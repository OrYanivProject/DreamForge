/*!
*  filename: ej2-documenteditor.umd.min.js
*  version : 27.1.48
*  Copyright Syncfusion Inc. 2001 - 2023. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@syncfusion/ej2-base"),require("@syncfusion/ej2-navigations"),require("@syncfusion/ej2-compression"),require("@syncfusion/ej2-popups"),require("@syncfusion/ej2-buttons"),require("@syncfusion/ej2-lists"),require("@syncfusion/ej2-inputs"),require("@syncfusion/ej2-dropdowns"),require("@syncfusion/ej2-calendars"),require("@syncfusion/ej2-splitbuttons"),require("@syncfusion/ej2-data"),require("@syncfusion/ej2-office-chart"),require("@syncfusion/ej2-file-utils")):"function"==typeof define&&define.amd?define(["exports","@syncfusion/ej2-base","@syncfusion/ej2-navigations","@syncfusion/ej2-compression","@syncfusion/ej2-popups","@syncfusion/ej2-buttons","@syncfusion/ej2-lists","@syncfusion/ej2-inputs","@syncfusion/ej2-dropdowns","@syncfusion/ej2-calendars","@syncfusion/ej2-splitbuttons","@syncfusion/ej2-data","@syncfusion/ej2-office-chart","@syncfusion/ej2-file-utils"],t):t((e=e||self).ej={},e.ej2Base,e.ej2Navigations,e.ej2Compression,e.ej2Popups,e.ej2Buttons,e.ej2Lists,e.ej2Inputs,e.ej2Dropdowns,e.ej2Calendars,e.ej2Splitbuttons,e.ej2Data,e.ej2OfficeChart,e.ej2FileUtils)}(this,function(V,_,k,f,C,H,F,D,U,v,w,b,W,x){"use strict";(e=V.CharacterRangeType||(V.CharacterRangeType={}))[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft",e[e.WordSplit=2]="WordSplit",e[e.Number=4]="Number",e[e.Tab=6]="Tab",(e=V.FontScriptType||(V.FontScriptType={}))[e.English=0]="English",e[e.Hindi=1]="Hindi",e[e.Korean=2]="Korean",e[e.Chinese=3]="Chinese",e[e.Arabic=4]="Arabic",e[e.Hebrew=5]="Hebrew",e[e.Japanese=6]="Japanese",e[e.Thai=7]="Thai",(e=V.FontHintType||(V.FontHintType={}))[e.Default=0]="Default",e[e.EastAsia=1]="EastAsia",e[e.CS=2]="CS",(e=V.LocaleId||(V.LocaleId={}))[e.af_ZA=1078]="af_ZA",e[e.sq_AL=1052]="sq_AL",e[e.am_ET=1118]="am_ET",e[e.gsw_FR=1156]="gsw_FR",e[e.ar_DZ=5121]="ar_DZ",e[e.ar_BH=15361]="ar_BH",e[e.ar_EG=3073]="ar_EG",e[e.ar_IQ=2049]="ar_IQ",e[e.ar_JO=11265]="ar_JO",e[e.ar_KW=13313]="ar_KW",e[e.ar_LB=12289]="ar_LB",e[e.ar_LY=4097]="ar_LY",e[e.ar_MA=6145]="ar_MA",e[e.ar_OM=8193]="ar_OM",e[e.ar_QA=16385]="ar_QA",e[e.ar_SA=1025]="ar_SA",e[e.ar_SY=10241]="ar_SY",e[e.ar_TN=7169]="ar_TN",e[e.ar_AE=14337]="ar_AE",e[e.ar_YE=9217]="ar_YE",e[e.hy_AM=1067]="hy_AM",e[e.as_IN=1101]="as_IN",e[e.az_Cyrl_AZ=2092]="az_Cyrl_AZ",e[e.az_Latn_AZ=1068]="az_Latn_AZ",e[e.ba_RU=1133]="ba_RU",e[e.eu_ES=1069]="eu_ES",e[e.be_BY=1059]="be_BY",e[e.bn_BD=2117]="bn_BD",e[e.bn_IN=1093]="bn_IN",e[e.bs_Cyrl_BA=8218]="bs_Cyrl_BA",e[e.bs_Latn_BA=5146]="bs_Latn_BA",e[e.bg_BG=1026]="bg_BG",e[e.br_FR=1150]="br_FR",e[e.my_MM=1109]="my_MM",e[e.ca_ES=1027]="ca_ES",e[e.chr_US=1116]="chr_US",e[e.zh_HK=3076]="zh_HK",e[e.zh_MO=5124]="zh_MO",e[e.zh_CN=2052]="zh_CN",e[e.zh_SG=4100]="zh_SG",e[e.zh_TW=1028]="zh_TW",e[e.co_FR=1155]="co_FR",e[e.hr_BA=4122]="hr_BA",e[e.hr_HR=1050]="hr_HR",e[e.cs_CZ=1029]="cs_CZ",e[e.da_DK=1030]="da_DK",e[e.prs_AF=1164]="prs_AF",e[e.dv_MV=1125]="dv_MV",e[e.nl_BE=2067]="nl_BE",e[e.nl_NL=1043]="nl_NL",e[e.bin_NG=1126]="bin_NG",e[e.et_EE=1061]="et_EE",e[e.en_AU=3081]="en_AU",e[e.en_BZ=10249]="en_BZ",e[e.en_CA=4105]="en_CA",e[e.en_029=9225]="en_029",e[e.en_HK=15369]="en_HK",e[e.en_IN=16393]="en_IN",e[e.en_ID=14345]="en_ID",e[e.en_IE=6153]="en_IE",e[e.en_JM=8201]="en_JM",e[e.en_MY=17417]="en_MY",e[e.en_NZ=5129]="en_NZ",e[e.en_PH=13321]="en_PH",e[e.en_SG=18441]="en_SG",e[e.en_ZA=7177]="en_ZA",e[e.en_TT=11273]="en_TT",e[e.en_GB=2057]="en_GB",e[e.en_US=1033]="en_US",e[e.en_ZW=12297]="en_ZW",e[e.fo_FO=1080]="fo_FO",e[e.fil_PH=1124]="fil_PH",e[e.fi_FI=1035]="fi_FI",e[e.fr_BE=2060]="fr_BE",e[e.fr_CM=11276]="fr_CM",e[e.fr_CA=3084]="fr_CA",e[e.fr_CD=9228]="fr_CD",e[e.fr_CI=12300]="fr_CI",e[e.fr_FR=1036]="fr_FR",e[e.fr_HT=15372]="fr_HT",e[e.fr_LU=5132]="fr_LU",e[e.fr_ML=13324]="fr_ML",e[e.fr_MC=6156]="fr_MC",e[e.fr_MA=14348]="fr_MA",e[e.fr_RE=8204]="fr_RE",e[e.fr_SN=10252]="fr_SN",e[e.fr_CH=4108]="fr_CH",e[e.fy_NL=1122]="fy_NL",e[e.ff_NG=1127]="ff_NG",e[e.gd_GB=1084]="gd_GB",e[e.gl_ES=1110]="gl_ES",e[e.ka_GE=1079]="ka_GE",e[e.de_AT=3079]="de_AT",e[e.de_DE=1031]="de_DE",e[e.de_LI=5127]="de_LI",e[e.de_LU=4103]="de_LU",e[e.de_CH=2055]="de_CH",e[e.el_GR=1032]="el_GR",e[e.gn_PY=1140]="gn_PY",e[e.gu_IN=1095]="gu_IN",e[e.kl_GL=1135]="kl_GL",e[e.ha_Latn_NG=1128]="ha_Latn_NG",e[e.haw_US=1141]="haw_US",e[e.he_IL=1037]="he_IL",e[e.hi_IN=1081]="hi_IN",e[e.hu_HU=1038]="hu_HU",e[e.ibb_NG=1129]="ibb_NG",e[e.is_IS=1039]="is_IS",e[e.ig_NG=1136]="ig_NG",e[e.id_ID=1057]="id_ID",e[e.iu_Latn_CA=2141]="iu_Latn_CA",e[e.iu_Cans_CA=1117]="iu_Cans_CA",e[e.it_IT=1040]="it_IT",e[e.it_CH=2064]="it_CH",e[e.ga_IE=2108]="ga_IE",e[e.xh_ZA=1076]="xh_ZA",e[e.zu_ZA=1077]="zu_ZA",e[e.kn_IN=1099]="kn_IN",e[e.kr_NG=1137]="kr_NG",e[e.ks_Deva=2144]="ks_Deva",e[e.ks_Arab=1120]="ks_Arab",e[e.kk_KZ=1087]="kk_KZ",e[e.km_KH=1107]="km_KH",e[e.kok_IN=1111]="kok_IN",e[e.ko_KR=1042]="ko_KR",e[e.ky_KG=1088]="ky_KG",e[e.qut_GT=1158]="qut_GT",e[e.rw_RW=1159]="rw_RW",e[e.lo_LA=1108]="lo_LA",e[e.la_Latn=1142]="la_Latn",e[e.lv_LV=1062]="lv_LV",e[e.lt_LT=1063]="lt_LT",e[e.dsb_DE=2094]="dsb_DE",e[e.lb_LU=1134]="lb_LU",e[e.mk_MK=1071]="mk_MK",e[e.ms_BN=2110]="ms_BN",e[e.ms_MY=1086]="ms_MY",e[e.ml_IN=1100]="ml_IN",e[e.mt_MT=1082]="mt_MT",e[e.mni_IN=1112]="mni_IN",e[e.mi_NZ=1153]="mi_NZ",e[e.mr_IN=1102]="mr_IN",e[e.arn_CL=1146]="arn_CL",e[e.mn_MN=1104]="mn_MN",e[e.mn_Mong_CN=2128]="mn_Mong_CN",e[e.ne_NP=1121]="ne_NP",e[e.ne_IN=2145]="ne_IN",e[e.nb_NO=1044]="nb_NO",e[e.nn_NO=2068]="nn_NO",e[e.oc_FR=1154]="oc_FR",e[e.or_IN=1096]="or_IN",e[e.om_Ethi_ET=1138]="om_Ethi_ET",e[e.pap_AN=1145]="pap_AN",e[e.ps_AF=1123]="ps_AF",e[e.fa_IR=1065]="fa_IR",e[e.pl_PL=1045]="pl_PL",e[e.pt_BR=1046]="pt_BR",e[e.pt_PT=2070]="pt_PT",e[e.pa_IN=1094]="pa_IN",e[e.pa_PK=2118]="pa_PK",e[e.quz_BO=1131]="quz_BO",e[e.guz_EC=2155]="guz_EC",e[e.guz_PE=3179]="guz_PE",e[e.ro_RO=1048]="ro_RO",e[e.ro_MO=2072]="ro_MO",e[e.rm_CH=1047]="rm_CH",e[e.ru_RU=1049]="ru_RU",e[e.ru_MO=2073]="ru_MO",e[e.smn_FI=9275]="smn_FI",e[e.smj_NO=4155]="smj_NO",e[e.smj_SE=5179]="smj_SE",e[e.se_FI=3131]="se_FI",e[e.se_NO=1083]="se_NO",e[e.se_SE=2107]="se_SE",e[e.sms_FI=8251]="sms_FI",e[e.sma_NO=6203]="sma_NO",e[e.sma_SE=7227]="sma_SE",e[e.sa_IN=1103]="sa_IN",e[e.sr_Cyrl_BA=7194]="sr_Cyrl_BA",e[e.sr_Cyrl_CS=3098]="sr_Cyrl_CS",e[e.sr_Latn_BA=6170]="sr_Latn_BA",e[e.sr_Latn_CS=2074]="sr_Latn_CS",e[e.nso_ZA=1132]="nso_ZA",e[e.tn_ZA=1074]="tn_ZA",e[e.sd_Arab_PK=2137]="sd_Arab_PK",e[e.sd_Deva_IN=1113]="sd_Deva_IN",e[e.si_LK=1115]="si_LK",e[e.sk_SK=1051]="sk_SK",e[e.sl_SI=1060]="sl_SI",e[e.so_SO=1143]="so_SO",e[e.es_AR=11274]="es_AR",e[e.es_BO=16394]="es_BO",e[e.es_CL=13322]="es_CL",e[e.es_CO=9226]="es_CO",e[e.es_CR=5130]="es_CR",e[e.es_DO=7178]="es_DO",e[e.es_EC=12298]="es_EC",e[e.es_SV=17418]="es_SV",e[e.es_GT=4106]="es_GT",e[e.es_HN=18442]="es_HN",e[e.es_MX=2058]="es_MX",e[e.es_NI=19466]="es_NI",e[e.es_PA=6154]="es_PA",e[e.es_PY=15370]="es_PY",e[e.es_PE=10250]="es_PE",e[e.es_PR=20490]="es_PR",e[e.es_ES=3082]="es_ES",e[e.es_ES_tradnl=1034]="es_ES_tradnl",e[e.es_US=21514]="es_US",e[e.es_UY=14346]="es_UY",e[e.es_VE=8202]="es_VE",e[e.st_ZA=1072]="st_ZA",e[e.sw_KE=1089]="sw_KE",e[e.sv_FI=2077]="sv_FI",e[e.sv_SE=1053]="sv_SE",e[e.syr_SY=1114]="syr_SY",e[e.tg_Cyrl_TJ=1064]="tg_Cyrl_TJ",e[e.tzm_Arab_MA=1119]="tzm_Arab_MA",e[e.tzm_Latn_DZ=2143]="tzm_Latn_DZ",e[e.ta_IN=1097]="ta_IN",e[e.tt_RU=1092]="tt_RU",e[e.te_IN=1098]="te_IN",e[e.th_TH=1054]="th_TH",e[e.bo_CN=1105]="bo_CN",e[e.ti_ER=2163]="ti_ER",e[e.ti_ET=1139]="ti_ET",e[e.ts_ZA=1073]="ts_ZA",e[e.tr_TR=1055]="tr_TR",e[e.tk_TM=1090]="tk_TM",e[e.ug_CN=1152]="ug_CN",e[e.uk_UA=1058]="uk_UA",e[e.hsb_DE=1070]="hsb_DE",e[e.ur_PK=1056]="ur_PK",e[e.uz_Cyrl_UZ=2115]="uz_Cyrl_UZ",e[e.uz_Latn_UZ=1091]="uz_Latn_UZ",e[e.ve_ZA=1075]="ve_ZA",e[e.vi_VN=1066]="vi_VN",e[e.cy_GB=1106]="cy_GB",e[e.wo_SN=1160]="wo_SN",e[e.sah_RU=1157]="sah_RU",e[e.ii_CN=1144]="ii_CN",e[e.yi_Hebr=1085]="yi_Hebr",e[e.yo_NG=1130]="yo_NG",e[e.ja_JP=1041]="ja_JP",(e=V.SectionBreakType||(V.SectionBreakType={})).EvenPage="EvenPage",e.NewPage="NewPage",e.Continuous="NoBreak",e.OddPage="OddPage";var L={Tab:"\t",Paragraph:"\n",LineBreak:"\v",PageBreak:"\f",ColumnBreak:"",Image:"",Table:"",Row:"",Cell:"",Marker_Start:"",Marker_End:"",Field_Separator:"",Section_Break:""},I=function(e,t,i){this.id=e,this.commentProperties=t,this.text=i},T=(Object.defineProperty(P.prototype,"length",{get:function(){return this.keysInternal.length},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"keys",{get:function(){return this.keysInternal},enumerable:!0,configurable:!0}),Object.defineProperty(P.prototype,"values",{get:function(){return this.valuesInternal},enumerable:!0,configurable:!0}),P.prototype.add=function(e,t){if(_.isNullOrUndefined(e))throw new ReferenceError("Provided key or value is not valid.");return this.keysInternal.indexOf(e)<0&&(this.keysInternal.push(e),this.valuesInternal.push(t)),1},P.prototype.get=function(e){if(_.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");e=this.keysInternal.indexOf(e);if(!(e<0||e>this.keysInternal.length-1))return this.valuesInternal[e]},P.prototype.set=function(e,t){if(_.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");e=this.keysInternal.indexOf(e);if(e<0||e>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");this.valuesInternal[e]=t},P.prototype.remove=function(e){if(_.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");e=this.keysInternal.indexOf(e);if(e<0||e>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");return this.keysInternal.splice(e,1),this.valuesInternal.splice(e,1),!0},P.prototype.containsKey=function(e){if(_.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");e=this.keysInternal.indexOf(e);return!(e<0||e>this.keysInternal.length-1)},P.prototype.clear=function(){this.keysInternal=[],this.valuesInternal=[]},P.prototype.destroy=function(){this.clear(),this.keysInternal=void 0,this.valuesInternal=void 0},P);function P(){this.keysInternal=[],this.valuesInternal=[]}R.prototype.isEqual=function(e,t,i){var n=!1;switch(this.uniqueFormatType){case 1:n=this.isBorderEqual(e,t,i);break;case 2:n=this.isCharacterFormatEqual(e,t,i);break;case 3:n=this.isParagraphFormatEqual(e,t,i);break;case 4:n=this.isCellFormatEqual(e,t,i);break;case 5:n=this.isShadingEqual(e,t,i);break;case 6:n=this.isRowFormatEqual(e,t,i);break;case 7:n=this.isListFormatEqual(e,t,i);break;case 8:n=this.isTableFormatEqual(e,t,i);break;case 9:n=this.isListLevelEqual(e,t,i);break;case 10:n=this.isSectionFormatEqual(e,t,i);break;case 11:n=this.isColumnFormatEqual(e,t,i)}return n},R.prototype.isNotEqual=function(e,t,i,n,r){var o=void 0,r=R.getPropertyType(r,e),s=(this.propertiesHash.containsKey(r)&&(o=this.propertiesHash.get(r)),void 0);return e===i?s=n:t.containsKey(r)&&(s=t.get(r)),!(o===s||!_.isNullOrUndefined(o)&&!_.isNullOrUndefined(s)&&o===s)},R.getPropertyType=function(e,t){var i=0;switch(e){case 1:i=this.getBorderPropertyType(t);break;case 2:i=this.getCharacterFormatPropertyType(t);break;case 3:i=this.getParaFormatPropertyType(t);break;case 4:i=this.getCellFormatPropertyType(t);break;case 5:i=this.getShadingPropertyType(t);break;case 6:i=this.getRowFormatType(t);break;case 7:i=this.getListFormatType(t);break;case 8:i=this.getTableFormatType(t);break;case 9:i=this.getListLevelType(t);break;case 10:i=this.getSectionFormatType(t);break;case 11:i=this.getColumnFormatType(t)}return i},R.getRowFormatType=function(e){return"allowBreakAcrossPages"===e?1:"isHeader"===e?2:"height"===e?3:"heightType"===e?4:"gridBefore"===e?5:"gridBeforeWidth"===e?6:"gridBeforeWidthType"===e?7:"gridAfter"===e?8:"gridAfterWidth"===e?9:"gridAfterWidthType"===e?10:"leftMargin"===e?11:"topMargin"===e?12:"bottomMargin"===e?13:"rightMargin"===e?14:"leftIndent"===e?15:0},R.getListFormatType=function(e){return"listId"===e?1:"listLevelNumber"===e?2:"nsid"===e?3:0},R.getTableFormatType=function(e){return"leftMargin"===e?1:"rightMargin"===e?2:"topMargin"===e?3:"bottomMargin"===e?4:"cellSpacing"===e?5:"leftIndent"===e?6:"tableAlignment"===e?7:"preferredWidth"===e?8:"preferredWidthType"===e?9:"bidi"===e?10:"allowAutoFit"===e?11:"horizontalPositionAbs"===e?12:"horizontalPosition"===e?13:0},R.getListLevelType=function(e){return"listLevelPattern"===e?1:"startAt"===e?2:"followCharacter"===e?3:"numberFormat"===e?4:"restartLevel"===e?5:"isLegalStyleNumbering"===e?6:"paraStyleName"===e?7:0},R.getShadingPropertyType=function(e){return"backgroundColor"===e?1:"foregroundColor"===e?2:"textureStyle"===e?3:0},R.getCellFormatPropertyType=function(e){return"leftMargin"===e?1:"rightMargin"===e?2:"topMargin"===e?3:"bottomMargin"===e?4:"columnSpan"===e?5:"rowSpan"===e?6:"verticalAlignment"===e?7:"preferredWidthType"===e?8:"preferredWidth"===e?9:"cellWidth"===e?10:0},R.getBorderPropertyType=function(e){return"color"===e?1:"lineStyle"===e?2:"lineWidth"===e?3:"shadow"===e?4:"space"===e?5:"hasNoneStyle"===e?6:0},R.getCharacterFormatPropertyType=function(e){return"fontColor"===e?1:"fontFamily"===e?2:"fontSize"===e?3:"bold"===e?4:"italic"===e?5:"underline"===e?6:"strikethrough"===e?7:"baselineAlignment"===e?8:"highlightColor"===e?9:"bidi"===e?10:"bdo"===e?11:"boldBidi"===e?12:"italicBidi"===e?13:"fontFamilyBidi"===e?14:"fontSizeBidi"===e?15:"allCaps"===e?16:"localeIdBidi"===e?17:"complexScript"===e?18:"fontFamilyFarEast"===e?19:"fontFamilyAscii"===e?20:"fontFamilyNonFarEast"===e?21:"localeIdAscii"===e?22:"localeIdFarEast"===e?23:"characterSpacing"===e?24:"scaling"===e?25:"underlineColor"===e?27:0},R.getParaFormatPropertyType=function(e){return"leftIndent"===e?1:"rightIndent"===e?2:"firstLineIndent"===e?3:"textAlignment"===e?4:"beforeSpacing"===e?5:"afterSpacing"===e?6:"lineSpacing"===e?7:"lineSpacingType"===e?8:"outlineLevel"===e?9:"bidi"===e?10:"contextualSpacing"===e?11:"keepWithNext"===e?12:"keepLinesTogether"===e?13:"widowControl"===e?14:"spaceBeforeAuto"===e?15:"spaceAfterAuto"===e?16:0},R.getColumnFormatType=function(e){return"width"===e?1:"space"===e?2:0},R.getSectionFormatType=function(e){return"headerDistance"===e?1:"footerDistance"===e?2:"differentFirstPage"===e?3:"differentOddAndEvenPages"===e?4:"pageWidth"===e?5:"pageHeight"===e?6:"leftMargin"===e?7:"topMargin"===e?8:"rightMargin"===e?9:"bottomMargin"===e?10:"bidi"===e?11:"restartPageNumbering"===e?12:"pageStartingNumber"===e?13:"endnoteNumberFormat"===e?14:"endnotePosition"===e?15:"footNoteNumberFormat"===e?16:"footnotePosition"===e?17:"restartIndexForEndnotes"===e?18:"restartIndexForFootnotes"===e?19:"initialFootNoteNumber"===e?20:"initialEndNoteNumber"===e?21:"pageNumberStyle"===e?22:"numberOfColumns"===e?23:"equalWidth"===e?24:"lineBetweenColumns"===e?25:"columns"===e?26:"breakCode"===e?27:0},R.prototype.isBorderEqual=function(e,t,i){return!this.isNotEqual("color",e,t,i,1)&&!this.isNotEqual("lineStyle",e,t,i,1)&&!(this.isNotEqual("lineWidth",e,t,i,1)||this.isNotEqual("shadow",e,t,i,1)||this.isNotEqual("space",e,t,i,1)||this.isNotEqual("hasNoneStyle",e,t,i,1))},R.prototype.isCharacterFormatEqual=function(e,t,i){return!this.isNotEqual("fontColor",e,t,i,2)&&!(this.isNotEqual("fontFamily",e,t,i,2)||this.isNotEqual("fontSize",e,t,i,2)||this.isNotEqual("bold",e,t,i,2)||this.isNotEqual("italic",e,t,i,2)||this.isNotEqual("underline",e,t,i,2)||this.isNotEqual("strikethrough",e,t,i,2)||this.isNotEqual("baselineAlignment",e,t,i,2)||this.isNotEqual("highlightColor",e,t,i,2)||this.isNotEqual("bidi",e,t,i,2)||this.isNotEqual("bdo",e,t,i,2)||this.isNotEqual("fontColor",e,t,i,2)||this.isNotEqual("fontFamilyBidi",e,t,i,2)||this.isNotEqual("fontSizeBidi",e,t,i,2)||this.isNotEqual("boldBidi",e,t,i,2)||this.isNotEqual("italicBidi",e,t,i,2)||this.isNotEqual("allCaps",e,t,i,2)||this.isNotEqual("localeIdBidi",e,t,i,2)||this.isNotEqual("localeIdAscii",e,t,i,2)||this.isNotEqual("complexScript",e,t,i,2)||this.isNotEqual("fontFamilyFarEast",e,t,i,2)||this.isNotEqual("fontFamilyAscii",e,t,i,2)||this.isNotEqual("fontFamilyNonFarEast",e,t,i,2)||this.isNotEqual("characterSpacing",e,t,i,2)||this.isNotEqual("scaling",e,t,i,2)||this.isNotEqual("underlineColor",e,t,i,2))},R.prototype.isParagraphFormatEqual=function(e,t,i){return!(this.isNotEqual("leftIndent",e,t,i,3)||this.isNotEqual("rightIndent",e,t,i,3)||this.isNotEqual("firstLineIndent",e,t,i,3)||this.isNotEqual("textAlignment",e,t,i,3)||this.isNotEqual("beforeSpacing",e,t,i,3)||this.isNotEqual("afterSpacing",e,t,i,3)||this.isNotEqual("spaceBeforeAuto",e,t,i,3)||this.isNotEqual("spaceAfterAuto",e,t,i,3)||this.isNotEqual("lineSpacing",e,t,i,3)||this.isNotEqual("lineSpacingType",e,t,i,3)||this.isNotEqual("outlineLevel",e,t,i,3)||this.isNotEqual("bidi",e,t,i,3)||this.isNotEqual("contextualSpacing",e,t,i,3)||this.isNotEqual("keepWithNext",e,t,i,3)||this.isNotEqual("keepLinesTogether",e,t,i,3)||this.isNotEqual("widowControl",e,t,i,3))},R.prototype.isCellFormatEqual=function(e,t,i){return!(this.isNotEqual("leftMargin",e,t,i,4)||this.isNotEqual("rightMargin",e,t,i,4)||this.isNotEqual("topMargin",e,t,i,4)||this.isNotEqual("bottomMargin",e,t,i,4)||this.isNotEqual("columnSpan",e,t,i,4)||this.isNotEqual("rowSpan",e,t,i,4)||this.isNotEqual("verticalAlignment",e,t,i,4)||this.isNotEqual("preferredWidthType",e,t,i,4)||this.isNotEqual("preferredWidth",e,t,i,4)||this.isNotEqual("cellWidth",e,t,i,4))},R.prototype.isShadingEqual=function(e,t,i){return!this.isNotEqual("backgroundColor",e,t,i,5)&&!this.isNotEqual("foregroundColor",e,t,i,5)&&!this.isNotEqual("textureStyle",e,t,i,5)},R.prototype.isRowFormatEqual=function(e,t,i){return!this.isNotEqual("allowBreakAcrossPages",e,t,i,6)&&!this.isNotEqual("isHeader",e,t,i,6)&&!(this.isNotEqual("height",e,t,i,6)||this.isNotEqual("heightType",e,t,i,6)||this.isNotEqual("gridBefore",e,t,i,6)||this.isNotEqual("gridBeforeWidth",e,t,i,6)||this.isNotEqual("gridBeforeWidthType",e,t,i,6)||this.isNotEqual("gridAfter",e,t,i,6)||this.isNotEqual("gridAfterWidth",e,t,i,6)||this.isNotEqual("gridAfterWidthType",e,t,i,6)||this.isNotEqual("leftMargin",e,t,i,6)||this.isNotEqual("topMargin",e,t,i,6)||this.isNotEqual("bottomMargin",e,t,i,6)||this.isNotEqual("rightMargin",e,t,i,6)||this.isNotEqual("leftIndent",e,t,i,6))},R.prototype.isListFormatEqual=function(e,t,i){return!this.isNotEqual("listId",e,t,i,7)&&!this.isNotEqual("listLevelNumber",e,t,i,7)&&!this.isNotEqual("nsid",e,t,i,7)},R.prototype.isTableFormatEqual=function(e,t,i){return!(this.isNotEqual("leftMargin",e,t,i,8)||this.isNotEqual("rightMargin",e,t,i,8)||this.isNotEqual("topMargin",e,t,i,8)||this.isNotEqual("bottomMargin",e,t,i,8)||this.isNotEqual("cellSpacing",e,t,i,8)||this.isNotEqual("leftIndent",e,t,i,8)||this.isNotEqual("tableAlignment",e,t,i,8)||this.isNotEqual("preferredWidth",e,t,i,8)||this.isNotEqual("preferredWidthType",e,t,i,8)||this.isNotEqual("bidi",e,t,i,8)||this.isNotEqual("allowAutoFit",e,t,i,8)||this.isNotEqual("horizontalPositionAbs",e,t,i,8)||this.isNotEqual("horizontalPosition",e,t,i,8))},R.prototype.isListLevelEqual=function(e,t,i){return!(this.isNotEqual("listLevelPattern",e,t,i,9)||this.isNotEqual("startAt",e,t,i,9)||this.isNotEqual("followCharacter",e,t,i,9)||this.isNotEqual("numberFormat",e,t,i,9)||this.isNotEqual("paraStyleName",e,t,i,9)||this.isNotEqual("restartLevel",e,t,i,9)||this.isNotEqual("isLegalStyleNumbering",e,t,i,9))},R.prototype.isSectionFormatEqual=function(e,t,i){return!this.isNotEqual("headerDistance",e,t,i,10)&&!(this.isNotEqual("footerDistance",e,t,i,10)||this.isNotEqual("differentFirstPage",e,t,i,10)||this.isNotEqual("differentOddAndEvenPages",e,t,i,10)||this.isNotEqual("pageWidth",e,t,i,10)||this.isNotEqual("pageHeight",e,t,i,10)||this.isNotEqual("leftMargin",e,t,i,10)||this.isNotEqual("topMargin",e,t,i,10)||this.isNotEqual("rightMargin",e,t,i,10)||this.isNotEqual("bottomMargin",e,t,i,10)||this.isNotEqual("bidi",e,t,i,10)||this.isNotEqual("restartPageNumbering",e,t,i,10)||this.isNotEqual("pageStartingNumber",e,t,i,10)||this.isNotEqual("endnoteNumberFormat",e,t,i,10)||this.isNotEqual("endnotePosition",e,t,i,10)||this.isNotEqual("footNoteNumberFormat",e,t,i,10)||this.isNotEqual("footnotePosition",e,t,i,10)||this.isNotEqual("restartIndexForEndnotes",e,t,i,10)||this.isNotEqual("restartIndexForFootnotes",e,t,i,10)||this.isNotEqual("initialFootNoteNumber",e,t,i,10)||this.isNotEqual("initialEndNoteNumber",e,t,i,10)||this.isNotEqual("pageNumberStyle",e,t,i,10)||this.isNotEqual("numberOfColumns",e,t,i,10)||this.isNotEqual("equalWidth",e,t,i,10)||this.isNotEqual("lineBetweenColumns",e,t,i,10)||this.isNotEqual("breakCode",e,t,i,10))},R.prototype.isColumnFormatEqual=function(e,t,i){return!this.isNotEqual("width",e,t,i,11)&&!this.isNotEqual("space",e,t,i,11)},R.prototype.cloneItems=function(e,t,i,n){for(var r=R.getPropertyType(n,t),o=e.propertiesHash.keys,s=0;s<o.length;s++)o[s]===r?this.propertiesHash.add(r,i):this.propertiesHash.add(o[s],e.propertiesHash.get(o[s]));e.propertiesHash.containsKey(r)||this.propertiesHash.add(r,i)},R.prototype.mergeProperties=function(e){for(var t=e.cloneProperties(),i=this.propertiesHash.keys,n=0;n<i.length;n++)t.containsKey(i[n])||t.add(i[n],this.propertiesHash.get(i[n]));return t},R.prototype.cloneProperties=function(){for(var e=new T,t=this.propertiesHash.keys,i=0;i<t.length;i++)e.add(t[i],this.propertiesHash.get(t[i]));return e},R.prototype.destroy=function(){_.isNullOrUndefined(this.propertiesHash)||this.propertiesHash.destroy(),this.propertiesHash=void 0,this.referenceCount=void 0,this.uniqueFormatType=void 0};var O=R;function R(e){this.referenceCount=0,this.uniqueFormatType=e,this.propertiesHash=new T}M.prototype.addUniqueFormat=function(e,t){for(var i=void 0,n=0;n<this.items.length;n++)if(this.items[n].isEqual(e,void 0,void 0)){i=this.items[n];break}return _.isNullOrUndefined(i)?((i=new O(t)).propertiesHash=e,i.referenceCount=1,this.items.push(i)):i.referenceCount++,i},M.prototype.updateUniqueFormat=function(e,t,i){for(var n=void 0,r=0;r<this.items.length;r++)if(this.items[r].isEqual(e.propertiesHash,t,i)){n=this.items[r];break}return _.isNullOrUndefined(n)?((n=new O(e.uniqueFormatType)).cloneItems(e,t,i,e.uniqueFormatType),n.referenceCount=1,this.items.push(n)):n.referenceCount++,this.remove(e),n},M.prototype.remove=function(e){e.referenceCount--,e.referenceCount<=0&&(this.items.splice(this.items.indexOf(e),1),e.destroy())},M.prototype.clear=function(){if(_.isNullOrUndefined(this.items))for(var e=0;e<this.items.length;e++)this.items[e].destroy();this.items=[]},M.prototype.destroy=function(){this.clear(),this.items=void 0};var e=M;function M(){this.items=[]}Q.prototype.send=function(e,t,i){var n=this,r=(this.xmlHttpRequest=new XMLHttpRequest,0);i=!!_.isNullOrUndefined(i)||i,_.isNullOrUndefined(t)||(this.xmlHttpRequest.withCredentials=t.withCredentials,r=0<=t.timeout?t.timeout:0,this.customHeaders=t.headers),this.xmlHttpRequest.onreadystatechange=function(){n.stateChange(n)},this.xmlHttpRequest.onerror=function(){n.error(n)},this.mode?this.sendRequest(e,r,i):setTimeout(function(){n.sendRequest(e,r,i)})},Q.prototype.sendRequest=function(e,t,i){this.xmlHttpRequest.open("POST",this.url,i),i&&(this.xmlHttpRequest.timeout=t),this.contentType&&this.xmlHttpRequest.setRequestHeader("Content-Type",this.contentType),this.setCustomAjaxHeaders(),this.responseType&&(this.xmlHttpRequest.responseType=this.responseType);i=e instanceof FormData?e:JSON.stringify(e);this.xmlHttpRequest.send(i)},Q.prototype.stateChange=function(e){var t;4===e.xmlHttpRequest.readyState&&200===e.xmlHttpRequest.status?(t={name:"onSuccess",data:this.responseType?e.xmlHttpRequest.response:e.xmlHttpRequest.responseText,readyState:e.xmlHttpRequest.readyState,status:e.xmlHttpRequest.status},e.successHandler(t)):4===e.xmlHttpRequest.readyState&&200!==e.xmlHttpRequest.status&&(t={name:"onFailure",status:e.xmlHttpRequest.status,statusText:e.xmlHttpRequest.statusText,url:e.url},e.failureHandler(t))},Q.prototype.error=function(e){var t={name:"onError",status:this.xmlHttpRequest.status,statusText:this.xmlHttpRequest.statusText};e.errorHandler(t)},Q.prototype.successHandler=function(e){return this.onSuccess&&this.onSuccess(e),e},Q.prototype.failureHandler=function(e){return this.onFailure&&this.onFailure(e),e},Q.prototype.errorHandler=function(e){return this.onError&&this.onError(e),e},Q.prototype.setCustomAjaxHeaders=function(){for(var e=0;e<this.customHeaders.length;e++)for(var t=this.customHeaders[e],i=0,n=Object.keys(t);i<n.length;i++){var r=n[i];this.xmlHttpRequest.setRequestHeader(r,t[r])}};var A=Q;function Q(){this.mode=!0}var $="internalZoomFactorChange",ee="contentChange",te="documentChange",ie="selectionChange",ne="zoomFactorChange",re="beforeFieldFill",oe="afterFieldFill",se="afterFormFieldFill",ae="beforeFormFieldFill",le="serviceFailure",de="viewChange",he="customContextMenuSelect",ce="customContextMenuBeforeOpen",pe="contentControl",ue="commentBegin",ge="commentEnd",me="beforeCommentAction",fe="commentDelete",ye="beforeAcceptRejectChanges",ve="beforePaneSwitch",we="requestNavigate",be="actionComplete",xe="trackChange",Ce="searchResultsChange",Ie="keyDown",ke="toolbarClick",Fe="beforeFileOpen",Pe="internalviewChange",Te="beforeXmlHttpRequestSend",Se="protectionTypeChange",He="internalDocumentEditorSettingsChange",Ne="internalStyleCollectionChange",We="Times New Roman",Oe="internalAutoResize",Ee="beforeAutoResize",Le="trackChanges",Be="internalOptionPaneChange",Re=["sections","sec"],Me=["fontSubstitutionTable","fst"],Ae=["characterFormat","cf"],De=["paragraphFormat","pf"],Ue=["lists","li"],Ve=["abstractLists","al"],ze=["background","bg"],qe=["styles","sty"],_e=["comments","cm"],je=["revisions","r"],Ge=["customXml","cx"],Ke=["defaultTabWidth","dtw"],Ze=["formatting","fmt"],Xe=["trackChanges","tc"],Je=["protectionType","pt"],Ye=["enforcement","enf"],Qe=["hashValue","hv"],$e=["saltValue","sv"],et=["dontUseHTMLParagraphAutoSpacing","dhtml"],tt=["alignTablesRowByRow","atrr"],it=["formFieldShading","ffs"],nt=["lastParagraphMarkCopied","lpmc"],rt=["footnotes","fn"],ot=["endnotes","en"],st=["compatibilityMode","comp"],at=["themeFontLanguages","tfl"],lt=["themes","thm"],dt=["name","n"],ht=["basedOn","b"],ct=["next","nx"],pt=["link","l"],ut=["localeId","id"],gt=["localeIdFarEast","idfe"],mt=["localeIdBidi","idbi"],ft=["bold","b"],yt=["italic","i"],vt=["underline","u"],wt=["underlineColor","uc"],bt=["baselineAlignment","ba"],xt=["strikethrough","st"],Ct=["highlightColor","hc"],It=["fontSize","fsz"],kt=["fontColor","fc"],Ft=["fontFamily","ff"],Pt=["styleName","stn"],Tt=["bidi","bi"],St=["bdo","bdo"],Ht=["breakClearType","bct"],Nt=["fontSizeBidi","fszbi"],Wt=["fontFamilyBidi","ffbi"],Ot=["boldBidi","bbi"],Et=["italicBidi","ibi"],Lt=["allCaps","ac"],Bt=["complexScript","cs"],Rt=["fontFamilyAscii","ffa"],Mt=["fontFamilyFarEast","fffe"],At=["fontFamilyNonFarEast","ffnfe"],Dt=["revisionIds","rids"],Ut=["listId","lid"],Vt=["characterSpacing","csp"],zt=["scaling","sc"],qt=["listLevelNumber","lilno"],_t=["leftIndent","lin"],jt=["rightIndent","rin"],Gt=["firstLineIndent","fin"],Kt=["textAlignment","ta"],Zt=["afterSpacing","as"],Xt=["beforeSpacing","bs"],Jt=["spaceAfterAuto","saa"],Yt=["spaceBeforeAuto","sba"],Qt=["lineSpacing","ls"],$t=["lineSpacingType","lst"],ei=["listFormat","lif"],ti=["keepWithNext","kwn"],ii=["widowControl","wc"],ni=["keepLinesTogether","klt"],ri=["outlineLevel","ol"],oi=["contextualSpacing","cs"],si=["borders","bdrs"],ai=["tabs","tb"],li=["headerDistance","hd"],di=["footerDistance","fd"],hi=["differentFirstPage","dfp"],ci=["differentOddAndEvenPages","doep"],pi=["pageWidth","pw"],ui=["pageHeight","ph"],gi=["leftMargin","lm"],mi=["rightMargin","rm"],fi=["topMargin","tm"],yi=["bottomMargin","bm"],vi=["restartPageNumbering","rpn"],wi=["pageStartingNumber","psn"],bi=["endnoteNumberFormat","enf"],xi=["footNoteNumberFormat","fnf"],Ci=["restartIndexForFootnotes","rif"],Ii=["restartIndexForEndnotes","rie"],ki=["initialFootNoteNumber","ifn"],Fi=["initialEndNoteNumber","ien"],Pi=["pageNumberStyle","pgns"],Ti=["columns","cols"],Si=["numberOfColumns","ncols"],Hi=["equalWidth","eqw"],Ni=["lineBetweenColumns","lbtc"],Wi=["breakCode","bc"],Oi=["cellWidth","cw"],Ei=["columnSpan","colsp"],Li=["rowSpan","rwsp"],Bi=["verticalAlignment","va"],Ri=["allowBreakAcrossPages","abrk"],Mi=["isHeader","hdr"],Ai=["heightType","ht"],Di=["gridBefore","gb"],Ui=["gridBeforeWidth","gbw"],Vi=["gridBeforeWidthType","gbwt"],zi=["gridAfter","ga"],qi=["gridAfterWidth","gaw"],_i=["gridAfterWidthType","gawt"],ji=["allowAutoFit","auft"],Gi=["cellSpacing","csp"],Ki=["shading","sd"],Zi=["tableAlignment","ta"],Xi=["preferredWidth","pw"],Ji=["preferredWidthType","pwt"],Yi=["horizontalPositionAbs","hpa"],Qi=["texture","t"],$i=["backgroundColor","bgc"],en=["foregroundColor","fgc"],tn=["shadow","sh"],nn=["hasNoneStyle","hns"],rn=["vertical","v"],on=["horizontal","h"],sn=["diagonalUp","du"],an=["diagonalDown","dd"],ln=["lineStyle","ls"],dn=["lineWidth","lw"],hn=["layout","l"],cn=["dataFormat","df"],pn=["yValue","y"],un=["chartData","chd"],gn=["categoryXName","cx"],mn=["line","l"],fn=["foreColor","fc"],yn=["layoutX","x"],vn=["layoutY","y"],wn=["direction","dir"],bn=["endStyle","est"],xn=["numberValue","no"],Cn=["markerStyle","mst"],In=["markerColor","mc"],kn=["markerSize","msz"],Fn=["forward","fw"],Pn=["backward","bw"],Tn=["intercept","itr"],Sn=["isDisplayRSquared","idrs"],Hn=["isDisplayEquation","ideq"],Nn=["seriesName","sn"],Wn=["dataLabel","sl"],On=["errorBar","eb"],En=["seriesFormat","sf"],Ln=["trendLines","tl"],Bn=["dataPoints","dp"],Rn=["firstSliceAngle","fsa"],Mn=["holeSize","hsz"],An=["isLegendKey","lk"],Dn=["isBubbleSize","bsz"],Un=["isCategoryName","icn"],Vn=["isSeriesName","isn"],zn=["isValue","iv"],qn=["isPercentage","ip"],_n=["isLeaderLines","il"],jn=["showSeriesKeys","sk"],Gn=["hasHorzBorder","hhbdr"],Kn=["hasVertBorder","hvbdr"],Zn=["hasBorders","hbdr"],Xn=["categoryType","ct"],Jn=["chartCategory","c"],Yn=["chartSeries","cs"],Qn=["chartArea","ca"],$n=["chartTitleArea","cta"],er=["plotArea","pa"],tr=["chartLegend","cl"],ir=["chartPrimaryCategoryAxis","cpca"],nr=["chartPrimaryValueAxis","cpva"],rr=["chartTitle","ctt"],or=["chartType","ct"],sr=["gapWidth","gw"],ar=["overlap","o"],lr=["chartDataTable","cdt"],dr=["text","tlp"],hr=["shapeId","sid"],cr=["alternativeText","at"],pr=["visible","v"],ur=["belowText","b"],gr=["horizontalRule","ihr"],mr=["width","w"],fr=["height","h"],yr=["widthScale","ws"],vr=["heightScale","hs"],wr=["lineFormat","lf"],br=["fillFormat","ff"],xr=["textWrappingStyle","tws"],Cr=["textWrappingType","twt"],Ir=["verticalRelativePercent","vrp"],kr=["horizontalRelativePercent","hrp"],Fr=["heightRelativePercent","hrp"],Pr=["widthRelativePercent","wrp"],Tr=["zOrderPosition","z"],Sr=["layoutInCell","lc"],Hr=["lockAnchor","la"],Nr=["autoShapeType","ast"],Wr=["textFrame","tf"],Or=["color","c"],Er=["fill","f"],Lr=["textVerticalAlignment","tva"],Br=["imageString","img"],Rr=["metaFileImageString","mtimg"],Mr=["isInlineImage","inimg"],Ar=["isMetaFile","imf"],Dr=["top","tp"],Ur=["bottom","bt"],Vr=["right","rg"],zr=["left","lt"],qr=["getimageheight","gih"],_r=["getimagewidth","giw"],jr=["hasFieldEnd","hfe"],Gr=["formFieldData","ffd"],Kr=["fieldType","ft"],Zr=["enabled","e"],Xr=["helpText","h"],Jr=["statusText","st"],Yr=["textInput","ti"],Qr=["checkBox","c"],$r=["dropDownList","ddl"],eo=["maxLength","ml"],to=["defaultValue","dv"],io=["format","f"],no=["sizeType","szt"],ro=["size","sz"],oo=["checked","chk"],so=["dropDownItems","ddi"],ao=["selectedIndex","si"],lo=["commentId","cid"],ho=["commentCharacterType","cct"],co=["author","a"],po=["initial","i"],uo=["date","dt"],go=["done","dn"],mo=["replyComments","rc"],fo=["revisionType","rt"],yo=["revisionId","rid"],vo=["itemID","iid"],wo=["xml","x"],bo=["footnoteType","fnt"],xo=["symbolCode","sc"],Co=["symbolFontName","sfn"],Io=["customMarker","cm"],ko=["inlines","i"],Fo=["contentControlProperties","ccp"],Po=["lockContentControl","lcc"],To=["lockContents","lc"],So=["tag","tg"],Ho=["title","tt"],No=["hasPlaceHolderText","hpt"],Wo=["multiline","mul"],Oo=["isTemporary","it"],Eo=["dateCalendarType","dtct"],Lo=["dateStorageFormat","dtsf"],Bo=["dateDisplayLocale","dtdl"],Ro=["dateDisplayFormat","dtdf"],Mo=["isChecked","ichk"],Ao=["uncheckedState","uchk"],Do=["checkedState","chks"],Uo=["contentControlListItems","ccli"],Vo=["xmlMapping","x"],zo=["font","f"],qo=["value","v"],_o=["displayText","dt"],jo=["isMapped","imap"],Go=["isWordMl","iwml"],Ko=["prefixMapping","pmap"],Zo=["xPath","xp"],Xo=["storeItemId","siid"],Jo=["customXmlPart","cxp"],Yo=["id","i"],Qo=["cellFormat","tcpr"],$o=["rowFormat","trpr"],es=["cells","c"],ts=["rows","r"],is=["description","desc"],ns=["wrapTextAround","wta"],rs=["isLegalStyleNumbering","isLgl"],os=["positioning","p"],ss=["tableFormat","tblpr"],as=["allowOverlap","ao"],ls=["distanceTop","dt"],ds=["distanceRight","dr"],hs=["distanceLeft","dl"],cs=["distanceBottom","db"],ps=["verticalOrigin","vo"],us=["verticalPosition","vp"],gs=["horizontalOrigin","ho"],ms=["horizontalAlignment","ha"],fs=["horizontalPosition","hp"],S=["blocks","b"],ys=["header","h"],vs=["footer","f"],ws=["evenHeader","eh"],bs=["evenFooter","ef"],xs=["firstPageHeader","fph"],Cs=["firstPageFooter","fpf"],Is=["headersFooters","hf"],ks=["sectionFormat","secpr"],Fs=["listLevelPattern","lilp"],Ps=["followCharacter","fchar"],Ts=["startAt","sa"],Ss=["restartLevel","rl"],Hs=["levelNumber","lvlno"],Ns=["numberFormat","nf"],Ws=["paraStyleName","psty"],Os=["abstractListId","alid"],Es="nsid",Ls=["levels","lvl"],Bs=["overrideListLevel","o"],Rs=["levelOverrides","lo"],Ms=["separator","s"],As=["continuationSeparator","cs"],Ds=["continuationNotice","cn"],Us=["bookmarkType","bkt"],Vs=["properties","p"],zs=["tabJustification","tj"],qs=["position","p"],_s=["deletePosition","dp"],js=["tabLeader","tl"],Gs=["editRangeId","erid"],Ks=["columnFirst","cft"],Zs=["columnLast","clt"],Xs=["user","u"],Js=["group","g"],Ys=["editableRangeStart","ers"],Qs=["space","sp"],$s=["fontScheme","fsc"],ea=["fontSchemeName","fscn"],ta=["majorFontScheme","majfs"],ia=["minorFontScheme","minfs"],na=["fontSchemeList","fsl"],ra=["fontTypeface","ft"],oa=["typeface","t"],sa=["panose","p"],aa=["type","t"],la=["majorUnit","maju"],da=["isAutoMajor","iam"],ha=["maximumValue","maxv"],ca=["minimumValue","minv"],pa=["hasMajorGridLines","hmajgl"],ua=["hasMinorGridLines","hmingl"],ga=["majorTickMark","majtm"],ma=["minorTickMark","mintm"],fa=["tickLabelPosition","tlp"],ya=["rgb","rgb"],va=["appearance","a"],wa=["lineFormatType","lft"],ba=["allowSpaceOfSameStyleInTable","stytbl"],xa=["weight","w"],Ca=["inlineFormat","inf"],Ia=["fontName","fn"],ka=["isCompressed","comp"],Fa=["columnIndex","ci"],Pa=["images","imgs"],Ta=["isAfterParagraphMark","apm"],Sa=["isAfterCellMark","acm"],Ha=["isAfterRowMark","arm"],Na=["grid","grd"],Wa=["columnCount","colc"],Oa=["isAfterTableMark","atm"],Ea=["iOps"],La=["editingpoints","ep"],Ba=(Ra.prototype.getModuleName=function(){return"Print"},Ra.prototype.print=function(e,t){this.printWindow(e,void 0!==navigator?navigator.userAgent:"",t)},Ra.prototype.printWindow=function(e,t,i){var n=this.getPageHeight(e.pages),r=this.getPageWidth(e.pages),o=document.createElement("div"),s=(o.style.width="100%",o.style.height="100%",o.style.overflow="scroll",this.generatePrintContent(e,o),_.isNullOrUndefined(i)&&(i=window.open("","print","height=452,width=1024,tabbar=no")),this.windowPrint=i,r.toString()+"px "+n.toString()+"px"),a=(n<r&&(s="landscape"),-1!==t.indexOf("Chrome")?(i.document.write("<!DOCTYPE html>"),i.document.write("<html><head><title>"+e.owner.documentName+"</title><style>img { height: 100%; width: 100%; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:"+s+"; }@media print{ body { margin: 0cm; size:"+s+"; }}</style></head> <body><center>")):-1!==t.indexOf("Firefox")?(i.document.write("<!DOCTYPE html>"),i.document.write("<html moznomarginboxes mozdisallowselectionprint><head><title>"+e.owner.documentName+"</title><style>html, body { height: 100%; } img { height: 100%; width: 100%; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:"+s+"; }@media print{ body { margin: 0cm; size:"+s+"; }}</style></head> <body><center>")):i.document.write("<html><head><title>"+e.owner.documentName+"</title><style>@page{margin:0;size:"+s+";}</style></head><body><center>"),i.document.write(o.innerHTML+"</center><script> (function() { window.ready = true; })(); <\/script></body></html>"),o=void 0,i.document.close(),i.focus(),window.addEventListener("beforeunload",this.closePrintWindow),Number(setInterval(function(){i.ready&&(i.print(),i.close(),clearInterval(a))},500)))},Ra.prototype.exportAsImage=function(e,t,i){var n,r,o;return!_.isNullOrUndefined(t)&&t<=e.pages.length&&1<=t&&(r=(t=e.pages[t-1]).boundingRectangle.height,o=t.boundingRectangle.width,e.render.isPrinting=!0,e.render.renderWidgets(t,0,0,0,0),t=e.render.pageCanvas.toDataURL(i,1),e.render.isPrinting=!1,(n=new Image).src=t,n.setAttribute("style","margin:0px;display:block;width:"+o.toString()+"px;height:"+r.toString()+"px;")),n},Ra.prototype.generatePrintContent=function(e,t){for(var i="",n=0;n<e.pages.length;n++){var r=e.pages[n],o=r.boundingRectangle.height,s=r.boundingRectangle.width,r=(e.render.isPrinting=!0,e.render.renderWidgets(r,0,0,s,0),e.render.pageCanvas.toDataURL()),a=(e.render.isPrinting=!1,n==e.pages.length-1?"":"<br/>");i+="<div><img src="+r+' style="margin:0px;display:block;width: '+s.toString()+"px; height:"+o.toString()+'px; "/></div>'+a}t.innerHTML=i},Ra.prototype.getPageWidth=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.width&&(t=e[i].boundingRectangle.width);return t},Ra.prototype.getPageHeight=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.height&&(t=e[i].boundingRectangle.height);return t},Ra.prototype.destroy=function(){window.removeEventListener("beforeunload",this.closePrintWindow),this.windowPrint=void 0},Ra);function Ra(){var e=this;this.windowPrint=void 0,this.closePrintWindow=function(){e.windowPrint&&!e.windowPrint.closed&&e.windowPrint.close()}}Object.defineProperty(Aa.prototype,"headerDistance",{get:function(){return this.getPropertyValue("headerDistance")},set:function(e){this.setPropertyValue("headerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"footerDistance",{get:function(){return this.getPropertyValue("footerDistance")},set:function(e){this.setPropertyValue("footerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"differentFirstPage",{get:function(){return this.getPropertyValue("differentFirstPage")},set:function(e){this.setPropertyValue("differentFirstPage",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"differentOddAndEvenPages",{get:function(){return this.getPropertyValue("differentOddAndEvenPages")},set:function(e){this.setPropertyValue("differentOddAndEvenPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"pageHeight",{get:function(){return this.getPropertyValue("pageHeight")},set:function(e){this.setPropertyValue("pageHeight",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"pageWidth",{get:function(){return this.getPropertyValue("pageWidth")},set:function(e){this.setPropertyValue("pageWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"restartPageNumbering",{get:function(){return this.getPropertyValue("restartPageNumbering")},set:function(e){this.setPropertyValue("restartPageNumbering",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"pageStartingNumber",{get:function(){return this.getPropertyValue("pageStartingNumber")},set:function(e){this.setPropertyValue("pageStartingNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"endnoteNumberFormat",{get:function(){return this.getPropertyValue("endnoteNumberFormat")},set:function(e){this.setPropertyValue("endnoteNumberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"restartIndexForEndnotes",{get:function(){return this.getPropertyValue("restartIndexForEndnotes")},set:function(e){this.setPropertyValue("restartIndexForEndnotes",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"restartIndexForFootnotes",{get:function(){return this.getPropertyValue("restartIndexForFootnotes")},set:function(e){this.setPropertyValue("restartIndexForFootnotes",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"footNoteNumberFormat",{get:function(){return this.getPropertyValue("footNoteNumberFormat")},set:function(e){this.setPropertyValue("footNoteNumberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"initialFootNoteNumber",{get:function(){return this.getPropertyValue("initialFootNoteNumber")},set:function(e){this.setPropertyValue("initialFootNoteNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"initialEndNoteNumber",{get:function(){return this.getPropertyValue("initialEndNoteNumber")},set:function(e){this.setPropertyValue("initialEndNoteNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"pageNumberStyle",{get:function(){return this.getPropertyValue("pageNumberStyle")},set:function(e){this.setPropertyValue("pageNumberStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"numberOfColumns",{get:function(){return this.getPropertyValue("numberOfColumns")},set:function(e){this.setPropertyValue("numberOfColumns",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"equalWidth",{get:function(){return this.getPropertyValue("equalWidth")},set:function(e){this.setPropertyValue("equalWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"lineBetweenColumns",{get:function(){return this.getPropertyValue("lineBetweenColumns")},set:function(e){this.setPropertyValue("lineBetweenColumns",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"breakCode",{get:function(){return this.getPropertyValue("breakCode")},set:function(e){this.setPropertyValue("breakCode",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"firstPageHeader",{get:function(){return this.getPropertyValue("firstPageHeader")},set:function(e){this.setPropertyValue("firstPageHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"firstPageFooter",{get:function(){return this.getPropertyValue("firstPageFooter")},set:function(e){this.setPropertyValue("firstPageFooter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"oddPageHeader",{get:function(){return this.getPropertyValue("oddPageHeader")},set:function(e){this.setPropertyValue("oddPageHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"oddPageFooter",{get:function(){return this.getPropertyValue("oddPageFooter")},set:function(e){this.setPropertyValue("oddPageFooter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"evenPageHeader",{get:function(){return this.getPropertyValue("evenPageHeader")},set:function(e){this.setPropertyValue("evenPageHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Aa.prototype,"evenPageFooter",{get:function(){return this.getPropertyValue("evenPageFooter")},set:function(e){this.setPropertyValue("evenPageFooter",e)},enumerable:!0,configurable:!0}),Aa.prototype.destroy=function(){_.isNullOrUndefined(this.uniqueSectionFormat)||Aa.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0,this.ownerBase=void 0,this.columns=void 0,this.removedHeaderFooters=void 0},Aa.prototype.hasValue=function(e){return!_.isNullOrUndefined(this.uniqueSectionFormat)&&(e=O.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,e),this.uniqueSectionFormat.propertiesHash.containsKey(e))},Aa.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"headerDistance":case"footerDistance":t=36;break;case"differentFirstPage":case"differentOddAndEvenPages":t=!1;break;case"pageWidth":t=612;break;case"pageHeight":t=792;break;case"leftMargin":case"topMargin":case"rightMargin":case"bottomMargin":t=72;break;case"bidi":case"restartPageNumbering":t=!1;break;case"pageStartingNumber":t=1;break;case"footnotePosition":t="PrintAtBottomOfPage";break;case"endnoteNumberFormat":t="LowerCaseRoman";break;case"endnotePosition":t="DisplayEndOfDocument";break;case"restartIndexForEndnotes":case"restartIndexForFootnotes":t="DoNotRestart";break;case"footNoteNumberFormat":t="Arabic";break;case"initialFootNoteNumber":case"initialEndNoteNumber":t=1;break;case"pageNumberStyle":t="Arabic";break;case"numberOfColumns":t=1;break;case"equalWidth":t=!0;break;case"lineBetweenColumns":t=!1;break;case"breakCode":t="NewPage";break;case"firstPageHeader":case"firstPageFooter":case"oddPageHeader":case"oddPageFooter":case"evenPageHeader":case"evenPageFooter":t=void 0}return t},Aa.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var t=O.getPropertyType(Aa.uniqueFormatType,e);if(!_.isNullOrUndefined(this.uniqueSectionFormat)&&this.uniqueSectionFormat.propertiesHash.containsKey(t))return this.uniqueSectionFormat.propertiesHash.get(t)}return Aa.getPropertyDefaultValue(e)},Aa.prototype.setPropertyValue=function(e,t){var i;!_.isNullOrUndefined(t)&&""!==t||(t=Aa.getPropertyDefaultValue(e)),_.isNullOrUndefined(this.uniqueSectionFormat)?this.initializeUniqueSectionFormat(e,t):(i=O.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,e),this.uniqueSectionFormat.propertiesHash.containsKey(i)&&this.uniqueSectionFormat.propertiesHash.get(i)===t||(this.uniqueSectionFormat=Aa.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat,e,t)))},Aa.prototype.initializeUniqueSectionFormat=function(e,t){var i=new T;this.addUniqueSectionFormat("headerDistance",e,t,i),this.addUniqueSectionFormat("footerDistance",e,t,i),this.addUniqueSectionFormat("differentFirstPage",e,t,i),this.addUniqueSectionFormat("differentOddAndEvenPages",e,t,i),this.addUniqueSectionFormat("pageWidth",e,t,i),this.addUniqueSectionFormat("pageHeight",e,t,i),this.addUniqueSectionFormat("leftMargin",e,t,i),this.addUniqueSectionFormat("topMargin",e,t,i),this.addUniqueSectionFormat("rightMargin",e,t,i),this.addUniqueSectionFormat("bottomMargin",e,t,i),this.addUniqueSectionFormat("bidi",e,t,i),this.addUniqueSectionFormat("restartPageNumbering",e,t,i),this.addUniqueSectionFormat("pageStartingNumber",e,t,i),this.addUniqueSectionFormat("endnoteNumberFormat",e,t,i),this.addUniqueSectionFormat("endnotePosition",e,t,i),this.addUniqueSectionFormat("footNoteNumberFormat",e,t,i),this.addUniqueSectionFormat("footnotePosition",e,t,i),this.addUniqueSectionFormat("restartIndexForEndnotes",e,t,i),this.addUniqueSectionFormat("restartIndexForFootnotes",e,t,i),this.addUniqueSectionFormat("initialFootNoteNumber",e,t,i),this.addUniqueSectionFormat("initialEndNoteNumber",e,t,i),this.addUniqueSectionFormat("pageNumberStyle",e,t,i),this.addUniqueSectionFormat("numberOfColumns",e,t,i),this.addUniqueSectionFormat("equalWidth",e,t,i),this.addUniqueSectionFormat("lineBetweenColumns",e,t,i),this.addUniqueSectionFormat("breakCode",e,t,i),this.uniqueSectionFormat=Aa.uniqueSectionFormats.addUniqueFormat(i,Aa.uniqueFormatType)},Aa.prototype.addUniqueSectionFormat=function(e,t,i,n){var r=O.getPropertyType(Aa.uniqueFormatType,e);e===t?n.add(r,i):n.add(r,Aa.getPropertyDefaultValue(e))},Aa.prototype.copyFormat=function(e,t){t&&(t.isUndoing||t.isRedoing)?(this.uniqueSectionFormat=e.uniqueSectionFormat,this.columns=e.columns,this.removedHeaderFooters=e.removedHeaderFooters):_.isNullOrUndefined(e)||(this.removedHeaderFooters=e.removedHeaderFooters,!_.isNullOrUndefined(e.uniqueSectionFormat)&&e.uniqueSectionFormat.propertiesHash&&(this.updateUniqueSectionFormat(e),this.columns=e.columns))},Aa.prototype.updateUniqueSectionFormat=function(e){var t=void 0;this.uniqueSectionFormat&&(t=this.uniqueSectionFormat.mergeProperties(e.uniqueSectionFormat),0===this.uniqueSectionFormat.referenceCount)&&(Aa.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0),this.uniqueSectionFormat=new O(Aa.uniqueFormatType),_.isNullOrUndefined(t)&&(t=this.uniqueSectionFormat.mergeProperties(e.uniqueSectionFormat)),this.uniqueSectionFormat=Aa.uniqueSectionFormats.addUniqueFormat(t,Aa.uniqueFormatType)},Aa.prototype.cloneFormat=function(){var e=new Aa;return e.uniqueSectionFormat=this.uniqueSectionFormat,e.columns=this.columns,e},Aa.clear=function(){this.uniqueSectionFormats.clear()},Aa.uniqueSectionFormats=new e,Aa.uniqueFormatType=10;var Ma=Aa;function Aa(e){this.uniqueSectionFormat=void 0,this.columns=[],this.ownerBase=e,this.columns=[],this.removedHeaderFooters=[]}Ua.prototype.destroy=function(){_.isNullOrUndefined(this.uniqueColumnFormat)||Ua.uniqueColumnFormats.remove(this.uniqueColumnFormat),this.uniqueColumnFormat=void 0,this.ownerBase=void 0},Ua.prototype.hasValue=function(e){return!_.isNullOrUndefined(this.uniqueColumnFormat)&&(e=O.getPropertyType(this.uniqueColumnFormat.uniqueFormatType,e),this.uniqueColumnFormat.propertiesHash.containsKey(e))},Object.defineProperty(Ua.prototype,"index",{get:function(){return this.indexIn},set:function(e){this.indexIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Ua.prototype,"width",{get:function(){return this.getPropertyValue("width")},set:function(e){this.setPropertyValue("width",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ua.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(e){this.setPropertyValue("space",e)},enumerable:!0,configurable:!0}),Ua.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var t=O.getPropertyType(Ua.uniqueFormatType,e);if(!_.isNullOrUndefined(this.uniqueColumnFormat)&&this.uniqueColumnFormat.propertiesHash.containsKey(t))return this.uniqueColumnFormat.propertiesHash.get(t)}return Ua.getPropertyDefaultValue(e)},Ua.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"width":t=36;break;case"space":t=0}return t},Ua.prototype.setPropertyValue=function(e,t){var i;!_.isNullOrUndefined(t)&&""!==t||(t=Ua.getPropertyDefaultValue(e)),_.isNullOrUndefined(this.uniqueColumnFormat)?this.initializeUniqueColumnFormat(e,t):(i=O.getPropertyType(this.uniqueColumnFormat.uniqueFormatType,e),this.uniqueColumnFormat.propertiesHash.containsKey(i)&&this.uniqueColumnFormat.propertiesHash.get(i)===t||(this.uniqueColumnFormat=Ua.uniqueColumnFormats.updateUniqueFormat(this.uniqueColumnFormat,e,t)))},Ua.prototype.initializeUniqueColumnFormat=function(e,t){var i=new T;this.addUniqueColumnFormat("width",e,t,i),this.addUniqueColumnFormat("space",e,t,i),this.uniqueColumnFormat=Ua.uniqueColumnFormats.addUniqueFormat(i,Ua.uniqueFormatType)},Ua.prototype.addUniqueColumnFormat=function(e,t,i,n){var r=O.getPropertyType(Ua.uniqueFormatType,e);e===t?n.add(r,i):n.add(r,Ua.getPropertyDefaultValue(e))},Ua.prototype.updateUniqueColumnFormat=function(e){var t=void 0;this.uniqueColumnFormat&&(t=this.uniqueColumnFormat.mergeProperties(e.uniqueColumnFormat),0===this.uniqueColumnFormat.referenceCount)&&(Ua.uniqueColumnFormats.remove(this.uniqueColumnFormat),this.uniqueColumnFormat=void 0),this.uniqueColumnFormat=new O(Ua.uniqueFormatType),_.isNullOrUndefined(t)&&(t=this.uniqueColumnFormat.mergeProperties(e.uniqueColumnFormat)),this.uniqueColumnFormat=Ua.uniqueColumnFormats.addUniqueFormat(t,Ua.uniqueFormatType)},Ua.prototype.cloneFormat=function(){var e=new Ua(void 0);return e.width=this.width,e.space=this.space,e},Ua.prototype.copyFormat=function(e){_.isNullOrUndefined(e)||_.isNullOrUndefined(e.uniqueColumnFormat)||(this.width=e.width,this.space=e.space)},Ua.clear=function(){this.uniqueColumnFormats.clear()},Ua.uniqueColumnFormats=new e,Ua.uniqueFormatType=11;var Da=Ua;function Ua(e){this.uniqueColumnFormat=void 0,this.ownerBase=e}Object.defineProperty(za.prototype,"color",{get:function(){return this.getPropertyValue("color")},set:function(e){this.setPropertyValue("color",e)},enumerable:!0,configurable:!0}),Object.defineProperty(za.prototype,"lineStyle",{get:function(){return this.getPropertyValue("lineStyle")},set:function(e){this.setPropertyValue("lineStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(za.prototype,"lineWidth",{get:function(){return this.getPropertyValue("lineWidth")},set:function(e){this.setPropertyValue("lineWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(za.prototype,"shadow",{get:function(){return this.getPropertyValue("shadow")},set:function(e){this.setPropertyValue("shadow",e)},enumerable:!0,configurable:!0}),Object.defineProperty(za.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(e){this.setPropertyValue("space",e)},enumerable:!0,configurable:!0}),Object.defineProperty(za.prototype,"hasNoneStyle",{get:function(){return this.getPropertyValue("hasNoneStyle")},set:function(e){this.setPropertyValue("hasNoneStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(za.prototype,"isBorderDefined",{get:function(){return"None"!==this.lineStyle||this.hasNoneStyle&&this.hasValue("hasNoneStyle")},enumerable:!0,configurable:!0}),za.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var t=O.getPropertyType(za.uniqueFormatType,e);if(!_.isNullOrUndefined(this.uniqueBorderFormat)){t=this.uniqueBorderFormat.propertiesHash.get(t);if(!_.isNullOrUndefined(t))return t}}return za.getPropertyDefaultValue(e)},za.prototype.setPropertyValue=function(e,t){var i;!_.isNullOrUndefined(t)&&""!==t||(t=za.getPropertyDefaultValue(e)),_.isNullOrUndefined(this.uniqueBorderFormat)?this.initializeUniqueBorder(e,t):(i=O.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,e),this.uniqueBorderFormat.propertiesHash.containsKey(i)&&this.uniqueBorderFormat.propertiesHash.get(i)===t||(this.uniqueBorderFormat=za.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat,e,t)))},za.prototype.initializeUniqueBorder=function(e,t){var i=new T;this.addUniqueBorderFormat("color",e,t,i),this.addUniqueBorderFormat("lineStyle",e,t,i),this.addUniqueBorderFormat("lineWidth",e,t,i),this.addUniqueBorderFormat("shadow",e,t,i),this.addUniqueBorderFormat("space",e,t,i),this.addUniqueBorderFormat("hasNoneStyle",e,t,i),this.uniqueBorderFormat=za.uniqueBorderFormats.addUniqueFormat(i,za.uniqueFormatType)},za.prototype.addUniqueBorderFormat=function(e,t,i,n){var r=O.getPropertyType(za.uniqueFormatType,e);e===t&&n.add(r,i)},za.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"color":t="#000000";break;case"lineStyle":t="None";break;case"lineWidth":t=0;break;case"shadow":t=!1;break;case"space":t=0;break;case"hasNoneStyle":t=!1}return t},za.prototype.getLineWidth=function(){switch(this.lineStyle){case"None":case"Cleared":return 0;case"Triple":case"Double":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"Emboss3D":case"Engrave3D":for(var e=this.getBorderLineWidthArray(this.lineStyle,this.lineWidth),t=0,i=0;i<e.length;i++)t+=e[i];return t;case"Single":case"DashLargeGap":case"DashSmallGap":case"Dot":case"DashDot":case"DashDotDot":case"Thick":return.5<=this.lineWidth?this.lineWidth:.5;case"SingleWavy":return 1.5===this.lineWidth?3:2.5;case"DoubleWavy":return 6.75;case"DashDotStroked":case"Outset":return.5<=this.lineWidth?this.lineWidth:.5}return.5<=this.lineWidth?this.lineWidth:.5},za.prototype.getBorderLineWidthArray=function(e,t){var i=[t];switch(e){case"Double":i=[1,1,1];break;case"ThinThickSmallGap":i=[1,-.75,-.75];break;case"ThickThinSmallGap":i=[-.75,-.75,1];break;case"ThinThickMediumGap":i=[1,.5,.5];break;case"ThickThinMediumGap":i=[.5,.5,1];break;case"ThinThickLargeGap":i=[-1.5,1,-.75];break;case"ThickThinLargeGap":i=[-.75,1,-1.5];break;case"Triple":i=[1,1,1,1,1];break;case"ThinThickThinSmallGap":i=[-.75,-.75,1,-.75,-.75];break;case"ThinThickThinMediumGap":i=[.5,.5,1,.5,.5];break;case"ThinThickThinLargeGap":i=[-.75,1,-1.5,1,-.75];break;case"Emboss3D":case"Engrave3D":i=[.25,0,1,0,.25]}if(1===i.length)return[t];for(var n=0;n<i.length;n++)0<=i[parseInt(n.toString(),10)]?i[parseInt(n.toString(),10)]=i[parseInt(n.toString(),10)]*t:i[parseInt(n.toString(),10)]=Math.abs(i[parseInt(n.toString(),10)]);return i},za.prototype.getBorderWeight=function(){var e=0,t=(this.getNumberOfLines(),this.getBorderNumber());switch(this.lineStyle){case"Single":case"DashSmallGap":case"DashDot":case"DashDotDot":case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"SingleWavy":case"DoubleWavy":case"DashDotStroked":case"Emboss3D":case"Engrave3D":case"Outset":case"Inset":case"Thick":e=this.lineWidth*t;break;case"Dot":case"DashLargeGap":e=1}return e},za.prototype.getBorderNumber=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},za.prototype.getNumberOfLines=function(){var e=0;switch(this.lineStyle){case"Single":case"Dot":case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":e=1;break;case"Double":e=3;break;case"Triple":e=5;break;case"ThinThickSmallGap":case"ThickThinSmallGap":e=3;break;case"ThinThickThinSmallGap":e=5;break;case"ThinThickMediumGap":case"ThickThinMediumGap":e=3;break;case"ThinThickThinMediumGap":e=5;break;case"ThinThickLargeGap":case"ThickThinLargeGap":e=3;break;case"ThinThickThinLargeGap":e=5;break;case"SingleWavy":e=1;break;case"DoubleWavy":e=2;break;case"DashDotStroked":e=1;break;case"Emboss3D":case"Engrave3D":e=3;break;case"Outset":case"Inset":case"Thick":e=1}return e},za.prototype.getPrecedence=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},za.prototype.hasValues=function(){return this.hasValue("color")||this.hasValue("lineStyle")||this.hasValue("lineWidth")||this.hasValue("shadow")||this.hasValue("space")||this.hasValue("hasNoneStyle")},za.prototype.hasValue=function(e){return!_.isNullOrUndefined(this.uniqueBorderFormat)&&(e=O.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,e),this.uniqueBorderFormat.propertiesHash.containsKey(e))},za.prototype.cloneFormat=function(){var e=new za(void 0);return e.color=this.color,e.lineStyle=this.lineStyle,e.lineWidth=this.lineWidth,e.shadow=this.shadow,e.space=this.space,e},za.prototype.clearFormat=function(){_.isNullOrUndefined(this.uniqueBorderFormat)||za.uniqueBorderFormats.remove(this.uniqueBorderFormat),this.uniqueBorderFormat=void 0},za.prototype.destroy=function(){this.clearFormat(),this.ownerBase=void 0},za.prototype.isEqualFormat=function(e){var t=!1;return t=this.color===e.color&&this.lineStyle===e.lineStyle&&this.lineWidth===e.lineWidth&&this.shadow===e.shadow&&this.space===e.space?!0:t},za.prototype.copyFormat=function(e){_.isNullOrUndefined(e)||_.isNullOrUndefined(e.uniqueBorderFormat)||(e.hasValue("color")&&(this.color=e.color),e.hasValue("lineStyle")&&(this.lineStyle=e.lineStyle),e.hasValue("lineWidth")&&(this.lineWidth=e.lineWidth),e.hasValue("shadow")&&(this.shadow=e.shadow),e.hasValue("space")&&(this.space=e.space),e.hasValue("hasNoneStyle")&&(this.hasNoneStyle=e.hasNoneStyle))},za.clear=function(){this.uniqueBorderFormats.clear()},za.uniqueBorderFormats=new e,za.uniqueFormatType=1;var Va=za;function za(e){this.uniqueBorderFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}Object.defineProperty(_a.prototype,"left",{get:function(){return this.ownerBase instanceof Xa?this.getPropertyValue("left"):this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(_a.prototype,"right",{get:function(){return this.ownerBase instanceof Xa?this.getPropertyValue("right"):this.rightIn},set:function(e){this.rightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(_a.prototype,"top",{get:function(){return this.ownerBase instanceof Xa?this.getPropertyValue("top"):this.topIn},set:function(e){this.topIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(_a.prototype,"bottom",{get:function(){return this.ownerBase instanceof Xa?this.getPropertyValue("bottom"):this.bottomIn},set:function(e){this.bottomIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(_a.prototype,"horizontal",{get:function(){return this.ownerBase instanceof Xa?this.getPropertyValue("horizontal"):this.horizontalIn},set:function(e){this.horizontalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(_a.prototype,"vertical",{get:function(){return this.ownerBase instanceof Xa?this.getPropertyValue("vertical"):this.verticalIn},set:function(e){this.verticalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(_a.prototype,"diagonalUp",{get:function(){return this.diagonalUpIn},set:function(e){this.diagonalUpIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(_a.prototype,"diagonalDown",{get:function(){return this.diagonalDownIn},set:function(e){this.diagonalDownIn=e},enumerable:!0,configurable:!0}),_a.prototype.getPropertyValue=function(e){var t=this.getBorder(e);if(this.isParsing)return t;if(t.hasValues())return t;var i=this.ownerBase.baseStyle;if(!_.isNullOrUndefined(i)){for(var n=this;!_.isNullOrUndefined(i);){var r=void 0;if(this.ownerBase.listFormat.hasValue("listId")||(r=i.paragraphFormat.getListPargaraphFormat(e)),i.paragraphFormat.borders.getBorder(e).hasValues()){n=i.paragraphFormat.borders;break}if(!_.isNullOrUndefined(r)&&r.borders.getBorder(e).hasValues()){n=r.borders;break}i=i.basedOn}if(!_.isNullOrUndefined(i))return n.getBorder(e)}return this.getDefaultValue(e)},_a.prototype.getDefaultValue=function(e){var t,i=this.documentParagraphFormat();return t=_.isNullOrUndefined(i)||_.isNullOrUndefined(i.borders)?t:i.borders.getBorder(e)},_a.prototype.documentParagraphFormat=function(){var e;return e=this.ownerBase instanceof Xa?this.ownerBase.getDocumentParagraphFormat():e},_a.prototype.getBorder=function(e){switch(e){case"left":return this.leftIn;case"right":return this.rightIn;case"top":return this.topIn;case"bottom":return this.bottomIn;case"vertical":return this.verticalIn;case"horizontal":return this.horizontalIn}},_a.prototype.clearFormat=function(){_.isNullOrUndefined(this.leftIn)||this.leftIn.clearFormat(),_.isNullOrUndefined(this.topIn)||this.topIn.clearFormat(),_.isNullOrUndefined(this.bottomIn)||this.bottomIn.clearFormat(),_.isNullOrUndefined(this.rightIn)||this.rightIn.clearFormat(),_.isNullOrUndefined(this.horizontalIn)||this.horizontalIn.clearFormat(),_.isNullOrUndefined(this.verticalIn)||this.verticalIn.clearFormat(),_.isNullOrUndefined(this.diagonalDown)||this.diagonalDown.clearFormat(),_.isNullOrUndefined(this.diagonalUp)||this.diagonalUp.clearFormat()},_a.prototype.destroy=function(){_.isNullOrUndefined(this.leftIn)||this.leftIn.destroy(),_.isNullOrUndefined(this.topIn)||this.topIn.destroy(),_.isNullOrUndefined(this.bottomIn)||this.bottomIn.destroy(),_.isNullOrUndefined(this.rightIn)||this.rightIn.destroy(),_.isNullOrUndefined(this.horizontalIn)||this.horizontalIn.destroy(),_.isNullOrUndefined(this.verticalIn)||this.verticalIn.destroy(),_.isNullOrUndefined(this.diagonalDown)||this.diagonalDown.destroy(),_.isNullOrUndefined(this.diagonalUp)||this.diagonalUp.destroy(),this.topIn=void 0,this.bottomIn=void 0,this.leftIn=void 0,this.rightIn=void 0,this.horizontalIn=void 0,this.verticalIn=void 0,this.diagonalDownIn=void 0,this.diagonalUpIn=void 0,this.ownerBase=void 0},_a.prototype.cloneFormat=function(){var e=new _a(void 0);return e.top=_.isNullOrUndefined(this.topIn)?void 0:this.topIn.cloneFormat(),e.bottom=_.isNullOrUndefined(this.bottomIn)?void 0:this.bottomIn.cloneFormat(),e.left=_.isNullOrUndefined(this.leftIn)?void 0:this.leftIn.cloneFormat(),e.right=_.isNullOrUndefined(this.rightIn)?void 0:this.rightIn.cloneFormat(),e.horizontal=_.isNullOrUndefined(this.horizontalIn)?void 0:this.horizontalIn.cloneFormat(),e.vertical=_.isNullOrUndefined(this.verticalIn)?void 0:this.verticalIn.cloneFormat(),e.diagonalUp=_.isNullOrUndefined(this.diagonalUp)?void 0:this.diagonalUp.cloneFormat(),e.diagonalDown=_.isNullOrUndefined(this.diagonalDown)?void 0:this.diagonalDown.cloneFormat(),e},_a.prototype.copyFormat=function(e){var t;!_.isNullOrUndefined(e.getBorder("left"))&&e.getBorder("left")instanceof Va&&((t=new Va(this)).copyFormat(e.getBorder("left")),this.left=t),!_.isNullOrUndefined(e.getBorder("right"))&&e.getBorder("right")instanceof Va&&((t=new Va(this)).copyFormat(e.getBorder("right")),this.right=t),!_.isNullOrUndefined(e.getBorder("top"))&&e.getBorder("top")instanceof Va&&((t=new Va(this)).copyFormat(e.getBorder("top")),this.top=t),!_.isNullOrUndefined(e.getBorder("bottom"))&&e.getBorder("bottom")instanceof Va&&((t=new Va(this)).copyFormat(e.getBorder("bottom")),this.bottom=t),!_.isNullOrUndefined(e.getBorder("horizontal"))&&e.getBorder("horizontal")instanceof Va&&((t=new Va(this)).copyFormat(e.getBorder("horizontal")),this.horizontal=t),!_.isNullOrUndefined(e.getBorder("vertical"))&&e.getBorder("vertical")instanceof Va&&((t=new Va(this)).copyFormat(e.getBorder("vertical")),this.vertical=t),!_.isNullOrUndefined(e.diagonalDown)&&e.diagonalDown instanceof Va&&(this.diagonalDown=new Va(this),this.diagonalDown.copyFormat(e.diagonalDown)),!_.isNullOrUndefined(e.diagonalUp)&&e.diagonalUp instanceof Va&&(this.diagonalUp=new Va(this),this.diagonalUp.copyFormat(e.diagonalUp))};var qa=_a;function _a(e){this.leftIn=new Va(this),this.rightIn=new Va(this),this.topIn=new Va(this),this.bottomIn=new Va(this),this.horizontalIn=new Va(this),this.verticalIn=new Va(this),this.diagonalUpIn=new Va(this),this.diagonalDownIn=new Va(this),this.isParsing=!1,this.ownerBase=e}Object.defineProperty(Ga.prototype,"nsid",{get:function(){return this.getPropertyValue("nsid")},set:function(e){this.setPropertyValue("nsid",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ga.prototype,"listId",{get:function(){return this.getPropertyValue("listId")},set:function(e){var t;0<=e?_.isNullOrUndefined(this.ownerBase)||(t=this.ownerBase.getDocumentHelperObject(),_.isNullOrUndefined(t))||(this.list=t.getListById(e)):!_.isNullOrUndefined(this.list)&&e<0&&(this.list=void 0),this.setPropertyValue("listId",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ga.prototype,"listLevelNumber",{get:function(){return this.getPropertyValue("listLevelNumber")},set:function(e){this.setPropertyValue("listLevelNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ga.prototype,"listLevel",{get:function(){var e=void 0;if(_.isNullOrUndefined(this.list))for(var t=this.baseStyle;!_.isNullOrUndefined(t)&&t instanceof ul;){if(t.paragraphFormat.listFormat.list){e=t.paragraphFormat.listFormat.list;break}t=t.basedOn}else e=this.list;if(!_.isNullOrUndefined(e))return e.getListLevel(this.listLevelNumber)},enumerable:!0,configurable:!0}),Ga.prototype.getPropertyValue=function(e){if(this.hasValue(e)){t=O.getPropertyType(Ga.uniqueFormatType,e);if(!_.isNullOrUndefined(this.uniqueListFormat)&&this.uniqueListFormat.propertiesHash.containsKey(t))return this.uniqueListFormat.propertiesHash.get(t)}else if(this.baseStyle instanceof ul){for(var t,i=this.baseStyle;!_.isNullOrUndefined(i)&&!i.paragraphFormat.listFormat.hasValue(e);)i=i.basedOn;if(!_.isNullOrUndefined(i))return t=O.getPropertyType(Ga.uniqueFormatType,e),i.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(t)}return Ga.getPropertyDefaultValue(e)},Ga.prototype.setPropertyValue=function(e,t){var i;!_.isNullOrUndefined(t)&&""!==t||(t=Ga.getPropertyDefaultValue(e)),_.isNullOrUndefined(this.uniqueListFormat)?this.initializeUniqueListFormat(e,t):(i=O.getPropertyType(this.uniqueListFormat.uniqueFormatType,e),this.uniqueListFormat.propertiesHash.containsKey(i)&&this.uniqueListFormat.propertiesHash.get(i)===t||(this.uniqueListFormat=Ga.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat,e,t)))},Ga.prototype.initializeUniqueListFormat=function(e,t){var i=new T;this.addUniqueListFormat("listId",e,t,i),this.addUniqueListFormat("listLevelNumber",e,t,i),this.addUniqueListFormat("nsid",e,t,i),this.uniqueListFormat=Ga.uniqueListFormats.addUniqueFormat(i,Ga.uniqueFormatType)},Ga.prototype.addUniqueListFormat=function(e,t,i,n){var r=O.getPropertyType(Ga.uniqueFormatType,e);e===t&&n.add(r,i)},Ga.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listId":t=-1;break;case"listLevelNumber":t=0;break;case"nsid":t=-1}return t},Ga.prototype.copyFormat=function(e){_.isNullOrUndefined(e)||(_.isNullOrUndefined(e.uniqueListFormat)||(this.listId=e.listId,this.listLevelNumber=e.listLevelNumber,this.nsid=e.nsid),_.isNullOrUndefined(e.baseStyle)||(this.baseStyle=e.baseStyle),_.isNullOrUndefined(e.list))||(this.list=e.list)},Ga.prototype.hasValue=function(e){return!_.isNullOrUndefined(this.uniqueListFormat)&&(e=O.getPropertyType(this.uniqueListFormat.uniqueFormatType,e),this.uniqueListFormat.propertiesHash.containsKey(e))},Ga.prototype.clearFormat=function(){_.isNullOrUndefined(this.uniqueListFormat)||0!==this.uniqueListFormat.referenceCount||Ga.uniqueListFormats.remove(this.uniqueListFormat),this.uniqueListFormat=void 0,this.list=void 0},Ga.prototype.destroy=function(){_.isNullOrUndefined(this.uniqueListFormat)||Ga.uniqueListFormats.remove(this.uniqueListFormat),this.uniqueListFormat=void 0,this.list=void 0,this.ownerBase=void 0,this.baseStyle=void 0},Ga.clear=function(){this.uniqueListFormats.clear()},Ga.prototype.applyStyle=function(e){this.baseStyle=e},Ga.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},Ga.prototype.cloneListFormat=function(){var e=new Ga(void 0);return e.list=this.list,e.listId=this.listId,e.nsid=this.nsid,e.baseStyle=this.baseStyle,e.listLevelNumber=this.listLevelNumber,e.uniqueListFormat=this.uniqueListFormat,e},Ga.uniqueListFormats=new e,Ga.uniqueFormatType=7;var ja=Ga;function Ga(e){this.uniqueListFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.list=void 0,this.ownerBase=e}Object.defineProperty(Za.prototype,"position",{get:function(){return this.positionIn},set:function(e){this.positionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Za.prototype,"deletePosition",{get:function(){return this.deletePositionIn},set:function(e){this.deletePositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Za.prototype,"tabJustification",{get:function(){return this.justification},set:function(e){this.justification=e},enumerable:!0,configurable:!0}),Object.defineProperty(Za.prototype,"tabLeader",{get:function(){return this.leader},set:function(e){this.leader=e},enumerable:!0,configurable:!0}),Za.prototype.clone=function(){var e=new Za;return e.deletePosition=this.deletePosition,e.position=this.position,e.tabJustification=this.tabJustification,e.tabLeader=this.tabLeader,e},Za.prototype.equals=function(e){return this.position===e.position&&this.deletePosition===e.deletePosition&&this.tabJustification===e.tabJustification&&this.tabLeader===e.tabLeader},Za.prototype.destroy=function(){this.position=void 0,this.deletePosition=void 0,this.tabJustification=void 0,this.leader=void 0};var Ka=Za;function Za(){}Ja.prototype.getUpdatedTabs=function(){for(var e=[],t=new T,i=0,n=this.getTabStopsFromListFormat();i<n.length;i++){var r=n[i];t.containsKey(r.position)||t.add(r.position,r)}if(!_.isNullOrUndefined(this.baseStyle)&&this.baseStyle instanceof ul){for(var o=this.baseStyle;!_.isNullOrUndefined(o);){for(var s=0,a=o.paragraphFormat.tabs;s<a.length;s++){var l=a[s];t.containsKey(l.position)||t.add(l.position,l)}o=o.basedOn}var d=[];t.keys.forEach(function(e){d.push(t.get(e))});for(var h=0;h<d.length;h++){r=d[h];this.isValidTabStop(d,r)||t.remove(r.position)}for(var c=0,p=t.keys;c<p.length;c++){var u=p[c];this.hasTabStop(parseFloat(u.toFixed(4)))||e.push(t.get(u))}}return e=(e=e.concat(this.tabs.filter(function(e){return 0!==e.position&&0===e.deletePosition}))).sort(function(e,t){return e.position-t.position})},Ja.prototype.getTabStopsFromListFormat=function(){if(-1<this.listFormat.listId&&-1<this.listFormat.listLevelNumber){var e=this.listFormat.listLevel;if(e&&e.paragraphFormat)return e.paragraphFormat.tabs}return[]},Ja.prototype.isValidTabStop=function(e,t){for(var i=0;i<e.length;i++)if(t!=e[i]&&(parseFloat(e[i].position.toFixed(4))===parseFloat(t.position.toFixed(4))||parseFloat(e[i].deletePosition.toFixed(4))===parseFloat(t.position.toFixed(4))))return!1;return!0},Ja.prototype.hasTabStop=function(e){for(var t=0;t<this.tabs.length;t++)if(parseFloat(this.tabs[t].position.toFixed(4))===e||parseFloat(this.tabs[t].deletePosition.toFixed(4))===e)return!0;return!1},Object.defineProperty(Ja.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"rightIndent",{get:function(){return this.getPropertyValue("rightIndent")},set:function(e){this.setPropertyValue("rightIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"firstLineIndent",{get:function(){return this.getPropertyValue("firstLineIndent")},set:function(e){this.setPropertyValue("firstLineIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"beforeSpacing",{get:function(){return this.getPropertyValue("beforeSpacing")},set:function(e){this.setPropertyValue("beforeSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"afterSpacing",{get:function(){return this.getPropertyValue("afterSpacing")},set:function(e){this.setPropertyValue("afterSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"spaceBeforeAuto",{get:function(){return this.getPropertyValue("spaceBeforeAuto")},set:function(e){this.setPropertyValue("spaceBeforeAuto",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"spaceAfterAuto",{get:function(){return this.getPropertyValue("spaceAfterAuto")},set:function(e){this.setPropertyValue("spaceAfterAuto",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"lineSpacing",{get:function(){return this.getPropertyValue("lineSpacing")},set:function(e){this.setPropertyValue("lineSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"lineSpacingType",{get:function(){return this.getPropertyValue("lineSpacingType")},set:function(e){this.setPropertyValue("lineSpacingType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"textAlignment",{get:function(){var e=this.getPropertyValue("textAlignment");return this.bidi&&("Left"===e?e="Right":"Right"===e&&(e="Left")),e},set:function(e){this.setPropertyValue("textAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"keepWithNext",{get:function(){return this.getPropertyValue("keepWithNext")},set:function(e){this.setPropertyValue("keepWithNext",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"keepLinesTogether",{get:function(){return this.getPropertyValue("keepLinesTogether")},set:function(e){this.setPropertyValue("keepLinesTogether",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"widowControl",{get:function(){return this.getPropertyValue("widowControl")},set:function(e){this.setPropertyValue("widowControl",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"outlineLevel",{get:function(){return this.getPropertyValue("outlineLevel")},set:function(e){this.setPropertyValue("outlineLevel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ja.prototype,"contextualSpacing",{get:function(){return this.getPropertyValue("contextualSpacing")},set:function(e){this.setPropertyValue("contextualSpacing",e)},enumerable:!0,configurable:!0}),Ja.prototype.getListFormatParagraphFormat=function(e){var t=this.getListPargaraphFormat(e);if(!_.isNullOrUndefined(t))return t.uniqueParagraphFormat.propertiesHash.get(O.getPropertyType(Ja.uniqueFormatType,e))},Ja.prototype.getListPargaraphFormat=function(e){var t,i;return-1<this.listFormat.listId&&-1<this.listFormat.listLevelNumber?(t=this.listFormat.listLevel,i=O.getPropertyType(Ja.uniqueFormatType,e),_.isNullOrUndefined(t)||_.isNullOrUndefined(t.paragraphFormat.uniqueParagraphFormat)||!t.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(i)?void 0:t.paragraphFormat):!this.listFormat.hasValue("listId")||-1!==this.listFormat.listId||"leftIndent"!==e&&"firstLineIndent"!==e?void 0:(i=new Ja,this.hasValue("leftIndent")||(i.leftIndent=0),this.hasValue("firstLineIndent")||(i.firstLineIndent=0),i)},Ja.prototype.getPropertyValue=function(e){if(this.hasValue(e)){i=O.getPropertyType(Ja.uniqueFormatType,e);if(!_.isNullOrUndefined(this.uniqueParagraphFormat)&&this.uniqueParagraphFormat.propertiesHash.containsKey(i))return this.uniqueParagraphFormat.propertiesHash.get(i)}else{var t=this.getListFormatParagraphFormat(e);if(this.baseStyle instanceof ul){for(var i,n=this,r=this.baseStyle;!_.isNullOrUndefined(r);){var o=void 0;if(this.listFormat.hasValue("listId")||(o=r.paragraphFormat.getListPargaraphFormat(e)),r.paragraphFormat.hasValue(e)){n=r.paragraphFormat;break}if(!_.isNullOrUndefined(o)&&o.hasValue(e)){n=o;break}r=r.basedOn}if(!_.isNullOrUndefined(r))return!_.isNullOrUndefined(t)&&this.listFormat.hasValue("listId")&&-1===n.listFormat.listId&&n.listFormat.listLevelNumber<=1||!_.isNullOrUndefined(t)&&this.listFormat.listId!==n.listFormat.listId&&n.listFormat.listLevelNumber<=1?t:(i=O.getPropertyType(Ja.uniqueFormatType,e),n.uniqueParagraphFormat.propertiesHash.get(i))}if(!_.isNullOrUndefined(t))return t}return this.getDefaultValue(e)},Ja.prototype.getDefaultValue=function(e){var t=O.getPropertyType(Ja.uniqueFormatType,e),i=this.getDocumentParagraphFormat(),n=!0,r=(this.ownerBase&&this.ownerBase instanceof G&&(n=this.ownerBase.containerWidget instanceof _d||this.ownerBase.containerWidget instanceof fc||this.ownerBase.containerWidget instanceof N),!_.isNullOrUndefined(this.ownerBase)&&!_.isNullOrUndefined(this.ownerBase.bodyWidget)&&this.ownerBase.bodyWidget.page&&!_.isNullOrUndefined(this.ownerBase.bodyWidget.page.documentHelper)&&this.ownerBase.bodyWidget.page.documentHelper.owner.editorModule&&this.ownerBase.bodyWidget.page.documentHelper.owner.editorModule.isPaste);if(n&&!r&&!_.isNullOrUndefined(i)&&!_.isNullOrUndefined(i.uniqueParagraphFormat)){n=i.uniqueParagraphFormat.propertiesHash.get(t);if(!_.isNullOrUndefined(n))return n}return Ja.getPropertyDefaultValue(e)},Ja.prototype.getDocumentParagraphFormat=function(){var e,t;return e=_.isNullOrUndefined(this.ownerBase)||(t=this.getDocumentHelperObject(),_.isNullOrUndefined(t))?e:t.paragraphFormat},Ja.prototype.getDocumentHelperObject=function(){var e,t;return this.ownerBase instanceof G&&(t=this.ownerBase.bodyWidget,_.isNullOrUndefined(t)||_.isNullOrUndefined(t.page)||_.isNullOrUndefined(t.page.documentHelper)||(e=t.page.documentHelper)),e},Ja.prototype.setPropertyValue=function(e,t,i){(_.isNullOrUndefined(t)||""===t&&!i)&&(t=Ja.getPropertyDefaultValue(e)),_.isNullOrUndefined(this.uniqueParagraphFormat)||_.isNullOrUndefined(this.uniqueParagraphFormat.propertiesHash)&&_.isNullOrUndefined(this.uniqueParagraphFormat.uniqueFormatType)&&_.isNullOrUndefined(this.uniqueParagraphFormat.referenceCount)?this.initializeUniqueParagraphFormat(e,t):(i=O.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e),this.uniqueParagraphFormat.propertiesHash.containsKey(i)&&this.uniqueParagraphFormat.propertiesHash.get(i)===t||(this.uniqueParagraphFormat=Ja.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat,e,t)))},Ja.prototype.initializeUniqueParagraphFormat=function(e,t){var i=new T;this.addUniqueParaFormat("leftIndent",e,t,i),this.addUniqueParaFormat("rightIndent",e,t,i),this.addUniqueParaFormat("firstLineIndent",e,t,i),this.addUniqueParaFormat("textAlignment",e,t,i),this.addUniqueParaFormat("beforeSpacing",e,t,i),this.addUniqueParaFormat("afterSpacing",e,t,i),this.addUniqueParaFormat("spaceBeforeAuto",e,t,i),this.addUniqueParaFormat("spaceAfterAuto",e,t,i),this.addUniqueParaFormat("lineSpacing",e,t,i),this.addUniqueParaFormat("lineSpacingType",e,t,i),this.addUniqueParaFormat("outlineLevel",e,t,i),this.addUniqueParaFormat("bidi",e,t,i),this.addUniqueParaFormat("contextualSpacing",e,t,i),this.addUniqueParaFormat("keepWithNext",e,t,i),this.addUniqueParaFormat("keepLinesTogether",e,t,i),this.addUniqueParaFormat("widowControl",e,t,i),this.uniqueParagraphFormat=Ja.uniqueParagraphFormats.addUniqueFormat(i,Ja.uniqueFormatType)},Ja.prototype.addUniqueParaFormat=function(e,t,i,n){var r=O.getPropertyType(Ja.uniqueFormatType,e);e===t&&n.add(r,i)},Ja.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftIndent":case"rightIndent":case"firstLineIndent":t=0;break;case"textAlignment":t="Left";break;case"beforeSpacing":case"afterSpacing":t=0;break;case"spaceBeforeAuto":case"spaceAfterAuto":t=!1;break;case"lineSpacing":t=1;break;case"lineSpacingType":t="Multiple";break;case"styleName":t="Normal";break;case"outlineLevel":t="BodyText";break;case"bidi":case"contextualSpacing":case"keepWithNext":case"keepLinesTogether":t=!1;break;case"widowControl":t=!0}return t},Ja.prototype.clearIndent=function(){this.clearPropertyValue("leftIndent"),this.clearPropertyValue("firstLineIndent")},Ja.prototype.clearPropertyValue=function(e){this.setPropertyValue(e,void 0,!0),_.isNullOrUndefined(this.uniqueParagraphFormat)||(e=O.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e),this.uniqueParagraphFormat.propertiesHash.containsKey(e)&&this.uniqueParagraphFormat.propertiesHash.remove(e))},Ja.prototype.clearFormat=function(){_.isNullOrUndefined(this.listFormat)||this.listFormat.clearFormat(),_.isNullOrUndefined(this.borders)||this.borders.clearFormat(),_.isNullOrUndefined(this.uniqueParagraphFormat)||0!==this.uniqueParagraphFormat.referenceCount||Ja.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0,_.isNullOrUndefined(this.getDocumentHelperObject())||(this.baseStyle=this.getDocumentHelperObject().styles.findByName("Normal"))},Ja.prototype.destroy=function(){if(_.isNullOrUndefined(this.uniqueParagraphFormat)||Ja.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0,_.isNullOrUndefined(this.listFormat)||this.listFormat.destroy(),this.listFormat=void 0,this.tabs&&0<this.tabs.length){for(var e=0;e<this.tabs.length;e++)this.tabs[e].destroy();this.tabs=[],this.tabs=void 0}_.isNullOrUndefined(this.borders)||this.borders.destroy(),this.borders=void 0,this.baseStyle=void 0,this.ownerBase=void 0},Ja.prototype.copyFormat=function(e){if(!_.isNullOrUndefined(e)&&(_.isNullOrUndefined(e.uniqueParagraphFormat)||this.updateUniqueParagraphFormat(e),_.isNullOrUndefined(e.borders)||(_.isNullOrUndefined(this.borders)&&(this.borders=new qa(this)),this.borders.copyFormat(e.borders)),_.isNullOrUndefined(e.listFormat)||(_.isNullOrUndefined(this.listFormat)&&(this.listFormat=new ja(this)),this.listFormat.copyFormat(e.listFormat)),_.isNullOrUndefined(e.baseStyle)||(this.baseStyle=e.baseStyle),!_.isNullOrUndefined(e.tabs)))for(var t=0;t<e.tabs.length;t++)this.tabs[t]=e.tabs[t]},Ja.prototype.updateUniqueParagraphFormat=function(e){var t=void 0;this.uniqueParagraphFormat&&(t=this.uniqueParagraphFormat.mergeProperties(e.uniqueParagraphFormat),0===this.uniqueParagraphFormat.referenceCount)&&(Ja.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0),this.uniqueParagraphFormat=new O(Ja.uniqueFormatType),_.isNullOrUndefined(t)&&(t=this.uniqueParagraphFormat.mergeProperties(e.uniqueParagraphFormat)),this.uniqueParagraphFormat=Ja.uniqueParagraphFormats.addUniqueFormat(t,Ja.uniqueFormatType)},Ja.prototype.cloneFormat=function(){var e=new Ja(void 0);return e.uniqueParagraphFormat=this.uniqueParagraphFormat,e.baseStyle=this.baseStyle,_.isNullOrUndefined(this.listFormat)?e.listFormat=void 0:(e.listFormat=this.listFormat.cloneListFormat(),e.listFormat.ownerBase=e),e.borders=_.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),e},Ja.prototype.hasValue=function(e){return!_.isNullOrUndefined(this.uniqueParagraphFormat)&&!_.isNullOrUndefined(this.uniqueParagraphFormat.propertiesHash)&&(e=O.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e),this.uniqueParagraphFormat.propertiesHash.containsKey(e))},Ja.clear=function(){this.uniqueParagraphFormats.clear()},Ja.prototype.applyStyle=function(e){this.baseStyle=e,this.listFormat.applyStyle(this.baseStyle)},Ja.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},Ja.prototype.assignFormat=function(e,t){t=!_.isNullOrUndefined(t)&&t,e.hasValue("leftIndent")&&(this.leftIndent=e.getValue("leftIndent")),e.hasValue("rightIndent")&&(this.rightIndent=e.getValue("rightIndent")),e.hasValue("firstLineIndent")&&(this.firstLineIndent=e.getValue("firstLineIndent")),e.hasValue("beforeSpacing")&&(this.beforeSpacing=e.getValue("beforeSpacing")),e.hasValue("afterSpacing")&&(this.afterSpacing=e.getValue("afterSpacing")),e.hasValue("spaceBeforeAuto")&&(this.spaceBeforeAuto=e.getValue("spaceBeforeAuto")),e.hasValue("spaceAfterAuto")&&(this.spaceAfterAuto=e.getValue("spaceAfterAuto")),e.hasValue("lineSpacing")&&(this.lineSpacing=e.getValue("lineSpacing")),e.hasValue("lineSpacingType")&&(this.lineSpacingType=e.getValue("lineSpacingType")),e.hasValue("textAlignment")&&(this.textAlignment=e.getValue("textAlignment")),e.hasValue("outlineLevel")&&(this.outlineLevel=e.getValue("outlineLevel")),!t&&e.hasValue("bidi")&&(this.bidi=e.getValue("bidi")),e.hasValue("contextualSpacing")&&(this.contextualSpacing=e.getValue("contextualSpacing")),e.hasValue("keepWithNext")&&(this.keepWithNext=e.getValue("keepWithNext")),e.hasValue("keepLinesTogether")&&(this.keepLinesTogether=e.getValue("keepLinesTogether")),e.hasValue("widowControl")&&(this.widowControl=e.getValue("widowControl"))},Ja.uniqueParagraphFormats=new e,Ja.uniqueFormatType=3;var Xa=Ja;function Ja(e){this.uniqueParagraphFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.tabs=void 0,this.ownerBase=e,this.listFormat=new ja(this),this.borders=new qa(this),this.tabs=[]}Object.defineProperty(Qa.prototype,"gridBefore",{get:function(){return this.getPropertyValue("gridBefore")},set:function(e){this.setPropertyValue("gridBefore",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"gridBeforeWidth",{get:function(){return this.getPropertyValue("gridBeforeWidth")},set:function(e){this.setPropertyValue("gridBeforeWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"gridBeforeWidthType",{get:function(){return this.getPropertyValue("gridBeforeWidthType")},set:function(e){this.setPropertyValue("gridBeforeWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"gridAfter",{get:function(){return this.getPropertyValue("gridAfter")},set:function(e){this.setPropertyValue("gridAfter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"gridAfterWidth",{get:function(){return this.getPropertyValue("gridAfterWidth")},set:function(e){this.setPropertyValue("gridAfterWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"gridAfterWidthType",{get:function(){return this.getPropertyValue("gridAfterWidthType")},set:function(e){this.setPropertyValue("gridAfterWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"allowBreakAcrossPages",{get:function(){return this.getPropertyValue("allowBreakAcrossPages")},set:function(e){this.setPropertyValue("allowBreakAcrossPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"isHeader",{get:function(){return this.getPropertyValue("isHeader")},set:function(e){this.setPropertyValue("isHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"height",{get:function(){return this.getPropertyValue("height")},set:function(e){0!==e||"AtLeast"!==this.heightType&&"Exactly"!==this.heightType?"Auto"===this.heightType&&(e=0):e=1,this.setPropertyValue("height",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"heightType",{get:function(){return this.getPropertyValue("heightType")},set:function(e){this.height="AtLeast"===e||"Exactly"===e?1:0,this.setPropertyValue("heightType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qa.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Qa.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var t=O.getPropertyType(Qa.uniqueFormatType,e);if(!_.isNullOrUndefined(this.uniqueRowFormat)&&this.uniqueRowFormat.propertiesHash.containsKey(t))return this.uniqueRowFormat.propertiesHash.get(t)}return Qa.getPropertyDefaultValue(e)},Qa.prototype.setPropertyValue=function(e,t){var i;!_.isNullOrUndefined(t)&&""!==t||(t=Qa.getPropertyDefaultValue(e)),_.isNullOrUndefined(this.uniqueRowFormat)?this.initializeUniqueRowFormat(e,t):(i=O.getPropertyType(this.uniqueRowFormat.uniqueFormatType,e),this.uniqueRowFormat.propertiesHash.containsKey(i)&&this.uniqueRowFormat.propertiesHash.get(i)===t||(this.uniqueRowFormat=Qa.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat,e,t)))},Qa.prototype.initializeUniqueRowFormat=function(e,t){var i=new T;this.addUniqueRowFormat("allowBreakAcrossPages",e,t,i),this.addUniqueRowFormat("isHeader",e,t,i),this.addUniqueRowFormat("height",e,t,i),this.addUniqueRowFormat("heightType",e,t,i),this.addUniqueRowFormat("gridBefore",e,t,i),this.addUniqueRowFormat("gridBeforeWidth",e,t,i),this.addUniqueRowFormat("gridBeforeWidthType",e,t,i),this.addUniqueRowFormat("gridAfter",e,t,i),this.addUniqueRowFormat("gridAfterWidth",e,t,i),this.addUniqueRowFormat("gridgridAfterWidth",e,t,i),this.addUniqueRowFormat("gridBeforeWidthType",e,t,i),this.addUniqueRowFormat("leftMargin",e,t,i),this.addUniqueRowFormat("rightMargin",e,t,i),this.addUniqueRowFormat("topMargin",e,t,i),this.addUniqueRowFormat("bottomMargin",e,t,i),this.addUniqueRowFormat("leftIndent",e,t,i),this.uniqueRowFormat=Qa.uniqueRowFormats.addUniqueFormat(i,Qa.uniqueFormatType)},Qa.prototype.addUniqueRowFormat=function(e,t,i,n){var r=O.getPropertyType(Qa.uniqueFormatType,e);e===t&&n.add(r,i)},Qa.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowBreakAcrossPages":t=!0;break;case"isHeader":t=!1;break;case"height":t=0;break;case"heightType":t="Auto";break;case"gridBefore":case"gridBeforeWidth":t=0;break;case"gridBeforeWidthType":t="Point";break;case"gridAfter":case"gridAfterWidth":t=0;break;case"gridAfterWidthType":t="Point";break;case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"leftIndent":t=0}return t},Qa.prototype.containsMargins=function(){return!(_.isNullOrUndefined(this.leftMargin)&&_.isNullOrUndefined(this.rightMargin)&&_.isNullOrUndefined(this.bottomMargin)&&_.isNullOrUndefined(this.topMargin))},Qa.prototype.cloneFormat=function(){var e=new Qa;return e.allowBreakAcrossPages=this.allowBreakAcrossPages,e.heightType=this.heightType,e.height=this.height,e.isHeader=this.isHeader,e.gridBefore=this.gridBefore,e.gridBeforeWidth=this.gridBeforeWidth,e.gridBeforeWidthType=this.gridBeforeWidthType,e.gridAfter=this.gridAfter,e.gridAfterWidth=this.gridAfterWidth,e.gridAfterWidthType=this.gridAfterWidthType,e.leftMargin=this.leftMargin,e.rightMargin=this.rightMargin,e.topMargin=this.topMargin,e.bottomMargin=this.bottomMargin,e.leftIndent=this.leftIndent,0<this.revisions.length?e.removedIds=$a.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice(),e},Qa.prototype.hasValue=function(e){return!_.isNullOrUndefined(this.uniqueRowFormat)&&(e=O.getPropertyType(this.uniqueRowFormat.uniqueFormatType,e),this.uniqueRowFormat.propertiesHash.containsKey(e))},Qa.prototype.copyFormat=function(e){_.isNullOrUndefined(e)||(_.isNullOrUndefined(e.uniqueRowFormat)||(this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader,this.heightType=e.heightType,this.height=e.height,this.gridBefore=e.gridBefore,this.gridBeforeWidth=e.gridBeforeWidth,this.gridBeforeWidthType=e.gridBeforeWidthType,this.gridAfter=e.gridAfter,this.gridAfterWidth=e.gridAfterWidth,this.gridAfterWidthType=e.gridAfterWidthType,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.revisions=e.revisions),_.isNullOrUndefined(e.borders)||(this.borders=new qa(this),this.borders.ownerBase=e,this.borders.copyFormat(e.borders)),0<e.revisions.length?this.removedIds=$a.cloneRevisions(e.revisions):this.removedIds=e.removedIds.slice())},Qa.prototype.destroy=function(){_.isNullOrUndefined(this.borders)||this.borders.destroy(),_.isNullOrUndefined(this.uniqueRowFormat)||Qa.uniqueRowFormats.remove(this.uniqueRowFormat),this.beforeWidth=void 0,this.afterWidth=void 0,this.borders=void 0,this.uniqueRowFormat=void 0},Qa.clear=function(){this.uniqueRowFormats.clear()},Qa.uniqueRowFormats=new e,Qa.uniqueFormatType=6;var Ya=Qa;function Qa(e){this.uniqueRowFormat=void 0,this.borders=new qa(this),this.ownerBase=void 0,this.beforeWidth=0,this.afterWidth=0,this.revisions=[],this.removedIds=[],this.ownerBase=e}el.prototype.handleAcceptReject=function(e,t){this.owner.selectionModule.selectRevision(this);var i=this.owner.selectionModule,n=i.start,r=i.end,o=(i.start.isExistBefore(i.end)||(n=i.end,r=i.start),i.getParagraphInfo(n)),s=(this.owner.editorModule.initHistory(e?"Accept Change":"Reject Change"),i.getHyperlinkField());if(e&&"Deletion"===this.revisionType&&!_.isNullOrUndefined(s)&&-1!==this.range.indexOf(s)&&-1!==this.range.indexOf(s.fieldEnd)&&this.range.indexOf(s.fieldSeparator)===this.range.indexOf(s.fieldEnd)-1&&(this.owner.editorHistoryModule.currentBaseHistoryInfo.isHyperlinkField=!0),this.owner.editorHistoryModule.currentBaseHistoryInfo.markerData.push(this.owner.editorModule.getMarkerData(void 0,void 0,this)),"Deletion"===this.revisionType&&(o=i.getParagraphInfo(this.owner.selectionModule.start)),i.editPosition=this.owner.selectionModule.getHierarchicalIndex(o.paragraph,o.offset.toString()),this.owner.editorModule.updateInsertPosition(),this.isContentRemoved=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,"Insertion"===this.revisionType||"Deletion"===this.revisionType||"MoveFrom"===this.revisionType||"MoveTo"===this.revisionType){this.owner.isShiftingEnabled=!0;for(var a,l=0;0<this.range.length&&(this.range[l]instanceof mh||this.range[l]instanceof B||this.range[l]instanceof Ya);)this.range[l]instanceof J&&e&&"Deletion"===this.revisionType&&(a=this.range[l],this.owner.documentHelper.bookmarks.containsKey(a.name))&&this.owner.documentHelper.bookmarks.remove(a.name),this.unlinkRangeItem(this.range[l],this,e,n,r)?l++:l=0}this.isTableRevision=!1,this.isContentRemoved?(s=i.getTextPosBasedOnLogicalIndex(i.editPosition),this.owner.selectionModule.selectContent(s,!0),this.owner.editorModule.updateEndPosition()):(i.selectRange(n,r),this.owner.editorModule.updateHistoryPosition(r,!1)),this.owner.editorHistoryModule&&this.owner.editorHistoryModule.currentBaseHistoryInfo&&"BackSpace"!==this.owner.editorHistoryModule.currentBaseHistoryInfo.action&&this.owner.editorHistoryModule.currentBaseHistoryInfo.removedNodes.reverse(),this.owner.editorHistoryModule&&(this.owner.trackChangesPane.isTrackingPageBreak&&(this.owner.editorHistoryModule.currentBaseHistoryInfo.action="TrackingPageBreak",this.owner.trackChangesPane.isTrackingPageBreak=!1),!(s=this.owner.editorHistoryModule).currentHistoryInfo||"Accept All"!==s.currentHistoryInfo.action&&"Reject All"!==s.currentHistoryInfo.action||this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),s.updateHistory()),this.owner.editorModule.reLayout(this.owner.selectionModule),o.paragraph.isInHeaderFooter&&this.owner.editorModule.updateHeaderFooterWidget(),t&&this.owner.selectionModule.start.paragraph.isInsideTable&&(i=this.owner.selectionModule.start.paragraph.containerWidget.ownerTable,this.owner.documentHelper.layout.reLayoutTable(i))},el.prototype.handleGroupAcceptReject=function(e){if(this.owner.trackChangesPane.tableRevisions.containsKey(this)){this.owner.editorModule.initComplexHistory(e?"Accept All":"Reject All");for(var t,i=this.owner.trackChangesPane.tableRevisions.get(this),n=i.length-1;0<=n;n--)e?i[n].handleAcceptReject(!0):i[n].handleAcceptReject(!1);this.owner.editorHistoryModule&&this.owner.editorHistoryModule.updateComplexHistory(),this.owner.selectionModule.start.paragraph.isInsideTable&&(t=this.owner.selectionModule.start.paragraph.containerWidget.ownerTable,this.owner.documentHelper.layout.reLayoutTable(t))}},el.prototype.accept=function(){var e={author:this.author,cancel:!1,revisionType:this.revisionType,actionType:"Accept"};this.owner.trigger(ye,e),e.cancel||this.owner.documentHelper.isTrackedOnlyMode||(!this.owner.revisions.skipGroupAcceptReject&&this.range[0]instanceof Ya&&this.owner.trackChangesPane.tableRevisions.containsKey(this)?this.handleGroupAcceptReject(!0):this.handleAcceptReject(!0,!0))},el.prototype.reject=function(){var e={author:this.author,cancel:!1,revisionType:this.revisionType,actionType:"Reject"};this.owner.trigger(ye,e),e.cancel||this.owner.documentHelper.isTrackedOnlyMode||(!this.owner.revisions.skipGroupAcceptReject&&this.range[0]instanceof Ya&&this.owner.trackChangesPane.tableRevisions.containsKey(this)?this.handleGroupAcceptReject(!1):this.handleAcceptReject(!1,!0))},el.prototype.unlinkRangeItem=function(e,t,i,n,r){if(this.isTableRevision)this.removeRangeRevisionForItem(e),0===t.range.length&&this.owner.revisions.remove(t);else{var o,s,a=!_.isNullOrUndefined(i)&&("MoveFrom"===t.revisionType||"Deletion"===t.revisionType)&&i||("Insertion"===t.revisionType||"MoveTo"===t.revisionType)&&!i;if(this.owner.selectionModule.isTOC())if(a)this.owner.editorModule.deleteSelectedContents(this.owner.selectionModule,!0),0===t.range.length&&this.owner.revisions.remove(t),this.isContentRemoved=!0,this.owner.editorHistoryModule.currentBaseHistoryInfo.action="BackSpace";else{for(;0<this.range.length;){var l=this.range[0];this.removeRangeRevisionForItem(l),0===t.range.length&&this.owner.revisions.remove(t)}this.owner.editorModule.addRemovedNodes(this.revisionID),this.owner.editorHistoryModule.currentBaseHistoryInfo.action="AcceptTOC"}else{if(e instanceof mh&&!this.canSkipTableItems)if(a){if(this.skipeElementRemoval(e))return this.skipUnLinkElement=!0;this.owner.editorModule.addRemovedNodes(e.clone())}else{var d=this.owner.selectionModule.getHyperlinkField();i||_.isNullOrUndefined(d)||d!=e||_.isNullOrUndefined(d.fieldEnd)?(this.owner.editorHistoryModule.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID(),this.removeRevisionFromPara(n,r)):(this.owner.editorModule.initComplexHistory("ClearRevisions"),this.owner.editorHistoryModule.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID(),this.removeRevisionFromPara(n,r),_.isNullOrUndefined(this.owner.editorHistoryModule)||(this.owner.editorHistoryModule.currentBaseHistoryInfo.isHyperlinkField=!0,d=this.owner.selectionModule.getParagraphInfo(r),d=this.owner.selectionModule.getHierarchicalIndex(d.paragraph,d.offset.toString()),this.owner.editorHistoryModule.currentBaseHistoryInfo.endPosition=d,this.owner.editorHistoryModule.currentBaseHistoryInfo.selectionEnd=d,this.owner.editorHistoryModule.updateHistory()),this.owner.enableTrackChanges?(this.owner.enableTrackChanges=!1,this.owner.editorModule.updateHyperlinkFormat(this.owner.selectionModule),this.owner.enableTrackChanges=!0):this.owner.editorModule.updateHyperlinkFormat(this.owner.selectionModule),this.owner.editorHistoryModule&&!_.isNullOrUndefined(this.owner.editorHistoryModule.currentHistoryInfo)&&this.owner.editorHistoryModule.updateComplexHistory()),this.owner.trackChangesPane.isTrackingPageBreak=!1}else!this.canSkipTableItems&&e instanceof B&&!a?(this.owner.editorHistoryModule.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID(),this.removeRevisionFromPara(n,r)):e instanceof Ya&&!a&&(this.isTableRevision=!0,o=e.ownerBase.ownerTable,s=e.ownerBase,this.owner.editorHistoryModule.currentBaseHistoryInfo.action="RemoveRowTrack",this.owner.editorModule.cloneTableToHistoryInfo(o.combineWidget(this.owner.viewer)));if(a=a&&!this.canSkipTableItems,e instanceof mh&&a){var d=e.line.paragraph;this.removeRevisionItemsFromRange(e),e instanceof Bh?"Footnote"===e.footnoteType?this.owner.editorModule.removeFootnote(e):this.owner.editorModule.removeEndnote(e):e instanceof uc&&this.owner.editorModule.removeDeletedShapeRevision(e),this.removeItem(e),this.isContentRemoved=!0,!_.isNullOrUndefined(d)&&!_.isNullOrUndefined(d.bodyWidget)&&d.bodyWidget instanceof Xd&&(_.isNullOrUndefined(d.bodyWidget.page)||!_.isNullOrUndefined(d.bodyWidget.page)&&-1===d.bodyWidget.page.index)||this.owner.documentHelper.layout.reLayoutParagraph(d,0,0),_.isNullOrUndefined(d.childWidgets)&&(d=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.owner.selectionModule.editPosition),this.owner.selectionModule.selectContent(d,!0))}else if(e instanceof B&&a){if(this.isContentRemoved=!0,this.skipUnLinkElement=!1,this.removeRevisionItemsFromRange(e),1===t.range.length)this.owner.editorModule.deleteSelectedContents(this.owner.selectionModule,!0);else{this.owner.editorModule.deleteSelectedContents(this.owner.selectionModule,!0),this.removeRevisionFromPara(n,r);d=t.range.indexOf(e);for(t.range.splice(d,1),this.owner.trackChangesPane.updateCurrentTrackChanges(t);0<this.range.length;)this.removeRangeRevisionForItem(this.range[0])}this.owner.editorHistoryModule.currentBaseHistoryInfo.action="BackSpace",this.owner.editorHistoryModule.currentBaseHistoryInfo.isAcceptOrReject=i?"Accept":"Reject"}else e instanceof Ya&&a&&(o=(o=e.ownerBase.ownerTable).combineWidget(this.owner.viewer),s=e.ownerBase,this.removeRevisionItemsFromRange(e),this.owner.editorHistoryModule.currentBaseHistoryInfo.action="DeleteCells",this.owner.editorModule.cloneTableToHistoryInfo(o),this.owner.editorModule.removeDeletedCellRevision(s),this.isContentRemoved=!0,o.removeChild(o.childWidgets.indexOf(s)),this.canSkipTableItems=!0,this.owner.editorModule.removeFieldInBlock(s),this.owner.editorModule.removeFieldInBlock(s,!0),this.owner.editorModule.removeFieldInBlock(s,void 0,!0),0===o.childWidgets.length?(this.owner.selectionModule.editPosition=this.owner.selectionModule.getHierarchicalIndex(o,"0"),this.owner.editorModule.removeBlock(o)):this.owner.editorModule.updateTable(o,!0));e instanceof Ya&&a||this.skipUnLinkElement||(this.removeRangeRevisionForItem(e),a&&e instanceof J&&this.owner.editorModule.removedBookmarkElements.push(e),e instanceof J&&this.owner.documentHelper.bookmarks.containsKey(e.name)&&(this.owner.enableCollaborativeEditing&&!_.isNullOrUndefined(this.owner.editorHistory.currentBaseHistoryInfo)&&this.owner.editorHistory.currentBaseHistoryInfo.markerData.push({bookmarkName:e.name}),this.owner.documentHelper.bookmarks.remove(e.name))),0===t.range.length&&this.owner.revisions.remove(t)}}return!1},el.prototype.removeRevisionFromPara=function(e,t){for(var e=this.owner.selectionModule.getParagraphInfo(e),i=this.owner.selectionModule.getParagraphInfo(t),n=e.paragraph;n instanceof G;){if(0<n.characterFormat.revisions.length)for(var r,o=0;o<n.characterFormat.revisions.length;o++)0===n.characterFormat.revisions[o].range.length&&(r=n.characterFormat.revisions.indexOf(n.characterFormat.revisions[o]),n.characterFormat.revisions.splice(r,1),o--);n=i.paragraph===n?void 0:n.nextWidget}},el.prototype.updateRevisionID=function(){for(this.owner.editorModule.addRemovedNodes(this.revisionID);0<this.range.length;)this.removeRangeRevisionForItem(this.range[0])},el.prototype.removeRevisionItemsFromRange=function(e){if(0<e.revisions.length)for(var t=0;t<e.revisions.length;t++){var i,n=e.revisions[t];this.revisionID!==n.revisionID&&(i=n.range.indexOf(e),e.revisions[t].range.splice(i,1),this.owner.trackChangesPane.updateCurrentTrackChanges(e.revisions[t])),0===n.range.length&&this.owner.revisions.remove(n)}},el.prototype.removeRangeRevisionForItem=function(e){var t=e.revisions.indexOf(this);0<=t&&(e.revisions.splice(t,1),t=this.range.indexOf(e),this.range.splice(t,1),this.owner.trackChangesPane.updateCurrentTrackChanges(this))},el.prototype.skipeElementRemoval=function(e){var t=e.paragraph;if(0<t.characterFormat.revisions.length)for(var i=0;i<t.characterFormat.revisions.length;i++){var n=t.characterFormat.revisions[i];if(0<=n.range.indexOf(e)&&n.revisionID===this.revisionID)return!0}return!1},el.prototype.removeRevisionFromRow=function(e){this.owner.editorModule.unlinkRangeFromRevision(e.rowFormat);for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];this.owner.editorModule.removeRevisionForCell(i,!1)}},el.prototype.removeItem=function(e){var t=e.line.paragraph,i=(this.owner.editorModule.unLinkFieldCharacter(e),e.line.children.indexOf(e)),n=e.previousNode,i=(e.line.children.splice(i,1),_.isNullOrUndefined(n)||this.owner.editorModule.combineElementRevisionToPrevNxt(n),e.line.paragraph.floatingElements.indexOf(e)),n=(e.line.paragraph.floatingElements.splice(i,1),e.line.paragraph.bodyWidget.floatingElements.indexOf(e));-1<n&&e.line.paragraph.bodyWidget.floatingElements.splice(n,1),this.owner.editorModule.removeEmptyLine(t)},el.prototype.canSkipCloning=function(){if(!_.isNullOrUndefined(this.owner)&&this.owner.editorHistoryModule&&this.owner.editorHistoryModule.currentBaseHistoryInfo&&"DeleteCells"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action)return!0;return!1},el.prototype.destroy=function(){this.author=void 0,this.revisionType=void 0,this.revisionID=void 0,this.date=void 0,this.range=[],this.range=void 0,this.owner=void 0},el.prototype.clone=function(){var e;return this.canSkipCloning()?this:((e=new el(void 0,this.author,this.date)).revisionID=this.revisionID,e.revisionType=this.revisionType,e)},el.cloneRevisions=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].revisionID);return t};var $a=el;function el(e,t,i){this.author=null,this.date=null,this.range=[],this.revisionID="",this.isContentRemoved=!1,this.isTableRevision=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,this.author=t,_.isNullOrUndefined(this.author)&&(this.author="Unknown"),this.date=i,this.owner=e}il.prototype.get=function(e){if(e>=this.changes.length||e<0)throw new ReferenceError("Provided index is not within the range");return this.changes[e]},Object.defineProperty(il.prototype,"length",{get:function(){return this.changes.length},enumerable:!0,configurable:!0}),il.prototype.remove=function(e){var t,i,n;_.isNullOrUndefined(e)||this.changes.indexOf(e)<0||(this.changes.splice(this.changes.indexOf(e),1),-1!==this.owner.trackChangesPane.revisions.indexOf(e)&&(t=this.owner.trackChangesPane.revisions.indexOf(e),i=!(this.owner.trackChangesPane.tableRevisions.containsKey(e)&&this.owner.trackChangesPane.tableRevisions.get(e)[this.owner.trackChangesPane.tableRevisions.get(e).length-1]!==e),n=this.owner.trackChangesPane.changes.get(e),i&&this.owner.trackChangesPane.changesInfoDiv.removeChild(n.outerSingleDiv),this.owner.trackChangesPane.revisions.splice(t,1),this.owner.trackChangesPane.changes.remove(e),this.owner.trackChangesPane.renderedChanges.containsKey(e)&&this.owner.trackChangesPane.renderedChanges.remove(e),this.owner.trackChangesPane.tableRevisions.containsKey(e))&&this.owner.trackChangesPane.tableRevisions.remove(e))},il.prototype.acceptAll=function(){this.owner.isReadOnly||this.owner.documentHelper.isTrackedOnlyMode||this.handleRevisionCollection(!0)},il.prototype.rejectAll=function(){this.owner.isReadOnly||this.owner.documentHelper.isTrackedOnlyMode||this.handleRevisionCollection(!1)},il.prototype.handleRevisionCollection=function(e,t){this.skipGroupAcceptReject=!0;var i=this.owner.selectionModule,n=i.start,r=i.end,o=t||this.changes;if(!(o.length<=0)){for(i.start.isExistBefore(i.end)||(n=i.end,r=i.start),n=n.clone(),r=r.clone(),e?this.owner.editorModule.initComplexHistory("Accept All"):this.owner.editorModule.initComplexHistory("Reject All");0<o.length;)e?o[0].accept():o[0].reject(),t&&o.splice(0,1),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget();_.isNullOrUndefined(i.editPosition)||(n=i.getTextPosBasedOnLogicalIndex(i.editPosition),this.owner.selectionModule.selectContent(n,!0)),this.owner.editorHistoryModule&&(this.owner.editorHistoryModule.updateComplexHistory(),_.isNullOrUndefined(i.editPosition))&&this.owner.editorHistoryModule.undoStack.pop(),this.owner.editorModule.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.owner.editorModule.reLayout(this.owner.selectionModule,!1),this.owner.editorModule.isSkipOperationsBuild=!1,this.skipGroupAcceptReject=!1}},il.prototype.clear=function(){this.changes=[]},il.prototype.destroy=function(){if(this.changes){for(var e=0;e<this.changes.length;e++)this.changes[e].destroy();this.changes=[]}this.changes=void 0,this.owner=void 0};var tl=il;function il(e){this.changes=[],this.skipGroupAcceptReject=!1,this.owner=e}Object.defineProperty(s.prototype,"bold",{get:function(){return this.getPropertyValue("bold")},set:function(e){this.setPropertyValue("bold",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"italic",{get:function(){return this.getPropertyValue("italic")},set:function(e){this.setPropertyValue("italic",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontSize",{get:function(){return this.getPropertyValue("fontSize")},set:function(e){this.setPropertyValue("fontSize",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"characterSpacing",{get:function(){return this.getPropertyValue("characterSpacing")},set:function(e){this.setPropertyValue("characterSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"scaling",{get:function(){return this.getPropertyValue("scaling")},set:function(e){this.setPropertyValue("scaling",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontFamily",{get:function(){return this.getPropertyValue("fontFamily")},set:function(e){this.setPropertyValue("fontFamily",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"underline",{get:function(){return this.getPropertyValue("underline")},set:function(e){this.setPropertyValue("underline",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"underlineColor",{get:function(){return this.getPropertyValue("underlineColor")},set:function(e){this.setPropertyValue("underlineColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"strikethrough",{get:function(){return this.getPropertyValue("strikethrough")},set:function(e){this.setPropertyValue("strikethrough",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"baselineAlignment",{get:function(){return this.getPropertyValue("baselineAlignment")},set:function(e){this.setPropertyValue("baselineAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"highlightColor",{get:function(){return this.getPropertyValue("highlightColor")},set:function(e){this.setPropertyValue("highlightColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontColor",{get:function(){return this.getPropertyValue("fontColor")},set:function(e){this.setPropertyValue("fontColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"localeIdBidi",{get:function(){return this.getPropertyValue("localeIdBidi")},set:function(e){this.setPropertyValue("localeIdBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"localeIdFarEast",{get:function(){return this.getPropertyValue("localeIdFarEast")},set:function(e){this.setPropertyValue("localeIdFarEast",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"localeIdAscii",{get:function(){return this.getPropertyValue("localeIdAscii")},set:function(e){this.setPropertyValue("localeIdAscii",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bdo",{get:function(){return this.getPropertyValue("bdo")},set:function(e){this.setPropertyValue("bdo",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"boldBidi",{get:function(){return this.getPropertyValue("boldBidi")},set:function(e){this.setPropertyValue("boldBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"italicBidi",{get:function(){return this.getPropertyValue("italicBidi")},set:function(e){this.setPropertyValue("italicBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontSizeBidi",{get:function(){return this.getPropertyValue("fontSizeBidi")},set:function(e){this.setPropertyValue("fontSizeBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontFamilyBidi",{get:function(){return this.getPropertyValue("fontFamilyBidi")},set:function(e){this.setPropertyValue("fontFamilyBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"allCaps",{get:function(){return this.getPropertyValue("allCaps")},set:function(e){this.setPropertyValue("allCaps",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"Lowercase",{get:function(){return this.getPropertyValue("Lowercase")},set:function(e){this.setPropertyValue("Lowercase",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"Uppercase",{get:function(){return this.getPropertyValue("Uppercase")},set:function(e){this.setPropertyValue("Uppercase",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"SentenceCase",{get:function(){return this.getPropertyValue("SentenceCase")},set:function(e){this.setPropertyValue("SentenceCase",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"ToggleCase",{get:function(){return this.getPropertyValue("ToggleCase")},set:function(e){this.setPropertyValue("ToggleCase",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"CapitalizeEachWord",{get:function(){return this.getPropertyValue("CapitalizeEachWord")},set:function(e){this.setPropertyValue("CapitalizeEachWord",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"complexScript",{get:function(){return this.getPropertyValue("complexScript")},set:function(e){this.setPropertyValue("complexScript",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontFamilyFarEast",{get:function(){return this.getPropertyValue("fontFamilyFarEast")},set:function(e){this.setPropertyValue("fontFamilyFarEast",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontFamilyAscii",{get:function(){return this.getPropertyValue("fontFamilyAscii")},set:function(e){this.setPropertyValue("fontFamilyAscii",e)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fontFamilyNonFarEast",{get:function(){return this.getPropertyValue("fontFamilyNonFarEast")},set:function(e){this.setPropertyValue("fontFamilyNonFarEast",e)},enumerable:!0,configurable:!0}),s.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var t=O.getPropertyType(s.uniqueFormatType,e);if(!_.isNullOrUndefined(this.uniqueCharacterFormat)&&this.uniqueCharacterFormat.propertiesHash.containsKey(t))return this.uniqueCharacterFormat.propertiesHash.get(t)}else{t=this.checkCharacterStyle(e);if(!_.isNullOrUndefined(t))return t;if(!_.isNullOrUndefined(this.baseCharStyle)){var t=void 0,i=void 0;if(_.isNullOrUndefined(this.ownerBase)||(t=this.ownerBase.paragraph,i=this.ownerBase.line),!_.isNullOrUndefined(t)&&!_.isNullOrUndefined(i))for(var n=i.children.length,r=0;r<n;r++){var o=this.ownerBase.line.children[r];o instanceof X&&(o=o.text).startsWith("HYPERLINK")&&-1!==o.indexOf("_Toc")&&(this.baseCharStyle=this.ownerBase.paragraph.paragraphFormat.baseStyle)}}t=this.checkBaseStyle(e);if(!_.isNullOrUndefined(t))return t}return this.getDefaultValue(e)},s.prototype.getDefaultValue=function(e){var t=O.getPropertyType(s.uniqueFormatType,e),i=this.documentCharacterFormat();return _.isNullOrUndefined(i)||_.isNullOrUndefined(i.uniqueCharacterFormat)||!i.uniqueCharacterFormat.propertiesHash.containsKey(t)?s.getPropertyDefaultValue(e):i.uniqueCharacterFormat.propertiesHash.get(t)},s.prototype.documentCharacterFormat=function(){var e;return _.isNullOrUndefined(this.ownerBase)||(_.isNullOrUndefined(this.ownerBase.paragraph)||_.isNullOrUndefined(this.ownerBase.paragraph.bodyWidget)||_.isNullOrUndefined(this.ownerBase.paragraph.bodyWidget.page)?_.isNullOrUndefined(this.ownerBase.bodyWidget)||(e=this.ownerBase.bodyWidget.page.documentHelper.characterFormat):e=this.ownerBase.paragraph.bodyWidget.page.documentHelper.characterFormat),e},s.prototype.checkBaseStyle=function(e){var t,i;for(_.isNullOrUndefined(this.ownerBase)||(_.isNullOrUndefined(this.ownerBase.paragraph)?this.ownerBase instanceof G&&!_.isNullOrUndefined(this.ownerBase.paragraphFormat)?t=this.ownerBase.paragraphFormat.baseStyle:_.isNullOrUndefined(this.ownerBase instanceof ul)||(t=this.ownerBase.basedOn):t=this.ownerBase.paragraph.paragraphFormat.baseStyle);!_.isNullOrUndefined(t)&&!t.characterFormat.hasValue(e);)t=t.basedOn;if(!_.isNullOrUndefined(t))return i=O.getPropertyType(s.uniqueFormatType,e),t.characterFormat.uniqueCharacterFormat.propertiesHash.get(i)},s.prototype.checkCharacterStyle=function(e){var t,i=this.baseCharStyle;if(!_.isNullOrUndefined(i))for(;!_.isNullOrUndefined(i)&&"Default Paragraph Font"!==i.name;){if(i.characterFormat.hasValue(e))return t=O.getPropertyType(s.uniqueFormatType,e),i.characterFormat.uniqueCharacterFormat.propertiesHash.get(t);i=i.basedOn}},s.prototype.setPropertyValue=function(e,t){var i;!_.isNullOrUndefined(t)&&""!==t||(t=s.getPropertyDefaultValue(e)),_.isNullOrUndefined(this.uniqueCharacterFormat)||_.isNullOrUndefined(this.uniqueCharacterFormat.propertiesHash)&&_.isNullOrUndefined(this.uniqueCharacterFormat.uniqueFormatType)&&_.isNullOrUndefined(this.uniqueCharacterFormat.referenceCount)?this.initializeUniqueCharacterFormat(e,t):(i=O.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,e),this.uniqueCharacterFormat.propertiesHash.containsKey(i)&&this.uniqueCharacterFormat.propertiesHash.get(i)===t||(this.uniqueCharacterFormat=s.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat,e,t)))},s.prototype.initializeUniqueCharacterFormat=function(e,t){var i=new T;this.addUniqueCharacterFormat("fontColor",e,t,i),this.addUniqueCharacterFormat("fontFamily",e,t,i),this.addUniqueCharacterFormat("fontSize",e,t,i),this.addUniqueCharacterFormat("bold",e,t,i),this.addUniqueCharacterFormat("italic",e,t,i),this.addUniqueCharacterFormat("underline",e,t,i),this.addUniqueCharacterFormat("underlineColor",e,t,i),this.addUniqueCharacterFormat("strikethrough",e,t,i),this.addUniqueCharacterFormat("baselineAlignment",e,t,i),this.addUniqueCharacterFormat("highlightColor",e,t,i),this.addUniqueCharacterFormat("styleName",e,t,i),this.addUniqueCharacterFormat("bidi",e,t,i),this.addUniqueCharacterFormat("bdo",e,t,i),this.addUniqueCharacterFormat("fontFamilyBidi",e,t,i),this.addUniqueCharacterFormat("fontSizeBidi",e,t,i),this.addUniqueCharacterFormat("boldBidi",e,t,i),this.addUniqueCharacterFormat("italicBidi",e,t,i),this.addUniqueCharacterFormat("allCaps",e,t,i),this.addUniqueCharacterFormat("Uppercase",e,t,i),this.addUniqueCharacterFormat("Lowercase",e,t,i),this.addUniqueCharacterFormat("SentenceCase",e,t,i),this.addUniqueCharacterFormat("ToggleCase",e,t,i),this.addUniqueCharacterFormat("CapitalizeEachWord",e,t,i),this.addUniqueCharacterFormat("localeIdAscii",e,t,i),this.addUniqueCharacterFormat("localeIdFarEast",e,t,i),this.addUniqueCharacterFormat("localeIdBidi",e,t,i),this.addUniqueCharacterFormat("fontFamilyFarEast",e,t,i),this.addUniqueCharacterFormat("fontFamilyAscii",e,t,i),this.addUniqueCharacterFormat("fontFamilyNonFarEast",e,t,i),this.addUniqueCharacterFormat("complexScript",e,t,i),this.addUniqueCharacterFormat("characterSpacing",e,t,i),this.addUniqueCharacterFormat("scaling",e,t,i),this.uniqueCharacterFormat=s.uniqueCharacterFormats.addUniqueFormat(i,s.uniqueFormatType)},s.prototype.addUniqueCharacterFormat=function(e,t,i,n){var r=O.getPropertyType(s.uniqueFormatType,e);e===t&&n.add(r,i)},s.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"bold":case"italic":t=!1;break;case"fontSize":t=11;break;case"underline":t="None";break;case"underlineColor":t=void 0;break;case"strikethrough":t="None";break;case"baselineAlignment":t="Normal";break;case"highlightColor":t="NoColor";break;case"fontColor":t="#00000000";break;case"fontFamily":t="Calibri";break;case"styleName":t="Default Paragraph Font";break;case"bidi":t=!1;break;case"bdo":t="None";break;case"boldBidi":case"italicBidi":t=!1;break;case"fontSizeBidi":t=11;break;case"fontFamilyBidi":t="Calibri";break;case"allCaps":case"Uppercase":case"Lowercase":case"CapitalizeEachWord":case"SentenceCase":case"ToggleCase":t=!1;break;case"localeIdAscii":case"localeIdFarEast":case"localeIdBidi":t=0;break;case"complexScript":t=!1;break;case"fontFamilyFarEast":case"fontFamilyAscii":case"fontFamilyNonFarEast":t=void 0;break;case"characterSpacing":t=0;break;case"scaling":t=100}return t},s.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.fontFamily===e.fontFamily&&this.bold===e.bold&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.underline===e.underline&&this.fontColor===e.fontColor&&this.strikethrough===e.strikethrough&&this.highlightColor===e.highlightColor&&this.bidi===e.bidi&&this.bdo===e.bdo&&this.allCaps===e.allCaps&&this.Uppercase===e.Uppercase&&this.Lowercase===e.Lowercase&&this.ToggleCase===e.ToggleCase&&this.SentenceCase===e.SentenceCase&&this.CapitalizeEachWord===e.CapitalizeEachWord&&this.localeIdBidi===e.localeIdBidi&&this.localeIdAscii===e.localeIdAscii&&this.localeIdFarEast===e.localeIdFarEast&&this.complexScript===e.complexScript&&this.fontFamilyAscii===e.fontFamilyAscii&&this.fontFamilyBidi===e.fontFamilyBidi&&this.fontFamilyFarEast===e.fontFamilyFarEast&&this.characterSpacing===e.characterSpacing&&this.scaling===e.scaling&&this.fontFamilyNonFarEast===e.fontFamilyNonFarEast},s.prototype.isSameFormat=function(e){return this.baseCharStyle===e.baseCharStyle&&this.uniqueCharacterFormat===e.uniqueCharacterFormat},s.prototype.cloneFormat=function(){var e=new s(void 0);return e.uniqueCharacterFormat=this.uniqueCharacterFormat,e.baseCharStyle=this.baseCharStyle,0<this.revisions.length?e.removedIds=$a.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice(),e},s.prototype.hasValue=function(e){return!_.isNullOrUndefined(this.uniqueCharacterFormat)&&!_.isNullOrUndefined(this.uniqueCharacterFormat.propertiesHash)&&(e=O.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,e),this.uniqueCharacterFormat.propertiesHash.containsKey(e))},s.prototype.clearFormat=function(){_.isNullOrUndefined(this.uniqueCharacterFormat)||0!==this.uniqueCharacterFormat.referenceCount||s.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0,this.baseCharStyle=void 0},s.prototype.destroy=function(){_.isNullOrUndefined(this.uniqueCharacterFormat)||s.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0,this.baseCharStyle=void 0,this.ownerBase=void 0},s.prototype.copyFormat=function(e){_.isNullOrUndefined(e)||(!_.isNullOrUndefined(e.uniqueCharacterFormat)&&e.uniqueCharacterFormat.propertiesHash&&this.updateUniqueCharacterFormat(e),_.isNullOrUndefined(e.baseCharStyle)||(this.baseCharStyle=e.baseCharStyle),0<e.revisions.length?this.removedIds=$a.cloneRevisions(e.revisions):this.removedIds=e.removedIds.slice())},s.prototype.isEqualTocFormat=function(e){return this.fontFamily===e.fontFamily&&this.bold===e.bold&&this.italic===e.italic&&this.strikethrough===e.strikethrough&&this.highlightColor===e.highlightColor&&this.fontFamilyAscii===e.fontFamilyAscii&&this.fontFamilyFarEast===e.fontFamilyFarEast&&this.fontFamilyNonFarEast===e.fontFamilyNonFarEast},s.prototype.copyTocFormat=function(e){_.isNullOrUndefined(e.bold)||(this.bold=e.bold),_.isNullOrUndefined(e.italic)||(this.italic=e.italic),_.isNullOrUndefined(e.strikethrough)||(this.strikethrough=e.strikethrough),_.isNullOrUndefined(e.highlightColor)||(this.highlightColor=e.highlightColor),_.isNullOrUndefined(e.fontFamily)||(this.fontFamily=e.fontFamily,this.fontFamilyAscii=e.fontFamily,this.fontFamilyFarEast=e.fontFamily,this.fontFamilyNonFarEast=e.fontFamily)},s.prototype.updateUniqueCharacterFormat=function(e){var t=void 0;this.uniqueCharacterFormat&&(t=this.uniqueCharacterFormat.mergeProperties(e.uniqueCharacterFormat),0===this.uniqueCharacterFormat.referenceCount)&&(s.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0),this.uniqueCharacterFormat=new O(s.uniqueFormatType),_.isNullOrUndefined(t)&&(t=this.uniqueCharacterFormat.mergeProperties(e.uniqueCharacterFormat)),this.uniqueCharacterFormat=s.uniqueCharacterFormats.addUniqueFormat(t,s.uniqueFormatType)},s.clear=function(){this.uniqueCharacterFormats.clear()},s.prototype.applyStyle=function(e){this.baseCharStyle=e},s.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},s.prototype.mergeFormat=function(e){_.isNullOrUndefined(this.getValue("bold"))&&(this.bold=e.getValue("bold")),_.isNullOrUndefined(this.getValue("italic"))&&(this.italic=e.getValue("italic")),_.isNullOrUndefined(this.getValue("fontSize"))&&(this.fontSize=e.getValue("fontSize")),_.isNullOrUndefined(this.getValue("characterSpacing"))&&(this.characterSpacing=e.getValue("characterSpacing")),_.isNullOrUndefined(this.getValue("scaling"))&&(this.scaling=e.getValue("scaling")),_.isNullOrUndefined(this.getValue("fontFamily"))?this.fontFamily=e.getValue("fontFamily"):(_.isNullOrUndefined(this.getValue("fontFamilyAscii"))&&(this.fontFamilyAscii=e.getValue("fontFamily")),_.isNullOrUndefined(this.getValue("fontFamilyFarEast"))&&(this.fontFamilyFarEast=e.getValue("fontFamily")),_.isNullOrUndefined(this.getValue("fontFamilyNonFarEast"))&&(this.fontFamilyNonFarEast=e.getValue("fontFamily"))),_.isNullOrUndefined(this.getValue("underline"))&&(this.underline=e.getValue("underline")),_.isNullOrUndefined(this.getValue("strikethrough"))&&(this.strikethrough=e.getValue("strikethrough")),_.isNullOrUndefined(this.getValue("baselineAlignment"))&&(this.baselineAlignment=e.getValue("baselineAlignment")),_.isNullOrUndefined(this.getValue("highlightColor"))&&(this.highlightColor=e.getValue("highlightColor")),_.isNullOrUndefined(this.getValue("fontColor"))&&(this.fontColor=e.getValue("fontColor")),_.isNullOrUndefined(this.getValue("bidi"))&&(this.bidi=e.getValue("bidi")),_.isNullOrUndefined(this.getValue("bdo"))&&(this.bdo=e.getValue("bdo")),_.isNullOrUndefined(this.getValue("allCaps"))&&(this.allCaps=e.getValue("allCaps")),_.isNullOrUndefined(this.getValue("Lowercase"))&&(this.Lowercase=e.getValue("Lowercase")),_.isNullOrUndefined(this.getValue("SentenceCase"))&&(this.SentenceCase=e.getValue("SentenceCase")),_.isNullOrUndefined(this.getValue("ToggleCase"))&&(this.ToggleCase=e.getValue("ToggleCase")),_.isNullOrUndefined(this.getValue("CapitalizeEachWord"))&&(this.CapitalizeEachWord=e.getValue("CapitalizeEachWord")),_.isNullOrUndefined(this.getValue("Uppercase"))&&(this.Uppercase=e.getValue("Uppercase")),_.isNullOrUndefined(this.getValue("localeIdBidi"))&&(this.localeIdBidi=e.getValue("localeIdBidi")),_.isNullOrUndefined(this.getValue("localeIdAscii"))&&(this.localeIdAscii=e.getValue("localeIdAscii")),_.isNullOrUndefined(this.getValue("localeIdFarEast"))&&(this.localeIdFarEast=e.getValue("localeIdFarEast")),_.isNullOrUndefined(this.getValue("complexScript"))&&(this.complexScript=e.getValue("complexScript")),_.isNullOrUndefined(this.getValue("fontFamilyAscii"))&&(this.fontFamilyAscii=e.getValue("fontFamilyAscii")),_.isNullOrUndefined(this.getValue("fontFamilyBidi"))&&(this.fontFamilyBidi=e.getValue("fontFamilyBidi")),_.isNullOrUndefined(this.getValue("fontFamilyFarEast"))&&(this.fontFamilyFarEast=e.getValue("fontFamilyFarEast")),_.isNullOrUndefined(this.getValue("fontFamilyNonFarEast"))&&(this.fontFamilyNonFarEast=e.getValue("fontFamilyNonFarEast"))},s.prototype.assignFormat=function(e){e.hasValue("bold")&&(this.bold=e.getValue("bold")),e.hasValue("italic")&&(this.italic=e.getValue("italic")),e.hasValue("fontSize")&&(this.fontSize=e.getValue("fontSize")),e.hasValue("characterSpacing")&&(this.characterSpacing=e.getValue("characterSpacing")),e.hasValue("scaling")&&(this.scaling=e.getValue("scaling")),e.hasValue("fontFamily")&&(this.fontFamily=e.getValue("fontFamily")),e.hasValue("fontFamilyAscii")&&(this.fontFamilyAscii=e.getValue("fontFamilyAscii")),e.hasValue("fontFamilyFarEast")&&(this.fontFamilyFarEast=e.getValue("fontFamilyFarEast")),e.hasValue("fontFamilyNonFarEast")&&(this.fontFamilyNonFarEast=e.getValue("fontFamilyNonFarEast")),e.hasValue("underline")&&(this.underline=e.getValue("underline")),e.hasValue("strikethrough")&&(this.strikethrough=e.getValue("strikethrough")),e.hasValue("baselineAlignment")&&(this.baselineAlignment=e.getValue("baselineAlignment")),e.hasValue("highlightColor")&&(this.highlightColor=e.getValue("highlightColor")),e.hasValue("fontColor")&&(this.fontColor=e.getValue("fontColor")),e.hasValue("bidi")&&(this.bidi=e.getValue("bidi")),e.hasValue("bdo")&&(this.bdo=e.getValue("bdo")),e.hasValue("allCaps")&&(this.allCaps=e.getValue("allCaps")),e.hasValue("Lowercase")&&(this.Lowercase=e.getValue("Lowercase")),e.hasValue("SentenceCase")&&(this.SentenceCase=e.getValue("SentenceCase")),e.hasValue("ToggleCase")&&(this.ToggleCase=e.getValue("ToggleCase")),e.hasValue("CapitalizeEachWord")&&(this.CapitalizeEachWord=e.getValue("CapitalizeEachWord")),e.hasValue("Uppercase")&&(this.Uppercase=e.getValue("Uppercase")),e.hasValue("localeIdBidi")&&(this.localeIdBidi=e.getValue("localeIdBidi")),e.hasValue("localeIdAscii")&&(this.localeIdAscii=e.getValue("localeIdAscii")),e.hasValue("localeIdFarEast")&&(this.localeIdFarEast=e.getValue("localeIdFarEast")),e.hasValue("complexScript")&&(this.complexScript=e.getValue("complexScript")),e.hasValue("fontFamilyBidi")&&(this.fontFamilyBidi=e.getValue("fontFamilyBidi"))},s.prototype.hasValueWithParent=function(e){var t=this.hasValue(e),i=(!t&&!_.isNullOrUndefined(this.baseCharStyle)&&this.baseCharStyle instanceof fl&&(t=this.baseCharStyle.characterFormat.hasValue(e)),this.documentCharacterFormat());return t=t||_.isNullOrUndefined(i)?t:i.hasValue(e)},s.uniqueCharacterFormats=new e,s.uniqueFormatType=2;var B=s;function s(e){this.uniqueCharacterFormat=void 0,this.ownerBase=void 0,this.baseCharStyle=void 0,this.removedIds=[],this.revisions=[],this.ownerBase=e}m.insert=function(e,t,i){return 0<=t?[e.slice(0,t)+i+e.slice(t)].join(""):i+this},m.replaceSpecialChars=function(e){return e=(e=(e=e.replace("^[\\s]*","")).replace("^[#@!~\\$%^&\\*\\(\\)\\-_\\+\\.=\\{\\}\\[\\]:;,<>\\?'\\\\\"\\“\\”\\//0123456789]+","")).replace("[#@!~\\$%^&\\*\\(\\)\\-_\\+\\.=\\{\\}\\[\\]:;,<>\\?'\\\\\"\\“\\”\\//0123456789]+$","")},m.getSpellCheckData=function(e){for(var t=[],i=0,n=(e=(e=(e=(e=(e=(e=e.replace("\r\n"," ")).replace("\n"," ")).replace("\r"," ")).replace("\v"," ")).replace("\t"," ")).replace("/"," ")).split(" ");i<n.length;i++){var r=n[i],o={};o.Text=this.replaceSpecialChars(r),o.HasSpellError=!1,t.push(o)}return t},m.checkTextFormat=function(e){return!(!/^(M{0,3})(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/i.test(e)&&!/^[0-9]+$/.test(e))},m.sanitizeString=function(e){return _.isNullOrUndefined(e)?"":_.SanitizeHtmlHelper.sanitize(e).replace(/&amp;/g,"&").replace(/&nbsp;/g,String.fromCharCode(160)).replace(/&gt;/g,">").replace(/&lt;/g,"<")},m.getSfdtDocument=function(e){var t;return e=e instanceof Object?e:JSON.parse(e),_.isNullOrUndefined(e.sfdt)||((t=new f.ZipArchive).open(JSON.stringify(e.sfdt)),t=t.items[0],t=new Uint8Array(t.data),t=new TextDecoder("utf-8").decode(t),e=JSON.parse(t)),e},m.generateUniqueId=function(e,t){var i=!_.isNullOrUndefined(t),n=Math.floor(1e8*Math.random());return i?this.isSameListIDExists(n,void 0,t,i)?this.generateUniqueId(void 0,t):n:this.isSameListIDExists(n,e)?this.generateUniqueId(e):n},m.generateHexDecimal=function(){return(Math.floor(373e7*Math.random())+27e7).toString(16).toUpperCase()},m.numberToHexDecimal=function(e){return e.toString(16).toUpperCase()},m.isSameListIDExists=function(e,t,i,n){if(n){for(var r=0;r<i.length;r++)if(e===i[parseInt(r.toString(),10)].nsid)return!0}else for(var o=0;o<t.length;o++)if(e===t[parseInt(o.toString(),10)].nsid)return!0;return!1},m.remove=function(e,t){return 0===t?e.substring(t+1,e.length):e.substring(0,t)+e.substring(t+1,e.length)},m.indexOfAny=function(e,t){for(var i=void 0,n=0;n<t.length;n++){var r=e.indexOf(t[parseInt(n.toString(),10)]);(-1!==r&&_.isNullOrUndefined(i)||-1!==r&&r<i)&&(i=r)}return _.isNullOrUndefined(i)?-1:i},m.lastIndexOfAny=function(e,t){for(var i=e.length-1;0<=i;i--)for(var n=0;n<=t.length-1;n++)if(e[parseInt(i.toString(),10)]===t[parseInt(n.toString(),10)])return i;return-1},m.convertArgbToRgb=function(e){return 8<=e.length?e.substr(0,6):e},m.convertRgbToHex=function(e){e=Number(e).toString(16);return e=e.length<2?"0"+e:e},m.getNumberFromString=function(e){for(var t=[],i="",n=0,r=e;n<r.length;n++){var o=r[n];/\d|\./.test(o)?i+=o:i&&(t.push(parseFloat(i)),i="")}return i&&t.push(parseFloat(i)),parseFloat(t.join(""))},m.convertHexToRgb=function(e){var t,i,n,r;if(e)return e=e.replace(/[^0-9A-â€Œâ€‹F]/gi,""),r=parseInt(e,16),8===e.length?(t=r>>32&255,i=r>>16&255,n=r>>8&255):6===e.length&&(t=r>>16&255,i=r>>8&255,n=255&r),{r:t,g:i,b:n}},m.addCssStyle=function(e){var t=document.createElement("style");t.style.cssText?t.style.cssText=e:t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t)},m.convertNodeListToArray=function(e){var t=[];if(!_.isNullOrUndefined(e))for(var i=0;i<e.length;i++)t.push(e[parseInt(i.toString(),10)]);return t},m.getHighlightColorCode=function(e){var t="#ffffff";switch(e){case"Yellow":t="#ffff00";break;case"BrightGreen":t="#00ff00";break;case"Turquoise":t="#00ffff";break;case"Pink":t="#ff00ff";break;case"Blue":t="#0000ff";break;case"Red":t="#ff0000";break;case"DarkBlue":t="#000080";break;case"Teal":t="#008080";break;case"Green":t="#008000";break;case"Violet":t="#800080";break;case"DarkRed":t="#800000";break;case"DarkYellow":t="#808000";break;case"Gray50":t="#808080";break;case"Gray25":t="#c0c0c0";break;case"Black":t="#000000"}return t},m.isVeryDark=function(e){e=e.substring(1);return(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3<=60},m.getColor=function(e){return 0<e.length&&"#"===e[0]&&7<e.length?e.substr(0,7):e},m.getTextVerticalAlignment=function(e){switch(e){case 0:return"Top";case 1:return"Middle";case 2:return"Bottom";default:return e}},m.convertPointToPixel=function(e){return e=m.round(e,5),m.round(96*e/72,5)},m.convertPixelToPoint=function(e){return m.round(72*e/96,5)},m.isLinkedFieldCharacter=function(e){return e instanceof Z&&0===e.fieldType?!_.isNullOrUndefined(e.fieldEnd):e instanceof Z&&2===e.fieldType?!_.isNullOrUndefined(e.fieldBegin)&&!_.isNullOrUndefined(e.fieldEnd):!_.isNullOrUndefined(e.fieldBegin)},m.removeSpace=function(e){if(!_.isNullOrUndefined(e)&&0!==e.length)for(var t=0;t<e.length;t++)" "===e.charAt(t)&&(e=e.replace(" ",""));return e},m.trimStart=function(e){for(var t=0;t<e.length&&" "===e[parseInt(t.toString(),10)];t++);return e.substring(t,e.length)},m.trimEnd=function(e){for(var t=e.length-1;0<=t&&" "===e[parseInt(t.toString(),10)];t--);return e.substring(0,t+1)},m.endsWith=function(e){return!_.isNullOrUndefined(e)&&0!==e.length&&" "===e[e.length-1]},m.addSpace=function(e){var t="";if(0<e)for(var i=0;i<e;i++)t+=" ";return t},m.getBoolValue=function(e){return e?1:0},m.getBoolInfo=function(e,t){return 1===t?this.getBoolValue(e):e},m.parseBoolValue=function(e){return e instanceof String?!_.isNullOrUndefined(e)&&"f"!==e&&"0"!==e&&"off"!==e&&"false"!==e:1==e},m.getBaselineAlignmentEnumValue=function(e){switch(e){case"Normal":return 0;case"Superscript":return 1;case"Subscript":return 2}},m.getUnderlineEnumValue=function(e){switch(e){case"None":return 0;case"Single":return 1;case"Words":return 2;case"Double":return 3;case"Dotted":return 4;case"Thick":return 5;case"Dash":return 6;case"DashLong":return 7;case"DotDash":return 8;case"DotDotDash":return 9;case"Wavy":return 10;case"DottedHeavy":return 11;case"DashHeavy":return 12;case"DashLongHeavy":return 13;case"DotDashHeavy":return 14;case"DotDotDashHeavy":return 15;case"WavyHeavy":return 16;case"WavyDouble":return 17}},m.getStrikeThroughEnumValue=function(e){switch(e){case"None":return 0;case"SingleStrike":return 1;case"DoubleStrike":return 2}},m.getHighlightColorEnumValue=function(e){switch(e){case"NoColor":return 0;case"Yellow":return 1;case"BrightGreen":return 2;case"Turquoise":return 3;case"Pink":return 4;case"Blue":return 5;case"Red":return 6;case"DarkBlue":return 7;case"Teal":return 8;case"Green":return 9;case"Violet":return 10;case"DarkRed":return 11;case"DarkYellow":return 12;case"Gray50":return 13;case"Gray25":return 14;case"Black":return 15}},m.getBiDirectionalOverride=function(e){switch(e){case"None":return 0;case"LTR":return 1;case"RTL":return 2}},m.getBreakClearType=function(e){switch(e){case"None":return 0;case"Left":return 1;case"Right":return 2;case"All":return 3}},m.getOutlineLevelEnumValue=function(e){switch(e){case"BodyText":return 0;case"Level1":return 1;case"Level2":return 2;case"Level3":return 3;case"Level4":return 4;case"Level5":return 5;case"Level6":return 6;case"Level7":return 7;case"Level8":return 8;case"Level9":return 9}},m.getTextAlignmentEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Right":return 2;case"Justify":return 3}},m.getLineStyleEnumValue=function(e){switch(e){case"Single":return 0;case"None":return 1;case"Dot":return 2;case"DashSmallGap":return 3;case"DashLargeGap":return 4;case"DashDot":return 5;case"DashDotDot":return 6;case"Double":return 7;case"Triple":return 8;case"ThinThickSmallGap":return 9;case"ThickThinSmallGap":return 10;case"ThinThickThinSmallGap":return 11;case"ThinThickMediumGap":return 12;case"ThickThinMediumGap":return 13;case"ThinThickThinMediumGap":return 14;case"ThinThickLargeGap":return 15;case"ThickThinLargeGap":return 16;case"ThinThickThinLargeGap":return 17;case"SingleWavy":return 18;case"DoubleWavy":return 19;case"DashDotStroked":return 20;case"Emboss3D":return 21;case"Engrave3D":return 22;case"Outset":return 23;case"Inset":return 24;case"Thick":return 25;case"Cleared":return 26}},m.getLineSpacingTypeEnumValue=function(e){switch(e){case"Multiple":return 0;case"AtLeast":return 1;case"Exactly":return 2}},m.writeBorder=function(e,t){var i={};return i[Or[t]]=e.hasValue("color")?e.color:void 0,i[nn[t]]=e.hasValue("hasNoneStyle")?m.getBoolInfo(e.hasNoneStyle,t):void 0,i[ln[t]]=e.hasValue("lineStyle")?1==t?this.getLineStyleEnumValue(e.lineStyle):e.lineStyle:void 0,i[dn[t]]=e.hasValue("lineWidth")?e.lineWidth:void 0,i[tn[t]]=e.hasValue("shadow")?m.getBoolInfo(e.shadow,t):void 0,i[Qs[t]]=e.hasValue("space")?e.space:void 0,i},m.writeBorders=function(e,t){var i={};return i[Dr[t]]=this.writeBorder(e.getBorder("top"),t),i[zr[t]]=this.writeBorder(e.getBorder("left"),t),i[Vr[t]]=this.writeBorder(e.getBorder("right"),t),i[Ur[t]]=this.writeBorder(e.getBorder("bottom"),t),i[on[t]]=this.writeBorder(e.getBorder("horizontal"),t),i[rn[t]]=this.writeBorder(e.getBorder("vertical"),t),i},m.writeParagraphFormat=function(e,t,i,n){n=_.isNullOrUndefined(n)?0:n,e[si[n]]=this.writeBorders(i.borders,n),e[_t[n]]=t?i.leftIndent:i.getValue("leftIndent"),e[jt[n]]=t?i.rightIndent:i.getValue("rightIndent"),e[Gt[n]]=t?i.firstLineIndent:i.getValue("firstLineIndent"),e[Kt[n]]=t?1==n?this.getTextAlignmentEnumValue(i.textAlignment):i.textAlignment:1==n?this.getTextAlignmentEnumValue(i.getValue("textAlignment")):i.getValue("textAlignment"),e[Xt[n]]=t?i.beforeSpacing:i.getValue("beforeSpacing"),e[Zt[n]]=t?i.afterSpacing:i.getValue("afterSpacing"),e[Yt[n]]=t?m.getBoolInfo(i.spaceBeforeAuto,n):i.getValue("spaceBeforeAuto"),e[Jt[n]]=t?m.getBoolInfo(i.spaceAfterAuto,n):i.getValue("spaceAfterAuto"),e[Qt[n]]=t?i.lineSpacing:i.getValue("lineSpacing"),e[$t[n]]=t?1==n?this.getLineSpacingTypeEnumValue(i.lineSpacingType):i.lineSpacingType:1==n?this.getLineSpacingTypeEnumValue(i.getValue("lineSpacingType")):i.getValue("lineSpacingType"),e[Pt[n]]=_.isNullOrUndefined(i.baseStyle)?void 0:i.baseStyle.name,e[ri[n]]=t?1==n?this.getOutlineLevelEnumValue(i.outlineLevel):i.outlineLevel:1==n?this.getOutlineLevelEnumValue(i.getValue("outlineLevel")):i.getValue("outlineLevel"),e[Tt[n]]=t?m.getBoolInfo(i.bidi,n):i.getValue("bidi"),e[ni[n]]=t?m.getBoolInfo(i.keepLinesTogether,n):i.getValue("keepLinesTogether"),e[ti[n]]=t?m.getBoolInfo(i.keepWithNext,n):i.getValue("keepWithNext"),e[oi[n]]=t?m.getBoolInfo(i.contextualSpacing,n):i.getValue("contextualSpacing"),e[ii[n]]=t?m.getBoolInfo(i.widowControl,n):i.getValue("widowControl")},m.writeCharacterFormat=function(e,t,i,n,r){n=_.isNullOrUndefined(n)?0:n,e[ft[n]]=r||t?m.getBoolInfo(i.bold,n):i.getValue("bold"),e[yt[n]]=r||t?m.getBoolInfo(i.italic,n):i.getValue("italic"),e[It[n]]=r?i.fontSize:t?this.toWriteInline(i,"fontSize"):i.getValue("fontSize"),e[Ft[n]]=r?i.fontFamily:t?this.toWriteInline(i,"fontFamily"):i.getValue("fontFamily"),e[vt[n]]=r?i.underline:t?1==n?m.getUnderlineEnumValue(i.underline):i.underline:1==n?m.getUnderlineEnumValue(i.getValue("underline")):i.getValue("underline"),e[wt[n]]=r?i.underlineColor:t?this.toWriteInline(i,"underlineColor"):i.getValue("underlineColor"),e[xt[n]]=r?i.strikethrough:t?1==n?m.getStrikeThroughEnumValue(i.strikethrough):i.strikethrough:1==n?m.getStrikeThroughEnumValue(i.getValue("strikethrough")):i.getValue("strikethrough"),e[bt[n]]=r?i.baselineAlignment:t?1==n?m.getBaselineAlignmentEnumValue(i.baselineAlignment):i.baselineAlignment:1==n?m.getBaselineAlignmentEnumValue(i.getValue("baselineAlignment")):i.getValue("baselineAlignment"),e[Ct[n]]=r?i.highlightColor:t?1==n?m.getHighlightColorEnumValue(i.highlightColor):i.highlightColor:1==n?m.getHighlightColorEnumValue(i.getValue("highlightColor")):i.getValue("highlightColor"),e[kt[n]]=r?i.fontColor:t?this.toWriteInline(i,"fontColor"):i.getValue("fontColor"),e[Pt[n]]=_.isNullOrUndefined(i.baseCharStyle)?void 0:i.baseCharStyle.name,e[Tt[n]]=r?i.bidi:t?m.getBoolInfo(i.bidi,n):i.getValue("bidi"),e[St[n]]=r?i.bdo:t?1==n?m.getBiDirectionalOverride(i.bdo):i.bdo:1==n?m.getBiDirectionalOverride(i.getValue("bdo")):i.getValue("bdo"),e[Ot[n]]=r?i.boldBidi:t?m.getBoolInfo(i.boldBidi,n):i.getValue("boldBidi"),e[Et[n]]=r?i.italicBidi:t?m.getBoolInfo(i.italicBidi,n):i.getValue("italicBidi"),e[Nt[n]]=r||t?i.fontSizeBidi:i.getValue("fontSizeBidi"),e[Wt[n]]=r||t?i.fontFamilyBidi:i.getValue("fontFamilyBidi"),e[Lt[n]]=r?i.allCaps:t?m.getBoolInfo(i.allCaps,n):i.getValue("allCaps"),e[mt[n]]=r||t?i.localeIdBidi:i.getValue("localeIdBidi"),e[ut[n]]=r?i.localeIdBidi:t?i.localeIdAscii:i.getValue("localeIdAscii"),e[Bt[n]]=r?i.complexScript:t?m.getBoolInfo(i.complexScript,n):i.getValue("complexScript"),e[Rt[n]]=r?i.fontFamilyAscii:t?this.toWriteInline(i,"fontFamilyAscii"):i.getValue("fontFamilyAscii"),e[At[n]]=r?i.fontFamilyNonFarEast:t?this.toWriteInline(i,"fontFamilyNonFarEast"):i.getValue("fontFamilyNonFarEast"),e[Mt[n]]=r?i.fontFamilyFarEast:t?this.toWriteInline(i,"fontFamilyFarEast"):i.getValue("fontFamilyFarEast"),e[Vt[n]]=r?i.characterSpacing:t?this.toWriteInline(i,"characterSpacing"):i.getValue("characterSpacing"),e[zt[n]]=r?i.scaling:t?this.toWriteInline(i,"scaling"):i.getValue("scaling"),(i.hasValue("fontFamily")||r)&&(_.isNullOrUndefined(e[Rt[n]])&&(e[Rt[n]]=i.fontFamily),_.isNullOrUndefined(e[At[n]])&&(e[At[n]]=i.fontFamily),_.isNullOrUndefined(e[Mt[n]]))&&(e[Mt[n]]=i.fontFamily)},m.isThemeFont=function(e){return"majorAscii"==e||"majorBidi"==e||"majorEastAsia"==e||"majorHAnsi"==e||"minorAscii"==e||"minorBidi"==e||"minorEastAsia"==e||"minorHAnsi"==e},m.toWriteInline=function(e,t){return _.isNullOrUndefined(e.ownerBase)||!(e.ownerBase instanceof mh)||e.hasValue(t)?e[t]:e.getValue(t)},m.round=function(e,t){for(var i=e,n=0;n<t;n++)i*=10;for(i=Math.round(i),n=0;n<t;n++)i/=10;return i},m.removeInvalidXmlChars=function(e){return e.replace(/[^\x09\x0A\x0C\x0D\v\f\r\u000E\x20-\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}]/gu,"")},m.commentInlines=function(e,r,o){var s=this,t=[];return e.split(/<\/?div>/).filter(Boolean).map(function(e){return e.trim()}).filter(Boolean).map(function(e){return"<br>"===e?e:e.split(/<br\s*\/?>/)}).flat().forEach(function(e){var n={};n[ko[o]]=[],""!==e&&"<br>"!==e&&(e=e.replace(/&nbsp;/g," ")).match(/(<[^>]+>[^<]*<\/[^>]+>|[^<]+)/g).forEach(function(e){var t,i;0===e.indexOf("<span")?(i=(i=e.match(/<span[^>]*>([^<]*)<\/span>/))?i[1].trim():"",t=s.getEmailIdByName(i,r),n=s.serializeMentions(i,t,n,o)):((i={})[dr[o]]=e,n[ko[o]].push(i))}),t.push(n)}),t},m.parseCommentAsText=function(e){var t=document.createElement("div"),i=(t.innerHTML=e.text,t.querySelectorAll("span.e-mention-chip")),e=JSON.stringify(e.mentions),n=JSON.parse(e),r=0;if(i.length!==n.length)throw new Error("The lengths of spanElements and inputData do not match");return i.forEach(function(e){var t,i;r in n&&((t=n[r])&&"string"==typeof t.value&&"string"==typeof t.text&&((i=document.createElement("a")).href="mailto:"+t.value,i.textContent="@"+t.text,e.replaceWith(i)),r++)}),t.innerHTML.replace(/<br>/g,"\r\n")},m.getEmailIdByName=function(e,t){for(var i=0,n=t;i<n.length;i++){var r=n[i];if(r.text===e)return _.isNullOrUndefined(r.value)?r.text+".com":r.value}return""},m.serializeMentions=function(e,t,i,n){var r={},r=(r[Ae[n]]={},r[Kr[n]]=0,r[jr[n]]=!0,i[ko[n]].push(r),{}),t=(r[Ae[n]]={},r[dr[n]]=' HYPERLINK "mailto:'+t+'" ',i[ko[n]].push(r),{}),r=(t[Ae[n]]={},t[Kr[n]]=2,i[ko[n]].push(t),{}),t=(r[Ae[n]]={underline:"Single",fontColor:"#0563c1",bidi:!1},r[dr[n]]=e,i[ko[n]].push(r),{});return t[Ae[n]]={},t[Kr[n]]=1,i[ko[n]].push(t),i},m.reverseString=function(e){return e=_.isNullOrUndefined(e)||""===e?e:e.split("").reverse().join("")},m.formatClippedString=function(e){var t="",i="";return this.startsWith(e,"data:image/svg+xml;base64,")?(t=".svg",i=e.replace("data:image/svg+xml;base64,","")):this.startsWith(e,"data:image/svg+xml;utf8,")?(t=".svg",i=e.replace("data:image/svg+xml;utf8,","")):this.startsWith(e,"data:image/bmp;base64,")?(t=".bmp",i=e.replace("data:image/bmp;base64,","")):this.startsWith(e,"data:image/x-emf;base64,")?(t=".emf",i=e.replace("data:image/x-emf;base64,","")):this.startsWith(e,"data:image/exif;base64,")?(t=".exif",i=e.replace("data:image/exif;base64,","")):this.startsWith(e,"data:image/gif;base64,")?(t=".gif",i=e.replace("data:image/gif;base64,","")):this.startsWith(e,"data:image/icon;base64,")?(t=".ico",i=e.replace("data:image/icon;base64,","")):this.startsWith(e,"data:image/jpeg;base64,")?(t=".jpeg",i=e.replace("data:image/jpeg;base64,","")):this.startsWith(e,"data:image/jpg;base64,")?(t=".jpg",i=e.replace("data:image/jpg;base64,","")):this.startsWith(e,"data:image/png;base64,")?(t=".png",i=e.replace("data:image/png;base64,","")):this.startsWith(e,"data:image/tiff;base64,")?(t=".tif",i=e.replace("data:image/tiff;base64,","")):this.startsWith(e,"data:image/x-wmf;base64,")?(t=".wmf",i=e.replace("data:image/x-wmf;base64,","")):t=".jpeg",{extension:t,formatClippedString:i}},m.startsWith=function(e,t){return 0<t.length&&e.substring(0,t.length)===t},m.formatText=function(e,t){var i=t;switch(e.toLowerCase()){case"uppercase":i=t.toUpperCase();break;case"lowercase":i=t.toLowerCase();break;case"firstlower":i=this.lowerFirstChar(t);break;case"firstcapital":i=this.capitaliseFirst(t,"FirstCapital");break;case"titlecase":i=this.capitaliseFirst(t,"Titlecase")}return i},m.formatNumber=function(e,t){var i=new _.Internationalization,n=(t=t.split(".")[0],i.parseNumber(t));return"NaN"===t.toString()?"":i.formatNumber(n,{format:e=""===e?"0":e})},m.formatDate=function(e,t){var i=new _.Internationalization,n=new Date(t);return isNaN(n.getDate())?"":""===e?t:(-1!==e.indexOf("am/pm")&&(e=e.replace(/am\/pm/gi,"a")),i.formatDate(n,{format:e}))},m.capitaliseFirst=function(e,t,i){var n="";if("Titlecase"===t){for(var r=i?e.split(i):e.split(" "),o=0;o<r.length;o++)n+=i?r[parseInt(o.toString(),10)].charAt(0).toUpperCase()+r[parseInt(o.toString(),10)].slice(1,r[parseInt(o.toString(),10)].length):this.capitaliseFirstInternal(r[parseInt(o.toString(),10)]),0<=r.length&&!i&&(n+=" ");i||(n=this.capitaliseFirst(n,"Titlecase","\r"))}else"FirstCapital"===t&&(n=this.capitaliseFirstInternal(e));return n},m.lowerFirstChar=function(e){return e.charAt(0).toLowerCase()+e.slice(1,e.length)},m.capitaliseFirstInternal=function(e){return e.charAt(0).toUpperCase()+e.slice(1,e.length).toLowerCase()},m.getModifiedDate=function(e){e=m.getLocaleDate(e);return e.toLocaleDateString([],{year:"numeric",month:"long",day:"numeric"})+" "+e.toLocaleTimeString([],{hour:"numeric",minute:"numeric"})},m.getUtcDate=function(e){return _.isNullOrUndefined(e)&&(e=new Date),new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString()},m.getLocaleDate=function(e){e=new Date(e);return new Date(e.getTime()+6e4*e.getTimezoneOffset())},m.getCompatibilityModeValue=function(e){var t;switch(e){case 1:t="11";break;case 2:t="12";break;case 3:t="14";break;default:t="15"}return t},m.getUniqueElementId=function(){return"de_element"+Date.now().toString(36)+Math.random().toString(36).substring(2)},m.splitSpaceInTextElementBox=function(e,t){var i=e.text,n="";if(t)for(;m.startsWith(i," ");)n+=" ",i=i.substring(1);else for(;m.endsWith(i);)n+=" ",i=i.slice(0,-1);if(""!=n){var r=new X;if(r.characterFormat.copyFormat(e.characterFormat),0<e.revisions.length){for(var o=0;o<e.revisions.length;o++){var s=e.revisions[o],a=(r.revisions.push(s),s.range.indexOf(e));a<0?s.range.push(r):s.range.splice(a+1,0,r)}r.isMarkedForRevision=e.isMarkedForRevision}r.line=e.line;var l=r.line.children;t?(e.text=n,r.text=i):(e.text=i,r.text=n),l.splice(l.indexOf(e)+1,0,r)}},m.getTextIndexAfterWhitespace=function(e,t){var i=e.length,n=e.indexOf(" ",t)+1;if(0!==n&&n!==i)for(;" "===e[n]&&++n!==i;);return n},m.splitWordByMaxLength=function(e,t,i){for(var n=e.text,r=0,o=n.length,s=e.characterFormat,a=e.revisions,l=t.children.indexOf(e);r<o;){var d=r+90,h=m.getTextIndexAfterWhitespace(n,d=o<d?o:d);if((0===h||o<h)&&(h=d),d=n.substring(r,h),0===r)e.text=d,e.isWidthUpdated=!1;else{var c=new X;if(c.text=d,c.line=t,c.characterFormat.copyFormat(s),0<a.length)for(var p=0;p<a.length;p++){var u=a[p],g=(c.revisions.push(u),u.range.indexOf(e));i||g<0?u.range.push(c):u.range.splice(g+1,0,c)}i?t.children.push(c):(t.children.splice(l+1,0,c),l++)}r=h}},m.wordBefore="\\b",m.wordAfter="\\b",m.wordSplitCharacters=[" ",",",".",":",";","<",">","=","+","-","_","{","}","[","]","`","~","!","@","#","$","%","^","&","*","(",")",'"',"?","/","|","\\","”","　","،","؟","؛","’","‘"];var j=m;function m(){}Object.defineProperty(rl.prototype,"x",{get:function(){return this.xIn},set:function(e){this.xIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(rl.prototype,"y",{get:function(){return this.yIn},set:function(e){this.yIn=e},enumerable:!0,configurable:!0}),rl.prototype.copy=function(e){this.xIn=e.xIn,this.yIn=e.yIn},rl.prototype.destroy=function(){this.xIn=void 0,this.yIn=void 0};var nl=rl;function rl(e,t){this.xIn=0,this.yIn=0,this.xIn=e,this.yIn=t}sl.prototype.encodeString=function(e){var t,i,n,r,o,s,a="",l=0;for(e=this.unicodeEncode(e);l<e.length;)n=(t=e.charCodeAt(l++))>>2,r=(3&t)<<4|(t=e.charCodeAt(l++))>>4,o=(15&t)<<2|(i=e.charCodeAt(l++))>>6,s=63&i,isNaN(t)?o=s=64:isNaN(i)&&(s=64),a=a+this.keyStr.charAt(n)+this.keyStr.charAt(r)+this.keyStr.charAt(o)+this.keyStr.charAt(s);return a},sl.prototype.unicodeEncode=function(e){for(var t=e.replace(/\r\n/g,"\n"),i="",n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?i+=String.fromCharCode(r):i=127<r&&r<2048?(i+=String.fromCharCode(r>>6|192))+String.fromCharCode(63&r|128):(i=(i+=String.fromCharCode(r>>12|224))+String.fromCharCode(r>>6&63|128))+String.fromCharCode(63&r|128)}return i},sl.prototype.decodeString=function(e){var t,i,n,r,o,s,a=0,l=0,d=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===this.keyStr.charAt(64)&&d--,e.charAt(e.length-2)===this.keyStr.charAt(64)&&d--,d%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var h=new Uint8Array(0|d);a<e.length;)n=this.keyStr.indexOf(e.charAt(a++)),t=(15&(r=this.keyStr.indexOf(e.charAt(a++))))<<4|(o=this.keyStr.indexOf(e.charAt(a++)))>>2,i=(3&o)<<6|(s=this.keyStr.indexOf(e.charAt(a++))),h[l++]=n<<2|r>>4,64!==o&&(h[l++]=t),64!==s&&(h[l++]=i);return h},sl.prototype.destroy=function(){this.keyStr=void 0};var ol=sl;function sl(){this.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}Object.defineProperty(ll.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0});var al=ll;function ll(e,t){this.x=0,this.width=0,this.x=e,this.width=t}function dl(){}hl=function(e,t){return(hl=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}))(e,t)};var hl,cl,pl=function(e,t){function i(){this.constructor=e}hl(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},ul=(pl(gl,cl=dl),gl.prototype.clear=function(){this.characterFormat&&this.characterFormat.clearFormat(),this.paragraphFormat&&this.paragraphFormat.clearFormat()},gl.prototype.destroy=function(){this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.ownerBase=void 0,this.name=void 0,this.next=void 0,this.basedOn=void 0,this.link=void 0},gl.prototype.copyStyle=function(e){this.name=e.name,this.ownerBase=e.ownerBase,this.type=e.type,this.next=e.next,this.basedOn=e.basedOn,this.link=e.link,this.characterFormat.copyFormat(e.characterFormat),this.paragraphFormat.copyFormat(e.paragraphFormat)},gl);function gl(e){var t=cl.call(this)||this;return t.ownerBase=e,t.paragraphFormat=new Xa(t),t.characterFormat=new B(t),t}pl(yl,ml=dl),yl.prototype.clear=function(){this.characterFormat&&this.characterFormat.clearFormat()},yl.prototype.destroy=function(){this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.ownerBase=void 0,this.name=void 0,this.next=void 0,this.basedOn=void 0,this.link=void 0},yl.prototype.copyStyle=function(e){this.name=e.name,this.ownerBase=e.ownerBase,this.type=e.type,this.next=e.next,this.basedOn=e.basedOn,this.characterFormat.copyFormat(e.characterFormat)};var ml,fl=yl;function yl(e){var t=ml.call(this)||this;return t.ownerBase=e,t.characterFormat=new B(t),t}pl(bl,vl=dl),bl.prototype.destroy=function(){this.ownerBase=void 0,this.name=void 0,this.next=void 0,this.basedOn=void 0,this.link=void 0};var vl,wl=bl;function bl(e){var t=vl.call(this)||this;return t.ownerBase=e,t}Object.defineProperty(Cl.prototype,"length",{get:function(){return this.collection.length},enumerable:!0,configurable:!0}),Cl.prototype.remove=function(t){this.collection=this.collection.filter(function(e){return e.name!==t.name})},Cl.prototype.push=function(e){return null!=e&&void 0!==e&&this.collection.push(e),1},Cl.prototype.getItem=function(e){return this.collection.length>e?this.collection[parseInt(e.toString(),10)]:null},Cl.prototype.indexOf=function(e){return this.collection.indexOf(e)},Cl.prototype.contains=function(e){e=this.collection.indexOf(e);return-1<e&&e<this.collection.length},Cl.prototype.clear=function(){if(this.collection&&0<this.collection.length)for(var e=0;e<this.collection.length;e++){var t=this.collection[parseInt(e.toString(),10)];(t instanceof fl||t instanceof ul)&&t.clear()}this.collection=[]},Cl.prototype.findByName=function(e,t){for(var i,n=0,r=this.collection;n<r.length;n++){var o=r[n];o.name===e&&(i=o,_.isNullOrUndefined(t)||o.type!==t&&(i=void 0))}return i},Cl.prototype.getStyleNames=function(t){return this.collection.filter(function(e){return e.type===t}).map(function(e){return e.name})},Cl.prototype.getStyles=function(t){for(var e=[],i=0,n=this.collection.filter(function(e){return e.type===t}).map(function(e){return e});i<n.length;i++){var r=n[i],o={},s={};"Paragraph"===t&&(s.paragraphFormat={},j.writeParagraphFormat(s.paragraphFormat,!0,r.paragraphFormat)),"Table"!==t&&(s.characterFormat={},j.writeCharacterFormat(s.characterFormat,!0,r.characterFormat)),o.name=r.name,o.style=JSON.stringify(s),_.isNullOrUndefined(t)||(o.type=t,"Paragraph"!==o.type)||_.isNullOrUndefined(r.link)||(o.type="Linked"),e.push(o)}return e},Cl.prototype.destroy=function(){if(this.collection&&0<this.collection.length)for(var e=0;e<this.collection.length;e++){var t=this.collection[parseInt(e.toString(),10)];(t instanceof fl||t instanceof ul||t instanceof wl)&&t.destroy()}this.collection=[],this.collection=void 0};var xl=Cl;function Cl(){this.collection=[]}Object.defineProperty(kl.prototype,"backgroundColor",{get:function(){return this.getPropertyValue("backgroundColor")},set:function(e){this.setPropertyValue("backgroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(kl.prototype,"foregroundColor",{get:function(){return this.getPropertyValue("foregroundColor")},set:function(e){this.setPropertyValue("foregroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(kl.prototype,"textureStyle",{get:function(){return this.getPropertyValue("textureStyle")},set:function(e){this.setPropertyValue("textureStyle",e)},enumerable:!0,configurable:!0}),kl.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var t=O.getPropertyType(kl.uniqueFormatType,e);if(!_.isNullOrUndefined(this.uniqueShadingFormat)&&this.uniqueShadingFormat.propertiesHash.containsKey(t))return this.uniqueShadingFormat.propertiesHash.get(t)}return kl.getPropertyDefaultValue(e)},kl.prototype.setPropertyValue=function(e,t){var i;!_.isNullOrUndefined(t)&&""!==t||(t=kl.getPropertyDefaultValue(e)),_.isNullOrUndefined(this.uniqueShadingFormat)?this.initializeUniqueShading(e,t):(i=O.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,e),this.uniqueShadingFormat.propertiesHash.containsKey(i)&&this.uniqueShadingFormat.propertiesHash.get(i)===t||(this.uniqueShadingFormat=kl.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat,e,t)))},kl.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"backgroundColor":case"foregroundColor":t="empty";break;case"textureStyle":t="TextureNone"}return t},kl.prototype.initializeUniqueShading=function(e,t){var i=new T;this.addUniqueShading("backgroundColor",e,t,i),this.addUniqueShading("foregroundColor",e,t,i),this.addUniqueShading("textureStyle",e,t,i),this.uniqueShadingFormat=kl.uniqueShadingFormats.addUniqueFormat(i,kl.uniqueFormatType)},kl.prototype.addUniqueShading=function(e,t,i,n){var r=O.getPropertyType(kl.uniqueFormatType,e);e===t?n.add(r,i):n.add(r,kl.getPropertyDefaultValue(e))},kl.prototype.destroy=function(){_.isNullOrUndefined(this.uniqueShadingFormat)||kl.uniqueShadingFormats.remove(this.uniqueShadingFormat),this.uniqueShadingFormat=void 0},kl.prototype.cloneFormat=function(){var e=new kl(void 0);return e.backgroundColor=this.backgroundColor,e.foregroundColor=this.foregroundColor,e.textureStyle=this.textureStyle,e},kl.prototype.copyFormat=function(e){_.isNullOrUndefined(e)||_.isNullOrUndefined(e.uniqueShadingFormat)||(this.backgroundColor=e.backgroundColor,this.foregroundColor=e.foregroundColor,this.textureStyle=e.textureStyle)},kl.prototype.hasValue=function(e){return!_.isNullOrUndefined(this.uniqueShadingFormat)&&(e=O.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,e),this.uniqueShadingFormat.propertiesHash.containsKey(e))},kl.clear=function(){this.uniqueShadingFormats.clear()},kl.uniqueShadingFormats=new e,kl.uniqueFormatType=5;var Il=kl;function kl(e){this.uniqueShadingFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}Object.defineProperty(Pl.prototype,"title",{get:function(){return this._title},set:function(e){this._title=e},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"description",{get:function(){return this._description},set:function(e){this._description=e},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"allowAutoFit",{get:function(){return this.getPropertyValue("allowAutoFit")},set:function(e){this.setPropertyValue("allowAutoFit",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"cellSpacing",{get:function(){return this.getPropertyValue("cellSpacing")},set:function(e){if(e<0||264.6<e)throw new RangeError("The measurement must be between 0 px and 264.6 px.");this.setPropertyValue("cellSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"tableAlignment",{get:function(){return this.getPropertyValue("tableAlignment")},set:function(e){this.setPropertyValue("tableAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){if(e<-1440||1440<e)throw new RangeError("The measurement must be between -1440 px and 1440 px.");this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"horizontalPositionAbs",{get:function(){return this.getPropertyValue("horizontalPositionAbs")},set:function(e){this.setPropertyValue("horizontalPositionAbs",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"horizontalPosition",{get:function(){return this.getPropertyValue("horizontalPosition")},set:function(e){this.setPropertyValue("horizontalPosition",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"styleName",{get:function(){return this._styleName},set:function(e){this._styleName=e},enumerable:!0,configurable:!0}),Pl.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var t=O.getPropertyType(Pl.uniqueFormatType,e);if(!_.isNullOrUndefined(this.uniqueTableFormat)&&this.uniqueTableFormat.propertiesHash.containsKey(t))return this.uniqueTableFormat.propertiesHash.get(t)}return Pl.getPropertyDefaultValue(e)},Pl.prototype.setPropertyValue=function(e,t){var i;!_.isNullOrUndefined(t)&&""!==t||(t=Pl.getPropertyDefaultValue(e)),_.isNullOrUndefined(this.uniqueTableFormat)?this.initializeUniqueTableFormat(e,t):(i=O.getPropertyType(this.uniqueTableFormat.uniqueFormatType,e),this.uniqueTableFormat.propertiesHash.containsKey(i)&&this.uniqueTableFormat.propertiesHash.get(i)===t||(this.uniqueTableFormat=Pl.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat,e,t)))},Pl.prototype.initializeUniqueTableFormat=function(e,t){var i=new T;this.addUniqueTableFormat("allowAutoFit",e,t,i),this.addUniqueTableFormat("cellSpacing",e,t,i),this.addUniqueTableFormat("leftMargin",e,t,i),this.addUniqueTableFormat("topMargin",e,t,i),this.addUniqueTableFormat("bottomMargin",e,t,i),this.addUniqueTableFormat("rightMargin",e,t,i),this.addUniqueTableFormat("leftIndent",e,t,i),this.addUniqueTableFormat("tableAlignment",e,t,i),this.addUniqueTableFormat("preferredWidth",e,t,i),this.addUniqueTableFormat("preferredWidthType",e,t,i),this.addUniqueTableFormat("bidi",e,t,i),this.addUniqueTableFormat("horizontalPositionAbs",e,t,i),this.addUniqueTableFormat("horizontalPosition",e,t,i),this.uniqueTableFormat=Pl.uniqueTableFormats.addUniqueFormat(i,Pl.uniqueFormatType)},Pl.prototype.addUniqueTableFormat=function(e,t,i,n){var r=O.getPropertyType(Pl.uniqueFormatType,e);e===t&&n.add(r,i)},Pl.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowAutoFit":t=!1;break;case"cellSpacing":t=0;break;case"leftMargin":t=5.4;break;case"topMargin":case"bottomMargin":t=0;break;case"rightMargin":t=5.4;break;case"leftIndent":t=0;break;case"tableAlignment":t="Left";break;case"preferredWidth":t=0;break;case"preferredWidthType":t="Point";break;case"bidi":t=!1;break;case"horizontalPositionAbs":t=null;break;case"horizontalPosition":t=0}return t},Pl.prototype.assignTableMarginValue=function(e,t,i,n){this.leftMargin=e,this.topMargin=t,this.rightMargin=i,this.bottomMargin=n},Pl.prototype.initializeTableBorders=function(){this.borders.left.lineStyle="Single",this.borders.left.lineWidth=.5,this.borders.right.lineStyle="Single",this.borders.right.lineWidth=.5,this.borders.top.lineStyle="Single",this.borders.top.lineWidth=.5,this.borders.bottom.lineStyle="Single",this.borders.bottom.lineWidth=.5,this.borders.horizontal.lineStyle="Single",this.borders.horizontal.lineWidth=.5,this.borders.vertical.lineStyle="Single",this.borders.vertical.lineWidth=.5},Pl.prototype.destroy=function(){_.isNullOrUndefined(this.borders)||this.borders.destroy(),_.isNullOrUndefined(this.shading)||this.shading.destroy(),_.isNullOrUndefined(this.uniqueTableFormat)||Pl.uniqueTableFormats.remove(this.uniqueTableFormat),this.uniqueTableFormat=void 0,this.ownerBase=void 0,this.borders=void 0,this.shading=void 0},Pl.prototype.cloneFormat=function(){var e=new Pl(void 0);return e.leftIndent=this.leftIndent,e.tableAlignment=this.tableAlignment,e.cellSpacing=this.cellSpacing,e.leftMargin=this.leftMargin,e.rightMargin=this.rightMargin,e.topMargin=this.topMargin,e.bottomMargin=this.bottomMargin,e.preferredWidth=this.preferredWidth,e.preferredWidthType=this.preferredWidthType,e.horizontalPositionAbs=this.horizontalPositionAbs,e.horizontalPosition=this.horizontalPosition,e.borders=_.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),e.shading=_.isNullOrUndefined(this.shading)?void 0:this.shading.cloneFormat(),e.bidi=this.bidi,e.allowAutoFit=this.allowAutoFit,e.styleName=this.styleName,e.title=this.title,e.description=this.description,e},Pl.prototype.hasValue=function(e){return!_.isNullOrUndefined(this.uniqueTableFormat)&&(e=O.getPropertyType(this.uniqueTableFormat.uniqueFormatType,e),this.uniqueTableFormat.propertiesHash.containsKey(e))},Pl.prototype.copyFormat=function(e){_.isNullOrUndefined(e)||(_.isNullOrUndefined(e.uniqueTableFormat)||(this.cellSpacing=e.cellSpacing,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.tableAlignment=e.tableAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType,this.bidi=e.bidi,this.allowAutoFit=e.allowAutoFit,this.horizontalPosition=e.horizontalPosition,this.horizontalPositionAbs=e.horizontalPositionAbs,this.styleName=e.styleName),_.isNullOrUndefined(e.borders)||(this.borders=new qa(this),this.borders.copyFormat(e.borders)),_.isNullOrUndefined(e.shading)||(this.shading=new Il(this),this.shading.copyFormat(e.shading)),_.isNullOrUndefined(e.title)||(this.title=e.title),_.isNullOrUndefined(e.description))||(this.description=e.description)},Pl.clear=function(){this.uniqueTableFormats.clear()},Pl.uniqueTableFormats=new e,Pl.uniqueFormatType=8;var Fl=Pl;function Pl(e){this.uniqueTableFormat=void 0,this.borders=new qa(this),this.shading=new Il(this),this._title=void 0,this._description=void 0,this.ownerBase=void 0,this._styleName=void 0,this.ownerBase=e,this.assignTableMarginValue(5.4,0,5.4,0)}Object.defineProperty(Sl.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Sl.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Sl.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Sl.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Sl.prototype,"cellWidth",{get:function(){return this.getPropertyValue("cellWidth")},set:function(e){this.setPropertyValue("cellWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Sl.prototype,"columnSpan",{get:function(){return this.getPropertyValue("columnSpan")},set:function(e){this.setPropertyValue("columnSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Sl.prototype,"rowSpan",{get:function(){return this.getPropertyValue("rowSpan")},set:function(e){this.setPropertyValue("rowSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Sl.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Sl.prototype,"verticalAlignment",{get:function(){return this.getPropertyValue("verticalAlignment")},set:function(e){this.setPropertyValue("verticalAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Sl.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),Sl.prototype.getPropertyValue=function(e){if(this.hasValue(e)){var t=O.getPropertyType(Sl.uniqueFormatType,e);if(!_.isNullOrUndefined(this.uniqueCellFormat)&&this.uniqueCellFormat.propertiesHash.containsKey(t))return this.uniqueCellFormat.propertiesHash.get(t)}return Sl.getPropertyDefaultValue(e)},Sl.prototype.setPropertyValue=function(e,t){var i;!_.isNullOrUndefined(t)&&""!==t||(t=Sl.getPropertyDefaultValue(e)),_.isNullOrUndefined(this.uniqueCellFormat)?this.initializeUniqueCellFormat(e,t):(i=O.getPropertyType(this.uniqueCellFormat.uniqueFormatType,e),this.uniqueCellFormat.propertiesHash.containsKey(i)&&this.uniqueCellFormat.propertiesHash.get(i)===t||(this.uniqueCellFormat=Sl.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat,e,t)))},Sl.prototype.initializeUniqueCellFormat=function(e,t){var i=new T;this.addUniqueCellFormat("leftMargin",e,t,i),this.addUniqueCellFormat("topMargin",e,t,i),this.addUniqueCellFormat("bottomMargin",e,t,i),this.addUniqueCellFormat("rightMargin",e,t,i),this.addUniqueCellFormat("cellWidth",e,t,i),this.addUniqueCellFormat("columnSpan",e,t,i),this.addUniqueCellFormat("rowSpan",e,t,i),this.addUniqueCellFormat("preferredWidth",e,t,i),this.addUniqueCellFormat("verticalAlignment",e,t,i),this.addUniqueCellFormat("preferredWidthType",e,t,i),this.uniqueCellFormat=Sl.uniqueCellFormats.addUniqueFormat(i,Sl.uniqueFormatType)},Sl.prototype.addUniqueCellFormat=function(e,t,i,n){var r=O.getPropertyType(Sl.uniqueFormatType,e);e===t&&n.add(r,i)},Sl.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"cellWidth":t=0;break;case"columnSpan":case"rowSpan":t=1;break;case"preferredWidth":t=0;break;case"verticalAlignment":t="Top";break;case"preferredWidthType":t="Point"}return t},Sl.prototype.containsMargins=function(){return!(_.isNullOrUndefined(this.leftMargin)&&_.isNullOrUndefined(this.rightMargin)&&_.isNullOrUndefined(this.bottomMargin)&&_.isNullOrUndefined(this.topMargin))},Sl.prototype.destroy=function(){_.isNullOrUndefined(this.borders)||this.borders.destroy(),_.isNullOrUndefined(this.shading)||this.shading.destroy(),_.isNullOrUndefined(this.uniqueCellFormat)||Sl.uniqueCellFormats.remove(this.uniqueCellFormat),this.uniqueCellFormat=void 0,this.borders=void 0,this.shading=void 0},Sl.prototype.cloneFormat=function(){var e=new Sl(void 0);return e.verticalAlignment=this.verticalAlignment,e.leftMargin=this.leftMargin,e.rightMargin=this.rightMargin,e.topMargin=this.topMargin,e.bottomMargin=this.bottomMargin,e.preferredWidth=this.preferredWidth,e.preferredWidthType=this.preferredWidthType,e.cellWidth=this.cellWidth,e.borders=_.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),e.shading=_.isNullOrUndefined(this.shading)?void 0:this.shading.cloneFormat(),e},Sl.prototype.hasValue=function(e){return!_.isNullOrUndefined(this.uniqueCellFormat)&&(e=O.getPropertyType(this.uniqueCellFormat.uniqueFormatType,e),this.uniqueCellFormat.propertiesHash.containsKey(e))},Sl.prototype.copyFormat=function(e){_.isNullOrUndefined(e)||(_.isNullOrUndefined(e.uniqueCellFormat)||(this.cellWidth=e.cellWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.preferredWidth=e.preferredWidth,this.columnSpan=e.columnSpan,this.rowSpan=e.rowSpan,this.preferredWidthType=e.preferredWidthType,this.verticalAlignment=e.verticalAlignment),_.isNullOrUndefined(e.shading)||(this.shading=new Il(this),this.shading.copyFormat(e.shading)),_.isNullOrUndefined(e.borders))||(this.borders=new qa(this),this.borders.copyFormat(e.borders))},Sl.clear=function(){this.uniqueCellFormats.clear()},Sl.uniqueCellFormats=new e,Sl.uniqueFormatType=4;var Tl=Sl;function Sl(e){this.uniqueCellFormat=void 0,this.borders=new qa(this),this.shading=new Il(this),this.ownerBase=e,this.borders=new qa(this),this.shading=new Il(this)}Object.defineProperty(Nl.prototype,"abstractListId",{get:function(){return this.abstractListIdIn},set:function(e){this.abstractListIdIn=e},enumerable:!0,configurable:!0}),Nl.prototype.clear=function(){if(!_.isNullOrUndefined(this.levels)){for(var e=0;e<this.levels.length;e++){var t=this.levels[parseInt(e.toString(),10)];t.clearFormat(),this.levels.splice(this.levels.indexOf(t),1),e--}this.levels=[]}},Nl.prototype.destroy=function(){if(!_.isNullOrUndefined(this.levels)){for(var e=0;e<this.levels.length;e++){var t=this.levels[parseInt(e.toString(),10)];t.destroy(),this.levels.splice(this.levels.indexOf(t),1),e--}this.levels=[]}this.levels=void 0},Nl.prototype.clone=function(){for(var e=new Nl,t=0;t<this.levels.length;t++)e.levels.push(this.levels[parseInt(t.toString(),10)].clone(e));return e};var Hl=Nl;function Nl(){this.abstractListIdIn=-1,this.nsid=-1,this.levels=[],this.nsid=parseInt(j.generateHexDecimal(),16)}Ol.prototype.clear=function(){_.isNullOrUndefined(this.overrideListLevel)||this.overrideListLevel.clearFormat(),this.overrideListLevel=void 0},Ol.prototype.destroy=function(){_.isNullOrUndefined(this.overrideListLevel)||this.overrideListLevel.destroy(),this.levelNumber=void 0,this.startAt=void 0,this.overrideListLevel=void 0},Ol.prototype.clone=function(){var e=new Ol;return e.startAt=this.startAt,e.levelNumber=this.levelNumber,_.isNullOrUndefined(this.overrideListLevel)||(e.overrideListLevel=this.overrideListLevel.clone(e)),e};var Wl=Ol;function Ol(){}Object.defineProperty(Ll.prototype,"listLevelPattern",{get:function(){return this.getPropertyValue("listLevelPattern")},set:function(e){this.setPropertyValue("listLevelPattern",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ll.prototype,"followCharacter",{get:function(){return this.getPropertyValue("followCharacter")},set:function(e){this.setPropertyValue("followCharacter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ll.prototype,"startAt",{get:function(){return this.getPropertyValue("startAt")},set:function(e){this.setPropertyValue("startAt",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ll.prototype,"numberFormat",{get:function(){return this.getPropertyValue("numberFormat")},set:function(e){this.setPropertyValue("numberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ll.prototype,"paraStyleName",{get:function(){return this.getPropertyValue("paraStyleName")},set:function(e){this.setPropertyValue("paraStyleName",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ll.prototype,"restartLevel",{get:function(){return this.getPropertyValue("restartLevel")},set:function(e){this.setPropertyValue("restartLevel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ll.prototype,"isLegalStyleNumbering",{get:function(){return this.getPropertyValue("isLegalStyleNumbering")},set:function(e){this.setPropertyValue("isLegalStyleNumbering",e)},enumerable:!0,configurable:!0}),Ll.prototype.getPropertyValue=function(e){var t=O.getPropertyType(Ll.uniqueFormatType,e);return!_.isNullOrUndefined(this.uniqueListLevel)&&this.uniqueListLevel.propertiesHash.containsKey(t)?this.uniqueListLevel.propertiesHash.get(t):Ll.getPropertyDefaultValue(e)},Ll.prototype.setPropertyValue=function(e,t){var i;!_.isNullOrUndefined(t)&&""!==t||(t=Ll.getPropertyDefaultValue(e)),_.isNullOrUndefined(this.uniqueListLevel)?this.initializeUniqueWListLevel(e,t):(i=O.getPropertyType(this.uniqueListLevel.uniqueFormatType,e),this.uniqueListLevel.propertiesHash.containsKey(i)&&this.uniqueListLevel.propertiesHash.get(i)===t||(this.uniqueListLevel=Ll.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel,e,t)))},Ll.prototype.initializeUniqueWListLevel=function(e,t){var i=new T;this.addUniqueWListLevel("listLevelPattern",e,t,i),this.addUniqueWListLevel("startAt",e,t,i),this.addUniqueWListLevel("followCharacter",e,t,i),this.addUniqueWListLevel("numberFormat",e,t,i),this.addUniqueWListLevel("paraStyleName",e,t,i),this.addUniqueWListLevel("restartLevel",e,t,i),this.addUniqueWListLevel("isLegalStyleNumbering",e,t,i),this.uniqueListLevel=Ll.uniqueListLevels.addUniqueFormat(i,Ll.uniqueFormatType)},Ll.prototype.addUniqueWListLevel=function(e,t,i,n){var r=O.getPropertyType(Ll.uniqueFormatType,e);e===t?n.add(r,i):n.add(r,Ll.getPropertyDefaultValue(e))},Ll.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listLevelPattern":t="Arabic";break;case"startAt":t=0;break;case"followCharacter":t="Tab";break;case"paraStyleName":case"numberFormat":t="";break;case"restartLevel":t=0;break;case"isLegalStyleNumbering":t=!1}return t},Ll.prototype.destroy=function(){_.isNullOrUndefined(this.uniqueListLevel)||Ll.uniqueListLevels.remove(this.uniqueListLevel),this.uniqueListLevel=void 0,_.isNullOrUndefined(this.characterFormat)||(this.characterFormat.destroy(),this.characterFormat=void 0),_.isNullOrUndefined(this.paragraphFormat)||(this.paragraphFormat.destroy(),this.paragraphFormat=void 0)},Ll.prototype.clearFormat=function(){_.isNullOrUndefined(this.uniqueListLevel)||Ll.uniqueListLevels.remove(this.uniqueListLevel),this.uniqueListLevel=void 0,this.characterFormat&&this.characterFormat.clearFormat(),this.characterFormat=void 0,this.paragraphFormat&&this.paragraphFormat.clearFormat(),this.paragraphFormat=void 0},Ll.clear=function(){this.uniqueListLevels.clear()},Ll.prototype.clone=function(e){e=new Ll(e);return e.paragraphFormat=this.paragraphFormat.cloneFormat(),e.characterFormat=this.characterFormat.cloneFormat(),this.uniqueListLevel&&(e.uniqueListLevel=this.uniqueListLevel,e.uniqueListLevel.referenceCount++),e},Ll.dotBullet=String.fromCharCode(61623),Ll.squareBullet=String.fromCharCode(61607),Ll.arrowBullet=String.fromCharCode(10148),Ll.circleBullet=String.fromCharCode(61551)+String.fromCharCode(32),Ll.uniqueListLevels=new e,Ll.uniqueFormatType=9;var El=Ll;function Ll(e){this.uniqueListLevel=void 0,this.paragraphFormat=void 0,this.characterFormat=void 0,0 instanceof Hl,this.ownerBase=e,this.characterFormat=new B(void 0),this.paragraphFormat=new Xa(void 0)}Object.defineProperty(Rl.prototype,"paragraphMark",{get:function(){return"¶"},enumerable:!0,configurable:!0}),Object.defineProperty(Rl.prototype,"lineBreakMark",{get:function(){return"↲"},enumerable:!0,configurable:!0}),Rl.prototype.getEnSpaceCharacter=function(){return String.fromCharCode(8194)},Rl.prototype.repeatChar=function(e,t){for(var i="",n=0;n<t;n++)i+=e;return i},Rl.prototype.getParagraphMarkWidth=function(e){return this.getParagraphMarkSize(e).Width},Rl.prototype.getParagraphMarkSize=function(e){var t=this.getFormatText(e);return this.paragraphMarkInfo[""+t]||(e={Width:this.getWidth(this.paragraphMark,e),Height:(e=this.getHeight(e)).Height,BaselineOffset:e.BaselineOffset},this.paragraphMarkInfo[""+t]=e)},Rl.prototype.getTextSize=function(e,t){var i=0,n=t.bidi||this.isRTLText(e.text),n=this.setText(e.text,n,t.bdo),n=("\r"===n&&(n=String.fromCharCode(182)),i=this.getWidth(n,t,e.scriptType),e.width=i,this.getHeight(t,e.scriptType));return"Word2003"===this.documentHelper.compatibilityMode&&e.isColumnBreak||(e.height=n.Height),e.baselineOffset=n.BaselineOffset," "===e.text[e.text.length-1]&&(i=this.getWidth(j.trimEnd(e.text),t,e.scriptType)),e.trimEndWidth=i},Rl.prototype.getHeight=function(e,t){var t=this.getFontNameToRender(t,e),i=this.getFormatText(e,t);return _.isNullOrUndefined(this.documentHelper.heightInfoCollection[""+i])?(e=this.documentHelper.owner.textMeasureHelper.getHeightInternal(e,t),this.documentHelper.heightInfoCollection[""+i]=e):this.documentHelper.heightInfoCollection[""+i]},Rl.prototype.getFormatText=function(e,t){var i="",i=(_.isNullOrUndefined(t)?e.fontFamily:t).toLocaleLowerCase();return i+=";"+e.fontSize,e.bold&&(i+=";bold"),e.italic&&(i+=";italic"),i},Rl.prototype.measureTextExcludingSpaceAtEnd=function(e,t,i){return this.getWidth(j.trimEnd(e),t,i)},Rl.prototype.getWidth=function(e,t,i){e.match("\v")&&e.replace("\v",this.lineBreakMark);var n=t.fontSize,r=t.bold?"bold":"",o=t.italic?"italic":"",i=this.getFontNameToRender(i,t),n=0===n?.5:n/("Normal"===t.baselineAlignment?1:1.5),r=(this.context.font=r+" "+o+" "+n+'pt "'+i+'"',this.context.letterSpacing=t.characterSpacing+"pt",t.scaling/100);return"̶"===(e=t.allCaps?e.toUpperCase():e)&&(e+="A"),Math.abs(this.context.measureText(e).width*r)},Rl.prototype.setText=function(e,t,i,n){return _.isNullOrUndefined(n)&&(n=!1),0===e.length?"":(!(t=t)&&"RTL"===i||t&&"LTR"===i?e=j.reverseString(e):n&&t&&j.endsWith(e)&&(i=e.length-j.trimEnd(e).length,e=j.addSpace(i)+j.trimEnd(e)),e)},Rl.prototype.measureText=function(e,t,i){e=this.getWidth(e,t,i),t=this.getHeight(t,i);return{Width:e,Height:t.Height,BaselineOffset:t.BaselineOffset}},Rl.prototype.updateTextSize=function(e,t){var i=new B(void 0),n=e.listLevel.characterFormat,t=t.characterFormat,r=(i.fontSize=(n.hasValue("fontSize")?n:t).fontSize,i.fontFamily=(n.hasValue("fontFamily")?n:t).fontFamily,("Normal"===n.baselineAlignment?t:n).baselineAlignment),o=n.hasValue("bold")?n.bold?"bold":"":t.bold?"bold":"",n=n.hasValue("italic")?n.italic?"italic":"":t.italic?"italic":"",t=(i.baselineAlignment=r,o&&(i.bold=!0),n&&(i.italic=!0),i.bidi||this.isRTLText(e.text)),r=this.setText(e.text,t,i.bdo),o=(e.width=this.getWidth(r,i),this.getHeight(i));e.height=o.Height,e.baselineOffset=o.BaselineOffset,i.destroy()},Rl.prototype.containsSpecialCharAlone=function(e){for(var t=0;t<e.length;t++)if(-1==="*|.:[]{}-`;()@&$#%!~?, '".indexOf(e.charAt(t)))return!1;return!0},Rl.prototype.containsNumberAlone=function(e){if(""===e)return!1;for(var t=0;t<e.length;t++)if(-1==="0123456789".indexOf(e.charAt(t)))return!1;return!0},Rl.prototype.containsCombinationText=function(e){return!(!e.text.match(/^[0-9]+$/)||!e.paragraph.bidi)},Rl.prototype.inverseCharacter=function(e){switch(e){case"(":return")";case")":return"(";case"<":return">";case">":return"<";case"{":return"}";case"}":return"{";case"[":return"]";case"]":return"[";default:return e}},Rl.prototype.containsSpecialChar=function(e){for(var t=0;t<e.length;t++)if(-1!=="*|.:[]{}-`;()@&$#%!~? ".indexOf(e.charAt(t)))return!0;return!1},Rl.prototype.isRTLText=function(e){var t=!1;if(!_.isNullOrUndefined(e))for(var i=0;i<e.length;i++){var n=e[i];if(n>=String.fromCharCode(1424)&&n<=String.fromCharCode(1535)||n>=String.fromCharCode(64285)&&n<=String.fromCharCode(64335)||n>=String.fromCharCode(1536)&&n<=String.fromCharCode(1791)||n>=String.fromCharCode(1872)&&n<=String.fromCharCode(1919)||n>=String.fromCharCode(2208)&&n<=String.fromCharCode(2303)||n>=String.fromCharCode(64336)&&n<=String.fromCharCode(65023)||n>=String.fromCharCode(65136)&&n<=String.fromCharCode(65279)||n>=String.fromCharCode(43392)&&n<=String.fromCharCode(43487)||n>=String.fromCharCode(1792)&&n<=String.fromCharCode(1871)||n>=String.fromCharCode(1920)&&n<=String.fromCharCode(1983)||n>=String.fromCharCode(2112)&&n<=String.fromCharCode(2143)||n>=String.fromCharCode(1984)&&n<=String.fromCharCode(2047)||n>=String.fromCharCode(2048)&&n<=String.fromCharCode(2111)||n>=String.fromCharCode(11568)&&n<=String.fromCharCode(11647)){t=!0;break}}return t},Rl.prototype.isUnicodeText=function(e,t){var i=!1;if(!_.isNullOrUndefined(e))for(var n=0;n<e.length;n++){var r=e[n];if(("　"<=r&&r<="ヿ"||"＀"<=r&&r<="￯"||"一"<=r&&r<="龯"||"㐀"<=r&&r<="䶿"||"가"<=r&&r<="￯"||"඀"<=r&&r<="෿")&&0!==t){i=!0;break}}return i},Rl.prototype.getRtlLanguage=function(e){return _.isNullOrUndefined(e)||""===e?{isRtl:!1,id:0}:e>=String.fromCharCode(1424)&&e<=String.fromCharCode(1535)?{isRtl:!0,id:1}:e>=String.fromCharCode(1536)&&e<=String.fromCharCode(1791)||e>=String.fromCharCode(1872)&&e<=String.fromCharCode(1919)||e>=String.fromCharCode(2208)&&e<=String.fromCharCode(2303)||e>=String.fromCharCode(64336)&&e<=String.fromCharCode(65023)||e>=String.fromCharCode(65136)&&e<=String.fromCharCode(65279)?{isRtl:!0,id:2}:e>=String.fromCharCode(43392)&&e<=String.fromCharCode(43487)?{isRtl:!0,id:3}:e>=String.fromCharCode(1792)&&e<=String.fromCharCode(1871)?{isRtl:!0,id:4}:e>=String.fromCharCode(1920)&&e<=String.fromCharCode(1983)?{isRtl:!0,id:5}:e>=String.fromCharCode(2112)&&e<=String.fromCharCode(2143)?{isRtl:!0,id:6}:e>=String.fromCharCode(1984)&&e<=String.fromCharCode(2047)?{isRtl:!0,id:7}:e>=String.fromCharCode(2048)&&e<=String.fromCharCode(2111)?{isRtl:!0,id:8}:e>=String.fromCharCode(11568)&&e<=String.fromCharCode(11647)?{isRtl:!0,id:9}:{isRtl:!1,id:0}},Rl.prototype.splitTextByConsecutiveLtrAndRtl=function(e,t,i,n,r,o){var s=n.length,a=[];if(!_.isNullOrUndefined(e)&&""!==e){for(var l=-1,d="",h="",c="",p="",u=0;u<e.length;u++){var g=0,m=!1;(_.isNullOrUndefined(r.value)?t:!r.value)&&this.isNumber(e[u])?(p+=e[u],g=4):this.isWordSplitChar(e[u])?(g=2,m=t||32==e.charCodeAt(u)&&""==c,c+=e[u]):this.isRTLText(e[u])&&!this.isNumber(e[u])?(r.value=!1,o.value=!0,h+=e[u],g=1):(r.value=!0,d+=e[u]),""!=p&&4!=g&&(a.push(p),n.push(V.CharacterRangeType.Number),p=""),""!=h&&1!=g&&(a.push(h),n.push(V.CharacterRangeType.RightToLeft),h=""),""!=d&&0!=g&&(a.push(d),l=a.length-1,n.push(V.CharacterRangeType.LeftToRight),d=""),""==c||2==g&&!m||(a.push(c),n.push(V.CharacterRangeType.WordSplit),c="")}if(""!=p?(a.push(p),n.push(V.CharacterRangeType.Number)):""!=h?(a.push(h),n.push(V.CharacterRangeType.RightToLeft)):""!=d?(a.push(d),l=a.length-1,n.push(V.CharacterRangeType.LeftToRight)):""!=c&&(a.push(c),n.push(V.CharacterRangeType.WordSplit)),o.value||!_.isNullOrUndefined(r.value)&&!r.value)for(u=1;u<a.length;u++)(y=n[u+s])==V.CharacterRangeType.WordSplit&&1==a[u].length&&u+s+1<n.length&&n[u+s-1]!=V.CharacterRangeType.WordSplit&&(n[u+s-1]!=V.CharacterRangeType.Number||Rl.isNumberNonReversingCharacter(a[u],t))&&n[u+s-1]==n[u+s+1]&&(a[u-1]=a[u-1]+a[u]+a[u+1],a.splice(u,1),a.splice(u,1),n.splice(u+s,1),n.splice(u+s,1),u--);else if(-1!=l)if(t){for(u=1;u<l;u++)if((y=n[u+s])==V.CharacterRangeType.WordSplit&&u<l&&n[u+s-1]==V.CharacterRangeType.LeftToRight){for(var d="",f=u+1;f<=l;f++)d+=a[f],a.splice(f,1),n.splice(f+s,1),f--,l--;a[u-1]=a[u-1]+a[u]+d,a.splice(u,1),n.splice(u+s,1),u--,l--}}else a.length=0,a.push(e);else t||(a.length=0,a.push(e));if(t)for(var y,u=1;u<a.length;u++)(y=n[u+s])==V.CharacterRangeType.WordSplit&&1==a[u].length&&u+s+1<n.length&&n[u+s-1]!=V.CharacterRangeType.WordSplit&&(n[u+s-1]!=V.CharacterRangeType.Number||Rl.isNumberNonReversingCharacter(a[u],t)||!i)&&n[u+s-1]==n[u+s+1]?(a[u-1]=a[u-1]+a[u]+a[u+1],a.splice(u,1),a.splice(u,1),n.splice(u+s,1),n.splice(u+s,1),u--):y==V.CharacterRangeType.WordSplit&&n[u+s-1]==V.CharacterRangeType.Number&&this.isNonWordSplitCharacter(a[u])&&!i?(a[u-1]=a[u-1]+a[u],a.splice(u,1),n.splice(u+s,1),u--):y!=V.CharacterRangeType.LeftToRight||n[u+s-1]!=V.CharacterRangeType.Number&&n[u+s-1]!=V.CharacterRangeType.LeftToRight||(a[u-1]=a[u-1]+a[u],n[u+s-1]=V.CharacterRangeType.LeftToRight,a.splice(u,1),n.splice(u+s,1),u--)}return a},Rl.prototype.isRightToLeftLanguage=function(e){return 14337==e||15361==e||5121==e||3073==e||2049==e||11265==e||13313==e||12289==e||4097==e||8193==e||16385==e||1025==e||10241==e||7169==e||9217==e||10655==e},Rl.prototype.isNumber=function(e){return!isNaN(parseInt(e,10))||e>=String.fromCharCode(1632)&&e<=String.fromCharCode(1641)||e>=String.fromCharCode(1776)&&e<=String.fromCharCode(1785)},Rl.prototype.isWordSplitChar=function(e){for(var t=0;t<Rl.wordSplitCharacters.length;t++)if(Rl.wordSplitCharacters[t]===e)return!0;return!1},Rl.isNumberNonReversingCharacter=function(e,t){for(var i=0;i<Rl.numberNonReversingCharacters.length;i++){var n=Rl.numberNonReversingCharacters[i];if(e[0]==n&&(47!=n.charCodeAt(0)||!t))return!0}return!1},Rl.prototype.isNonWordSplitCharacter=function(e){for(var t=!1,i=0;i<e.length;i++){var n=e.charCodeAt(i);if(35!=n&&36!=n&&37!=n){t=!1;break}t=!0}return t},Rl.prototype.getFontNameToRender=function(e,t){return _.isNullOrUndefined(e)?t.fontFamily:t.bidi||t.complexScript?this.getFontNameBidiToRender(e,t):this.isEastAsiaScript(e)&&!_.isNullOrUndefined(t.fontFamilyFarEast)?this.getFontNameEAToRender(e,t):this.getFontNameAsciiToRender(e,t)},Rl.prototype.isEastAsiaScript=function(e){return e==V.FontScriptType.Japanese||e==V.FontScriptType.Korean||e==V.FontScriptType.Chinese},Rl.prototype.getFontNameEAToRender=function(e,t){var i=t.fontFamilyFarEast;return _.isNullOrUndefined(i)||j.isThemeFont(i)?this.getFontNameFromTheme(t,i,e,V.FontHintType.EastAsia):i},Rl.prototype.getFontNameAsciiToRender=function(e,t){var i=t.fontFamilyAscii;return j.isThemeFont(i)?this.getFontNameFromTheme(t,i,e,V.FontHintType.Default):t.fontFamily},Rl.prototype.getFontNameBidiToRender=function(e,t){var i=t.fontFamilyBidi;return!_.isNullOrUndefined(i)||j.isThemeFont(i)?this.getFontNameFromTheme(t,i,e,V.FontHintType.CS):i},Rl.prototype.getFontNameFromTheme=function(e,t,i,n){var r,o;return!this.documentHelper.hasThemes||_.isNullOrUndefined(this.documentHelper.themes)||_.isUndefined(this.documentHelper.themes.fontScheme)||(r=this.documentHelper.themes.fontScheme),"majorAscii"==t||"majorBidi"==t||"majorEastAsia"==t||"majorHAnsi"==t?(o=void 0,null!=r&&null!=r.majorFontScheme&&(o=r.majorFontScheme),t=this.updateFontNameFromTheme(e,o,i,t,n)):"minorAscii"!=t&&"minorBidi"!=t&&"minorEastAsia"!=t&&"minorHAnsi"!=t||(o=void 0,null!=r&&null!=r.majorFontScheme&&(o=r.minorFontScheme),t=this.updateFontNameFromTheme(e,o,i,t,n)),t=_.isNullOrUndefined(t)||j.isThemeFont(t)?We:t},Rl.prototype.updateFontNameFromTheme=function(e,t,i,n,r){var o="";if(null!=t&&null!=t.fontSchemeList&&0<t.fontSchemeList.length&&t.fontSchemeList.forEach(function(e){("cs"!=e.name||"majorBidi"!=n&&"minorBidi"!=n)&&("ea"!=e.name||"majorEastAsia"!=n&&"minorEastAsia"!=n)&&("latin"!=e.name||"majorAscii"!=n&&"majorHAnsi"!=n&&"minorAscii"!=n&&"minorHAnsi"!=n)||(o=e.typeface)}),null!=t&&null!=t.fontTypeface)if(r==V.FontHintType.CS)t.fontTypeface.containsKey("Arab")&&(o=t.fontTypeface.get("Arab"));else if(r!=V.FontHintType.EastAsia&&_.isNullOrUndefined(o)&&null!=this.documentHelper.themeFontLanguage&&("minorBidi"===n||"majorBidi"===n))return n=this.getFontNameWithFontScript(t,this.documentHelper.themeFontLanguage.localeIdBidi,r);return _.isNullOrUndefined(o)&&(o=We),n=o},Rl.prototype.getFontNameWithFontScript=function(e,t,i){var n=null,r=t.toString(),e=e.fontTypeface;return("gu_IN"!=r&&1095!=t||!e.containsKey("Gujr"))&&("hi_IN"!=r&&"mr_IN"!=r&&1081!=t&&1102!=t||!e.containsKey("Deva"))&&!(("ko_KR"==r||1042==t)&&e.containsKey("Hang")||("zh_CN"==r||"zh_SG"==r||2052==t)&&e.containsKey("Hans")||("zh_TW"==r||"zh_HK"==r||"zh_MO"==r)&&e.containsKey("Hant")||("ja_JP"==r||1041==t)&&e.containsKey("Jpan")||("ta_IN"==r||1097==t)&&e.containsKey("Taml")||("te_IN"==r||1098==t)&&e.containsKey("Telu")||("he_IL"==r||"yi_Hebr"==r||1037==t)&&e.containsKey("Hebr"))?"th_TH"!=r&&1054!=t||!e.containsKey("Thai")?i==V.FontHintType.CS&&e.containsKey("Arab")&&(n=e.get("Arab")):n=e.get("Thai"):n=e.get("Arab"),n},Rl.prototype.destroy=function(){this.documentHelper=void 0,this.context=void 0,this.paragraphMarkInfo={},this.paragraphMarkInfo=void 0},Rl.wordSplitCharacters=[String.fromCharCode(32),String.fromCharCode(33),String.fromCharCode(34),String.fromCharCode(35),String.fromCharCode(36),String.fromCharCode(37),String.fromCharCode(38),String.fromCharCode(39),String.fromCharCode(40),String.fromCharCode(41),String.fromCharCode(42),String.fromCharCode(43),String.fromCharCode(44),String.fromCharCode(45),String.fromCharCode(46),String.fromCharCode(47),String.fromCharCode(58),String.fromCharCode(59),String.fromCharCode(60),String.fromCharCode(61),String.fromCharCode(62),String.fromCharCode(63),String.fromCharCode(64),String.fromCharCode(91),String.fromCharCode(92),String.fromCharCode(93),String.fromCharCode(94),String.fromCharCode(95),String.fromCharCode(96),String.fromCharCode(123),String.fromCharCode(124),String.fromCharCode(125),String.fromCharCode(126),String.fromCharCode(1548),String.fromCharCode(1563),String.fromCharCode(8211),String.fromCharCode(8212),String.fromCharCode(8216),String.fromCharCode(8217),String.fromCharCode(8221),String.fromCharCode(12288),String.fromCharCode(8207)],Rl.numberNonReversingCharacters=[String.fromCharCode(44),String.fromCharCode(46),String.fromCharCode(47),String.fromCharCode(58),String.fromCharCode(1548)];var Bl=Rl;function Rl(e){this.paragraphMarkInfo={},this.documentHelper=e,_.isNullOrUndefined(e)||(this.context=e.containerContext)}t.prototype.isSameStyle=function(e,t){var i=void 0;if(t?e.nextWidget instanceof G&&(i=e.nextWidget):e.previousWidget instanceof G&&(i=e.previousWidget),_.isNullOrUndefined(i)){if(e.paragraphFormat.contextualSpacing&&e.isInsideTable&&(!this.documentHelper.allowSpaceOfSameStyleInTable||"Word2013"===this.documentHelper.compatibilityMode))if(0===e.index)i=this.updateFirstParagraphSpacingBasedOnContextualSpacing(e,t);else if(e.index===e.associatedCell.childWidgets.length-1&&(i=this.updateLastParagraphSpacingBasedOnContextualSpacing(e))===e)return!0;if(_.isNullOrUndefined(i))return!1}if(!(i instanceof G&&e.paragraphFormat.baseStyle===i.paragraphFormat.baseStyle)||e.isInsideTable&&this.documentHelper.allowSpaceOfSameStyleInTable)return!1;if(0<=e.paragraphFormat.listFormat.listId&&0<=i.paragraphFormat.listFormat.listId&&!e.paragraphFormat.contextualSpacing){if(t&&e.paragraphFormat.spaceAfterAuto)return!0;if(!t&&e.paragraphFormat.spaceBeforeAuto)return!0}return e.paragraphFormat.contextualSpacing},t.prototype.updateFirstParagraphSpacingBasedOnContextualSpacing=function(e,t){var i=e.associatedCell,n=i.ownerRow,r=n.ownerTable,o=t?_.isNullOrUndefined(e.nextRenderedWidget)?_.isNullOrUndefined(i.nextRenderedWidget)?void 0:i.nextRenderedWidget.firstChild:e.nextRenderedWidget:_.isNullOrUndefined(e.previousRenderedWidget)?_.isNullOrUndefined(i.previousRenderedWidget)?void 0:i.previousRenderedWidget.firstChild:e.previousRenderedWidget;if(0===i.index&&0===e.index){if(0!==n.index)return _.isNullOrUndefined(o)&&"Normal"===e.paragraphFormat.baseStyle.name&&e.paragraphFormat.listFormat.listId<0?e:o;if(!r.isInsideTable||0!=r.index)return r.previousRenderedWidget;o=this.checkOwnerTablePrevItem(r,e)}else if(0===e.index&&!t){r=n.childWidgets[i.index-1];if(r.childWidgets[r.childWidgets.length-1]instanceof K&&"Normal"===e.paragraphFormat.baseStyle.name&&e.paragraphFormat.listFormat.listId<0)return e}return o},t.prototype.updateLastParagraphSpacingBasedOnContextualSpacing=function(e){var t=e.associatedCell,i=t.ownerRow;if(t.index===i.childWidgets.length-1&&e.index===t.childWidgets.length-1){if("Normal"===e.paragraphFormat.baseStyle.name&&e.paragraphFormat.listFormat.listId<0)return e}else if(e.index===t.childWidgets.length-1)for(var n=i.childWidgets[t.index+1].firstChild;n instanceof K;)n=n.childWidgets[0].childWidgets[0].childWidgets[0];return n},t.prototype.checkOwnerTablePrevItem=function(e,t){e=e.associatedCell.ownerRow;if(0<e.index){if("Normal"===t.paragraphFormat.baseStyle.name&&t.paragraphFormat.listFormat.listId<0)return t}else{if(!e.ownerTable.isInsideTable||0!==e.ownerTable.index)return e.ownerTable.previousRenderedWidget;this.checkOwnerTablePrevItem(e.ownerTable,t)}},Object.defineProperty(t.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),t.prototype.layout=function(){},t.prototype.destroy=function(){this.documentHelper=void 0,this.value=void 0,this.allowLayout=void 0,this.isInitialLoad=void 0,this.fieldBegin=void 0,this.maxTextHeight=void 0,this.maxBaseline=void 0,this.maxTextBaseline=void 0,this.isSkipFirstLineIndent=void 0,this.isFieldCode=void 0,this.footnoteHeight=void 0,this.isMultiColumnDoc=void 0,this.isIFfield=void 0},t.prototype.layoutItems=function(e,t,i){for(var n,r=this,o=0,s=0,a=0;a<e.length;a++){var l,d,h,c=e[a],p=(1<c.sectionFormat.numberOfColumns&&(this.isMultiColumnDoc=!0),e[a+1]),u=(this.viewer.columnLayoutArea.setColumns(c.sectionFormat),this.documentHelper.pages[this.documentHelper.pages.length-1]),g=void 0,g=(_.isNullOrUndefined(u)||_.isNullOrUndefined(u.bodyWidgets[u.bodyWidgets.length-1])||0!==u.bodyWidgets[u.bodyWidgets.length-1].childWidgets.length||_.isNullOrUndefined(u.bodyWidgets[u.bodyWidgets.length-1].previousSplitWidget)||(g=u.bodyWidgets[u.bodyWidgets.length-1].previousSplitWidget),!(0<a)||_.isNullOrUndefined(g)||_.isNullOrUndefined(g.lastChild)||g.lastChild instanceof K||!("Word2013"===this.documentHelper.compatibilityMode&&g.lastChild.isEndsWithPageBreak||g.lastChild.isEndsWithColumnBreak)||0!==u.bodyWidgets[0].childWidgets.length||(this.documentHelper.pages.splice(this.documentHelper.pages.length-1,1)[0].destroy(),u=this.documentHelper.pages[this.documentHelper.pages.length-1]),c.sectionFormat.breakCode),m=void 0;if(0!==a&&"Word2010"===this.documentHelper.compatibilityMode&&"NewColumn"===g&&1<(m=(l=e[a-1].getSplitWidgets())[l.length-1]).sectionFormat.columns.length&&1<c.sectionFormat.columns.length&&m.sectionFormat.columns.length===c.sectionFormat.columns.length&&m.sectionFormat.columns.length-1!==m.columnIndex&&!(m.lastChild instanceof G&&m.lastChild.isEndsWithPageBreak)&&(l=this.viewer.columnLayoutArea.getNextColumnByBodyWidget(m),_.isNullOrUndefined(l)||(c.columnIndex=l.index,c.isWord2010NextColumn=!0,c.y=m.y,this.viewer.clientActiveArea.height-=c.y-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=c.y)),c.isWord2010NextColumn||"NoBreak"===g||(g="NewPage"),0===a&&!i||0!==a&&!c.isWord2010NextColumn&&(_.isNullOrUndefined(g)||"NewPage"===g||o!==c.sectionFormat.pageHeight||s!==c.sectionFormat.pageWidth||!_.isNullOrUndefined(u.bodyWidgets[u.bodyWidgets.length-1].lastChild)&&u.bodyWidgets[u.bodyWidgets.length-1].lastChild.isEndsWithPageBreak)?n=this.viewer.createNewPage(c):(l=this.documentHelper.viewer.clientActiveArea.y,g=this.documentHelper.viewer.clientActiveArea.height,i&&(h=this.getBodyWidget(u.bodyWidgets[u.bodyWidgets.length-1],!0),d=this.getNextWidgetHeight(h),this.viewer.updateClientArea(h,h.page),g=this.viewer.clientActiveArea.height-(d-this.viewer.clientActiveArea.y),l=d,i=!1),(n=u).bodyWidgets.push(c),n.bodyWidgets[n.bodyWidgets.length-1].page=n,this.documentHelper.viewer.updateClientArea(c,n),this.documentHelper.viewer.clientActiveArea.y=l,this.documentHelper.viewer.clientActiveArea.height=g),o=c.sectionFormat.pageHeight,s=c.sectionFormat.pageWidth,this.addBodyWidget(this.viewer.clientActiveArea,c),1<this.documentHelper.pages.length){for(var f=0,y=0;y<this.documentHelper.pages.length;y++){var v=this.documentHelper.pages[y],w=v.sectionIndex;if(c.index<w||v===n)break;f++}f<this.documentHelper.pages.length-1&&this.documentHelper.insertPage(f,n)}this.layoutSection(c,0,p),c.isWord2010NextColumn&&!_.isNullOrUndefined(m)&&(h=this.getNextWidgetHeight(m),this.viewer.clientActiveArea.y<h)&&(this.viewer.updateClientArea(m,m.page),this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.height-(h-this.viewer.clientActiveArea.y),this.viewer.clientActiveArea.y=h)}t||this.layoutComments(this.documentHelper.comments),this.updateFieldElements(),"Pages"===this.documentHelper.owner.layoutType&&this.layoutEndNoteElement(),setTimeout(function(){r.documentHelper&&(r.documentHelper.isScrollHandler=!0,r.documentHelper.clearContent(),r.viewer.updateScrollBars(),r.documentHelper.isScrollHandler=!1,r.isInitialLoad=!1)},50)},t.prototype.layoutComments=function(e){_.isNullOrUndefined(e)||this.viewer.owner.commentReviewPane.layoutComments()},t.prototype.layoutSection=function(e,t,i){var n,r,o,s=e.firstChild;do{}while(s instanceof K&&"Auto"===s.tableFormat.preferredWidthType&&!s.tableFormat.allowAutoFit&&s.calculateGrid(),_.isNullOrUndefined(s)||(this.viewer.updateClientAreaForBlock(s,!0,void 0,!0,!0),s.containerWidget.indexInOwner,n=this.layoutBlock(s,t),t=0,this.viewer.updateClientAreaForBlock(s,!1),s=n),s);for(s=e.firstChild,this.viewer instanceof Sd&&1<e.sectionFormat.numberOfColumns&&!_.isNullOrUndefined(i)&&"NoBreak"===i.sectionFormat.breakCode&&("NoBreak"===e.sectionFormat.breakCode||e.sectionIndex===e.page.bodyWidgets[0].sectionIndex)&&(this.getColumnBreak(e)?(i=(i=e.getSplitWidgets())[i.length-1],_.isNullOrUndefined(e.page.nextPage)?(r=this.getBodyWidget(i,!0),this.viewer.updateClientArea(r,r.page),r=this.getNextWidgetHeight(r),this.viewer.clientActiveArea.height-=r-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=r):this.splitBodyWidgetBasedOnColumn(i)):(_.isNullOrUndefined(e.page.nextPage)||(e=this.documentHelper.pages[this.documentHelper.pages.length-1].bodyWidgets[0]),this.splitBodyWidgetBasedOnColumn(e))),s&&s.bodyWidget&&s.bodyWidget.page&&(o=s.bodyWidget.page);o;)o=(o.footnoteWidget&&this.layoutfootNote(o.footnoteWidget),o.nextPage);o=void 0},t.prototype.reLayoutMultiColumn=function(e,t,i){this.isInitialLoad=!0,e=e.getSplitWidgets()[0],this.combineMultiColumnForRelayout(e),1<e.sectionFormat.numberOfColumns&&(this.isMultiColumnDoc=!0),this.isMultiColumnSplit=!1;var n=e.previousRenderedWidget,r=e.nextRenderedWidget,o=!1;if(!t&&!_.isNullOrUndefined(e.firstChild)&&e.firstChild instanceof G&&e.y!==e.firstChild.y&&(e.y=e.firstChild.y),t&&r&&e.page!==r.page&&e.firstChild instanceof G){var t=0,s=(t=(a=e.firstChild).isEmpty()?this.documentHelper.textHelper.getParagraphMarkSize(a.characterFormat).Height:(s=a.childWidgets[0],this.getMaxElementHeight(s)),a.previousRenderedWidget);e.y===this.viewer.clientActiveArea.y&&t>this.viewer.clientActiveArea.height&&(s=_.isNullOrUndefined(s)?a:s,this.moveBlocksToNextPage(s),this.viewer.columnLayoutArea.setColumns(e.sectionFormat),this.viewer.updateClientArea(e,e.page),o=!0)}else if(!_.isNullOrUndefined(n)&&n.page!==e.page&&e.firstChild instanceof G&&n.lastChild instanceof G){var t=n.lastChild,a=e.firstChild;if(e instanceof z&&n.lastChild&&t instanceof G&&"NoBreak"===n.sectionFormat.breakCode&&e.page.index!==n.page.index&&e.index!==n.index){s=n,t=(1<s.sectionFormat.columns.length&&(s=this.getBodyWidget(s,!0)),j.round(this.getNextWidgetHeight(s)+a.height,2));if(!n.lastChild.isEndsWithPageBreak&&!n.lastChild.isEndsWithColumnBreak&&t<=j.round(this.viewer.clientActiveArea.bottom,2)){for(var l=n.page,d=e.page,h=0;h<d.bodyWidgets.length;h++){var c=d.bodyWidgets[h];d.bodyWidgets.splice(d.bodyWidgets.indexOf(c),1),l.bodyWidgets.splice(l.bodyWidgets.length,0,c),c.page=l,h--}e.y=this.viewer.clientActiveArea.y,this.documentHelper.removeEmptyPages()}}}o||(this.viewer.columnLayoutArea.setColumns(e.sectionFormat),this.viewer.updateClientArea(e,e.page),this.viewer.clientActiveArea.height-=e.y-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=e.y),this.addBodyWidget(this.viewer.clientActiveArea,e),this.clearBlockWidget(e.childWidgets,!0,!0,!0),this.isMultiColumnLayout=!0,this.reLayoutMultiColumnBlock(e,r,i),this.isMultiColumnLayout=!1,this.isInitialLoad=!1;s=e.getSplitWidgets(),a=s[s.length-1],t=this.getBodyWidget(a,!0),this.viewer.updateClientArea(t,t.page),n=this.getNextWidgetHeight(t);this.viewer.clientActiveArea.height-=n-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=n,_.isNullOrUndefined(a)||_.isNullOrUndefined(a.nextRenderedWidget)||(r=a.nextRenderedWidget,o=this.documentHelper.viewer.clientActiveArea.y,i=this.documentHelper.viewer.clientActiveArea.height,this.documentHelper.viewer.updateClientArea(r,r.page),this.documentHelper.viewer.clientActiveArea.y=o,this.documentHelper.viewer.clientActiveArea.height=i,this.documentHelper.blockToShift=r.firstChild),(_.isNullOrUndefined(a.nextRenderedWidget)||!_.isNullOrUndefined(a.nextRenderedWidget)&&"NoBreak"!==a.sectionFormat.breakCode&&a.nextRenderedWidget.sectionFormat.pageHeight!==a.sectionFormat.pageHeight&&a.nextRenderedWidget.sectionFormat.pageWidth!==a.sectionFormat.pageWidth)&&(this.documentHelper.blockToShift=void 0)},t.prototype.combineMultiColumnForRelayout=function(e){var t=e.getSplitWidgets(),i=t[0];for(e=t[t.length-1];e!==i;){for(var n=e.previousRenderedWidget,r=!1,o=0;o<e.childWidgets.length;o++)e.childWidgets[o]instanceof Qd&&!_.isNullOrUndefined(e.childWidgets[o].previousSplitWidget)&&!_.isNullOrUndefined(e.childWidgets[o].previousSplitWidget.previousSplitWidget)&&e.childWidgets[o].previousSplitWidget.bodyWidget.page!==e.childWidgets[o].previousSplitWidget.previousSplitWidget.bodyWidget.page&&(r=!0),e.childWidgets[o]instanceof Qd&&!_.isNullOrUndefined(e.childWidgets[o].previousSplitWidget)&&e.childWidgets[o].previousSplitWidget.bodyWidget.page===e.childWidgets[o].bodyWidget.page&&!r?(e.childWidgets[o].combineWidget(this.viewer),n.lastChild instanceof K&&this.updateCellHeightInCombinedTable(n.lastChild)):(n.childWidgets.push(e.childWidgets[o]),e.childWidgets[o].containerWidget=n,e.childWidgets[o].containerWidget.page=n.page,e.childWidgets.splice(0,1)),o--;e=e.previousRenderedWidget}this.documentHelper.removeEmptyPages()},t.prototype.reLayoutMultiColumnBlock=function(e,t,i){for(var n,r,o=e.firstChild;o instanceof K&&"Auto"===o.tableFormat.preferredWidthType&&!o.tableFormat.allowAutoFit&&o.calculateGrid(),_.isNullOrUndefined(o)||(this.viewer.updateClientAreaForBlock(o,!0,void 0,!0),n=this.layoutBlock(o,0,o.index<i),this.viewer.updateClientAreaForBlock(o,!1),o=n),o&&-1!==e.getSplitWidgets().indexOf(o.bodyWidget););o=e.firstChild,this.viewer instanceof Sd&&1<e.sectionFormat.numberOfColumns&&!_.isNullOrUndefined(t)&&"NoBreak"===t.sectionFormat.breakCode&&("NoBreak"===e.sectionFormat.breakCode||e.sectionIndex===e.page.bodyWidgets[0].sectionIndex)&&(t=(t=e.getSplitWidgets())[t.length-1],this.getColumnBreak(e)?e.page!==t.page?this.splitBodyWidgetBasedOnColumn(t):(r=this.getBodyWidget(t,!0),this.viewer.updateClientArea(r,r.page),r=this.getNextWidgetHeight(r),this.viewer.clientActiveArea.height-=r-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=r):_.isNullOrUndefined(e.page.nextPage)||this.splitBodyWidgetBasedOnColumn(t))},t.prototype.splitBodyWidgetBasedOnColumn=function(e){var t,i=e=this.getBodyWidget(e,!0);this.isMultiColumnSplit=!0,!this.isInitialLoad&&e.sectionFormat.equalWidth&&(n=this.documentHelper.selection.startOffset,t=this.documentHelper.selection.endOffset,this.combineMultiColumn(e),this.layoutMultiColumnBody(e,!1),n!==this.documentHelper.selection.startOffset)&&this.documentHelper.selection.select(n,t),this.combineMultiColumn(e);for(var n=this.getCountOrLine(e,void 0,void 0,!0).lineCount,r=Math.round(n/e.sectionFormat.numberOfColumns);e;){var o=this.getCountOrLine(e,r,!0,!1),s=o.lineWidget,o=o.lineCount;if(!_.isNullOrUndefined(s)){if(s.paragraph.containerWidget instanceof z)this.moveToNextLine(s,!0,s.indexInOwner);else if(s.paragraph.containerWidget instanceof N){for(var a=[s.paragraph.containerWidget.ownerTable],l=[s.paragraph.containerWidget.ownerRow],d=s.paragraph.containerWidget.index,o=(a[a.length-1].isInsideTable&&(a[a.length-1]=this.getParentTable(a[a.length-1]),l[l.length-1]=this.getParentRow(l[l.length-1])),this.updateWidgetsToTable(a,l,l[l.length-1],!1,o,d,!0),a[a.length-1]),h=l[l.length-1].nextRenderedWidget;h;)this.clearRowWidget(h,!0,!0,!1),h=(h=this.layoutRow(a,h)).nextRenderedWidget;!_.isNullOrUndefined(o.nextRenderedWidget)&&e.sectionFormat.equalWidth&&(this.documentHelper.blockToShift=o.nextRenderedWidget,this.documentHelper.layout.shiftLayoutedItems(!1))}d=this.getBodyWidget(s.paragraph.bodyWidget,!0),l=this.getBodyWidget(d,!1);!d.sectionFormat.equalWidth&&l.sectionFormat.numberOfColumns-1===l.columnIndex&&_.isNullOrUndefined(l.nextSplitWidget)&&(s=this.getCountOrLine(o=d).lineCount,this.layoutMultiColumnBody(o,!0),s!==this.getCountOrLine(d).lineCount)&&this.splitBodyWidgetBasedOnColumn(d),_.isNullOrUndefined(l.nextSplitWidget)&&(this.viewer.updateClientArea(d,d.page),o=this.getNextWidgetHeight(d),this.viewer.clientActiveArea.height-=o-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=o,this.viewer.clientArea.y=this.viewer.clientActiveArea.y,this.viewer.clientArea.height=this.viewer.clientActiveArea.height)}if(e=e.nextRenderedWidget,!_.isNullOrUndefined(e)&&e.columnIndex===e.sectionFormat.numberOfColumns-1)break}this.isMultiColumnSplit=!1,this.isInitialLoad||(e=this.getBodyWidget(i,!1),_.isNullOrUndefined(e.nextRenderedWidget))||(this.documentHelper.blockToShift=e.nextRenderedWidget.firstChild)},t.prototype.getColumnBreak=function(e){var t=this.getBodyWidget(e,!0);if(!(t.sectionFormat.numberOfColumns<=1))for(;t;){if(t.lastChild instanceof G&&t.lastChild.isEndsWithColumnBreak)return!0;if(_.isNullOrUndefined(t.nextRenderedWidget)||t.index!==t.nextRenderedWidget.index)break;t=t.nextRenderedWidget}return!1},t.prototype.layoutMultiColumnBody=function(e,t){for(var i=!1;e;){i||(this.viewer.updateClientArea(e,e.page),this.viewer.clientActiveArea.height-=e.y-this.viewer.clientActiveArea.y,e instanceof q?(this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY):this.viewer.clientActiveArea.y=e.y);for(var i=!t,n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n],o=(r instanceof K&&this.clearTableWidget(r,!0,!0,!0),this.viewer.updateClientAreaForBlock(r,!0),!1);r instanceof G&&!_.isNullOrUndefined(r.paragraphFormat)&&-1!==r.paragraphFormat.listFormat.listId&&(o=0===r.paragraphFormat.listFormat.listLevelNumber),this.layoutBlock(r,0,o),this.viewer.updateClientAreaForBlock(r,!1)}if(e.columnIndex===e.sectionFormat.numberOfColumns-1||!_.isNullOrUndefined(e.nextRenderedWidget)&&e.sectionIndex!==e.nextRenderedWidget.sectionIndex)break;e=e.nextRenderedWidget}},t.prototype.getNextWidgetHeight=function(e){for(var t=0,i=0;e&&0<e.childWidgets.length&&(t=e.lastChild.height,e.lastChild instanceof K&&(t=this.getHeight(e.lastChild)),i<(t+=e.lastChild.y)&&(i=t),_.isNullOrUndefined(e)||e.columnIndex!==e.sectionFormat.numberOfColumns-1)&&0!==e.sectionFormat.numberOfColumns&&(_.isNullOrUndefined(e.nextRenderedWidget)||e.sectionIndex===e.nextRenderedWidget.sectionIndex);)e=e.nextRenderedWidget;return i},t.prototype.getHeight=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;return t},t.prototype.getBookmarkMargin=function(e){for(var t=0,i=0;i<e.children.length;i++){var n=e.children[i];if(!_.isNullOrUndefined(n.margin)&&n instanceof J){t=n.margin.top+n.margin.bottom;break}}return t},t.prototype.getCountOrLine=function(e,t,i,n){for(var r,o,s=0,a=!1,l=0,d=0,h=0;e;){for(var c=0;c<e.childWidgets.length;c++){var p=e.childWidgets[c];if(p instanceof G)for(var u=0;u<p.childWidgets.length;u++){var g=p.childWidgets[u],h=0;if(_.isNullOrUndefined(g.margin)||(h=g.margin.top+g.margin.bottom+this.getBookmarkMargin(g)),i){if(l+=g.height-h,Math.round(t)<Math.round(l)){r=p.childWidgets[u],a=!0;break}}else s++,l+=g.height-h}else p instanceof K&&(o=this.getCountOrLineTable(p,t,i,l,!1,n),n?l+=o.lineCount:i?_.isNullOrUndefined(o.lineWidget)?l=o.lineCount:(r=o.lineWidget,d=o.lineCount,a=!0):s+=o.lineCount);if(a&&i)break}if(a&&i)break;if(!_.isNullOrUndefined(e.nextRenderedWidget)&&e.index!==e.nextRenderedWidget.index)break;e=e.nextRenderedWidget}return n?{lineWidget:void 0,lineCount:l}:i?{lineWidget:r,lineCount:d}:{lineWidget:void 0,lineCount:s}},t.prototype.getCountOrLineTable=function(e,t,i,n,r,o){for(var s,a,l=0,d=!1,h=0,c=0,p=0,u=0,g=0,m=0,f=0;f<e.childWidgets.length;f++){for(var y=e.childWidgets[f],v=void 0,w=void 0,p=0,u=0,g=0,m=0,b=0;b<y.childWidgets.length;b++){for(var x=y.childWidgets[b],C=0;C<x.childWidgets.length;C++)if((k=x.childWidgets[C])instanceof G&&0<k.childWidgets.length)for(var I=0;I<k.childWidgets.length;I++)p++,v=x,g+=k.childWidgets[I].height;else p+=(a=this.getCountOrLineTable(k,t,i,n,!0,o)).lineCount,g+=a.lineCount;u<p&&(u=p),m<g&&(m=g,w=v),g=p=0}if(!i||r)h+=u,c+=m;else for(var k,F=0,P=0;P<w.childWidgets.length;P++){if((k=w.childWidgets[P])instanceof G)for(b=0;b<k.childWidgets.length;b++){if(n+=k.childWidgets[b].height,Math.round(t)<Math.round(n)){s=k.childWidgets[b],d=!0,n=0,l=F;break}if(F++,d&&i)break}else{if(a=this.getCountOrLineTable(k,t,i,n,!1,o),!_.isNullOrUndefined(a.lineWidget)){d=!0,n=0,s=a.lineWidget,l=F+=a.lineCount;break}F+=a.lineCount,n+=k.height}if(d&&i)break}if(u=0,d&&i)break}return o?{lineWidget:void 0,lineCount:c}:!i||_.isNullOrUndefined(s)&&r?{lineWidget:void 0,lineCount:h}:i&&_.isNullOrUndefined(s)&&!r?{lineWidget:void 0,lineCount:n}:{lineWidget:s,lineCount:l}},t.prototype.combineMultiColumn=function(e){for(e=this.getBodyWidget(e,!1);e&&0!==e.columnIndex;){var t=e.previousRenderedWidget;if(t.lastChild instanceof G&&t.lastChild.isEndsWithColumnBreak)break;for(var i=!1,n=0;n<e.childWidgets.length;n++)e.childWidgets[n]instanceof Qd&&!_.isNullOrUndefined(e.childWidgets[n].previousSplitWidget)&&!_.isNullOrUndefined(e.childWidgets[n].previousSplitWidget.previousSplitWidget)&&e.childWidgets[n].previousSplitWidget.bodyWidget.page!==e.childWidgets[n].previousSplitWidget.previousSplitWidget.bodyWidget.page&&(i=!0),e.childWidgets[n]instanceof Qd&&!_.isNullOrUndefined(e.childWidgets[n].previousSplitWidget)&&e.childWidgets[n].previousSplitWidget.bodyWidget.page===e.childWidgets[n].bodyWidget.page&&!i?(e.childWidgets[n].combineWidget(this.viewer),t.lastChild instanceof K&&this.updateCellHeightInCombinedTable(t.lastChild)):(t.childWidgets.push(e.childWidgets[n]),e.childWidgets[n].containerWidget=t,e.childWidgets[n].containerWidget.page=t.page,e.childWidgets.splice(0,1)),n--;e=e.previousRenderedWidget}this.documentHelper.removeEmptyPages()},t.prototype.updateCellHeightInCombinedTable=function(e){for(var t=0,i=0,n=0;n<e.childWidgets.length;n++){for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++){for(var s=r.childWidgets[o],a=0;a<s.childWidgets.length;a++)i+=s.childWidgets[a].height;t<i&&(t=i);for(var i=0,l=0;l<r.childWidgets.length;l++)r.childWidgets[l].height=t}t=0}},t.prototype.layoutHeaderFooter=function(e,t,i){var n,r,o=t.getCurrentPageHeaderFooter(e,!0);o&&(n=o,_.isNullOrUndefined(o.page)&&(o.page=i,o.height=0,this.clearBlockWidget(o.childWidgets,!0,!0,!0),t.updateHFClientArea(e.sectionFormat,!0),this.layoutHeaderFooterItems(t,o)),(o=n.clone()).parentHeaderFooter=n,this.clearBlockWidget(o.childWidgets,!0,!0,!0),(r=o).page=i,r.height=0,this.updateRevisionsToHeaderFooter(r,i),t.updateHFClientArea(e.sectionFormat,!0),i.headerWidget=this.layoutHeaderFooterItems(t,r),e.sectionFormat.topMargin<i.boundingRectangle.bottom)&&0<i.headerWidget.floatingElements.length&&"Behind"!==i.headerWidget.floatingElements[0].textWrappingStyle&&(i.headerWidget=this.shiftItemsForVerticalAlignment(r)),(o=t.getCurrentPageHeaderFooter(e,!1))&&(n=o,_.isNullOrUndefined(o.page)&&(o.page=i,o.height=0,this.clearBlockWidget(o.childWidgets,!0,!0,!0),t.updateHFClientArea(e.sectionFormat,!1),this.layoutHeaderFooterItems(t,o)),(o=n.clone()).parentHeaderFooter=n,this.clearBlockWidget(o.childWidgets,!0,!0,!0),(r=o).page=i,r.height=0,t.updateHFClientArea(e.sectionFormat,!1),this.updateRevisionsToHeaderFooter(r,i),i.footerWidget=this.layoutHeaderFooterItems(t,r))},t.prototype.shiftItemsForVerticalAlignment=function(e){for(var t=e.floatingElements,i=0;i<t.length;i++){var n=t[i],r=n.verticalOrigin,o=n.paragraph;if("Margin"===r&&!o.isInsideTable){r=n.verticalPosition;if(0!=r){var s=(r+=this.viewer.clientActiveArea.y)-n.y;if(n.y=r,n instanceof uc)for(var a=0;a<n.textFrame.childWidgets.length;a++){var l=n.textFrame.childWidgets[a];l instanceof G&&(l.y=l.y+s)}}}}return e},t.prototype.updateHeaderFooterToParent=function(e){var t=e.page.sectionIndex,i=this.viewer.getHeaderFooter(e.headerFooterType),n=e.clone();this.documentHelper.headersFooters[t][i]=n;for(var r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];o instanceof K&&this.clearTableWidget(o,!1,!0)}return n},t.prototype.updateRevisionsToHeaderFooter=function(e,t){var i=e.childWidgets;if(e instanceof Xd&&0<i.length)for(var n=0;n<i.length;n++)if(0<i[n].childWidgets.length)for(var r=i[n].childWidgets,o=0;o<r.length;o++){var s=r[o].children;if(s)for(var a=0;a<s.length;a++)if(0<s[a].removedIds.length)for(var l=s[a].removedIds,d=0;d<l.length;d++){var h=this.documentHelper.revisionsInternal.get(l[d]);s[a].revisions[d]=h,this.updateRevisionRange(h,t)}}},t.prototype.updateRevisionRange=function(e,t){for(var i=0;i<e.range.length;i++){var n=e.range[i];n.line.paragraph.bodyWidget.page||(n.line.paragraph.bodyWidget.page=t)}},t.prototype.linkFieldInHeaderFooter=function(e){for(var t=e.firstChild;t instanceof G?this.linkFieldInParagraph(t):this.linkFieldInTable(t),t=t.nextWidget;);},t.prototype.linkFieldInParagraph=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++){var r,o=i.children[n];if(o instanceof Z&&(0!==o.fieldType||0===o.fieldType&&-1===this.documentHelper.fields.indexOf(o))&&o.linkFieldCharacter(this.documentHelper),o instanceof Vh&&!_.isNullOrUndefined(o.previousElement)&&o.previousElement instanceof Z&&o.fieldBegin!==o.previousElement.fieldBegin&&(o.fieldBegin=o.previousElement.fieldBegin),o instanceof uc){var s=o.textFrame.firstChild;if(s)for(;s instanceof G?this.linkFieldInParagraph(s):this.linkFieldInTable(s),s=s.nextWidget;);}else o instanceof up&&(r=this.getCommentById(this.documentHelper.comments,o.commentId),_.isNullOrUndefined(r)||(0===o.commentType?r.commentStart=o:r.commentEnd=o,o.comment=r))}},t.prototype.getCommentById=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.commentId===t)return n}},t.prototype.linkFieldInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];s instanceof G?this.linkFieldInParagraph(s):this.linkFieldInTable(s)}},t.prototype.layoutHeaderFooterItems=function(e,t){var i;this.viewer.updateClientAreaLocation(t,e.clientActiveArea),0===t.childWidgets.length&&(i=new G,o=new uh(i),i.childWidgets.push(o),t.childWidgets.push(i),i.containerWidget=t),this.linkFieldInHeaderFooter(t);for(var n=0;n<t.childWidgets.length;n++){var r=t.childWidgets[n];r instanceof K&&"Auto"===r.tableFormat.preferredWidthType&&!r.tableFormat.allowAutoFit&&!r.isGridUpdated&&r.calculateGrid(),e.updateClientAreaForBlock(r,!0),this.layoutBlock(r,0),e.updateClientAreaForBlock(r,!1)}var o=t.headerFooterType;return"OddFooter"!==o&&"EvenFooter"!==o&&"FirstPageFooter"!==o||this.shiftChildLocation(e.clientArea.y-e.clientActiveArea.y,t),t},t.prototype.shiftChildLocation=function(e,t){var i=t.y+e,n=t.page.boundingRectangle.height-t.page.boundingRectangle.height/100*40;e=(i=Math.max(i,n))-t.y;for(var r=t.y=i,o=0;o<t.childWidgets.length;o++){var s=t.childWidgets[o];if(s instanceof G){s.x=s.x,s.y=0===o?s.y+e:r,r+=s.height;for(var a=0;a<s.childWidgets.length;a++)for(var l=s.childWidgets[a],d=0;d<l.children.length;d++){var h,c=l.children[d];c instanceof hc&&"Inline"!==c.textWrappingStyle&&("Paragraph"===c.verticalOrigin||"Line"===c.verticalOrigin?c.y=s.y+c.verticalPosition:(h=this.getFloatingItemPoints(c),c.y=h.y),c instanceof uc)&&(h=c.textFrame.marginTop,this.updateChildLocationForCellOrShape(c.y+h,c))}}else this.shiftChildLocationForTableWidget(s,e),r+=s.height}},t.prototype.shiftChildLocationForTableWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];n instanceof dh&&this.shiftChildLocationForTableRowWidget(n,t)}},t.prototype.shiftChildLocationForTableRowWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)this.shiftChildLocationForTableCellWidget(e.childWidgets[i],t)},t.prototype.shiftChildLocationForTableCellWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i]instanceof G?(e.childWidgets[i].x=e.childWidgets[i].x,e.childWidgets[i].y=e.childWidgets[i].y+t):this.shiftChildLocationForTableWidget(e.childWidgets[i],t)},t.prototype.layoutBlock=function(e,t,i){var n;return e instanceof G?((this.isInitialLoad||!this.isRelayout&&e.paragraphFormat.bidi&&this.isDocumentContainsRtl)&&(e.splitTextRangeByScriptType(0),e.splitLtrAndRtlText(0),e.combineconsecutiveRTL(0)),n=this.layoutParagraph(e,t,i),(i=this.checkAndRelayoutPreviousOverlappingBlock(e))&&(n=i)):(n=this.layoutTable(e,t),this.checkAndRelayoutPreviousOverlappingBlock(e),this.updateTableYPositionBasedonTextWrap(n)),n.nextRenderedWidget},t.prototype.updateTableYPositionBasedonTextWrap=function(i){var n,r,o=this;_.isNullOrUndefined(i.bodyWidget)||i.containerWidget instanceof fc||(n=i.y,r=new Rd(i.x,i.y,i.width,i.height),i.bodyWidget.floatingElements.forEach(function(e){var t;e instanceof uc&&!e.paragraph.isInsideTable&&(t=new Rd(e.x,e.y,e.width,e.height),"TopAndBottom"===e.textWrappingStyle||"Square"===e.textWrappingStyle)&&r.isIntersecting(t)&&(i.y=e.y+e.height+e.distanceBottom,o.updateChildLocationForTable(i.y,i),t=i.y-n,o.viewer.cutFromTop(o.viewer.clientActiveArea.y+t))}))},t.prototype.shiftWrapStyle=function(e){return"InFrontOfText"===e.textWrappingStyle||"Behind"===e.textWrappingStyle||"Inline"===e.textWrappingStyle},t.prototype.checkAndRelayoutPreviousOverlappingBlock=function(e){if(!(e.containerWidget instanceof fc||this.isRelayoutOverlap)){var t=e.previousWidget;if(e instanceof G)if(0<e.floatingElements.length)for(var i=0,n=0;n<e.floatingElements.length;n++){var r=e.floatingElements[n];if(!this.shiftWrapStyle(r)){for(var o,s=new Rd(r.x,r.y,r.width,r.height);t;){if(e.isInsideTable&&i>this.viewer.clientArea.height){this.startOverlapWidget=void 0,this.endOverlapWidget=void 0;break}t instanceof G&&(o=new Rd(t.x,t.y,t.width,t.height),s.isIntersecting(o))&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=e),i+=t.height,t=t.previousWidget}t=e.previousWidget}}else{var a=e.getSplitWidgets();if(a)return a[a.length-1]}else{var a=e;if(!a.wrapTextAround)return a;for(var l,d=new Rd(a.x,a.y,a.getTableCellWidth(),a.height);t;)t instanceof G&&(l=new Rd(t.x,t.y,t.width,t.height),d.isIntersecting(l))&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=e),t=t.previousWidget;t=e.previousWidget}e instanceof G&&e.containerWidget instanceof z&&0<e.floatingElements.length&&!this.shiftWrapStyle(e.floatingElements[0])&&e.containerWidget.firstChild!=e&&e.y+e.floatingElements[0].height>this.viewer.clientArea.bottom&&(a=e.previousWidget)&&a instanceof G&&a.y+a.height+this.getLineHeigth(e,e.floatingElements[0].line)+e.floatingElements[0].height>this.viewer.clientArea.bottom&&(this.moveToNextPage(this.viewer,e.floatingElements[0].line,!1,!1,!0),this.startOverlapWidget=e,this.endOverlapWidget=e),this.startOverlapWidget&&(this.isRelayoutOverlap=!0,this.skipRelayoutOverlap=!0,this.layoutStartEndBlocks(this.startOverlapWidget,e),this.isRelayoutOverlap=!1,this.skipRelayoutOverlap=!1),this.startOverlapWidget=void 0,this.endOverlapWidget=void 0}return e},t.prototype.getLineHeigth=function(e,t){for(var i=0,n=0;n<e.childWidgets.length;n++)t!=e.childWidgets[n]&&(i+=e.childWidgets[n].height);return i},t.prototype.addParagraphWidget=function(e,t){return t.isEmpty()&&!_.isNullOrUndefined(t.paragraphFormat)&&("Center"===t.paragraphFormat.textAlignment||"Right"===t.paragraphFormat.textAlignment||"Justify"===t.paragraphFormat.textAlignment&&t.paragraphFormat.bidi)&&-1===t.paragraphFormat.listFormat.listId?(this.updateXPositionForEmptyParagraph(e,t),t.y=e.y):(this.viewer.clientActiveArea.width<=0&&this.viewer instanceof Wd?t.x=this.previousPara:(t.x=e.x,this.previousPara=t.x),t.width=e.width,t.y=e.y,t.clientX=void 0,t.hasOwnProperty("absoluteXPosition")&&delete t.absoluteXPosition),t},t.prototype.updateXPositionForEmptyParagraph=function(e,t){var i,n;t.isEmpty()&&!_.isNullOrUndefined(t.paragraphFormat)&&(i=this.documentHelper.textHelper.getParagraphMarkWidth(t.characterFormat),t.clientX=e.x,n=e.x,t.absoluteXPosition={width:e.width,x:e.x},"Center"===t.paragraphFormat.textAlignment?n+=(e.width-i)/2:n+=e.width-i,t.width=i,t.x=n)},t.prototype.addLineWidget=function(e){var t=void 0;return(t=new uh(e)).width=e.width,e.childWidgets.push(t),t.paragraph=e,t},t.prototype.isFirstElementWithPageBreak=function(e){var t=!1;if(this.viewer instanceof Sd){e=e.childWidgets[0];if(e)for(var i=e.children[0];i;){if(!(i instanceof J&&0<=i.name.indexOf("_"))){i instanceof X&&("\f"===i.text||i.text===String.fromCharCode(14))&&(t=!0);break}i=i.nextElement}}return t},t.prototype.layoutfootNote=function(e){if("Pages"===this.documentHelper.owner.layoutType){for(var t,i,n,r,o=e.page.index,s=this.viewer.clientActiveArea.clone(),a=this.viewer.clientArea.clone(),l=("Footnote"===e.footNoteType&&1<e.sectionFormat.columns.length&&!this.isInitialLoad&&(this.updateColumnIndex(e.bodyWidgets[0],!1),this.layoutMultiColumnBody(e.bodyWidgets[0],!0)),"Endnote"===e.footNoteType&&1<e.bodyWidgets[0].sectionFormat.numberOfColumns&&(this.isInitialLoad||this.updateColumnIndex(e.bodyWidgets[0],!1),this.layoutMultiColumnBody(e.bodyWidgets[0],!0),this.viewer.clientActiveArea=s),0),d=(1<e.sectionFormat.columns.length&&"Footnote"===e.footNoteType&&(this.viewer.updateClientArea(e,e.page),l=this.viewer.clientActiveArea.width),"Footnote"===e.footNoteType&&(this.viewer.updateFootnoteClientArea(e.sectionFormat,e),1<e.sectionFormat.columns.length)&&(this.viewer.clientActiveArea.width=l,this.viewer.clientArea.width=l),void(e.height=0)),h=0,c=(this.isRelayoutFootnote=!1,0),p=(this.viewer instanceof Sd&&0<e.bodyWidgets.length&&("Footnote"===e.footNoteType&&1<e.sectionFormat.columns.length||"Endnote"===e.footNoteType&&1<e.bodyWidgets[0].sectionFormat.columns.length)&&(this.isLayoutWhole&&this.updateColumnIndex(e.bodyWidgets[0],!1),this.splitFootNoteWidgetBasedOnColumn(e.bodyWidgets[0])),e.bodyWidgets[0]),u=0;u<e.bodyWidgets.length;u++){e.bodyWidgets[u].columnIndex!==p.columnIndex&&("Footnote"===e.footNoteType&&1<e.sectionFormat.columns.length||"Endnote"===e.footNoteType&&1<e.bodyWidgets[u].sectionFormat.columns.length)&&(this.viewer.updateClientArea(e.bodyWidgets[u],e.bodyWidgets[u].page),l=this.viewer.clientActiveArea.width,t=this.viewer.clientActiveArea.x,"Footnote"===e.footNoteType&&this.viewer.updateFootnoteClientArea(e.sectionFormat,e),this.viewer.clientActiveArea.x=t,this.viewer.clientArea.x=t,this.viewer.clientActiveArea.width=l,this.viewer.clientArea.width=l,this.viewer.cutFromTop(e.y+h)),0===u&&((t=new G).characterFormat=new B,t.paragraphFormat=new Xa,t.index=0,i=new uh(t),t.childWidgets.push(i),h=this.documentHelper.textHelper.getParagraphMarkSize(t.characterFormat).Height,e.height+=h,e.y=this.viewer.clientActiveArea.y,"Endnote"===e.footNoteType&&this.viewer.updateClientArea(e.bodyWidgets[u],e.bodyWidgets[u].page,!0),this.viewer.cutFromTop(e.y+h),e.margin=new Dd(0,h,0,0));for(var c="Endnote"===e.footNoteType?0:c,g=0;g<e.bodyWidgets[u].childWidgets.length&&(d=e.bodyWidgets[u].childWidgets[g],"Footnote"!==e.footNoteType&&1!==e.bodyWidgets[u].getSplitWidgets().length||(d.index=c,c++),d.containerWidget=e.bodyWidgets[u],d.containerWidget.page=e.page,d.containerWidget.containerWidget=e,this.viewer.updateClientAreaForBlock(d,!0),d instanceof K&&(this.clearTableWidget(d,!0,!0,!0),this.isRelayoutFootnote=!0,"Footnote"===e.footNoteType)&&(this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY),this.layoutBlock(d,0),!_.isNullOrUndefined(e.bodyWidgets[u]));g++)e.bodyWidgets[u].columnIndex===p.columnIndex&&(e.height+=d.height),this.viewer.updateClientAreaForBlock(d,!1);p=e.bodyWidgets[u]}1<e.sectionFormat.columns.length&&(n=this.getFootNoteBodyHeight(e.bodyWidgets[0]),e.height=n+h),"Footnote"===e.footNoteType&&this.shiftChildWidgetInFootnote(e),"Footnote"===e.footNoteType&&1<e.sectionFormat.columns.length&&1<e.page.bodyWidgets[e.page.bodyWidgets.length-1].sectionFormat.columns.length&&(n=this.getBodyWidget(e.page.bodyWidgets[e.page.bodyWidgets.length-1],!0),this.getNextWidgetHeight(n)>e.y)&&(this.footnoteHeight=e.height,r=this.isLayoutWhole,this.isLayoutWhole=!1,this.layoutMultiColumnBody(n,!0),this.isLayoutWhole=r),this.viewer.clientActiveArea=s,this.viewer.clientArea=a,this.islayoutFootnote||this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height>e.y&&(this.viewer.clientActiveArea.height-=e.height,n=this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height-e.y,this.viewer.clientActiveArea.height-=n),"Endnote"===e.footNoteType&&(r=void 0,_.isNullOrUndefined(e.page.nextPage)||_.isNullOrUndefined(e.page.nextPage.endnoteWidget)?e.page.index!==o&&(r=e):r=e.page.nextPage.endnoteWidget,_.isNullOrUndefined(r)||(s=this.getBodyWidget(r.page.bodyWidgets[r.page.bodyWidgets.length-1],!0),this.viewer.updateClientArea(s,s.page),this.layoutfootNote(r)))}return this.footnoteHeight=0,e},t.prototype.getFootNoteBodyHeight=function(e){for(var t=0;e&&0===e.columnIndex;){for(var i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;e=e.nextRenderedWidget}return t},t.prototype.splitFootNoteWidgetBasedOnColumn=function(e){for(var t=this.getCountOrLine(e,void 0,void 0,!0).lineCount,i=Math.round(t/e.sectionFormat.numberOfColumns);e;){var n,r=this.getCountOrLine(e,i,!0,!1),o=this.viewer.clientActiveArea.clone(),s=this.viewer.clientArea.clone();if(0===r.lineWidget.paragraph.indexInOwner&&0===r.lineWidget.indexInOwner?this.updateColumnIndex(r.lineWidget.paragraph.bodyWidget,!0):(this.splitParagraph(r.lineWidget.paragraph,r.lineWidget.indexInOwner,void 0),n=this.moveBlocksToNextPage(r.lineWidget.paragraph.previousRenderedWidget),this.viewer.clientActiveArea=o,this.viewer.clientArea=s,_.isNullOrUndefined(n.nextRenderedWidget)||this.updateColumnIndex(n.nextRenderedWidget,!0)),r.lineWidget.paragraph.bodyWidget.columnIndex===r.lineWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns-1)break;e=e.nextRenderedWidget}},t.prototype.updateColumnIndex=function(e,t){for(;e;)t?e.columnIndex++:e.columnIndex=0,e=e.nextRenderedWidget},t.prototype.shiftChildWidgetInFootnote=function(e){for(var t,i=e.page,n=e.y-e.height,r=(1===i.bodyWidgets[0].childWidgets.length&&i.bodyWidgets[0].firstChild&&n<(t=i.bodyWidgets[0].firstChild.y)+(i=this.getBodyWidgetHeight(i.bodyWidgets[0]))&&(n=t+i),e.y=n,n+=e.margin.top),o=e.bodyWidgets[0],s=0;s<e.bodyWidgets.length;s++){e.bodyWidgets[s].columnIndex!==o.columnIndex&&(n=r);for(var o=e.bodyWidgets[s],a=0;a<e.bodyWidgets[s].childWidgets.length;a++){var l=e.bodyWidgets[s].childWidgets[a];l instanceof G?l.y=n:this.shiftChildLocationForTableWidget(l,n-l.y),n+=l.height}}},t.prototype.getBodyWidgetHeight=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;return t},t.prototype.checkParaHasField=function(e){for(var t=!1,i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.children.length;r++){var o=n.children[r];if(o instanceof Z&&(2===o.fieldType||1===o.fieldType)&&0<this.documentHelper.fieldStacks.length&&o.fieldBegin===this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]){t=!0;break}}return t},t.prototype.checkTableHasField=function(e){for(var t=!1,i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(t=a instanceof G?this.checkParaHasField(a):this.checkTableHasField(a))break}return t},t.prototype.layoutParagraph=function(e,t,i){if(this.isFieldCode&&!this.checkParaHasField(e))0===e.childWidgets.length&&this.addLineWidget(e),e.isFieldCodeBlock=!0;else{this.addParagraphWidget(this.viewer.clientActiveArea,e);var n=!0;if(this.isFirstElementWithPageBreak(e)||(this.layoutListItems(e,i),n=!1),e.isEmpty()&&!this.checkIsFieldParagraph(e))this.layoutEmptyLineWidget(e,!0);else{var r,o=t<e.childWidgets.length?e.childWidgets[t]:void 0;for(this.isRelayoutOverlap||e.containerWidget instanceof fc||this.layoutFloatElements(e);o instanceof uh;)e!==o.paragraph&&0===o.indexInOwner&&n&&(o.previousLine.isEndsWithColumnBreak?(this.viewer.updateClientAreaForBlock(e,!0),this.layoutListItems(o.paragraph),this.viewer.updateClientAreaForBlock(e,!1)):this.layoutListItems(o.paragraph)),o.isFirstLine()&&_.isNullOrUndefined(this.fieldBegin)&&(_.isNullOrUndefined(e.paragraphFormat)||(r=-j.convertPointToPixel(e.paragraphFormat.firstLineIndent),this.viewer.updateClientWidth(r))),o.marginTop=0,e=(o=this.layoutLine(o,0)).paragraph,o=o.nextLine}this.updateWidgetToPage(this.viewer,e),e.isLayouted=!0,e.isFieldCodeBlock=!1}return e},t.prototype.checkIsFieldParagraph=function(e){if(!_.isNullOrUndefined(e.childWidgets)&&0!==e.childWidgets.length)for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++){var r=i.children[n];if(r instanceof Z&&r.hasFieldEnd)return!0}return!1},t.prototype.clearLineMeasures=function(){this.maxBaseline=0,this.maxTextBaseline=0,this.maxTextHeight=0},t.prototype.layoutFloatElements=function(e){var t=this;e.floatingElements.forEach(function(e){e instanceof hc&&"Inline"!==e.textWrappingStyle&&(t.isRelayoutOverlap||t.layoutShape(e))})},t.prototype.layoutShape=function(e){if(!(e instanceof uc&&e.isHorizontalRule)){"Inline"!==e.textWrappingStyle?(t=this.getFloatingItemPoints(e),e.x=t.x,e.y=t.y,!e.paragraph.isInsideTable&&0!==e.paragraph.indexInOwner&&0<=e.verticalPosition&&Math.round(e.paragraph.y)>=Math.round(e.y)&&this.viewer.clientArea.bottom<=e.y+e.height&&("Line"==e.verticalOrigin||"Paragraph"==e.verticalOrigin)&&"InFrontOfText"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&(this.moveToNextPage(this.viewer,e.line),this.updateShapeBaseLocation(e.line.paragraph)),-1===(t=e.paragraph.bodyWidget).floatingElements.indexOf(e)&&(t.floatingElements.push(e),t.floatingElements.sort(function(e,t){return e.y-t.y})),-1===e.paragraph.floatingElements.indexOf(e)&&e.paragraph.floatingElements.push(e)):0===e.width&&0!==e.widthScale&&(t=j.convertPointToPixel(e.line.paragraph.getContainerWidth()),e.width=t/100*e.widthScale);var t=this.viewer.clientArea,i=this.viewer.clientActiveArea;if(e instanceof uc){var n=e.textFrame.childWidgets;this.viewer.updateClientAreaForTextBoxShape(e,!0);for(var r=0;r<n.length;r++){var o=n[r];this.viewer.updateClientAreaForBlock(o,!0),o instanceof K&&this.clearTableWidget(o,!0,!0),this.layoutBlock(o,0),this.viewer.updateClientAreaForBlock(o,!1)}}this.viewer.clientActiveArea=i,this.viewer.clientArea=t}},t.prototype.moveElementFromNextLine=function(e){var t=e.nextLine;for(t&&!e.paragraph.bodyWidget.sectionFormat.equalWidth&&e.paragraph.bodyWidget.columnIndex!==t.paragraph.bodyWidget.columnIndex&&(t=void 0);t instanceof uh;){if(0<t.children.length){var i=t.children.splice(0,1)[0];e.children.push(i),i.line=e;break}1===t.paragraph.childWidgets.length?t.paragraph.destroy():t.paragraph.childWidgets.splice(t.paragraph.childWidgets.indexOf(t),1),t=e.nextLine}},t.prototype.layoutLine=function(e,t){var i=e.paragraph,n=(0===e.children.length&&this.moveElementFromNextLine(e),e.children[t]),r=!0;if(n instanceof Z&&e.children[e.children.length-1]instanceof Z)for(var r=!1,o=0;o<e.children.length;o++)if(2==e.children[o].fieldType&&null!=e.children[o].nextElement&&!(e.children[o].nextElement instanceof Z)){r=!0;break}this.clearLineMeasures(),e.marginTop=0;for(i.bodyWidget.indexInOwner,e.indexInOwner;n instanceof mh;)if(n.padding.left=0,r?this.layoutElement(n,i):(this.layoutElement(n,i,!0),r=!0),e=n.line,n instanceof X&&(a=n,!_.isNullOrUndefined(a.errorCollection))&&0<a.errorCollection.length&&(a.ischangeDetected=!0),this.isRTLLayout)n=void 0,this.isRTLLayout=!1;else{var s=i.childWidgets.indexOf(n.line);if(0<s&&this.hasFloatingElement)this.hasFloatingElement=!1,0<i.bodyWidget.floatingElements.length&&n instanceof X&&!(i.containerWidget instanceof N)&&(n=i.childWidgets[s].children[0]);else{if(this.hasFloatingElement=!1,!this.is2013Justification||_.isNullOrUndefined(this.nextElementToLayout)||!_.isNullOrUndefined(n.paragraph.containerWidget.containerShape)&&n.paragraph.containerWidget.containerShape===this.nextElementToLayout){if((n=n.nextElement)instanceof X&&0==n.text.indexOf(" ")&&2<n.text.length&&_.isNullOrUndefined(n.nextElement)&&0<n.text.trim().length){n.text=n.text.substring(1,n.text.length),n.isWidthUpdated=!1;var a,s=n.line.children.indexOf(n);if(n.line.children.splice(s,1),(a=new X).text=" ",a.line=n.line,a.characterFormat.copyFormat(n.characterFormat),0<n.revisions.length)for(var l=0;l<n.revisions.length;l++){var d=n.revisions[l],h=(a.revisions.push(d),d.range.indexOf(n));h<0?d.range.push(a):d.range.splice(h,0,a)}n.line.children.splice(s,0,a),n.line.children.splice(s+1,0,n),n=a}}else n=this.nextElementToLayout;this.nextElementToLayout=void 0}}return e},t.prototype.layoutElement=function(e,t,i){if(!(e.isPageBreak&&t.isInHeaderFooter||e instanceof uc&&e.isHorizontalRule)){var n=e.line,r="",o=e.indexInOwner;if(this.viewer.owner.editorModule&&this.viewer.owner.editorHistoryModule&&this.viewer.owner.editorHistoryModule.isRedoing&&!_.isNullOrUndefined(e.paragraph.containerWidget.footNoteReference)&&this.viewer.owner.enableTrackChanges&&0<e.removedIds.length&&this.viewer.owner.editorModule.constructRevisionFromID(e,!0),e instanceof Z)0===e.fieldType&&(-1===this.documentHelper.fields.indexOf(e)&&this.documentHelper.fields.push(e),_.isNullOrUndefined(e.formFieldData)||-1!==this.documentHelper.formFields.indexOf(e)||this.isInsertFormField||this.documentHelper.formFields.push(e)),this.layoutFieldCharacters(e),e.line.isLastLine()&&_.isNullOrUndefined(e.nextNode)&&!this.isFieldCode?(!_.isNullOrUndefined(t.containerWidget)&&0<t.floatingElements.length&&!(t.containerWidget instanceof fc)&&this.isConsiderAsEmptyLineWidget(e.line)&&this.layoutEmptyLineWidget(t,!1,e.line),this.moveToNextLine(n)):_.isNullOrUndefined(e.nextElement)&&0<this.viewer.clientActiveArea.width&&!e.line.isLastLine()?(this.moveElementFromNextLine(n),e.line.isLastLine()&&_.isNullOrUndefined(e.nextNode)&&!this.isFieldCode&&(2!==e.fieldType&&_.isNullOrUndefined(e.fieldSeparator)&&this.layoutEmptyLineWidget(t,!1,e.line),this.moveToNextLine(n))):_.isNullOrUndefined(e.nextElement)&&0===this.viewer.clientActiveArea.width?(this.moveToNextLine(n),n.paragraph.lastChild===n&&!_.isNullOrUndefined(n.nextLine)&&0<=this.viewer.clientActiveArea.height&&this.moveFromNextPage(n)):i&&(i=this.documentHelper.textHelper.getHeight(t.characterFormat),e.height=i.Height);else if(e instanceof Y||this.isFieldCode||e instanceof J||e instanceof Sc||e instanceof Wc||e instanceof E||e instanceof hc&&"Inline"!==e.textWrappingStyle){if(e instanceof J)if(0!==e.bookmarkType||this.documentHelper.bookmarks.containsKey(e.name))if(1===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)){i=this.documentHelper.bookmarks.get(e.name);if((_.isNullOrUndefined(i.reference)||_.isNullOrUndefined(i.reference.paragraph)||_.isNullOrUndefined(i.reference.paragraph.bodyWidget))&&((i.reference=e).reference=i),_.isNullOrUndefined(i.properties))_.isNullOrUndefined(this.documentHelper.selection)||(h=i.reference.paragraph.associatedCell,_.isNullOrUndefined(h))||(h.isRenderBookmarkEnd=!1,this.documentHelper.selection.isRenderBookmarkAtEnd(i.reference)&&(h.isRenderBookmarkEnd=!0));else if(!_.isNullOrUndefined(e.paragraph.associatedCell)){var s=this.documentHelper.selection.getLastParagraph(e.paragraph.associatedCell).lastChild;if(!_.isNullOrUndefined(s))if(s.children[s.children.length-1]==e){for(var i=parseInt(e.reference.properties.columnLast),a=e.paragraph.associatedCell.ownerRow,l=void 0,d=i;_.isNullOrUndefined(l)&&-1<d;)l=a.getCellUsingColumnIndex(a.rowIndex,d),_.isNullOrUndefined(l)&&d--;_.isNullOrUndefined(l)||(a.isRenderBookmarkEnd=!0)}}}else 0===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)&&(_.isNullOrUndefined(e.reference)&&this.documentHelper.bookmarks.remove(e.name),_.isNullOrUndefined(e.properties)||(v=parseInt(e.properties.columnFirst),e.paragraph.isInsideTable&&(h=(w=e.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(w.rowIndex,v),_.isNullOrUndefined(h)||(h.isRenderBookmarkStart=!0))));else this.documentHelper.bookmarks.add(e.name,e),_.isNullOrUndefined(e.properties)||(v=parseInt(e.properties.columnFirst),e.paragraph.isInsideTable&&(h=(w=e.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(w.rowIndex,v),_.isNullOrUndefined(h)||(h.isRenderBookmarkStart=!0)));if(e instanceof Wc||e instanceof Sc)if(e instanceof Wc&&(this.documentHelper.owner.currentUser===e.user||"Everyone"===e.group&&""===e.user))-1!=e.columnFirst&&-1!=e.columnLast&&(h=(w=e.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(w.rowIndex,e.columnFirst),_.isNullOrUndefined(h)||(h.isRenderEditRangeStart=!0,w.editRangeID.add(e.editRangeId,e)));else if(e instanceof Sc&&(this.documentHelper.owner.currentUser===e.editRangeStart.user||"Everyone"===e.editRangeStart.group&&""===e.editRangeStart.user))if(-1!=e.editRangeStart.columnFirst&&-1!=e.editRangeStart.columnLast)if((w=e.paragraph.associatedCell.ownerRow).editRangeID.containsKey(e.editRangeStart.editRangeId)){var h=w.getCellUsingColumnIndex(w.rowIndex,e.editRangeStart.columnFirst);_.isNullOrUndefined(h)||h.isRenderEditRangeStart&&(h.isRenderEditRangeEnd=!0)}else for(var c=e.paragraph.associatedCell.ownerTable,p=w.rowIndex-1;0<=p;p--){var u=c.childWidgets[p];if(u.editRangeID.containsKey(e.editRangeStart.editRangeId)){u=u.getCellUsingColumnIndex(u.rowIndex,e.editRangeStart.columnFirst);if(!_.isNullOrUndefined(u)&&u.isRenderEditRangeStart){u.isRenderEditRangeEnd=!0;break}}}if(e instanceof hc&&"Inline"!==e.textWrappingStyle&&-1==t.floatingElements.indexOf(e)&&e instanceof uc&&(-1===t.floatingElements.indexOf(e)&&t.floatingElements.push(e),-1===t.bodyWidget.floatingElements.indexOf(e))&&t.bodyWidget.floatingElements.push(e),e instanceof E&&-1===this.documentHelper.contentControlCollection.indexOf(e))if(0===e.type)this.documentHelper.contentControlCollection.push(e);else if(1===e.type)for(var g=e.paragraph.bodyWidget.page,p=0;p<this.documentHelper.contentControlCollection.length;p++){var m=this.documentHelper.contentControlCollection[p],f=m.line.paragraph.isInHeaderFooter;(!f||e.contentControlProperties!==m.contentControlProperties||g!==m.line.paragraph.bodyWidget.page)&&(f||e.contentControlProperties!==m.contentControlProperties)||((e.reference=m).reference=e)}_.isNullOrUndefined(e.nextElement)&&0<this.viewer.clientActiveArea.width&&!e.line.isLastLine()&&this.moveElementFromNextLine(n),e.line.isLastLine()&&_.isNullOrUndefined(e.nextElement)&&((!this.hasValidElement(n.paragraph)||t.isContainsShapeAlone())&&(this.isInitialLoad||this.hasValidElement(n.paragraph)||!n.paragraph.paragraphFormat.bidi||-1===n.paragraph.paragraphFormat.listFormat.listId)?this.layoutEmptyLineWidget(n.paragraph,!1,n,!1):this.moveToNextLine(n))}else{e instanceof X&&"NoColor"!=e.characterFormat.highlightColor&&""!=e.text.trim()&&e.text!=e.text.trim()&&(i=t.firstChild,s=t.lastChild,!_.isNullOrUndefined(i)&&i instanceof uh&&0<i.children.length&&e===i.children[0]&&j.splitSpaceInTextElementBox(e,!0),!_.isNullOrUndefined(s))&&s instanceof uh&&0<s.children.length&&e===s.children[s.children.length-1]&&j.splitSpaceInTextElementBox(e,!1);var y,v=e.width,h=(e instanceof Vh&&!this.isTocField(e.fieldBegin)?""!==(r=this.documentHelper.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page))?e.text=r:r=e.text:e instanceof Bh?""!==(r=this.startAt(e,r))&&(e.text=r):e instanceof X&&(!_.isNullOrUndefined(e.paragraph.containerWidget.footNoteReference)&&e.line.isFirstLine()&&0===e.paragraph.index&&0===e.indexInOwner&&!this.documentHelper.owner.editorModule.handledEnter&&e instanceof Op&&(e.text=e.paragraph.containerWidget.footNoteReference.text),this.checkAndSplitTabOrLineBreakCharacter(e.text,e),r=e.text),e instanceof X&&(!e.isWidthUpdated||0===e.width||this.isInitialLoad||this.viewer.owner.editorModule&&this.viewer.owner.editorModule.isMeasureParaWidth?(v=this.documentHelper.textHelper.getTextSize(e,e.characterFormat),e.isWidthUpdated=!0):v=e.trimEndWidth,"\t"===e.text?(v=this.getTabWidth(t,this.viewer,o,n,e),e.width=v):e.text!==String.fromCharCode(31)&&e.text!==String.fromCharCode(14)||(e.width=v=0)),_.isNullOrUndefined(t.containerWidget)||!(0<t.bodyWidget.floatingElements.length)||e instanceof uc&&"Inline"==e.textWrappingStyle||t.containerWidget instanceof fc&&!(e instanceof up)||t.containerWidget instanceof N&&t.containerWidget.ownerTable.containerWidget instanceof fc||this.adjustPosition(e,e.line.paragraph.bodyWidget),n.isFirstLine()&&0===e.indexInOwner?this.getBeforeSpacing(t):0);if(this.viewer instanceof Sd&&(e instanceof uc&&"Inline"===e.textWrappingStyle||!(e instanceof uc))&&this.viewer.clientActiveArea.height<h+e.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(!(e instanceof X&&("\f"!==e.text&&e.text!==String.fromCharCode(14)||"\f"===e.text&&t.isPageBreak()&&"Word2013"===this.documentHelper.compatibilityMode))&&e instanceof X||this.moveToNextPage(this.viewer,n),e instanceof Vh&&this.updateFieldText(e),!e.previousElement||!(e.previousElement instanceof uc&&"Inline"===e.previousElement.textWrappingStyle)&&e.previousElement instanceof uc||this.cutClientWidth(e.previousElement)),e instanceof uc&&"Inline"===e.textWrappingStyle&&(-1===t.floatingElements.indexOf(e)&&t.floatingElements.push(e),e.width>this.viewer.clientActiveArea.width&&(this.splitElementForClientArea(t,e),this.checkLineWidgetWithClientArea(n,e)),w=this.is2013Justification,this.layoutShape(e),this.is2013Justification=w),e instanceof Bh&&(!e.isLayout||this.isLayoutWhole)&&"Pages"===this.documentHelper.owner.layoutType&&this.layoutFootEndNoteElement(e),e instanceof Bh&&(this.isfootMove&&(this.moveToNextPage(this.viewer,e.line),!e.previousElement||!(e.previousElement instanceof uc&&"Inline"===e.previousElement.textWrappingStyle)&&e.previousElement instanceof uc||this.cutClientWidth(e.previousElement),this.isfootMove=!1),t.paragraphFormat.keepWithNext)&&t.paragraphFormat.keepLinesTogether&&e.isLayout&&!this.isLayoutWhole&&!_.isNullOrUndefined(t.bodyWidget.page.footnoteWidget)&&0!==t.bodyWidget.page.footnoteWidget.y&&t.bodyWidget.page.footnoteWidget.y<this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height&&(i=this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height-t.bodyWidget.page.footnoteWidget.y,this.viewer.clientActiveArea.height-=i),parseFloat(v.toFixed(4))<=parseFloat(this.viewer.clientActiveArea.width.toFixed(4))||!this.viewer.textWrap)this.addElementToLine(t,e),_.isNullOrUndefined(e.nextElement)&&!e.line.isLastLine()&&(s=e.line.nextLine.children[0])instanceof X&&0==s.text.indexOf(" ")&&this.moveElementFromNextLine(n),_.isNullOrUndefined(e.nextElement)&&0<this.viewer.clientActiveArea.width&&!e.line.isLastLine()?this.moveElementFromNextLine(n):!e.line.isLastLine()&&_.isNullOrUndefined(e.nextElement)&&0===this.viewer.clientActiveArea.width&&(this.moveToNextLine(n),n.paragraph.lastChild===n)&&0<=this.viewer.clientActiveArea.height&&this.moveFromNextPage(n);else if(e instanceof X){if("\t"===e.text){var h=e.line,w=!1;if(0!==e.indexInOwner&&e instanceof _h?(w=!0,this.addSplittedLineWidget(h,h.children.indexOf(e)-1)):(this.isWrapText&&this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width===this.viewer.clientActiveArea.right&&(this.isWrapText=!1),this.addSplittedLineWidget(h,h.children.indexOf(e))),this.moveToNextLine(h),0<h.paragraph.bodyWidget.floatingElements.length&&w)return this.nextElementToLayout=e,void(this.hasFloatingElement=!0);e.width=this.getTabWidth(t,this.viewer,o,e.line,e),w&&(this.addElementToLine(t,e),_.isNullOrUndefined(e.nextElement))&&0<this.viewer.clientActiveArea.width&&!e.line.isLastLine()&&this.moveElementFromNextLine(e.line)}else do{if(n=e.line,e.previousElement instanceof Z&&2==e.previousElement.fieldType&&!_.isNullOrUndefined(e.previousElement.fieldBeginInternal)&&e.previousElement.fieldBeginInternal.formFieldData instanceof Sh||this.splitTextForClientArea(n,e,e.text,e.trimEndWidth,e.characterFormat),this.checkLineWidgetWithClientArea(n,e),e instanceof Vh&&!this.isInitialLoad&&this.updateFieldText(e),e.line!==n&&!_.isNullOrUndefined(this.nextElementToLayout)&&this.is2013Justification)return}while(e.line!==n&&this.cutClientWidth(e))}else for(;n=e.line,this.splitElementForClientArea(t,e),this.checkLineWidgetWithClientArea(n,e),e instanceof Vh&&this.updateFieldText(e),e.line!==n&&this.cutClientWidth(e,!0););if(!_.isNullOrUndefined(e.nextNode)&&e.nextNode instanceof E&&(y=e.nextNode),"\v"!==r&&"\f"!==r&&"\r"!==r&&r!==String.fromCharCode(14)||y||-1<(i=n.children.indexOf(e))&&this.addSplittedLineWidget(n,i),e.line.isLastLine()&&_.isNullOrUndefined(e.nextElement)||"\v"===r||"\f"===r||"\r"===r||r===String.fromCharCode(14)){if(this.isXPositionUpdated)return void(this.isXPositionUpdated=!1);this.moveToNextLine(e.line),"\v"===r&&_.isNullOrUndefined(e.nextNode)?this.layoutEmptyLineWidget(t,!0,n,!0):"\f"!==r&&r!==String.fromCharCode(14)||!(this.viewer instanceof Sd)||e.line.paragraph.containerWidget instanceof N||(v=this.isRTLLayout,this.isRTLLayout=!1,_.isNullOrUndefined(e.nextNode)||e.nextNode instanceof E?r===String.fromCharCode(14)?(this.moveToNextPage(this.viewer,e.line.nextLine,!1),this.layoutEmptyLineWidget(e.line.nextLine.paragraph,!1,e.line.nextLine,!0)):this.moveToNextPage(this.viewer,e.line,!0):_.isNullOrUndefined(e.line.nextLine)||this.moveToNextPage(this.viewer,e.line.nextLine,!1),this.isRTLLayout=v)}this.isXPositionUpdated=!1}}},t.prototype.adjustPosition=function(e,t){var i=this.viewer.clientActiveArea,n=this.viewer.clientActiveArea.x,r=this.viewer.clientActiveArea.y,o=this.viewer.clientActiveArea.width,i=this.adjustClientAreaBasedOnTextWrap(e,new Rd(i.x,i.y,i.width,i.height)),i=(this.viewer.clientActiveArea.width=i.width,this.viewer.clientActiveArea.x-n);e.line.isFirstLine()&&this.getFirstElement(e.line)===e&&0<i&&!this.isSkipFirstLineIndent&&(n=e.line.paragraph.paragraphFormat.firstLineIndent,i+=j.convertPointToPixel(0<n?n:0)),this.isSkipFirstLineIndent=!1,e.padding.left=0<i?i:0,o!==this.viewer.clientActiveArea.width&&(n=new al(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.width),this.updateWrapPosition(n)),0===this.viewer.clientActiveArea.width&&(this.isWrapText=!1),this.isYPositionUpdated&&(e.line.isFirstLine()?(_.isNullOrUndefined(e.line.paragraph.associatedCell)||(i=e.line.paragraph.previousRenderedWidget,_.isNullOrUndefined(i)?e.line.paragraph.associatedCell.height+=this.viewer.clientActiveArea.y-r:e.line.paragraph.associatedCell.height+=this.viewer.clientActiveArea.y-i.y+i.height),e.line.paragraph.y=this.viewer.clientActiveArea.y):e.line.children[0]===e&&(e.line.marginTop+=this.viewer.clientActiveArea.y-r),e.line.paragraph.containerWidget instanceof Xd&&(e.line.paragraph.containerWidget.height+=this.viewer.clientActiveArea.y-r),e instanceof Y||(this.isYPositionUpdated=!1))},t.prototype.getFirstElement=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(!(i instanceof hc&&"Inline"!==i.textWrappingStyle))return i}},t.prototype.updateWrapPosition=function(e){for(var t=0;t<this.wrapPosition.length;t++){var i=this.wrapPosition[t];if(!(1<Math.abs(i.right-e.right)))return}this.wrapPosition.push(e)},t.prototype.isFirstitemInPage=function(e,t){return!e.line.paragraph.isInHeaderFooter&&Math.round(t)===this.viewer.clientArea.y},t.prototype.isTextFitBelow=function(e,t,i){return!1},t.prototype.isNeedToWrapForTopAndBottom=function(e,t,i,n,r,o,s,a,l,d,h,c,p){if(e.isInsideTable&&"TopAndBottom"===r&&!(l instanceof K)){var u=l.paragraph;if(!_.isNullOrUndefined(u)&&!_.isNullOrUndefined(u.associatedCell)){var g=u.isInsideTable,u=u.associatedCell,e=e.associatedCell;if(!_.isNullOrUndefined(u)&&!_.isNullOrUndefined(e)&&u!==e||!g&&"Word2013"!==this.documentHelper.compatibilityMode)return!1}}return i!==a&&n!==a&&"TopAndBottom"===r&&(h.y>=o.y&&h.y<o.bottom||(h.y+p>o.y||this.isTextFitBelow(o,h.y+p,l))&&h.y+p<o.bottom||h.y<o.y&&h.y+p>o.bottom&&0<o.height)&&!(s&&(d||t instanceof Ic&&"Inline"!==t.textWrappingStyle&&t.allowOverlap))},t.prototype.isNeedToWrapForSquareTightAndThrough=function(e,t,i,n,r,o,s,a,l,d,h,c,p){return 0<e.floatingElements.length&&i!==a&&n!==a&&"Inline"!==r&&"Behind"!==r&&"TopAndBottom"!==r&&"InFrontOfText"!==r&&(Math.round(h.y+p)>Math.round(o.y)||this.isTextFitBelow(o,h.y+p,l))&&Math.round(h.y)<Math.round(o.y+o.height)&&!(s&&(d||t instanceof Ic&&"Inline"!==t.textWrappingStyle&&t.allowOverlap))},t.prototype.isNeedToWrapForSquareTightAndThroughForTable=function(e,t,i,n,r,o,s,a,l,d,h,c,p){return 0<e.floatingElements.length&&i!==a&&n!==a&&"Inline"!==r&&"Behind"!==r&&"TopAndBottom"!==r&&"InFrontOfText"!==r&&(Math.round(h.y+p)>=Math.round(o.y)&&Math.round(h.y)<Math.round(o.bottom)||Math.round(h.y+p)<=Math.round(o.bottom)&&Math.round(h.y+p)>=Math.round(o.y))&&!(s&&d)},t.prototype.isNeedToWrapLeafWidget=function(e,t){return 0<e.bodyWidget.floatingElements.length&&!(t instanceof hc&&("InFrontOfText"===t.textWrappingStyle||"Behind"===t.textWrappingStyle))},t.prototype.getMinWidth=function(e,t,i,n){var r=e.text,o=r.split(" "),r=(""!==r&&""===r.trim()&&e&&e.line.paragraph&&e.previousNode&&e.nextNode&&e.line.paragraph.isEmpty&&(o=[""]),this.documentHelper.textHelper.measureText(o[0],e.characterFormat,e.scriptType).Width),e=this.getNextSibling(e);return 1===o.length&&e&&(o=e.text,r+=this.getNextTextRangeWidth(e,o,t,i,n)),r},t.prototype.getNextTextRangeWidth=function(e,t,i,n,r){for(var o=e,s=new Rd(0,0,0,0),a=this.isNextSibligSizeNeedToBeMeasure(s,e,r,i,n);a&&this.isLeafWidgetNextSiblingIsTextRange(o)&&i+s.width<r.width&&(o=this.getNextSibling(o),this.isNextSibligSizeNeedToBeMeasure(s,o,r,i,n));)o.text;return s.width},t.prototype.isLeafWidgetNextSiblingIsTextRange=function(e){e=this.getNextSibling(e);return!!(e&&e instanceof X)},t.prototype.isNextSibligSizeNeedToBeMeasure=function(e,t,i,n,r){var o,s=null;if(t){if(-1!==(s=t.text).indexOf(" ")||-1!==s.indexOf("-")||-1!==s.indexOf("_")&&n+e.width+this.documentHelper.textHelper.measureText(s.split("-")[0],t.characterFormat,t.scriptType).Width<i.width||"\t"===t.text)return o=t.width,s!==s.split(" ")[0]&&(o=this.documentHelper.textHelper.measureText(s.split(" ")[0],t.characterFormat,t.scriptType).Width),n+e.width+o>i.width&&s.indexOf("-")&&s!==s.split("-")[0]+"-"&&(o=this.documentHelper.textHelper.measureText(s.split("-")[0]+"-",t.characterFormat,t.scriptType).Width),e.width+=o,!1;0<t.text.length&&(n=this.documentHelper.textHelper.measureText(t.text,t.characterFormat,t.scriptType),e.height+=n.Height,e.width+=n.Width)}return!0},t.prototype.isNeedDoIntermediateWrapping=function(e,t,i,n,r,o,s,a,l){return l<e&&((Math.round(i.width)<=Math.round(a)||i.width<n&&s.paragraph.isInsideTable)&&"Left"!==t&&"Largest"!==t||"Right"===t||i.width<e&&"Largest"===t)||(Math.round(o.x-r.x+r.leftIndent)<l||s instanceof X&&this.isFloatingItemOnLeft(i,a,o))&&("Left"!==t||e<l)},t.prototype.isFloatingItemOnLeft=function(e,t,i){return!1},t.prototype.getNextSibling=function(e){for(var t=e.nextNode,i=!1;t;){if(t instanceof Z||t instanceof J||i||t instanceof Y)t instanceof Z&&(0===t.fieldType?i=!0:2===t.fieldType&&(i=!1));else if(t instanceof X)break;t=t.nextNode}return t},t.prototype.adjustClientAreaBasedOnTextWrap=function(e,t){var i=e.line.paragraph,n=i.bodyWidget,r=this.viewer,o=t.y;this.isFirstitemInPage(e,o),_.isNullOrUndefined(i.previousWidget);if(this.isNeedToWrapLeafWidget(i,e)){var s=r.clientArea;n.floatingElements.sort(function(e,t){return e.y-t.y}),n.floatingElements.sort(function(e,t){return e.x-t.x});for(var a=0;a<n.floatingElements.length;a++){var l,d,h,c,p,u,g,m,f,y,v,w,b,x,C,I,k,F,P,T,S=n.floatingElements[a],H=!1,H=(S instanceof hc?S:S.positioning).allowOverlap;i.isInsideTable&&S instanceof K&&!S.isInsideTable||this.isRelayout&&!this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(S instanceof K?S:S.line.paragraph,e.line.paragraph)||this.isRelayout&&this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(S instanceof K?S:S.line.paragraph,this.endOverlapWidget)||(S.x,l=p=h=c=d=0,S instanceof hc?(d=S.distanceLeft,c=S.distanceTop,h=S.distanceRight,p=S.distanceBottom,l=S.width):(l=S.getTableCellWidth(),d=S.positioning.distanceLeft,c=S.positioning.distanceTop,h=S.positioning.distanceRight,p=S.positioning.distanceBottom),l=new Rd(S.x-d,S.y-c,l+d+h,S.height+c+p),d=S instanceof K?"Square":S.textWrappingStyle,h=S instanceof K?"Both":S.textWrappingType,r.clientArea.y,S.height,s.x>l.right+(c=24))||s.right<l.x-c||(this.isNeedToWrapForSquareTightAndThrough(n,e,-1,-1,d,l,H,1,S,!1,t,e.width,e.height)?(T=u=p=0,g=j.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent),I=j.convertPointToPixel(i.paragraphFormat.leftIndent),v=j.convertPointToPixel(i.paragraphFormat.rightIndent),g=0===e.indexInOwner&&e.line.isFirstLine()&&0<g?g:0,m=e instanceof X||e instanceof Y?e:null,f=(S instanceof K?S:S.line.paragraph).containerWidget,F=!1,e.line.paragraph&&(t.x>=l.x&&"Left"!==h&&(p=v),t.x<l.x&&"Right"!==h&&(u=I),v=i.paragraphFormat.listFormat,y=this.getListLevel(v.list,v.listLevelNumber),t.x===s.x+I)&&v&&v.baseStyle&&y&&0!==y.paragraphFormat.leftIndent&&(T=I,F=!0),v=!1,w=void(y=0),b=void(C=0),S instanceof K&&(b=(w=S).positioning.horizontalAlignment,y=this.getMaximumRightCellBorderWidth(S),v=this.getDefaultBorderSpacingValue(y,v,b),C=S.tableFormat.borders.left.lineWidth/2),t.x+C>=l.x&&t.x<l.right&&"Left"!==h?(t.width=t.width-(l.right-t.x)-p,this.isWrapText=!0,_.isNullOrUndefined(w)||(c=this.getMinimumWidthRequiredForTable(v,b,y)),Math.round(t.width)<c||t.width<e.width&&"\t"===e.text||l.x<i.x+I?(t.width=this.viewer.clientArea.right-l.right-(F?T:0),k=0,k=_.isNullOrUndefined(m)?e.width:this.getMinWidth(e,e.width,e.height,t),Math.round(t.width)<c||t.width<k?(l.x-(i.x+i.leftIndent)>c&&this.viewer.clientArea.right-l.right>c?t.width=0:(this.isYPositionUpdated=!(P=0),t.width=this.viewer.clientArea.width,t.height-=l.bottom+P-t.y,t.y=l.bottom+P),this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1):(x=t.x,t.x=l.right+(F?T:0)+g,t.width-=g,this.isSkipFirstLineIndent=!0,"Square"===d&&t.width<0&&0<e.width&&(this.isYPositionUpdated=!(P=0),t.width=this.viewer.clientArea.width,t.height-=l.bottom+P-t.y,t.y=l.bottom+P,t.x=x),this.viewer.updateClientAreaForTextWrap(t))):(x=t.x,t.x=l.right+(F?T:0)+g,t.width=this.viewer.clientArea.right-l.right-(F?T:0)-g,this.isSkipFirstLineIndent=!0,"Square"===d&&t.width<0&&0<e.width&&(this.isYPositionUpdated=!(P=0),t.width=this.viewer.clientArea.width,t.height-=l.bottom+P-t.y,t.y=l.bottom+P,t.x=x),this.isWrapText=!0,this.viewer.updateClientAreaForTextWrap(t))):l.x>=t.x&&t.right>l.x&&(t.width=l.x-t.x-p,C=0<(C=this.viewer.clientArea.right-l.right)?C:0,I=!(this.isWrapText=!0),k=0,k=_.isNullOrUndefined(m)?e.width:this.getMinWidth(m,e.width,e.height,t),_.isNullOrUndefined(w)||(c=this.getMinimumWidthRequiredForTable(v,b,y)),this.isNeedDoIntermediateWrapping(C,h,t,e.width,e.paragraph,l,e,k,c)?(t.width=C,this.isWrapText=!0,(t.x+k>l.x||"Right"===h||s.x>l.x-24)&&(t.x=l.right,t.width>k||"Right"===h?this.viewer.updateClientAreaForTextWrap(t):t.width<k&&e.line.children[0]!==e&&"Both"===h&&S instanceof hc&&(this.viewer.updateClientAreaForTextWrap(t),I=!0)),(t.width<c&&!(k<C&&"Tight"===d)||t.width<k&&Math.round(t.right)===Math.round(this.viewer.clientArea.right)&&"Both"===h)&&(F=l,Math.round(t.x)===Math.round(n.sectionFormat.leftMargin+i.paragraphFormat.leftIndent)?(t.y=F.bottom+(P=0),this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height=t.height-(F.height+P),this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1):!I&&Math.round(t.right)>=Math.round(this.viewer.clientArea.right)&&"Both"===h?(t.y=F.bottom+(P=0),t.width=this.viewer.clientArea.width,t.height=t.height-(F.height+P),t.x=this.viewer.clientArea.x+u,this.viewer.updateClientAreaForTextWrap(t),this.isYPositionUpdated=!0,this.isWrapText=!1):(t.width=0,this.viewer.updateClientAreaForTextWrap(t)))):((e.line.isFirstLine()&&0===e.indexInOwner||0==C&&e.line.children[0]===e)&&"Square"===d&&Math.round(t.width)<=Math.round(k)&&i.containerWidget===f?(t.x=s.x,t.y=l.bottom,t.width=s.width,t.height-=l.bottom-t.y,this.isYPositionUpdated=!0):Math.round(t.width)<=Math.round(k)&&Math.round(t.x-u)!==Math.round(this.viewer.clientArea.x)&&(t.width=0),this.viewer.updateClientAreaForTextWrap(t))),"Both"!==h&&(this.isWrapText=!1)):this.isNeedToWrapForTopAndBottom(i,e,-1,-1,d,l,H,1,S,!1,t,e.width,e.height)&&(T=t.y,t.y=l.bottom+(P=0),this.isYPositionUpdated=!0,t.height=t.height-(l.bottom-T+P),t.y!==o&&e instanceof X&&!(S instanceof K)&&e.line.isFirstLine()&&(t.y+=e.margin.top,o=t.y),this.viewer.updateClientAreaForTextWrap(t)))}}return t},t.prototype.adjustClientAreaBasedOnTextWrapForTable=function(e,t){if(!_.isNullOrUndefined(e.containerWidget)&&!_.isNullOrUndefined(e.bodyWidget)){var i=e.bodyWidget,n=this.viewer;t.y,_.isNullOrUndefined(e.previousWidget);if(0<i.floatingElements.length){var r=n.clientActiveArea;i.floatingElements.sort(function(e,t){return e.y-t.y}),i.floatingElements.sort(function(e,t){return e.x-t.x});for(var o=0;o<i.floatingElements.length;o++){var s,a,l,d,h,c,p,u,g=i.floatingElements[o],m=!1,m=(g instanceof hc?g:g.positioning).allowOverlap;e.isInsideTable&&g instanceof K&&!g.isInsideTable||g instanceof K&&g.wrapTextAround&&g.positioning.allowOverlap&&e.wrapTextAround&&e.positioning.allowOverlap||(s=e.getTableCellWidth(),l=((a=g instanceof hc)?g:g.positioning).distanceLeft,h=(a?g:g.positioning).distanceTop,d=(a?g:g.positioning).distanceRight,c=(a?g:g.positioning).distanceBottom,a=a?g.width:g.getTableCellWidth(),a=new Rd(g.x-l,g.y-h,a+l+d,g.height+h+c),l=g instanceof K?"Square":g.textWrappingStyle,d=g instanceof K?"Both":g.textWrappingType,h=0<e.childWidgets.length?e.childWidgets[0].rowFormat.height:0,c=this.getNestedTable(e).firstChild.firstChild.firstChild.characterFormat,h<(c=this.documentHelper.textHelper.measureText(" ",c)).Height&&(h=c.Height),r.x>a.right+24)||r.right<a.x-24||this.isNeedToWrapForSquareTightAndThroughForTable(i,e,-1,-1,l,a,m,1,g,!1,t,s,h)&&t.x>=a.x&&t.x<a.right&&"Left"!==d&&(t.width=t.width-(a.right-t.x),this.isWrapText=!0,Math.round(t.width)<24||t.width<s||a.x<e.x?(t.width=this.viewer.clientArea.right-a.right,c=s,Math.round(t.width)<24||t.width<c?(24<a.x-e.x&&24<this.viewer.clientArea.right-a.right?t.width=0:(this.isYPositionUpdated=!(u=0),t.width=this.viewer.clientArea.width,t.height-=a.bottom+u-t.y,t.y=a.bottom+u),this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1):(p=t.x,t.x=a.right,"Square"===l&&t.width<0&&0<s&&(this.isYPositionUpdated=!0,t.height-=a.bottom+0-t.y,t.width=this.viewer.clientArea.width,t.y=a.bottom+0,t.x=p),this.viewer.updateClientAreaForTextWrap(t))):(p=t.x,t.x=a.right+e.firstChild.firstChild.leftMargin,t.width=this.viewer.clientArea.right-a.right,"Square"===l&&t.width<0&&0<s&&(this.isYPositionUpdated=!(u=0),t.width=this.viewer.clientArea.width,t.height-=a.bottom+u-t.y,t.y=a.bottom+u,t.x=p),this.viewer.updateClientAreaForTextWrap(t)))}}}return t},t.prototype.getNestedTable=function(e){for(var t=e;t.firstChild.firstChild.firstChild instanceof K;)t=t.firstChild.firstChild.firstChild;return t},t.prototype.startAt=function(e,t){return"Footnote"===e.footnoteType?(this.startat=e.paragraph.bodyWidget.sectionFormat.initialFootNoteNumber,this.getFootEndNote(e.paragraph.bodyWidget.sectionFormat.footNoteNumberFormat,this.documentHelper.footnoteCollection.indexOf(e)+this.startat)):(this.startat=e.paragraph.bodyWidget.sectionFormat.initialEndNoteNumber,this.getFootEndNote(e.paragraph.bodyWidget.sectionFormat.endnoteNumberFormat,this.documentHelper.endnoteCollection.indexOf(e)+this.startat))},t.prototype.layoutFootEndNoteElement=function(e){var t,i=!(this.isFootnoteContentChanged=!0),n=this.documentHelper.footnoteCollection.indexOf(e),r=1,o=(this.islayoutFootnote=!0,new Rd(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height)),s=new Rd(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height),a=e.paragraph.bodyWidget,l=!1,d=0;if(a.page.footnoteWidget)for(var h=0;h<a.page.footnoteWidget.bodyWidgets.length;h++){var r=a.page.footnoteWidget.bodyWidgets.length,c=this.documentHelper.footnoteCollection.indexOf(a.page.footnoteWidget.bodyWidgets[h].footNoteReference);if(n<c&&c-n==1){r=h,i=!0;break}}if(e.isLayout=!0,"Footnote"===e.footnoteType){a.page.footnoteWidget&&a.page.footnoteWidget instanceof q?t=a.page.footnoteWidget:(l=!0,(t=new q).footNoteType="Footnote",t.page=a.page,(g=new G).characterFormat=new B,g.paragraphFormat=new Xa,g.index=0,p=new uh(g),g.childWidgets.push(p),d=this.documentHelper.textHelper.getParagraphMarkSize(g.characterFormat).Height,t.margin=new Dd(0,d,0,0)),this.isFootNoteLayoutStart=!0,l&&(a.page.footnoteWidget=t);var p,u=e.bodyWidget;this.viewer.updateClientArea(t,t.page),this.viewer.clientArea.y=o.y,this.viewer.clientActiveArea.y=s.y;for(var g,m=0;m<e.bodyWidget.childWidgets.length;m++){var f=e.bodyWidget.childWidgets[m];(f.containerWidget=u).page=a.page,u.sectionFormat=t.sectionFormat,f.containerWidget.containerWidget=t,this.viewer.updateClientAreaForBlock(f,!0),f instanceof K&&this.clearTableWidget(f,!0,!0),this.layoutBlock(f,0),d+=f.height,f.y=0,this.viewer.updateClientAreaForBlock(f,!1),u.height+=f.height}1<t.sectionFormat.columns.length&&!(0===t.bodyWidgets.length&&u.childWidgets.length<=1&&u.childWidgets[0].childWidgets.length<=1)&&(d/=t.sectionFormat.numberOfColumns),p=this.isFootNoteLayoutStart=!1,d>=s.height&&(this.isfootMove=!0),i?t.bodyWidgets.splice(r,0,u):t.bodyWidgets.push(u),e.line.paragraph.isInsideTable&&(g=this.getParentTable(e.line.paragraph.associatedCell.ownerTable),_.isNullOrUndefined(g.footnoteElement)&&(g.footnoteElement=[]),-1==g.footnoteElement.indexOf(e))&&(g.footnoteElement.push(e),this.layoutedFootnoteElement.push(e)),t.height+=d,p=!0,this.viewer.clientActiveArea=s,this.viewer.clientActiveArea.height-=d,this.footnoteHeight+=d,this.viewer.clientArea=o}return p},t.prototype.layoutEndNoteElement=function(){var e=this.documentHelper.pages.length;if(0<this.documentHelper.endnoteCollection.length){var t,i=void 0,n=void 0,e=this.documentHelper.pages[e-1],r=e.bodyWidgets[0],e=e.bodyWidgets[e.bodyWidgets.length-1];this.viewer instanceof Sd&&1<e.sectionFormat.numberOfColumns&&(e=this.getBodyWidget(e,!0),this.splitBodyWidgetBasedOnColumn(e));for(var o=0;o<this.documentHelper.endnoteCollection.length;o++){t=this.documentHelper.endnoteCollection[o],r.page.endnoteWidget instanceof q&&"Endnote"===r.page.endnoteWidget.footNoteType?i=r.page.endnoteWidget:(n=!0,(i=new q).footNoteType="Endnote",i.page=r.page);var s=t.bodyWidget;s.page=i.page;for(var a=0;a<t.bodyWidget.childWidgets.length;a++){var l=t.bodyWidget.childWidgets[a];l.containerWidget=s,l.containerWidget.containerWidget=i}-1===i.bodyWidgets.indexOf(s)&&(s.index=i.bodyWidgets.length,i.bodyWidgets.push(s),s.sectionFormat=i.page.bodyWidgets[i.page.bodyWidgets.length-1].sectionFormat),n&&(r.page.endnoteWidget=i)}this.layoutfootNote(i)}},t.prototype.hasValidElement=function(e){var t=e.firstChild;if(t&&!_.isNullOrUndefined(this.documentHelper.selection))for(var i=t.children[0];i;){if(i instanceof Z&&(i=this.documentHelper.selection.getNextValidElementForField(i),!_.isNullOrUndefined(i))&&!i.line.paragraph.equals(e))return!1;if(i instanceof X||i instanceof Ic)return!0;_.isNullOrUndefined(i)||(i=i.nextNode)}return!1},t.prototype.isConsiderAsEmptyLineWidget=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(!(i instanceof hc&&"Inline"!==i.textWrappingStyle)&&0<i.width)return!1}return!0},t.prototype.updateFieldText=function(e){var t=this.documentHelper.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page);""!==t&&(e.text=t,this.documentHelper.textHelper.getTextSize(e,e.characterFormat))},t.prototype.checkLineWidgetWithClientArea=function(e,t){var i;(e!==t.line||t.line===e&&_.isNullOrUndefined(t.nextElement)&&!t.line.isLastLine())&&(this.moveToNextLine(e),"Word2013"!==this.documentHelper.compatibilityMode&&this.isOverlapFloatTable&&(i=void 0,t.line.paragraph.previousRenderedWidget instanceof K&&t.line.paragraph.previousRenderedWidget.wrapTextAround&&(i=t.line.paragraph.previousRenderedWidget,this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-j.convertPointToPixel(i.firstChild.firstChild.leftMargin)),this.viewer.clientActiveArea.x+=e.paragraph.leftIndent,this.isOverlapFloatTable=!1),e!==t.line)&&(this.isRTLLayout=!1),t.line!==e&&this.viewer instanceof Sd&&this.viewer.clientActiveArea.height<t.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?this.moveToNextPage(this.viewer,t.line):t.line===e&&_.isNullOrUndefined(t.nextElement)&&e.paragraph.lastChild===e&&!e.isLastLine()&&0<=this.viewer.clientActiveArea.height&&this.moveFromNextPage(e)},t.prototype.checkAndSplitTabOrLineBreakCharacter=function(e,t){var i,n=j.indexOfAny(e,["\t","\v","\f"]);-1<n&&("\t"===(i=e[n])&&"\t"!==e||"\v"===i&&"\v"!==e||"\f"===i&&"\f"!==e)&&this.splitByLineBreakOrTab(this.viewer,t,n,i)},t.prototype.moveFromNextPage=function(e){var t,i=e.nextLine;i&&-1===e.paragraph.childWidgets.indexOf(i)&&(t=i.paragraph,i.paragraph.childWidgets.splice(i.indexInOwner,1),e.paragraph.childWidgets.push(i),i.paragraph=e.paragraph,0===t.childWidgets.length)&&t.destroy()},t.prototype.cutClientWidth=function(e,t){if(this.is2013Justification)return!1;this.clearLineMeasures();for(var i=e.line,n=i.marginTop=0,r=0;r<i.children.length;r++){var o=i.children[r];if(t&&o instanceof uc&&"Inline"===o.textWrappingStyle&&this.layoutShape(o),n+=o.width,e===o)break}var s=this.viewer.clientActiveArea.width-n<0,a=e.line.paragraph.bodyWidget;return a&&0<a.floatingElements.length?(this.hasFloatingElement=!0,!(this.isXPositionUpdated=!0)):(s?e.previousElement&&this.cutClientWidth(e.previousElement):(this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+n),"Justify"===e.line.paragraph.paragraphFormat.textAlignment&&e instanceof X&&this.splitTextElementWordByWord(e),_.isNullOrUndefined(e.nextElement)&&0<this.viewer.clientActiveArea.width&&!e.line.isLastLine()&&this.moveElementFromNextLine(i)),s)},t.prototype.layoutFieldCharacters=function(e){var t,i;0===e.fieldType?(!_.isNullOrUndefined(e.formFieldData)&&this.isInitialLoad&&this.checkAndUpdateFieldData(e),this.isFieldCode||_.isNullOrUndefined(e.fieldEnd)&&!e.hasFieldEnd||(-1===this.documentHelper.fieldStacks.indexOf(e)&&this.documentHelper.fieldStacks.push(e),this.isRelayout&&(t=j.trimEnd(this.documentHelper.selection.getFieldCode(e)),this.isIFfield=j.startsWith(t,"IF")),this.isFieldCode=!0,e.hasFieldEnd=!0)):0<this.documentHelper.fieldStacks.length&&(2===e.fieldType?(i=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]).fieldSeparator!==e||_.isNullOrUndefined(i.fieldEnd)&&!i.hasFieldEnd||(this.isFieldCode=!1):e===(i=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]).fieldEnd&&(this.documentHelper.fieldStacks.pop(),this.isFieldCode=!1,this.isIFfield=!1))},t.prototype.checkAndUpdateFieldData=function(e){var t,i,n;e.hasFieldEnd&&!_.isNullOrUndefined(e.fieldEnd)&&(_.isNullOrUndefined(e.fieldSeparator)&&((t=new Z(2)).fieldBegin=e,t.fieldEnd=e.fieldEnd,t.line=e.line,e.line.children.splice(e.fieldEnd.indexInOwner,0,t),e.fieldSeparator=t,e.fieldEnd.fieldSeparator=t),(t=e.fieldEnd.previousNode)instanceof Z)&&2===t.fieldType&&((t=e.formFieldData)instanceof Fh?((i=new X).skipformFieldLength=!0,i.line=e.line,n=e.line.children.indexOf(e.fieldEnd),e.line.children.splice(n,0,i),i.characterFormat.copyFormat(e.characterFormat),t.checked?i.text=String.fromCharCode(9745):i.text=String.fromCharCode(9744),this.setCheckBoxFontSize(t,i.characterFormat)):t instanceof Sh&&((i=new X).characterFormat.copyFormat(e.characterFormat),i.skipformFieldLength=!0,i.line=e.line,0<t.dropdownItems.length?i.text=t.dropdownItems[t.selectedIndex]:i.text=this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),n=e.line.children.indexOf(e.fieldEnd),e.line.children.splice(n,0,i)))},t.prototype.setCheckBoxFontSize=function(e,t){"Auto"!==e.sizeType?t.fontSize=1.35*e.size:t.fontSize=1.35*t.fontSize},t.prototype.layoutEmptyLineWidget=function(e,t,i,n){this.clearLineMeasures();for(var r,o=e.paragraphFormat,s=0,a=(n=!_.isNullOrUndefined(n)&&n,o.borders),l=this.documentHelper.canRenderBorder(e),d=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat).Height,h=0,c=(0<e.childWidgets.length&&!n?(this.isUpdateMarginForCurrentLine(i),0<(r=e.childWidgets[0]).children.length&&((o.bidi||this.isContainsRtl(r))&&this.shiftElementsForRTLLayouting(r,o.bidi),n=r.isFirstLine(),f=r.isLastLine(),c=0,n&&(h=this.getBeforeSpacing(e),c=j.convertPointToPixel(o.firstLineIndent)),"Left"!==(w=o.textAlignment))&&this.viewer.textWrap&&("Justify"!==w||!f||"Justify"===w&&o.bidi)&&(s=(n=this.getSubWidth(r,"Justify"===w,0,c,f))[0].subWidth,n[0].spaceCount)):r=t?this.addLineWidget(e):i,r.isFirstLine()&&(h=this.getBeforeSpacing(e)),_.isNullOrUndefined(e.containerWidget)||!(0<e.bodyWidget.floatingElements.length)||e.containerWidget instanceof fc||e.containerWidget instanceof N&&e.containerWidget.ownerTable.containerWidget instanceof fc||(((o=new X).line=r).children.push(o),o.text="¶",o.characterFormat=e.characterFormat,o.width=this.documentHelper.textHelper.getTextSize(o,o.characterFormat),this.adjustPosition(o,e.bodyWidget),e.x+=o.padding.left,t&&this.checkInbetweenShapeOverlap(r),r.children.splice(o.indexInOwner,1)),!(this.viewer instanceof Sd&&this.viewer.clientActiveArea.height<h+d&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y)||r.isFirstLine()&&_.isNullOrUndefined(r.paragraph.previousWidget)&&!r.isEndnoteLineWidget()||e.isSectionBreak||this.moveToNextPage(this.viewer,r),this.getLineSpacing(e,d)),p=0,u=0,g=0,m=d=!isNaN(this.maxTextHeight)&&d<this.maxTextHeight?this.maxTextHeight:d,f=e.paragraphFormat.lineSpacingType,y=("Multiple"===f?d<c?u+=c-d:p+=c-d:("Exactly"===f||p+m+u<c)&&(p+=c-(p+m+u)),p+=h,u+=j.convertPointToPixel(this.getAfterSpacing(e)),"None"!=a.top.lineStyle&&r.isFirstLine()&&!l.skipTopBorder&&(p+=j.convertPointToPixel(a.top.lineWidth+a.top.space)),"None"!=a.bottom.lineStyle&&r.isLastLine()&&!l.skipBottomBorder&&(u+=j.convertPointToPixel(a.bottom.lineWidth+a.bottom.space)),r.renderedElements),v=0;v<y.length;v++){var w,b=y[v];if(0===v&&b instanceof Y||e.paragraphFormat.bidi&&y[y.length-1]instanceof Y){"Right"===(w=e.paragraphFormat.textAlignment)?g=s:"Center"===w&&(g=s/2),b.margin=new Dd(g,p,0,u),(b.line=r).height=p+m+u;break}}r.margin=new Dd(0,p,0,u),r.height=p+m+u,this.adjustPositionBasedOnTopAndBottom(r),_.isNullOrUndefined(e.nextRenderedWidget)&&e.isInsideTable&&e.previousRenderedWidget instanceof K&&1==e.childWidgets.length&&(r.height=0),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r.height),this.wrapPosition=[]},t.prototype.isUpdateMarginForCurrentLine=function(e){var t=!0;if(!_.isNullOrUndefined(e)&&!e.isFirstLine()){for(var i=0;i<e.children.length;i++)if(!(e.children[i]instanceof Wc||e.children[i]instanceof Sc)){t=!1;break}t&&(e.margin=new Dd(0,0,0,0))}},t.prototype.adjustPositionBasedOnTopAndBottom=function(e){!_.isNullOrUndefined(e.paragraph.bodyWidget)&&!_.isNullOrUndefined(e.paragraph.bodyWidget.page.headerWidget)&&0<e.paragraph.bodyWidget.page.headerWidget.floatingElements.length&&e.paragraph===e.paragraph.bodyWidget.childWidgets[0]&&0===e.indexInOwner&&this.checkInbetweenShapeOverlap(e,e.paragraph.bodyWidget.page.headerWidget.floatingElements)},t.prototype.layoutListItems=function(e,t){this.isFieldCode||(!_.isNullOrUndefined(e.paragraphFormat)&&!_.isNullOrUndefined(e.paragraphFormat.listFormat)&&!_.isNullOrUndefined(this.documentHelper.getListById(e.paragraphFormat.listFormat.listId))&&0<=e.paragraphFormat.listFormat.listLevelNumber&&e.paragraphFormat.listFormat.listLevelNumber<9&&!t?(this.clearListElementBox(e),this.layoutList(e,this.documentHelper)):e.paragraphFormat.listFormat&&-1===e.paragraphFormat.listFormat.listId&&this.clearListElementBox(e))},t.prototype.layoutList=function(e,t){var i,n,r,o=t.getListById(e.paragraphFormat.listFormat.listId),s=e.paragraphFormat.listFormat.listLevelNumber,a=this.getListLevel(o,s);_.isNullOrUndefined(a)||_.isNullOrUndefined(a.numberFormat)||(i=e.childWidgets[0],_.isNullOrUndefined(i)&&(i=new uh(e),e.childWidgets.push(i)),(r=new Y(a,!1)).line=i,"Bullet"===a.listLevelPattern?(r.text=a.numberFormat,this.updateListValues(o,s)):r.text=this.getListNumber(e.paragraphFormat.listFormat),""!==a.numberFormat&&(this.viewer.updateClientWidth(-j.convertPointToPixel(e.paragraphFormat.firstLineIndent)),this.documentHelper.isIosDevice&&(o=(o=r.text)===String.fromCharCode(61623)?String.fromCharCode(9679):o===String.fromCharCode(61551)+String.fromCharCode(32)?String.fromCharCode(9675):o)!==r.text&&(r.text=o),t.textHelper.updateTextSize(r,e),this.viewer instanceof Sd&&this.viewer.clientActiveArea.height<r.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(n=!0),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+r.width),s=r,i.children.splice(0,0,r),"None"!==a.followCharacter&&(r=new Y(a,!0),"Tab"===a.followCharacter?(r.text="\t",o=i.children.indexOf(r),o=this.getTabWidth(e,this.viewer,o,i,r),t.textHelper.updateTextSize(r,e),r.width=o):(r.text=" ",t.textHelper.updateTextSize(r,e)),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+r.width),i.children.splice(1,0,r),r.line=i),_.isNullOrUndefined(e.containerWidget)||!(0<e.bodyWidget.floatingElements.length)||s instanceof uc||e.containerWidget instanceof fc||(this.adjustPosition(s,s.line.paragraph.bodyWidget),this.isYPositionUpdated&&(this.viewer.clientActiveArea.width>s.width+r.width&&(this.viewer.clientActiveArea.width-=s.width+r.width),this.isYPositionUpdated=!1)),n?(this.moveToNextPage(this.viewer,i,void 0,!0),this.cutClientWidth(r),this.hasFloatingElement=!1,this.isXPositionUpdated=!1):"None"!==a.followCharacter&&this.viewer.updateClientWidth(j.convertPointToPixel(e.paragraphFormat.firstLineIndent))))},t.prototype.addBodyWidget=function(e,t){t=t||new z;return t.width=e.width,t.x=e.x,t.y=e.y,t},t.prototype.addListLevels=function(e){for(var t=e.levels.length;t<9;t++){var i=new El(e),n=t%3;"Bullet"===e.levels[0].listLevelPattern?(i.listLevelPattern="Bullet",i.numberFormat=0==n?String.fromCharCode(61623):1==n?String.fromCharCode(61551)+String.fromCharCode(32):String.fromCharCode(61607),i.characterFormat.fontFamily=i.numberFormat===String.fromCharCode(61607)?"Wingdings":"Symbol"):(i.listLevelPattern=this.getListLevelPattern(n),i.numberFormat="%"+(t+1).toString()+".",i.startAt=1,i.restartLevel=t),i.paragraphFormat=new Xa(void 0),i.paragraphFormat.leftIndent=48*(t+1),i.paragraphFormat.firstLineIndent=-24,e.levels.push(i)}},t.prototype.addSplittedLineWidget=function(e,t,i){if(this.isWrapText)_.isNullOrUndefined(i)||(e.children.splice(t+1,0,i),i.line=e);else{var n=!1,r=e.paragraph,o=[],s=r.childWidgets.indexOf(e),a=(_.isNullOrUndefined(i)||o.push(i),void 0),i=e.children[t];i instanceof up&&0===i.commentType&&0!=t?t-=1:i.isColumnBreak&&_.isNullOrUndefined(i.nextNode)&&(n=!0);for(var l=t+1;l<e.children.length;l++)o.push(e.children[l]);if(0<o.length||n){for(var a=s===r.childWidgets.length-1?new uh(r):r.childWidgets[s+1],d=0;d<o.length;d++)o[d].line=a;0<o.length&&(e.children.splice(t+1,e.children.length-1),!_.isNullOrUndefined(e.layoutedElements)&&0<e.layoutedElements.length&&e.layoutedElements.splice(t+1,e.layoutedElements.length-1),a.children=o.concat(a.children)),-1===r.childWidgets.indexOf(a)&&r.childWidgets.splice(s+1,0,a)}}},t.prototype.addElementToLine=function(e,t){t instanceof hc&&"Inline"!==t.textWrappingStyle||(this.isWrapText&&(this.isWrapText=!1,this.viewer.clientActiveArea.width=this.viewer.clientArea.right-this.viewer.clientActiveArea.x),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+t.width)),"Justify"===e.paragraphFormat.textAlignment&&t instanceof X&&this.splitTextElementWordByWord(t),t instanceof Ic&&(t.line.skipClipImage=!t.isInlineImage)},t.prototype.splitElementForClientArea=function(e,t){var i,n;0<t.line.children.length&&(i=t.previousElement,n=t.indexInOwner,1<t.line.children.length&&i&&this.viewer.clientActiveArea.x!==this.viewer.clientArea.x&&--n,this.addSplittedLineWidget(t.line,n))},t.prototype.splitByWord=function(e,t,i,n,r,o){var s,a,r=this.getSplitIndexByWord(this.viewer.clientActiveArea.width,n,r,o,i.scriptType);0<r&&r<i.length&&(a=e.children.indexOf(i),s=new X,n=n.substring(r)," "===(s.text=n)[0]&&(r+=n.length-(n=j.trimStart(n)).length),s.characterFormat.copyFormat(i.characterFormat),s.width=this.documentHelper.textHelper.getWidth(s.text,o,s.scriptType)," "===s.text[s.text.length-1]?s.trimEndWidth=this.documentHelper.textHelper.getWidth(j.trimEnd(s.text),o,s.scriptType):s.trimEndWidth=s.width,s.characterRange=i.characterRange,i.text=i.text.substr(0,r)," "!==i.text&&j.endsWith(i.text)&&o.bidi&&i.characterRange===V.CharacterRangeType.RightToLeft&&!this.isWrapText&&(n=this.spitTextElementByWhitespace(i,o),a=e.children.indexOf(n)),i.width=this.documentHelper.textHelper.getWidth(i.text,i.characterFormat,i.scriptType)," "===i.text[i.text.length-1]?i.trimEndWidth=this.documentHelper.textHelper.getWidth(j.trimEnd(i.text),i.characterFormat,i.scriptType):i.trimEndWidth=i.width,0<i.revisions.length&&(this.updateRevisionForSplittedElement(i,s,!0),s.isMarkedForRevision=i.isMarkedForRevision),s.height=i.height,s.baselineOffset=i.baselineOffset,this.splitErrorCollection(i,s),this.addSplittedLineWidget(e,a,s),this.addElementToLine(t,i),0===i.width)&&e.children.splice(a,1)},t.prototype.spitTextElementByWhitespace=function(e,t){var i=e.line,n=i.children.indexOf(e),r=e.text,o=new X,s=r.length-1;return e.text=r.substring(0,s),o.text=r.substring(s),o.characterFormat.copyFormat(e.characterFormat),o.line=i,o.characterRange=V.CharacterRangeType.WordSplit,o.scriptType=V.FontScriptType.English,o.height=e.height,o.baselineOffset=e.baselineOffset,o.width=this.documentHelper.textHelper.getWidth(o.text,t,o.scriptType),i.children.splice(n+1,0,o),0<e.revisions.length&&(this.updateRevisionForSplittedElement(e,o,0<s,!0),o.isMarkedForRevision=e.isMarkedForRevision),o},t.prototype.splitErrorCollection=function(e,t){if(0<e.errorCollection.length){for(var i=[],n=e.ignoreOnceItems,r=0;r<e.errorCollection.length;r++)i.push(e.errorCollection[r]);for(var o=0;o<e.errorCollection.length;o++){var s=e.text.indexOf(e.errorCollection[o].text),a=e.errorCollection[o];s<0?(i.splice(0,1),t.errorCollection.push(a)):0<t.text.indexOf(a.text)&&t.errorCollection.push(a)}t.ignoreOnceItems=n,e.ignoreOnceItems=[],e.errorCollection=i}},t.prototype.splitByCharacter=function(e,t,i,n,r){var o,s=e.paragraph,a="AtLeast"===s.paragraphFormat.lineSpacingType?s.paragraphFormat.afterSpacing:0,n=this.getTextSplitIndexByCharacter(this.viewer.clientArea.width,this.viewer.clientActiveArea.width,i,n,r,t.scriptType);0===n&&t.previousNode instanceof Ic&&"Right"===t.previousNode.textWrappingType||((n=(o=0)===n&&!_.isNullOrUndefined(t)&&0<t.length&&Math.max(t.height,a)<=this.viewer.clientArea.height&&0===this.viewer.clientActiveArea.width&&0===e.children.indexOf(t)?1:n)<t.length&&(o=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,n),r,t.scriptType),i=i.substring(n)),o>this.viewer.clientActiveArea.width&&0<t.indexInOwner?this.addSplittedLineWidget(e,t.indexInOwner-1):(a=e.children.indexOf(t),n<t.length?((o=new X).text=i,o.errorCollection=t.errorCollection,t.text=t.text.substr(0,n),o.characterFormat.copyFormat(t.characterFormat),o.width=this.documentHelper.textHelper.getWidth(o.text,r,o.scriptType)," "===o.text[o.text.length-1]?o.trimEndWidth=this.documentHelper.textHelper.getWidth(j.trimEnd(o.text),r,o.scriptType):o.trimEndWidth=o.width,o.characterRange=t.characterRange,t.width=this.documentHelper.textHelper.getWidth(t.text,r,t.scriptType)," "===t.text[t.text.length-1]?t.trimEndWidth=this.documentHelper.textHelper.getWidth(j.trimEnd(t.text),r,t.scriptType):t.trimEndWidth=t.width,o.height=t.height,o.baselineOffset=t.baselineOffset,e.children.splice(t.indexInOwner+1,0,o),0<t.revisions.length&&(this.updateRevisionForSplittedElement(t,o,0<n),o.isMarkedForRevision=t.isMarkedForRevision),this.addElementToLine(s,t),this.addSplittedLineWidget(e,a),0===t.width&&e.children.splice(a,1)):(this.addSplittedLineWidget(e,a),this.addElementToLine(s,t))))},t.prototype.updateRevisionForSplittedElement=function(e,t,i,n){if(0<e.revisions.length)for(var r=0;r<e.revisions.length;r++){var o,s=e.revisions[r];i?(t.revisions.push(s),(o=s.range.indexOf(e))<0?s.range.push(t):n?s.range.splice(o,0,t):s.range.splice(o+1,0,t)):(o=s.range.indexOf(e),s.range.splice(o,1),s.range.splice(o,0,t),t.revisions.push(s))}},t.prototype.splitTextElementWordByWord=function(e){var t=e.line,i=s=t.children.indexOf(e),n=e.padding.left;if((e.padding.left=0)<=(a=e.text).trim().indexOf(" ")){t.children.splice(s,1);for(var r,o,s,a,l=e.characterFormat,d=e.length-j.trimStart(a).length;d<e.length&&0!==(d=this.getTextIndexAfterSpace(a,d))&&d!==e.length;)d<e.length&&(r=new X,o=a.substring(0,d)," "===(a=a.substring(d)).substring(0,1)&&(d+=a.length-j.trimStart(a).length),r.text=o,r.characterFormat.copyFormat(e.characterFormat),r.line=t,r.height=e.height,r.baselineOffset=e.baselineOffset,r.characterRange=e.characterRange,t.children.splice(s,0,r),0<e.revisions.length&&(this.updateRevisionForSplittedElement(e,r,0<d,!0),r.isMarkedForRevision=e.isMarkedForRevision)," "!==r.text&&j.endsWith(r.text)&&l.bidi&&r.characterRange===V.CharacterRangeType.RightToLeft&&(o=this.spitTextElementByWhitespace(r,l),s=t.children.indexOf(o)),r.width=this.documentHelper.textHelper.getWidth(r.text,l,r.scriptType)," "===r.text[r.text.length-1]?r.trimEndWidth=this.documentHelper.textHelper.getWidth(j.trimEnd(r.text),l,r.scriptType):r.trimEndWidth=r.width,e.text=a,e.width=this.documentHelper.textHelper.getWidth(e.text,e.characterFormat,e.scriptType)," "===e.text[e.text.length-1]?e.trimEndWidth=this.documentHelper.textHelper.getWidth(j.trimEnd(e.text),e.characterFormat,e.scriptType):e.trimEndWidth=e.width,0===e.width&&-1!==t.children.indexOf(e)&&t.children.splice(t.children.indexOf(e),1),d=0,s++);e.text=a,t.children.splice(s,0,e)}t.children[i].padding.left=n},t.prototype.isSplitByHyphen=function(e,t){if(!_.isNullOrUndefined(e.previousElement)&&(e.previousElement instanceof X||e.previousElement instanceof Y))return e=e.previousElement.text,"-"===t.substring(0,1)&&" "!==e.substring(e.length-1,e.length);return"-"===t.substring(0,1)},t.prototype.splitTextForClientArea=function(e,t,i,n,r){var o=e.paragraph,s=!0,a=-1;if(" "===i.substring(0,1)||this.isSplitByHyphen(t,i))a=1;else{var l=n,d=0,d=j.trimEnd(i).indexOf(" ")+1;if(0<(a=d=0==d?j.trimEnd(i).indexOf("-")+1:d)&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.slice(0,a),r,t.scriptType)),this.viewer.clientActiveArea.width<l&&!this.documentHelper.textHelper.isUnicodeText(i,t.scriptType)&&!this.isWordFittedByJustification(t,l)&&(s=this.checkPreviousElement(e,e.children.indexOf(t))))return}n<=this.viewer.clientActiveArea.width?this.addElementToLine(o,t):s&&(0<a||-1!==i.indexOf(" ")||-1!==i.indexOf("-"))?this.splitByWord(e,o,t,i,n,r):this.splitByCharacter(e,t,i,n,r)},t.prototype.splitByLineBreakOrTab=function(e,t,i,n){var r,o=t.line.children.indexOf(t),s=t.text,a=s.substring(i),l=new("\t"===n?_h:X);l.line=t.line,this.updateRevisionForSplittedElement(t,l,!0),l.characterFormat.copyFormat(t.characterFormat),l.characterRange=t.characterRange,t.line.children.splice(o+1,0,l),t.isWidthUpdated=!1,0<i&&1===a.length?(l.text=s.substring(i),t.text=s.substring(0,i)):0<i?(l.text=n,(r=new X).line=t.line,r.text=s.substring(i+1),this.updateRevisionForSplittedElement(t,r,!0),r.characterFormat.copyFormat(t.characterFormat),r.characterRange=t.characterRange,t.line.children.splice(o+2,0,r),t.text=s.substring(0,i)):""!==a&&(l.text=s.substring(i+1),t.text=n)},t.prototype.moveToNextLine=function(e,t,i){var n,r,o=e.paragraph,s=o.paragraphFormat,a=e.isFirstLine(),l=e.isLastLine(),d=0,h=0,c=0,p=0,u=0,g=0,m=s.borders,f=(this.updateLineWidget(e),h=(d=this.maxTextHeight)-this.maxTextBaseline,0),y=!1,R=this.documentHelper.canRenderBorder(o),v=(!o.bodyWidget||o.bodyWidget instanceof Xd||(f=this.documentHelper.pages.indexOf(o.bodyWidget.page)),a&&(p=this.getBeforeSpacing(o,f),g=j.convertPointToPixel(s.firstLineIndent)),l&&(c=j.convertPointToPixel(this.getAfterSpacing(o))),(s.bidi||this.isContainsRtl(e))&&(this.shiftElementsForRTLLayouting(e,s.bidi),this.isRTLLayout=!0),h=isNaN(this.maxTextHeight)?(d=(a=this.documentHelper.textHelper.measureText("a",o.characterFormat)).Height)-a.BaselineOffset:(d=this.maxTextHeight)-this.maxTextBaseline,u=this.getLineSpacing(o,d),(e.skipClipImage||14<=o.paragraphFormat.lineSpacing||u<0)&&"Exactly"===s.lineSpacingType&&u<h+this.maxBaseline&&(u=h+this.maxBaseline),0),w=0,b=s.textAlignment,a=0,x=0;if("Left"!==b&&this.viewer.textWrap&&("Justify"!==b||!l||"Justify"===b&&s.bidi||this.is2013Justification&&l)&&(v=(n=this.getSubWidth(e,"Justify"===b,w,g,l))[0].subWidth,w=n[0].spaceCount,a=n[0].totalSpaceCount,x=n[0].trimmedSpaceWidth,y=e.isEndsWithPageBreak||e.isEndsWithColumnBreak||e.isEndsWithLineBreak||e.paragraph.bidi||this.isRTLLayout),!y&&n&&1===n.length&&0<this.viewer.clientActiveArea.width&&!l&&!this.is2013Justification&&"Justify"===b&&"Word2013"===this.documentHelper.compatibilityMode)g=this.viewer.clientActiveArea.width,y=this.getTotalSpaceWidth(e),r=0,this.viewer.clientActiveArea.x-=r=g/a/(y/a)*100<=33?y/8:y/4,this.viewer.clientActiveArea.width+=r,this.is2013Justification=!0,t?this.splitParagraphForMultiColumn(e,i):(this.moveElementFromNextLine(e),this.nextElementToLayout=e.children[e.children.length-1]);else{this.is2013Justification&&l&&0<v&&(w=v=0),this.is2013Justification=!1,this.nextElementToLayout=void 0;for(var M=!1,C=0,A=s.lineSpacingType,D=!1,I=e.renderedElements,U=0,V=0,z=0,k=this.viewer.clientArea.x,F=0;F<I.length;F++){var P=0,T=0,S=0,H=I[F];if(!_.isNullOrUndefined(n)&&D&&0<H.padding.left&&n.length>C+1&&(N=v,"Justify"===b?N=v*n[C].spaceCount:"Center"===b&&(N=v/2),H.padding.left=H.padding.left-N,v=(N=n[++C]).subWidth,w=N.spaceCount),!(H instanceof hc&&"Inline"!==H.textWrappingStyle)){var D=!0,N=this.alignLineElements(H,P,T,h,M,v,b,w,F===I.length-1);if("Justify"===b&&H instanceof hc&&"Inline"===H.textWrappingStyle&&0!==v&&(H.x=k,H instanceof uc))for(var W=0;W<H.textFrame.childWidgets.length;W++){var q=(L=H.textFrame.childWidgets[W]).bidi?L.rightIndent:L.leftIndent;L.x=k+j.convertPointToPixel(q+H.textFrame.marginLeft)}k+=H.width,e.maxBaseLine=this.maxBaseline,P=N.topMargin,T=N.bottomMargin,M=N.addSubWidth,w=N.whiteSpaceCount,"Multiple"===A?d<u?T+=u-d:P+=u-d:("Exactly"===A||u>P+H.height+T)&&(P+=u-(P+H.height+T)),0<f&&o===o.bodyWidget.childWidgets[0]&&this.documentHelper.pages[f].sectionIndex===this.documentHelper.pages[f-1].sectionIndex?P+=0:P+=p,"None"!=m.top.lineStyle&&e.isFirstLine()&&!R.skipTopBorder&&(P+=j.convertPointToPixel(m.top.lineWidth+m.top.space)),"None"!=m.bottom.lineStyle&&e.isLastLine()&&!R.skipBottomBorder&&(T+=j.convertPointToPixel(m.bottom.lineWidth+m.bottom.space)),T+=c;var O=0<F?I[F-1]:void 0;if((0===F||!(H instanceof hc&&"Inline"!==H.textWrappingStyle)&&O instanceof hc&&"Inline"!==O.textWrappingStyle&&O.indexInOwner<H.indexInOwner||0<H.padding.left)&&(e.height=P+H.height+T,"Right"===b||"Justify"===b&&s.bidi&&(l||x<0)?S=x<0?x:v:"Center"===b&&(S=v<0?v:v/2)),H.margin=new Dd(S,P,0,T),H.line=e,U<H.height&&(U=H.height,V=H.margin.bottom,z=H.margin.top),H instanceof uc&&"Inline"===H.textWrappingStyle){if(0!==F||0<H.margin.left){var E=I[0].margin.left;H.x+=E;for(var L,B=0;B<H.textFrame.childWidgets.length;B++)(L=H.textFrame.childWidgets[B])instanceof K?L.updateChildWidgetLeft(L.x+E,!0):L.x+=E}this.updateShapeYPosition(H)}}}e.margin=new Dd(0,z,0,V),this.adjustPositionBasedOnTopAndBottom(e),this.checkInbetweenShapeOverlap(e),!t&&e.isLastLine()&&0===e.indexInOwner&&e.paragraph.paragraphFormat.widowControl?(g=e.paragraph.previousSplitWidget,_.isNullOrUndefined(g)||g.isEndsWithPageBreak||g.isEndsWithColumnBreak||0===g.indexInOwner||(a=g.childWidgets.length-1,2===g.childWidgets.length&&(a=0),this.splitParagraph(g,a,e.paragraph),this.updateClientAreaForNextBlock(e,e.paragraph))):t&&this.splitParagraphForMultiColumn(e,i),t||this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height),this.wrapPosition=[]}},t.prototype.updateShapeYPosition=function(e){if(0<e.margin.top){e.y+=e.margin.top;for(var t=0;t<e.textFrame.childWidgets.length;t++)e.textFrame.childWidgets[t].y+=e.margin.top}},t.prototype.getBodyWidget=function(e,t){if(t)for(;e&&0!==e.columnIndex;)e=e.previousRenderedWidget;else for(;e&&!_.isNullOrUndefined(e.nextRenderedWidget)&&e.columnIndex!==e.sectionFormat.numberOfColumns-1&&e.index===e.nextRenderedWidget.index;)e=e.nextRenderedWidget;return e},t.prototype.splitParagraphForMultiColumn=function(e,t){this.splitParagraph(e.paragraph,t,void 0),_.isNullOrUndefined(e.paragraph.previousRenderedWidget)&&0==t||!_.isNullOrUndefined(e.paragraph.previousRenderedWidget)&&e.paragraph.previousRenderedWidget.bodyWidget.sectionIndex!==e.paragraph.bodyWidget.sectionIndex?this.moveBlocksToNextPage(e.paragraph):this.moveBlocksToNextPage(e.paragraph.previousRenderedWidget);var t=this.viewer.clientActiveArea.height;this.viewer.updateClientArea(e.paragraph.bodyWidget,e.paragraph.bodyWidget.page),this.viewer.clientActiveArea.y=e.paragraph.bodyWidget.y,this.viewer.clientActiveArea.height=t,!e.paragraph.bodyWidget.sectionFormat.equalWidth&&e.paragraph.bodyWidget.sectionFormat.numberOfColumns-1!==e.paragraph.bodyWidget.columnIndex||(t=e.paragraph,this.documentHelper.blockToShift=t,this.shiftLayoutedItems(!1,!0))},t.prototype.checkInbetweenShapeOverlap=function(o,e){var s,a,l,d,h,c=this;o.paragraph.containerWidget instanceof fc||!o.paragraph.bodyWidget||(a=this.getLineY(o),l=o.paragraph.isInsideTable,d=o.paragraph.y,h=!0,_.isNullOrUndefined(e)&&(h=!1,e=o.paragraph.bodyWidget.floatingElements),e.sort(function(e,t){return e.y-t.y}),e.forEach(function(e){var t,i,n,r;l&&e.line&&!e.line.paragraph.isInsideTable||_.isNullOrUndefined(e.line)||(t="TopAndBottom"===e.textWrappingStyle&&e instanceof Ic&&!o.paragraph.isEmpty()?new Rd(o.paragraph.x,c.viewer.clientActiveArea.y,o.paragraph.width,o.children[0].height):new Rd(o.paragraph.x,c.viewer.clientActiveArea.y,o.paragraph.width,o.height),i=new Rd(e.x,e.y-e.distanceTop,e.width,e.height),e.line&&c.isRelayout&&!c.isRelayoutOverlap&&c.viewer.documentHelper.selection.isExistAfter(e.line.paragraph,o.paragraph))||c.isRelayout&&c.isRelayoutOverlap&&c.viewer.documentHelper.selection.isExistAfter(e.line.paragraph,c.endOverlapWidget)||(n="TopAndBottom"===e.textWrappingStyle,r=e.y+e.height+e.distanceBottom-a,s&&n&&s.y+s.height+s.distanceBottom+o.height>e.y-e.distanceTop&&s.y-s.distanceTop<e.y-e.distanceTop&&e.y+e.height+e.distanceBottom>s.y+s.height+s.distanceBottom?(s=e,o.paragraph.isEmpty()&&h?(o.paragraph.y=d,o.paragraph.y+=r):o.marginTop=r):n&&!s&&t.isIntersecting(i)&&(s=e,o.paragraph.isEmpty()&&h?o.paragraph.y+=r:o.marginTop=r))}),s?this.viewer.cutFromTop(s.y+s.height+s.distanceBottom):this.isRelayoutOverlap&&(o.marginTop=0))},t.prototype.getLineY=function(e){var t=e.paragraph,i=t.y;if(!t.isEmpty())for(var n=t.firstChild;n!==e;)i=i+n.height+n.marginTop,n=n.nextLine;return i},t.prototype.updateLineWidget=function(e){for(var t,i=0,n=0,r=!1,o=!1,s=0;s<e.children.length;s++){var a,l,d,h=e.children[s];(o=h instanceof Z&&2===h.fieldType?!1:o)||(h instanceof Z&&0===h.fieldType&&(o=!0),h instanceof hc&&"Inline"!==h.textWrappingStyle)||(h instanceof X&&0===h.text.replace(/\s+/g,"").length&&h.text!==String.fromCharCode(160)?i<h.height&&(i=h.height,n=h.baselineOffset):h instanceof X||h instanceof Y?(a=h.height,l=h.baselineOffset,d=!1,h instanceof X&&h.isCheckBoxElement&&!_.isNullOrUndefined(h.previousNode)&&h.previousNode instanceof E&&("Cell"===h.previousNode.contentControlWidgetType||"Inline"===h.previousNode.contentControlWidgetType)&&(d=!0),h instanceof X&&h.isCheckBoxElement&&!d&&(a/=1.35,l/=1.35),this.maxTextHeight<a&&(this.maxTextHeight=a,this.maxTextBaseline=l),this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)):this.maxBaseline<h.height&&(this.maxBaseline=h.height,h instanceof Ic)&&(r=!0))}0===this.maxTextHeight&&0!==i&&(r?(this.maxTextHeight=0,this.maxTextBaseline=0):(e.isLastLine()&&this.documentHelper.selection?(t=this.documentHelper.selection.getParagraphMarkSize(e.paragraph,0,0),this.maxTextHeight=t.height):this.maxTextHeight=i,this.maxTextBaseline=n,this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)))},t.prototype.reLayoutEndnote=function(){var e,t,i=this.documentHelper.pages[this.documentHelper.pages.length-1];_.isNullOrUndefined(i)||_.isNullOrUndefined(i.endnoteWidget)||(e=this.viewer.clientActiveArea.clone(),t=this.getBodyWidget(i.bodyWidgets[i.bodyWidgets.length-1],!0),this.viewer.updateClientArea(t,t.page),0<(t=this.getNextWidgetHeight(t))&&(this.viewer.clientActiveArea.height-=t-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=t),this.layoutfootNote(i.endnoteWidget),this.viewer.clientActiveArea=e)},t.prototype.moveEndnoteToNextPage=function(e,t,i){if(i){var i=this.createSplitBody(t),n=this.viewer.createNewPage(i);this.viewer.updateClientArea(i,i.page),i.y=t.y=this.viewer.clientActiveArea.y;for(var r=0;r<e.bodyWidgets.length;r++)e.bodyWidgets[r].page=n,e.bodyWidgets[r].containerWidget=e;e.page.endnoteWidget=void 0,(n.endnoteWidget=e).page=n}else{var o=t.page,s=t.index;if(_.isNullOrUndefined(o.endnoteWidget)){var a=new q;a.footNoteType="Endnote",a.page=o,a.bodyWidgets.push(t),t.containerWidget=a;for(r=s+1;r<e.bodyWidgets.length;r++){var l=e.bodyWidgets[r];e.bodyWidgets.splice(r,1),a.bodyWidgets.push(l),l.containerWidget=a,l.page=o,r--}o.endnoteWidget=a}else{-1===o.endnoteWidget.bodyWidgets.indexOf(t)&&(o.endnoteWidget.bodyWidgets.splice(0,0,t),t.containerWidget=o.endnoteWidget);for(r=e.bodyWidgets.length-1;s<r;r--){l=e.bodyWidgets[r];o.endnoteWidget.bodyWidgets.unshift(l),l.containerWidget=o.endnoteWidget,l.page=o,e.bodyWidgets.splice(r,1)}}}},t.prototype.moveToNextPage=function(e,t,i,n,r){if(!this.isFootNoteLayoutStart){var o=t.paragraph,s=!1,a=!1,l=!1,d=0;if(o&&(_.isNullOrUndefined(o.containerWidget)||_.isNullOrUndefined(o.containerWidget.containerWidget)||!(o.containerWidget.containerWidget instanceof q)||"Footnote"!==o.containerWidget.containerWidget.footNoteType)){var h=0;if(o instanceof q)return;if(!_.isNullOrUndefined(o.containerWidget)&&!_.isNullOrUndefined(o.containerWidget.containerWidget)&&o.containerWidget.containerWidget instanceof q&&"Endnote"===o.containerWidget.containerWidget.footNoteType&&(l=!0),_.isNullOrUndefined(t)||(0===(h=o.childWidgets.indexOf(t))||(!o.paragraphFormat.keepLinesTogether||_.isNullOrUndefined(o.previousWidget)||t.previousLine.isEndsWithColumnBreak)&&(1!=h||t.previousLine.isEndsWithPageBreak||t.previousLine.isEndsWithColumnBreak||!o.paragraphFormat.widowControl||_.isNullOrUndefined(o.previousWidget))||(s=!(h=0)),(0<h||i)&&(o.height=e.clientActiveArea.y-o.y),0!==h)||o.isEndsWithPageBreak||o.isEndsWithColumnBreak||(c=this.alignBlockElement(o),_.isNullOrUndefined(c.node))||(h=(p=c.node instanceof dh?this.splitRow(c.node):c.node)instanceof K?0:parseInt(c.position.index,10),a=!(s=!1),(o=p)instanceof G?this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!o.paragraphFormat.keepWithNext&&!n&&this.viewer.owner.editorModule.updateWholeListItems(o):this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!n&&this.viewer.owner.editorModule.updateWholeListItems(o)),_.isNullOrUndefined(o.bodyWidget)||_.isNullOrUndefined(o.bodyWidget.containerWidget)||o.bodyWidget.containerWidget instanceof q||void 0===o.bodyWidget.page.footnoteWidget||this.layoutfootNote(o.bodyWidget.page.footnoteWidget),this.isMultiColumnSplit){var c=this.viewer.columnLayoutArea.getNextColumnByBodyWidget(o.bodyWidget);if(_.isNullOrUndefined(c))return}var p=o.bodyWidget.page;if(i&&0===h&&!_.isNullOrUndefined(o.bodyWidget.lastChild)&&o===o.bodyWidget.lastChild&&this.endOverlapWidget&&(this.isRelayoutOverlap=!1),l&&_.isNullOrUndefined(p.nextPage)&&0===o.bodyWidget.index&&0===o.index&&0===h)return u=o.containerWidget.containerWidget,void this.moveEndnoteToNextPage(u,o.bodyWidget,!0);var u,n=this.moveBlocksToNextPage(o,0===h,h,!1,l);if(l&&(u=o.containerWidget.containerWidget,n.footNoteReference=o.bodyWidget.footNoteReference,this.moveEndnoteToNextPage(u,n)),p!==n.page&&this.viewer.updateClientArea(n,n.page),this.viewer.updateClientAreaForBlock(o,!0),0<h){if(t.isLastLine()&&i)return;var g=void 0,g=n.firstChild instanceof G&&n.firstChild.equals(o)?n.firstChild:new G;(g=this.moveChildsToParagraph(o,h,g)).containerWidget=n;for(var m=0;m<g.floatingElements.length;m++){var f=g.floatingElements[m];f.line.paragraph.bodyWidget!==o.bodyWidget&&"Inline"!==f.textWrappingStyle&&o.bodyWidget.floatingElements.splice(o.bodyWidget.floatingElements.indexOf(f),1)}c=this.getFootNoteWidgetsOf(g);this.moveFootNotesToPage(c,o.bodyWidget,n),o=g,this.viewer.clientActiveArea.height-=this.getFootNoteHeight(c)}else i||(o.containerWidget.removeChild(o.indexInOwner),o instanceof G&&0<o.floatingElements.length&&this.addRemoveFloatElementsFromBody(o,o.containerWidget,!1),l&&0===o.containerWidget.childWidgets.length&&!_.isNullOrUndefined(o.containerWidget.containerWidget)&&o.containerWidget.containerWidget instanceof q&&((u=o.containerWidget.containerWidget).bodyWidgets.splice(u.bodyWidgets.indexOf(o.containerWidget),1),n.footNoteReference.bodyWidget=n,_.isNullOrUndefined(u.page.endnoteWidget)||0!==u.page.endnoteWidget.bodyWidgets.length||(u.page.endnoteWidget=void 0)));if(!i){if(-1===n.childWidgets.indexOf(o)&&(n.childWidgets.splice(0,0,o),o instanceof G)&&0<o.floatingElements.length&&this.addRemoveFloatElementsFromBody(o,n,!0),o.containerWidget=n,this.viewer.updateClientAreaLocation(o,this.viewer.clientActiveArea),s||a){o.bodyWidget.page.footnoteWidget&&this.layoutfootNote(o.bodyWidget.page.footnoteWidget),(t.paragraph!==o||o.paragraphFormat.widowControl&&this.isImagePresent(o))&&(o instanceof K&&this.clearTableWidget(o,!0,!0,!1),this.layoutBlock(o,0,!0),e.updateClientAreaForBlock(o,!1));var y=t.paragraph;if(a){var v=o.nextWidget;if(!_.isNullOrUndefined(v))do{if(e.updateClientAreaForBlock(v,!0),v===y){this.viewer.updateClientAreaLocation(v,this.viewer.clientActiveArea);break}}while(v instanceof K&&this.clearTableWidget(v,!0,!0,!1),this.layoutBlock(v,0,!0),e.updateClientAreaForBlock(v,!1),v=v.nextWidget)}this.updateClientAreaForNextBlock(t,y)}!t.isFirstLine()||0!==t.indexInOwner||t.children[0]instanceof Y||r||(d=-j.convertPointToPixel(t.paragraph.paragraphFormat.firstLineIndent),this.viewer.updateClientWidth(d))}}if(i||this.updateShapeBaseLocation(o),r&&this.viewer.updateClientWidth(d),this.isRelayoutOverlap&&this.endOverlapWidget&&(!this.skipRelayoutOverlap||this.endOverlapWidget instanceof K&&this.endOverlapWidget.wrapTextAround)){var w=this.endOverlapWidget.previousRenderedWidget,b=t.paragraph;for(this.startOverlapWidget=b,b=(t=this.endOverlapWidget.childWidgets[0]).paragraph;b;)b.floatingElements.forEach(function(e){-1!==w.bodyWidget.floatingElements.indexOf(e)&&"Inline"!==e.textWrappingStyle&&(w.bodyWidget.floatingElements.splice(w.bodyWidget.floatingElements.indexOf(e),1),t.paragraph.bodyWidget.floatingElements.push(e))}),b=b!==this.endOverlapWidget?b.nextWidget:void 0;this.layoutStartEndBlocks(this.startOverlapWidget,this.endOverlapWidget),this.startOverlapWidget=void 0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-this.endOverlapWidget.y,this.viewer.clientActiveArea.y=this.endOverlapWidget.y}}},t.prototype.isImagePresent=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++)if(i.children[n]instanceof Ic)return!0;return!1},t.prototype.updateShapeBaseLocation=function(e){if(e instanceof G&&0<e.floatingElements.length)for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],n=this.getFloatingItemPoints(i);i.y=n.y,i.x=n.x,i instanceof uc&&this.updateChildLocationForCellOrShape(i.y,i)}},t.prototype.moveChildsToParagraph=function(e,t,i){i=this.addParagraphWidget(this.viewer.clientActiveArea,i);for(var n=0,r=t;r<e.childWidgets.length;r++){var o=e.childWidgets[r];(o.paragraph=i).childWidgets.splice(n,0,o),o.paragraph=i,n++}i.paragraphFormat=e.paragraphFormat,i.characterFormat=e.characterFormat,i.index=e.index,e.childWidgets.splice(t);for(r=0;r<e.floatingElements.length;r++){var s=e.floatingElements[r];s.line.paragraph!==e&&(i.floatingElements.push(s),e.floatingElements.splice(e.floatingElements.indexOf(s),1),r--)}return i},t.prototype.addRemoveFloatElementsFromBody=function(e,t,i){if(0<e.floatingElements.length)for(var n=0;n<e.floatingElements.length;n++)i?-1===t.floatingElements.indexOf(e.floatingElements[n])&&"Inline"!==e.floatingElements[n].textWrappingStyle&&t.floatingElements.push(e.floatingElements[n]):-1!==t.floatingElements.indexOf(e.floatingElements[n])&&t.floatingElements.splice(t.floatingElements.indexOf(e.floatingElements[n]),1)},t.prototype.alignBlockElement=function(e){if(e instanceof G&&(e.isEndsWithPageBreak||e.isEndsWithColumnBreak))return{node:void 0,position:{index:""}};for(var t,i=0,n=this.getPreviousBlock(e);n;){if(n instanceof G){if(!n.paragraphFormat.keepWithNext||n.isEndsWithPageBreak||n.isEndsWithColumnBreak)break;if((t=n).paragraphFormat.keepLinesTogether)_.isNullOrUndefined(this.getPreviousBlock(n))?t=void 0:i=0;else if(_.isNullOrUndefined(this.getPreviousBlock(n))&&1===n.childWidgets.length)t=void 0;else if(n.paragraphFormat.widowControl){if(0!==(i=1===(i=n.lastChild.indexInOwner-1)||i<0?0:i))break}else if(0!==(i=n.lastChild.indexInOwner))break}else if(n instanceof dh){var r=n.childWidgets[0];if(!(0<r.childWidgets.length))break;r=this.documentHelper.getFirstParagraphInCell(r);if(!r.paragraphFormat.keepWithNext)break;r.paragraphFormat.keepWithNext&&(_.isNullOrUndefined(this.getPreviousBlock(n))?t=void 0:i=(t=n).indexInOwner)}n=this.getPreviousBlock(n)}return{node:t=!_.isNullOrUndefined(t)&&t instanceof G&&0===t.indexInOwner&&t.paragraphFormat.keepWithNext&&t.paragraphFormat.widowControl?e:t,position:{index:i.toString()}}},t.prototype.getPreviousBlock=function(e){var t;return e instanceof G?(t=e.previousWidget,!this.isInitialLoad&&_.isNullOrUndefined(t)&&e.containerWidget instanceof z&&!_.isNullOrUndefined(e.containerWidget.previousRenderedWidget)&&e.containerWidget.sectionIndex===e.containerWidget.previousRenderedWidget.sectionIndex&&!_.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof G&&(t=e.previousRenderedWidget)):e instanceof dh&&(t=e.previousWidget,_.isNullOrUndefined(t))&&(t=e.ownerTable.previousWidget),t=t instanceof K?t.lastChild:t},t.prototype.splitRow=function(e){var t=e.ownerTable;if(0===e.indexInOwner)return t;for(var i=this.createTableWidget(t),n=e.indexInOwner;n<t.childWidgets.length;){var r=t.childWidgets.splice(n,1)[0];i.childWidgets.push(r),r.containerWidget=i,t.height-=r.height,i.height+=r.height}return t.containerWidget.childWidgets.splice(t.indexInOwner+1,0,i),i.containerWidget=t.containerWidget,i},t.prototype.splitParagraph=function(e,t,i){if(0===t&&_.isNullOrUndefined(i))return e;for(var n,r=!1,o=(_.isNullOrUndefined(i)?((i=new G).containerWidget=e.containerWidget,e.containerWidget.childWidgets.splice(e.indexInOwner+1,0,i),i.paragraphFormat=e.paragraphFormat,i.characterFormat=e.characterFormat,i.index=e.index):0===t&&(r=!0,n=e,e=i,i=n),0),s=t;s<e.childWidgets.length;s++){var a=e.childWidgets[s];a.paragraph=i,r?i.childWidgets.push(a):i.childWidgets.splice(o,0,a),i.height+=a.height,e.height-=a.height,a.paragraph=i,o++}return i.width=e.width,r?(i.containerWidget.childWidgets.splice(i.indexInOwner,1),i.y=e.y,i.x=e.x,i.containerWidget=e.containerWidget,e.containerWidget.childWidgets.unshift(i)):e.childWidgets.splice(t),0!==e.childWidgets.length&&!r||e.containerWidget.childWidgets.splice(e.indexInOwner,1),i},t.prototype.updateClientPositionForBlock=function(e,t){var i=e instanceof dh?e.ownerTable:e,n=!1;do{if(this.viewer.updateClientAreaForBlock(i,!0),i instanceof G){if(t instanceof G&&t.equals(i)){n=!0;break}this.addParagraphWidget(this.viewer.clientActiveArea,i),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+i.height),this.viewer.updateClientAreaForBlock(i,!1)}else if(i instanceof K){"Word2013"===this.documentHelper.compatibilityMode||i.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-j.convertPointToPixel(i.firstChild.firstChild.leftMargin)),this.addTableWidget(this.viewer.clientActiveArea,[i]);var r=i.firstChild;if(t instanceof dh&&i.equals(t.ownerTable)&&!_.isNullOrUndefined(r)){do{if(r.equals(t)){n=!0;break}}while(this.addTableRowWidget(this.viewer.clientActiveArea,[r]),this.updateChildLocationForRow(this.viewer.clientActiveArea.y,r),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r.height),i.height+=r.height,r=r.nextWidget)}else this.updateChildLocationForTable(i.y,i),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+i.height),this.viewer.updateClientAreaForBlock(i,!1)}}while((i=i.nextWidget)&&!n)},t.prototype.updateClientAreaForNextBlock=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(e===n)break;this.updateShapeBaseLocation(t),this.checkInbetweenShapeOverlap(n),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+n.height)}},t.prototype.layoutStartEndBlocks=function(e,t){var i=e;for(this.isOverlapFloatTable=!0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-e.y,this.viewer.clientActiveArea.y=e.y,e=e instanceof K?this.documentHelper.getFirstParagraphInFirstCell(e):e,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(e);i;){this.viewer.updateClientAreaForBlock(i,!0),i instanceof G?this.layoutParagraph(i,0):(this.clearTableWidget(i,!0,!0,!0),this.layoutTable(i,0)),this.viewer.updateClientAreaForBlock(i,!1);var n=!_.isNullOrUndefined(i.nextWidget)&&i.nextWidget instanceof K&&i.nextWidget===t&&"Paragraph"===i.nextWidget.positioning.verticalOrigin,i=i===t||n?void 0:i.nextWidget}},t.prototype.alignLineElements=function(e,t,i,n,r,o,s,a,l){var d,h,c;return 0<e.width&&(e instanceof X||e instanceof Y)?(d=e instanceof X?e:void 0,h=(e instanceof X?d:e).baselineOffset,t+=this.maxBaseline-h,i+=n-(e.height-h),!_.isNullOrUndefined(d)&&"Justify"===s&&0<a&&(d.isWidthUpdated=!1,h=d.width,s=d.text,r=r||0<(s=j.trimStart(s)).length)&&(c=s.length-j.removeSpace(s).length,l&&(c-=s.length-j.trimEnd(s).length),a<c&&(h=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(s,d.characterFormat,d.scriptType),c=a),0<c)&&(d.width=h+o*c,a-=c)):(r=!0,t+=this.maxBaseline-e.height,i+=n),{topMargin:t,bottomMargin:i,addSubWidth:r,whiteSpaceCount:a}},t.prototype.updateWidgetToPage=function(e,t){if(t.isInsideTable){var i=t.associatedCell;if(t.height=e.clientActiveArea.y-t.y,_.isNullOrUndefined(t.associatedCell)||_.isNullOrUndefined(t.associatedCell.ownerRow)||_.isNullOrUndefined(t.associatedCell.ownerRow.rowFormat))return;"Exactly"===t.associatedCell.ownerRow.rowFormat.heightType?i.height=j.convertPointToPixel(t.associatedCell.ownerRow.rowFormat.height):[i].length<=1&&"AtLeast"===t.associatedCell.ownerRow.rowFormat.heightType?i.height=Math.max(j.convertPointToPixel(t.associatedCell.ownerRow.rowFormat.height),this.getCellContentHeight(i,!1,t.indexInOwner)):i.height=i.height+t.height,t.containerWidget=i}else(!t.isEndsWithPageBreak&&!t.isEndsWithColumnBreak||e instanceof Wd)&&(t.height=e.clientActiveArea.y-t.y);this.isRelayoutFootnote&&t.bodyWidget instanceof q&&(t.isInsideTable||(t.containerWidget.height+=t.height),this.shiftFootnoteChildLocation(t.bodyWidget,this.viewer)),t.bodyWidget instanceof Xd&&(t.isInsideTable||(t.containerWidget.height+=t.height),this.viewer.owner.enableHeaderAndFooter)&&-1!==t.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(t.bodyWidget,this.viewer),e instanceof Wd&&t.containerWidget instanceof z&&(t.containerWidget.height+=t.height)},t.prototype.shiftFooterChildLocation=function(e,t){var i,n,r=e.page.bodyWidgets[0].sectionFormat.pageHeight;-1!==e.headerFooterType.indexOf("Footer")&&(i=e.page.bodyWidgets[0].sectionFormat.footerDistance,r=j.convertPointToPixel(r-i),e.y+e.height>r?n=r-(e.y+e.height):e.y+e.height<r&&(n=e.y+e.height-r),_.isNullOrUndefined(n)||(n=r-(e.y+e.height),this.shiftChildLocation(n,e),t.clientActiveArea.y+=n))},t.prototype.shiftFootnoteChildLocation=function(e,t){var i,n=e.page.bodyWidgets[0].sectionFormat.pageHeight,r=(e.page.bodyWidgets[0].sectionFormat.footerDistance,e.page.bodyWidgets[0].sectionFormat.bottomMargin),n=j.convertPointToPixel(n-r);e.y+e.height>n?i=n-(e.y+e.height):e.y+e.height<n&&(i=e.y+e.height-n),_.isNullOrUndefined(i)||(i=n-(e.y+e.height),this.shiftChildLocation(i,e),t.clientActiveArea.y+=i)},t.prototype.checkPreviousElement=function(e,t){for(var i=e.paragraph,n=!1,r=0,o=t-1;0<=o;o--){var s=e.children[o];if(s instanceof X&&0<s.width){var a=s.text,r=o;if(0<a.length&&(" "===a[a.length-1]||"-"===a[a.length-1])){if(o===t-1)return this.addSplittedLineWidget(e,t-1),!0;n=!0;break}if("\t"===a||this.documentHelper.textHelper.isUnicodeText(a,s.scriptType))return!1;if(0<=a.indexOf(" ")){var n=!0,l=a.lastIndexOf(" ")+1,d=new X;d.text=a.substr(l),d.characterFormat.copyFormat(s.characterFormat),d.characterRange=s.characterRange,0<s.revisions.length&&(this.updateRevisionForSplittedElement(s,d,0<l),d.isMarkedForRevision=s.isMarkedForRevision),s.text=a.substr(0,l),this.documentHelper.textHelper.getTextSize(d,s.characterFormat),s.width-=d.width," "===s.text[s.text.length-1]?s.trimEndWidth=this.documentHelper.textHelper.getWidth(j.trimEnd(s.text),s.characterFormat,s.scriptType):s.trimEndWidth=s.width,s.height=d.height,0===s.width&&(e.children.splice(o,1),!_.isNullOrUndefined(e.layoutedElements))&&0<e.layoutedElements.length&&e.layoutedElements.splice(o,1),e.children.splice(o+1,0,d),_.isNullOrUndefined(e.layoutedElements)||e.layoutedElements.splice(o+1,0,d);break}}else if(!(s instanceof Y||s instanceof Z||s instanceof X&&0===s.width||s instanceof up||s instanceof E)){r=o,n=!0;break}}if(n&&++r<e.children.length){for(var h=0,o=r;o<e.children.length;o++)h+=e.children[o].width,this.addSplittedLineWidget(e,o-1),o--;"Justify"===i.paragraphFormat.textAlignment&&"Word2013"===this.documentHelper.compatibilityMode||this.viewer.updateClientWidth(h)}return n},t.prototype.clearListElementBox=function(e){if(0!==e.childWidgets.length){var t=e.childWidgets[0];if(!_.isNullOrUndefined(t.children)){for(var i=t.children.length-1;0<i&&t.children[i]instanceof Y;i--)t.children.splice(i,1);for(i=0;i<t.children.length&&t.children[i]instanceof Y;i++)t.children.splice(i,1),i--}}},t.prototype.clearInvalidList=function(e){e&&(-1===e.abstractListId&&-1!==this.documentHelper.abstractLists.indexOf(e.abstractList)&&this.documentHelper.abstractLists.splice(this.documentHelper.abstractLists.indexOf(e.abstractList),1),-1===e.listId)&&-1!==this.documentHelper.lists.indexOf(e)&&this.documentHelper.lists.splice(this.documentHelper.lists.indexOf(e),1)},t.prototype.getListNumber=function(e,t){var i,n=this.documentHelper.getListById(e.listId),r=e.listLevelNumber,e=this.getListLevel(n,e.listLevelNumber),o=_.isNullOrUndefined(n.levelOverrides)?void 0:n.levelOverrides[r];return!_.isNullOrUndefined(o)&&-1===this.documentHelper.renderedLevelOverrides.indexOf(o)&&_.isNullOrUndefined(o.overrideListLevel)&&(this.documentHelper.renderedLevelOverrides.push(o),o=this.documentHelper.getAbstractListById(n.abstractListId),this.documentHelper.renderedLists.containsKey(o))&&(i=this.documentHelper.renderedLists.get(o)).containsKey(r)&&(i.remove(r),this.ClearSubListLevelValues(n,o,r)),_.isNullOrUndefined(t)&&this.updateListValues(n,r),this.getListText(n,r,e)},t.prototype.ClearSubListLevelValues=function(e,t,i){for(var n=this.documentHelper.renderedLists.get(t),r=i+1;r<t.levels.length;){var o=this.getListLevel(e,r);n.containsKey(r)&&o.restartLevel>i&&n.remove(r),r++}},t.prototype.getListStartValue=function(e,t){var i=_.isNullOrUndefined(t.levelOverrides)?void 0:t.levelOverrides[e];return(_.isNullOrUndefined(i)||!_.isNullOrUndefined(i.overrideListLevel))&&(i=this.getListLevel(t,e),_.isNullOrUndefined(i))?0:i.startAt},t.prototype.updateListValues=function(e,t){var i=this.documentHelper.getAbstractListById(e.abstractListId),n=this.getListLevel(e,t);if(this.documentHelper.renderedLists.containsKey(i)){var r=this.documentHelper.renderedLists.get(i);if(r.containsKey(t))for(var o=r.get(t),s=(r.set(t,o+1),t+1);s<this.documentHelper.getAbstractListById(e.abstractListId).levels.length;){l=this.getListLevel(e,s);r.containsKey(s)&&(l.restartLevel>t||"Bullet"===n.listLevelPattern)&&r.remove(s),s++}else{for(s=t;!r.containsKey(s-1)&&0<s;){l=this.getListLevel(e,s-1);r.add(s-1,this.getListStartValue(s-1,e)),s--}o=this.getListStartValue(t,e);r.add(t,o)}}else for(var a=new T,l=(this.documentHelper.renderedLists.add(i,a),this.getListLevel(e,t)),d=0;d<=t;d++)a.add(d,this.getListStartValue(d,e))},t.prototype.getListText=function(e,t,i){var n=i.numberFormat;if(this.documentHelper.renderedLists.containsKey(this.documentHelper.getAbstractListById(e.abstractListId)))for(var r=this.documentHelper.renderedLists.get(this.documentHelper.getAbstractListById(e.abstractListId)),o=r.keys,s=0;s<o.length;s++){var a=o[s],l="%"+(a+1).toString(),d=this.getListLevel(e,a),h=s<t?"LeadingZero"!==d.listLevelPattern?"Arabic":d.listLevelPattern:void 0;if(n.match(l)){if(t<a)return"";n=r.containsKey(a)&&!_.isNullOrUndefined(d)?n.replace(l,this.getListTextListLevel(d,r.get(a),i.isLegalStyleNumbering?h:void 0)):n.replace(l,"0")}}return n},t.prototype.getAsLetter=function(e){for(var t=e/26,e=e%26,i=(0===e&&(e=26,t--),String.fromCharCode(64+e)),n="";0<=t;)n+=i.toString(),t--;return n},t.prototype.getListTextListLevel=function(e,t,i){switch(_.isNullOrUndefined(i)?e.listLevelPattern:i){case"UpRoman":return this.getAsRoman(t).toUpperCase();case"LowRoman":return this.getAsRoman(t).toLowerCase();case"UpLetter":return this.getAsLetter(t).toUpperCase();case"LowLetter":return this.getAsLetter(t).toLowerCase();case"Arabic":return t.toString();case"LeadingZero":return this.getAsLeadingZero(t);case"Number":return t.toString();case"OrdinalText":return(3082===e.characterFormat.localeIdAscii||3082===this.documentHelper.characterFormat.localeIdAscii?this.getOrdinalTextInSpanish(!0,t.toString()):this.getOrdinalText(!0,t.toString())).toUpperCase();case"Ordinal":return this.getAsOrdinal(t,e.characterFormat).toString();case"FarEast":case"Special":return t.toString();default:return""}},t.prototype.getFootEndNote=function(e,t){switch(e){case"UpperCaseRoman":return this.getAsRoman(t).toUpperCase();case"LowerCaseRoman":return this.getAsRoman(t).toLowerCase();case"UpperCaseLetter":return this.getAsLetter(t).toUpperCase();case"LowerCaseLetter":return this.getAsLetter(t).toLowerCase();default:return t.toString()}},t.prototype.generateNumber=function(e,t,i){for(var n="";t<=e;)n+=i,this.value=e-=t;return n.toString()},t.prototype.getAsLeadingZero=function(e){return e<10?"0"+e.toString():e.toString()},t.prototype.getAsRoman=function(e){var t="";return this.value=e,(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t+=this.generateNumber(this.value,1e3,"M"))+this.generateNumber(this.value,900,"CM"))+this.generateNumber(this.value,500,"D"))+this.generateNumber(this.value,400,"CD"))+this.generateNumber(this.value,100,"C"))+this.generateNumber(this.value,90,"XC"))+this.generateNumber(this.value,50,"L"))+this.generateNumber(this.value,40,"XL"))+this.generateNumber(this.value,10,"X"))+this.generateNumber(this.value,9,"IX"))+this.generateNumber(this.value,5,"V"))+this.generateNumber(this.value,4,"IV"))+this.generateNumber(this.value,1,"I")).toString()},t.prototype.getOrdinalText=function(e,t){if(e){t=t.trim();for(var i=0;i<t.length;i++)if(/[a-zA-Z]/.test(t.charAt(i))){e=!1;break}e&&(t=this.numberToWords(parseInt(t),!1))}return t},t.prototype.numberToWords=function(e,t){var i,n;return 0===e?"zero":(i="",0<Math.floor(e/1e6)&&(i+=this.numberToWords(Math.floor(e/1e6),t)+" million ",t||e%10!=0||(i+="th "),e%=1e6),0<Math.floor(e/1e3)&&(i+=this.numberToWords(Math.floor(e/1e3),t)+" thousand ",t||e%10!=0||(i+="th "),e%=1e3),0<Math.floor(e/100)&&(i+=this.numberToWords(Math.floor(e/100),t)+" hundred ",t||e%10!=0||(i+="th "),e%=100),0<e&&(""!==i&&t&&(i+="and "),n=null,n=t?["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"]:["","first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth","eleventh","twelfth","thirteenth","fourteenth","fifteenth","sixteenth","seventeenth","eighteenth","nineteenth"],e<20?i+=n[e]:((t||0<e%10)&&(i+=["","ten","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"][Math.floor(e/10)]),e%10!=0||t?0<e%10&&(i+="-"+n[e%10]):i+=["","tenth","twentieth","thirtieth","fortieth","fiftieth","sixtieth","seventieth","eightieth","ninetieth"][Math.floor(e/10)])),i)},t.prototype.getOrdinalTextInSpanish=function(e,t){if(e){t=t.trim();for(var i=0;i<t.length;i++)if(/[a-zA-Z]/.test(t.charAt(i))){e=!1;break}e&&(t=this.numberToSpanishWords(parseInt(t),!1))}return t},t.prototype.numberToSpanishWords=function(e,t){var i,n,r,o;return 0===e&&t?"cero":(i="",0<Math.floor(e/1e3)&&e<=1e4&&(i+=(t?["","mil","dos mil","tres mil","cuatro mil","cinco mil","seis mil","siete mil","ocho mil","nueve mil","diez mil"]:["","milésimo","dosmilésimo","tresmilésimo","cuatromilésimo","cincomilésimo","seismilésimo","sietemilésimo","ochomilésimo","nuevemilésimo","diezmilésimo"])[Math.floor(e/1e3)],e%=1e3),0<Math.floor(e/100)&&(""!==i&&(i+=" "),i+=(t?["","ciento","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"]:["","centésimo","ducentésimo","tricentésimo","cuadringentésimo","quingentésimo","sexcentésimo","septingentésimo","octingentésimo","noningentésimo"])[Math.floor(e/100)],e%=100),0<e&&e<100&&(""!==i&&(i+=" "),n=null,n=t?["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciséis","diecisiete","dieciocho","diecinueve"]:["","primero","segundo","tercero","cuarto","quinto","sexto","séptimo","octavo","noveno","décimo","undécimo","duodécimo","decimotercero","decimocuarto","decimoquinto","decimosexto","decimoséptimo","decimoctavo","decimonoveno"],r=["","diez","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],o=["","décimo","vigésimo","trigésimo","cuadragésimo","quincuagésimo","sexagésimo","septuagésimo","octogésimo","nonagésimo"],e<20?i+=n[e]:20<e&&e<30&&t?i+=["","veintiuno","veintidós","veintitrés","veinticuatro","veinticinco","veintiséis","veintisiete","veintiocho","veintinueve"][e%10]:((t&&0<e%10||t&&e%10==0)&&(i+=r[Math.floor(e/10)]),0<e%10&&!t&&(i+=o[Math.floor(e/10)]),e%10!=0||t?0<e%10&&(i+=t?" y "+n[e%10]:" "+n[e%10]):i+=o[Math.floor(e/10)])),i)},t.prototype.getAsOrdinal=function(e,t){switch(t.localeIdAscii){case 1069:case 8218:case 5146:case 4122:case 1050:case 1029:case 1061:case 1035:case 3079:case 1031:case 5127:case 4103:case 2055:case 1038:case 1060:case 1055:case 1044:case 2068:case 1045:case 6170:case 2074:return e.toString()+".";case 2060:case 11276:case 3084:case 9228:case 12300:case 1036:case 15372:case 5132:case 13324:case 6156:case 14348:case 8204:case 10252:case 4108:return 1==e?e.toString()+"er":e.toString()+"e";case 2067:case 1043:return e.toString()+"e";case 1032:return e.toString()+"o";case 1040:case 2064:return e.toString()+String.fromCharCode(176);case 5130:case 7178:case 12298:case 17418:case 4106:case 1046:case 2070:case 11274:case 16394:case 13322:case 9226:case 18442:case 2058:case 19466:case 6154:case 15370:case 10250:case 20490:case 3082:case 1034:case 21514:case 14346:case 8202:return e.toString()+String.fromCharCode(186);case 1049:case 2073:return e.toString()+"-"+String.fromCharCode(1081);case 2077:case 1053:return this.getOrdinalInSwedish(e);case 1027:return this.getOrdinalInCatalan(e);case 1030:return this.getOrdinalInDanish(e);default:return this.getOrdinalInEnglish(e)}},t.prototype.getOrdinalInEnglish=function(e){switch(e%100){case 11:case 12:case 13:return e.toString()+"th"}switch(e%10){case 1:return e.toString()+"st";case 2:return e.toString()+"nd";case 3:return e.toString()+"rd";default:return e.toString()+"th"}},t.prototype.getOrdinalInSwedish=function(e){return 11!=e&&12!=e&&(e%10==1||e%10==2)?e.toString()+":a":e.toString()+":e"},t.prototype.getOrdinalInCatalan=function(e){switch(e){case 1:return e.toString()+".";case 2:return e.toString()+"n";case 3:return e.toString()+"r";case 4:return e.toString()+"t";case 14:return e.toString()+String.fromCharCode(232)+"h";default:return e.toString()+String.fromCharCode(232)}},t.prototype.getOrdinalInDanish=function(e){if(0==e)return e.toString()+"te";switch(e%100){case 0:return e.toString()+"ende";case 1:return e.toString()+"ste";case 2:return e.toString()+"nden";case 3:return e.toString()+"dje";case 4:return e.toString()+"rde";case 5:case 6:case 11:case 12:case 30:return e.toString()+"te";default:return e.toString()+"nde"}},t.prototype.getListLevel=function(e,t){if(!_.isNullOrUndefined(e)){var i=this.documentHelper.getAbstractListById(e.abstractListId),n=(!_.isNullOrUndefined(e)&&i.levels.length<=t&&0<=t&&t<9&&this.addListLevels(i),void 0);if(!_.isNullOrUndefined(e.levelOverrides)&&!_.isNullOrUndefined(n=this.getOverrideListLevel(e.levelOverrides,t))&&!_.isNullOrUndefined(n.overrideListLevel))return _.isNullOrUndefined(n.startAt)&&(n.overrideListLevel.startAt=i.levels[t].startAt),n.overrideListLevel;if(!_.isNullOrUndefined(i)&&0<=t&&t<i.levels.length)return i.levels[t]}},t.prototype.getOverrideListLevel=function(e,t){for(var i=0;i<e.length;i++)if(e[i].levelNumber==t)return e[i]},t.prototype.getTabWidth=function(e,t,i,n,r){var o=0,s=!1,a=e.paragraphFormat.getUpdatedTabs(),l=!1,d=e.bodyWidget.sectionFormat,h=(j.convertPointToPixel(d.leftMargin),!1),d=(_.isNullOrUndefined(e.paragraphFormat.listFormat.listLevel)||_.isNullOrUndefined(e.paragraphFormat.listFormat.listLevel.paragraphFormat)||(d=e.paragraphFormat.listFormat.listLevel.paragraphFormat,e.paragraphFormat.leftIndent!==d.leftIndent&&(l=!0)),0),c=t.clientActiveArea.x,p=j.convertPointToPixel(e.paragraphFormat.firstLineIndent),u=j.convertPointToPixel(e.paragraphFormat.leftIndent);if(!_.isNullOrUndefined(r)&&n.isFirstLine()?(d=this.viewer.clientArea.x+p,l&&(c+=p)):d=this.viewer.clientArea.x,c<d&&("Word2003"!==this.documentHelper.compatibilityMode||0===a.length))return t.clientArea.x-t.clientActiveArea.x;for(var g=t.clientActiveArea.x-(t.clientArea.x-j.convertPointToPixel(e.paragraphFormat.leftIndent)),m=0;m<a.length;m++){var f=a[m],y=j.convertPointToPixel(f.position);y<u&&(h=parseFloat(g.toFixed(2))<parseFloat(y.toFixed(2)))}if(n.isFirstLine()&&0<u&&p<0&&(r instanceof Y||!h)){if(0<t.clientArea.x-t.clientActiveArea.x)return t.clientArea.x-t.clientActiveArea.x;0===a.length&&e.paragraphFormat.listFormat&&e.paragraphFormat.listFormat.listLevel&&(a=e.paragraphFormat.listFormat.listLevel.paragraphFormat.tabs)}var v=j.convertPointToPixel(this.documentHelper.defaultTabWidth);if(0===a.length&&(0<g&&v>Math.round(g)&&l||v===this.defaultTabWidthPixel&&v>Math.round(g)))return v-g;var w=!1;if(0<a.length){for(m=a.length-1;-1<m;m--){var f=a[m],b=j.convertPointToPixel(f.position);if(!(parseFloat(b.toFixed(2))>parseFloat(g.toFixed(2))||0<m&&j.convertPointToPixel(a[m-1].position)>parseFloat(g.toFixed(2)))){m!=a.length-1&&(v=(b=this.getJustificationTabWidth(a[m+1],r,n,e,v,g,o)).defaultTabWidth,o=b.fPosition,g=b.position,s=!0),w=!0;break}}w||(v=(c=this.getJustificationTabWidth(a[0],r,n,e,v,g,o)).defaultTabWidth,o=c.fPosition,g=c.position,s=!0)}return s||(o=(1+(g-parseFloat((100*g%(100*v)/100).toFixed(2)))/v)*v),parseFloat(o.toFixed(1))!==parseFloat(g.toFixed(1))&&0<o-g?o-g:v},t.prototype.getJustificationTabWidth=function(e,t,i,n,r,o,s){var a,l,d=t?this.documentHelper.textHelper.getTextSize(t,t.characterFormat):0;return s="Left"===e.tabJustification||"List"===e.tabJustification?j.convertPointToPixel(e.position):(a=j.convertPointToPixel(e.position)-o,(i=this.getRightTabWidth(t.indexInOwner+1,i,n))<a&&"Decimal"!=e.tabJustification?"Right"===e.tabJustification?(r=a-i,n=j.convertPointToPixel(n.rightIndent),l=this.viewer.clientActiveArea.width+n-r,this.viewer.clientActiveArea.width+=n,l<0?r+=l-i:l<i&&(r-=i-l)):r=a-i/2:r="Center"===e.tabJustification&&i/2<a?a-i/2:"Decimal"===e.tabJustification?!_.isNullOrUndefined(t.nextElement)&&t.nextElement instanceof X?-1!=(n=t.nextElement).text.indexOf(".")?(l=n.text.indexOf("."),l=n.text.substring(0,l),a-this.documentHelper.textHelper.getWidth(l,n.characterFormat,n.scriptType)):i<a?a-i:a:a:"Right"===e.tabJustification?0:d,o),t instanceof _h&&(t.tabLeader=e.tabLeader,t.tabText=""),{defaultTabWidth:r,fPosition:s,position:o}},t.prototype.getRightTabWidth=function(e,t,i){for(var n,r=0,o=!1,s=t.children[e];s;){if(s instanceof Z||s instanceof J||o?(s instanceof Z&&(0===s.fieldType?o=!0:2===s.fieldType&&(o=!1)),s.width=0):(s instanceof Vh&&!this.isTocField(s.fieldBegin)&&""!==(n=this.documentHelper.getFieldResult(s.fieldBegin,s.paragraph.bodyWidget.page))&&(s.text=n),s instanceof X&&this.documentHelper.textHelper.getTextSize(s,s.characterFormat)),s instanceof X&&"\t"===s.text)return r;r+=s.width,s=s.nextNode}return r},t.prototype.getSplitIndexByWord=function(e,t,i,n,r){for(var o=0,s=t.length;o<s;){var a=this.getTextIndexAfterSpace(t,o),l=i;if(!((l=((a=0!==a&&a!==s?a:s-1)<s-1||a===s-1&&" "===t[a-1])&&o!==a?this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(t.slice(0,a),n,r):l)<=e)){0===o&&" "===t[0]&&(o=this.getTextIndexAfterSpace(t,0));break}o=a}return o},t.prototype.getTextSplitIndexByCharacter=function(e,t,i,n,r,o){for(var s=i.length,a=0;a<s;a++){var l=n;if(t<(l=a+1<s?this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,a+1),r,o):l))return 0===a&&e<l?1<s&&" "===i[1]?this.getTextIndexAfterSpace(i,1):1:" "===i[a]?this.getTextIndexAfterSpace(i,a):a}return 0},t.prototype.getSubWidth=function(e,t,i,n,r){var o=0,s=!0,a="",l=0,d=e.paragraph.paragraphFormat.bidi;if(0<this.wrapPosition.length){var h=this.getSubWidthBasedOnTextWrap(e,t,i,n,r);if(0<h.length)return h}for(var c=e.renderedElements,p=c.length-1;0<=p;p--){var u=c[p];if(0<u.width&&u instanceof X){var g=u.text,a=g+a;!(s=t&&d?" "===g&&0<=p-1&&" "===c[p-1].text:s)||""===g.trim()&&"\t"!==g?s?l+=u.width:o+=u.width:(j.endsWith(g)?(o+=g=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(g,u.characterFormat,u.scriptType),l+=u.width-g):o+=u.width,s=!1)}else{if(a="a"+a,s=!1,u instanceof hc&&"Inline"!==u.textWrappingStyle)continue;o+=u.width}t||(o=Math.round(o))}h=a.length-j.removeSpace(a).length,i=(a=a.trim()).length-j.removeSpace(a).length,e=this.viewer.clientArea.width-n-o,n=this.viewer.clientArea.width-n-(o+l);return d&&t&&(n<0?l=-l:e=n),e<=0&&!this.is2013Justification||0===i&&t&&!d?e=i=0:t?!r&&0<i||r&&this.is2013Justification&&0<i?e/=i:i=0:0<l&&d&&r&&(e-=l),[{trimmedSpaceWidth:l,subWidth:e,spaceCount:i,totalSpaceCount:h}]},t.prototype.getSubWidthBasedOnTextWrap=function(e,t,i,n,r){for(var o=[],s=0,a="",l=this.wrapPosition.length-1,d=!0,h=e.children.length-1;0<=h;h--){var c=e.children[h];if(0<c.width&&c instanceof X?(a=(u=c.text)+a,!d||""===u.trim()&&"\t"!==u?d||(s+=c.width):(j.endsWith(u)?s+=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(u,c.characterFormat,c.scriptType):s+=c.width,d=!1)):(a="a"+a,d=!1,c instanceof hc&&"Inline"!==c.textWrappingStyle||(s+=c.width)),(0<c.padding.left||0===h)&&0<=l){for(var p=this.wrapPosition[l--];p.width<=0&&0<=l;)p=this.wrapPosition[l--];var u=this.getSubWidthInfo(e,p.width,s,a,i,t,r);_.isNullOrUndefined(u)||(s=0,a="",o.unshift(u))}}return o},t.prototype.isWordFittedByJustification=function(e,t){var e=e.line,i=e.paragraph.paragraphFormat,n=i.textAlignment,r=e.isLastLine(),o=0,s=(e.isFirstLine()&&(o=j.convertPointToPixel(i.firstLineIndent)),this.viewer.clientActiveArea.width);if(0!=t&&t/2<=s){var a=void 0,l=0;if("Left"!==n&&this.viewer.textWrap&&("Justify"!==n||!r||"Justify"===n&&i.bidi||this.is2013Justification&&r)&&((a=this.getSubWidth(e,"Justify"===n,0,o,r))[0].spaceCount,l=a[0].totalSpaceCount),!_.isNullOrUndefined(a)&&1==a.length&&0<s&&"Justify"===n&&"Word2013"===this.documentHelper.compatibilityMode&&!this.is2013Justification&&0===i.rightIndent&&0===i.leftIndent){o=0,r=this.getTotalSpaceWidth(e,l),a=r/l;if(t<=s+(o=((s+r)/l-a)/a*100<=33?r/8:r/4))return this.viewer.clientActiveArea.x-=o,this.viewer.clientActiveArea.width+=o,this.is2013Justification=!0}}return!1},t.prototype.getTotalSpaceWidth=function(e,t){var i=0,n=0;if(e)for(var r=0;r<e.children.length;r++){var o,s=e.children[r];if(s instanceof X&&0<(o=s.text.length-j.removeSpace(s.text).length)&&(i+=o*this.documentHelper.textHelper.getWidth(" ",s.characterFormat,s.scriptType),n+=o),!_.isNullOrUndefined(t)&&t<=n)break}return i},t.prototype.getSubWidthInfo=function(e,t,i,n,r,o,s){if(0<t)return t=t-i,r=(n=n.trim()).length-j.removeSpace(n).length,(i=t)<=0||0===r&&o&&!e.paragraph.paragraphFormat.bidi?i=r=0:o&&(!s&&0<r?i/=r:r=0),{trimmedSpaceWidth:0,subWidth:i,spaceCount:r,totalSpaceCount:r}},t.prototype.getBeforeSpacing=function(e,t){var i,n,r,o=0;return this.documentHelper.dontUseHtmlParagraphAutoSpacing?o=e.paragraphFormat.beforeSpacing:(i=e.previousWidget)instanceof G?(n=this.getAfterSpacing(i),r=e.paragraphFormat.beforeSpacing,n<(r=e.paragraphFormat.spaceBeforeAuto?14:r)&&(o=r-n)):i instanceof K?o=e.paragraphFormat.spaceBeforeAuto?14:e.paragraphFormat.beforeSpacing:0<t&&e===e.bodyWidget.childWidgets[0]?this.documentHelper.pages[t].sectionIndex!==this.documentHelper.pages[t-1].sectionIndex&&(o=e.paragraphFormat.spaceBeforeAuto?14:e.paragraphFormat.beforeSpacing):o=e.paragraphFormat.spaceBeforeAuto?0:e.paragraphFormat.beforeSpacing,this.isSameStyle(e,!1)?0:j.convertPointToPixel(o)},t.prototype.getAfterSpacing=function(e){var t=e.paragraphFormat.afterSpacing;return!this.documentHelper.dontUseHtmlParagraphAutoSpacing&&e.paragraphFormat.spaceAfterAuto&&(t=_.isNullOrUndefined(e.nextWidget)&&e.isInsideTable?0:14),this.isSameStyle(e,!0)?0:t},t.prototype.getLineSpacing=function(e,t,i){if(_.isNullOrUndefined(e.paragraphFormat))return 0;var n=0;switch(e.paragraphFormat.lineSpacingType){case"AtLeast":case"Exactly":n=j.convertPointToPixel(e.paragraphFormat.lineSpacing);break;default:n=e.paragraphFormat.lineSpacing,i&&(n-=1),n*=t}return n},t.prototype.isParagraphFirstLine=function(e,t){var i=e;return!(!_.isNullOrUndefined(i.childWidgets)&&0!==i.childWidgets.indexOf(t)||0<t.children.length&&!_.isNullOrUndefined(e.previousWidget)&&e.previousWidget instanceof G&&t.paragraph.index===e.previousWidget.index)},t.prototype.isParagraphLastLine=function(e){var t=e.line.paragraph,t=t.childWidgets[t.childWidgets.length-1],t=t.children[t.children.length-1];return e===t&&(t instanceof Z||!(t instanceof X&&"\v"===t.text))},t.prototype.getTextIndexAfterSpace=function(e,t){var i=e.length,n=0,r=0,n=e.indexOf(" ",t)+1,o=(0<(r=1==(r=e.indexOf("-",t)+1)?e.indexOf("-",r+1)+1:r)&&0<n?n=Math.min(n,r):0<r&&0==n&&(n=r),n);if(0!==o&&o!==i)for(;" "===e[o]&&++o!==i;);return o},t.prototype.moveNextWidgetsToTable=function(e,t,i){for(var n=t.indexInOwner,r=e[e.length-1],o=(i&&(n+=1),t.containerWidget.childWidgets.splice(n)),s=0;s<o.length;s++)r.childWidgets.push(o[s]),o[s].containerWidget=r},t.prototype.addTableCellWidget=function(e,t,i,n){var r=0,o=0,s=0,o=(_.isNullOrUndefined(e.cellFormat)||(s=e.cellFormat.containsMargins()?(o=_.isNullOrUndefined(e.cellFormat.leftMargin)?j.convertPointToPixel(e.ownerTable.tableFormat.leftMargin):j.convertPointToPixel(e.cellFormat.leftMargin),_.isNullOrUndefined(e.cellFormat.rightMargin)?j.convertPointToPixel(e.ownerTable.tableFormat.rightMargin):j.convertPointToPixel(e.cellFormat.rightMargin)):(o=0===e.columnIndex&&e.ownerRow.rowFormat.hasValue("leftMargin")?j.convertPointToPixel(e.ownerRow.rowFormat.leftMargin):j.convertPointToPixel(e.ownerTable.tableFormat.leftMargin),e.columnIndex===e.ownerTable.tableHolder.columns.length-1&&e.ownerRow.rowFormat.hasValue("rightMargin")?j.convertPointToPixel(e.ownerRow.rowFormat.rightMargin):j.convertPointToPixel(e.ownerTable.tableFormat.rightMargin))),e.margin=new Dd(o,i,s,n),e.ownerTable.tableFormat.allowAutoFit,e.cellFormat.cellWidth),n=("Percent"===e.cellFormat.preferredWidthType&&0!==e.cellFormat.preferredWidth&&o<=0&&(i=j.convertPointToPixel(e.ownerTable.getTableClientWidth(e.ownerTable.getContainerWidth())),o=e.ownerTable.getCellWidth(e.cellFormat.preferredWidth,e.cellFormat.preferredWidthType,i,e)),e.width=j.convertPointToPixel(o),_.isNullOrUndefined(e.previousWidget)||(r=e.previousWidget.columnIndex+e.previousWidget.cellFormat.columnSpan),s=_.isNullOrUndefined(e.ownerTable)||_.isNullOrUndefined(e.ownerTable.tableFormat)?0:j.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing),0),i=(r<e.columnIndex&&(n=j.convertPointToPixel(e.ownerTable.tableHolder.getPreviousSpannedCellWidth(r,e.columnIndex)),0===r)&&(n-=s/2),e.x=t.x+n+e.margin.left,e.y=t.y+e.margin.top+s,e.width=e.width-e.margin.left-e.margin.right,0<s&&(e.x+=s,1===e.ownerTable.tableHolder.columns.length?e.width-=2*s:0===e.columnIndex||e.columnIndex===e.ownerTable.tableHolder.columns.length-1?e.width-=2*s-s/2:e.width-=s),j.convertPointToPixel(N.getCellLeftBorder(e).getLineWidth())),o=j.convertPointToPixel(N.getCellRightBorder(e).getLineWidth()),r=!1,n=(e.leftBorderWidth=e.ownerTable.isBidiTable?o:i,"None"===e.cellFormat.borders.left.lineStyle),t="None"===e.cellFormat.borders.right.lineStyle;e.x+=!n||0<e.leftBorderWidth?0:e.leftBorderWidth,e.width-=!n||0<e.leftBorderWidth?0:e.leftBorderWidth,e.ownerTable.isBidiTable?e.cellIndex:(e.cellIndex,e.ownerRow.childWidgets.length);return(0<s||e.columnIndex===e.ownerTable.tableHolder.columns.length-1||e.index===e.containerWidget.childWidgets.length-1)&&(e.rightBorderWidth=e.ownerTable.isBidiTable?i:o,e.ownerTable.tableFormat.allowAutoFit||(e.width-=e.rightBorderWidth),this.isInsertTable()||(r=this.checkPreviousMargins(e.ownerTable))),e.margin.right+=t&&!r?0:e.rightBorderWidth,e},t.prototype.checkPreviousMargins=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)if("None"!==i.childWidgets[i.childWidgets.length-1].cellFormat.borders.right.lineStyle)return!0;return!1},t.prototype.addWidgetToTable=function(e,t,i,n,r,o,s,a,l){var d=t[0],h=d.childWidgets.length,c=void 0,p=i.indexOf(n),u=[];if(0<p?c=i[p-1]:n.previousRenderedWidget instanceof dh&&n.previousRenderedWidget.ownerTable.equals(n.ownerTable)&&(c=n.previousRenderedWidget),_.isNullOrUndefined(c)||(h=(d=c.containerWidget).childWidgets.indexOf(c)+1,Math.round(n.y)!==Math.round(c.y+c.height)&&((c=t.indexOf(d))+1>=t.length&&this.addTableWidget(e.clientActiveArea,t,!0),h=(d=t[c+1]).childWidgets.length),0<p&&(h=0)),this.updateRowHeightBySpannedCell(d,n,h),this.updateRowHeightByCellSpacing(t,n,e),n.containerWidget&&n.containerWidget!==d&&-1!==n.containerWidget.childWidgets.indexOf(n)&&n.containerWidget.childWidgets.splice(n.containerWidget.childWidgets.indexOf(n),1),-1===d.childWidgets.indexOf(n)&&(d.childWidgets.splice(h,0,n),l)&&(d.bodyWidget.page.repeatHeaderRowTableWidget=!0),n.containerWidget=d,!n.ownerTable.isInsideTable){if(0<r.length)_.isNullOrUndefined(r)||(u=this.getFootnoteBody(r));else if(!_.isNullOrUndefined(n))for(var g=0;g<n.childWidgets.length;g++)for(var m=n.childWidgets[g],f=0;f<m.childWidgets.length;f++)for(var y=this.getFootNoteWidgetsOf(m.childWidgets[f],!0),v=0;v<y.length;v++)u.splice(u.length,0,y[v]);0<u.length&&_.isNullOrUndefined(u[0].containerWidget)?this.layoutFootnoteInSplittedRow(n,u):!_.isNullOrUndefined(u)&&0<u.length&&void 0!==n.bodyWidget.previousRenderedWidget&&a!==n.bodyWidget.page.index&&u[0].containerWidget.page.index!==n.bodyWidget.page.index?this.moveFootNotesToPage(u,u[0].containerWidget.page.bodyWidgets[0],n.bodyWidget):0<u.length&&!this.isInitialLoad&&!_.isNullOrUndefined(n.bodyWidget.page.footnoteWidget)&&this.layoutfootNote(n.bodyWidget.page.footnoteWidget),r.length=0}d.height=d.height+n.height,this.viewer instanceof Sd&&(_.isNullOrUndefined(d.containerWidget)||!(0<=d.containerWidget.childWidgets.indexOf(d))||d.containerWidget instanceof Xd||(d.containerWidget.height+=n.height)),this.updateHeightForRowWidget(e,!1,t,i,n,!1,o,s),e.cutFromTop(n.y+n.height),this.viewer.clientActiveArea.height-=this.getFootNoteHeight(u),this.existFootnoteHeight=0},t.prototype.layoutFootnoteInSplittedRow=function(e,t){if(t&&0<t.length){_.isNullOrUndefined(e.ownerTable.bodyWidget.page.footnoteWidget)&&this.addEmptyFootNoteToBody(e.ownerTable.bodyWidget);var i=e.ownerTable.bodyWidget.page.footnoteWidget;if(i){for(var n=0;n<t.length;n++)i.bodyWidgets.push(t[n]),t[n].containerWidget=i;this.layoutfootNote(i)}}},t.prototype.getFootNoteHeight=function(e){var t=0;if(Array.isArray(e))for(var i=0;i<e.length;i++)t+=this.getFootnoteHeightInternal(e[i]);else t=this.getFootnoteHeightInternal(e);return t},t.prototype.getFootnoteHeightInternal=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height,0===e.indexInOwner&&0===i&&(t+=e.containerWidget.margin.top);return t},t.prototype.updateRowHeightBySpannedCell=function(e,t,i){var n=1;if(0===e.childWidgets.length||0===i)this.updateRowHeight(t,t);else{for(var r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r],n=_.isNullOrUndefined(o)||_.isNullOrUndefined(o.cellFormat)?n:o.cellFormat.rowSpan;this.updateSpannedRowCollection(n,t,o)}if(!_.isNullOrUndefined(t.ownerTable))for(r=0;r<t.ownerTable.spannedRowCollection.length;r++)if(t.ownerTable.spannedRowCollection.keys[r]===t.index){for(var s=0;s<i;s++){var a=e.childWidgets[s];this.updateRowHeight(a,t)}t.ownerTable.spannedRowCollection.remove(t.ownerTable.spannedRowCollection.keys[r]);break}}},t.prototype.updateRowHeight=function(e,t){for(var i=t.index,n=1,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r],n=_.isNullOrUndefined(o)||_.isNullOrUndefined(o.cellFormat)?n:o.cellFormat.rowSpan;this.updateSpannedRowCollection(n,t,o),i-o.rowIndex==n-1&&(o=o.y+o.height+o.margin.bottom-t.y,"Exactly"!==t.rowFormat.heightType||"Exactly"===t.rowFormat.heightType&&t.rowFormat.height>o)&&t.height<o&&(t.height=o)}},t.prototype.updateSpannedRowCollection=function(e,t,i){1<e&&!_.isNullOrUndefined(t.ownerTable)&&(t.ownerTable.spannedRowCollection.containsKey(t.index+e-1)||t.ownerTable.spannedRowCollection.add(t.index+e-1,t.index))},t.prototype.updateRowHeightByCellSpacing=function(e,t,i){0<t.ownerTable.tableFormat.cellSpacing&&1<e.length&&t.y===i.clientArea.y&&i instanceof Sd&&(t.height=t.height-j.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing)/2)},t.prototype.isRowSpanEnd=function(e,t){for(var i=e.index,n=1,r=0;r<this.documentHelper.splittedCellWidgets.length;r++){var o=this.documentHelper.splittedCellWidgets[r],n=_.isNullOrUndefined(o)||_.isNullOrUndefined(o.cellFormat)?n:o.cellFormat.rowSpan;if(i-o.rowIndex==n-1)return!0}return!1},t.prototype.isVerticalMergedCellContinue=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];if(t<n.columnIndex)return!0;t+=n.cellFormat.columnSpan}return t<e.ownerTable.tableHolder.columns.length},t.prototype.splitWidgets=function(e,t,i,n,r,o,s,a,l,d,h){if((!d||0!==a)&&this.isFirstLineFitForRow(t.clientArea.bottom,e)&&0<e.childWidgets.length){if(r=this.getSplittedWidgetForRow(t.clientArea.bottom,i,n,e,s,a,d,void 0,h),0<this.documentHelper.splittedCellWidgets.length||r!==e){if(o)for(var c=0;c<r.childWidgets.length;c++)r.childWidgets[c].rowIndex!==r.index&&(r.childWidgets.splice(c,1),c--);this.insertSplittedCellWidgets(t,i,r,e.index-1)}}else this.insertSplittedCellWidgets(t,i,r,e.index-1);return r},t.prototype.getSplittedWidgetForRow=function(e,t,i,n,r,o,s,a,l){for(var d=void 0,h=n.index,c=this.isRelayoutneed=!1,p=n.height,u=p,g=0,m=0;m<n.childWidgets.length;m++){var f=n.childWidgets[m],y=this.getSplittedWidget(e,!0,t,i,f,r,o,s,a);if(s&&!_.isNullOrUndefined(y)&&0!==y.childWidgets.length&&p>f.height&&(p=f.height),r=[],_.isNullOrUndefined(y)&&f===n.childWidgets[n.childWidgets.length-1]&&this.isRowSpanEnd(n,this.viewer)&&0<this.documentHelper.splittedCellWidgets.length&&l&&(d=this.getSplittedWidgetForSpannedRow(e,n,t,i,r),y=void 0),!_.isNullOrUndefined(y)){if(y===f)return 1<i.length&&this.combineSplittedRowWidgets(i,u),n;f.height>g&&(g=f.height),-1!==n.childWidgets.indexOf(y)&&n.childWidgets.splice(n.childWidgets.indexOf(y),1),n.height-=y.height,(0===m||n.height<g+f.margin.top+f.margin.bottom)&&(n.height=g+f.margin.top+f.margin.bottom),_.isNullOrUndefined(d)&&((d=new dh).containerWidget=n.containerWidget,d.index=n.index,d.rowFormat=n.rowFormat,d.isRenderBookmarkEnd=n.isRenderBookmarkEnd,this.updateWidgetLocation(n,d),i.push(d));f=_.isNullOrUndefined(y)||_.isNullOrUndefined(y.cellFormat)?1:y.cellFormat.rowSpan;h-y.rowIndex==f-1&&d.height<y.height+y.margin.top+y.margin.bottom?d.height=y.height+y.margin.top+y.margin.bottom:("Exactly"===n.rowFormat.heightType||"AtLeast"===n.rowFormat.heightType&&d.height<n.rowFormat.height)&&(d.height=n.rowFormat.height),d.childWidgets.push(y),y.containerWidget=d,this.isRelayoutneed=!0;for(var v=m;0<v&&!c;){var w=n.childWidgets[v-1],y=this.getSplittedWidget(e,!0,t,i,w,r);d.childWidgets.splice(0,0,y),y.containerWidget=d,v--}c=!0}}if(s&&p!==u){for(m=0;m<n.childWidgets.length;m++)n.childWidgets[m].height=p;n.height=p}return d},t.prototype.combineSplittedRowWidgets=function(e,t){for(var i=e[0],n=1;n<e.length;n++){for(var r=e[n],o=0;o<r.childWidgets.length;o++){var s=i.childWidgets[o],a=r.childWidgets[o];if(0<a.childWidgets.length)for(var l=0;l<a.childWidgets.length;l++){var d=a.childWidgets[l];if(d instanceof G){var h=s.childWidgets[l];if(h.index===d.index){var c=d;if(0<c.childWidgets.length)for(var p=0;p<c.childWidgets.length;p++){var u=c.childWidgets[p];h.childWidgets.push(u),(u.paragraph=h).height+=u.height}}else s.childWidgets.push(d),d.containerWidget=s;s.height+=d.height}else d instanceof K&&(s.childWidgets.push(d),(d.containerWidget=s).height+=d.height)}}e.splice(n,1)}i.height=t},t.prototype.getSplittedWidgetForSpannedRow=function(e,t,i,n,r){for(var o=void 0,s=void 0,a=!1,l=!1,d=0;d<this.documentHelper.splittedCellWidgets.length;d++){var s=this.documentHelper.splittedCellWidgets[d],h=this.documentHelper.splittedCellWidgets[d+1],c=_.isNullOrUndefined(h)?0:h.columnIndex;if(t.childWidgets[t.childWidgets.length-1].columnIndex<s.columnIndex)break;for(var p=this.documentHelper.splittedCellWidgets[d].columnIndex,u=this.documentHelper.splittedCellWidgets[d];u&&u.cellFormat.rowSpan===this.documentHelper.splittedCellWidgets[d].cellFormat.rowSpan&&0<p&&!a;)p=u.columnIndex,u=(m=u.containerWidget).getCell(m.rowIndex,p-1);var g=this.documentHelper.splittedCellWidgets[d].columnIndex;for(u=this.documentHelper.splittedCellWidgets[d];u&&u.cellFormat.rowSpan===this.documentHelper.splittedCellWidgets[d].cellFormat.rowSpan&&g<u.containerWidget.childWidgets.length-1&&(!a||l);){var m,g=u.columnIndex;u=(m=u.containerWidget).getCell(m.rowIndex,g+1)}for(_.isNullOrUndefined(o)&&((o=new dh).containerWidget=t.containerWidget,o.index=t.index,o.rowFormat=t.rowFormat,o.isRenderBookmarkEnd=t.isRenderBookmarkEnd,this.updateWidgetLocation(t,o),n.push(o)),o.childWidgets.push(s),s.containerWidget=o,this.isRelayoutneed=!0;0<p&&!a;){var f=t.getCell(t.index,p-1);_.isNullOrUndefined(f)?p--:(s=this.getSplittedWidget(e,!0,i,n,f,r),o.childWidgets.splice(0,0,s),s.containerWidget=o,p--)}for(;g<t.childWidgets[t.childWidgets.length-1].columnIndex&&(!a||l);){f=t.getCell(t.index,g+1);if(_.isNullOrUndefined(f));else{if(h&&f.columnIndex>c){l=!0;break}s=this.getSplittedWidget(e,!0,i,n,f,r),o.childWidgets.push(s),s.containerWidget=o}g++}a=!0}return o},t.prototype.getFootNoteHeightInLine=function(e){for(var t=0,i=0;i<e.children.length;i++){var n=e.children[i];n instanceof Bh&&(t+=this.getFootNoteHeight(n.bodyWidget))}return t},t.prototype.getFootnoteFromLine=function(e,t){for(var i=0;i<e.children.length;i++)e.children[i]instanceof Bh&&t.push(e.children[i])},t.prototype.updateWidgetsToTable=function(e,t,i,R,n,r,o){for(var M=i.bodyWidget.page.index,s=this.getRowHeight(i,[i]),a=this.viewer,l=i.rowFormat.isHeader,d=i.rowFormat.allowBreakAcrossPages,h=i.rowFormat.heightType,c=0,p=i,u=!1,g=this.layoutedFootnoteElement,m=!1,f=(void 0!==p.bodyWidget.page.footnoteWidget?(this.footHeight=p.bodyWidget.page.footnoteWidget.height,0===this.footnoteHeight&&(this.footnoteHeight=this.footHeight)):this.footHeight=0,i.ownerTable.continueHeader&&!l&&(i.ownerTable.continueHeader=!1),i.ownerTable.isInsideTable),y=!1,v=_.isNullOrUndefined(i.ownerTable)||_.isNullOrUndefined(i.ownerTable.tableFormat)?0:j.convertPointToPixel(i.ownerTable.tableFormat.cellSpacing);c<t.length;){if(c=t.length,this.isRowSpanEnd(i,a)&&"Exactly"===i.rowFormat.heightType&&1===this.documentHelper.splittedCellWidgets.length&&(this.documentHelper.splittedCellWidgets=[]),!o&&(i.ownerTable.isInsideTable||0===this.documentHelper.splittedCellWidgets.length&&p.y+p.height+v+this.footHeight<=a.clientArea.bottom))!this.isVerticalMergedCellContinue(i)||p.y!==a.clientArea.y&&p.y!==this.viewer.clientArea.y+p.ownerTable.headerHeight||this.insertSplittedCellWidgets(a,e,p,p.index-1),this.addWidgetToTable(a,e,t,p,g,void 0,f,M,m),0<this.documentHelper.splittedCellWidgets.length&&_.isNullOrUndefined(t[t.length-1].nextRow)?(c--,y=!0):0<this.documentHelper.splittedCellWidgets.length&&!_.isNullOrUndefined(t[t.length-1].nextRow)&&!this.isRowSpanEnd(t[t.length-1].nextRow,a)&&c--,f=!1;else{g=[],f=!1;if(0<this.documentHelper.splittedCellWidgets.length&&p.y+p.height+this.footHeight<=a.clientArea.bottom)if(!this.isRowSpanEnd(i,a)){!this.isVerticalMergedCellContinue(i)||p.y!==a.clientArea.y&&p.y!==this.viewer.clientArea.y+p.ownerTable.headerHeight||this.insertSplittedCellWidgets(a,e,p,p.index-1),this.addWidgetToTable(a,e,t,p,g);continue}var w=p,b=e[e.length-1];if(o||s+p.y+this.footHeight>a.clientArea.bottom)if(!d||l&&i.ownerTable.continueHeader||"AtLeast"===h&&j.convertPointToPixel(i.rowFormat.height)<a.clientArea.bottom){var x=!d&&_.isNullOrUndefined(p.previousWidget)&&1<e.length;if(("AtLeast"===h&&j.convertPointToPixel(i.rowFormat.height)<a.clientActiveArea.height&&(d||x)||"Exactly"!==h&&p.y===a.clientArea.y||"Auto"===h&&d)&&(w=this.splitWidgets(p,a,e,t,w,y,g,n,r,o),_.isNullOrUndefined(w)&&p.y===a.clientArea.y?this.addWidgetToTable(a,e,t,p,g):_.isNullOrUndefined(w)&&"AtLeast"===h&&p.containerWidget.lastChild!==p&&(w=p)),"Exactly"===h&&p.y===a.clientArea.y&&(this.addWidgetToTable(a,e,t,p,g),c++),l&&i.ownerTable.continueHeader){i.ownerTable.header=!1;var C=void(i.ownerTable.headerHeight=0);if(a instanceof Sd&&(C=this.documentHelper.pages),!_.isNullOrUndefined(C))for(var I=0;I<C.length;I++)!C[I].repeatHeaderRowTableWidget||_.isNullOrUndefined(C[I].bodyWidgets[0].firstChild)||C[I].bodyWidgets[0].firstChild instanceof K&&C[I].bodyWidgets[0].firstChild.header||(C[I].repeatHeaderRowTableWidget=!1,i.ownerTable.continueHeader=!1)}}else if("Auto"!==h&&"AtLeast"!==h||!d)"Exactly"===h&&p.y===a.clientArea.y&&(this.addWidgetToTable(a,e,t,p,g),c++);else if(j.convertPointToPixel(i.rowFormat.height)>a.clientArea.bottom&&p.y!==a.clientArea.y){if("AtLeast"===h&&j.convertPointToPixel(i.rowFormat.height)>a.clientArea.bottom&&p.ownerTable.wrapTextAround&&p.y-j.convertPointToPixel(p.ownerTable.positioning.verticalPosition)===a.clientArea.y&&p.bodyWidget.firstChild===p.ownerTable&&(w=this.splitWidgets(p,a,e,t,w,y,g,n,r,o),_.isNullOrUndefined(w))){this.addWidgetToTable(a,e,t,p,g),c++;continue}}else w=this.splitWidgets(p,a,e,t,w,y,g,n,r,o),_.isNullOrUndefined(w)&&p.y===a.clientArea.y&&this.addWidgetToTable(a,e,t,p,g);else{var x=!1,k=0;if(_.isNullOrUndefined(p.ownerTable.headerHeight)||(k=p.ownerTable.headerHeight),this.isVerticalMergedCellContinue(i)&&(d||(x=p.y===a.clientArea.y||p.y===this.viewer.clientArea.y+k))){if(x)this.insertSplittedCellWidgets(a,e,w,p.indexInOwner-1);else if(w=this.splitWidgets(p,a,e,t,w,y,g,void 0,void 0,void 0,!0),_.isNullOrUndefined(w)){if(x=p.y===a.clientArea.y||p.y===this.viewer.clientArea.y+k){this.insertSplittedCellWidgets(a,e,p,p.indexInOwner-1),c--;continue}this.isRowSpanEnd(i,a)&&(w=p)}}else y&&!d?w=this.splitWidgets(p,a,e,t,w,y,g):this.isRowSpanEnd(i,a)&&!d&&("AtLeast"===h&&0<i.ownerTable.spannedRowCollection.keys.length&&(w=this.splitWidgets(p,a,e,t,w,y,g,n,r,o,!0)),_.isNullOrUndefined(w))&&this.addWidgetToTable(a,e,t,p,g)}if(!_.isNullOrUndefined(w)&&(_.isNullOrUndefined(this.documentHelper.owner.editorModule)||this.documentHelper.owner.editorModule&&!this.documentHelper.owner.editorModule.isTableInsert)&&!(w.bodyWidget.containerWidget instanceof q)){if(w!==p)this.addWidgetToTable(a,e,t,p,g,p.nextRow,void 0,void 0,m),this.updateWidgetsToPage(e,t,i.ownerTable,R,p.nextRow),e.indexOf(p.containerWidget)+1>=e.length&&this.addTableWidget(a.clientActiveArea,e,!0),p=w;else{if(0<i.index)this.updateWidgetsToPage(e,t,i.ownerTable,R,i),i.previousRenderedWidget instanceof dh&&(P=i.previousRenderedWidget,j.round(p.y,2)===j.round(P.y+P.height,2))&&!(e.indexOf(P.containerWidget)+1>=e.length)||this.addTableWidget(a.clientActiveArea,e,!0);else if("Exactly"===h&&s+p.y+this.footHeight<a.clientArea.bottom&&p.y>=a.clientArea.y){this.addWidgetToTable(a,e,t,p,g),c++;continue}u=!0,c--}var F,b=e[e.length-1],P=i,T=!1,S=(i.ownerTable.containerWidget.index,!1),H=void 0,N=void 0,W=(N=u&&1===e.length?e[e.length-1]:e[e.length-2],!0),O=(u&&1===t.length&&(O=this.alignBlockElement(i),_.isNullOrUndefined(O.node)||((F=O.node)instanceof dh&&0===F.indexInOwner?1<e.length&&0===e[e.length-1].childWidgets.length&&(e.pop(),(b=e[e.length-1]).height=0):O.node instanceof G&&(N=this.splitParagraph(O.node,parseInt(O.position.index,10)),1<e.length&&0===e[e.length-1].childWidgets.length&&(e.pop(),b=e[e.length-1]),W=!1),F instanceof dh&&(S=0===F.indexInOwner,(P=F).ownerTable.equals(i.ownerTable)||(N=P.ownerTable,W=!1)),T=!0)),H=this.moveBlocksToNextPage(!(N instanceof G)&&(!T||!S||_.isNullOrUndefined(N.previousWidget))?N:N.previousWidget,T),e[e.length-1]),S=(u&&W&&0===P.index&&O.containerWidget&&-1!==O.containerWidget.childWidgets.indexOf(O)&&O.containerWidget.childWidgets.splice(O.containerWidget.childWidgets.indexOf(O),1),W&&(-1!==H.childWidgets.indexOf(O)&&H.childWidgets.splice(H.childWidgets.indexOf(O),1),H.childWidgets.unshift(O),this.shiftFloatingItemsFromTable(O,H)),O.containerWidget=H,(u&&0<P.index||1<t.length)&&(F=u?t[t.length-1]:t[t.length-2],T&&(F=P),this.moveNextWidgetsToTable(e,F,!u),P=i),T&&this.updateClientPositionForBlock(W?O:N,i),u=!1),N=this.documentHelper.viewer.clientArea.bottom-p.bottomBorderWidth-v;if(P.ownerTable.header&&(w.x=w.x,w.y=this.viewer.clientArea.y+b.headerHeight,this.updateChildLocationForRow(w.y,w),S=this.isFirstLineFitForRow(N,w)),S&&P.ownerTable.header&&!T){a instanceof Sd&&(m=H.page.repeatHeaderRowTableWidget=!0),a.updateClientAreaForBlock(P.ownerTable,!0,e),w.x=w.x,w.y=b.y+P.ownerTable.headerHeight;var A=v/2;this.updateChildLocationForRow(b.y+P.ownerTable.headerHeight-A,w,b.containerWidget)}else{if(a.updateClientAreaForBlock(P.ownerTable,!0,e),1<w.bodyWidget.sectionFormat.columns.length){for(var N=new Rd(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),S=new Rd(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height),D=(w.x=this.viewer.clientActiveArea.x,w.y=this.viewer.clientActiveArea.y,this.getMaxTopCellMargin(w)),U=this.getMaxBottomCellMargin(w),I=0;I<w.childWidgets.length;I++){var E=w.childWidgets[I];E.height=0,this.addTableCellWidget(E,this.viewer.clientActiveArea,D+w.topBorderWidth,U+w.bottomBorderWidth),this.viewer.updateClientAreaForCell(E,!0);for(var V=0;V<E.childWidgets.length;V++){var L=E.childWidgets[V];a.updateClientAreaForBlock(L,!0),L.containerWidget=E,this.layoutBlock(L,0),a.updateClientAreaForBlock(L,!1)}this.viewer.updateClientAreaForCell(E,!1)}this.viewer.clientActiveArea=S,this.viewer.clientArea=N}w.x=w.x,w.y=b.y;A=v/2;this.updateChildLocationForRow(b.y-A,w,b.containerWidget,!0)}if(W&&0<this.shiftedFloatingItemsFromTable.length){for(I=0;I<this.shiftedFloatingItemsFromTable.length;I++){var B=this.shiftedFloatingItemsFromTable[I],z=this.getFloatingItemPoints(B);B.y=z.y,B.x=z.x,B instanceof uc&&this.updateChildLocationForCellOrShape(B.y,B)}this.shiftedFloatingItemsFromTable=[]}}y=!1}if(l)if(i.ownerTable.continueHeader&&(i.ownerTable.header=!0,i.ownerTable.headerHeight=s+i.ownerTable.headerHeight),T=this.getHeader(i.ownerTable),!_.isNullOrUndefined(T)&&i.index===T.index)if(((k=this.getHeaderHeight(i.ownerTable,i,t))>i.ownerTable.headerHeight||k>i.ownerTable.headerHeight)&&(i.ownerTable.headerHeight=k),i.ownerTable.headerHeight>a.clientArea.height){i.ownerTable.header=!1,i.ownerTable.continueHeader=!1,i.ownerTable.headerHeight=0;for(C=this.documentHelper.pages,I=0;I<C.length;I++)C[I].repeatHeaderRowTableWidget&&(C[I].repeatHeaderRowTableWidget=!1)}o=!1,2<e.length&&i.ownerTable.header&&p.height<a.clientActiveArea.bottom&&!a.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget&&(a.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget=!0)}},t.prototype.getHeader=function(e){var t=void 0,i=!0;e=e.getSplitWidgets()[0];for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r.rowFormat.isHeader?t=r:i=!1,!i)break}return t},t.prototype.getHeaderHeight=function(e,t,i){var n=0;if(0<t.ownerTable.childWidgets.length&&e.childWidgets[0].rowFormat.isHeader)for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(!o.rowFormat.isHeader)break;n+=o.height}return n},t.prototype.getHeaderHeightForSpannedRow=function(e){for(var t=0,i=1,n=this.getHeader(e),r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(o.rowFormat.isHeader&&(t+=o.height,o==n)){for(var s=0;s<n.childWidgets.length;s++)var a=n.childWidgets[s],i=Math.max(i,a.cellFormat.rowSpan);if(1<i&&r+i<e.childWidgets.length)for(var l=1;l<i;l++){var d=e.childWidgets[r+l];_.isNullOrUndefined(d)||(t+=d.height)}}}return t},t.prototype.updateWidgetToRow=function(e){var t,i=e.ownerRow;e.containerWidget=i,!_.isNullOrUndefined(e.ownerRow)&&"Exactly"!==e.ownerRow.rowFormat.heightType&&0<j.convertPointToPixel(e.ownerRow.rowFormat.height)&&0===e.cellIndex&&(i.height=i.height+j.convertPointToPixel(e.ownerRow.rowFormat.height)),1===e.cellFormat.rowSpan&&(t=void 0,t="Exactly"===i.rowFormat.heightType?e.height+e.margin.bottom:e.height+e.margin.top+e.margin.bottom,i.height-j.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing)<t)&&(i.height=t+j.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))},t.prototype.updateHeightForRowWidget=function(e,t,i,n,r,o,s,a){for(var l=0;l<r.childWidgets.length;l++){var d,h=0,c=void 0,p=(c=r.childWidgets[l]).cellFormat.rowSpan,h=j.convertPointToPixel(c.ownerTable.tableFormat.cellSpacing);1<p?(p=(d=r.containerWidget.childWidgets.indexOf(r))+p-1-(r.index-c.rowIndex),!a&&(e.clientArea.bottom<c.y+c.height+c.margin.bottom||d+1<=p)&&(1===n.length||1<=n.length&&r===n[n.length-1])&&(d=this.footHeight,this.footHeight=_.isNullOrUndefined(r.bodyWidget.page.footnoteWidget)?0:r.bodyWidget.page.footnoteWidget.height,this.splitSpannedCellWidget(c,i,n,e),this.footHeight=d),d=r,0<p&&(p<r.containerWidget.childWidgets.length?(p=r.containerWidget.childWidgets[p])instanceof dh&&(d=p)===s&&(d=r):d=r.containerWidget.childWidgets[r.containerWidget.childWidgets.length-1]),c.y+c.height+c.margin.bottom<d.y+d.height?c.height=d.y+d.height-d.bottomBorderWidth-c.y-c.margin.bottom:o&&d&&0!==d.y&&0!==d.height&&c.y+c.height+c.margin.bottom>d.y+d.height&&("Exactly"!==d.rowFormat.heightType||"Exactly"===d.rowFormat.heightType&&d.rowFormat.height>c.y+c.height+c.margin.bottom-d.y?d.height=c.y+c.height+c.margin.bottom-d.y:c.height=d.y-c.y+d.height)):(0<h&&1<i.length&&r.y===e.clientArea.y&&e instanceof Sd&&(h/=2),c.height=r.height-c.margin.top-c.margin.bottom-h),this.updateHeightForCellWidget(e,i,n,c);for(var u=r.containerWidget;u.containerWidget instanceof Vd;)u=u.containerWidget;p=void 0;u instanceof z&&(p=u.page),(e instanceof Sd&&-1!==e.visiblePages.indexOf(p)||t)&&this.updateCellVerticalPosition(c,!1,c.ownerTable.isInsideTable)}},t.prototype.updateHeightForCellWidget=function(e,t,i,n){for(var r=0;r<n.childWidgets.length;r++)n.childWidgets[r]instanceof K&&this.updateHeightForTableWidget(t,i,n.childWidgets[r])},t.prototype.getRowHeight=function(e,t){var i=0;if("Exactly"===e.rowFormat.heightType)i=e.rowFormat.height;else{for(var n=0;n<t.length;n++)t[n]instanceof dh&&(i=t[n].height+i);i=Math.max(i,e.rowFormat.height)}return i},t.prototype.splitSpannedCellWidget=function(e,t,i,n){n=this.getSplittedWidget(n.clientArea.bottom,!1,t,i,e,void 0,void 0,void 0,void 0,!0);_.isNullOrUndefined(n)||(this.documentHelper.splittedCellWidgets.push(n),n.isSplittedCell=!0)},t.prototype.insertSplittedCellWidgets=function(e,t,i,n){if(!_.isNullOrUndefined(i)){for(var r=i.x,o=!1,s=j.convertPointToPixel(i.ownerTable.tableHolder.tableWidth),a=0;a<i.childWidgets.length;a++){var l=i.childWidgets[a],d="None"===l.cellFormat.borders.right.lineStyle,h=_.isNullOrUndefined(l.ownerTable)||_.isNullOrUndefined(l.ownerTable.tableFormat)?0:j.convertPointToPixel(l.ownerTable.tableFormat.cellSpacing);if(Math.round(r)<Math.round(l.x-l.margin.left-h)){if(this.insertRowSpannedWidget(i,e,r,a)){a--;continue}if(1==t.length)break;var c=i.childWidgets.length;if(this.insertEmptySplittedCellWidget(i,t,r,a,n),c<i.childWidgets.length){a--;continue}}r+=l.margin.left+l.width+l.margin.right,(0<h||l.columnIndex===l.ownerTable.tableHolder.columns.length-1||l.index===l.containerWidget.childWidgets.length-1)&&(l.ownerTable.tableFormat.allowAutoFit||(c=j.convertPointToPixel(N.getCellLeftBorder(l).getLineWidth()),h=j.convertPointToPixel(N.getCellRightBorder(l).getLineWidth()),l.rightBorderWidth=l.ownerTable.isBidiTable?c:h,r+=l.rightBorderWidth),this.isInsertTable()||(o=this.checkPreviousMargins(l.ownerTable))),r-=d&&!o?0:l.rightBorderWidth,a===i.childWidgets.length-1&&Math.round(r)<Math.round(i.x+s)&&(this.insertRowSpannedWidget(i,e,r,a+1)||this.insertEmptySplittedCellWidget(i,t,r,a+1,n))}if((_.isNullOrUndefined(i.childWidgets)||0===i.childWidgets.length)&&0<this.documentHelper.splittedCellWidgets.length)for(var p=0;p<this.documentHelper.splittedCellWidgets.length;p++){var u=this.documentHelper.splittedCellWidgets[p];if(Math.round(r)<=Math.round(u.x-u.margin.left)){if(this.insertRowSpannedWidget(i,e,r,p)){p--;continue}var g=i.childWidgets.length;if(this.insertEmptySplittedCellWidget(i,t,r,p,n),g<i.childWidgets.length){p--;continue}}r+=u.margin.left+u.width+u.margin.right,p===i.childWidgets.length-1&&Math.round(r)<Math.round(i.x+s)&&(this.insertRowSpannedWidget(i,e,r,p+1)||this.insertEmptySplittedCellWidget(i,t,r,p+1,n))}0<this.documentHelper.splittedCellWidgets.length&&(this.documentHelper.splittedCellWidgets=[])}},t.prototype.insertRowSpannedWidget=function(e,t,i,n){var r=0;0<e.ownerTable.tableFormat.cellSpacing&&(r=j.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing));for(var o=0;o<this.documentHelper.splittedCellWidgets.length;o++){var s=this.documentHelper.splittedCellWidgets[o];if(Math.round(i)===Math.round(s.x-s.margin.left))return e.childWidgets.splice(n,0,s),s.containerWidget=e,s.height>e.height&&(e.height=s.height),s.y!==e.y+s.margin.top+r&&this.updateChildLocationForRow(e.y,e),this.documentHelper.splittedCellWidgets.splice(o,1),!0}return!1},t.prototype.insertEmptySplittedCellWidget=function(e,t,i,n,r){for(var o,s=t[t.length-1],a=t.length-1;0<=a;a--)for(var l=t[a],d=l.childWidgets.length-1;0<=d;d--){var h=l.childWidgets[d];if(h.index===r){o=h;break}}o&&(s=o.ownerTable,r=o.indexInOwner);for(var c=r;0<=c;c--)for(var p=s.childWidgets[c],u=p.x,a=0;a<p.childWidgets.length;a++){var g,m=p.childWidgets[a];if(Math.round(i)===Math.round(u))if(1<(_.isNullOrUndefined(m)||_.isNullOrUndefined(m.cellFormat)?1:m.cellFormat.rowSpan)&&0===p.firstChild.columnIndex)return this.isVerticalMergedCellContinue(e)&&"Exactly"!==e.rowFormat.heightType&&!_.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof dh&&e.previousRenderedWidget.y+e.previousRenderedWidget.height<m.y+m.height?(g=this.getSplittedWidget(e.previousRenderedWidget.y+e.previousRenderedWidget.height,!0,t,void 0,m,void 0,void 0,void 0,void 0,!0),e.childWidgets.splice(n,0,g),g.containerWidget=e):(g=this.createCellWidget(m),e.childWidgets.splice(n,0,g),g.containerWidget=e),void this.updateChildLocationForRow(e.y,e);u+=m.margin.left+m.width+m.margin.right}},t.prototype.getSplittedWidget=function(e,t,i,n,r,o,s,a,l,d){var h=void 0,c=0;if(a||r.y+r.height>e-this.footHeight-r.margin.bottom){for(var p=0;p<r.ownerRow.childWidgets.length;p++){var u=r.ownerRow.childWidgets[p];if(u.y+u.height<e-this.footHeight-u.margin.bottom)for(var g=0;g<u.childWidgets.length;g++)if(u.childWidgets[g]instanceof G)for(var m=u.childWidgets[g],f=0;f<m.childWidgets.length;f++){var y=m.childWidgets[f],y=this.getFootNoteHeightInLine(y);this.existFootnoteHeight+=y,c+=y}}for(var v=0,w=(r.ownerTable.isInsideTable&&(v=l),!1),p=0;p<r.childWidgets.length;p++)if(r.childWidgets[p]instanceof G){var m=r.childWidgets[p],b=this.getSplittedWidgetForPara(e-r.margin.bottom,m,o,s,a,v,w);if(a&&(v+=m.childWidgets.length),!_.isNullOrUndefined(b)){if(w=!0,0===p&&b===m&&!d)return r;-1!==r.childWidgets.indexOf(b)&&(r.childWidgets.splice(r.childWidgets.indexOf(b),1),p--),r.height-=b.height,(h=_.isNullOrUndefined(h)?this.createCellWidget(r):h).height+=b.height,h.childWidgets.push(b),b.containerWidget=h}}else{b=r.childWidgets[p];if(a||e-r.margin.bottom<b.y+b.height){var x=b.height,C=this.getSplittedWidgetForTable(e-r.margin.bottom,[b],b,o,s,a,v);if(_.isNullOrUndefined(C)&&!b.childWidgets[0].rowFormat.allowBreakAcrossPages&&(C=b),!_.isNullOrUndefined(C)){if(0===p&&C===b)return r;-1!==r.childWidgets.indexOf(C)?(r.childWidgets.splice(r.childWidgets.indexOf(C),1),p--,r.height-=C.height):r.height-=x-b.height,(h=_.isNullOrUndefined(h)?this.createCellWidget(r):h).height+=C.height,h.childWidgets.push(C),C.containerWidget=h}}}}return this.existFootnoteHeight-=c,h=_.isNullOrUndefined(h)&&t&&this.isRelayoutneed?this.createCellWidget(r):h},t.prototype.getListLevelPattern=function(e){switch(e){case 0:return"Arabic";case 1:return"LowLetter";case 2:return"LowRoman";case 3:return"UpLetter";case 4:return"UpRoman";case 5:return"Ordinal";case 6:return"Number";case 7:return"OrdinalText";case 8:return"LeadingZero";case 9:return"Bullet";case 10:return"FarEast";case 11:return"Special";default:return"None"}},t.prototype.createCellWidget=function(e){var t=new N;return t.cellFormat=e.cellFormat,t.index=e.index,t.rowIndex=e.rowIndex,t.columnIndex=e.columnIndex,t.containerWidget=e.containerWidget,this.updateWidgetLocation(e,t),t.margin=e.margin,t.leftBorderWidth=e.leftBorderWidth,t.rightBorderWidth=e.rightBorderWidth,t},t.prototype.createTableWidget=function(e){var t,i=new K;return e.header&&(i.header=e.header,t=this.getHeaderHeightForSpannedRow(e),i.headerHeight=t>e.headerHeight?t:e.headerHeight),i.index=e.index,i.tableFormat=e.tableFormat,i.tableHolder=e.tableHolder,i.footnoteElement=e.footnoteElement,i.isGridUpdated=e.isGridUpdated,i.wrapTextAround=e.wrapTextAround,i.positioning=e.positioning,i.isContainInsideTable=e.isContainInsideTable,i.isBidiTable=e.isBidiTable,i},t.prototype.getSplittedWidgetForPara=function(e,t,i,n,r,o,s){for(var a=t.y,l=void 0,d=!1,h=!1,c=0;c<t.childWidgets.length;c++){var p=t.childWidgets[c],u=this.getFootNoteHeightInLine(p);if(u+=this.existFootnoteHeight,!_.isNullOrUndefined(i))for(var g=0;g<i.length;g++)u+=this.getFootNoteHeight(i[g].bodyWidget);var m=0,m=(p.children[0]instanceof hc?p.children[0]:p).height;if(!_.isNullOrUndefined(t.associatedCell)&&0===t.associatedCell.index&&0===t.index&&_.isNullOrUndefined(t.associatedCell.ownerRow.previousSplitWidget)&&_.isNullOrUndefined(t.associatedCell.ownerRow.previousWidget)&&t.paragraphFormat.keepWithNext)return d=!0,p=t.childWidgets[0],t;if(r&&n<=o||e<a+u+m||s){if(t.paragraphFormat.keepLinesTogether&&(0!==t.index||0===t.index&&!_.isNullOrUndefined(t.associatedCell.ownerRow.previousWidget)))d=!0,p=t.childWidgets[c=0];else if(t.paragraphFormat.widowControl){if(!_.isNullOrUndefined(t.associatedCell)&&1===c&&e<a+t.height&&!h){var m=t.associatedCell.ownerRow.containerWidget,f=!!_.isNullOrUndefined(m.previousWidget),m=1<m.getSplitWidgets().length;if(!f&&!m)return t;if(p.isLastLine()&&_.isNullOrUndefined(l))return;h=!0}1!==c||h||(d=!0,p=t.childWidgets[c=0])}if(0===c){if(p.paragraph.containerWidget instanceof N&&!d&&!r&&p.paragraph.containerWidget.y===t.y){a+=p.height;continue}l=t;break}-1!==t.childWidgets.indexOf(p)&&(t.childWidgets.splice(t.childWidgets.indexOf(p),1),c--),t.height-=p.height,_.isNullOrUndefined(l)?((l=new G).characterFormat=t.characterFormat,l.paragraphFormat=t.paragraphFormat,l.index=t.index,this.updateWidgetLocation(t,l),l.height=p.height):l.height+=p.height,l.childWidgets.push(p),p.paragraph=l}this.getFootnoteFromLine(p,i),a+=p.height,o++}return l},t.prototype.getSplittedWidgetForTable=function(e,t,i,n,r,o,s){for(var a=i.y,l=void 0,d=0;d<i.childWidgets.length;d++){var h=void 0,c=(h=i.childWidgets[d]).height;if(o||e<a+c||!_.isNullOrUndefined(l)){var p=void 0,u=!0;if((u=_.isNullOrUndefined(h)||_.isNullOrUndefined(h.rowFormat)?u:h.rowFormat.allowBreakAcrossPages)?p=_.isNullOrUndefined(l)&&this.isFirstLineFitForRow(e,h)?this.getSplittedWidgetForRow(e,t,[h],h,n,r,o,s):h:_.isNullOrUndefined(i.containerWidget.containerWidget.previousWidget)&&this.isFirstLineFitForRow(e,h)||i.isInsideTable&&!i.containerWidget.containerWidget.rowFormat.allowBreakAcrossPages?p=this.getSplittedWidgetForRow(e,t,[h],h,n,r,o,s):_.isNullOrUndefined(i.containerWidget.containerWidget.previousWidget)||(p=h),!_.isNullOrUndefined(p)){if(0===d&&p===h)return i;-1!==i.childWidgets.indexOf(p)?(i.childWidgets.splice(i.childWidgets.indexOf(p),1),d--,i.height-=p.height):i.height-=c-h.height,_.isNullOrUndefined(l)?(l=this.createTableWidget(i),this.updateWidgetLocation(i,l),l.height=p.height):l.height+=p.height,l.childWidgets.push(p),p.containerWidget=l}}a+=h.height}return l},t.prototype.isFirstLineFitForPara=function(e,t){var i=t.childWidgets[0],n=i.height,r=this.getFootNoteHeightInLine(i),r=(n+=r+=this.existFootnoteHeight,i.paragraph.containerWidget);if(t.paragraphFormat.keepLinesTogether&&Math.floor(r.containerWidget.y)!==this.viewer.clientArea.y&&(n=t.height),this.documentHelper.isFirstLineFitInShiftWidgets){if(this.viewer.clientActiveArea.y===this.viewer.clientArea.y&&t.y+n>=e)return!0}else if(!r.ownerTable.isInsideTable&&r.containerWidget.y===this.viewer.clientArea.y&&t.y+n>=e)return!0;return t.y+n<=e},t.prototype.isFirstLineFitForTable=function(e,t){var i=!1,t=t.childWidgets[0];return i=_.isNullOrUndefined(t=t)?i:this.isFirstLineFitForRow(e,t)},t.prototype.isFirstLineFitForRow=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(!this.isFirstLineFitForCell(e,n))return!1}return!0},t.prototype.isFirstLineFitForCell=function(e,t){var i;return 0===t.childWidgets.length||(t.childWidgets[0]instanceof G?(i=t.childWidgets[0],this.isFirstLineFitForPara(e-t.margin.bottom,i)):(i=t.childWidgets[0],this.isFirstLineFitForTable(e-t.margin.bottom,i)))},t.prototype.updateWidgetLocation=function(e,t){t.x=e.x,t.y=e.y,t.width=e.width},t.prototype.updateChildLocationForTable=function(e,t,i,n){for(var r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r];o.y=e,this.updateChildLocationForRow(e,o,i,n),e+=o.height}},t.prototype.updateChildLocationForRow=function(e,t,i,n){var r=0;0<t.ownerTable.tableFormat.cellSpacing&&(r=j.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing));for(var o=0;o<t.childWidgets.length;o++){var s=t.childWidgets[o];s.index=s.cellIndex,s.y=e+s.margin.top+r,this.updateChildLocationForCellOrShape(s.y,s,i,n)}},t.prototype.updateChildLocationForCellOrShape=function(e,t,i,n,r){var o=t;t instanceof uc&&(o=t.textFrame);for(var s=0;s<o.childWidgets.length;s++){var a=!1;if(o.childWidgets[s]instanceof K&&o.childWidgets[s].wrapTextAround&&!_.isNullOrUndefined(o.childWidgets[s+1])&&o.childWidgets[s+1].y>o.childWidgets[s].y&&o.childWidgets[s+1].y<o.childWidgets[s].y+o.childWidgets[s].height&&(a=!0),!_.isNullOrUndefined(o.childWidgets[s].floatingElements)&&0<o.childWidgets[s].floatingElements.length&&n&&(this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-e,this.viewer.clientActiveArea.y=e),o.childWidgets[s].x=o.childWidgets[s].x,o.childWidgets[s].y=e,t instanceof uc&&"Inline"==t.textWrappingStyle&&r&&this.updateShapeYPosition(t),!_.isNullOrUndefined(i)&&t instanceof N&&o.childWidgets[s]instanceof G){var l=o.childWidgets[s],d=t.ownerTable.bodyWidget.floatingElements,h=!1;if(t.ownerTable.bodyWidget!==i||_.isNullOrUndefined(t.ownerTable.previousSplitWidget)||(d=t.ownerTable.previousSplitWidget.bodyWidget.floatingElements,h=!0),0<l.floatingElements.length)for(var c=0;c<l.floatingElements.length;c++){var p=l.floatingElements[c],u=this.viewer.clientActiveArea.x;if(this.viewer.clientActiveArea.x=p.x,this.layoutShape(p),this.viewer.clientActiveArea.x=u,!_.isNullOrUndefined(l.firstChild))for(var g=l.childWidgets[0],m=0;m<g.children.length;m++){var f=g.children[m];f instanceof hc&&"Inline"==f.textWrappingStyle&&(this.adjustPosition(f,t.ownerTable.bodyWidget),e=l.y)}-1<d.indexOf(p)&&"Inline"!==p.textWrappingStyle&&(h||(i.floatingElements.push(p),u=i.previousSplitWidget,_.isNullOrUndefined(u))||-1===u.floatingElements.indexOf(p)||u.floatingElements.splice(u.floatingElements.indexOf(p),1),-1!==d.indexOf(p))&&d.splice(d.indexOf(p),1)}}o.childWidgets[s]instanceof K&&this.updateChildLocationForTable(e,o.childWidgets[s],i,n),a||(e+=o.childWidgets[s].height)}},t.prototype.updateCellVerticalPosition=function(e,t,i){var n=e.ownerTable.containerWidget;(n instanceof _d||n instanceof fc||i)&&(n=this.getDisplacement(e,t),this.updateCellContentVerticalPosition(e,n,t))},t.prototype.updateCellContentVerticalPosition=function(e,t,i){if(0!==t)for(var n,r=e.y+t,o=0;o<e.childWidgets.length;o++)e.childWidgets[o]instanceof G?((n=e.childWidgets[o]).y=r,this.updateShapeInsideCell(n,t)):this.updateTableWidgetLocation(e.childWidgets[o],r,i),r+=e.childWidgets[o].height},t.prototype.updateShapeInsideCell=function(e,t){for(var i=0;i<e.floatingElements.length;i++){var n=e.floatingElements[i];n.y+=t,n instanceof uc&&this.updateChildLocationForCellOrShape(n.y,n)}},t.prototype.updateTableWidgetLocation=function(e,t,i){e.y=t+=e.topBorderWidth;for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];r.y=t;for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];s.y=t+s.margin.top+0,this.updateCellVerticalPosition(s,i,!0)}t+=r.height}return t},t.prototype.getDisplacement=function(e,t){var i=0,n=e.containerWidget,r=e.margin.top+e.margin.bottom,i=!_.isNullOrUndefined(e.cellFormat)&&1<e.cellFormat.rowSpan?e.height:(_.isNullOrUndefined(n)?0:n.height)-r,n=this.getCellContentHeight(e,!0),r=0;return n<i&&i<=this.viewer.clientArea.height&&(r=i-n,"Center"===e.cellFormat.verticalAlignment?r/=2:"Top"!==e.cellFormat.verticalAlignment&&!t||(r=0)),r},t.prototype.getCellContentHeight=function(e,t,i){if(_.isNullOrUndefined(e.childWidgets))return 0;for(var n=0,r=e.y,o=0,s=0,a=!1,l=!1,d=0;d<e.childWidgets.length;d++)if(e.childWidgets[d]instanceof G){var h=e.childWidgets[d];n+=e.childWidgets[d].height,!t&&0<h.floatingElements.length&&i===h.indexInOwner&&(n+=this.getFloatingItemsHeight(h,e));for(var c=0;c<h.floatingElements.length;c++){var a=!0,p=h.floatingElements[c],u=p.textWrappingStyle,g=p.y+p.height,m=h.y+h.height;r+e.containerWidget.height>g&&s<g?(o=Math.abs(r-g),s=g,l=!1):m<g&&h.x+h.width>p.x&&s<g&&"InFrontOfText"!==u&&"Behind"!==u&&("Word2013"===this.documentHelper.compatibilityMode||h.floatingElements[c].layoutInCell)?(n+=0===s?g-m:g-s,s=g):l=!0}}else this.considerPositionTableHeight(e,e.childWidgets[d])&&(n+=e.childWidgets[d].height);return s<r+n&&(a=!1),t&&a?o:t&&l?e.ownerRow.height:n},t.prototype.getFloatingItemsHeight=function(e,t){for(var i=0,n=0,r=0;r<e.floatingElements.length;r++){var o=e.floatingElements[r],s=o.textWrappingStyle,a=o.y+o.height,l=e.y+e.height;a<this.viewer.clientArea.bottom&&o.y!==e.y&&a<l&&e.x+e.width>o.x&&i<a&&"InFrontOfText"!==s&&"Behind"!==s&&"Inline"!==s&&("Word2013"===this.documentHelper.compatibilityMode||e.floatingElements[r].layoutInCell)&&(n+=0===i?a-t.y:a-i,i=a)}return n},t.prototype.considerPositionTableHeight=function(e,t){if(t.isLayouted&&t.wrapTextAround)for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];if(t!==n&&(n.y===t.y||n.y+n.height<t.y))return!1}return!0},t.prototype.getTableLeftBorder=function(e){var t;return _.isNullOrUndefined(e.left)?((t=new Va(e)).lineStyle="Single",t.lineWidth=.66,t):e.left},t.prototype.getTableRightBorder=function(e){var t;return _.isNullOrUndefined(e.right)?((t=new Va(e)).lineStyle="Single",t.lineWidth=.66,t):e.right},t.prototype.getTableTopBorder=function(e){var t;return _.isNullOrUndefined(e.top)?((t=new Va(e)).lineStyle="Single",t.lineWidth=.66,t):e.top},t.prototype.getTableBottomBorder=function(e){var t;return _.isNullOrUndefined(e.bottom)?((t=new Va(e)).lineStyle="Single",t.lineWidth=.66,t):e.bottom},t.prototype.getCellDiagonalUpBorder=function(e){return e.cellFormat.borders.diagonalUp},t.prototype.getCellDiagonalDownBorder=function(e){return e.cellFormat.borders.diagonalDown},t.prototype.getTableWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){for(var n=e.childWidgets[i],r=0,o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];r+=j.convertPointToPixel(s.cellFormat.cellWidth)}t<r&&(t=r)}return t},t.prototype.layoutNextItemsBlock=function(e,t,i,n){for(var r=e.bodyWidget.sectionIndex,o=(d=e).getSplitWidgets(),s=o[o.length-1].nextRenderedWidget,a=(!_.isNullOrUndefined(s)&&this.documentHelper.blockToShift!==d||(this.documentHelper.blockToShift=void 0),!0);s instanceof Qd&&(s.bodyWidget.sectionIndex===r||"NoBreak"===s.bodyWidget.sectionFormat.breakCode&&d.bodyWidget.sectionFormat.pageWidth===s.bodyWidget.sectionFormat.pageWidth&&d.bodyWidget.sectionFormat.pageHeight===s.bodyWidget.sectionFormat.pageHeight)&&(_.isNullOrUndefined(i)||!i||s.isLayouted||!this.isInitialLoad);){var l=d.getSplitWidgets(),l=l[l.length-1],d=s,a=(this.documentHelper.blockToShift===d&&(this.documentHelper.blockToShift=void 0),!1),h=d.getSplitWidgets()[0];if(0===this.documentHelper.fieldStacks.length&&!_.isNullOrUndefined(h)&&l.containerWidget===h.containerWidget&&j.round(h.y,2)===j.round(l.y+l.height,2)){(!_.isNullOrUndefined(this.documentHelper.blockToShift)||this.documentHelper.owner.editorModule.isFootnoteElementRemoved||h.bodyWidget&&(0<(h=h.bodyWidget.floatingElements.length)||0===h&&_.isNullOrUndefined(this.documentHelper.blockToShift)&&l instanceof K&&n))&&(this.documentHelper.blockToShift=d);break}if(a=!0,t.owner.isShiftingEnabled&&(0===this.documentHelper.fieldStacks.length||this.viewer.owner.editorModule.isInsertingTOC)||this.isIFfield){this.documentHelper.blockToShift=d;break}!_.isNullOrUndefined(this.viewer.owner.editorModule)&&this.viewer.owner.editorModule.isInsertingTOC||(d=d.combineWidget(this.viewer),l.containerWidget===d.containerWidget||l instanceof G&&(!(l instanceof G)||l.isEndsWithPageBreak||l.isEndsWithColumnBreak||l.containerWidget.page===d.containerWidget.page||d.bodyWidget instanceof z&&"NoBreak"===d.bodyWidget.sectionFormat.breakCode)||this.updateContainerWidget(d,l.containerWidget,l.indexInOwner+1,!1),d instanceof K&&(this.clearTableWidget(d,!0,!0),d.isGridUpdated=!1),t.updateClientAreaForBlock(d,!0),(this.viewer instanceof Wd||d.bodyWidget instanceof Xd)&&(d.containerWidget.height-=d.height),this.documentHelper.layout.layoutBlock(d,0),t.updateClientAreaForBlock(d,!1)),s=(o=s.getSplitWidgets())[o.length-1].nextRenderedWidget}t.owner.isShiftingEnabled&&this.documentHelper.blockToShift===d||this.viewer.owner.editorModule.updateListItemsTillEnd(d,a)},t.prototype.updateClientAreaForLine=function(e){e.marginTop=0;var e=this.documentHelper.selection.getTop(e),t=this.viewer.clientArea.x;this.viewer.cutFromTop(e),this.viewer.cutFromLeft(t)},t.prototype.getParentTable=function(e){for(var t=e;t.containerWidget;){if(t.containerWidget instanceof _d||t.containerWidget instanceof fc)return t;t=t.containerWidget}},t.prototype.reLayoutParagraph=function(e,t,i,n,r){var o;this.isReplaceAll||(this.isRelayout=!0,e.containerWidget instanceof fc&&"Inline"===e.containerWidget.containerShape.textWrappingStyle&&(t=e.containerWidget.containerShape.line.indexInOwner,e=e.containerWidget.containerShape.paragraph),n=!_.isNullOrUndefined(n)&&n,this.isRelayout=!0,this.documentHelper.blockToShift===e?(this.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.isBidiReLayout=!0):this.isBidiReLayout&&(this.isBidiReLayout=!1),e.isInsideTable?(this.isBidiReLayout=!0,this.isReplacingAll||this.reLayoutTable(e),!this.isFootnoteContentChanged||_.isNullOrUndefined(e.bodyWidget)||_.isNullOrUndefined(e.bodyWidget.page.footnoteWidget)||(o=e.bodyWidget.page.footnoteWidget,this.layoutfootNote(o)),this.isBidiReLayout=!1):this.reLayoutLine(e,t,n,r),e.bodyWidget instanceof Xd&&-1!==e.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(e.bodyWidget,this.viewer))},t.prototype.getParentRow=function(e){return this.getParentCell(e).ownerRow},t.prototype.getParentCell=function(e){for(var t=e;null!==t.ownerTable&&t.ownerTable.isInsideTable;)t=t.ownerTable.associatedCell;return t},t.prototype.reLayoutRow=function(e){e instanceof G&&(e=e.associatedCell);var t=this.getParentRow(e).getSplitWidgets()[0];if(_.isNullOrUndefined(t)||t.ownerTable.tableFormat.allowAutoFit)this.currentCell=e,this.reLayoutTable(e),this.currentCell=void 0;else{for(var i=t.ownerTable.getSplitWidgets()[0].combineWidget(this.viewer),n=t;this.isVerticalMergedCellContinue(n);){var r=n.previousWidget;if(_.isNullOrUndefined(r))break;n=r}var o=i.containerWidget,e=(this.viewer instanceof Wd&&(o.height-=i.height),!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||o instanceof fc?o instanceof fc?this.viewer.updateClientAreaForTextBoxShape(o.containerShape,!0):this.viewer.updateClientArea(o,o.page):(e.bodyWidget.isEmpty=!1,o.height-=i.height,this.viewer.updateHeaderFooterClientAreaWithTop(i.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(i),o.page)),new Rd(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height)),o=new Rd(e.x,e.y,e.width,e.height);for(this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&(e=this.documentHelper.getFirstParagraphInFirstCell(i),this.viewer.owner.editorModule.updateWholeListItems(e)),this.viewer.updateClientAreaForBlock(i,!0),this.viewer.cutFromTop(n.y),this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,i.height=0;this.clearRowWidget(t,!0,!0,!0),this.layoutRow([i],t,!0),n!==t&&(n=n.nextRow)&&n!==t;);this.updateChildLocationForTable(i.y,i),this.viewer.clientArea=o,this.viewer.clientActiveArea=new Rd(o.x,o.y,o.width,o.height),this.viewer.updateClientAreaForBlock(i,!0),i.x-=i.leftBorderWidth,i.y-=i.topBorderWidth,this.viewer.cutFromTop(i.y),this.shiftTableWidget(i,this.viewer,!0),this.layoutNextItemsBlock(i,this.viewer)}},t.prototype.reLayoutTable=function(e,t){var i=this.getParentTable(e);if(i.header)for(var n=i.getSplitWidgets(),r=1;r<n.length;r++)n[r].bodyWidget.page.repeatHeaderRowTableWidget=!1;var o,s=0,a=(i.containerWidget instanceof z&&(s=(o=i.getSplitWidgets())[o.length-1].containerWidget.page.index),i.combineWidget(this.viewer)),l=a.containerWidget,i=(this.viewer instanceof Wd&&(l.height-=a.height),!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||l instanceof fc?l instanceof fc?this.viewer.updateClientAreaForTextBoxShape(l.containerShape,!0):this.viewer.updateClientArea(l,l.page):(e.bodyWidget.isEmpty=!1,l.height-=a.height,this.viewer.updateHeaderFooterClientAreaWithTop(i.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(i),l.page)),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&(e=this.documentHelper.getFirstParagraphInFirstCell(a),this.viewer.owner.editorModule.updateWholeListItems(e)),this.viewer.updateClientAreaForBlock(a,!0),a.x-=a.leftBorderWidth,a.y-=a.topBorderWidth,this.getYPosition(a)),l=(this.viewer.cutFromTop(i),this.clearTableWidget(a,!0,!0,!0,!0),this.isBidiReLayout=!0,this.layoutBlock(a,0),this.viewer.updateClientAreaForBlock(a,!1),0);a.containerWidget instanceof z&&(l=(o=a.getSplitWidgets())[o.length-1].containerWidget.page.index),this.layoutNextItemsBlock(a,this.viewer,t,s!==l)},t.prototype.getYPosition=function(e){if(e.wrapTextAround){for(var t=e.previousWidget;t;){if(t instanceof G)return t.y+t.height;if(t instanceof K){if(!t.wrapTextAround)return t.y+t.height;t=t.previousWidget}}return this.viewer.clientActiveArea.y}return e.y},t.prototype.clearFootnoteReference=function(e,t){if(e.footnoteElement&&0<e.footnoteElement.length){for(var i=e.bodyWidget.page,n=e.footnoteElement.length-1;0<=n;n--){var r,o=e.footnoteElement[n],s=(o.isLayout=!1,o.bodyWidget.containerWidget);s&&-1!==s.bodyWidgets.indexOf(o.bodyWidget)&&(r=this.getFootNoteHeight(o.bodyWidget),s.height-=r,s.bodyWidgets.splice(o.bodyWidget.indexInOwner,1),t)&&s.page===i&&(this.viewer.clientActiveArea.height+=r,this.viewer.clientArea.height+=r),0===s.bodyWidgets.length&&s.page&&(s.page.footnoteWidget=void 0),o.bodyWidget.containerWidget=void 0}e.footnoteElement=[]}},t.prototype.clearTableWidget=function(e,t,i,n,r){e.height=0,n&&(e.isGridUpdated=!1),t&&(e.y=0,e.x=0,e.footnoteElement)&&0<e.footnoteElement.length&&this.clearFootnoteReference(e,r),e.leftBorderWidth=0,e.rightBorderWidth=0,e.topBorderWidth=0;for(var o=e.bottomBorderWidth=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];this.clearRowWidget(s,t,i,n)}},t.prototype.clearRowWidget=function(e,t,i,n){e.height=0,t&&(e.y=0,e.x=0),e.topBorderWidth=0;for(var r=e.bottomBorderWidth=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];this.clearCellWidget(o,t,i,n)}},t.prototype.clearCellWidget=function(e,t,i,n){e.height=0,t&&(e.y=0,e.x=0),e.leftBorderWidth=0,e.rightBorderWidth=0,this.clearBlockWidget(e.childWidgets,t,i,n)},t.prototype.clearBlockWidget=function(e,t,i,n){for(var r=0;r<e.length;r++){var o=e[r];o instanceof G?(t&&(o.y=0,o.x=0),i&&(o.height=0)):this.clearTableWidget(o,t,i,n)}},t.prototype.layoutBodyWidgetCollection=function(e,t,i,n,r){if(_.isNullOrUndefined(i)||!i.isFieldCodeBlock){if(!_.isNullOrUndefined(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled)if(t instanceof _d||t instanceof fc){i=this.checkAndGetBlock(t,e);if(t instanceof z&&_.isNullOrUndefined(i)&&!_.isNullOrUndefined(t.nextRenderedWidget)&&"NoBreak"===t.nextRenderedWidget.sectionFormat.breakCode&&(i=t.nextRenderedWidget.firstChild,t=t.nextRenderedWidget),_.isNullOrUndefined(i))return;if(this.viewer instanceof Wd&&(i.containerWidget.height-=i.height),t instanceof Xd)t.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(t.sectionFormat,-1!==t.headerFooterType.indexOf("Header"),t.page),i.containerWidget.height-=i.height;else if(t instanceof fc)this.viewer.updateClientAreaForTextBoxShape(t.containerShape,!0,!n);else if(!_.isNullOrUndefined(t.containerWidget)&&t.containerWidget instanceof q){if(this.viewer.updateClientArea(t,t.page,!0),"Footnote"!==t.containerWidget.footNoteType)return this.viewer.cutFromTop(t.containerWidget.y),void this.layoutfootNote(t.containerWidget);this.isRelayoutFootnote=!0,this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.y=i.containerWidget.containerWidget.y}else _.isNullOrUndefined(t.page.footnoteWidget)||t.page.footnoteWidget.footNoteType,this.viewer.updateClientArea(t,t.page,!0);if(0<e||"NoBreak"===i.bodyWidget.sectionFormat.breakCode&&0!==i.bodyWidget.index&&i===t.firstChild){var o=(i=i.combineWidget(this.viewer)).getSplitWidgets()[0].previousRenderedWidget;for(!_.isNullOrUndefined(o)&&o.wrapTextAround&&!_.isNullOrUndefined(o.getSplitWidgets()[0].previousRenderedWidget)&&o.y<o.getSplitWidgets()[0].previousRenderedWidget.y&&(o=o.getSplitWidgets()[0].previousRenderedWidget);o instanceof Qd&&o.isFieldCodeBlock;)o=o.getSplitWidgets()[0].previousRenderedWidget;!(_.isNullOrUndefined(o)||o instanceof G)||o instanceof G&&!o.isEndsWithPageBreak&&!o.isEndsWithColumnBreak?_.isNullOrUndefined(r)&&i.containerWidget!==o.containerWidget?(e=i.containerWidget,r=o.containerWidget,s=this.getFootNoteWidgetsOf(i),this.moveFootNotesToPage(s,e,r),"NoBreak"!==i.bodyWidget.sectionFormat.breakCode||i.bodyWidget.index===o.bodyWidget.index?(this.viewer.cutFromTop(o.y+o.height),this.updateContainerWidget(i,r,o.indexInOwner+1,!1)):i.bodyWidget.sectionIndex!==o.bodyWidget.sectionIndex&&1<o.bodyWidget.sectionFormat.numberOfColumns&&i.bodyWidget.page===o.bodyWidget.page?(s=this.getBodyWidget(o.bodyWidget,!0),e=this.getNextWidgetHeight(s),this.viewer.clientActiveArea.height-=e-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=e,this.viewer.clientArea.y=this.viewer.clientActiveArea.y,this.viewer.clientArea.height=this.viewer.clientActiveArea.height):(this.viewer.updateClientArea(i.bodyWidget,i.bodyWidget.page,!0),this.viewer.cutFromTop(o.y+o.height))):(o instanceof G&&o.height<=0&&this.isMultiColumnDoc&&(r=o,this.viewer.updateClientAreaForBlock(r,!0),this.layoutParagraph(r,0),this.viewer.updateClientArea(r.bodyWidget,r.bodyWidget.page,!0)),this.viewer.cutFromTop(o.y+o.height)):o instanceof G&&(o.isEndsWithPageBreak||o.isEndsWithColumnBreak)&&o.containerWidget===i.containerWidget&&this.moveBlocksToNextPage(o,!1)}var s=void 0,e=(s=(i=i.combineWidget(this.viewer))instanceof K?(this.clearTableWidget(i,!0,!0),i.isGridUpdated=!1,this.documentHelper.getFirstParagraphInFirstCell(i)):i,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(s),this.viewer.updateClientAreaForBlock(i,!0,void 0,!1,!0),this.isRelayout=!0,this.documentHelper.layout.layoutBlock(i,0),this.isRelayout=!1,this.viewer.updateClientAreaForBlock(i,!1),!_.isNullOrUndefined(t.containerWidget)&&t.containerWidget instanceof q&&"Footnote"===t.containerWidget.footNoteType&&this.layoutfootNote(t.containerWidget),t);null!=t.containerWidget||t instanceof fc||null==e.page||null==e.page.footnoteWidget||"Footnote"===e.page.footnoteWidget.footNoteType&&this.layoutfootNote(e.page.footnoteWidget),n?this.shiftNextWidgets(i):this.layoutNextItemsBlock(i,this.viewer)}else t instanceof N&&this.reLayoutTable(t.ownerTable);this.isRelayoutFootnote=!1}},t.prototype.checkAndGetBlock=function(e,t){if(e instanceof fc)return e.childWidgets[t];var i=e.indexInOwner;if(e.page.bodyWidgets.length<=1)for(;e&&e.indexInOwner===i;){if(0<e.childWidgets.length&&e.firstChild.index<=t&&e.lastChild.index>=t)for(var n=0;n<e.childWidgets.length;n++)if((r=e.childWidgets[n]).index===t)return r;if(!(e instanceof z))break;e=e.nextRenderedWidget}else for(;e;){if(0<e.childWidgets.length)for(var r,n=0;n<e.childWidgets.length;n++)if((r=e.childWidgets[n]).index===t)return r;if(!(e instanceof z))break;e=e.nextRenderedWidget}},t.prototype.layoutTable=function(e,t){if(this.isFieldCode&&!this.checkTableHasField(e)&&!this.isRelayout)return e.isFieldCodeBlock=!0,e;!_.isNullOrUndefined(e.previousWidget)&&this.viewer.clientActiveArea.height<0&&!e.wrapTextAround&&this.moveBlocksToNextPage(e.previousWidget,!1),e.isBidiTable=e.bidi,e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||_.isNullOrUndefined(e.firstChild.firstChild.leftMargin)||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-j.convertPointToPixel(e.firstChild.firstChild.leftMargin));for(var i,n,r,o=[e],s=(this.addTableWidget(this.viewer.clientActiveArea,o),this.viewer.updateClientAreaTopOrLeft(e,!0),0),a=(e.wrapTextAround?(i=this.viewer.clientActiveArea.clone(),n=this.viewer.clientArea.clone(),this.updateClientAreaForWrapTable(o,e,!0,i,n)):e.containerWidget instanceof fc||(this.adjustClientAreaBasedOnTextWrapForTable(e,this.viewer.clientActiveArea),this.isWrapText&&(s=this.viewer.clientActiveArea.x-this.viewer.clientArea.x,this.isWrapText=!1,e.x=this.viewer.clientActiveArea.x)),0<e.childWidgets.length&&(r=e.childWidgets[0].rowFormat.isHeader,e.header=r,e.continueHeader=r,e.headerHeight=0),e.childWidgets[t]);a;)a=(a=this.layoutRow(o,a)).nextRow;return this.documentHelper.viewer instanceof Sd&&e.wrapTextAround&&("Bottom"===e.positioning.verticalAlignment||"Center"===e.positioning.verticalAlignment||"Outside"===e.positioning.verticalAlignment)&&(this.updateTableFloatPoints(e),this.updateChildLocationForTable(e.y,e)),this.updateWidgetsToPage(o,[],e,!0),0<s&&(this.viewer.clientArea.x=this.viewer.clientArea.x-s),e.wrapTextAround&&this.updateClientAreaForWrapTable(o,e,!1,i,n),o[o.length-1].isLayouted=!0,o[o.length-1].isFieldCodeBlock=!1,"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||e.wrapTextAround||_.isNullOrUndefined(e.firstChild.firstChild.leftMargin)||(this.viewer.clientArea.x=this.viewer.clientArea.x+j.convertPointToPixel(e.firstChild.firstChild.leftMargin)),o[o.length-1]},t.prototype.updateClientAreaForWrapTable=function(e,t,i,n,r){var o;if(i)t.wrapTextAround&&(this.updateTableFloatPoints(t),i=this.viewer.clientActiveArea.clone(),o=this.adjustClientAreaBasedOnTextWrapForTable(t,this.viewer.clientActiveArea),i.x!==o.x&&(t.x=this.viewer.clientActiveArea.x),i.y!==o.y)&&(t.y=this.viewer.clientActiveArea.y);else if(t.wrapTextAround&&t.bodyWidget)if(1==e.length)!_.isNullOrUndefined(t.previousWidget)||t.isInHeaderFooter||t.isInsideTable?(i=n.clone(),o=r.clone(),t.bodyWidget.lastChild!==e[e.length-1]&&(this.viewer.clientActiveArea=i,this.viewer.clientArea=o),!t.isLayouted&&i.height<t.height&&t.width>=i.width&&this.moveBlocksToNextPage(t.previousWidget,!1)):(this.documentHelper.tableLefts.pop(),this.viewer.updateClientArea(t.bodyWidget,t.bodyWidget.page)),-1===t.bodyWidget.floatingElements.indexOf(t)&&t.bodyWidget.floatingElements.push(t);else{if(!_.isNullOrUndefined(t.previousWidget)&&!t.isLayouted&&n.height<t.height&&t.width>=n.width)for(var s=t;this.moveBlocksToNextPage(s.previousWidget,!1),s=s.nextSplitWidget;);this.documentHelper.tableLefts.pop(),this.viewer.updateClientArea(t.bodyWidget,t.bodyWidget.page);for(var a=0;a<e.length;a++){var l=e[a].bodyWidget;_.isNullOrUndefined(l)||-1!==l.floatingElements.indexOf(e[a])||l.floatingElements.push(e[a])}r=e[e.length-1];this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r.height+r.tableFormat.borders.bottom.lineWidth)}},t.prototype.addTableWidget=function(e,t,i){var n=t[t.length-1];return i&&(n=this.createTableWidget(n),t.push(n)),n.width=e.width,n.x=e.x,n.y=e.y,0<n.tableFormat.cellSpacing&&(n.height=n.height+j.convertPointToPixel(n.tableFormat.cellSpacing),n.isBidiTable?(n.leftBorderWidth=j.convertPointToPixel(this.getTableRightBorder(n.tableFormat.borders).getLineWidth()),n.rightBorderWidth=j.convertPointToPixel(this.getTableLeftBorder(n.tableFormat.borders).getLineWidth())):(n.leftBorderWidth=j.convertPointToPixel(this.getTableLeftBorder(n.tableFormat.borders).getLineWidth()),n.rightBorderWidth=j.convertPointToPixel(this.getTableRightBorder(n.tableFormat.borders).getLineWidth())),n.topBorderWidth=j.convertPointToPixel(this.getTableTopBorder(n.tableFormat.borders).getLineWidth()),n.bottomBorderWidth=j.convertPointToPixel(this.getTableBottomBorder(n.tableFormat.borders).getLineWidth()),n.x+=n.leftBorderWidth,n.y+=n.topBorderWidth,n.width-=n.leftBorderWidth,n.width-=n.rightBorderWidth,n.height+=n.bottomBorderWidth),n},t.prototype.updateWidgetsToPage=function(e,t,i,n,r){var o=this.viewer,s=e[e.length-1];if(!i.isInsideTable){for(var a=0;a<e.length;a++)this.updateHeightForTableWidget(e,t,e[a],r);0<s.childWidgets.length&&s.y!==s.childWidgets[0].y&&(s.y=s.childWidgets[0].y)}if(i.isBidiTable&&n)for(a=0;a<e.length;a++)for(var l=e[a],d=0;d<l.childWidgets.length;d++)l.childWidgets[d].shiftWidgetForRtlTable();0<i.tableFormat.cellSpacing&&(s.y+s.height+j.convertPointToPixel(i.tableFormat.cellSpacing)>o.clientArea.bottom&&o instanceof Wd&&(s.height=s.height-j.convertPointToPixel(i.tableFormat.cellSpacing)/2),o.cutFromTop(s.y+s.height)),this.viewer instanceof Wd&&(i.containerWidget.height+=i.height),i.bodyWidget instanceof Xd&&!i.wrapTextAround&&(i.containerWidget.height+=i.height,this.viewer.owner.enableHeaderAndFooter)&&-1!==i.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(i.bodyWidget,this.viewer)},t.prototype.updateHeightForTableWidget=function(e,t,i,n){for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[r];if(o===n)break;this.updateHeightForRowWidget(this.viewer,!0,e,t,o,!1,n)}},t.prototype.layoutRow=function(e,t,i){for(var n=t.ownerTable.isInsideTable,r=(n||this.updateExistingFootnoteHeight(t),this.viewer),o=(this.addTableRowWidget(r.clientActiveArea,[t]),r.updateClientAreaForRow(t,!0),this.getMaxTopCellMargin(t)),s=this.getMaxBottomCellMargin(t),a=0;a<t.childWidgets.length;a++){var l=t.childWidgets[a];this.layoutCell(l,o+t.topBorderWidth,s+t.bottomBorderWidth)}r.updateClientAreaForRow(t,!1);r=[t];return i||this.updateWidgetsToTable(e,r,t,!1),n||(this.layoutedFootnoteElement=[]),r[r.length-1]},t.prototype.updateExistingFootnoteHeight=function(e){this.layoutedFootnoteElement=[],_.isNullOrUndefined(e.bodyWidget.page.footnoteWidget)||0===e.bodyWidget.page.footnoteWidget.bodyWidgets.length?this.existFootnoteHeight=0:this.existFootnoteHeight=e.bodyWidget.page.footnoteWidget.height},t.prototype.isIntersecting=function(e,t,i,n){return(j.round(i,2)<=j.round(e,2)||j.round(i,2)<j.round(t,2))&&j.round(n,2)>j.round(e,2)},t.prototype.getAdjacentRowCell=function(e,t,i,n){var r=[],o=e.ownerTable.tableHolder.columns.length,s=e.ownerTable.childWidgets[n];if(!_.isNullOrUndefined(s)){var a=0,l=0,d=e.cellFormat.columnSpan,h=e.columnIndex;if(0<s.rowFormat.gridBefore){if(s.rowFormat.gridBefore>h+d)return r;a=s.rowFormat.beforeWidth,l=s.rowFormat.gridBefore}for(var c=0;c<s.childWidgets.length;c++){var p=s.childWidgets[c],u=p.x-p.margin.left,g=p.x+p.width+p.margin.right,m=p.columnIndex+p.cellFormat.columnSpan;if(c==s.childWidgets.length-1||j.round(u,2)>j.round(a,2)&&j.round(u,2)>j.round(t,2)){if(c==s.childWidgets.length-1&&0<s.rowFormat.gridAfter&&m+s.rowFormat.gridAfter===o)return r;if(this.isIntersecting(t,i,a,u))for(;0<d;){var f,y=s.getVerticalMergeStartCell(h,d);if(_.isNullOrUndefined(y))break;var v=y.cellFormat.columnSpan;if(r.push(y),f=y.x+y.width+y.margin.right,d-=(l=y.columnIndex+v)-h,h=l,j.round(t=f,2)>=j.round(i,2))break}}if(this.isIntersecting(t,i,u,g)&&(r.push(p),t=g,d-=m-h,h=m),j.round(g,2)>=j.round(i,2))break;a=g,l=m}}return r},t.prototype.addTableRowWidget=function(e,t){var i=t[t.length-1],n=(0===i.rowFormat.beforeWidth&&0===i.rowFormat.gridBeforeWidth||this.documentHelper.alignTablesRowByRow&&"Left"!==i.ownerTable.tableFormat.tableAlignment?i.x=e.x:i.x+=0!==i.rowFormat.beforeWidth?i.rowFormat.beforeWidth:i.rowFormat.gridBeforeWidth,i.y=e.y,i.width=e.width,0);if(!_.isNullOrUndefined(i.ownerTable)&&!_.isNullOrUndefined(i.ownerTable.tableFormat)&&0<i.ownerTable.tableFormat.cellSpacing){i.height=i.height+j.convertPointToPixel(i.ownerTable.tableFormat.cellSpacing);for(var r,o=0;o<i.childWidgets.length;o++)_.isNullOrUndefined(i.childWidgets[o].cellFormat)||_.isNullOrUndefined(i.childWidgets[o].cellFormat.borders)||n<(r=N.getCellBottomBorder(i.childWidgets[o]).getLineWidth())&&(n=r);if(i.bottomBorderWidth=j.convertPointToPixel(n),0<i.index&&!_.isNullOrUndefined(i.previousWidget)){for(var s,a=i.previousWidget,n=0,l=0;l<a.childWidgets.length;l++)_.isNullOrUndefined(a.childWidgets[l].cellFormat)||_.isNullOrUndefined(a.childWidgets[l].cellFormat.borders)||n<(s=N.getCellBottomBorder(a.childWidgets[l]).getLineWidth())&&(n=s);i.topBorderWidth=j.convertPointToPixel(n)}}if(!_.isNullOrUndefined(i.childWidgets))for(var d,l=0;l<i.childWidgets.length;l++)_.isNullOrUndefined(i.childWidgets[l].cellFormat)||_.isNullOrUndefined(i.childWidgets[l].cellFormat.borders)||n<(d=N.getCellTopBorder(i.childWidgets[l]).getLineWidth())&&(n=d);if(i.topBorderWidth=j.convertPointToPixel(n),!_.isNullOrUndefined(i.ownerTable)&&!_.isNullOrUndefined(i.ownerTable.tableFormat)&&i.ownerTable.tableFormat.cellSpacing<=0&&i.rowIndex===i.ownerTable.childWidgets.length-1){for(var h,l=0;l<i.childWidgets.length;l++)_.isNullOrUndefined(i.childWidgets[l].cellFormat)||_.isNullOrUndefined(i.childWidgets[l].cellFormat.borders)||n<(h=N.getCellBottomBorder(i.childWidgets[l]).getLineWidth())&&(n=h);i.bottomBorderWidth=j.convertPointToPixel(n)}return i},t.prototype.getMaxTopCellMargin=function(e){if(_.isNullOrUndefined(e.childWidgets))return 0;for(var t=0,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i],r=0;t<(r=n.cellFormat.hasValue("topMargin")?j.convertPointToPixel(n.cellFormat.topMargin):e.rowFormat.hasValue("topMargin")?j.convertPointToPixel(e.rowFormat.topMargin):j.convertPointToPixel(e.ownerTable.tableFormat.topMargin))&&(t=r)}return t},t.prototype.getMaxBottomCellMargin=function(e){if(_.isNullOrUndefined(e.childWidgets))return 0;for(var t=0,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i],r=0;t<(r=n.cellFormat.hasValue("bottomMargin")?j.convertPointToPixel(n.cellFormat.bottomMargin):e.rowFormat.hasValue("bottomMargin")?j.convertPointToPixel(e.rowFormat.bottomMargin):j.convertPointToPixel(e.ownerTable.tableFormat.bottomMargin))&&(t=r)}return t},t.prototype.layoutCell=function(e,t,i){var n=this.viewer;this.addTableCellWidget(e,n.clientActiveArea,t,i),this.updateTopBorders(e),n.updateClientAreaForCell(e,!0),0===e.childWidgets.length&&((t=new G).characterFormat=new B,t.paragraphFormat=new Xa,t.index=0,i=new uh(t),t.childWidgets.push(i),e.childWidgets.push(t),t.paragraphFormat.borders=new qa);for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];n.updateClientAreaForBlock(o,!0),o.containerWidget=e,this.layoutBlock(o,0),n.updateClientAreaForBlock(o,!1)}this.updateWidgetToRow(e),n.updateClientAreaForCell(e,!1)},t.prototype.isInsertTable=function(){return!(!this.documentHelper.owner.editorHistoryModule||!this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo||"InsertTable"!==this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.action)},t.prototype.updateTopBorders=function(e){if(e.updatedTopBorders=[],0===e.ownerTable.tableFormat.cellSpacing)for(var t=e.cellFormat.borders.top,i=((t=!t.isBorderDefined||t.isBorderDefined&&"None"===t.lineStyle&&0===t.lineWidth&&t.hasValue("color")?e.ownerRow.rowFormat.borders.horizontal:t).isBorderDefined||(t=e.ownerRow.ownerTable.tableFormat.borders.horizontal),e.x-e.margin.left),n=e.x+e.width+e.margin.right,r=this.getAdjacentRowCell(e,i,n,e.ownerRow.indexInOwner-1),o=0;o<r.length;o++){var s,a=r[o],l=a.cellFormat.borders.bottom,d=((l=!l.isBorderDefined||l.isBorderDefined&&"None"===l.lineStyle&&0===l.lineWidth&&l.hasValue("color")?a.ownerRow.rowFormat.borders.horizontal:l).isBorderDefined||(l=a.ownerRow.ownerTable.tableFormat.borders.horizontal),void 0),d="None"===t.lineStyle||"Cleared"===t.lineStyle?l:"Cleared"===l.lineStyle||"None"===l.lineStyle?t:e.getBorderBasedOnPriority(t,l),l=a.x-a.margin.left,a=a.x+a.width+a.margin.right;0===o&&i<l&&e.updatedTopBorders.push({border:t,width:l-i}),d&&(s=0,(s=j.round(a,2)===j.round(n,2)&&j.round(l,2)===j.round(i,2)?n-i:j.round(l,2)>=j.round(i,2)&&j.round(a,2)>=j.round(n,2)?n-l:j.round(l,2)>=j.round(i,2)&&j.round(a,2)<=j.round(n,2)?a-l:j.round(l,2)<=j.round(i,2)&&j.round(a,2)<=j.round(n,2)?a-i:(j.round(l,2)<=j.round(i,2)&&(j.round(a,2),j.round(n,2)),n-i))<0&&(s=0),e.updatedTopBorders.push({border:d,width:s})),o===r.length-1&&a<n&&e.updatedTopBorders.push({border:t,width:n-a})}},t.prototype.shiftLayoutedItems=function(e,t){if(_.isNullOrUndefined(this.documentHelper.blockToShift)||_.isNullOrUndefined(this.documentHelper.blockToShift.containerWidget))this.documentHelper.blockToShift=void 0,this.checkAndShiftEndnote(),e||this.documentHelper.removeEmptyPages();else{var i=this.documentHelper.blockToShift,n=this.getColumnBreak(i.bodyWidget),r=(!n&&this.viewer instanceof Sd&&!this.isMultiColumnSplit&&i===i.bodyWidget.firstChild&&!_.isNullOrUndefined(i.bodyWidget.previousRenderedWidget)&&i.bodyWidget.sectionIndex!==i.bodyWidget.previousRenderedWidget.sectionIndex&&1<i.bodyWidget.previousRenderedWidget.sectionFormat.columns.length&&(y=i.bodyWidget.previousRenderedWidget,o=this.getBodyWidget(y,!1),_.isNullOrUndefined(o.nextRenderedWidget)||o.page!==o.nextRenderedWidget.page||this.splitBodyWidgetBasedOnColumn(y)),!1),o=this.documentHelper.pages[this.documentHelper.pages.length-1];o.bodyWidgets[o.bodyWidgets.length-1];if((!n||e&&this.isSectionEndsWithColumnBreak(i.bodyWidget))&&this.viewer instanceof Sd&&!this.isMultiColumnSplit&&1<i.bodyWidget.sectionFormat.columns.length){if(0!==i.bodyWidget.columnIndex||i!==i.bodyWidget.firstChild||_.isNullOrUndefined(i.previousRenderedWidget)||i.bodyWidget.page!==i.previousRenderedWidget.bodyWidget.page||(i.bodyWidget.y=this.viewer.clientActiveArea.y),r=i===i.bodyWidget.firstChild,this.reLayoutMultiColumn(i.bodyWidget,r,i.index),_.isNullOrUndefined(this.documentHelper.blockToShift))return;i=this.documentHelper.blockToShift}for(var s=i.bodyWidget.index,a=(this.reLayoutOrShiftWidgets(i,this.viewer,t),!0),l=i.getSplitWidgets(),d=l[l.length-1].nextRenderedWidget;d instanceof Qd&&(d.bodyWidget.index===s||"NoBreak"===d.bodyWidget.sectionFormat.breakCode&&i.bodyWidget.sectionFormat.pageWidth===d.bodyWidget.sectionFormat.pageWidth&&i.bodyWidget.sectionFormat.pageHeight===d.bodyWidget.sectionFormat.pageHeight);){if(t&&0===d.bodyWidget.sectionFormat.columns.length)return;if((!(n=this.getColumnBreak(d.bodyWidget))||e&&this.isSectionEndsWithColumnBreak(d.bodyWidget))&&this.viewer instanceof Sd&&!this.isMultiColumnSplit&&1<d.bodyWidget.sectionFormat.columns.length){if(0!==d.bodyWidget.columnIndex||d!==d.bodyWidget.firstChild||_.isNullOrUndefined(d.previousRenderedWidget)||d.bodyWidget.page!==d.previousRenderedWidget.bodyWidget.page||(d.bodyWidget.y=this.viewer.clientActiveArea.y),r=d===d.bodyWidget.firstChild,this.reLayoutMultiColumn(d.bodyWidget,r,d.index),_.isNullOrUndefined(this.documentHelper.blockToShift))return;d=this.documentHelper.blockToShift}var h=(p=i.getSplitWidgets())[p.length-1],a=!1,c=void 0,p=(i=d).getSplitWidgets();if((i instanceof G||i instanceof K)&&(c=p[0]),!this.documentHelper.owner.editorModule.isFootnoteElementRemoved&&h.containerWidget===c.containerWidget&&j.round(c.y,2)===j.round(this.viewer.clientActiveArea.y,2)&&_.isNullOrUndefined(c.nextWidget))break;if(_.isNullOrUndefined(h.floatingElements),a=!0,i.isFieldCodeBlock||this.reLayoutOrShiftWidgets(i,this.viewer,t),this.keepWithNext&&(i=this.documentHelper.blockToShift,this.keepWithNext=!1),!this.isMultiColumnSplit&&n&&1<i.bodyWidget.sectionFormat.numberOfColumns&&i.bodyWidget.nextWidget&&i.nextRenderedWidget&&i.bodyWidget.index!==i.nextRenderedWidget.bodyWidget.index&&(p=this.viewer.clientActiveArea.y,c=this.viewer.clientActiveArea.height,this.viewer.updateClientArea(i.bodyWidget.nextWidget,i.bodyWidget.nextWidget.page),this.viewer.clientActiveArea.height=c,this.viewer.clientActiveArea.y=p),this.isMultiColumnSplit&&1<i.bodyWidget.sectionFormat.numberOfColumns&&i===i.bodyWidget.lastChild&&!_.isNullOrUndefined(i.bodyWidget.nextRenderedWidget)&&i.bodyWidget.sectionIndex!==i.bodyWidget.nextRenderedWidget.sectionIndex&&i.bodyWidget.page===i.bodyWidget.nextRenderedWidget.page)return;d=(l=i.getSplitWidgets())[l.length-1].nextRenderedWidget}this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateListItemsTillEnd(i,a),this.documentHelper.blockToShift=void 0;var u,g,m,f,y=this.viewer,v=(y.owner.editorModule.isFootnoteElementRemoved&&(m=(o=this.documentHelper.pages[this.documentHelper.pages.length-1]).bodyWidgets[o.bodyWidgets.length-1],o=o.endnoteWidget,_.isNullOrUndefined(o)||(u=this.viewer.clientArea.clone(),g=this.viewer.clientActiveArea.clone(),f=m.y,0<m.childWidgets.length&&(f=(m=m.childWidgets[m.childWidgets.length-1]).y+m.height),this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-f,this.viewer.clientActiveArea.x=this.viewer.clientArea.x,this.viewer.clientActiveArea.width=this.viewer.clientArea.width,this.viewer.clientActiveArea.y=f,this.layoutfootNote(o),this.viewer.clientArea=u,this.viewer.clientActiveArea=g)),this.documentHelper.removeEmptyPages(),this.updateFieldElements(e),this.documentHelper.pages[0]);if(0<v.bodyWidgets[0].sectionIndex){for(var w=v;this.documentHelper.layout.layoutHeaderFooter(w.bodyWidgets[0],this.viewer,w),w=w.nextPage;);for(;0<v.bodyWidgets[0].sectionIndex;)this.documentHelper.owner.editorModule.updateSectionIndex(void 0,v.bodyWidgets[0],!1)}i.bodyWidget instanceof q||this.isRelayoutFootnote||!i.bodyWidget.page.endnoteWidget||this.checkAndShiftEndnote(!0),(this.documentHelper.owner.enableLockAndEdit||this.documentHelper.owner.enableHeaderAndFooter)&&e||this.isMultiColumnSplit||y.updateScrollBars()}},t.prototype.isSectionEndsWithColumnBreak=function(e){return!_.isNullOrUndefined(e)&&0<e.childWidgets.length&&e.lastChild instanceof G&&e.lastChild.isEndsWithColumnBreak},t.prototype.checkAndShiftEndnote=function(e){var t,i;this.documentHelper.owner.selectionModule&&(!(t=(t=this.documentHelper.owner.selectionModule.end.paragraph).isInsideTable?this.getParentTable(t):t)||t.isInHeaderFooter||t.bodyWidget.containerWidget instanceof q||!_.isNullOrUndefined(t.nextRenderedWidget)&&!e?this.isEndnoteContentChanged&&e&&!this.isRelayoutFootnote&&this.reLayoutEndnote():t.bodyWidget instanceof q||this.isRelayoutFootnote||!t.bodyWidget.page.endnoteWidget||(e=t.bodyWidget.page,t=this.viewer.clientActiveArea.clone(),i=this.getBodyWidget(e.bodyWidgets[e.bodyWidgets.length-1],!0),this.viewer.updateClientArea(i,i.page),0<(i=this.getNextWidgetHeight(i))&&(this.viewer.clientActiveArea.height-=i-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=i),this.layoutfootNote(e.endnoteWidget),this.viewer.clientActiveArea=t))},t.prototype.updateFieldElements=function(e){for(var t=0;t<this.documentHelper.fields.length;t++){var i,n,r,o,s,a=this.documentHelper.fields[t];!(this.viewer instanceof Sd||this.viewer instanceof Wd&&!(a.line.paragraph.containerWidget instanceof fc||a.line.paragraph.bodyWidget instanceof Xd))||_.isNullOrUndefined(this.documentHelper.selection)||(o=this.documentHelper.selection.getFieldCode(a),s=/^(?!.*\bhyperlink\b).*\bpage\b.*$/,_.isNullOrUndefined(o))||!(o.toLowerCase().match("numpages")||o.toLowerCase().match("sectionpages")||s.test(o.toLowerCase())&&e)||_.isNullOrUndefined(a.fieldSeparator)||(i=a.fieldSeparator.nextNode,!_.isNullOrUndefined(i)&&(n=i.text,r=a.line.paragraph,_.isNullOrUndefined(r.containerWidget)||r.containerWidget instanceof Xd||-1!==r.containerWidget.indexInOwner)&&!_.isNullOrUndefined(r.bodyWidget)&&!_.isNullOrUndefined(r.bodyWidget.page)&&-1!==r.bodyWidget.page.index&&(s.test(o.toLowerCase())?(s=r.bodyWidget.page.index+1,i.text=s.toString()):i.text=this.documentHelper.pages.length.toString(),n!==i.text)&&(i.isWidthUpdated=!1,o=r.childWidgets.indexOf(a.line),s=a.line.children.indexOf(i),r.isInsideTable?this.reLayoutParagraph(r,o,s):this.reLayoutLine(r,o,!1,!1,!0)))}},t.prototype.reLayoutOrShiftWidgets=function(e,t,i){var n=e,r=!1;if(this.isNeedToRelayout(e.bodyWidget)||this.isPageBreakInsideContentControl(e)?(this.isMultiColumnSplit||this.updateContainerForTable(n,t),n instanceof K&&(n=n.combineWidget(this.viewer),this.clearTableWidget(n,!0,!0,!0)),t.updateClientAreaForBlock(n,!0),n.wrapTextAround&&(n.isLayouted=!1),this.isRelayout=!0,this.layoutBlock(n,0),this.isRelayout=!1,t.updateClientAreaForBlock(n,!1),r=!0):this.shiftWidgetsBlock(n,t),0<this.documentHelper.pages.indexOf(n.bodyWidget.page)&&n===n.bodyWidget.childWidgets[0]&&n instanceof G)for(var o=n.bodyWidget.childWidgets[0].childWidgets[0].children,s=0;s<o.length;s++){var a=o[s];0<a.margin.top&&a.margin.top===this.getBeforeSpacing(a.paragraph)&&(a.margin.top-=this.getBeforeSpacing(a.paragraph))}!this.viewer.owner.editorModule||r||i||this.viewer.owner.editorModule.updateRenderedListItems(n),!this.isRelayoutFootnote&&n.bodyWidget.page.footnoteWidget&&(this.islayoutFootnote=!0,this.layoutfootNote(n.bodyWidget.page.footnoteWidget))},t.prototype.isNeedToRelayout=function(e){for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t];if(i instanceof K||i instanceof hc&&("Square"===i.textWrappingStyle||"TopAndBottom"===i.textWrappingStyle))return!0}return!1},t.prototype.shiftWidgetsBlock=function(e,t){e instanceof G?this.shiftWidgetsForPara(e,t):e instanceof K&&this.shiftWidgetsForTable(e,t)},t.prototype.shiftWidgetsForPara=function(e,t){if(!(e.height>t.clientArea.height+t.clientArea.y)||this.documentHelper.owner.enableHeaderAndFooter){e.bodyWidget;for(var i=this.getBodyWidgetOfPreviousBlock(e,0),n=i.bodyWidget,r=i.index,o=void 0,s=!1,a=!0,l=0;l<e.getSplitWidgets().length;l++){var d=e.getSplitWidgets()[l],h=this.getBodyWidget(d.bodyWidget,!0);if(!this.isMultiColumnSplit||d===e){if(a&&!_.isNullOrUndefined(o)){var c=!!o.lastChild&&o.lastChild.isEndsWithPageBreak,p=!!o.lastChild&&o.lastChild.isEndsWithColumnBreak;if(this.shiftToPreviousWidget(d,t,o,c,p),this.updateFloatingElementPosition(o),(_.isNullOrUndefined(d.childWidgets)||0===d.childWidgets.length)&&!c&&!p){l--;continue}n!==d.containerWidget&&(n=d.containerWidget,c)&&o!==d.previousSplitWidget&&t.updateClientAreaByWidget(d),o=void 0}var u=[];if(s||(u=this.getFootNoteWidgetsOf(d)),s=!1,this.isFitInClientArea(d,t,u)||this.isMultiColumnSplit&&d.bodyWidget.sectionFormat.numberOfColumns-1!==d.bodyWidget.columnIndex){if(this.keepWithNext&&(this.updateClientPositionForBlock(d.containerWidget.firstChild,d),this.keepWithNext=!1),t.updateClientAreaForBlock(o=d,!0,void 0,!1,!0),d.isEmpty()&&!_.isNullOrUndefined(d.paragraphFormat)&&("Center"===d.paragraphFormat.textAlignment||"Right"===d.paragraphFormat.textAlignment||"Justify"===d.paragraphFormat.textAlignment&&d.paragraphFormat.bidi)&&-1===d.paragraphFormat.listFormat.listId?this.updateXPositionForEmptyParagraph(t.clientActiveArea,d):d.x=t.clientActiveArea.x,t.updateClientAreaForBlock(d,!1),d.y=t.clientActiveArea.y,this.updateFloatingElementPosition(d),t.cutFromTop(t.clientActiveArea.y+d.height),_.isNullOrUndefined(n)||n===d.containerWidget||this.isMultiColumnSplit){if(d.containerWidget instanceof z&&d.containerWidget.firstChild===d&&d.previousRenderedWidget&&d.previousRenderedWidget instanceof G&&"NoBreak"==d.previousRenderedWidget.containerWidget.sectionFormat.breakCode&&d.containerWidget.page.index!==d.previousRenderedWidget.containerWidget.page.index&&d.containerWidget.index!==d.previousRenderedWidget.containerWidget.index){var g=d.previousRenderedWidget.bodyWidget,m=g.sectionFormat.breakCode,g=(1<g.sectionFormat.columns.length&&(g=this.getBodyWidget(g,!0)),_.isNullOrUndefined(g.previousRenderedWidget)||"NoBreak"!==g.sectionFormat.breakCode||"NewPage"!=g.previousRenderedWidget.sectionFormat.breakCode||g.page.index!==g.previousRenderedWidget.page.index||(m=g.previousRenderedWidget.sectionFormat.breakCode),j.round(this.getNextWidgetHeight(g)+d.height,2));if(!d.previousRenderedWidget.containerWidget.lastChild.isEndsWithPageBreak&&!d.previousRenderedWidget.containerWidget.lastChild.isEndsWithColumnBreak&&g<=j.round(this.viewer.clientActiveArea.bottom,2)&&"NoBreak"===m){for(var f=d.previousRenderedWidget.bodyWidget.page,y=d.containerWidget.page,v=0;v<y.bodyWidgets.length;v++){var w=y.bodyWidgets[v];y.bodyWidgets.splice(y.bodyWidgets.indexOf(w),1),f.bodyWidgets.splice(f.bodyWidgets.length,0,w),w.page=f,v--}d.containerWidget.y=this.viewer.clientActiveArea.y,this.documentHelper.removeEmptyPages()}}}else if(r++,n.lastChild.isEndsWithPageBreak||n.lastChild.isEndsWithColumnBreak||this.isPageBreakInsideContentControl(n.lastChild)||this.updateContainerWidget(d,n,r,!0,u),0<u.length&&n.page.footnoteWidget)for(var b=0;b<u.length;b++)-1===n.page.footnoteWidget.bodyWidgets.indexOf(u[b])&&d.bodyWidget.page.index!=u[b].page.index&&(n.page.footnoteWidget.bodyWidgets.push(u[b]),n.page.footnoteWidget.height+=u[b].height);!this.isInitialLoad&&a&&1<d.bodyWidget.sectionFormat.columns.length&&d===d.bodyWidget.firstChild&&!_.isNullOrUndefined(h.previousWidget)&&h.page===h.previousWidget.page&&(this.viewer.updateClientArea(d.bodyWidget,d.bodyWidget.page),h=this.getBodyWidget(h.previousWidget,!0),g=this.getNextWidgetHeight(h),d.bodyWidget.y=g,this.viewer.clientActiveArea.height-=g-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=g,a=!1,l--),(d.isEndsWithPageBreak&&!this.isPageBreakInsideField(d)||d.isEndsWithColumnBreak||this.isPageBreakInsideContentControl(d))&&this.viewer instanceof Sd&&(w=this.createOrGetNextBodyWidget(n,this.viewer),w=this.moveBlocksToNextPage(d,!0),t.updateClientArea(w,w.page))}else{m=d.previousRenderedWidget,c=!1,p=!1,h=(m instanceof G&&m.isEndsWithPageBreak&&this.viewer instanceof Sd&&(c=!0),m instanceof G&&m.isEndsWithColumnBreak&&this.viewer instanceof Sd&&(p=!0),this.splitWidget(d,t,n,r+1,c,u,p));this.updateFloatingElementPosition(d),o=void 0,n!==d.containerWidget&&(n=d.containerWidget,l--,0<u.length)&&(s=!0),r=n.childWidgets.indexOf(d),h&&(n=e.getSplitWidgets()[l+1].containerWidget)}}}this.skipUpdateContainerWidget=!1}},t.prototype.updateFloatingElementPosition=function(e){if(0<e.floatingElements.length)for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],n=0;if(i instanceof uc&&"Inline"===i.textWrappingStyle){for(var r=i.line.indexInOwner,o=0,n=j.convertPointToPixel(i.textFrame.marginTop),s=0;s<r;s++)_.isNullOrUndefined(e.childWidgets[s])||(o+=e.childWidgets[s].height);i.y=e.y+o}else{var a=this.getFloatingItemPoints(i);i.y=a.y,i.x=a.x}i instanceof uc&&this.updateChildLocationForCellOrShape(i.y+n,i,void 0,!1,!0)}},t.prototype.isPageBreakInsideField=function(e){for(var t=!1,i=!1,n=0,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];n+=o.height;for(var s=0;s<o.children.length;s++){var a=o.children[s];a instanceof Z&&(0===a.fieldType?i=!0:2!==a.fieldType&&1!==a.fieldType||(i=!1)),t=!(!i&&"\f"===a.text)}}return t&&0===e.height&&this.viewer.cutFromTop(this.viewer.clientActiveArea.y+n),t},t.prototype.isPageBreakInsideContentControl=function(e){var t=!1;return t=e instanceof G&&0<e.childWidgets.length&&0<(e=e.childWidgets[e.childWidgets.length-1]).children.length&&(e=e.children[e.children.length-1])instanceof E&&"Block"===e.contentControlWidgetType&&!_.isNullOrUndefined(e.previousElement)&&e.previousElement instanceof X&&"\f"===e.previousElement.text?!0:t},t.prototype.getFootNotesOfBlock=function(e,t){if(_.isNullOrUndefined(t)&&(t=[]),0<e.childWidgets.length)for(var i=0;i<this.documentHelper.footnoteCollection.length;i++)this.documentHelper.footnoteCollection[i].line.paragraph===e&&t.push(this.documentHelper.footnoteCollection[i]);return t},t.prototype.getFootNotesWidgetsInLine=function(e){for(var t=[],i=0;i<e.children.length;i++){var n=e.children[i];n instanceof Bh&&t.push(n)}return this.getFootNoteWidgetsBy(e.paragraph,t)},t.prototype.getFootNoteWidgetsBy=function(e,t){var i=[];if(e.bodyWidget.page.footnoteWidget)for(var n=0;n<e.bodyWidget.page.footnoteWidget.bodyWidgets.length;n++)for(var r=0;r<t.length;r++)e.bodyWidget.page.footnoteWidget.bodyWidgets[n].footNoteReference===t[r]&&i.push(e.bodyWidget.page.footnoteWidget.bodyWidgets[n]);if(0===i.length&&!_.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget.bodyWidget.page.footnoteWidget)for(n=0;n<e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets.length;n++)for(r=0;r<t.length;r++)e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets[n].footNoteReference===t[r]&&i.push(e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets[n]);else if(!_.isNullOrUndefined(e.bodyWidget.previousRenderedWidget)&&e.bodyWidget.previousRenderedWidget.page.footnoteWidget)for(n=0;n<e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets.length;n++)for(r=0;r<t.length;r++)e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets[n].footNoteReference===t[r]&&i.push(e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets[n]);else if(!_.isNullOrUndefined(e.bodyWidget.nextRenderedWidget)&&e.bodyWidget.nextRenderedWidget.page.footnoteWidget)for(n=0;n<e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets.length;n++)for(r=0;r<t.length;r++)e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets[n].footNoteReference===t[r]&&i.push(e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets[n]);return i},t.prototype.getFootNoteWidgetsOf=function(e,t){var i=[],n=[];if(e instanceof K)for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++)for(var a=o.childWidgets[s],l=0;l<a.childWidgets.length;l++)for(var d=a.childWidgets[l],n=this.getFootNotesOfBlock(d,n),h=this.getFootNoteWidgetsBy(d,n),c=0;c<h.length;c++)-1===i.indexOf(h[c])&&i.push(h[c]);else if(0<(n=this.getFootNotesOfBlock(e)).length&&(i=this.getFootNoteWidgetsBy(e,n)),t&&0===i.length)for(var p=0;p<n.length;p++)i.push(n[p].bodyWidget);return i},t.prototype.getFootNodeWidgetsToShiftToPage=function(e){for(var t,i=e.getSplitWidgets(),n=[],r=e.containerWidget,o=0;o<i.length;o++)for(var s=this.getFootNoteWidgetsOf(i[o]),a=0;a<s.length;a++)r!==(t=s[a].containerWidget)&&n.push(s[a]);return{footNoteWidgets:n,fromBodyWidget:t,toBodyWidget:r}},t.prototype.shiftTableWidget=function(e,t,i){void 0===i&&(i=!1);for(var n,r,o=[e],s=(this.addTableWidget(this.viewer.clientActiveArea,o),this.viewer.updateClientAreaTopOrLeft(e,!0),e.wrapTextAround&&(n=this.viewer.clientActiveArea.clone(),r=this.viewer.clientArea.clone(),this.updateClientAreaForWrapTable(o,e,!0,n,r)),e.childWidgets[0]);s;)s=(s=this.shiftRowWidget(o,s,i)).nextRow;return this.updateWidgetsToPage(o,[],e,!0),e.wrapTextAround&&e.bodyWidget&&this.updateClientAreaForWrapTable(o,e,!1,n,r),o[o.length-1]},t.prototype.shiftRowWidget=function(e,t,i){var n=this.viewer,r=((i=void 0===i?!1:i)&&(t.height=0),t.ownerTable.isInsideTable),o=(r||this.updateExistingFootnoteHeight(t),[t]);this.addTableRowWidget(n.clientActiveArea,o),n.updateClientAreaForRow(t,!0);for(var s=0;s<t.childWidgets.length;s++){var a=t.childWidgets[s];i&&(a.height=0),this.shiftCellWidget(a,this.getMaxTopCellMargin(t)+t.topBorderWidth,this.getMaxBottomCellMargin(t)+t.bottomBorderWidth,i)}return n.updateClientAreaForRow(t,!1),r||(n=this.footnoteHeight,this.updateFootnoteToBody(t,this.layoutedFootnoteElement),this.footnoteHeight=n),this.updateWidgetsToTable(e,o,t,!1),r||(this.layoutedFootnoteElement=[]),o[o.length-1]},t.prototype.updateFootnoteToBody=function(e,t){this.layoutFootnoteInSplittedRow(e,this.getFootnoteBody(t)),_.isNullOrUndefined(e.ownerTable.footnoteElement)&&(e.ownerTable.footnoteElement=[]);for(var i=0;i<t.length;i++)e.ownerTable.footnoteElement.push(t[i])},t.prototype.getFootnoteBody=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].bodyWidget);return t},t.prototype.shiftCellWidget=function(e,t,i,n){_.isNullOrUndefined(n)&&(n=!1);var r=this.viewer,t=(this.addTableCellWidget(e,r.clientActiveArea,t,i),this.viewer.clientActiveArea.height);r.updateClientAreaForCell(e,!0);for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];r.updateClientAreaForBlock(s,!0),s instanceof G?this.shiftParagraphWidget(s):this.shiftTableWidget(s,r,n),r.updateClientAreaForBlock(s,!1)}this.updateWidgetToRow(e),r.updateClientAreaForCell(e,!1),e.ownerTable.isInsideTable||(this.viewer.clientActiveArea.height=t)},t.prototype.shiftParagraphWidget=function(e){if(this.addParagraphWidget(this.viewer.clientActiveArea,e),0<e.floatingElements.length)for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],n=0;if(i instanceof uc&&"Inline"===i.textWrappingStyle){for(var r=i.line.indexInOwner,o=0,n=j.convertPointToPixel(i.textFrame.marginTop),s=0;s<r;s++)o+=e.childWidgets[s].height;i.y=e.y+o}else{var a=this.getFloatingItemPoints(i);i.y=a.y,i.x=a.x}i instanceof uc&&this.updateChildLocationForCellOrShape(i.y+n,i)}this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height);for(var l=this.getFootNoteWidgetsOf(e,!0),d=0;d<l.length;d++)this.layoutedFootnoteElement.push(l[d].footNoteReference);this.footnoteHeight+=this.getFootNoteHeight(l),this.updateWidgetToPage(this.viewer,e)},t.prototype.updateContainerForTable=function(e,t){var i=this.getBodyWidgetOfPreviousBlock(e,0),n=i.bodyWidget,i=i.index,r=!_.isNullOrUndefined(n.lastChild)&&!_.isNullOrUndefined(n.lastChild.lastChild)&&n.lastChild.lastChild.isEndsWithPageBreak,o=!_.isNullOrUndefined(n.lastChild)&&!_.isNullOrUndefined(n.lastChild.lastChild)&&n.lastChild.lastChild.isEndsWithColumnBreak;n!==e.containerWidget&&(r||o?t.updateClientArea(e.bodyWidget,e.bodyWidget.page):this.updateContainerWidget(e,n,i+1,!0)),(e.isInHeaderFooter||this.viewer instanceof Wd)&&(e.containerWidget.height-=e.height)},t.prototype.shiftWidgetsForTable=function(e,t){this.updateContainerForTable(e,t),this.viewer.updateClientAreaForBlock(e,!0,void 0,!1,!0);var t=this.viewer.clientArea.x,i=("Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-j.convertPointToPixel(e.firstChild.firstChild.leftMargin)),this.updateVerticalPositionToTop(e,!0),e.combineWidget(this.viewer));this.documentHelper.layout.updateChildLocationForTable(i.y,i),this.clearTableWidget(i,!0,!1,!1,!0),this.shiftTableWidget(i,this.viewer),this.updateVerticalPositionToTop(e,!1),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientArea.x=t),this.viewer.updateClientAreaForBlock(e,!1)},t.prototype.updateVerticalPositionToTop=function(e,t){for(var i=0;i<e.getSplitWidgets().length;i++)for(var n=e.getSplitWidgets()[i],r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];this.documentHelper.layout.updateCellVerticalPosition(a,t,!1)}},t.prototype.splitWidget=function(e,t,i,n,r,o,s){var a=e.childWidgets[0],l=e.paragraphFormat.keepLinesTogether&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?e.height:this.getMaxElementHeight(a),d=e.getSplitWidgets(),h=e.containerWidget,l=this.getMaximumLineHeightToSplit(e,l,t),c=this.getFootNotesWidgetsInLine(a);if(_.isNullOrUndefined(e.previousWidget)&&0<c.length)for(var p=0;p<c.length;p++)for(var u=0;u<c[p].childWidgets.length;u++)l+=c[p].childWidgets[u].height;if(t.clientActiveArea.height>=l&&!r&&!s){var g=void 0,a=d.indexOf(e);a<d.length-1?h=(g=d[a+1]).containerWidget:((g=new G).index=e.index,g.characterFormat=e.characterFormat,g.paragraphFormat=e.paragraphFormat,g.width=e.width,g.x=e.x,g.y=e.y,d.push(g)),i===e.containerWidget||this.skipUpdateContainerWidget||this.updateContainerWidget(e,i,n,!0);for(p=e.childWidgets.length-1;0<p;p--){var m=e.childWidgets[p];if(this.isFitInClientArea(e,t,void 0)){1===g.childWidgets.length&&(this.updateParagraphWidgetInternal(m,g,0),this.skipUpdateContainerWidget=!0);break}m=e.childWidgets[p];this.updateParagraphWidgetInternal(m,g,0)}if(_.isNullOrUndefined(g.containerWidget)&&0<g.childWidgets.length){var r=t.clientActiveArea.y,s=new Rd(t.clientArea.x,t.clientArea.y,t.clientArea.width,t.clientArea.height),a=new Rd(t.clientActiveArea.x,t.clientActiveArea.y,t.clientActiveArea.width,t.clientActiveArea.height),f=e.bodyWidget.page,h=this.moveBlocksToNextPage(e,!1,-1);if((g.containerWidget=h).childWidgets.splice(0,0,g),f===h.page)return e.x!==e.containerWidget.x&&(e.x=e.containerWidget.x),e.y=r,t.updateClientArea(h,h.page),g=this.addParagraphWidget(this.viewer.clientActiveArea,g),!0;if(h.height+=g.height,h!=i&&this.moveFootNotesToPage(o,i,h),1===h.childWidgets.length&&h.firstChild instanceof G&&h.firstChild.equals(e))return e.y=r,!0;t.clientArea=s,t.clientActiveArea=a}}else{d=!1,n=0,r=(t.columnLayoutArea.setColumns(i.sectionFormat),h=this.createOrGetNextBodyWidget(i,this.viewer),this.alignBlockElement(e));if(this.isInitialLoad||_.isNullOrUndefined(r.node)||e.isEndsWithPageBreak||e.isEndsWithColumnBreak||!_.isNullOrUndefined(e.previousSplitWidget)||(s=r.node instanceof dh?this.splitRow(r.node):r.node).containerWidget instanceof z&&s.containerWidget.firstChild!==s&&(n=s instanceof K?0:parseInt(r.position.index,10),d=!0,!_.isNullOrUndefined((e=s).nextRenderedWidget))&&e.nextRenderedWidget instanceof G&&(this.keepWithNext=!0,this.documentHelper.blockToShift=e.nextRenderedWidget),e.containerWidget!==h||d){f=e.bodyWidget.page;if(i!==(h=this.moveBlocksToNextPage(e,!0))){if(t.updateClientArea(h,h.page),0<n&&this.keepWithNext){this.viewer.updateClientAreaForBlock(e,!0);var y=void 0;e instanceof K?this.addTableWidget(this.viewer.clientActiveArea,[e]):y=h.firstChild instanceof G&&h.firstChild.equals(e)?h.firstChild:new G,(y=this.moveChildsToParagraph(e,n,y)).containerWidget=h;for(var v=0;v<y.floatingElements.length;v++){var w=y.floatingElements[v];w.line.paragraph.bodyWidget!==e.bodyWidget&&"Inline"!==w.textWrappingStyle&&e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(w),1)}e=y,-1===h.childWidgets.indexOf(e)&&h.childWidgets.splice(0,0,e),this.viewer.updateClientAreaLocation(e,this.viewer.clientActiveArea),this.layoutBlock(e,0,!0),this.viewer.updateClientAreaForBlock(e,!1)}else this.updateContainerWidget(e,h,0,!0),this.addParagraphWidget(this.viewer.clientActiveArea,e);this.moveFootNotesToPage(o,i,h)}if(i.page===h.page)return i!==h||(t.updateClientArea(h,h.page),!1)}}return i===e.containerWidget?(e.y=t.clientActiveArea.y,t.cutFromTop(t.clientActiveArea.y+e.height)):t.updateClientArea(h,h.page),!1},t.prototype.getMaximumLineHeightToSplit=function(e,t,i){if(i.clientActiveArea.height>=t&&!e.paragraphFormat.keepLinesTogether&&e.paragraphFormat.widowControl&&!_.isNullOrUndefined(e.previousWidget)&&_.isNullOrUndefined(e.previousSplitWidget))for(var n=e.height,r=e.childWidgets.length-1;0<=r;r--){var o=e.childWidgets[r],s=this.getMaxElementHeight(o);if(o.height>s&&(n-=o.height-s),i.clientActiveArea.height>=n){0===r&&(t=e.height);break}n-=o.height}return t},t.prototype.moveFootNotesToPage=function(e,t,i){if(0<e.length&&t.page.footnoteWidget&&t.page!==i.page){for(var n=void 0,r=0,o=!1,s=0;s<e.length;s++)if(n=e[s],0<=(a=t.page.footnoteWidget.bodyWidgets.indexOf(n))){void 0===i.page.footnoteWidget&&this.addEmptyFootNoteToBody(i);for(var a,l,d=0;d<i.page.footnoteWidget.bodyWidgets.length;d++)i.page.footnoteWidget.bodyWidgets[d].footNoteReference===n.footNoteReference&&(o=!0);t.page.footnoteWidget.bodyWidgets.splice(a,1),i.page.footnoteWidget.bodyWidgets.indexOf(n)<0&&!o&&(i.page.footnoteWidget.bodyWidgets.length,a=this.documentHelper.pages.indexOf(t.page),l=this.documentHelper.pages.indexOf(i.page),n.containerWidget=i.page.footnoteWidget,n.page=i.page,l<a?(i.page.footnoteWidget.bodyWidgets.push(n),r++):i.page.footnoteWidget.bodyWidgets.splice(r++,0,n),i.page.footnoteWidget.height+=n.height),t.page.footnoteWidget.height-=n.height}t.page.footnoteWidget&&0===t.page.footnoteWidget.bodyWidgets.length&&(t.page.footnoteWidget=void 0),void 0!==t.page.footnoteWidget&&this.layoutfootNote(t.page.footnoteWidget),void 0!==i.page.footnoteWidget&&this.layoutfootNote(i.page.footnoteWidget)}},t.prototype.addEmptyFootNoteToBody=function(e){var t=new q,i=(t.footNoteType="Footnote",t.page=e.page,new G),n=(i.characterFormat=new B,i.paragraphFormat=new Xa,i.index=0,new uh(i));i.childWidgets.push(n),t.height=this.documentHelper.textHelper.getParagraphMarkSize(i.characterFormat).Height,t.margin=new Dd(0,t.height,0,0),e.page.footnoteWidget=t},t.prototype.getMaxElementHeight=function(e){var t=0;if(0===e.children.length||1===e.children.length&&e.children[0]instanceof Y||2===e.children.length&&e.children[0]instanceof Y&&e.children[1]instanceof Y){t=this.documentHelper.selection.getParagraphMarkSize(e.paragraph,0,0).height;t+=0,0<e.children.length&&t<(i=e.children[0]).margin.top+i.height&&(t=i.margin.top+i.height)}else for(var i,n=0;n<e.children.length;n++)t<(i=e.children[n]).margin.top+i.height&&(t=i.margin.top+i.height);return t},t.prototype.createOrGetNextBodyWidget=function(e,t){t.columnLayoutArea.setColumns(e.sectionFormat);var i,n,r,o=t.columnLayoutArea.getNextColumnByBodyWidget(e);return _.isNullOrUndefined(o)?(o=0,o=this.documentHelper.pages.indexOf(e.page),r=i=void 0,r=e.index,(o===this.documentHelper.pages.length-1||this.documentHelper.pages[o+1].sectionIndex!==r?((n=new z).sectionFormat=e.sectionFormat,n.index=e.index,i=t.createNewPage(n),this.documentHelper.pages[o+1].sectionIndex!==r&&this.documentHelper.insertPage(o+1,i),i):i=this.documentHelper.pages[o+1]).bodyWidgets[0]):this.createOrGetNextColumnBody(e)},t.prototype.isFitInClientArea=function(e,t,i){var n=e.childWidgets[e.childWidgets.length-1],e=e.height,r=this.getMaxElementHeight(n),o=(n.height>r&&(e-=n.height-r),0);if(!_.isNullOrUndefined(i)&&0<i.length){i[0].containerWidget instanceof q&&(o=i[0].containerWidget.margin.top);for(var s=0;s<i.length;s++)for(var a=0;a<i[s].childWidgets.length;a++)o+=i[s].childWidgets[a].height}return t.clientActiveArea.height>=e+o},t.prototype.isLineInFootNote=function(e,t){for(var i=0;i<t.length;i++)if(t[i].line===e)return!0;return!1},t.prototype.shiftToPreviousWidget=function(e,t,i,n,r){var o=e.containerWidget,s=i.containerWidget,a=[],l=[];s!==o&&(a=this.getFootNotesOfBlock(e));for(var d=0;d<e.childWidgets.length;d++){var h=e.childWidgets[d],c=this.getMaxElementHeight(h);if(this.isLineInFootNote(h,a)){for(var p=this.getFootNoteWidgetsBy(h.paragraph,a),u=0,g=0;g<p.length;g++)for(var m=p[g],f=0;f<m.childWidgets.length;f++)u+=m.childWidgets[f].height;0<p.length&&p[0].containerWidget&&(u+=p[0].containerWidget.margin.top),c+=u}if(!(t.clientActiveArea.height>=c)||n||r){var c=i.containerWidget,y=(t.updateClientArea(c,c.page),this.createOrGetNextBodyWidget(c,t));c!==(y=e.containerWidget!==y?this.moveBlocksToNextPage(e,!0):y)&&(0<(a=this.getFootNotesOfBlock(e)).length&&(l=l.concat(this.getFootNoteWidgetsBy(e,a)),s=y),this.updateContainerWidget(e,y,0,!0)),t.updateClientArea(y,y.page);break}if(0<a.length&&this.isLineInFootNote(h,a)&&(l=l.concat(this.getFootNoteWidgetsBy(h.paragraph,a))),this.updateParagraphWidgetInternal(h,i,i.childWidgets.length),d--,t.cutFromTop(t.clientActiveArea.y+h.height),_.isNullOrUndefined(e.childWidgets))break}!_.isNullOrUndefined(l)&&0<l.length&&o.page.footnoteWidget&&o!=s&&this.moveFootNotesToPage(l,o,s)},t.prototype.updateParagraphWidgetInternal=function(e,t,i){!_.isNullOrUndefined(e.paragraph)&&(e.paragraph.childWidgets.splice(e.paragraph.childWidgets.indexOf(e),1),e.paragraph.height-=e.height,_.isNullOrUndefined(e.paragraph.containerWidget)||(e.paragraph.containerWidget.height-=e.height),_.isNullOrUndefined(e.paragraph.childWidgets)||0===e.paragraph.childWidgets.length)&&e.paragraph.destroyInternal(this.viewer),!_.isNullOrUndefined(e.paragraph)&&0<e.paragraph.floatingElements.length&&this.shiftFloatingElements(e,t),t.childWidgets.splice(i,0,e),(e.paragraph=t).height+=e.height,_.isNullOrUndefined(t.containerWidget)||(t.containerWidget.height+=e.height)},t.prototype.shiftFloatingElements=function(e,t){for(var i,n=0;n<e.children.length;n++)e.children[n]instanceof uc&&"Inline"===e.children[n].textWrappingStyle&&0<=(i=e.paragraph.floatingElements.indexOf(e.children[n]))&&(e.paragraph.floatingElements.splice(i,1),t.floatingElements.splice(i,0,e.children[n]))},t.prototype.shiftNextWidgets=function(e){for(var t=e;t.nextWidget instanceof Qd;){if(t=t.nextWidget,this.viewer instanceof Sd&&!this.isMultiColumnSplit&&1<t.bodyWidget.sectionFormat.columns.length){var i=this.getBodyWidget(t.bodyWidget,!1);if(!_.isNullOrUndefined(i.nextRenderedWidget)&&i.page===i.nextRenderedWidget.page){this.splitBodyWidgetBasedOnColumn(t.bodyWidget);break}}this.reLayoutOrShiftWidgets(t,this.viewer)}},t.prototype.updateContainerWidget=function(e,t,i,n,r){if(!(e.containerWidget&&e.containerWidget.containerWidget instanceof q)){var o=e.containerWidget;if(_.isNullOrUndefined(e.containerWidget)||(e.containerWidget.childWidgets.splice(e.containerWidget.childWidgets.indexOf(e),1),e.containerWidget.height-=t.height,(_.isNullOrUndefined(e.containerWidget.childWidgets)||0===e.containerWidget.childWidgets.length)&&e.containerWidget instanceof z&&e.containerWidget!==t&&n&&(n=e.containerWidget.page,this.documentHelper.pages[this.documentHelper.pages.length-1]===n&&-1!==this.viewer.visiblePages.indexOf(n)&&this.documentHelper.scrollToBottom(),_.isNullOrUndefined(n.endnoteWidget))&&(_.isNullOrUndefined(n.nextPage)||n.nextPage.bodyWidgets[0].index!==e.containerWidget.index)&&(n=e.containerWidget,!_.isNullOrUndefined(n.nextRenderedWidget)&&1<n.nextRenderedWidget.sectionFormat.columns.length&&(n.nextRenderedWidget.columnIndex=n.columnIndex),e.containerWidget.destroyInternal(this.viewer))),t.childWidgets.splice(i,0,e),e instanceof G&&!_.isNullOrUndefined(e.floatingElements))for(var s=0;s<e.floatingElements.length;s++){var a=e.floatingElements[s];"Inline"!==a.textWrappingStyle&&(t.floatingElements.push(a),e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(a),1),t.floatingElements.sort(function(e,t){return e.y-t.y}))}e instanceof K&&e.wrapTextAround&&-1!==e.bodyWidget.floatingElements.indexOf(e)&&e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(e),1),t.height+=t.height,e.containerWidget=t,o&&o.page&&o.page.footnoteWidget&&r&&0<r.length&&this.moveFootNotesToPage(r,o,t)}},t.prototype.getBodyWidgetOfPreviousBlock=function(e,t){var i=void 0,n=e.previousRenderedWidget,i=n&&n.containerWidget.equals(e.containerWidget)?n.containerWidget:e instanceof K&&!_.isNullOrUndefined(e.containerWidget.previousRenderedWidget)&&e.containerWidget.index===e.containerWidget.previousRenderedWidget.index?e.containerWidget.previousRenderedWidget:e.containerWidget;return t=n&&n.containerWidget.equals(e.containerWidget)?i.childWidgets.indexOf(n):e.containerWidget.childWidgets.indexOf(e),{bodyWidget:i,index:t}},t.prototype.moveBlocksToNextPage=function(e,t,i,n,r){var o=e.bodyWidget,s=(this.viewer.columnLayoutArea.setColumns(o.sectionFormat),this.viewer.columnLayoutArea.getNextColumnByBodyWidget(e.bodyWidget)),a=void 0,l=void 0;if(!(_.isNullOrUndefined(s)||e instanceof G&&e.isEndsWithPageBreak)&&((l=this.moveToNextColumnByBodyWidget(e,i)).columnIndex=s.index,l.y=e.bodyWidget.y,this.viewer.updateClientArea(l,l.page),this.viewer.clientActiveArea.height-=l.y-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=l.y,1<e.bodyWidget.sectionFormat.columns.length))for(var i=e.bodyWidget.columnIndex,d=e.bodyWidget.x+e.bodyWidget.sectionFormat.columns[i].width+e.bodyWidget.sectionFormat.columns[i].space,h=0;h<e.bodyWidget.floatingElements.length;h++)e.bodyWidget.floatingElements[h]instanceof uc&&d<e.bodyWidget.floatingElements[h].x+e.bodyWidget.floatingElements[h].width&&l.floatingElements.push(e.bodyWidget.floatingElements[h]);if(_.isNullOrUndefined(l)){var c,s=!1,i=o.page,p=i.index+1;if(this.documentHelper.pages.length>p&&!this.isMultiColumnLayout&&(a=this.documentHelper.pages[p],!r||_.isNullOrUndefined(a)||_.isNullOrUndefined(a.endnoteWidget)?_.isNullOrUndefined(a)||0===a.bodyWidgets.length||o.sectionFormat.pageHeight!==a.bodyWidgets[0].sectionFormat.pageHeight||o.sectionFormat.pageWidth!==a.bodyWidgets[0].sectionFormat.pageWidth||"NoBreak"!==o.sectionFormat.breakCode?0===a.bodyWidgets.length||!o.equals(a.bodyWidgets[0])||o.sectionIndex!==a.bodyWidgets[0].sectionIndex&&("NewPage"===o.sectionFormat.breakCode||!o.isWord2010NextColumn&&"NoBreak"!==o.sectionFormat.breakCode)?s=!(a=void 0):(l=a.bodyWidgets[0],this.viewer.updateClientArea(l,l.page)):a.bodyWidgets[0].index===o.index?(l=a.bodyWidgets[0],this.viewer.updateClientArea(l,l.page)):(l=this.createSplitBody(o),a.bodyWidgets.splice(0,0,l),l.page=a,this.viewer.updateClientArea(l,l.page),l.y=this.viewer.clientActiveArea.y):a.endnoteWidget.bodyWidgets[0].index===o.index?(l=a.endnoteWidget.bodyWidgets[0],this.viewer.updateClientArea(l,l.page)):(l=this.createSplitBody(o),(c=new q).footNoteType="Endnote",c.page=a,c.bodyWidgets.push(l),l.containerWidget=c,l.page=a,this.viewer.updateClientArea(l,l.page),l.y=this.viewer.clientActiveArea.y)),this.isMultiColumnLayout&&(s=!0),_.isNullOrUndefined(a)&&(l=this.createSplitBody(o),this.documentHelper.owner.editorHistoryModule&&this.documentHelper.owner.editorHistoryModule.isRedoing&&this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo&&"SectionBreakContinuous"===this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.action&&"NoBreak"===e.bodyWidget.sectionFormat.breakCode||n||(r?(c=i.bodyWidgets[o.page.bodyWidgets.length-1],n=this.createSplitBody(c),a=this.viewer.createNewPage(n,p),this.viewer.updateClientArea(n,n.page),n.y=l.y=this.viewer.clientActiveArea.y,l.page=a):(a=this.viewer.createNewPage(l,p),this.viewer.updateClientArea(l,l.page),l.y=this.viewer.clientActiveArea.y)),s&&!_.isNullOrUndefined(a)&&this.documentHelper.insertPage(p,a),this.clearLineMeasures()),a)for(;;){var u=o.page.bodyWidgets[o.page.bodyWidgets.length-1];if(this.isSectionBreakCont||o===u||o.containerWidget instanceof q)break;o.page.bodyWidgets.splice(o.page.bodyWidgets.indexOf(u),1),a.bodyWidgets.splice(1,0,u),u.page=a}}if(this.isTextFormat){r=o.childWidgets.indexOf(e),i=o.childWidgets.slice(r);o.childWidgets.splice(r);for(var g=0,m=i;g<m.length;g++){var f=m[g];l.childWidgets.push(f),f.containerWidget=l}}else for(;;){var y,v=void 0,v=o.lastChild instanceof q?o.lastChild.previousWidget:o.lastChild;if(t&&(y=this.getFootNoteWidgetsOf(v),this.moveFootNotesToPage(y,o,l)),e===v)break;if(o.childWidgets.splice(o.childWidgets.indexOf(v),1),l.childWidgets.splice(0,0,v),v instanceof K&&-1!==o.floatingElements.indexOf(v)&&o.floatingElements.splice(o.floatingElements.indexOf(v),1),v instanceof G&&0<v.floatingElements.length)for(var w=0;w<v.floatingElements.length;w++)-1!==o.floatingElements.indexOf(v.floatingElements[w])&&"Inline"!==v.floatingElements[w].textWrappingStyle&&(o.floatingElements.splice(o.floatingElements.indexOf(v.floatingElements[w]),1),l.floatingElements.push(v.floatingElements[w]));(v.containerWidget=l).height+=v.height}return l},t.prototype.createSplitBody=function(e){var t=this.addBodyWidget(this.viewer.clientActiveArea);return t.sectionFormat=e.sectionFormat,t.index=e.index,t},t.prototype.createOrGetNextColumnBody=function(e){var t;return e.nextRenderedWidget&&e.columnIndex+1===e.nextRenderedWidget.columnIndex&&(t=e.nextRenderedWidget),_.isNullOrUndefined(t)&&((t=new z).sectionFormat=e.sectionFormat,t.index=e.index,t.page=e.page,t.y=e.y,e.containerWidget instanceof q?(e.containerWidget.bodyWidgets.splice(e.containerWidget.bodyWidgets.indexOf(e)+1,0,t),t.containerWidget=e.containerWidget):e.page.bodyWidgets.splice(e.page.bodyWidgets.indexOf(e)+1,0,t)),t},t.prototype.moveToNextColumnByBodyWidget=function(e,t){e=e.containerWidget;return this.createOrGetNextColumnBody(e)},t.prototype.reLayoutLine=function(e,t,i,n,r){this.documentHelper.owner.editorModule.isFootnoteElementRemoved||(this.isFootnoteContentChanged=!1),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!r&&this.viewer.owner.editorModule.updateWholeListItems(e),r=e.paragraphFormat.listFormat&&-1!==e.paragraphFormat.listFormat.listId?e.getSplitWidgets()[0].firstChild:e.childWidgets[t],e.containerWidget instanceof z&&1<e.containerWidget.sectionFormat.numberOfColumns&&e.containerWidget.sectionFormat.equalWidth&&(o=r.previousLine),_.isNullOrUndefined(o)&&(o=r),this.allowLayout&&(o.paragraph.splitTextRangeByScriptType(o.indexInOwner),o.paragraph.splitLtrAndRtlText(o.indexInOwner),o.paragraph.combineconsecutiveRTL(o.indexInOwner));var o,t=e.containerWidget;if(t.height-=e.height,!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||t instanceof fc?t instanceof fc?this.viewer.updateClientAreaForTextBoxShape(t.containerShape,!0):this.viewer.updateClientArea(t,t.page,!0):(e.bodyWidget.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(e.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(e),t.page)),this.viewer.updateClientAreaForBlock(e,!0),!_.isNullOrUndefined(e.containerWidget)&&!_.isNullOrUndefined(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof q)a=e.bodyWidget.containerWidget.y,this.viewer.cutFromTop(a),this.documentHelper.owner.editorModule.isFootNoteInsert=!0,this.layoutfootNote(e.containerWidget.containerWidget),this.documentHelper.owner.editorModule.isFootNoteInsert=!1;else{if(o.paragraph.isEmpty())this.viewer.cutFromTop(e.y),this.layoutParagraph(e,0);else{for(this.updateClientAreaForLine(o),this.layoutListItems(o.paragraph),o.isFirstLine()&&!_.isNullOrUndefined(e.paragraphFormat)&&(r=-j.convertPointToPixel(e.paragraphFormat.firstLineIndent),this.viewer.updateClientWidth(r));e=(o=this.layoutLine(o,0)).paragraph,o=o.nextLine;);this.updateWidgetToPage(this.viewer,e)}this.viewer.updateClientAreaForBlock(e,!1),this.layoutNextItemsBlock(e,this.viewer);var s,a,t=e.getSplitWidgets()[0].previousRenderedWidget,l=(_.isNullOrUndefined(t)||e.isEndsWithPageBreak||e.isEndsWithColumnBreak||t instanceof G&&(!(t instanceof G)||t.isEndsWithPageBreak||t.isEndsWithColumnBreak)||(this.viewer.cutFromTop(e.y+e.height),e.containerWidget===t.containerWidget)||_.isNullOrUndefined(t.containerWidget)||(r=e.containerWidget,t=t.containerWidget,l=this.getFootNoteWidgetsOf(e),_.isNullOrUndefined(t.page.footnoteWidget))||this.moveFootNotesToPage(l,t,r),this.documentHelper.pages.length),t=this.documentHelper.pages[l-1],r=t.bodyWidgets[t.bodyWidgets.length-1];!this.documentHelper.owner.editorModule.isFootnoteElementRemoved&&!this.isFootnoteContentChanged||_.isNullOrUndefined(e.bodyWidget.page.footnoteWidget)||(s=e.bodyWidget.page.footnoteWidget,this.layoutfootNote(s)),_.isNullOrUndefined(this.viewer.owner.editorHistoryModule)||!this.viewer.owner.editorHistoryModule.isRedoing||_.isNullOrUndefined(r.page.endnoteWidget)||(this.isEndnoteContentChanged=!0),!this.documentHelper.owner.editorModule.isEndnoteElementRemoved&&!this.isEndnoteContentChanged||_.isNullOrUndefined(r.page.endnoteWidget)||(s=r.page.endnoteWidget,l=this.viewer.clientArea.clone(),t=this.viewer.clientActiveArea.clone(),a=r.y,0<r.childWidgets.length&&(a=(r=r.childWidgets[r.childWidgets.length-1]).y+r.height),this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-a,this.viewer.clientActiveArea.x=this.viewer.clientArea.x,this.viewer.clientActiveArea.width=this.viewer.clientArea.width,this.viewer.clientActiveArea.y=a,this.layoutfootNote(s),this.viewer.clientArea=l,this.viewer.clientActiveArea=t),!_.isNullOrUndefined(this.viewer.owner.editorHistoryModule)&&this.viewer.owner.editorHistoryModule.isRedoing&&(this.isEndnoteContentChanged=!1)}},t.prototype.isContainsRtl=function(e){if(this.viewer.documentHelper.isSelectionChangedOnMouseMoved&&!this.isDocumentContainsRtl)return!1;for(var t=!1,i=0;i<e.children.length;i++)if(e.children[i]instanceof X&&(t=e.children[i].characterFormat.bidi||"RTL"===e.children[i].characterFormat.bdo||this.documentHelper.textHelper.isRTLText(e.children[i].text))){this.isDocumentContainsRtl||(this.isDocumentContainsRtl=t);break}return t},t.prototype.shiftElementsForRTLLayouting=function(e,t){var i=this.hasTextRangeBidi(e);if(this.isContainsRTLText(e)||t||i){for(var n=[],r=[],o=0;o<e.children.length;o++){var s,a,l,d=e.children[o];d instanceof X&&0<d.height&&!d.isPageBreak&&"\v"!==d.text?(r.push((l=d).characterFormat.bidi),"\t"==l.text?n.push(V.CharacterRangeType.Tab):n.push(l.characterRange),d.isRightToLeft=n[n.length-1]==V.CharacterRangeType.RightToLeft):d instanceof up||d instanceof J||d instanceof Wc||d instanceof Sc||d instanceof E||d instanceof Z?(a=this.isStartMarker(d),s=this.isEndMarker(d),a&&o<e.children.length-1?(a=this.getNextValidWidget(o+1,e),!_.isNullOrUndefined(a)&&a instanceof X&&0<a.height?(r.push((l=a).characterFormat.bidi),"\t"===a.text?n.push(V.CharacterRangeType.Tab):n.push(l.characterRange)):(r.push(!1),n.push(V.CharacterRangeType.LeftToRight))):!s&&0<o?(r.push(r[r.length-1]),n.push(n[n.length-1])):(r.push(!1),n.push(V.CharacterRangeType.LeftToRight))):d instanceof Y&&t?(r.push(t),n.push(V.CharacterRangeType.RightToLeft)):(r.push(!1),n.push(V.CharacterRangeType.LeftToRight))}for(var h=-1,c=void 0,o=0;o<n.length;o++)if(o+1<r.length&&r[o]!=r[o+1])-1!=h&&(this.updateCharacterRange(e,o,h,r,n),h=-1),c=null;else{if(0<o&&o!=n.length-1&&n[o]==V.CharacterRangeType.WordSplit&&r[o]&&n[o-1]==V.CharacterRangeType.Number&&r[o-1]&&n[o+1]==V.CharacterRangeType.Number&&r[o+1]&&this.isNumberNonReversingCharacter(e.children[o]))n[o]=V.CharacterRangeType.Number;else if(n[o]==V.CharacterRangeType.RightToLeft||n[o]==V.CharacterRangeType.LeftToRight||n[o]==V.CharacterRangeType.Number&&-1!=h||(_.isNullOrUndefined(c)||!c)&&r[o])if(-1==h&&n[o]!=V.CharacterRangeType.LeftToRight)h=o;else{if(-1==h){n[o]==V.CharacterRangeType.LeftToRight?c=!0:n[o]==V.CharacterRangeType.RightToLeft&&(c=!1);continue}n[o]==V.CharacterRangeType.LeftToRight&&(this.updateCharacterRange(e,o,h,r,n),h=n[o]==V.CharacterRangeType.RightToLeft||n[o]==V.CharacterRangeType.Number&&-1!=h?o:-1)}n[o]==V.CharacterRangeType.LeftToRight?c=!0:n[o]==V.CharacterRangeType.RightToLeft&&(c=!1)}if(-1!=h&&h<n.length-1&&(this.updateCharacterRange(e,n.length-1,h,r,n),h=-1),n.length!=e.children.length)throw new Error("Splitted Widget count mismatch while reordering layouted child widgets of a line");i=this.reorderElements(e,n,r,t);(n.length=r.length=0)<e.children.length&&(e.layoutedElements=i)}return t},t.prototype.isNumberNonReversingCharacter=function(e){if(e instanceof X){if(!e.characterFormat.hasValueWithParent("localeIdBidi"))return Bl.isNumberNonReversingCharacter(e.text,e.characterFormat.bidi);var t=e.text.charCodeAt(0);if(47==t&&!this.isNumberReverseLangForSlash(e.characterFormat.localeIdBidi)||(35==t||36==t||37==t||43==t||45==t)&&!this.isNumberReverseLangForOthers(e.characterFormat.localeIdBidi)||44==t||46==t||58==t||1548==t)return!0}return!1},t.prototype.isNumberReverseLangForSlash=function(e){return this.isNumberReverseLangForOthers(e)||6145==e||1164==e||1125==e||1120==e||1123==e||1065==e||2137==e||1114==e||1119==e||1152==e||1056==e},t.prototype.isNumberReverseLangForOthers=function(e){return 14337==e||15361==e||5121==e||3073==e||2049==e||11265==e||13313==e||12289==e||4097==e||8193==e||16385==e||1025==e||10241==e||7169==e||9217==e},t.prototype.isStartMarker=function(e){return e instanceof up?0===e.commentType:e instanceof J?0===e.bookmarkType:e instanceof Wc||(e instanceof E?0===e.type:e instanceof Z&&0===e.fieldType)},t.prototype.isEndMarker=function(e){return e instanceof up?1===e.commentType:e instanceof J?1===e.bookmarkType:e instanceof Wc||(e instanceof E?1===e.type:e instanceof Z&&1===e.fieldType)},t.prototype.getNextValidWidget=function(e,t){for(var i=e;i<t.children.length;i++){var n=t.children[i];if(!(n instanceof up||n instanceof J||n instanceof Wc||n instanceof Sc||n instanceof E||n instanceof Z))return n[i]}return null},t.prototype.hasTextRangeBidi=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(i instanceof X)if(i.characterFormat.bidi)return!0}return!1},t.prototype.isContainsRTLText=function(e){for(var t=e.paragraph.bodyWidget.page.documentHelper.textHelper,i=!1,n=0;n<e.children.length&&!(e.children[n]instanceof X&&(i=e.children[n].characterFormat.bidi||1==e.children[n].characterFormat.bidi||t.isRTLText(e.children[n].text)));n++);return i},t.prototype.updateCharacterRange=function(e,t,i,n,r){var o=t;if(!n[t]){r[t]===V.CharacterRangeType.LeftToRight&&o--;for(var s=o;i<=s;s--)if(r[s]!=V.CharacterRangeType.WordSplit){o=s;break}}for(var a,l,s=i;s<=o;s++)r[s]==V.CharacterRangeType.WordSplit&&(r[s]=V.CharacterRangeType.RightToLeft|V.CharacterRangeType.WordSplit,l=s+1,0<=(a=s-1))&&l<r.length&&r[a]==V.CharacterRangeType.RightToLeft&&(r[l]==V.CharacterRangeType.RightToLeft||r[l]==V.CharacterRangeType.Number)&&e.children[s]instanceof X&&"Times New Roman"==(a=e.children[s]).characterFormat.fontFamilyBidi&&(l=a.text.split("").reverse().join(""),a.text=l)},t.prototype.reorderElements=function(e,t,i,n){for(var r=0,o=-1,s=0,a=0,l=[],d=V.CharacterRangeType.LeftToRight,h=!1,c=0;c<e.children.length;c++){var p=e.children[c],u=p,g=(u.characterRange=t[c],(u.characterRange&V.CharacterRangeType.RightToLeft)==V.CharacterRangeType.RightToLeft||u.characterRange==V.CharacterRangeType.Number),m=i[c];if(t[c]==V.CharacterRangeType.Tab){if(n){d=V.CharacterRangeType.LeftToRight,h=!(o=-1),l.splice(r=0,s=0,p);continue}m=m&&!1}0<c&&h!=m&&(n?(o=-1,s=r=0):o=l.length-1,a=0),m||g?g||m&&u.characterRange==V.CharacterRangeType.WordSplit&&(d==V.CharacterRangeType.RightToLeft||this.isInsertWordSplitToLeft(t,i,c))?(s++,r=o+1,u.characterRange==V.CharacterRangeType.Number&&(d==V.CharacterRangeType.Number&&(r+=a),a++),l.splice(r,0,p)):(l.splice(r,0,p),r++,s=0):(n?(0<s&&h==m&&(r+=s),l.splice(r,0,p),r++):(l.push(p),r=c+1),s=0,o=n?r-1:l.length-1),u.characterRange!=V.CharacterRangeType.Number&&(a=0),u.characterRange!=V.CharacterRangeType.WordSplit&&(d=u.characterRange),h=m}return l},t.prototype.isInsertWordSplitToLeft=function(e,t,i){for(var n=i+1;n<e.length;n++){if((e[n]&V.CharacterRangeType.RightToLeft)==V.CharacterRangeType.RightToLeft)return!0;if(e[n]==V.CharacterRangeType.LeftToRight)return!t[n]}return!0},t.prototype.shiftLayoutFloatingItems=function(e){for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],n=this.getFloatingItemPoints(i),r=n.y-i.y;if(i.x=n.x,i.y=n.y,i instanceof uc)for(var o=0;o<i.textFrame.childWidgets.length;o++){var s=i.textFrame.childWidgets[o];s instanceof G?s.y=s.y+r:s instanceof K&&this.shiftChildLocationForTableWidget(s,r)}}},t.prototype.getFloatingItemPoints=function(e){var t=e.line.paragraph,i=t.bodyWidget.sectionFormat,n=0,r=0;if(t){var o=j.convertPointToPixel(i.leftMargin),s=j.convertPointToPixel(i.rightMargin),a=j.convertPointToPixel(i.topMargin),l=0<i.bottomMargin?j.convertPointToPixel(i.bottomMargin):48,d=j.convertPointToPixel(i.headerDistance),h=j.convertPointToPixel(i.footerDistance),c=j.convertPointToPixel(i.pageWidth),p=j.convertPointToPixel(i.pageHeight),u=c-(o+s),g=p-a-l,a=t.isInHeaderFooter&&i.topMargin<=0?0<Math.abs(a)?Math.abs(a):j.convertPointToPixel(i.headerDistance)+t.height:0<a?a:48,m=(!t.isInHeaderFooter&&a<this.viewer.clientArea.y&&(a=this.viewer.clientArea.y),"InFrontOfText"),f=!1,y=e.verticalOrigin,v=e.horizontalOrigin,w=e.horizontalAlignment,b=e.verticalAlignment,x=e.verticalRelativePercent,C=(e.horizontalRelativePercent,e.height),I=e.width,k=e.verticalPosition,F=e.horizontalPosition,P=e.layoutInCell,T=e.heightRelativePercent,S=e.widthRelativePercent,H=void 0;if(e instanceof uc&&(H=e.autoShapeType),t.isInsideTable&&P)f=!0,r=this.getVerticalPosition(e,k,y,m),n=this.getHorizontalPosition(e.width,e,w,v,F,m,t.associatedCell.cellFormat.cellWidth);else if(this.documentHelper.viewer instanceof Wd)r="Line"===y?this.documentHelper.selection.getTop(e.line):this.viewer.clientActiveArea.y,n="Character"===v?this.viewer.clientActiveArea.x:"Center"===w?this.viewer.clientArea.width/2-e.width/2:this.viewer.clientArea.x;else{switch(y){case"Page":case"TopMargin":switch(r=k,b){case"Top":r=k;break;case"Center":"TopMargin"===y?r=(a-C)/2:0<T&&0<S?(r=(p-p*(T/100))/2,e.height=p*(T/100)):r=(p-C)/2;break;case"Outside":case"Bottom":r="Page"===y&&"Bottom"===b?p-C:"TopMargin"===y?a-C:(t.bodyWidget.page.index+1)%2!=0?p-C-h/2:d/2;break;case"Inside":"Page"===y?r=(t.bodyWidget.page.index+1)%2==0?p-C-h/2:d/2:(t.bodyWidget.page.index+1)%2==0&&(r=(a-C)/2-d);break;case"None":r=Math.abs(x)<=1e3?p*(x/100):k}break;case"Line":switch(r=k,b){case"Inside":case"Top":r=this.viewer.clientActiveArea.y;break;case"Center":r=this.viewer.clientActiveArea.y-C/2;break;case"Outside":case"Bottom":r=this.viewer.clientActiveArea.y-C;break;case"None":r=Math.round(t.y)+k}break;case"BottomMargin":switch(r=k,b){case"Inside":case"Top":r=p-l;break;case"Center":r=p-l+(l-C)/2;break;case"Outside":case"Bottom":r=t.bodyWidget.page.index+1!==0&&"Outside"===b?p-l:p-C;break;case"None":r=p-l+k}break;case"InsideMargin":case"OutsideMargin":switch(r=k,b){case"Inside":r="InsideMargin"===y?t.bodyWidget.page.index+1===0?p-C:0:(t.bodyWidget.page.index+1)%2!=0?p-l:a-C;break;case"Top":r="InsideMargin"===y?(t.bodyWidget.page.index+1)%2==0?p-l:0:(t.bodyWidget.page.index+1)%2!=0?p-l:0;break;case"Center":r="OutsideMargin"===y?(t.bodyWidget.page.index+1)%2!=0?p-l+(l-C)/2:(a-C)/2:(t.bodyWidget.page.index+1)%2==0?p-l+(l-C)/2:(a-C)/2;break;case"Outside":r="InsideMargin"===y?(t.bodyWidget.page.index+1)%2==0?p-l:a-C:(t.bodyWidget.page.index+1)%2!=0?a-C:p-l;break;case"Bottom":r="OutsideMargin"===y?t.bodyWidget.page.index+1!==0?p-C:a-C:(t.bodyWidget.page.index+1)%2==0?p-C:a-C}break;case"Paragraph":r=Math.round(t.y)+0+k;break;case"Margin":switch(r=t.isInHeaderFooter&&a<d?d+t.height+k:a+k,b){case"Top":r=a;break;case"Center":r=a+(g-C)/2;break;case"Outside":case"Bottom":r=(t.bodyWidget.page.index+1)%2!=0?a+g-C:a;break;case"Inside":r=(t.bodyWidget.page.index+1)%2==0?a+g-C:a}break;default:r=this.viewer.clientArea.y-k}switch(v){case"Page":switch(n=F,w){case"Center":f?n=(t.associatedCell.cellFormat.cellWidth-I)/2:0<T&&0<S?(n=(c-c*(S/100))/2,e.width=c*(S/100)):n=(c-I)/2;break;case"Left":n=0;break;case"Outside":case"Right":n=f?t.associatedCell.cellFormat.cellWidth-I:c-I;break;case"None":n=f?t.associatedCell.x+F:(0 instanceof uc,F)}n<0&&f&&(n=t.associatedCell.x);break;case"Column":var N=!1,n=!(this.viewer.clientActiveArea.x<t.x)&&!e.paragraph.isInsideTable&&("StraightConnector"===H||"Rectangle"===H||e instanceof Ic)?(N=!0,F+t.bodyWidget.x):t.x+F;switch(t.paragraphFormat.leftIndent&&!N&&(n-=j.convertPointToPixel(t.leftIndent)),w){case"Center":n=this.viewer.clientActiveArea.x+(this.viewer.clientActiveArea.width-I)/2;break;case"Left":n=this.viewer.clientActiveArea.x;break;case"Right":n=this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width-I}break;case"Margin":if(t.bodyWidget)switch(n=o+F,w){case"Center":n=o+(u-I)/2;break;case"Left":n=o;break;case"Outside":(t.bodyWidget.page.index+1)%2!=0&&(n=o+u-I);break;case"Right":n=o+u-I;break;case"Inside":(t.bodyWidget.page.index+1)%2==0&&(n=o+u-I)}else n=this.viewer.clientArea.x+F;break;case"Character":n="Right"===w||"Center"===w?this.getLeftMarginHorizPosition(o,w,F,I,m):this.viewer.clientArea.x+F;break;case"LeftMargin":n=this.getLeftMarginHorizPosition(o,w,F,I,m);break;case"RightMargin":n=this.getRightMarginHorizPosition(c,s,w,F,I,m);break;case"InsideMargin":n=(t.bodyWidget.page.index+1)%2==0?this.getRightMarginHorizPosition(c,s,w,F,I,m):this.getLeftMarginHorizPosition(o,w,F,I,m);break;case"OutsideMargin":n=(t.bodyWidget.page.index+1)%2==0?this.getLeftMarginHorizPosition(o,w,F,I,m):this.getRightMarginHorizPosition(c,s,w,F,I,m);break;default:n=this.viewer.clientArea.x+F}}!t||"Paragraph"!==y&&"Line"!==y||"InFrontOfText"===e.textWrappingStyle||"Behind"===e.textWrappingStyle||"Word2013"!==this.documentHelper.compatibilityMode||t.isInHeaderFooter||(r=r+e.height>this.viewer.clientArea.bottom?this.viewer.clientArea.bottom-e.height:r)<i.topMargin&&(r=i.topMargin)}return new nl(n,r)},t.prototype.getLeftMarginHorizPosition=function(e,t,i,n,r){var o=i;switch(t){case"Center":o=(e-n)/2;break;case"Left":o=0;break;case"Right":o=e-n}return o=o<0&&"InFrontOfText"!==r&&"Behind"!==r?0:o},t.prototype.getRightMarginHorizPosition=function(e,t,i,n,r,o){var s=e-t,a=s+n;switch(i){case"Center":a=s+(t-r)/2;break;case"Left":a=s;break;case"Right":a=e-r}return a=(a<0||e<a+r)&&"InFrontOfText"!==o&&"Behind"!==o?e-r:a},t.prototype.getVerticalPosition=function(e,t,i,n){var r=e.line.paragraph,o=e,s=0,a=r.associatedCell.y;switch(i){case"Page":case"Margin":case"TopMargin":case"InsideMargin":case"BottomMargin":case"OutsideMargin":s=a+t;break;case"Line":case"Paragraph":s=r.y+t+0;"Square"==o.textWrappingStyle&&(s=s<=r.associatedCell.y?r.associatedCell.y:s);break;default:s=this.viewer.clientActiveArea.y+t}return s},t.prototype.getHorizontalPosition=function(e,t,i,n,r,o,s){var a=0,t=t.line.paragraph.associatedCell,l=s-t.leftMargin-t.rightMargin,d=t.cellFormat.cellWidth,h=t.x,c=h-t.leftMargin;switch(n){case"Page":switch(a=r,i){case"Center":a=c+(l-e)/2;break;case"Left":a=c;break;case"Right":a=l-e+c;break;case"None":a=c+r}break;case"Column":case"Margin":switch(i){case"Center":a=h+(d-e)/2;break;case"Left":a=h;break;case"Right":a=h+(d-e);break;case"None":a=h+r}break;default:a=h+r}return a},t.prototype.updateTableFloatPoints=function(e){var t,i,n,r,o;e.wrapTextAround&&(t=e.getTableCellWidth(),i=e.positioning,n=e.bodyWidget.sectionFormat,this.documentHelper.viewer instanceof Wd?"Margin"!==i.horizontalOrigin&&"Page"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=this.viewer.clientArea.width-t:this.viewer.clientActiveArea.x=this.viewer.clientArea.x):e.containerWidget instanceof fc||e.isInsideTable?e.isInsideTable&&(o=(r=e.containerWidget).cellFormat,"Page"===i.verticalOrigin?(this.viewer.clientActiveArea.y=r.y,this.viewer.clientActiveArea.y+=j.convertPointToPixel(i.verticalPosition)):"Margin"===i.verticalOrigin?(this.viewer.clientActiveArea.y+=j.convertPointToPixel(i.verticalPosition),(this.viewer.clientActiveArea.y<r.y||"Top"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y=r.y)):this.viewer.clientActiveArea.y+j.convertPointToPixel(i.verticalPosition)<r.y?this.viewer.clientActiveArea.y=r.y:this.viewer.clientActiveArea.y+=j.convertPointToPixel(i.verticalPosition),"Page"===i.horizontalOrigin?"Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=r.x:"Right"!==i.horizontalAlignment&&"Outside"!==i.horizontalAlignment||(this.viewer.clientActiveArea.x=r.x+o.preferredWidth-t):"Margin"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=r.x+r.leftMargin:"Right"!==i.horizontalAlignment&&"Outside"!==i.horizontalAlignment||(this.viewer.clientActiveArea.x=r.x+o.preferredWidth-(t+r.rightMargin))),0<Math.round(i.horizontalPosition)&&(this.viewer.clientActiveArea.x=r.x,"Margin"===i.horizontalOrigin&&(this.viewer.clientActiveArea.x+=r.leftMargin),this.viewer.clientActiveArea.x+=j.convertPointToPixel(i.horizontalPosition)),"Center"===i.horizontalAlignment)&&(this.viewer.clientActiveArea.x=o.preferredWidth/2-t/2):("Page"===i.verticalOrigin?"Top"===i.verticalAlignment||"Inside"===i.verticalAlignment?this.viewer.clientActiveArea.y=0:!_.isNullOrUndefined(i.verticalAlignment)&&"None"!==i.verticalAlignment||(this.viewer.clientActiveArea.y=j.convertPointToPixel(i.verticalPosition)):"Margin"===i.verticalOrigin?"Top"===i.verticalAlignment||"Inside"===i.verticalAlignment?this.viewer.clientActiveArea.y=j.convertPointToPixel(n.topMargin):0==Math.round(i.verticalPosition)||_.isNullOrUndefined(n.topMargin)?this.viewer.clientActiveArea.y=j.convertPointToPixel(i.verticalPosition):this.viewer.clientActiveArea.y=j.convertPointToPixel(n.topMargin+i.verticalPosition):"Paragraph"!==i.verticalOrigin||!_.isNullOrUndefined(i.verticalAlignment)&&"None"!==i.verticalAlignment||(this.viewer.clientActiveArea.y+=j.convertPointToPixel(i.verticalPosition)),"Page"===i.horizontalOrigin?"Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=0:"Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=j.convertPointToPixel(n.pageWidth)-t:"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=(j.convertPointToPixel(n.pageWidth)-t)/2):"Margin"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Left"===i.horizontalAlignment?(this.viewer.clientActiveArea.x=j.convertPointToPixel(n.leftMargin),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-j.convertPointToPixel(e.firstChild.firstChild.leftMargin))):"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=j.convertPointToPixel(n.leftMargin):"Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=j.convertPointToPixel(n.pageWidth)-(j.convertPointToPixel(n.rightMargin)+t):"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=j.convertPointToPixel(n.leftMargin)+(j.convertPointToPixel(n.pageWidth-n.rightMargin-n.leftMargin)-t)/2)),(0<Math.round(i.horizontalPosition)||"Margin"===i.horizontalOrigin&&"Left"===i.horizontalAlignment)&&(this.viewer.clientActiveArea.x+=j.convertPointToPixel(i.horizontalPosition)))),e.x=this.viewer.clientActiveArea.x,e.y=this.viewer.clientActiveArea.y},t.prototype.isTocField=function(e){if(e instanceof Z){var t=e.nextNode;if(e instanceof Z&&0===e.fieldType&&t instanceof X&&-1!==t.text.trim().toLowerCase().indexOf("toc"))return!0}return!1},t.prototype.getTotalColumnSpan=function(e){for(var t=e,i=0,n=0;n<t.childWidgets.length;n++)i+=t.childWidgets[n].cellFormat.columnSpan;return i},t.prototype.getMaximumRightCellBorderWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i],n=n.childWidgets[n.childWidgets.length-1].cellFormat.borders.right.lineWidth;t<n&&(t=n)}return t},t.prototype.getDefaultBorderSpacingValue=function(e,t,i){return 0==e?(e="Word2013"!=this.documentHelper.compatibilityMode&&"Center"==i?1.5:.75,!0):t},t.prototype.getMinimumWidthRequiredForTable=function(e,t,i){var n=0,n="Word2013"==this.documentHelper.compatibilityMode?"Center"==t?e?18.5+Math.round(.375):18.5+Math.round(i/2):e?19.25:18.5+i:"Center"==t?e?19.25:18.5+i/2:.25==i?18.5:19.3;return j.convertPointToPixel(n)},t.prototype.shiftFloatingItemsFromTable=function(e,t){if(e.containerWidget instanceof z)for(var i=0;i<e.containerWidget.floatingElements.length;i++){var n=e.containerWidget.floatingElements[i];!(n instanceof K)&&n.paragraph.containerWidget instanceof N&&n.paragraph.containerWidget.ownerTable.containerWidget.ownerTable==e&&(t.floatingElements.push(e.containerWidget.floatingElements[i]),e.containerWidget.floatingElements.splice(e.containerWidget.floatingElements.indexOf(e.containerWidget.floatingElements[i]),1),this.shiftedFloatingItemsFromTable.push(n),i--)}};var Ml=t;function t(e){this.islayoutFootnote=!1,this.isMultiColumnDoc=!1,this.allowLayout=!0,this.isReplaceAll=!1,this.isTextFormat=!1,this.isSectionBreakCont=!1,this.isReplacingAll=!1,this.footHeight=0,this.existFootnoteHeight=0,this.isfootMove=!1,this.footnoteHeight=0,this.isTableFootNote=!1,this.isRelayout=!1,this.isRelayoutneed=!1,this.isOverlapFloatTable=!1,this.isInitialLoad=!0,this.isInsertFormField=!1,this.fieldBegin=void 0,this.maxTextHeight=0,this.maxBaseline=0,this.maxTextBaseline=0,this.isFieldCode=!1,this.isRtlFieldCode=!1,this.isRTLLayout=!1,this.isSkipFirstLineIndent=!1,this.currentCell=void 0,this.isFootnoteContentChanged=!1,this.isEndnoteContentChanged=!1,this.keepWithNext=!1,this.is2013Justification=!1,this.nextElementToLayout=void 0,this.endNoteHeight=0,this.isMultiColumnSplit=!1,this.isMultiColumnLayout=!1,this.skipUpdateContainerWidget=!1,this.isIFfield=!1,this.isLayoutWhole=!1,this.isBidiReLayout=!1,this.defaultTabWidthPixel=48,this.isRelayoutFootnote=!1,this.isRelayoutOverlap=!1,this.skipRelayoutOverlap=!1,this.isWrapText=!1,this.isYPositionUpdated=!1,this.isXPositionUpdated=!1,this.hasFloatingElement=!1,this.isFootNoteLayoutStart=!1,this.wrapPosition=[],this.shiftedFloatingItemsFromTable=[],this.isDocumentContainsRtl=!1,this.layoutedFootnoteElement=[],this.documentHelper=e}Dl.prototype.getContext=function(e,t){return this.context},Dl.prototype.toDataURL=function(e,t){return this.context.renderedPath};var Al=Dl;function Dl(){this.style={},this.context=new Ul}Object.defineProperty(Vl.prototype,"globalAlpha",{set:function(e){this.renderedPath+="GA:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(Vl.prototype,"globalCompositeOperation",{set:function(e){this.renderedPath+="GCP:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(Vl.prototype,"fillStyle",{set:function(e){this.renderedPath+="FS:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(Vl.prototype,"strokeStyle",{set:function(e){this.renderedPath+="SS:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(Vl.prototype,"direction",{set:function(e){this.renderedPath+="Dir:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(Vl.prototype,"font",{set:function(e){this.renderedPath+="Fn:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(Vl.prototype,"textAlign",{set:function(e){this.renderedPath+="TA:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(Vl.prototype,"textBaseline",{set:function(e){this.renderedPath+="TBL:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(Vl.prototype,"lineWidth",{set:function(e){this.renderedPath+="LW:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(Vl.prototype,"lineCap",{set:function(e){this.renderedPath+="LC:"+e+";"},enumerable:!0,configurable:!0}),Vl.prototype.drawImage=function(e,t,i,n,r,o,s,a,l){this.renderedPath+="LC:"+e.src+";",this.renderedPath+="sx:"+t+";",this.renderedPath+="sy:"+i+";",this.renderedPath+="sw:"+n+";",this.renderedPath+="sh:"+r+";",o&&(this.renderedPath+="dx:"+o+";"),s&&(this.renderedPath+="dy:"+s+";"),a&&(this.renderedPath+="dw:"+a+";"),l&&(this.renderedPath+="dh:"+l+";")},Vl.prototype.beginPath=function(){this.renderedPath+="BP;"},Vl.prototype.clip=function(e){this.renderedPath+="Cl;"},Vl.prototype.fill=function(e){this.renderedPath+="Fl;"},Vl.prototype.stroke=function(){this.renderedPath+="Stk;"},Vl.prototype.closePath=function(){this.renderedPath+="CP;"},Vl.prototype.lineTo=function(e,t){this.renderedPath+="LT:x:"+e+";y:"+t+";"},Vl.prototype.moveTo=function(e,t){this.renderedPath+="MT:x:"+e+";y:"+t+";"},Vl.prototype.rect=function(e,t,i,n){this.renderedPath+="Rt:x:"+e+";y:"+t+";w:"+i+";h:"+n+";"},Vl.prototype.setLineDash=function(e){this.renderedPath+="Sgm:"+e.toString()+";"},Vl.prototype.clearRect=function(e,t,i,n){this.renderedPath+="CR:x:"+e+";y:"+t+";w:"+i+";h:"+n+";"},Vl.prototype.fillRect=function(e,t,i,n){this.renderedPath+="FR:x:"+e+";y:"+t+";w:"+i+";h:"+n+";"},Vl.prototype.strokeRect=function(e,t,i,n){this.renderedPath+="SR:x:"+e+";y:"+t+";w:"+i+";h:"+n+";"},Vl.prototype.restore=function(){this.renderedPath+="RES;"},Vl.prototype.save=function(){this.renderedPath+="S;"},Vl.prototype.fillText=function(e,t,i,n){this.renderedPath+="FT:"+e+";x:"+t+";y:"+i+";",n&&(this.renderedPath+="MW:"+n+";")},Vl.prototype.measureText=function(e){return{width:30}},Vl.prototype.strokeText=function(e,t,i,n){this.renderedPath+="ST:"+e+";x:"+t+";y:"+i+";",n&&(this.renderedPath+="MW:"+n+";")},Vl.prototype.scale=function(e,t){this.renderedPath+="SC:x:"+e+";y:"+t+";"};var Ul=Vl;function Vl(){this.renderedPath=""}function zl(e){var t,i=[],n=function(e){var t=/([a-z]+)|([+-]?(?:\d+\.?\d*|\.\d+))/gi,i=[],n=[],r={},o=(t.lastIndex=0,!1);r=t.exec(e);for(;r;)o="e"===r[1]||(r[1]?i="zm"===r[1].toLowerCase()?(i.length&&n.push(i),n.push(["Z"]),[r[1].substring(1,2)]):(i.length&&n.push(i),[r[1]]):(i.length||(i=[]),o||i.push(Number(r[2]))),!1),r=t.exec(e);i.length&&n.push(i);return n}(e);if(0<n.length)for(var r=0;r<n.length;r++){var o=n[parseInt(r.toString(),10)],s="";switch((s=o[0]).toLowerCase()){case"m":for(t=1;t<o.length;t++)i.push({command:s,x:o[parseInt(t.toString(),10)],y:o[t+1]}),t+=1,"m"===s?s="l":"M"===s&&(s="L");break;case"l":case"t":for(t=1;t<o.length;t++)i.push({command:s,x:o[parseInt(t.toString(),10)],y:o[t+1]}),t+=1;break;case"h":for(t=1;t<o.length;t++)i.push({command:s,x:o[parseInt(t.toString(),10)]});break;case"v":for(t=1;t<o.length;t++)i.push({command:s,y:o[parseInt(t.toString(),10)]});break;case"z":i.push({command:s});break;case"c":for(t=1;t<o.length;t++)i.push({command:s,x1:o[parseInt(t.toString(),10)],y1:o[t+1],x2:o[t+2],y2:o[t+3],x:o[t+4],y:o[t+5]}),t+=5;break;case"s":for(t=1;t<o.length;t++)i.push({command:s,x2:o[parseInt(t.toString(),10)],y2:o[t+1],x:o[t+2],y:o[t+3]}),t+=3;break;case"q":for(t=1;t<o.length;t++)i.push({command:s,x1:o[parseInt(t.toString(),10)],y1:o[t+1],x:o[t+2],y:o[t+3]}),t+=3;break;case"a":for(t=1;t<o.length;t++)i.push({command:s,r1:o[parseInt(t.toString(),10)],r2:o[t+1],angle:o[t+2],largeArc:o[t+3],sweep:o[t+4],x:o[t+5],y:o[t+6]}),t+=6}}return i}function ql(e){for(var t="",i=0;i<e.length;i++)t+=0===i?_l(e[parseInt(i.toString(),10)]):" "+_l(e[parseInt(i.toString(),10)]);return t}function _l(e){var t="";switch(e.command){case"Z":case"z":t=e.command;break;case"M":case"m":case"L":case"l":t=e.command+" "+e.x+" "+e.y;break;case"C":case"c":t=e.command+" "+e.x1+" "+e.y1+" "+e.x2+" "+e.y2+" "+e.x+" "+e.y;break;case"Q":case"q":t=e.command+" "+e.x1+" "+e.y1+" "+e.x+" "+e.y;break;case"A":case"a":var i=e.command,n=e.angle,r=e.largeArc?"1":"0",o=e.sweep?"1":"0",t=i+" "+e.r1+" "+e.r2+" "+n+" "+r+" "+o+" "+e.x+" "+e.y;break;case"H":case"h":t=e.command+" "+e.x;break;case"V":case"v":t=e.command+" "+e.y;break;case"S":case"s":t=e.command+" "+e.x2+" "+e.y2+" "+e.x+" "+e.y;break;case"T":case"t":t=e.command+" "+e.x+" "+e.y}return t}function jl(e,t,i,n,r,o,s,a){for(var l,d,h,c,p=0,u=0,g=0,m=e.length;g<m;++g){var f=e[g],y=f.command;"x"in f&&(p=f.x),"y"in f&&(u=f.y),"y1"in f&&(d=f.y1),"y2"in f&&(c=f.y2),"x1"in f&&(l=f.x1),"x2"in f&&(h=f.x2),n?(void 0!==p&&(p=Gl(p,t,r,s)),void 0!==u&&(u=Gl(u,i,o,a)),void 0!==l&&(l=Gl(l,t,r,s)),void 0!==d&&(d=Gl(d,i,o,a)),void 0!==h&&(h=Gl(h,t,r,s)),void 0!==c&&(c=Gl(c,i,o,a))):(void 0!==p&&(p=Number((p+t).toFixed(2))),void 0!==u&&(u=Number((u+i).toFixed(2))),void 0!==l&&(l=Number((l+t).toFixed(2))),void 0!==d&&(d=Number((d+i).toFixed(2))),void 0!==h&&(h=Number((h+t).toFixed(2))),void 0!==c&&(c=Number((c+i).toFixed(2)))),(y=function(e,t,i,n,r,o){switch(t){case"M":case"L":e.x=i.x,e.y=i.y;break;case"H":e.x=i.x;break;case"V":e.y=i.y;break;case"C":e.x=i.x,e.y=i.y,e.x1=i.x1,e.y1=i.y1,e.x2=i.x2,e.y2=i.y2;break;case"S":e.x=i.x,e.y=i.y,e.x2=i.x2,e.y2=i.y2;break;case"Q":e.x=i.x,e.y=i.y,e.x1=i.x1,e.y1=i.y1;break;case"T":e.x=i.x,e.y=i.y;break;case"A":var s=i.r1,a=i.r2;n&&(i.r1=s*=r,i.r2=a*=o),e.x=i.x,e.y=i.y,e.r1=i.r1,e.r2=i.r2;break;case"z":case"Z":e={command:"Z"}}return e}(f,y,{x:p,y:u,x1:l,y1:d,x2:h,y2:c,r1:f.r1,r2:f.r2},n,t,i))&&(e[g]=y)}return ql(e)}function Gl(e,t,i,n){return e!==i?e=n!==i?e*t-(Number(i)*t-Number(i))+(n-Number(i)):Number(e)*t-(Number(i)*t-Number(i)):n!==i&&(e=n),Number(e.toFixed(2))}var Kl={Rectangle:"M0,0 L50,0 L50,50 L0,50 z",Oval:"M80.5,12.5 C80.5,19.127417 62.59139,24.5 40.5,24.5 C18.40861,24.5 0.5,19.127417 0.5,12.5C0.5,5.872583 18.40861,0.5 40.5,0.5 C62.59139,0.5 80.5,5.872583 80.5,12.5 z",IsoscelesTriangle:"M45,0 L90,45 L0,45 L45,0 z",RightTriangle:"M836.293,292.9238 L776.293,292.9238 L776.293,254.8408 L836.293,292.9238 z",Parallelogram:"M30,0 L60,0 L45,30 L15,30 z",Trapezoid:"M 1873 358 l -506 1332 h -686 l -506 -1332 z",Diamond:"M397.784,287.875 L369.5,316.159 L341.216,287.875 L369.5,259.591 L397.784,287.875 z",RegularPentagon:"M30,0 L60,30 L50,70 L10,70 L0,30 L30,0 z",Hexagon:"M30,0 L60,0 L90,30 L60,60 L30,60 L0,30 L30,0 z",Heptagon:"M223.7783,195.7134 L207.1303,174.8364 L213.0713,148.8034 L237.1303,137.2174 L261.1883,148.8034 L267.1303,174.8364L250.4813,195.7134 L223.7783,195.7134 z",Octagon:"M98.7319,196.4653 L81.1579,178.8923 L81.1579,154.0393 L98.7319,136.4653 L123.5849,136.4653L141.1579,154.0393 L141.1579,178.8923 L123.5849,196.4653 L98.7319,196.4653 z",Decagon:"M657.3379,302.4141 L642.3369,291.5161 L636.6089,273.8821 L642.3369,256.2481 L657.3379,245.3511 L675.8789,245.3511L690.8789,256.2481 L696.6089,273.8821L690.8789,291.5161 L675.8789,302.4141 L657.3379,302.4141 z",Dodecagon:"M-69.20000457763672,-17.685555555555553L-50.656966313962585,-48.31444444444445L-18.543038263674127,-66L18.543038263674134,-66L50.656966313962585,-48.31444444444445L69.20000457763672,-17.685555555555553L69.20000457763672,17.685555555555553L50.656966313962585,48.31444444444445L18.543038263674134,66L-18.543038263674127,66L-50.656966313962585,48.31444444444445L-69.20000457763672,17.685555555555553Z",Pie:"M 1024 1894 q -120 0 -231 -31 q -111 -31 -208 -88 q -97 -57 -176 -136 q -79 -79 -136 -176 q -57 -97 -88 -208 q -31 -111 -31 -231 q 0 -109 26 -212 q 26 -102 75 -194 q 48 -92 117 -170 q 68 -78 153 -138 q 84 -59 183 -98 q 99 -39 207 -52 l 58 -7 v 922 h 922 l -7 58 q -13 109 -52 207 q -39 99 -98 183 q -60 85 -138 153 q -78 69 -170 117 q -92 49 -194 75 q -103 26 -212 26 z",Chord:"M 1024 1894 q -120 0 -231 -31 q -111 -31 -208 -88 q -97 -57 -176 -136 q -79 -79 -136 -176 q -57 -97 -88 -208 q -31 -111 -31 -231 q 0 -116 29 -224 q 29 -108 82 -203 q 53 -94 128 -173 q 75 -79 167 -137 q 92 -57 198 -92 q 106 -34 222 -40 l 23 -1 l 891 891 l -1 23 q -6 116 -40 222 q -35 106 -92 198 q -58 92 -137 167 q -79 75 -173 128 q -95 53 -203 82 q -108 29 -224 29 z",Teardrop:"M 1024 1894 q -120 0 -231 -31 q -111 -31 -208 -88 q -97 -57 -176 -136 q -79 -79 -136 -176 q -57 -97 -88 -208 q -31 -111 -31 -231 q 0 -120 31 -231 q 31 -111 88 -208 q 57 -97 136 -176 q 79 -79 176 -136 q 97 -57 208 -88 q 111 -31 231 -31 h 870 v 870 q 0 120 -31 231 q -31 111 -88 208 q -57 97 -136 176 q -79 79 -176 136 q -97 57 -208 88 q -111 31 -231 31 z",Frame:"M 1894 154 v 1740 h -1740 v -1740 m 1433 307 h -1126 v 1126 h 1126 z",HalfFrame:"M 154 154 h 1668 l -307 307 h -1054 v 1054 l -307 307 z",L_Shape:"M 870 154 v 1024 h 1024 v 716 h -1740 v -1740 z",DiagonalStripe:"M 154 943 l 789 -789 h 879 l -1668 1668 z",Cross:"M 666 1894 v -512 h -512 v -716 h 512 v -512 h 716 v 512 h 512 v 716 h -512 v 512 z",Plaque:"M 563 1894 v -51 q 0 -66 -31 -131 q -31 -64 -81 -115 q -51 -50 -115 -81 q -65 -31 -131 -31 h -51 v -922 h 51 q 66 0 131 -31 q 64 -31 115 -82 q 50 -50 81 -115 q 31 -64 31 -130 v -51 h 922 v 51 q 0 66 31 130 q 31 65 82 115 q 50 51 115 82 q 64 31 130 31 h 51 v 922 h -51 q -66 0 -130 31 q -65 31 -115 81 q -51 51 -82 115 q -31 65 -31 131 v 51 z",Cube:"M 1946 102 v 1280 l -564 564 h -1280 v -1280 l 564 -564 m 665 615 h -1126 v 1126 h 1126 m 51 -1229 l 410 -409 h -1075 l -410 409 m 1536 -307 l -409 410 v 1024 l 409 -410 z",Bevel:"M 1946 102 v 1844 h -1844 v -1844 m 175 103 l 205 205 h 1084 l 205 -205 m -235 1331 v -1024 h -1024 v 1024 m -307 235 l 205 -205 v -1084 l -205 -205 m 1566 1566 l -205 -205 h -1084 l -205 205 m 1566 -1566 l -205 205 v 1084 l 205 205 z",Donut:"M 1024 154 q 120 0 231 31 q 111 31 208 88 q 97 57 176 136 q 79 79 136 176 q 57 97 88 208 q 31 111 31 231 q 0 120 -31 231 q -31 111 -88 208 q -57 97 -136 176 q -79 79 -176 136 q -97 57 -208 88 q -111 31 -231 31 q -120 0 -231 -31 q -111 -31 -208 -88 q -97 -57 -176 -136 q -79 -79 -136 -176 q -57 -97 -88 -208 q -31 -111 -31 -231 q 0 -120 31 -231 q 31 -111 88 -208 q 57 -97 136 -176 q 79 -79 176 -136 q 97 -57 208 -88 q 111 -31 231 -31 m 0 1331 q 95 0 179 -37 q 84 -36 147 -99 q 62 -62 99 -146 q 36 -84 36 -179 q 0 -95 -36 -179 q -37 -84 -99 -147 q -63 -62 -147 -99 q -84 -36 -179 -36 q -95 0 -179 36 q -84 37 -146 99 q -63 63 -99 147 q -37 84 -37 179 q 0 95 37 179 q 36 84 99 146 q 62 63 146 99 q 84 37 179 37 z",NoSymbol:"M 1024 154 q 124 0 237 30 q 112 30 209 85 q 96 56 175 134 q 78 79 134 175 q 55 97 85 209 q 30 113 30 237 q 0 124 -30 236 q -30 113 -85 209 q -56 97 -134 175 q -79 79 -175 134 q -97 56 -209 86 q -113 30 -237 30 q -124 0 -236 -30 q -113 -30 -209 -86 q -97 -55 -175 -134 q -79 -78 -134 -175 q -56 -96 -86 -209 q -30 -112 -30 -236 q 0 -124 30 -237 q 30 -112 86 -209 q 55 -96 134 -175 q 78 -78 175 -134 q 96 -55 209 -85 q 112 -30 236 -30 m 273 1369 l -772 -772 l -28 74 q -36 96 -36 199 q 0 116 45 218 q 44 103 121 179 q 76 77 179 121 q 102 45 218 45 q 103 0 199 -36 m 328 -328 q 36 -96 36 -199 q 0 -116 -44 -219 q -45 -102 -121 -179 q -77 -76 -179 -121 q -103 -44 -219 -44 q -103 0 -199 36 l -74 28 l 772 772 z",BlockArc:"M 1485 1485 v -51 q 0 -96 -36 -180 q -37 -84 -99 -147 q -63 -62 -147 -98 q -84 -36 -179 -36 q -95 0 -179 36 q -84 36 -146 98 q -63 63 -99 147 q -37 84 -37 180 v 51 h -409 v -51 q 0 -120 31 -231 q 31 -111 88 -208 q 57 -97 136 -177 q 79 -79 176 -136 q 97 -57 208 -88 q 111 -31 231 -31 q 120 0 231 31 q 111 31 208 88 q 97 57 176 136 q 79 80 136 177 q 57 97 88 208 q 31 111 31 231 v 51 z",FoldedCorner:"M 1946 102 v 1229 l -615 615 h -1229 v -1844 m 1229 1699 l 470 -470 h -470 m 512 -1126 h -1638 v 1638 h 1024 v -614 h 614 zM 154 1894 v -1740 h 1740 v 1156 l -584 584 z",SmileyFace:"M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 186 q 60 103 93 221 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 220 q -60 103 -144 187 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -187 q -60 -102 -93 -220 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -221 q 60 -102 144 -186 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1741 q 113 0 218 -30 q 104 -29 195 -82 q 91 -53 166 -128 q 75 -75 128 -166 q 53 -91 83 -196 q 29 -104 29 -217 q 0 -113 -29 -218 q -30 -104 -83 -195 q -53 -91 -128 -166 q -75 -75 -166 -128 q -91 -53 -195 -83 q -105 -29 -218 -29 q -113 0 -217 29 q -105 30 -196 83 q -91 53 -166 128 q -75 75 -128 166 q -53 91 -82 195 q -30 105 -30 218 q 0 113 30 217 q 29 105 82 196 q 53 91 128 166 q 75 75 166 128 q 91 53 196 82 q 104 30 217 30 m 358 -1331 q 32 0 60 12 q 28 12 49 33 q 21 21 33 49 q 12 28 12 60 q 0 32 -12 59 q -12 28 -33 49 q -21 21 -49 33 q -28 12 -60 12 q -32 0 -59 -12 q -28 -12 -49 -33 q -21 -21 -33 -49 q -12 -27 -12 -59 q 0 -32 12 -60 q 12 -28 33 -49 q 21 -21 49 -33 q 27 -12 59 -12 m 52 102 h -103 v 103 h 103 m -768 -205 q 31 0 59 12 q 28 12 49 33 q 21 21 33 49 q 12 28 12 60 q 0 32 -12 59 q -12 28 -33 49 q -21 21 -49 33 q -28 12 -59 12 q -32 0 -60 -12 q -28 -12 -49 -33 q -21 -21 -33 -49 q -12 -27 -12 -59 q 0 -32 12 -60 q 12 -28 33 -49 q 21 -21 49 -33 q 28 -12 60 -12 m 51 102 h -103 v 103 h 103 m 823 512 q -18 87 -66 162 q -48 75 -117 130 q -69 55 -154 86 q -86 31 -179 31 q -93 0 -178 -31 q -86 -31 -155 -86 q -69 -55 -117 -130 q -48 -75 -66 -162 h 106 q 17 66 57 122 q 39 56 94 97 q 55 42 122 65 q 66 23 137 23 q 71 0 138 -23 q 66 -23 121 -65 q 55 -41 95 -97 q 39 -56 56 -122 z",Heart:"M 997 1758 q -401 -286 -612 -551 q -212 -265 -231 -504 v -101 q 9 -106 45 -187 q 35 -80 87 -135 q 52 -55 114 -85 q 62 -30 122 -36 q 21 -2 41 -3 q 19 -1 38 -1 q 67 0 119 12 q 51 13 96 38 q 44 26 85 65 q 40 39 84 91 l 39 46 l 39 -46 q 44 -52 85 -91 q 40 -39 85 -65 q 44 -25 96 -38 q 51 -12 118 -12 q 19 0 39 1 q 19 1 40 3 q 60 6 122 36 q 62 31 114 86 q 51 56 87 137 q 36 82 45 189 v 100 q -19 240 -229 503 q -211 264 -609 548 l -30 21 z",LightningBolt:"M-8,-55L7,-24L1,-20L19,6L13,11L36,55L-3,21L5,16L-19,-6L-11,-12L-36,-35Z",Sun:"M69.60002899169922,0L41.51352437242167,8.416795119701419L41.51352437242167,-8.416795119701426ZM49.209798275982905,-41.47314036934465L36.41601824906962,-18.783766017986338L22.290725499983694,-30.686752034954836ZM0,-58.64998245239259L9.988224375410937,-34.982276749768076L-9.988224375410944,-34.982276749768076ZM-49.216242723111755,-41.47314036934465L-22.290725499983694,-30.686752034954836L-36.416018249069616,-18.783766017986338ZM-69.60002899169922,0L-41.51352437242167,-8.416795119701426L-41.51352437242167,8.416795119701419ZM-49.216242723111755,41.46770981541388L-36.416018249069616,18.783766017986338L-22.290725499983694,30.68675203495485ZM0,58.64998245239259L-9.988224375410944,34.98227674976806L9.988224375410937,34.98227674976806ZM49.209798275982905,41.46770981541388L22.290725499983694,30.68675203495485L36.41601824906962,18.783766017986338ZM-34.80001449584961,0Q-34.800014495849624,-12.14680908236253,-24.607326235405417,-20.735900154279413Q-14.414637974961238,-29.32499122619629,-1.4210854715202004e-14,-29.324991226196296Q14.414637974961224,-29.324991226196293,24.60732623540541,-20.735900154279413Q34.80001449584961,-12.146809082362545,34.80001449584961,-7.105427357601002e-15Q34.80001449584961,12.146809082362523,24.60732623540541,20.735900154279406Q14.414637974961224,29.32499122619629,0,29.32499122619629Q-14.414637974961217,29.32499122619629,-24.607326235405388,20.73590015427945Q-34.8000144958496,12.146809082362552,-34.80001449584961,7.105427357601002e-15Z",Moon:"M36.80000305175781,60.90000915527344Q6.313882332939066,60.90000915527344,-15.243060359409363,43.06280944801668Q-36.80000305175781,25.22560974075992,-36.80000305175781,7.105427357601002e-15Q-36.800003051757834,-25.225609740759907,-15.243060359409384,-43.062809448016665Q6.3138823329390235,-60.90000915527342,36.8000030517578,-60.90000915527344Q6.313882332939052,-41.98080184970351,0.9246466598519447,-10.765702362004177Q-4.464589013235177,20.449397125695157,18.400001525878878,45.67500686645508Q26.28571646554125,54.375008174351294,36.800003051757784,60.90000915527344Z",Cloud:"M 1024 1792 q -60 0 -115 -20 q -55 -19 -100 -54 q -46 -34 -79 -83 q -34 -48 -50 -106 l -24 -86 l -62 65 q -37 38 -83 58 q -47 21 -101 21 q -54 0 -101 -21 q -47 -20 -81 -55 q -35 -35 -54 -83 q -20 -47 -20 -100 q 0 -48 18 -91 q 18 -42 50 -78 l 25 -28 l -19 -32 q -38 -64 -56 -135 q -18 -71 -18 -145 q 0 -116 44 -219 q 44 -102 121 -179 q 76 -76 179 -121 q 102 -44 219 -44 q 106 0 206 38 q 99 39 177 113 l 39 37 l 35 -41 q 61 -72 140 -110 q 79 -37 171 -37 q 85 0 160 32 q 74 33 130 88 q 55 56 87 130 q 32 75 32 160 q 0 70 -23 135 q -23 66 -71 123 l -28 34 l 30 32 q 45 51 69 112 q 23 61 23 127 q 0 74 -28 139 q -28 65 -76 114 q -49 49 -114 77 q -66 28 -140 28 q -63 0 -126 -24 l -44 -17 l -20 43 q -23 47 -56 84 q -34 38 -76 64 q -42 27 -90 41 q -48 14 -100 14 z",Arc:"M-1.4210854715202004e-14,-45.200008392333984Q15.408730615404892,-45.200008392334,26.304348523034477,-31.96123244390823Q37.19996643066406,-18.722456495482472,37.19996643066406,-2.1316282072803006e-14Q37.19996643066406,-1.4210854715202004e-14,37.19996643066406,-1.4210854715202004e-14",DoubleBracket:"M 717 1843 v 103 h -307 q -63 0 -119 -25 q -56 -24 -98 -66 q -42 -42 -66 -98 q -25 -56 -25 -119 v -1228 q 0 -63 25 -119 q 24 -56 66 -98 q 42 -42 98 -67 q 56 -24 119 -24 h 307 v 103 h -307 q -42 0 -79 16 q -38 16 -66 44 q -28 28 -44 65 q -16 38 -16 80 v 1228 q 0 42 16 79 q 16 38 44 66 q 28 28 66 44 q 37 16 79 16 m 1228 -1741 q 63 0 119 24 q 56 25 98 67 q 42 42 67 98 q 24 56 24 119 v 1228 q 0 63 -24 119 q -25 56 -67 98 q -42 42 -98 66 q -56 25 -119 25 h -307 v -103 h 307 q 42 0 80 -16 q 37 -16 65 -44 q 28 -28 44 -66 q 16 -37 16 -79 v -1228 q 0 -42 -16 -80 q -16 -37 -44 -65 q -28 -28 -65 -44 q -38 -16 -80 -16 h -307 v -103 z",DoubleBrace:"M 1843 1126 q -38 0 -75 8 q -37 9 -66 32 q -29 23 -46 62 q -18 40 -18 103 v 410 q 0 77 -22 118 q -23 42 -55 61 q -33 20 -68 23 q -35 3 -59 3 h -103 v -103 q 14 -1 25 -1 q 10 0 18 0 q 15 0 27 0 q 11 1 33 1 q 38 0 59 -16 q 20 -15 30 -35 q 11 -22 13 -51 v -410 q 0 -62 18 -113 q 17 -51 46 -90 q 29 -39 66 -66 q 36 -26 75 -38 q -39 -12 -75 -40 q -37 -27 -66 -67 q -29 -40 -46 -91 q -18 -50 -18 -109 v -410 q 0 -38 -16 -59 q -16 -20 -35 -30 q -23 -11 -51 -13 h -103 v -103 h 103 q 57 3 102 26 q 19 10 38 24 q 18 15 32 37 q 14 22 23 51 q 9 29 9 67 v 410 q 0 59 18 98 q 17 39 46 63 q 29 24 66 34 q 37 10 75 10 m -1638 0 q 38 0 75 -10 q 37 -10 66 -34 q 29 -24 47 -63 q 17 -39 17 -98 v -410 q 0 -38 9 -67 q 9 -29 23 -51 q 14 -22 33 -37 q 18 -14 37 -24 q 45 -23 102 -26 h 103 v 103 h -103 q -29 2 -51 13 q -20 10 -35 30 q -16 21 -16 59 v 410 q 0 59 -17 109 q -18 51 -47 91 q -29 40 -65 67 q -37 28 -76 40 q 39 12 76 38 q 36 27 65 66 q 29 39 47 90 q 17 51 17 113 v 410 q 2 29 13 51 q 10 20 31 35 q 20 16 58 16 q 22 0 33 -1 q 11 0 27 0 q 8 0 19 0 q 10 0 24 1 v 103 h -103 q -24 0 -59 -3 q -35 -3 -67 -23 q -33 -19 -55 -61 q -23 -41 -23 -118 v -410 q 0 -63 -17 -103 q -18 -39 -47 -62 q -29 -23 -66 -32 q -37 -8 -75 -8 z",LeftBracket:"M 1331 1843 v 103 h -307 q -63 0 -119 -25 q -56 -24 -98 -66 q -42 -42 -66 -98 q -24 -56 -24 -119 v -1228 q 0 -63 24 -119 q 24 -56 66 -98 q 42 -42 98 -67 q 56 -24 119 -24 h 307 v 103 h -307 q -42 0 -79 16 q -38 16 -66 44 q -28 28 -44 65 q -16 38 -16 80 v 1228 q 0 42 16 79 q 16 38 44 66 q 28 28 66 44 q 37 16 79 16 z",RightBracket:"M 1024 102 q 63 0 119 24 q 56 25 98 67 q 42 42 66 98 q 24 56 24 119 v 1228 q 0 63 -24 119 q -24 56 -66 98 q -42 42 -98 66 q -56 25 -119 25 h -307 v -103 h 307 q 42 0 80 -16 q 37 -16 65 -44 q 28 -28 44 -66 q 16 -37 16 -79 v -1228 q 0 -42 -16 -80 q -16 -37 -44 -65 q -28 -28 -65 -44 q -38 -16 -80 -16 h -307 v -103 z",LeftBrace:"M 717 922 q 38 0 75 -10 q 37 -10 66 -34 q 29 -24 47 -63 q 17 -39 17 -98 v -410 q 0 -38 9 -67 q 9 -29 23 -51 q 14 -22 33 -37 q 18 -14 37 -24 q 45 -23 102 -26 h 103 v 103 h -103 q -29 2 -51 13 q -20 10 -35 30 q -16 21 -16 59 v 410 q 0 59 -17 109 q -18 51 -47 91 q -29 40 -65 67 q -37 28 -76 40 q 39 12 76 38 q 36 27 65 66 q 29 39 47 90 q 17 51 17 113 v 410 q 2 29 13 51 q 10 20 31 35 q 20 16 58 16 q 22 0 33 -1 q 11 0 27 0 q 8 0 19 0 q 10 0 24 1 v 103 h -103 q -24 0 -59 -3 q -35 -3 -67 -23 q -33 -19 -55 -61 q -23 -41 -23 -118 v -410 q 0 -63 -17 -103 q -18 -39 -47 -62 q -29 -23 -66 -32 q -37 -8 -75 -8 z",RightBrace:"M 1229 1126 q -39 0 -75 8 q -37 9 -66 32 q -29 23 -46 62 q -18 40 -18 103 v 410 q 0 51 -10 86 q -11 35 -28 58 q -18 23 -40 35 q -22 13 -44 18 q -23 6 -45 7 q -22 1 -38 1 h -102 v -103 q 14 -1 25 -1 q 10 0 18 0 q 15 0 26 0 q 11 1 33 1 q 38 0 59 -16 q 21 -15 31 -35 q 11 -22 13 -51 v -410 q 0 -62 18 -113 q 17 -51 46 -90 q 28 -39 65 -66 q 36 -26 75 -38 q -39 -12 -75 -40 q -37 -27 -65 -67 q -29 -40 -46 -91 q -18 -50 -18 -109 v -410 q 0 -38 -16 -59 q -16 -20 -36 -30 q -23 -11 -51 -13 h -102 v -103 h 102 q 57 3 102 26 q 19 10 38 24 q 18 15 33 37 q 14 22 23 51 q 9 29 9 67 v 410 q 0 59 18 98 q 17 39 46 63 q 29 24 66 34 q 36 10 75 10 z",Plus:"M696.6084,158.2656 L674.8074,158.2656 L674.8074,136.4656 L658.4084,136.4656 L658.4084,158.2656 L636.6084,158.2656L636.6084,174.6646 L658.4084,174.6646 L658.4084,196.4656 L674.8074,196.4656 L674.8074,174.6646 L696.6084,174.6646L696.6084,158.2656 z",Star:"M540.3643,137.9336 L546.7973,159.7016 L570.3633,159.7296 L550.7723,171.9366 L558.9053,194.9966 L540.3643,179.4996L521.8223,194.9966 L529.9553,171.9366 L510.3633,159.7296 L533.9313,159.7016 L540.3643,137.9336 z",Can:"M 542.802,362.009C 542.802,368.452 525.341,373.676 503.802,373.676C 482.263,373.676 464.802,368.452 464.802,362.009L 464.802,466.484C 464.802,472.928 482.263,478.151 503.802,478.151C 525.341,478.151 542.802,472.928 542.802,466.484L 542.802,362.016C 542.802,368.459 525.341,373.534 503.802,373.534C 482.263,373.534 464.802,368.31 464.802,361.867L 464.802,362.016C 464.802,355.572 482.263,350.349 503.802,350.349C 525.341,350.349 542.802,355.572 542.802,362.016",FlowChartProcess:"M419.511,76.687L359.511,76.687L359.511,43.086L419.511,43.086z",FlowChartAlternateProcess:"M 456 1690 q -62 0 -117 -24 q -55 -24 -96 -65 q -41 -41 -65 -96 q -24 -55 -24 -118 v -726 q 0 -63 24 -118 q 24 -55 65 -96 q 41 -41 96 -65 q 55 -24 117 -24 h 1136 q 62 0 117 24 q 55 24 96 65 q 41 41 65 96 q 24 55 24 118 v 726 q 0 63 -24 118 q -24 55 -65 96 q -41 41 -96 65 q -55 24 -117 24 z",FlowChartPunchedTape:"M 563 1894 q -94 0 -169 -15 q -76 -15 -129 -38 q -54 -23 -82 -50 q -29 -27 -29 -50 v -1276 q 69 45 175 71 q 105 27 234 27 q 109 0 203 -20 q 94 -19 163 -54 q 68 -34 107 -81 q 39 -46 39 -101 q 0 -23 29 -50 q 29 -27 83 -50 q 53 -23 129 -38 q 75 -15 169 -15 q 94 0 170 15 q 75 15 128 38 q 53 23 82 50 q 29 27 29 50 v 1276 q -69 -45 -174 -72 q -106 -26 -235 -26 q -110 0 -203 19 q -94 20 -162 54 q -69 35 -108 81 q -39 47 -39 102 q 0 23 -29 50 q -29 27 -82 50 q -54 23 -129 38 q -76 15 -170 15 Z",FlowChartDecision:"M 253.005,115.687L 200.567,146.071L 148.097,115.687L 200.534,85.304L 253.005,115.687 Z",FlowChartDocument:"M 60 31.9 c 0 0 -11 -7.7 -30 0 s -30 0 -30 0 V 0 h 60 V 31.9 Z",FlowChartPredefinedProcess:"M 0,0 L 50,0 L 50,50 L 0,50 Z  M 8.334,0 L 8.334,50 M 41.667,0 L 41.667,50",FlowChartTerminator:"M 269.711,29.33C 269.71,44.061 257.77,56 243.04,56L 158.058,56C 143.33,56 131.39,44.061 131.39,29.33L 131.39,29.33C 131.391,14.6057 143.33,2.669 158.058,2.669L 243.044,2.669C 257.772,2.669 269.711,14.6057 269.711,29.333 Z",PaperTap:"M0.0009,17.2042 L0.0009,47.165 C0.001,47.165 14.403,53.5455 25.00,47.165 C35.599,40.7852 44.403,43.5087 50.00,47.165L50.001,17.2042 M50.001,32.7987 L50.001,2.8405 C50.001,2.8405 35.599,-3.5427 25.001,2.8405C14.403,9.2237 5.599,6.494 0.0009,2.8405 L0.0009,32.7987",DirectData:"M 132.62 0 L 17.38 0 C 7.78 0 0 13.43 0 30 C 0 46.57 7.78 60 17.38 60 L 132.62 60 M 132.62 0C 123.02 0 115.24 13.43 115.24 30 C 115.24 46.57 123.02 60 132.62 60 C 142.22 60 150 46.57 150 30 C 150 13.43 142.22 0 132.62 0 z ",SequentialData:"M0.0029,24.999 C0.0029,11.1922 10.433,0.0021 23.295,0.0021 C36.159,0.00216 46.585,11.1922 46.585,24.999C46.585,38.8057 36.159,49.9979 23.295,49.9979 C10.433,49.9979 0.0029,38.8057 0.0029,24.999 z M23.294,49.999 L50.002,49.999",FlowChartSort:"M50.001,24.9971 L25.001,49.9971 L0.00097,24.9971 L25.001,-0.00286865 L50.001,24.9971 z M0.000976562,24.9971 L50.001,24.9971",FlowChartMultiDocument:"M43.6826,40 C44.8746,40.6183 45.8586,41.3502 46.8366,42.1122 L46.8366,4.74487 L3.09857,4.74487 L3.09857,10.9544 M46.837,35.143 C48.027,35.765 49.025,36.604 50.003,37.369 L50.003,0.002 L6.264,0.002 L6.264,4.744 M43.682,47.113 L43.682,10.765 L0.0025,10.7652 L0.0025,47.1132 C0.0025,47.1132 12.5846,53.6101 21.8426,47.1132 C31.1006,40.6163 38.792,43.393 43.6826,47.1132 z",FlowChartCollate:"M50.001,0.0028 L25.001,25.0029 L0.00097,0.0028 L50.001,0.002 z M0.0009,50.002 L25.001,25.002L50.001,50.002 L0.0009,50.0029 z",FlowChartSummingJunction:"M7.3252,42.6768 L42.6772,7.3247 M42.6768,42.6768 L7.3248,7.3247 M0.0009,25.001 C0.0009,11.193 11.197,0.0009 25.001,0.0009 C38.809,0.0009 50.001,11.193 50.001,25.001 C50.001,38.809 38.809,50.001 25.001,50.001 C11.197,50.00 0.0009,38.809 0.0009,25.00 z",FlowChartOr:"M 0 50 L 100 50 M 50 100 L 50 0.0 M 0 50 C 0 22.384 22.392 0 50 0 C 77.616 0 100 22.384 100 50 C 100 77.616 77.616 100 50 100 C 22.392 100 0 77.616 0 50 Z",FlowChartInternalStorage:"M 0 3.81946A 2.5,3.81946 0 0,1 2.5,0L 47.5 0A 2.5,3.81946 0 0,1 50,3.81946L 50 45.836A 2.5,3.819446 0 0,1 47.5,49.652778L 2.5 49.652778A 2.5,3.819446 0 0,1 0,45.8336L 0 3.819446ZM 0 11.45834L 50 11.4583334M 12.5 0L 12.5 49.652778",FlowChartExtract:"M0,35 L30,0 L60,35 Z",FlowChartManualOperation:"M46.4,28.8 L14.8,28.8 L0,0 L60,0 Z",FlowChartMagneticDisk:"M 1024 1690 q -128 0 -242 -13 q -115 -12 -211 -34 q -97 -22 -174 -52 q -78 -30 -131 -64 q -54 -34 -83 -71 q -29 -37 -29 -74 v -716 q 0 -36 29 -74 q 29 -37 83 -71 q 53 -34 131 -64 q 77 -30 174 -52 q 96 -22 211 -35 q 114 -12 242 -12 q 128 0 243 12 q 114 13 211 35 q 96 22 174 52 q 77 30 131 64 q 53 34 82 71 q 29 38 29 74 v 716 q 0 37 -29 74 q -29 37 -82 71 q -54 34 -131 64 q -78 30 -174 52 q -97 22 -211 34 q -115 13 -243 13 Z",FlowChartConnector:"M 973 1792 q -113 0 -217 -30 q -105 -29 -196 -82 q -91 -53 -166 -128 q -75 -75 -128 -166 q -53 -91 -82 -196 q -30 -104 -30 -217 q 0 -113 30 -218 q 29 -104 82 -195 q 53 -91 128 -166 q 75 -75 166 -128 q 91 -53 196 -83 q 104 -29 217 -29 q 113 0 218 29 q 104 30 195 83 q 91 53 166 128 q 75 75 128 166 q 53 91 83 195 q 29 105 29 218 q 0 113 -29 217 q -30 105 -83 196 q -53 91 -128 166 q -75 75 -166 128 q -91 53 -195 82 q -105 30 -218 30 Z",FlowChartOffPageConnector:"M 358 1407 v -1253 h 1332 v 1253 l -666 476 Z",FlowChartDirectAccessStorage:"M 358 1024 q 0 -128 13 -243 q 12 -114 34 -211 q 22 -96 52 -174 q 30 -77 64 -131 q 34 -53 71 -82 q 37 -29 74 -29 h 716 q 36 0 74 29 q 37 29 71 82 q 34 54 64 131 q 30 78 52 174 q 22 97 35 211 q 12 115 12 243 q 0 128 -12 242 q -13 115 -35 211 q -22 97 -52 174 q -30 78 -64 131 q -34 54 -71 83 q -38 29 -74 29 h -716 q -37 0 -74 -29 q -37 -29 -71 -83 q -34 -53 -64 -131 q -30 -77 -52 -174 q -22 -96 -34 -211 q -13 -114 -13 -242 Z",FlowChartMerge:"M60,0 L30,35 L0,0 Z",OffPageReference:"M60,33.3 L30.1,39 L0,33.3 L0,0 L60,0 Z",FlowChartSequentialAccessStorage:"M 60 30 C 60 13.4 46.6 0 30 0 S 0 13.4 0 30 s 13.4 30 30 30 h 28.6 v -6.5 h -9.9C 55.5 48 60 39.5 60 30 Z",Annotation:"M49.9984,50.0029 L-0.00271199,50.0029 L-0.00271199,0.00286865 L49.9984,0.00286865",Annotation2:"M49.9977,50.0029 L25.416,50.0029 L25.416,0.00286865 L49.9977,0.00286865 M25.4166,25.0029 L-0.00227869,25.0029",FlowChartData:"M 10 0 L 40 0 L 30 40 L 0 40 Z",FlowChartCard:"M275,60 L400,60 L400,110 L260,110 L260,75 Z",FlowChartDelay:"M0,0 L12.029,0 C14.212999,0 16,1.7869979 16,3.9709952 C16,6.1549926 14.212999,7.9409904 12.029,7.9409904 L0,7.9409904 z",FlowChartPreparation:"M 1048.17 572 C 1051.06 568.86 1055.17 567.05 1059.5 567 L 1094.51 567 C 1098.84 567.05 1102.95 568.86 1105.84 572 L 1126.43 595 C 1127.01 596.28 1127.01 597.72 1126.43 599 L 1105.84 622 C 1102.95 625.14 1098.84 626.95 1094.51 627 L 1059.5 627 C 1055.17 626.95 1051.06 625.14 1048.17 622 L 1027.58 599 C 1027 597.72 1027 596.28 1027.58 595 L 1048.17 572 Z",FlowChartDisplay:"M47.8809,19.2914 L32.7968,-0.00594145 L11.3902,-0.00594145 C7.93166,-0.00594145 0.00124586,11.187 0.00124586,24.9968C0.00124586,38.8032 7.93166,49.9962 11.3902,49.9962 L32.7968,49.99 L47.615,31.038 C47.615,31.0388 52.798,24.9968 47.880,19.2914 z",FlowChartManualInput:"M 912 732 L 1006.85 707 C 1008.2 707 1009.5 707.53 1010.46 708.46 C 1011.41 709.4 1011.95 710.67 1011.95 712 L 1011.95 762C 1012 764.41 1010.28 766.52 1007.87 767 L 917.1 767 C 915.75 767 914.45 766.47 913.49 765.54 C 912.54 764.6 912 763.33 912 762 L 912 732 Z",LoopLimit:"M 8 9 L 27 9 L 33 15 L 33 26 C 33 27 33 27 32 27 L 4 27 C 3 27 2 27 2 26 L 2 15 L 8 9 Z",FlowChartStoredData:"M 5.55 0L 50 0A 1.5,30 0 0,1 50,0A 5.555,25 0 0,0 50,50A 1.5,30 0 0,1 50,50L 5.555 50A 5.55,25 0 0,1 5.555,0Z",RightArrow:"M 1178 1382 h -1024 v -716 h 1024 v -338 l 695 696 l -695 696 z",LeftArrow:"M 870 666 h 1024 v 716 h -1024 v 338 l -695 -696 l 695 -696 z",UpArrow:"M 1382 870 v 1024 h -716 v -1024 h -338 l 696 -695 l 696 695 z",DownArrow:"M 666 1178 v -1024 h 716 v 1024 h 338 l -696 695 l -696 -695 z",LeftRightArrow:"M 1382 1280 h -716 v 235 l -491 -491 l 491 -491 v 235 h 716 v -235 l 491 491 l -491 491 z",UpDownArrow:"M 768 1382 v -716 h -235 l 491 -491 l 491 491 h -235 v 716 h 235 l -491 491 l -491 -491 z",QuadArrow:"M 738 1587 h 132 v -409 h -409 v 132 l -286 -286 l 286 -286 v 132 h 409 v -409 h -132 l 286 -286 l 286 286 h -132 v 409 h 409 v -132 l 286 286 l -286 286 v -132 h -409 v 409 h 132 l -286 286 z",LeftRightUpArrow:"M 461 1485 v 132 l -286 -286 l 286 -286 v 133 h 409 v -615 h -132 l 286 -286 l 286 286 h -132 v 615 h 409 v -133 l 286 286 l -286 286 v -132 z",BentArrow:"M 154 1894 v -1126 q 0 -63 24 -119 q 24 -56 66 -98 q 41 -42 97 -66 q 56 -24 120 -24 h 1024 v -235 l 388 388 l -388 389 v -235 h -768 q -53 0 -99 20 q -47 20 -82 55 q -35 35 -55 81 q -20 47 -20 100 v 870 z",UTurnArrow:"M 154 1894 v -1075 q 0 -92 24 -177 q 24 -85 67 -159 q 43 -73 104 -134 q 61 -61 135 -104 q 73 -43 158 -67 q 85 -24 177 -24 h 103 q 92 0 177 24 q 85 24 159 67 q 73 43 134 104 q 61 61 104 134 q 43 74 67 159 q 24 85 24 177 v 359 h 235 l -388 388 l -389 -388 h 235 v -359 q 0 -74 -28 -139 q -28 -65 -77 -114 q -49 -49 -114 -77 q -65 -28 -139 -28 h -103 q -74 0 -139 28 q -65 28 -114 77 q -49 49 -77 114 q -28 65 -28 139 v 1075 z",LeftUpArrow:"M 175 1434 l 388 -389 v 235 h 717 v -717 h -235 l 389 -388 l 388 388 h -235 v 1024 h -1024 v 235 z",BentUpArrow:"M 154 1894 v -307 h 1126 v -1024 h -235 l 389 -388 l 388 388 h -235 v 1331 z",CurvedRightArrow:"M 1280 1587 h -205 q -99 0 -190 -26 q -92 -25 -171 -72 q -80 -47 -145 -112 q -66 -65 -113 -145 q -47 -80 -72 -172 q -26 -91 -26 -190 q 0 -99 26 -191 q 25 -91 72 -171 q 47 -79 113 -145 q 65 -65 145 -112 q 79 -46 171 -72 q 91 -25 190 -25 h 205 v 307 h -205 q -108 0 -208 31 q -101 31 -187 88 q -87 57 -155 137 q -68 81 -110 180 l -10 25 l 14 23 q 50 79 116 141 q 66 62 144 105 q 78 43 166 66 q 87 23 179 23 h 256 v -235 l 388 389 l -388 388 z",CurvedLeftArrow:"M 768 1822 l -388 -388 l 388 -389 v 235 h 256 q 92 0 180 -23 q 87 -23 165 -66 q 78 -43 144 -105 q 66 -62 116 -141 l 14 -23 l -10 -25 q -42 -99 -110 -180 q -68 -80 -154 -137 q -87 -57 -187 -88 q -101 -31 -209 -31 h -205 v -307 h 205 q 99 0 191 25 q 91 26 171 72 q 79 47 145 112 q 65 66 112 145 q 47 80 73 171 q 25 92 25 191 q 0 99 -25 190 q -26 92 -73 172 q -47 80 -112 145 q -66 65 -145 112 q -80 47 -171 72 q -92 26 -191 26 h -205 z",CurvedUpArrow:"M 1587 768 v 205 q 0 99 -25 190 q -26 92 -73 171 q -47 80 -112 145 q -65 66 -145 113 q -80 47 -171 72 q -92 26 -191 26 q -99 0 -190 -26 q -92 -25 -171 -72 q -80 -47 -145 -113 q -66 -65 -112 -145 q -47 -79 -72 -171 q -26 -91 -26 -190 v -205 h 307 v 205 q 0 108 31 208 q 31 101 88 187 q 57 87 138 155 q 80 68 179 110 l 25 10 l 23 -14 q 79 -50 141 -116 q 62 -66 105 -144 q 43 -78 66 -166 q 23 -87 23 -179 v -256 h -235 l 389 -388 l 388 388 z",CurvedDownArrow:"M 1822 1280 l -388 388 l -389 -388 h 235 v -256 q 0 -92 -23 -180 q -23 -87 -66 -165 q -43 -78 -105 -144 q -62 -66 -141 -116 l -23 -14 l -25 10 q -99 42 -179 110 q -81 68 -138 154 q -57 87 -88 187 q -31 101 -31 209 v 205 h -307 v -205 q 0 -99 26 -191 q 25 -91 72 -171 q 46 -79 112 -145 q 65 -65 145 -112 q 79 -47 171 -73 q 91 -25 190 -25 q 99 0 191 25 q 91 26 171 73 q 80 47 145 112 q 65 66 112 145 q 47 80 73 171 q 25 92 25 191 v 205 z",StripedRightArrow:"M 102 614 h 103 v 820 h -103 m 205 -820 h 103 v 820 h -103 m 819 409 v -409 h -614 v -820 h 614 v -409 l 820 819 m -717 307 v 265 l 572 -572 l -572 -572 v 265 h -615 v 614 z",NotchedRightArrow:"M 1126 1843 v -409 h -1024 l 512 -410 l -512 -410 h 1024 v -409 l 820 819 m -717 307 v 265 l 572 -572 l -572 -572 v 265 h -835 l 384 307 l -384 307 z",Pentagon:"M 154 1690 v -1434 h 1002 l 717 717 l -717 717 z",Chevron:"M 226 1690 l 717 -717 l -717 -717 h 930 l 717 717 l -717 717 z",RightArrowCallout:"M 154 154 h 1024 v 716 h 307 v -234 l 388 388 l -388 388 v -234 h -307 v 716 h -1024 z",DownArrowCallout:"M 154 154 h 1740 v 1024 h -716 v 307 h 234 l -388 388 l -388 -388 h 234 v -307 h -716 z",LeftArrowCallout:"M 1894 154 v 1740 h -1024 v -716 h -307 v 234 l -388 -388 l 388 -388 v 234 h 307 v -716 z",UpArrowCallout:"M 1894 1894 h -1740 v -1024 h 716 v -307 h -234 l 388 -388 l 388 388 h -234 v 307 h 716 z",LeftRightArrowCallout:"M 666 1894 v -716 h -205 v 132 l -286 -286 l 286 -286 v 132 h 205 v -716 h 716 v 716 h 205 v -132 l 286 286 l -286 286 v -132 h -205 v 716 z",QuadArrowCallout:"M 738 1587 h 132 v -205 h -204 v -204 h -205 v 132 l -286 -286 l 286 -286 v 132 h 205 v -204 h 204 v -205 h -132 l 286 -286 l 286 286 h -132 v 205 h 204 v 204 h 205 v -132 l 286 286 l -286 286 v -132 h -205 v 204 h -204 v 205 h 132 l -286 286 z",CircularArrow:"M 1045 1382 h 235 v -460 q 0 -74 -28 -140 q -28 -65 -77 -114 q -49 -48 -114 -77 q -65 -28 -139 -28 h -103 q -74 0 -139 28 q -65 29 -114 77 q -49 49 -77 114 q -28 66 -28 140 v 665 h -307 v -665 q 0 -92 24 -177 q 24 -85 67 -159 q 43 -74 104 -135 q 61 -60 135 -104 q 73 -43 158 -67 q 85 -24 177 -24 h 103 q 92 0 177 24 q 85 24 159 67 q 73 44 134 104 q 61 61 104 135 q 43 74 67 159 q 24 85 24 177 v 460 h 235 l -388 389 z",Explosion1:"M 833 1509 l -270 225 v -352 h -282 l 309 -193 l -374 -421 h 450 v -337 l 260 260 l 354 -443 v 418 h 361 l -226 317 l 381 297 h -394 l 228 457 l -479 -218 l -134 312 z",Explosion2:"M 591 1480 l -324 -1 l 208 -249 l -270 -360 h 492 l -135 -270 l 247 82 l 39 -239 l 187 281 l 168 -418 l 35 281 l 417 -186 l -135 408 l 253 42 l -215 172 l 246 206 h -300 l 174 346 l -347 -173 v 353 l -305 -175 l -416 270 z",Star4Point:"M 848 1200 l -572 -176 l 572 -176 l 176 -572 l 176 572 l 572 176 l -572 176 l -176 572 z",Star5Point:"M 1219 768 h 603 l -446 446 l 175 612 l -527 -352 l -527 352 l 175 -612 l -446 -446 h 598 l 202 -521 z",Star6Point:"M 786 1485 h -580 l 350 -461 l -350 -461 h 580 l 238 -367 l 238 367 h 580 l -350 461 l 350 461 h -580 l -238 367 z",Star7Point:"M 1024 1541 l -395 307 l -42 -422 l -396 -176 l 314 -314 l -207 -373 h 461 l 265 -372 l 265 372 h 461 l -207 373 l 314 314 l -396 176 l -42 422 z",Star8Point:"M 738 1587 h -277 v -277 l -286 -286 l 286 -286 v -277 h 282 l 281 -286 l 286 286 h 277 v 277 l 286 286 l -286 286 v 277 h -277 l -286 286 z",Star10Point:"M 828 1635 l -367 48 v -286 l -277 -93 l 198 -280 l -198 -280 l 277 -93 v -286 l 367 48 l 196 -231 l 196 231 l 370 -48 v 286 l 274 92 l -198 281 l 198 280 l -277 93 v 286 l -367 -48 l -196 231 z",Star12Point:"M 868 1611 l -305 231 v -357 h -357 l 231 -305 l -241 -156 l 241 -156 l -231 -305 h 357 v -357 l 305 231 l 156 -241 l 156 241 l 305 -231 v 357 h 357 l -231 305 l 241 156 l -241 156 l 231 305 h -357 v 357 l -305 -231 l -156 241 z",Star16Point:"M-51.20001220703125,0L-37.66234497940063,-6.9061855534744225L-47.302667277832036,-18.06249483215332L-31.9284556123352,-19.667176728401184L-36.204040631713866,-33.375589842071534L-21.333893086395264,-29.434036096916195L-19.593220671386717,-43.60713318054199L-7.491457786102288,-34.71996375514984L0,-47.19999694824219L7.491457786102288,-34.71996375514984L19.593220671386717,-43.60713318054199L21.33389308639528,-29.434036096916195L36.20404063171388,-33.375589842071534L31.928455612335213,-19.667176728401184L47.30266727783204,-18.06249483215332L37.66234497940066,-6.9061855534744225L51.20001220703125,0L37.66234497940066,6.9061855534744225L47.30266727783204,18.06249483215332L31.928455612335213,19.667176728401188L36.20404063171388,33.37558984207155L21.33389308639528,29.434036096916202L19.593220671386717,43.60713318054199L7.491457786102288,34.71996375514985L0,47.19999694824219L-7.491457786102288,34.71996375514985L-19.593220671386717,43.60713318054199L-21.333893086395264,29.434036096916202L-36.204040631713866,33.37558984207155L-31.9284556123352,19.667176728401188L-47.302667277832036,18.06249483215332L-37.66234497940063,6.9061855534744225Z",Star24Point:"M-51.20001220703125,0L-38.071305076904295,-4.620761701240539L-49.45541409708704,-12.216258138985935L-35.47700045837402,-13.546871124114986L-44.34051124536243,-23.599998474121094L-30.464647263336182,-21.55010260665893L-36.20387582842581,-33.3754379140864L-23.37638957336425,-28.084588184165955L-25.600006103515625,-40.87639641572571L-14.694915503540031,-32.70534988540649L-13.251538268661228,-45.59169605307234L-5.012353195037839,-35.096973730773925L0,-47.19999694824219L5.012353195037846,-35.096973730773925L13.251538268661236,-45.59169605307234L14.694915503540045,-32.70534988540649L25.600006103515625,-40.87639641572571L23.37638957336425,-28.084588184165955L36.20387582842582,-33.3754379140864L30.464647263336204,-21.55010260665893L44.340511245362435,-23.599998474121094L35.47700045837402,-13.546871124114986L49.45541409708704,-12.216258138985935L38.07130507690431,-4.620761701240539L51.20001220703125,0L38.07130507690431,4.620761701240539L49.45541409708704,12.216258138985935L35.47700045837402,13.546871124114993L44.340511245362435,23.599998474121094L30.464647263336204,21.550102606658925L36.20387582842582,33.375437914086405L23.37638957336425,28.084588184165966L25.600006103515625,40.87639641572571L14.694915503540045,32.70534988540649L13.251538268661236,45.59169605307234L5.012353195037846,35.096973730773925L0,47.19999694824219L-5.012353195037839,35.096973730773925L-13.251538268661228,45.59169605307234L-14.694915503540031,32.70534988540649L-25.600006103515625,40.87639641572571L-23.37638957336425,28.084588184165966L-36.20387582842581,33.375437914086405L-30.464647263336182,21.550102606658925L-44.34051124536243,23.599998474121094L-35.47700045837402,13.546871124114993L-49.45541409708704,12.216258138985935L-38.071305076904295,4.620761701240539Z",Star32Point:"M-54,0L-40.30479,-3.52872L-52.96266,-9.36432L-38.75607,-10.45008L-49.889520000000005,-18.368640000000003L-35.71776,-16.9704L-44.89938,-26.667360000000002L-31.306905,-22.838040000000007L-38.18376618407357,-33.94112549695428L-25.692795000000004,-27.828360000000004L-30.00078,-39.910560000000004L-19.091700000000003,-31.749120000000005L-20.664719999999996,-44.34624L-11.756339999999994,-34.44984L-10.534859999999995,-47.077920000000006L-3.9698099999999954,-35.82648L0,-48L3.9698100000000025,-35.82648L10.534860000000009,-47.077920000000006L11.756340000000009,-34.44984L20.664720000000003,-44.34624L19.091700000000003,-31.749120000000005L30.000780000000006,-39.910560000000004L25.692795000000004,-27.828360000000004L38.183766184073576,-33.94112549695428L31.306905000000015,-22.838040000000007L44.89938000000001,-26.667360000000002L35.71776000000001,-16.9704L49.889520000000005,-18.368640000000003L38.75607000000001,-10.45008L52.962660000000014,-9.36432L40.30479000000001,-3.52872L54,0L40.30479000000001,3.52872L52.962660000000014,9.36432L38.75607000000001,10.45008L49.889520000000005,18.36864L35.71776000000001,16.970399999999998L44.89938000000001,26.667359999999988L31.306905000000015,22.838039999999992L38.183766184073576,33.941125496954285L25.692795000000004,27.828360000000004L30.000780000000006,39.91055999999999L19.091700000000003,31.749120000000005L20.664720000000003,44.346239999999995L11.756340000000009,34.449839999999995L10.534860000000009,47.077920000000006L3.9698100000000025,35.826480000000004L0,48L-3.9698099999999954,35.826480000000004L-10.534859999999995,47.077920000000006L-11.756339999999994,34.449839999999995L-20.664719999999996,44.346239999999995L-19.091700000000003,31.749120000000005L-30.00078,39.91055999999999L-25.692795000000004,27.828360000000004L-38.18376618407357,33.941125496954285L-31.306905,22.838039999999992L-44.89938,26.667359999999988L-35.71776,16.970399999999998L-49.889520000000005,18.36864L-38.75607,10.45008L-52.96266,9.36432L-40.30479,3.52872Z",UpRibbon:"M 1741 1075 l 205 461 h -717 v -205 h -410 v 205 h -717 l 205 -461 l -205 -461 h 410 v -204 h 1024 v 204 h 410 m -512 615 v -717 h -820 v 717 m -102 -512 h -252 l 159 358 l -159 359 h 252 m 1117 -359 l 159 -358 h -252 v 717 h 252 m -1071 -103 h -103 v 103 h 103 m 717 0 v -103 h -103 v 103 z",DownRibbon:"M 1946 410 l -205 460 l 205 461 h -410 v 205 h -1024 v -205 h -410 l 205 -461 l -205 -460 h 717 v 204 h 410 v -204 m -615 307 v 717 h 820 v -717 m 102 512 h 252 l -159 -359 l 159 -358 h -252 m -1117 358 l -159 359 h 252 v -717 h -252 m 1174 0 h -103 v 102 h 103 m -820 -102 v 102 h 103 v -102 z",CurvedUpRibbon:"M 1741 1075 l 205 666 q -62 -57 -130 -102 q -29 -19 -62 -38 q -34 -18 -70 -33 q -36 -14 -73 -23 q -38 -9 -75 -9 h -307 v -256 q 0 -10 -16 -20 q -16 -9 -44 -16 q -28 -7 -65 -11 q -38 -4 -80 -4 q -42 0 -79 4 q -38 4 -66 11 q -28 7 -44 16 q -16 10 -16 20 v 256 h -307 q -38 0 -75 9 q -38 9 -74 23 q -36 15 -69 33 q -33 19 -62 38 q -69 45 -130 102 l 205 -666 l -205 -461 q 60 -75 122 -117 q 62 -41 119 -62 q 56 -20 104 -25 q 47 -4 78 -4 q 19 -43 65 -80 q 45 -37 111 -64 q 66 -27 149 -42 q 82 -15 174 -15 q 92 0 175 15 q 82 15 148 42 q 66 27 112 64 q 45 37 64 80 q 31 0 79 4 q 47 5 104 25 q 56 21 118 62 q 62 42 122 117 m -1659 876 q 116 -56 225 -56 v -926 l -8 -1 q -21 0 -51 4 q -30 4 -65 16 q -35 12 -73 34 q -39 22 -78 58 l 184 456 m 296 256 h -103 v 103 h 103 m 307 -308 q 72 0 124 8 q 52 9 87 23 q 35 15 55 33 q 20 19 30 39 h 114 v -773 l -4 -9 q -9 -21 -41 -46 q -32 -24 -83 -45 q -52 -21 -123 -35 q -71 -14 -159 -14 q -88 0 -159 14 q -71 14 -123 35 q -52 21 -83 45 q -32 25 -41 46 l -4 9 v 773 h 114 q 10 -20 30 -39 q 20 -18 55 -33 q 35 -14 87 -23 q 52 -8 124 -8 m 410 308 v -103 h -103 v 103 m 296 -380 l 184 -435 q -39 -36 -77 -58 q -39 -22 -74 -34 q -35 -12 -64 -16 q -30 -4 -51 -4 h -9 v 927 q 109 0 225 56 z",CurvedDownRibbon:"M 307 870 l -205 -665 q 61 58 130 103 q 29 19 62 37 q 33 19 69 33 q 36 14 74 23 q 37 9 75 9 h 307 v 256 q 0 11 16 20 q 16 9 44 16 q 28 7 66 11 q 37 4 79 4 q 42 0 80 -4 q 37 -4 65 -11 q 28 -7 44 -16 q 16 -9 16 -20 v -256 h 307 q 37 0 75 -9 q 37 -9 73 -23 q 36 -14 70 -33 q 33 -18 62 -37 q 68 -45 130 -103 l -205 665 l 205 461 q -55 69 -112 110 q -57 41 -110 63 q -54 23 -100 30 q -47 7 -80 7 q -6 0 -11 -1 q -5 0 -10 0 q -19 43 -64 80 q -46 37 -112 64 q -66 27 -148 42 q -83 15 -175 15 q -92 0 -174 -15 q -83 -15 -149 -42 q -66 -27 -111 -64 q -46 -37 -65 -80 q -5 0 -10 0 q -6 1 -11 1 q -33 0 -79 -7 q -47 -7 -100 -30 q -54 -22 -111 -63 q -57 -41 -112 -110 m 1659 -875 q -120 56 -225 56 v 926 h 8 q 21 0 51 -4 q 30 -4 65 -16 q 35 -12 74 -34 q 38 -22 77 -58 l -184 -456 m -296 -256 h 103 v -102 h -103 m -307 307 q -72 0 -124 -9 q -52 -8 -87 -22 q -35 -14 -55 -33 q -20 -18 -30 -38 h -114 v 773 l 4 9 q 9 21 41 45 q 31 25 83 45 q 52 21 123 35 q 71 14 159 14 q 88 0 159 -14 q 71 -14 123 -35 q 51 -20 83 -45 q 32 -24 41 -45 l 4 -9 v -773 h -114 q -10 20 -30 38 q -20 19 -55 33 q -35 14 -87 22 q -52 9 -124 9 m -410 -307 v 102 h 103 v -102 m -296 380 l -184 434 q 39 36 78 58 q 38 22 73 34 q 35 12 65 16 q 29 4 50 4 h 9 v -926 q -105 0 -225 -56 z",VerticalScroll:"M 1690 102 q 53 0 100 20 q 46 20 81 55 q 35 35 55 81 q 20 47 20 100 q 0 53 -20 100 q -20 47 -55 81 q -35 35 -81 55 q -47 20 -100 20 h -52 v 1178 q 0 32 -12 60 q -12 28 -32 49 q -21 21 -49 33 q -28 12 -60 12 h -1178 q -42 0 -79 -17 q -38 -16 -65 -44 q -28 -27 -44 -65 q -17 -37 -17 -79 q 0 -42 17 -80 q 16 -37 44 -65 q 27 -28 65 -44 q 37 -16 79 -16 h 103 v -1280 q 0 -32 12 -60 q 12 -28 33 -49 q 20 -21 48 -33 q 28 -12 60 -12 m 51 308 q 0 -41 16 -78 q 15 -36 42 -64 q 26 -28 62 -45 q 35 -16 76 -18 h -247 q -21 0 -36 15 q -15 15 -15 36 v 1587 h 973 q 21 0 36 -15 q 15 -15 15 -36 v -1178 h -717 q -42 0 -79 -16 q -38 -16 -66 -44 q -28 -27 -44 -65 q -16 -37 -16 -79 m 1076 102 q 31 0 59 -12 q 28 -12 49 -33 q 21 -21 33 -49 q 12 -28 12 -60 q 0 -31 -12 -59 q -12 -28 -33 -49 q -21 -21 -49 -33 q -28 -12 -59 -12 h -863 q 41 2 77 18 q 36 17 63 45 q 26 28 42 64 q 15 37 15 78 q 0 28 -7 53 q -7 26 -20 49 m -587 1126 h -103 q -21 0 -39 8 q -19 8 -33 22 q -14 14 -22 33 q -8 19 -8 40 q 0 21 8 39 q 8 19 22 33 q 14 14 33 22 q 18 8 39 8 h 103 m 409 -1331 q 21 0 40 -8 q 19 -8 33 -22 q 14 -14 22 -33 q 8 -18 8 -39 q 0 -21 -8 -40 q -8 -19 -22 -33 q -14 -14 -33 -22 q -19 -8 -40 -8 q -21 0 -39 8 q -19 8 -33 22 q -14 14 -22 33 q -8 19 -8 40 q 0 21 8 39 q 8 19 22 33 q 14 14 33 22 q 18 8 39 8 z",HorizontalScroll:"M 1741 102 q 42 0 80 16 q 37 17 65 44 q 27 28 44 65 q 16 38 16 80 v 1178 q 0 32 -12 60 q -12 28 -33 48 q -21 21 -49 33 q -28 12 -60 12 h -1178 v 52 q 0 53 -20 99 q -20 47 -54 82 q -35 35 -82 55 q -47 20 -100 20 q -53 0 -99 -20 q -47 -20 -82 -55 q -35 -35 -55 -82 q -20 -46 -20 -99 v -1127 q 0 -32 12 -60 q 12 -28 33 -49 q 21 -20 49 -32 q 28 -12 60 -12 h 1280 v -103 q 0 -42 16 -80 q 16 -37 44 -65 q 28 -27 66 -44 q 37 -16 79 -16 m 102 410 h -1587 q -21 0 -36 15 q -15 15 -15 36 v 248 q 1 -41 18 -77 q 17 -36 45 -63 q 27 -26 64 -42 q 37 -15 78 -15 q 42 0 80 16 q 37 16 65 44 q 27 28 43 65 q 16 38 16 80 v 717 h 1178 q 21 0 36 -15 q 15 -15 15 -36 m -1433 -461 q -41 0 -78 -16 q -37 -15 -64 -42 q -28 -26 -45 -62 q -17 -35 -18 -76 v 862 q 0 32 12 59 q 12 28 33 49 q 21 21 49 33 q 27 12 59 12 q 32 0 60 -12 q 28 -12 49 -33 q 21 -21 33 -49 q 12 -27 12 -59 v -693 q -23 13 -48 20 q -26 7 -54 7 m 1433 -717 q 0 -21 -8 -40 q -8 -18 -22 -32 q -14 -14 -32 -22 q -19 -8 -40 -8 q -21 0 -40 8 q -19 8 -33 22 q -14 14 -22 32 q -8 19 -8 40 v 103 h 205 m -1331 409 q 0 -21 -8 -40 q -8 -18 -22 -32 q -14 -14 -32 -22 q -19 -8 -40 -8 q -21 0 -40 8 q -19 8 -33 22 q -14 14 -22 32 q -8 19 -8 40 q 0 21 8 40 q 8 19 22 33 q 14 14 33 22 q 19 8 40 8 q 21 0 40 -8 q 18 -8 32 -22 q 14 -14 22 -33 q 8 -19 8 -40 z",Wave:"M 1383 1894 q -42 0 -84 -8 q -43 -7 -77 -16 q -34 -9 -55 -17 q -22 -7 -23 -7 q -8 -5 -26 -17 q -18 -11 -39 -25 q -21 -13 -41 -27 q -20 -13 -32 -24 l -38 -33 q -40 -35 -89 -76 q -49 -41 -106 -77 q -58 -35 -123 -59 q -66 -23 -138 -23 q -68 0 -122 10 q -55 10 -99 27 q -44 17 -78 39 q -34 23 -59 47 v -1275 q 24 -16 77 -47 q 52 -30 126 -59 q 73 -29 165 -51 q 91 -22 195 -22 q 72 0 130 17 q 57 18 104 47 q 46 29 85 65 q 38 37 74 75 q 35 39 70 75 q 34 37 72 66 q 38 29 83 46 q 44 18 99 18 q 78 0 147 -24 q 69 -23 127 -59 q 57 -36 104 -80 q 47 -44 82 -85 v 1356 q -16 18 -57 55 q -41 38 -105 75 q -64 37 -149 65 q -86 28 -191 28 z",DoubleWave:"M 1690 1894 q -58 0 -100 -19 q -42 -19 -75 -48 q -33 -28 -62 -61 q -29 -33 -61 -62 q -32 -28 -71 -47 q -39 -19 -92 -19 q -51 0 -92 19 q -42 19 -77 47 q -35 29 -65 62 q -30 33 -59 61 q -29 29 -57 48 q -29 19 -60 19 q -35 0 -73 -19 q -39 -19 -79 -48 q -40 -28 -80 -61 q -40 -33 -79 -62 q -40 -28 -78 -47 q -38 -19 -72 -19 q -26 0 -52 10 q -27 11 -53 27 q -27 17 -52 38 q -25 22 -47 44 v -1480 q 19 -20 45 -42 q 26 -21 54 -39 q 27 -18 55 -30 q 27 -12 50 -12 q 24 0 55 19 q 31 19 67 47 q 36 29 77 62 q 41 33 84 61 q 43 29 88 48 q 45 19 90 19 q 48 0 87 -19 q 38 -19 71 -48 q 33 -28 63 -61 q 29 -33 59 -62 q 30 -28 62 -47 q 31 -19 68 -19 q 36 0 68 19 q 31 19 63 47 q 31 29 64 62 q 33 33 72 61 q 39 29 87 48 q 47 19 107 19 q 70 0 120 -17 q 50 -16 84 -40 v 1477 q -5 6 -17 17 q -12 11 -35 21 q -24 11 -61 18 q -37 8 -91 8 z",MathPlus:"M 1894 1280 h -614 v 614 h -512 v -614 h -614 v -512 h 614 v -614 h 512 v 614 h 614 z",MathMinus:"M 154 768 h 1740 v 512 h -1740 z",MathMultiply:"M 1409 1771 l -435 -435 l -434 435 l -362 -362 l 434 -435 l -434 -434 l 362 -362 l 434 434 l 435 -434 l 362 362 l -435 434 l 435 435 z",MathDivision:"M 1024 1792 q -32 0 -60 -12 q -28 -12 -49 -33 q -21 -21 -33 -49 q -12 -28 -12 -60 q 0 -31 12 -59 q 12 -28 33 -49 q 21 -21 49 -33 q 28 -12 60 -12 q 32 0 60 12 q 28 12 49 33 q 21 21 33 49 q 12 28 12 59 q 0 32 -12 60 q -12 28 -33 49 q -21 21 -49 33 q -28 12 -60 12 m 0 -1229 q -32 0 -60 -12 q -28 -12 -49 -33 q -21 -21 -33 -49 q -12 -27 -12 -59 q 0 -32 12 -60 q 12 -28 33 -49 q 21 -21 49 -33 q 28 -12 60 -12 q 32 0 60 12 q 28 12 49 33 q 21 21 33 49 q 12 28 12 60 q 0 32 -12 59 q -12 28 -33 49 q -21 21 -49 33 q -28 12 -60 12 m -870 205 h 1740 v 512 h -1740 z",MathEqual:"M 154 358 h 1740 v 512 h -1740 m 0 205 h 1740 v 512 h -1740 z",MathNotEqual:"M 1372 870 l -136 205 h 658 v 512 h -1000 l -205 307 h -389 l 205 -307 h -351 v -512 h 693 l 136 -205 h -829 v -512 h 1170 l 137 -204 h 389 l -137 204 h 181 v 512 z",RoundedRectangle:"M 20,0 h 160 a 20,20 0 0 1 20,20 v 60 a 20,20 0 0 1 -20,20 h -160 a 20,20 0 0 1 -20,-20 v -60 a 20,20 0 0 1 20,-20 z",SnipSingleCornerRectangle:"M 154 1690 v -1332 h 1258 l 482 482 v 850 z",SnipSameSideCornerRectangle:"M 154 1690 v -850 l 482 -482 h 776 l 482 482 v 850 z",SnipDiagonalCornerRectangle:"M 636 1690 l -482 -482 v -850 h 1258 l 482 482 v 850 z",SnipAndRoundSingleCornerRectangle:"M 154 1690 v -1029 q 0 -63 24 -118 q 24 -55 65 -96 q 41 -41 96 -65 q 55 -24 117 -24 h 956 l 482 482 v 850 z",RoundSingleCornerRectangle:"M 154 1690 v -1332 h 1438 q 62 0 117 24 q 55 24 96 65 q 41 41 65 96 q 24 55 24 118 v 1029 z",RoundSameSideCornerRectangle:"M 154 1690 v -1029 q 0 -63 24 -118 q 24 -55 65 -96 q 41 -41 96 -65 q 55 -24 117 -24 h 1136 q 62 0 117 24 q 55 24 96 65 q 41 41 65 96 q 24 55 24 118 v 1029 z",RoundDiagonalCornerRectangle:"M 456 1690 q -62 0 -117 -24 q -55 -24 -96 -65 q -41 -41 -65 -96 q -24 -55 -24 -118 v -1029 h 1438 q 62 0 117 24 q 55 24 96 65 q 41 41 65 96 q 24 55 24 118 v 1029 z"},Zl=(Object.defineProperty(i.prototype,"pageCanvas",{get:function(){return this.isPrinting?(_.isNullOrUndefined(this.pageCanvasIn)&&(this.pageCanvasIn=document.createElement("canvas"),this.pageCanvasIn.getContext("2d").save()),this.pageCanvasIn):this.isExporting?(_.isNullOrUndefined(this.exportPageCanvas)&&(this.exportPageCanvas=new Al),this.exportPageCanvas):_.isNullOrUndefined(this.viewer)?void 0:this.documentHelper.containerCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"spellChecker",{get:function(){try{return this.documentHelper.owner.spellCheckerModule}catch(e){}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectionCanvas",{get:function(){return _.isNullOrUndefined(this.viewer)?void 0:this.documentHelper.selectionCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pageContext",{get:function(){return this.pageCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),i.prototype.renderWidgets=function(e,t,i,n,r){if(!_.isNullOrUndefined(this.pageCanvas)&&!_.isNullOrUndefined(e)){var o;this.pageContext.fillStyle=j.getColor(this.documentHelper.backgroundColor),this.pageContext.beginPath(),this.viewer instanceof Wd?(r=r>this.documentHelper.visibleBounds.height?r:this.documentHelper.visibleBounds.height,o=i,0===e.index&&(o=i-this.viewer.padding.top),this.pageContext.fillRect(t-this.viewer.padding.left,o,n+this.viewer.padding.left,r+this.viewer.padding.top)):this.pageContext.fillRect(t,i,n,r),this.pageContext.closePath(),this.viewer instanceof Sd&&(this.pageContext.strokeStyle=this.documentHelper.owner.pageOutline,this.pageContext.strokeRect(t,i,n,r)),this.pageLeft=t,this.pageTop=i,this.pageIndex=e.index,this.isPrinting?this.setPageSize(e):(this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(t,i,n,r),this.pageContext.clip()),this.height=r,e.headerWidget&&this.renderHFWidgets(e,e.headerWidgetIn,n,!0),e.footerWidget&&this.renderHFWidgets(e,e.footerWidgetIn,n,!1);for(var s=0;s<e.bodyWidgets.length;s++)this.render(e,e.bodyWidgets[parseInt(s.toString(),10)]),e.footnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(e,e.footnoteWidget,n);e.endnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(e,e.endnoteWidget,n),this.documentHelper.owner.enableHeaderAndFooter&&!this.isPrinting&&this.renderHeaderSeparator(e,this.pageLeft,this.pageTop,e.headerWidgetIn),this.pageLeft=0,this.pageTop=0,this.pageContext.restore()}},i.prototype.setPageSize=function(e){this.pageContext.clearRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContext.restore(),this.selectionContext.restore();var t=e.boundingRectangle.width,e=e.boundingRectangle.height,i=Math.max(window.devicePixelRatio,this.documentHelper.owner.documentEditorSettings.printDevicePixelRatio);this.pageCanvas.width===t*i&&this.pageCanvas.height===e*i||(this.pageCanvas.height=e*i,this.pageCanvas.width=t*i,this.pageCanvas.style.height=e+"px",this.pageCanvas.style.width=t+"px",this.pageContext.globalAlpha=1,this.pageContext.scale(i,i)),this.pageContext.fillStyle="#FFFFFF",this.pageContext.fillRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.pageContext.fillStyle="#000000"},i.prototype.renderHFWidgets=function(e,t,i,n){this.isFieldCode&&(this.isFieldCode=!1),this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?1:.65);var r,o=!1,s=e.boundingRectangle.height/100*40;n?(r=j.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),s<Math.max(t.y+t.height,r)&&(o=!0,this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.pageTop,i,this.getScaledValue(s)),this.pageContext.clip())):(r=j.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),i=void 0,_.isNullOrUndefined(e.footerWidgetIn.sectionFormat),i=e.boundingRectangle.height-Math.max(e.footerWidgetIn.height+r,j.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin)),Math.max(e.boundingRectangle.height-s,i),e.boundingRectangle.height),this.renderFloatingItems(e,t.floatingElements,"Behind");for(var a=0;a<t.childWidgets.length;a++){var l=t.childWidgets[parseInt(a.toString(),10)];n||l.height,this.renderWidget(e,l)}this.renderFloatingItems(e,t.floatingElements,"InFrontOfText"),o&&this.pageContext.restore(),this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?.5:1)},i.prototype.renderHeaderSeparator=function(e,t,i,n){var r,o,s,a,l,d=j.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),d=this.getScaledValue(Math.max(n.y+n.height,Math.abs(d))),h=this.getScaledValue(e.boundingRectangle.width),c=this.pageContext,p=(c.save(),c.globalAlpha=.85,this.getScaledValue(e.boundingRectangle.height)/100*40),d=Math.min(d,p),u=(this.renderDashLine(c,t,i+d,h,"#000000",!1),this.getHeaderFooterType(e,!0)),n=this.viewer.getHeaderFooter(n.headerFooterType),g=e.sectionIndex,m=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),f=(m.setLocale(this.documentHelper.owner.locale),1<this.documentHelper.headersFooters.length&&(r=g+1,u=u+" -"+m.getConstant("Section")+" "+r+"-"),c.font="9pt Arial",c.measureText(u).width);this.renderHeaderFooterMark(c,t+5,i+d,f+10,20),this.renderHeaderFooterMarkText(c,u,t+10,d+i+15),this.documentHelper.headersFooters[parseInt(g.toString(),10)]&&(o=this.documentHelper.headersFooters[parseInt(g.toString(),10)][parseInt(n.toString(),10)]),0===g||o||(a=m.getConstant("Same as Previous"),u=c.measureText(a).width,l=this.viewer.containerWidth-u-75+t,this.renderHeaderFooterMark(c,l,i+d,u+10,20),this.renderHeaderFooterMarkText(c,a,l+5,d+i+15)),e.footerWidget&&(n=j.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),g=this.getScaledValue(e.boundingRectangle.height)-this.getScaledValue(Math.max(e.footerWidgetIn.height+n,Math.abs(j.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin)))),g=Math.max(this.getScaledValue(e.boundingRectangle.height)-p,g),this.renderDashLine(c,t,i+g,h,"#000000",!1),o=this.getHeaderFooterType(e,!1),u=e.sectionIndex,1<this.documentHelper.headersFooters.length&&(r=u+1,o=o+" -"+m.getConstant("Section")+" "+r+"-"),f=c.measureText(o).width,this.renderHeaderFooterMark(c,t+5,i+g-20,f+10,20),this.renderHeaderFooterMarkText(c,o,t+10,i+g-5),d=this.viewer.getHeaderFooter(e.footerWidget.headerFooterType),this.documentHelper.headersFooters[parseInt(u.toString(),10)]&&(s=this.documentHelper.headersFooters[parseInt(u.toString(),10)][parseInt(d.toString(),10)]),0===u||s||(a=m.getConstant("Same as Previous"),n=c.measureText(a).width,l=this.viewer.containerWidth-n-75+t,this.renderHeaderFooterMark(c,l,i+g-20,n+10,20),this.renderHeaderFooterMarkText(c,a,l+5,i+g-5)),c.restore())},i.prototype.getFooterHeight=function(e){var t=e.boundingRectangle.height/100*40,i=j.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),i=e.boundingRectangle.height-Math.max(e.footerWidgetIn.height+i,j.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin));return Math.max(e.boundingRectangle.height-t,i)},i.prototype.getHeaderFooterType=function(e,t){var i,n=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);return n.setLocale(this.documentHelper.owner.locale),i=t?n.getConstant("Header"):n.getConstant("Footer"),e.bodyWidgets[0].sectionFormat.differentFirstPage&&(_.isNullOrUndefined(e.previousPage)||e.sectionIndex!==e.previousPage.sectionIndex)?i=t?n.getConstant("First Page Header"):n.getConstant("First Page Footer"):e.bodyWidgets[0].sectionFormat.differentOddAndEvenPages&&(i=(this.documentHelper.pages.indexOf(e)+1)%2==0?t?n.getConstant("Even Page Header"):n.getConstant("Even Page Footer"):t?n.getConstant("Odd Page Header"):n.getConstant("Odd Page Footer")),i},i.prototype.renderDashLine=function(e,t,i,n,r,o){e.beginPath(),e.strokeStyle=r,e.lineWidth=1,o?e.setLineDash([3,2]):e.setLineDash([6,4]),e.moveTo(t,i),e.lineTo(t+n,i),e.stroke(),e.setLineDash([]),e.closePath()},i.prototype.renderSolidLine=function(e,t,i,n,r){e.beginPath(),e.strokeStyle=r,e.lineWidth=.5,e.moveTo(t,i),e.lineTo(t+n,i),e.stroke(),e.closePath()},i.prototype.renderHeaderFooterMark=function(e,t,i,n,r){e.beginPath(),e.fillStyle="lightgray",e.fillRect(t,i,n,r),e.strokeStyle="black",e.strokeRect(t,i,n,r),e.closePath()},i.prototype.renderHeaderFooterMarkText=function(e,t,i,n){e.beginPath(),e.fillStyle="#000000",e.textBaseline="alphabetic",e.fillText(t,i,n),e.closePath()},i.prototype.render=function(e,t){this.isFieldCode&&(this.isFieldCode=!1);for(var i=0;i<e.bodyWidgets.length;i++)_.isNullOrUndefined(e.bodyWidgets[i].floatingElements)||this.renderFloatingItems(e,e.bodyWidgets[i].floatingElements,"Behind");var n,r,o,s=!1;_.isNullOrUndefined(t.nextRenderedWidget)||t.columnIndex+1!==t.nextRenderedWidget.columnIndex||(n=t.nextRenderedWidget),this.viewer instanceof Wd||!(1<t.sectionFormat.columns.length)||_.isNullOrUndefined(n)||(n=e.bodyWidgets.indexOf(t),o=r=void 0,o=0===t.columnIndex?(r=e.bodyWidgets[n].x-j.convertPointToPixel(e.bodyWidgets[n].sectionFormat.leftMargin),j.convertPointToPixel(e.bodyWidgets[n].sectionFormat.leftMargin)+t.sectionFormat.columns[t.columnIndex].width+t.sectionFormat.columns[t.columnIndex].space/2):n===t.sectionFormat.columns.length-1?(r=e.bodyWidgets[n].x-t.sectionFormat.columns[t.columnIndex-1].space/2,j.convertPointToPixel(e.bodyWidgets[n].sectionFormat.rightMargin)+t.sectionFormat.columns[t.columnIndex].width+t.sectionFormat.columns[t.columnIndex-1].space/2):(r=e.bodyWidgets[n].x-t.sectionFormat.columns[t.columnIndex].space/2,t.sectionFormat.columns[t.columnIndex].width+t.sectionFormat.columns[t.columnIndex].space),this.clipRect(r,e.bodyWidgets[n].y,this.getScaledValue(o),this.getScaledValue(e.boundingRectangle.height)),s=!0);for(i=0;i<t.childWidgets.length;i++){var a=t.childWidgets[parseInt(i.toString(),10)];0===i&&t.childWidgets[0]instanceof K&&0<t.childWidgets[0].childWidgets.length&&e.repeatHeaderRowTableWidget&&this.renderHeader(e,a,this.documentHelper.layout.getHeader(t.childWidgets[0])),this.renderWidget(e,a)}s&&this.pageContext.restore();for(i=0;i<e.bodyWidgets.length;i++)_.isNullOrUndefined(e.bodyWidgets[i].floatingElements)||this.renderFloatingItems(e,e.bodyWidgets[i].floatingElements,"InFrontOfText");for(var l,d,h,c,i=0;i<e.bodyWidgets.length;i++)!0===e.bodyWidgets[parseInt(i.toString(),10)].sectionFormat.lineBetweenColumns&&0!==e.bodyWidgets[parseInt(i.toString(),10)].columnIndex&&1<e.bodyWidgets.length&&(d=j.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),d=this.getScaledValue(Math.max(e.headerWidgetIn.y+e.headerWidgetIn.height,d)),l=this.getScaledValue(e.boundingRectangle.height)/100*40,c=j.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),c=this.getScaledValue(e.boundingRectangle.height)-this.getScaledValue(Math.max(e.footerWidgetIn.height+c,j.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin))),c=Math.max(this.getScaledValue(e.boundingRectangle.height)-l,c),l=(e.bodyWidgets[parseInt(i.toString(),10)].x-(e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.x+e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.width))/2+(e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.x+e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.width),c=d/this.documentHelper.zoomFactor,d=l,e.footnoteWidget?(e.footerWidgetIn.height,e.footnoteWidget.height,this.documentHelper.zoomFactor,this.documentHelper.zoomFactor):(e.footerWidgetIn.height,this.documentHelper.zoomFactor),h=this.documentHelper.layout.getBodyWidget(e.bodyWidgets[parseInt(i.toString(),10)],!0),h=this.documentHelper.layout.getNextWidgetHeight(h),c=e.bodyWidgets[parseInt(i.toString(),10)].y,this.renderSingleBorder("#000000",l,c,d,h,.5,"Single"))},i.prototype.renderFloatingItems=function(e,t,i){if(!_.isNullOrUndefined(t)&&0<t.length){var n=new T;t.sort(function(e,t){return e instanceof K||t instanceof K?0:e.zOrderPosition-t.zOrderPosition});for(var r=0;r<t.length;r++)t[r]instanceof K||(o=t[r],"Behind"===i&&"Behind"!==o.textWrappingStyle)||"Behind"!==i&&"Behind"===o.textWrappingStyle||(!this.isOverLappedShapeWidget(o)||n.containsKey(o.zOrderPosition)?o instanceof Ic?this.renderImageElementBox(o,o.x,o.y,0):o instanceof uc&&(s=this.getScaledValue(o.x,1),a=this.getScaledValue(o.y,2),this.renderShapeElementBox(o,s,a,e)):n.containsKey(o.zOrderPosition)||n.add(o.zOrderPosition,o));if(0<n.length)for(var o,s,a,l=n.keys.sort(),d=0;d<l.length;d++)(o=n.get(l[d]))instanceof Ic?this.renderImageElementBox(o,o.x,o.y,0):o instanceof uc&&(s=this.getScaledValue(o.x,1),a=this.getScaledValue(o.y,2),this.renderShapeElementBox(o,s,a,e))}},i.prototype.isOverLappedShapeWidget=function(e){return e instanceof Ic&&"Inline"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&!("Word2013"!==this.documentHelper.compatibilityMode&&e.isBelowText&&"InFrontOfText"!==e.textWrappingStyle)||e instanceof uc&&"Inline"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&!("Word2013"!==this.documentHelper.compatibilityMode&&e.isBelowText&&"InFrontOfText"!==e.textWrappingStyle)},i.prototype.renderShapeElementBox=function(e,t,i,n){if(!e.isHorizontalRule){var r=0===e.height,o=e.autoShapeType,s=e.textFrame.childWidgets,t=(this.pageContext.beginPath(),e.fillFormat&&e.fillFormat.color&&e.fillFormat.fill&&"StraightConnector"!==o&&(this.pageContext.fillStyle=e.fillFormat.color,"Rectangle"===o?this.pageContext.fillRect(t,i,this.getScaledValue(e.width),this.getScaledValue(e.height)):this.renderPathElement(e,t,i)),_.isNullOrUndefined(o)||e.lineFormat.line&&"None"!==e.lineFormat.lineFormatType&&(this.pageContext.lineWidth=e.lineFormat.weight,this.pageContext.strokeStyle=j.getColor(e.lineFormat.color),"Rectangle"===o?this.pageContext.strokeRect(t,i,this.getScaledValue(e.width),this.getScaledValue(e.height)):"StraightConnector"===o&&(this.pageContext.moveTo(t,i),this.pageContext.lineTo(t+this.getScaledValue(e.width),i+this.getScaledValue(e.height)),this.pageContext.stroke())),this.pageContext.closePath(),!1);0!=e.width&&0!=e.height&&(t=!0,this.clipRect(e.x,e.y,this.getScaledValue(e.width),this.getScaledValue(e.height)));for(var a=0;a<s.length;a++)this.renderWidget(n,s[a]),r&&"StraightConnector"!==o&&(e.height=j.round(e.height+s[a].height,5));r=r&&!1,t&&this.pageContext.restore()}},i.prototype.renderPathElement=function(e,t,i){var n,r,o;if(e.autoShapeType&&"Unknown"!=e.autoShapeType)switch(e.autoShapeType){case"ElbowConnector":n=this.getConnectorPathData(e);break;case"CurvedConnector":n=this.getCurvedPathData(e);break;default:r=e.autoShapeType,n=Kl[r.toString()]}else e.autoShapeType&&(n=this.constructPath(e));n&&(o=this.calculatePathBounds(n),o=this.updatePath(n,o,e),this.drawPath(o,e,t,i))},i.prototype.renderWidget=function(e,t){this.documentHelper.owner.enableLockAndEdit&&this.renderLockRegionBorder(e,t),t instanceof G?this.renderParagraphWidget(e,t):this.renderTableWidget(e,t)},i.prototype.getConnectorPathData=function(e){var t=e.distanceTop,i=e.distanceLeft,n=e.distanceTop+this.getScaledValue(e.width),e=e.distanceLeft+this.getScaledValue(e.height),r=t+(n-t)/2,t="M "+t+","+i+" ";return(t+="L "+r+","+i+" ")+("L "+r+","+e+" ")+("L "+n+","+e)},i.prototype.getCurvedPathData=function(e){var t=e.distanceTop,i=e.distanceLeft,n=e.distanceTop+this.getScaledValue(e.width),r=e.distanceLeft+this.getScaledValue(e.height);return"M "+t+","+i+" C "+(t+this.getScaledValue(e.width)/1.5)+","+i+" "+(n-this.getScaledValue(e.width)/1.5)+","+r+" "+n+","+r},i.prototype.constructPath=function(e){var t,i=e.editingPoints,n={};for(t in i)i.hasOwnProperty(t)&&(n[t]=this.calculateCoord(i[t],400,400));return"\n      M "+n.connsiteX0+","+n.connsiteY0+"\n      L "+n.connsiteX1+","+n.connsiteY1+"\n      L "+n.connsiteX2+","+n.connsiteY2+"\n      L "+n.connsiteX3+","+n.connsiteY3+"\n      L "+n.connsiteX4+","+n.connsiteY4+"\n      Z\n    "},i.prototype.calculateCoord=function(e,t,i){var e=e.split(" "),n=e[0],r=parseFloat(e[1]),t="w"===e[2]?t:i,i=parseFloat(e[3]);return"*/"===n?r/i*t:0},i.prototype.drawPath=function(e,t,i,n){e=function(e){for(var t,i,n,r,o,s,a=[],l=0,d=0,h=0,c=e.length;h<c;++h){var p,u,g=e[h],m=g.command,f=("y1"in g&&(r=g.y1),"y2"in g&&(s=g.y2),"x1"in g&&(n=g.x1),"x2"in g&&(o=g.x2),"x"in g&&(l=g.x),"y"in g&&(d=g.y),a[a.length-1]);switch(m){case"M":a.push({command:"M",x:l,y:d});break;case"L":a.push({command:"L",x0:t,y0:i,x:l,y:d});break;case"H":a.push({command:"L",x0:t,y0:i,x:l,y:i});break;case"V":a.push({command:"L",x0:t,y0:i,x:t,y:d});break;case"C":a.push({command:"C",x0:t,y0:i,x1:n,y1:r,x2:o,y2:s,x:l,y:d});break;case"S":f&&(p=void 0,u={x:2*t-(p="C"===f.command||"S"===f.command?{x:f.x2,y:f.y2}:{x:t,y:i}).x,y:2*i-p.y},a.push({command:"C",x0:t,y0:i,x1:u.x,y1:u.y,x2:o,y2:s,x:l,y:d}));break;case"Q":a.push({command:"Q",x0:t,y0:i,x1:n,y1:r,x:l,y:d});break;case"T":f&&(p=void 0,u={x:2*t-(p="Q"===f.command?{x:f.x1,y:f.y1}:{x:t,y:i}).x,y:2*i-p.y},a.push({command:"Q",x0:t,y0:i,x1:u.x,y1:u.y,x:l,y:d}));break;case"A":var y=g;y.command="A",a.push(y);break;case"Z":case"z":a.push({command:"Z"}),l=t,d=i}t=l,i=d}return a}(zl(e)),this.setStyle(t);t=this.pageContext;t.translate&&(t.save(),t.beginPath(),t.translate(i,n),this.renderPath(t,e),t.fill(),t.translate(-i,-n),t.stroke(),t.restore())},i.prototype.renderPath=function(e,t){for(var i,n,r,o,s,a,l=e,d=t,h=0,c=0,p=0,u=d.length;p<u;++p){var g=d[parseInt(p.toString(),10)],m=g.command;switch("x1"in g&&(r=g.x1),"x2"in g&&(s=g.x2),"y1"in g&&(o=g.y1),"y2"in g&&(a=g.y2),"x"in g&&(h=g.x),"y"in g&&(c=g.y),m){case"M":l.moveTo(h,c),g.x=h,g.y=c;break;case"L":l.lineTo(h,c),g.x=h,g.y=c;break;case"C":l.bezierCurveTo(r,o,s,a,h,c),g.x=h,g.y=c,g.x1=r,g.y1=o,g.x2=s,g.y2=a;break;case"Q":l.quadraticCurveTo(r,o,h,c),g.x=h,g.y=c,g.x1=r,g.y1=o;break;case"A":var f=i,y=n,v=g.r1,w=g.r2,b=g.angle*(Math.PI/180),x=g.largeArc,C=g.sweep,I=h,k=c,F={x:Math.cos(b)*(f-I)/2+Math.sin(b)*(y-k)/2,y:-Math.sin(b)*(f-I)/2+Math.cos(b)*(y-k)/2},P=Math.pow(F.x,2)/Math.pow(v,2)+Math.pow(F.y,2)/Math.pow(w,2),P=(1<P&&(v*=Math.sqrt(P),w*=Math.sqrt(P)),Math.pow(w,2)*Math.pow(F.x,2)),x=(x===C?-1:1)*Math.sqrt((Math.pow(v,2)*Math.pow(w,2)-Math.pow(v,2)*Math.pow(F.y,2)-P)/(Math.pow(v,2)*Math.pow(F.y,2)+Math.pow(w,2)*Math.pow(F.x,2))),P=(x=isNaN(x)?0:x)*v*F.y/w,x=x*-w*F.x/v,f={x:(f+I)/2+Math.cos(b)*P-Math.sin(b)*x,y:(y+k)/2+Math.sin(b)*P+Math.cos(b)*x},I=this.a([1,0],[(F.x-P)/v,(F.y-x)/w]),y=[(F.x-P)/v,(F.y-x)/w],k=[(-F.x-P)/v,(-F.y-x)/w],P=this.a(y,k),F=(this.r(y,k)<=-1&&(P=Math.PI),C?1:-1),x=I+(P=1<=this.r(y,k)?0:P)/2*F;Math.cos(x),Math.sin(x);g.centp=f,g.xAxisRotation=b,g.rx=v,g.ry=w,g.a1=I,g.ad=P,g.sweep=C,null!=l&&(y=w<v?v:w,k=w<v?1:v/w,F=w<v?w/v:1,l.save(),l.translate(f.x,f.y),l.rotate(b),l.scale(k,F),l.arc(0,0,y,I,I+P,!C),l.scale(1/k,1/F),l.rotate(-b),l.translate(-f.x,-f.y),l.restore());break;case"Z":case"z":l.closePath(),h=i,c=n}i=h,n=c}},i.prototype.m=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},i.prototype.r=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(this.m(e)*this.m(t))},i.prototype.a=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(this.r(e,t))},i.prototype.updatePath=function(e,t,i){var n=!1,r="",o=-t.x,s=-t.y;return this.getScaledValue(i.width)===t.width&&this.getScaledValue(i.height)===t.height||(o=this.getScaledValue(i.width)/Number(t.width||1),s=this.getScaledValue(i.height)/Number(t.height||1),n=!0),i=function(e){for(var t,i,n,r,o,s,a=0,l=0,d=0,h=e.length;d<h;++d){var c=e[parseInt(d.toString(),10)],p=c.command;if(/[MLHVCSQTA]/.test(p))"x"in c&&(c.x=a=c.x),"y"in c&&(c.y=l=c.y);else{"x1"in c&&(c.x1=n=a+c.x1),"x2"in c&&(c.x2=o=a+c.x2),"y1"in c&&(c.y1=r=l+c.y1),"y2"in c&&(c.y2=s=l+c.y2),"x"in c&&(c.x=a+=c.x),"y"in c&&(c.y=l+=c.y);var u=void 0;switch(p){case"m":case"M":u={command:"M",x:a,y:l};break;case"l":case"L":u={command:"L",x:a,y:l};break;case"h":case"H":u={command:"H",x:a};break;case"v":case"V":u={command:"V",y:l};break;case"c":case"C":u={command:"C",x:a,y:l,x1:n,y1:r,x2:o,y2:s};break;case"s":case"S":u={command:"S",x:a,y:l,x2:o,y2:s};break;case"q":case"Q":u={command:"Q",x:a,y:l,x1:n,y1:r};break;case"t":case"T":u={command:"T",x:a,y:l};break;case"a":case"A":(u={command:"A",x:a,y:l}).r1=c.r1,u.r2=c.r2,u.angle=c.angle,u.largeArc=c.largeArc,u.sweep=c.sweep;break;case"z":case"Z":u={command:"Z"},a=t,l=i,u=e[parseInt(d.toString(),10)]}u&&(e[parseInt(d.toString(),10)]=u)}"M"!==p&&"m"!==p||(t=a,i=l)}return e}(zl(e)),r=n?jl(i,o,s,n,t.x,t.y,0,0):ql(i),n=!1,r},i.prototype.calculatePathBounds=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=(document.body.appendChild(t),document.createElementNS("http://www.w3.org/2000/svg","path")),e=(i.setAttribute("d",e),t.appendChild(i),i.getBBox());return t.remove(),new Rd(e.x,e.y,e.width,e.height)},i.prototype.setStyle=function(e){var t=this.pageContext;"none"===e.lineFormat.color&&(e.lineFormat.color="transparent"),t.strokeStyle=j.getColor(e.lineFormat.color),t.lineWidth=e.lineFormat.weight,0===e.lineFormat.weight&&(t.strokeStyle="transparent")},i.prototype.renderLockRegionBorder=function(e,t){var i,n,r,o,s,a;!t.isInsideTable&&t instanceof Qd&&t.locked&&(o=this.documentHelper.owner.documentEditorSettings.collaborativeEditingSettings,e=e.bodyWidgets[0].sectionFormat,i=j.convertPointToPixel(e.leftMargin)-5,e=e.pageWidth-e.leftMargin-e.rightMargin,e=j.convertPointToPixel(e)+10,this.viewer instanceof Wd&&(i=t.x-5,e=(this.documentHelper.visibleBounds.width-5*this.viewer.padding.right)/this.documentHelper.zoomFactor),n=t.previousRenderedWidget,r=t.nextRenderedWidget,o=t.lockedBy===this.documentHelper.owner.currentUser?o.editableRegionColor:o.lockedRegionColor,s=t.y,a=t.y+t.height,this.renderSingleBorder(o,i,s,i,a,1,"Single"),!_.isNullOrUndefined(n)&&n.locked&&t.lockedBy===n.lockedBy||this.renderSingleBorder(o,i,s,i+e,s,1,"Single"),this.renderSingleBorder(o,i+e,s,i+e,a,1,"Single"),!_.isNullOrUndefined(r)&&r.locked&&t.lockedBy===r.lockedBy||this.renderSingleBorder(o,i,a,i+e,a,1,"Single"))},i.prototype.renderHeader=function(e,t,i){if(!_.isNullOrUndefined(i)){e.viewer.updateClientArea(e.bodyWidgets[0],e);var n=e.viewer.clientArea.y,r=i.ownerTable.getSplitWidgets()[0];if(0!==r.childWidgets.length&&-1===t.childWidgets.indexOf(i)){var o=r.clone();o.childWidgets=[],e.viewer.updateClientAreaLocation(o,new Rd(e.viewer.clientArea.x,n,o.width,o.height)),this.updateTableHeaderRows(i,o,e,n),this.isRenderHeader=!0;for(var s=0;s<o.childWidgets.length;s++){for(var a,l=o.childWidgets[s],d=0;d<l.childWidgets.length;d++)a=l.childWidgets[d],this.renderTableCellWidget(e,a);n+=l.height}this.isRenderHeader=!1,t.y!==n&&e.documentHelper.layout.updateChildLocationForTable(n,t)}}},i.prototype.updateTableHeaderRows=function(e,t,i,n){for(var r=e.ownerTable,o=1,s=0;s<r.childWidgets.length;s++){var a=r.childWidgets[s];if(a.rowFormat.isHeader){var l=a.clone();if(t.childWidgets.push(l),l.containerWidget=t,i.viewer.updateClientAreaLocation(l,new Rd(i.viewer.clientArea.x,n,l.width,l.height)),i.documentHelper.layout.updateChildLocationForRow(n,l),n+=l.height,a==e){for(var d=0;d<e.childWidgets.length;d++)var h=e.childWidgets[d],o=Math.max(o,h.cellFormat.rowSpan);if(1<o&&s+o<r.childWidgets.length)for(var c=1;c<o;c++){var p=r.childWidgets[s+c];_.isNullOrUndefined(p)||(p=p.clone(),t.childWidgets.push(p),p.containerWidget=t,i.viewer.updateClientAreaLocation(p,new Rd(i.viewer.clientArea.x,n,p.width,p.height)),i.documentHelper.layout.updateChildLocationForRow(n,p),n+=p.height)}}}}},i.prototype.renderParagraphWidget=function(e,t){if(!this.isFieldCode||!t.isFieldCodeBlock){var i=t.y,n=t.x,r=!1,o=t.firstChild,s=0;if(!_.isNullOrUndefined(o))for(var a=0;a<o.children.length;a++){var l=o.children[a];if(l instanceof X){s=l.padding.left;break}}0<s&&(this.clipRect(t.x+s,this.getScaledValue(e.boundingRectangle.y),this.getScaledValue(e.boundingRectangle.width),this.getScaledValue(e.boundingRectangle.height)),r=!0),t.containerWidget instanceof Xd&&t.containerWidget.isEmpty&&!_.isNullOrUndefined(this.documentHelper.owner.selectionModule)&&!_.isNullOrUndefined(this.documentHelper.selection.start.paragraph)&&!this.documentHelper.selection.start.paragraph.isInHeaderFooter||this.renderParagraphBorder(e,t),r&&this.pageContext.restore();for(a=0;a<t.childWidgets.length;a++){var d=t.childWidgets[a];i+=d.marginTop,this.renderLine(d,e,n,i),i+=d.height}}},i.prototype.renderParagraphBorder=function(e,t){var i=t.paragraphFormat.borders.left,n=t.paragraphFormat.borders.top,r=t.paragraphFormat.borders.right,o=t.paragraphFormat.borders.bottom,s=0,a=0,l=0,d=0,h=0,c=t.firstChild,p=t.lastChild,u=this.documentHelper.canRenderBorder(t);_.isNullOrUndefined(i)||"None"===i.lineStyle||(l=s=this.documentHelper.getParagraphLeftPosition(t)-j.convertPointToPixel(i.space),d=a+t.height,d="None"!==n.lineStyle&&c.isFirstLine()&&!u.skipTopBorder?(a=t.y+this.getTopMargin(t)-j.convertPointToPixel(n.lineWidth+n.space))+t.height-(this.getTopMargin(t)-j.convertPointToPixel(n.lineWidth+n.space)):(a=t.y)+t.height,"None"!==o.lineStyle&&p.isLastLine()&&!u.skipBottomBorder&&(d=d+j.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t)),h=j.convertPointToPixel(i.lineWidth),this.renderSingleBorder(i.color,s,a,l,d,h,i.lineStyle)),_.isNullOrUndefined(n)||"None"===n.lineStyle||!c.isFirstLine()||u.skipTopBorder||(l=(s=this.documentHelper.getParagraphLeftPosition(t))+this.getContainerWidth(t,e),d=a=t.y+this.getTopMargin(t)-j.convertPointToPixel(n.lineWidth+n.space),"None"!==i.lineStyle&&(s-=j.convertPointToPixel(i.space)),"None"!==r.lineStyle&&(l+=j.convertPointToPixel(r.space)),h=j.convertPointToPixel(n.lineWidth),this.renderSingleBorder(n.color,s,a,l,d,h,n.lineStyle)),_.isNullOrUndefined(r)||"None"===r.lineStyle||(l=s=this.documentHelper.getParagraphLeftPosition(t)+this.getContainerWidth(t,e)+j.convertPointToPixel(r.space),d=(a=d)+t.height,d="None"!==n.lineStyle&&c.isFirstLine()&&!u.skipTopBorder?(a=t.y+this.getTopMargin(t)-j.convertPointToPixel(n.lineWidth+n.space))+t.height-(this.getTopMargin(t)-j.convertPointToPixel(n.lineWidth+n.space)):(a=t.y)+t.height,"None"!==o.lineStyle&&p.isLastLine()&&!u.skipBottomBorder&&(d=d+j.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t)),h=j.convertPointToPixel(r.lineWidth),this.renderSingleBorder(r.color,s,a,l,d,h,r.lineStyle)),_.isNullOrUndefined(o)||"None"===o.lineStyle||!p.isLastLine()||u.skipBottomBorder||(l=(s=this.documentHelper.getParagraphLeftPosition(t))+this.getContainerWidth(t,e),d=a=t.y+t.height+j.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t),"None"!==i.lineStyle&&(s-=j.convertPointToPixel(i.space)),"None"!==r.lineStyle&&(l+=j.convertPointToPixel(r.space)),h=j.convertPointToPixel(o.lineWidth),this.renderSingleBorder(o.color,s,a,l,d,h,o.lineStyle))},i.prototype.renderImgBorder=function(e,t,i,n,r,o,s,a){var l,d=e.width/this.documentHelper.zoomFactor,o=j.convertPointToPixel(o),h=this.documentHelper.selection.getNextTextElement(e),c=this.documentHelper.selection.getPreviousTextElement(e),p="Subscript"===s?e.margin.top+(e.height-e.height/1.5):e.margin.top,s=e.height/("Normal"===s?1:1.5)+15,u=0,g=0,u=i+=0<p?p:0,g=i;this.renderSingleBorder(n,p=t,u,l=t+d,g,o,r),this.renderSingleBorder(n,p,g=u=i+s,l,g,o,r),u=i,l=t,c instanceof X&&(r=c.line!==e.line||null==c.contentControlProperties?"Solid":"None"),this.renderSingleBorder(n,p,u,l,g,o,r),l=p=t+d,r=!(h instanceof X)||h.line!==e.line||null==h.contentControlProperties?"Solid":"None",this.renderSingleBorder(n,p,u,l,g,o,r)},i.prototype.getContainerWidth=function(e,t){var i,n,r=0;return e.paragraphFormat.firstLineIndent<0&&(r=Math.abs(e.paragraphFormat.firstLineIndent)),e.isInsideTable?(i=e.associatedCell).width+i.margin.left+i.margin.right-i.leftBorderWidth:this.viewer instanceof Wd?(i=j.convertPointToPixel(e.leftIndent+e.rightIndent),(this.documentHelper.visibleBounds.width-i-4*this.viewer.padding.right-2*this.viewer.padding.left)/this.documentHelper.zoomFactor):(i=e.bodyWidget)instanceof z&&1<i.sectionFormat.columns.length?(n=i.columnIndex,i.sectionFormat.columns[n].width+j.convertPointToPixel(r-(e.rightIndent+e.leftIndent))):(n=i.sectionFormat.pageWidth-i.sectionFormat.leftMargin-i.sectionFormat.rightMargin,j.convertPointToPixel(n+r-(e.rightIndent+e.leftIndent)))},i.prototype.getTopMargin=function(e){var t;return e.isEmpty()?e.childWidgets[0].margin.top:(e=e.childWidgets[0],t=0,_.isNullOrUndefined(e.margin)?t:e.margin.top)},i.prototype.getBottomMargin=function(e){var t;return e.isEmpty()?e.childWidgets[e.childWidgets.length-1].margin.bottom:(e=e.childWidgets[e.childWidgets.length-1],t=0,_.isNullOrUndefined(e.margin)?t:e.margin.bottom)},i.prototype.renderfootNoteWidget=function(e,t,i){1!==t.page.bodyWidgets.length||1===t.page.bodyWidgets[0].childWidgets.length&&null!=t.page.bodyWidgets[0].childWidgets[0].isEmpty&&t.page.bodyWidgets[0].childWidgets[0].isEmpty()||t.page.bodyWidgets[0].childWidgets.length;var n=this.getFooterHeight(e),r=t.y+t.height;n<r&&(r=n-t.y),this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.getScaledValue(t.y,2),this.getScaledValue(i),this.getScaledValue(r)),this.pageContext.clip();for(var o=0;o<t.bodyWidgets.length;o++)for(var s=t.bodyWidgets[o],a=s.footNoteReference,l=0;l<s.childWidgets.length;l++){var d,h,c,p=s.childWidgets[l];0===o&&0===l&&(c=this.pageContext,d=e.bodyWidgets[0].x,1<e.bodyWidgets.length&&!_.isNullOrUndefined(s.nextWidget)&&"NoBreak"!==s.nextWidget.sectionFormat.breakCode?(h=e.bodyWidgets[0].width,this.renderSolidLine(c,this.getScaledValue(d,1),this.getScaledValue(t.y+t.margin.top/2+1,2),h*this.documentHelper.zoomFactor,"#000000")):this.renderSolidLine(c,this.getScaledValue(d,1),this.getScaledValue(t.y+t.margin.top/2+1,2),210*this.documentHelper.zoomFactor,"#000000")),_.isNullOrUndefined(a)||this.documentHelper.owner.editorModule.isFootNoteInsert||(h=this.documentHelper.getFirstParagraphBlock(p)).firstChild.children[0]instanceof X&&""===(c=h.firstChild.children[0]).text&&(c.text=c.text.replace(c.text,a.text),c.width=a.width),this.renderWidget(e,p)}this.pageContext.restore()},i.prototype.renderTableWidget=function(e,t){if(!this.isFieldCode)for(var i=0;i<t.childWidgets.length;i++){var n,r,o,s=t.childWidgets[i];this.renderTableRowWidget(e,s),0<t.tableFormat.cellSpacing&&this.renderTableOutline(t),s.isRenderBookmarkEnd&&this.documentHelper.owner.documentEditorSettings.showBookmarks&&(r=(n=s.lastChild).ownerTable.isBidiTable?N.getCellLeftBorder(n):N.getCellRightBorder(n),r=j.convertPointToPixel(r.getLineWidth()),o=(s=this.documentHelper.selection.getLastParagraph(s.lastChild)).lastChild.height-s.lastChild.margin.bottom,this.renderBookmark(this.getScaledValue(n.x+n.width+n.margin.right-r/2+this.documentHelper.textHelper.getParagraphMarkWidth(s.characterFormat),1),this.getScaledValue(n.y-n.margin.top,2),this.getScaledValue(o),1))}},i.prototype.renderTableRowWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var n,r=t.childWidgets[i];this.renderTableCellWidget(e,r),r.isRenderBookmarkEnd&&this.documentHelper.owner.documentEditorSettings.showBookmarks&&(n=(r=this.documentHelper.selection.getLastParagraph(r)).lastChild,r=this.documentHelper.selection.getEndPosition(r),this.renderBookmark(this.getScaledValue(r.x,1),this.getScaledValue(r.y,2),this.getScaledValue(n.height-n.margin.bottom),1))}},i.prototype.renderTableCellWidget=function(e,t){if(!this.isPrinting&&!this.isExporting){var i=t.margin.top-t.containerWidget.topBorderWidth,n=t.margin.bottom-t.containerWidget.bottomBorderWidth;if(this.getScaledValue(t.y,2)+t.height+n*this.documentHelper.zoomFactor<0||this.getScaledValue(t.y,2)-i>this.documentHelper.visibleBounds.height)return}this.renderSelectionHighlightOnTable(e,t),this.renderTableCellOutline(e.documentHelper,t);for(var r,o,s,a,l=0;l<t.childWidgets.length;l++){var d=t.childWidgets[l],h=t.width+t.margin.left+t.margin.right-t.leftBorderWidth;this.isPrinting||this.clipRect(t.x-t.margin.left,t.y,this.getScaledValue(h),this.getScaledValue(this.height)),this.renderWidget(e,d),this.pageContext.restore()}t.isRenderEditRangeStart&&(r=(n=this.documentHelper.selection.getFirstParagraph(t).firstChild).paragraph.x,i=n.paragraph.y,this.documentHelper.owner.documentEditorSettings.highlightEditableRanges)&&(o=this.documentHelper.selection.editRegionHighlighters,s=_.isNullOrUndefined(o)?[]:o.get(n),a=_.isNullOrUndefined(s)||_.isNullOrUndefined(s[0])?"ffff00":s[0].color,this.renderBookmark(this.getScaledValue(r,1),this.getScaledValue(i,2),this.getScaledValue(n.height-n.margin.bottom),0,a)),t.isRenderEditRangeEnd&&(n=(i=this.documentHelper.selection.getLastParagraph(t)).lastChild,i=this.documentHelper.selection.getEndPosition(i),r=this.documentHelper.textHelper.getWidth(String.fromCharCode(164),n.paragraph.characterFormat)+i.x,this.documentHelper.owner.documentEditorSettings.highlightEditableRanges)&&(o=this.documentHelper.selection.editRegionHighlighters,s=_.isNullOrUndefined(o)?[]:o.get(n),a=_.isNullOrUndefined(s)||_.isNullOrUndefined(s[0])?"ffff00":s[0].color,this.renderBookmark(this.getScaledValue(r,1),this.getScaledValue(i.y,2),this.getScaledValue(n.height-n.margin.bottom),0,a))},i.prototype.checkHeaderFooterLineWidget=function(e,t){if(e instanceof uh?i=e.paragraph.bodyWidget:e instanceof N&&(i=e.bodyWidget),!_.isNullOrUndefined(i.parentHeaderFooter))for(var i=i.parentHeaderFooter,n=0;n<t.length;n++){var r=t[n];if(r instanceof uh&&e instanceof uh){var o=r.getHierarchicalIndex(""),s=e.getHierarchicalIndex("");if(r.paragraph.isInHeaderFooter&&i===r.paragraph.bodyWidget&&o.substring(o.indexOf(";"))===s.substring(s.indexOf(";")))return r}else if(r instanceof N&&e instanceof N){o=r.getHierarchicalIndex(""),s=e.getHierarchicalIndex("");if(r.ownerTable.isInHeaderFooter&&i===r.ownerTable.bodyWidget&&o.substring(o.indexOf(";"))===s.substring(s.indexOf(";")))return r}}},i.prototype.renderEditregionContentHighlight=function(e,t,i){if(!_.isNullOrUndefined(this.documentHelper.owner.editorModule)&&e.documentHelper.selection&&!_.isNullOrUndefined(e.documentHelper.selection.contentControleditRegionHighlighters)){var n=this.documentHelper.owner.editorModule.getContentControl();if(!_.isNullOrUndefined(n)){var r=this.documentHelper.selection.contentControleditRegionHighlighters.get(n),o=i;if(!_.isNullOrUndefined(r)&&t==n.line)for(var s=0;s<r.length;s++){var a=n.contentControlProperties.color,l=("#00000000"===a&&(a="#939393"),r.get(r.keys[s])),d=o;o+=r.keys[s].height;for(var h=0;h<l.length;h++){var c,p,u,g=l[h].left-2,m=l[h].left+l[h].width+2,f=(r.length-1>s&&(m=this.documentHelper.getParagraphLeftPosition(t.paragraph)+this.getContainerWidth(t.paragraph,e)+j.convertPointToPixel(t.paragraph.paragraphFormat.borders.right.space)),d),y=o;0==s&&(this.renderSingleBorder(a,g,f,g,y,1,"single"),this.renderSingleBorder(a,g,f,m,f,1,"single"),this.renderSingleBorder(a,m,f,m,y,1,"single"),1===r.length)&&this.renderSingleBorder(a,g,y,m,y,1,"single"),0<s&&s<r.length-1&&(this.renderSingleBorder(a,g,f,g,y,1,"single"),this.renderSingleBorder(a,m,f,m,y,1,"single"),c=r.get(r.keys[s-1]),this.renderSingleBorder(a,g,f,c[h].left-2,f,1,"single")),s==r.length-1&&1<r.length&&(this.renderSingleBorder(a,g,f,g,y,1,"single"),g>(c=r.get(r.keys[s-1]))[h].left&&this.renderSingleBorder(a,c[h].left-2,f,g,f,1,"single"),u=r.keys[s].paragraph.lastChild,!_.isNullOrUndefined(u)&&r.keys[s]===u&&u.children[u.children.length-1]instanceof E&&u.children[u.children.length-1]===n.reference&&"Block"===n.contentControlWidgetType?(m=this.documentHelper.getParagraphLeftPosition(r.keys[s].paragraph)+this.getContainerWidth(r.keys[s].paragraph,e)+j.convertPointToPixel(r.keys[s].paragraph.paragraphFormat.borders.right.space),this.renderSingleBorder(a,g,y,m,y,1,"single")):(this.renderSingleBorder(a,g,y,m,y,1,"single"),1<r.length&&(u=r.get(r.keys[s-1]),p=this.documentHelper.getParagraphLeftPosition(t.paragraph)+this.getContainerWidth(t.paragraph,e)+j.convertPointToPixel(t.paragraph.paragraphFormat.borders.right.space),this.renderSingleBorder(a,m,f,p,f,1,"single"),g<u[h].left-2)&&this.renderSingleBorder(a,u[h].left-2,f,g,f,1,"single")),this.renderSingleBorder(a,m,f,m,y,1,"single")),s!=r.length-1||_.isNullOrUndefined(n)||"ComboBox"!==n.contentControlProperties.type&&"DropDownList"!==n.contentControlProperties.type&&"Date"!==n.contentControlProperties.type||((p=document.getElementById("contenticon"))?(p.style.display="block",g=this.getScaledValue(m,1),f=this.getScaledValue(f,2),p.style.left=g+"px",p.style.top=f+"px",p.style.border="0.5px solid #7F7F7F",p.style.backgroundColor="#D3D3D3",p.style.height=t.height+"px",p):((u=document.createElement("div")).id="contenticon",u.style.display="block",u.style.position="sticky",g=this.getScaledValue(m,1),f=this.getScaledValue(f,2),u.style.left=g+"px",u.style.top=f+"px",u.style.border="0.5px solid #7F7F7F",u.style.backgroundColor="#D3D3D3",u.style.height=t.height+"px",u.classList.add("e-de-cmt-mark"),(y=document.createElement("span")).classList.add("e-icons"),y.classList.add("e-chevron-down-fill"),u.appendChild(y),this.documentHelper.pageContainer.appendChild(u),u)).addEventListener("click",this.documentHelper.owner.editor.contentControlDropDownChange.bind(this))}}}}},i.prototype.renderEditRegionHighlight=function(e,t,i){if(e.documentHelper.selection&&!_.isNullOrUndefined(e.documentHelper.selection.editRegionHighlighters)){var n,e=this.documentHelper.selection.editRegionHighlighters.containsKey(t);if(!e&&t.paragraph.isInHeaderFooter&&(n=this.documentHelper.selection.editRegionHighlighters.keys,t=this.checkHeaderFooterLineWidget(t,n),_.isNullOrUndefined(t)||(e=!0)),e)for(var r=this.documentHelper.selection.editRegionHighlighters.get(t),o=0;o<r.length;o++)this.pageContext.fillStyle=""!==r[o].color?r[o].color:"#add8e6",this.pageContext.fillRect(this.getScaledValue(r[o].left,1),this.getScaledValue(i,2),this.getScaledValue(r[o].width),this.getScaledValue(t.height))}},i.prototype.renderSearchHighlight=function(e,t,i){if(this.documentHelper.owner.searchModule&&!_.isNullOrUndefined(e.documentHelper.owner.searchModule.searchHighlighters)){var n,r=e.documentHelper.owner.searchModule.searchHighlighters.containsKey(t);if(!r&&t.paragraph.isInHeaderFooter&&(n=e.documentHelper.owner.searchModule.searchHighlighters.keys,t=this.checkHeaderFooterLineWidget(t,n),_.isNullOrUndefined(t)||(r=!0)),r)for(var o=e.documentHelper.owner.searchModule.searchHighlighters.get(t),s=0;s<o.length;s++)this.pageContext.fillStyle=this.viewer.owner.documentEditorSettings.searchHighlightColor,this.pageContext.fillRect(this.getScaledValue(o[s].left,1),this.getScaledValue(i,2),this.getScaledValue(o[s].width),this.getScaledValue(t.height))}},i.prototype.renderSelectionHighlight=function(e,t,i){var n,r;!this.isPrinting&&e.documentHelper.owner.selectionModule&&!this.documentHelper.isScrollToSpellCheck&&0<e.documentHelper.owner.selectionModule.selectedWidgets.length&&(!(n=e.documentHelper.owner.selectionModule.selectedWidgets.containsKey(t))&&t.paragraph.isInHeaderFooter&&(r=e.documentHelper.owner.selectionModule.selectedWidgets.keys,t=this.checkHeaderFooterLineWidget(t,r),_.isNullOrUndefined(t)||(n=!0)),n)&&e.documentHelper.owner.selectionModule.addSelectionHighlight(this.selectionContext,t,i,e)},i.prototype.renderSelectionHighlightOnTable=function(e,t){var i,n;!this.isPrinting&&e.documentHelper.owner.selectionModule&&0<e.documentHelper.owner.selectionModule.selectedWidgets.length&&(!(i=e.documentHelper.owner.selectionModule.selectedWidgets.containsKey(t))&&t.ownerTable.isInHeaderFooter&&(n=e.documentHelper.owner.selectionModule.selectedWidgets.keys,t=this.checkHeaderFooterLineWidget(t,n),_.isNullOrUndefined(t)||(i=!0)),i)&&e.documentHelper.owner.selectionModule.addSelectionHighlightTable(this.selectionContext,t,e)},i.prototype.renderLine=function(e,t,i,n){this.renderSelectionHighlight(t,e,n);var r=e.paragraph.paragraphFormat,o=i;if(e.isFirstLine()&&!r.bidi&&(i+=j.convertPointToPixel(r.firstLineIndent)),this.documentHelper&&this.documentHelper.selection&&!_.isNullOrUndefined(this.documentHelper.selection.formFieldHighlighters)&&this.documentHelper.selection.formFieldHighlighters.containsKey(e)&&this.documentHelper.owner.documentEditorSettings&&this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading)for(var s=t.documentHelper.selection.formFieldHighlighters.get(e),a=0;a<s.length;a++){this.pageContext.fillStyle=this.documentHelper.owner.documentEditorSettings.formFieldSettings.shadingColor;var l,R,d=e.height,h=!1;e.isLastLine()&&(d-=j.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(e.paragraph)),1<e.paragraph.paragraphFormat.lineSpacing)&&(l=this.getFormfieldInLine(e),_.isNullOrUndefined(l)||(R=(l=this.documentHelper.textHelper.getHeight(l.characterFormat)).Height,"Multiple"===e.paragraph.paragraphFormat.lineSpacingType?d-=j.convertPointToPixel(this.documentHelper.layout.getLineSpacing(e.paragraph,R,!0)):(n+=j.convertPointToPixel(e.paragraph.paragraphFormat.beforeSpacing),d=l.Height,h=!0))),this.pageContext.fillRect(this.getScaledValue(s[a].left,1),this.getScaledValue(n,2),this.getScaledValue(s[a].width),this.getScaledValue(d)),h&&(h=!1,n-=j.convertPointToPixel(e.paragraph.paragraphFormat.beforeSpacing))}this.renderSearchHighlight(t,e,n),this.renderEditRegionHighlight(t,e,n),this.renderEditregionContentHighlight(t,e,n);var M=[],c=e.renderedElements,A=this.getUnderlineYPosition(e),p=[];!_.isNullOrUndefined(e.paragraph.associatedCell)&&e.paragraph.associatedCell.isRenderBookmarkStart&&e.paragraph.associatedCell.firstChild.firstChild==e&&p.push({x:i,y:n,height:e.height-e.margin.bottom,type:0});for(var u,g,m,f,y,a=0;a<c.length;a++){var v,w,b,x,C,I,k,D,F=c[a];if(!(F instanceof hc&&"Inline"!==F.textWrappingStyle)){if((F instanceof up||F instanceof Wc)&&(I=0,this.viewer instanceof Sd&&(I=this.viewer.pageGap),k="display:block;position:absolute;",I=this.getScaledValue(n+(t.boundingRectangle.y-I*(t.index+1)))+I*(t.index+1)+"px;",F instanceof Wc&&(this.documentHelper.owner.currentUser===F.user||"Everyone"===F.group&&""===F.user)?(this.documentHelper.owner.documentEditorSettings.highlightEditableRanges&&-1==F.columnFirst&&(T=F.line.height-F.line.margin.bottom,S=i,H=n,b=this.documentHelper.selection.editRegionHighlighters,s=_.isNullOrUndefined(b)?[]:b.get(e),x=_.isNullOrUndefined(s)||_.isNullOrUndefined(s[0])?"ffff00":s[0].color,this.renderBookmark(this.getScaledValue(S,1),this.getScaledValue(H,2),this.getScaledValue(e.height-e.margin.bottom),0,x)),this.documentHelper.owner.enableLockAndEdit?((v=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale)).setLocale(this.documentHelper.owner.locale),F.renderLockMark(this.documentHelper.owner.currentUser,v),w=this.documentHelper.owner.documentEditorSettings.collaborativeEditingSettings,k+="color:"+(x=F.user===this.documentHelper.owner.currentUser?w.editableRegionColor:w.lockedRegionColor)+";",w=j.convertPointToPixel(t.bodyWidgets[0].sectionFormat.leftMargin),w=t.boundingRectangle.x+this.getScaledValue(w-20)+"px;",this.viewer instanceof Wd&&(w=e.paragraph.x-5+"px;"),F.editRangeMark.setAttribute("style",k=k+"left:"+w+"top:"+I)):F.editRangeMark&&F.editRangeMark.setAttribute("style","display:none")):F instanceof up&&0===F.commentType&&this.documentHelper.owner.selectionModule&&(this.documentHelper.owner.enableComment?(C=j.convertPointToPixel(t.bodyWidgets[0].sectionFormat.rightMargin),P=j.convertPointToPixel(t.bodyWidgets[0].sectionFormat.pageWidth),w=t.boundingRectangle.x+this.getScaledValue(P-C+C/4)+"px;",k=k+"left:"+(w=this.viewer instanceof Wd?t.boundingRectangle.width-2*this.viewer.padding.right-2*this.viewer.padding.left+"px;":w)+"top:"+I,-1!==M.indexOf(F.commentId)||_.isNullOrUndefined(F.comment)||F.comment.isReply||(M.push(F.commentId),F.renderCommentMark(I,w),F.commentMark.setAttribute("style",k))):F.commentMark&&F.commentMark.setAttribute("style","display:none"))),F instanceof Sc&&(this.documentHelper.owner.currentUser===F.editRangeStart.user||"Everyone"===F.editRangeStart.group&&""===F.editRangeStart.user)&&-1==F.editRangeStart.columnFirst&&this.documentHelper.owner.documentEditorSettings.highlightEditableRanges&&(T=F.line.height-F.line.margin.bottom,S=i,H=n,b=this.documentHelper.selection.editRegionHighlighters,s=_.isNullOrUndefined(b)?[]:b.get(e),x=_.isNullOrUndefined(s)||_.isNullOrUndefined(s[0])?"ffff00":s[0].color,this.renderBookmark(this.getScaledValue(S,1),this.getScaledValue(H,2),this.getScaledValue(e.height-e.margin.bottom),1,x)),F instanceof J&&this.documentHelper.owner.documentEditorSettings.showBookmarks&&-1!==this.documentHelper.getBookmarks().indexOf(F.name)){var P,T=F.line.height-F.line.margin.bottom,S=i,H=n;if(1==F.bookmarkType){if(this.isBookmarkEndAtStart(F)&&_.isNullOrUndefined(F.properties)){for(var N=F.paragraph,W=void 0,O=!1;!O&&!_.isNullOrUndefined(N);){for(var U=0<=N.childWidgets.indexOf(F.line)?N.childWidgets.indexOf(F.line):N.childWidgets.length-1;0<=U;U--){for(var E=N.childWidgets[U],L=0<=E.children.indexOf(F)?E.children.indexOf(F):E.children.length-1;0<=L;L--)if(this.isRenderable(E.children[L])){W=E.children[L],O=!0;break}if(O)break}O||(N=this.documentHelper.selection.getPreviousParagraphBlock(N))}_.isNullOrUndefined(W)||(S+=this.documentHelper.selection.getWidth(W.line,!1)+this.documentHelper.textHelper.getParagraphMarkWidth(F.line.paragraph.characterFormat),H=this.documentHelper.selection.getTop(W.line))}_.isNullOrUndefined(F.properties)||(F.properties.isAfterParagraphMark&&(S+=this.documentHelper.textHelper.getParagraphMarkWidth(F.line.paragraph.characterFormat)),F.properties.isAfterCellMark&&(S+=this.documentHelper.textHelper.getWidth(String.fromCharCode(164),e.paragraph.characterFormat)))}1==F.bookmarkType?_.isNullOrUndefined(F.reference)||(_.isNullOrUndefined(F.reference.properties)?this.documentHelper.selection.isRenderBookmarkAtEnd(F)||p.push({x:S,y:H,height:T,type:F.bookmarkType}):(P=F.paragraph.associatedCell,_.isNullOrUndefined(P)&&p.push({x:S,y:H,height:T,type:F.bookmarkType}))):_.isNullOrUndefined(F.properties)&&p.push({x:S,y:H,height:T,type:F.bookmarkType})}F instanceof Z||this.isFieldCode||0===F.width&&0===F.height?(this.isFieldCode&&(F.width=0),i+=F.width+F.margin.left,this.toSkipFieldCode(F)):!this.isPrinting&&(this.getScaledValue(n+F.margin.top,2)+F.height*this.documentHelper.zoomFactor<0||this.getScaledValue(n+F.margin.top,2)>this.documentHelper.visibleBounds.height)&&(i+=F.width+F.margin.left,F instanceof X&&(this.documentHelper.owner.isSpellCheck&&(F.canTrigger=!0),F.isVisible=!1,F.isSpellChecked&&!F.line.paragraph.isChangeDetected||(F.ischangeDetected=!0)),!this.isExporting)||(F instanceof Y?this.renderListTextElementBox(F,i,n,A):F instanceof Ic?(i+=F.padding.left,this.renderImageElementBox(F,i,n,A)):F instanceof uc?(C=F.margin.left,I=F.margin.top,k=this.getScaledValue(i+C,1),D=this.getScaledValue(n+I,2),this.renderShapeElementBox(F,k,D,t)):(F.isVisible=!0,i+=F.padding.left,this.renderTextElementBox(F,i,n,A)),i+=F.width+F.margin.left,e.paragraph.bidi?o+=F.margin.left:o=i)}}if(this.documentHelper.owner.documentEditorSettings.showBookmarks&&0<p.length)for(a=0;a<p.length;a++){var B=p[a];this.renderBookmark(this.getScaledValue(B.x,1),this.getScaledValue(B.y,2),this.getScaledValue(B.height),B.type)}this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting&&(r="",u=e.paragraph.characterFormat,g=0,m=this.retriveCharacterformat(u),(v=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale)).setLocale(this.documentHelper.owner.locale),this.pageContext.fillStyle=j.getColor(u.fontColor),y=0,!e.paragraph.bodyWidget||e.paragraph.bodyWidget instanceof Xd||(y=this.documentHelper.pages.indexOf(e.paragraph.bodyWidget.page)),0==c.length&&!e.isEndsWithLineBreak&&!_.isNullOrUndefined(e.paragraph)||1===e.paragraph.childWidgets.length?(g=e.paragraph.y+this.documentHelper.textHelper.getHeight(u).BaselineOffset+this.documentHelper.layout.getBeforeSpacing(e.paragraph,y),!e.isEndsWithLineBreak&&0<e.indexInOwner&&0==c.length&&(g=n+e.previousLine.maxBaseLine)):g=n+e.maxBaseLine,0<u.revisions.length&&(x=this.documentHelper.authors.get(u.revisions[0].author),this.pageContext.fillStyle=j.getColor(x)),e.isEndsWithColumnBreak?(m=this.retriveCharacterformat(u,.7),r="....."+v.getConstant("Column Break")+"....."):e.isEndsWithPageBreak?(m=this.retriveCharacterformat(u,.7),r=e.paragraph.bidi?String.fromCharCode(182)+"....."+v.getConstant("Page Break")+".....":"....."+v.getConstant("Page Break")+"....."+String.fromCharCode(182),f=this.documentHelper.textHelper.getWidth(r,u,V.FontScriptType.English),this.viewer instanceof Sd?e.paragraph.bidi?o<f+this.viewer.clientActiveArea.x&&(r="....."):o>this.viewer.clientActiveArea.width&&(r="....."):e.paragraph.bidi?o-f<this.viewer.clientActiveArea.x&&(r="....."):o+f>this.viewer.clientActiveArea.width+this.viewer.clientActiveArea.x&&(r=".....")):e.isEndsWithLineBreak?r=e.paragraph.bidi?String.fromCharCode(8627):String.fromCharCode(8629):e.paragraph.isInsideTable&&_.isNullOrUndefined(e.nextLine)&&_.isNullOrUndefined(e.paragraph.nextWidget)?0!=e.height&&(r=String.fromCharCode(164)):_.isNullOrUndefined(e.nextLine)&&(r=String.fromCharCode(182)),e.paragraph.containerWidget instanceof z&&!_.isNullOrUndefined(e.paragraph.nextRenderedWidget)&&e.paragraph.containerWidget.sectionIndex!==e.paragraph.nextRenderedWidget.containerWidget.sectionIndex&&e.isLastLine()&&(r="NoBreak"===e.paragraph.nextRenderedWidget.containerWidget.sectionFormat.breakCode&&e.paragraph.containerWidget.index!==e.paragraph.nextRenderedWidget.containerWidget.index?":::::"+v.getConstant("Section Break Continuous")+":::::":":::::"+v.getConstant("Section Break Next Page")+":::::",m=this.retriveCharacterformat(u,.7),e.isEndsWithPageBreak&&(r=e.paragraph.bidi?r+String.fromCharCode(182)+"....."+v.getConstant("Page Break")+".....":"....."+v.getConstant("Page Break")+"....."+String.fromCharCode(182)+r),f=this.documentHelper.textHelper.getWidth(r,u,V.FontScriptType.English),this.viewer instanceof Sd?e.paragraph.bidi?o<f+this.viewer.clientActiveArea.x&&(r=":::::",e.isEndsWithPageBreak)&&(r=":::::....."):o+f-this.viewer.clientActiveArea.x>this.viewer.clientActiveArea.width&&(r=":::::",e.isEndsWithPageBreak)&&(r=".....:::::"):e.paragraph.bidi?o-f<this.viewer.clientActiveArea.x&&(r=":::::",e.isEndsWithPageBreak)&&(r=":::::....."):o+f-this.documentHelper.pages[0].boundingRectangle.x>this.viewer.clientActiveArea.width&&(r=":::::",e.isEndsWithPageBreak)&&(r=".....:::::")),0<r.length)&&(e.paragraph.bidi&&!e.paragraph.isEmpty()&&(o-=this.documentHelper.textHelper.getWidth(r,u,V.FontScriptType.English)),this.pageContext.font=m,y=u.scaling<100?1:u.scaling/100,this.pageContext.letterSpacing=u.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(y,1),this.pageContext.fillText(r,this.getScaledValue(o,1)/y,this.getScaledValue(g,2)),this.pageContext.restore())},i.prototype.isBookmarkEndAtStart=function(e){for(var t=e.paragraph,i=0,n=t.childWidgets[i],r=!0;-1==n.children.indexOf(e)&&(n=t.childWidgets[++i],i!=t.childWidgets.length););if(e.line!=n)return!1;for(var o=0<=n.children.indexOf(e)?n.children.indexOf(e):-1;0<=o;o--){var s=n.children[o];this.isRenderable(s)&&(r=!1)}return!!r},i.prototype.isRenderable=function(e){return!(e instanceof J||e instanceof Wc||e instanceof Sc)},i.prototype.combineHexColors=function(e,t){var e=e.replace("#",""),t=t.replace("#",""),i=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),e=parseInt(e.substring(4,6),16),r=parseInt(t.substring(0,2),16),o=parseInt(t.substring(2,4),16),t=parseInt(t.substring(4,6),16),i=Math.round(.35*i+.65*r),r=Math.round(.35*n+.65*o),n=Math.round(.35*e+.65*t);return"#"+i.toString(16)+r.toString(16)+n.toString(16)},i.prototype.renderBookmark=function(e,t,i,n,r){this.isPrinting||(this.pageContext.beginPath(),this.pageContext.lineWidth=1.5,0==n&&(this.pageContext.moveTo(e+3,t),this.pageContext.lineTo(e,t),this.pageContext.lineTo(e,t+i),this.pageContext.lineTo(e+3,t+i)),1==n&&(this.pageContext.moveTo(e-3,t),this.pageContext.lineTo(e,t),this.pageContext.lineTo(e,t+i),this.pageContext.lineTo(e-3,t+i)),this.pageContext.strokeStyle="#7F7F7F",this.pageContext.stroke(),this.pageContext.closePath(),_.isNullOrUndefined(r))||(n=this.combineHexColors(r,"#7F7F7F"),this.pageContext.fillStyle=n,this.pageContext.fillRect(e,t,1.5,i))},i.prototype.retriveCharacterformat=function(e,t){_.isNullOrUndefined(t)&&(t=1);this.pageContext.textBaseline="alphabetic";return(e.bold?"bold":"")+" "+(e.italic?"italic":"")+" "+(0===e.fontSize?.5:e.fontSize/("Normal"===e.baselineAlignment?1:1.5))*this.documentHelper.zoomFactor*t+'pt "'+e.fontFamily+'"'},i.prototype.toSkipFieldCode=function(e){e instanceof Z&&(0===e.fieldType?this.isFieldCode||_.isNullOrUndefined(e.fieldEnd)&&!e.hasFieldEnd||(this.fieldStacks.push(e),this.isFieldCode=!0):2!==e.fieldType&&1!==e.fieldType||0<this.fieldStacks.length&&e.fieldBegin===this.fieldStacks[this.fieldStacks.length-1]&&(this.fieldStacks.pop(),this.isFieldCode=!1))},i.prototype.getUnderlineYPosition=function(e){for(var t=0,i=0,n=0;n<e.children.length;n++)e.children[n]instanceof Z||0===e.children[n].width&&0===e.children[n].height||e.children[n]instanceof uc||t<e.children[n].height+e.children[n].margin.top&&(t=e.children[n].margin.top+e.children[n].height,i=e.children[n]instanceof Ic?.9:e.children[n].height/20);return t-2*i},i.prototype.renderListTextElementBox=function(e,t,i,n){var r=e.margin.top,o=e.margin.left,s=e.listLevel.characterFormat,a=e.line.paragraph.characterFormat,l=(s.hasValue("fontColor")?s:a).fontColor,d=(this.pageContext.textBaseline="alphabetic",(s.hasValue("fontFamily")?s:a).fontFamily),h=(!this.documentHelper.isIosDevice||e.text!==String.fromCharCode(9679)&&e.text!==String.fromCharCode(9675)||(d=""),(s.hasValue("fontSize")?s:a).fontSize),c=(s.hasValue("baselineAlignment")?s:a).baselineAlignment,p=s.hasValue("bold")?s.bold?"bold":"":a.bold?"bold":"",u=s.hasValue("italic")?s.italic?"italic":"":a.italic?"italic":"",h=0===h?.5:h/("Normal"===c?1:1.5),g=(h=this.isPrinting?h:h*this.documentHelper.zoomFactor,(s.hasValue("strikethrough")?s:a).strikethrough),a=(s.hasValue("highlightColor")?s:a).highlightColor,a=("NoColor"!==a&&("#"!==a.substring(0,1)?this.pageContext.fillStyle=j.getHighlightColorCode(a):this.pageContext.fillStyle=j.getColor(a),this.pageContext.fillRect(Math.floor(this.getScaledValue(t+o,1)),Math.floor(this.getScaledValue(i+r,2)-1),Math.ceil(this.getScaledValue(e.width)+1),Math.ceil(this.getScaledValue(e.height)+1))),this.pageContext.font=p+" "+u+" "+h+'pt "'+d+'"',"Subscript"===c&&(r+=e.height-e.height/1.5),e.baselineOffset),r="Normal"===s.baselineAlignment?r+a:r+a/1.5,p=e.text,u=e.paragraph.paragraphFormat.bidi,d=(u&&(this.pageContext.direction="rtl",t+=e.width),"empty"===l||"#00000000"===l?(h=this.getBackgroundColorHeirachy(e),this.pageContext.fillStyle=this.getDefaultFontColor(h)):this.pageContext.fillStyle=j.getColor(l),s.scaling<100?1:s.scaling/100);this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting?(e instanceof Y&&"\t"===e.text&&this.tabMark(e,s,t,i,o,r),this.pageContext.letterSpacing=s.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(d,1),this.pageContext.fillText(this.replaceSpace(p),this.getScaledValue(t+o,1)/d,this.getScaledValue(i+r,2),this.getScaledValue(e.width))):(this.pageContext.letterSpacing=s.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(d,1),this.pageContext.fillText(p,this.getScaledValue(t+o,1)/d,this.getScaledValue(i+r,2),this.getScaledValue(e.width))),this.pageContext.restore(),u&&(this.pageContext.direction="ltr",t-=e.width),"None"===s.underline||_.isNullOrUndefined(s.underline)||this.renderUnderline(e,t,i,n,l,s.underline,c),"None"!==g&&this.renderStrikeThrough(e,t,i,s.strikethrough,l,c)},i.prototype.getDefaultFontColor=function(e){return j.isVeryDark(e)?"#FFFFFF":"#000000"},i.prototype.renderTextElementBox=function(e,t,i,n){var r=!1,o=e.line.paragraph.containerWidget,s=(o instanceof N&&(r="Exactly"===o.ownerRow.rowFormat.heightType),e.margin.top),a=e.margin.left,l=(r&&o instanceof N&&(d=o.width+o.margin.left+o.margin.right-o.leftBorderWidth,this.clipRect(o.x-o.margin.left,o.y,this.getScaledValue(d),this.getScaledValue(o.height))),e.characterFormat),d=!0,h=("NoColor"!=l.highlightColor&&""==e.text.trim()&&(h=e.line.paragraph.firstChild,p=e.line.paragraph.lastChild,!_.isNullOrUndefined(h)&&h instanceof uh&&0<h.children.length&&e===h.children[0]&&(d=!1),!_.isNullOrUndefined(p))&&p instanceof uh&&0<p.children.length&&e===p.children[p.children.length-1]&&(d=!1),"NoColor"!==l.highlightColor&&d&&("#"!==l.highlightColor.substring(0,1)?this.pageContext.fillStyle=j.getHighlightColorCode(l.highlightColor):this.pageContext.fillStyle=j.getColor(l.highlightColor),this.pageContext.fillRect(Math.floor(this.getScaledValue(t+a,1)),Math.floor(this.getScaledValue(i+s,2)-1),Math.ceil(this.getScaledValue(e.width)+1),Math.ceil(this.getScaledValue(e.height)+1))),this.checkRevisionType(e)),c=0<h.length?this.getRevisionColor(h):l.fontColor,p=(this.pageContext.textBaseline="alphabetic",l.bold?"bold":""),d=l.italic?"italic":"",u=0===l.fontSize?.5:l.fontSize/("Normal"===l.baselineAlignment?1:1.5),g=(u=this.isPrinting?u:u*this.documentHelper.zoomFactor,this.documentHelper.textHelper.getFontNameToRender(e.scriptType,l)),p=(this.pageContext.font=p+" "+d+" "+u+'pt "'+g+'"',"Subscript"===l.baselineAlignment&&(s+=e.height-e.height/1.5),e.baselineOffset),s="Normal"===l.baselineAlignment?s+p:s+p/1.5,u=("empty"===c||"#00000000"===c?(d=this.getBackgroundColorHeirachy(e),this.pageContext.fillStyle=this.getDefaultFontColor(d)):this.pageContext.fillStyle=j.getColor(c),this.getScaledValue(e.width)),g=e.text,m=(e instanceof _h&&(""!==(p=e).tabText||_.isNullOrUndefined(p.tabLeader)||"None"===p.tabLeader?""!==p.tabText&&(g=p.tabText):(g=this.getTabLeader(e),p.tabText=g)),l.bidi||this.documentHelper.textHelper.isRTLText(e.text)),g=this.documentHelper.textHelper.setText(g,m,l.bdo,!0),d=(l.allCaps&&(g=g.toUpperCase()),e.characterRange),p=((d==V.CharacterRangeType.WordSplit||(d&V.CharacterRangeType.WordSplit)==V.CharacterRangeType.WordSplit&&(d&V.CharacterRangeType.RightToLeft)==V.CharacterRangeType.RightToLeft)&&l.bidi&&(g=this.inverseCharacter(g)),l.scaling<100?1:l.scaling/100);if(d!==V.CharacterRangeType.RightToLeft||j.startsWith(g," ")||(this.pageContext.direction="rtl",t+=e.width),this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting)(e instanceof _h||e instanceof X)&&"\t"===e.text&&this.tabMark(e,l,t,i,a,s),"\r"===g&&(g=String.fromCharCode(182)),this.pageContext.letterSpacing=l.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(p,1),this.pageContext.fillText(this.replaceSpace(g),this.getScaledValue(t+a,1)/p,this.getScaledValue(i+s,2),u);else if(this.pageContext.letterSpacing=l.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(p,1),e.paragraph.containerWidget.containerShape&&"Center"==e.paragraph.containerWidget.textVerticalAlignment){var f=e.paragraph.containerWidget.containerShape.height,y=this.getScaledValue(i+s,2)+this.getScaledValue(f)/4.5,v=0;if(e.paragraph.containerWidget.childWidgets&&0<e.paragraph.containerWidget.childWidgets.length)for(var w=0;w<e.paragraph.containerWidget.childWidgets.length;w++)v+=e.paragraph.containerWidget.childWidgets[w].height;v+this.getScaledValue(f)/2<this.getScaledValue(f)?this.pageContext.fillText(g,this.getScaledValue(t+a,1)/p,y,u):this.pageContext.fillText(g,this.getScaledValue(t+a,1)/p,this.getScaledValue(i+s,2),u)}else if(e.paragraph.containerWidget.containerShape&&"Bottom"==e.paragraph.containerWidget.textVerticalAlignment){f=e.paragraph.containerWidget.containerShape.height,y=this.getScaledValue(i+s,2)+this.getScaledValue(f)/2,v=0;if(e.paragraph.containerWidget.childWidgets&&0<e.paragraph.containerWidget.childWidgets.length)for(w=0;w<e.paragraph.containerWidget.childWidgets.length;w++)v+=e.paragraph.containerWidget.childWidgets[w].height;v+this.getScaledValue(f)/2<this.getScaledValue(f)?this.pageContext.fillText(g,this.getScaledValue(t+a,1)/p,y,u):this.pageContext.fillText(g,this.getScaledValue(t+a,1)/p,this.getScaledValue(i+s,2),u)}else this.pageContext.fillText(g,this.getScaledValue(t+a,1)/p,this.getScaledValue(i+s,2),u);if(this.pageContext.restore(),d!==V.CharacterRangeType.RightToLeft||j.startsWith(g," ")||(this.pageContext.direction="ltr",t-=e.width),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.isSpellCheck&&!this.spellChecker.removeUnderline&&(this.documentHelper.triggerSpellCheck||e.canTrigger)&&" "!==e.text&&!this.documentHelper.isScrollHandler&&(_.isNullOrUndefined(e.previousNode)||!(e.previousNode instanceof Z))){e.canTrigger=!0,this.leftPosition=this.pageLeft,this.topPosition=this.pageTop;var b=this.spellChecker.checktextElementHasErrors(e.text,e,t);if(b.errorFound&&!this.isPrinting)for(var c="#FF0000",x=(o instanceof N?o.cellFormat.shading:this.documentHelper).backgroundColor,C=this.spellChecker.errorWordCollection,w=0;w<b.elements.length;w++){var I=b.elements[w],k=this.spellChecker.manageSpecialCharacters(I.text,void 0,!0);-1===e.ignoreOnceItems.indexOf(k)&&(m?this.renderWavyLine(I,_.isNullOrUndefined(I.end)?t:I.end.location.x,i,n,c,"Single",l.baselineAlignment,x):this.renderWavyLine(I,_.isNullOrUndefined(I.start)?t:I.start.location.x,i,n,c,"Single",l.baselineAlignment,x),C.containsKey(k))&&-1===(k=C.get(k)).indexOf(I)&&k.push(I)}else(e.ischangeDetected||this.documentHelper.triggerElementsOnLoading)&&(e.ischangeDetected=!1,this.handleChangeDetectedElements(e,n,t,i,l.baselineAlignment))}f=this.getRevisionType(h,!0);("None"===l.underline||_.isNullOrUndefined(l.underline))&&(_.isNullOrUndefined(f)||"Insertion"!==f.type&&"MoveTo"!==f.type)||this.renderUnderline(e,t,i,n,c,l.underline,l.baselineAlignment,f),f=this.getRevisionType(h,!1),("None"===l.strikethrough||_.isNullOrUndefined(l.strikethrough))&&(_.isNullOrUndefined(f)||"Deletion"!==f.type&&"MoveFrom"!==f.type)||this.renderStrikeThrough(e,t,i,l.strikethrough,c,l.baselineAlignment,f),r&&this.pageContext.restore()},i.prototype.tabMark=function(e,t,i,n,r,o){var s=e.paragraph.bidi?String.fromCharCode(8592):String.fromCharCode(8594),a=this.documentHelper.textHelper.getWidth(s,t,e.scriptType),l=e.width/2,d=a/2,t=(this.pageContext.font=this.retriveCharacterformat(e.characterFormat),this.pageContext.letterSpacing=t.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),t.scaling<100?1:t.scaling/100);this.pageContext.scale(t,1),a<l?this.pageContext.fillText(s,this.getScaledValue(i+r+l-d,1)/t,this.getScaledValue(n+o,2)):this.pageContext.fillText(s,this.getScaledValue(i+r,1)/t,this.getScaledValue(n+o,2),this.getScaledValue(e.width)),this.pageContext.restore()},i.prototype.replaceSpace=function(e){return e=(e=e.replace(new RegExp(String.fromCharCode(32),"g"),String.fromCharCode(183))).replace(new RegExp(String.fromCharCode(160),"g"),String.fromCharCode(176))},i.prototype.inverseCharacter=function(e){switch(e){case String.fromCharCode(40):return String.fromCharCode(41);case String.fromCharCode(41):return String.fromCharCode(40);case String.fromCharCode(60):return String.fromCharCode(62);case String.fromCharCode(62):return String.fromCharCode(60);case String.fromCharCode(123):return String.fromCharCode(125);case String.fromCharCode(125):return String.fromCharCode(123);case String.fromCharCode(91):return String.fromCharCode(93);case String.fromCharCode(93):return String.fromCharCode(91);default:return e}},i.prototype.getBackgroundColorHeirachy=function(e){if(e.paragraph.isInsideTable){var t,i=e.paragraph.containerWidget;if("empty"!==(t=i.cellFormat.shading.backgroundColor)&&"#00000000"!==t)return t;if("empty"!==(t=i.ownerTable.tableFormat.shading.backgroundColor)&&"#00000000"!==t)return t}else if(e.paragraph.containerWidget instanceof fc&&!_.isNullOrUndefined(e.paragraph.containerWidget.containerShape)&&!_.isNullOrUndefined(e.paragraph.containerWidget.containerShape.fillFormat)&&"#000000FF"===e.paragraph.containerWidget.containerShape.fillFormat.color)return e.paragraph.containerWidget.containerShape.fillFormat.color;return this.documentHelper.backgroundColor},i.prototype.handleChangeDetectedElements=function(i,n,r,o,s){var a=this,e=i.text.trim(),l=this.pageIndex;if("\v"!==i.text&&!this.spellChecker.checkElementCanBeCombined(i,n,l,!0)){var t=e.split(/[\s]+/),d=i.line.getOffset(i,0);if(1<t.length)for(var h=0;h<t.length;h++){var c=t[h],p=this.spellChecker.manageSpecialCharacters(c,void 0,!0);-1===this.spellChecker.ignoreAllItems.indexOf(p)&&-1===i.ignoreOnceItems.indexOf(p)&&(this.handleUnorderedElements(p,i,n,h,d,h===t.length-1,l),d+=c.length+1)}else{var u,g,m,f,p=this.spellChecker.manageSpecialCharacters(e,void 0,!0);0<e.length&&-1===this.spellChecker.ignoreAllItems.indexOf(p)&&-1===i.ignoreOnceItems.indexOf(p)&&(u=i.indexInOwner,g=i.line.paragraph.indexInOwner,(m=this.spellChecker.checkSpellingInPageInfo(p)).isElementPresent&&this.spellChecker.enableOptimizedSpellCheck?(f=JSON.parse('{"HasSpellingError":'+m.hasSpellError+"}"),this.spellChecker.handleWordByWordSpellCheck(f,i,r,o,n,s,!0)):this.spellChecker.isInUniqueWords(p)?(m=!!this.spellChecker.isErrorWord(p),f=JSON.parse('{"HasSpellingError":'+m+"}"),this.spellChecker.handleWordByWordSpellCheck(f,i,r,o,n,s,!0)):this.documentHelper.owner.editorModule.triggerPageSpellCheck&&!this.documentHelper.triggerElementsOnLoading||this.spellChecker.callSpellChecker(this.spellChecker.languageID,e,!0,this.spellChecker.allowSpellCheckAndSuggestion).then(function(e){var t,e=JSON.parse(e);_.isNullOrUndefined(a.spellChecker)||(t=(l===a.pageIndex||i.isVisible)&&u===i.indexInOwner&&g===i.line.paragraph.indexInOwner,a.spellChecker.handleWordByWordSpellCheck(e,i,r,o,n,s,t))}))}}},i.prototype.handleUnorderedElements=function(t,i,n,r,o,s,e){var a,l,d,h=this,c=i.indexInOwner,p=i.line.paragraph.indexInOwner;0<t.length&&((l=this.spellChecker.checkSpellingInPageInfo(t)).isElementPresent&&this.spellChecker.enableOptimizedSpellCheck?(d=JSON.parse('{"HasSpellingError":'+l.hasSpellError+"}"),this.spellChecker.handleSplitWordSpellCheck(d,t,i,!0,n,r,o,s)):(a=i.isVisible&&c===i.indexInOwner&&p===i.line.paragraph.indexInOwner,this.spellChecker.isInUniqueWords(t)?(l=!!this.spellChecker.isErrorWord(t),d=JSON.parse('{"HasSpellingError":'+l+"}"),this.spellChecker.handleSplitWordSpellCheck(d,t,i,a,n,r,o,s)):this.documentHelper.owner.editorModule.triggerPageSpellCheck&&!this.documentHelper.triggerElementsOnLoading||this.spellChecker.callSpellChecker(this.spellChecker.languageID,t,!0,this.spellChecker.allowSpellCheckAndSuggestion).then(function(e){e=JSON.parse(e);_.isNullOrUndefined(h.spellChecker)||h.spellChecker.handleSplitWordSpellCheck(e,t,i,a,n,r,o,s)})))},i.prototype.renderWavyLine=function(e,t,i,n,r,o,s,a){var l,d,h,c;this.isPrinting||1<e.text.length&&(h=e.height/("Normal"===s?1:1.5),c=e.margin.top,d=h/20,l=0,"Subscript"===s||e instanceof Y?(l=h-2*d+i,l+=0<(c+=e.height-h)?c:0):l=n+i,s=this.spellChecker.getSpecialCharactersInfo(e),d=this.spellChecker.getWhiteSpaceCharacterInfo(e),h=(t+s.beginningWidth+(d.isBeginning?d.width:0)+e.margin.left)*this.documentHelper.zoomFactor+this.leftPosition,c=l*this.documentHelper.zoomFactor+this.topPosition,n=h+this.getScaledValue(e.width-(s.beginningWidth+s.endWidth)-d.width),i=new nl(h,c),t=new nl(n,c),this.drawWavy(i,t,.5*(n-h),1,.7,r,e.height,a))},i.prototype.drawWavy=function(e,t,i,n,r,o,s,a,l){this.pageContext.save(),this.pageContext.fillStyle=_.isNullOrUndefined(a)?this.documentHelper.backgroundColor:a,this.pageContext.fillRect(e.x,e.y-n,t.x-e.x,3*n),this.pageContext.restore(),this.pageContext.lineWidth=1,this.pageContext.lineCap="round",this.pageContext.strokeStyle=o,this.pageContext.beginPath();for(var d,h,a=e.x,o=e.y,c=t.x,t=t.y,p=0,u=Math.atan2(t-o,c-a),g=Math.sqrt((a-c)*(a-c)+(o-t)*(o-t)),m=+n,f=Math.PI*i;p<=g;p+=r)h=Math.sin(p/g*f)*m,d=e.x+Math.cos(u)*p+Math.cos(u-Math.PI/2)*h,h=e.y+Math.sin(u)*p+Math.sin(u-Math.PI/2)*h,0<p?this.pageContext.lineTo(d,h):this.pageContext.moveTo(d,h);this.pageContext.stroke(),this.pageContext.restore()},i.prototype.getTabLeader=function(e){var t=this.getTabLeaderString(e.tabLeader),i=t,n=this.documentHelper.textHelper.getWidth(i,e.characterFormat,e.scriptType),r=Math.floor(e.width/n);0==n&&(r=0);for(var o=0;o<=r;o++)i+=t;return i.slice(0,-1)},i.prototype.getTabLeaderString=function(e){var t="";switch(e){case"Dot":t=".";break;case"Hyphen":t="-";break;case"Underscore":case"Single":t="_"}return t},i.prototype.clipRect=function(e,t,i,n){this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.getScaledValue(e,1),this.getScaledValue(t,2),i,n),this.pageContext.clip()},i.prototype.getTrimmedWidth=function(e){var t=e.width;return t=e instanceof X&&!(e instanceof _h)&&_.isNullOrUndefined(e.nextNode)?this.documentHelper.textHelper.getWidth(j.trimEnd(e.text),e.characterFormat,e.scriptType):t},i.prototype.renderUnderline=function(e,t,i,n,r,o,s,a){var l=e.height/("Normal"===s?1:1.5),d=e.margin.top,h=l/20,c=0,p=l/20,u=("Subscript"===s||e instanceof Y?(c=l-2*h+i,c+=0<(d+=e.height-l)?d:0):c=n+i,0);for("Double"===(o=_.isNullOrUndefined(a)?o:"MoveTo"===a.type?"Double":"Single")&&(c-=p),e instanceof Ic&&(h=.9);u<("Double"===o?2:1);){u++;var g=this.getTrimmedWidth(e);this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(c,2),this.getScaledValue(g),this.getScaledValue(h)),c+=2*p}},i.prototype.renderStrikeThrough=function(e,t,i,n,r,o,s){var a=e.height/("Normal"===o?1:1.5),l=e.margin.top,d=("Subscript"===o&&(l+=e.height-a),i+=0<l?l:0,a/20),h=a/2+.5*d,c=0;for(_.isNullOrUndefined(s)||(n="Deletion"===s.type?"SingleStrike":"DoubleStrike"),e instanceof Ic&&(d=.9),"DoubleStrike"===n&&(h-=d);c<("DoubleStrike"===n?2:1);){c++;var p=this.getTrimmedWidth(e);this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(h+i,2),this.getScaledValue(p),this.getScaledValue(d)),h+=2*d}},i.prototype.renderImageElementBox=function(i,t,n,e){var r=this,o=i.margin.top,s=i.margin.left,a=this.checkRevisionType(i),l=0<a.length?this.getRevisionColor(a):"black",d=!(this.pageContext.textBaseline="top"),h=i.line.paragraph.containerWidget,c=!1;if(h instanceof N&&(c="Exactly"===h.ownerRow.rowFormat.heightType),"Inline"===i.textWrappingStyle&&(o<0||i.line.paragraph.width<i.width?h instanceof N&&(h.childWidgets[v=0]instanceof G&&(v=h.childWidgets[0].paragraphFormat.leftIndent),v=h.width+h.margin.left-h.leftBorderWidth-v,d=!0,this.clipRect(t+s,n+o,this.getScaledValue(v),this.getScaledValue(h.height))):c&&(v=h.width+h.margin.left-h.leftBorderWidth,d=!0,this.clipRect(h.x,h.y,this.getScaledValue(v),this.getScaledValue(h.height)))),i.isMetaFile&&!_.isNullOrUndefined(i.metaFileImageString))this.pageContext.drawImage(i.element,this.getScaledValue(t+s,1),this.getScaledValue(n+o,2),this.getScaledValue(i.width),this.getScaledValue(i.height));else{var p="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC";try{var u=this.getScaledValue(t+s,1),g=this.getScaledValue(n+o,2),m=this.getScaledValue(i.width),f=this.getScaledValue(i.height),y=this;i.element.onload=function(){var e=i.element.getAttribute("lastLoaded");_.isNullOrUndefined(y.documentHelper)||e===i.element.src||(i.isCrop?y.pageContext.drawImage(i.element,i.cropX,i.cropY,i.cropWidth,i.cropHeight,u,g,m,f):y.pageContext.drawImage(i.element,u,g,m,f))},i.element.onerror=function(){var e=p,t=r.documentHelper.getImageString(i);t&&(j.startsWith(t,"http://")||j.startsWith(t,"https://"))&&(t=r.viewer.documentHelper.images.get(parseInt(i.imageString)))&&1<t.length&&(e=t[1]),i.element.src=e},i.isCrop?this.pageContext.drawImage(i.element,i.cropX,i.cropY,i.cropWidth,i.cropHeight,u,g,m,f):this.pageContext.drawImage(i.element,u,g,m,f)}catch(e){c=this.documentHelper.getImageString(i);c&&(j.startsWith(c,"http://")||j.startsWith(c,"https://"))?(v=this.viewer.documentHelper.images.get(parseInt(i.imageString)))&&1<v.length?i.element.src=v[1]:i.element.src=p:(i.imageString=p,this.documentHelper.addBase64StringInCollection(i),i.element.src=this.documentHelper.getImageString(i)),this.pageContext.drawImage(i.element,this.getScaledValue(t+s,1),this.getScaledValue(n+o,2),this.getScaledValue(i.width),this.getScaledValue(i.height))}}this.pageContext.fillStyle=j.getColor(l);var v,h=this.getRevisionType(a,!1);_.isNullOrUndefined(h)||"Deletion"!==h.type&&"MoveFrom"!==h.type||this.renderStrikeThrough(i,t,n,"SingleStrike",l,"Normal",h),h=this.getRevisionType(a,!0),_.isNullOrUndefined(h)||"Insertion"!==h.type&&"MoveTo"!==h.type||(c=this.getUnderlineYPosition(i.line),this.renderUnderline(i,t,n,c,l,"Single","Normal")),this.documentHelper.owner.picturePositionY=this.getScaledValue(n+o,2),!_.isNullOrUndefined(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked()&&this.documentHelper.selection.start.currentWidget===i.line&&(v=this.documentHelper.owner.getImageContentControl(),_.isNullOrUndefined(v)||"Picture"!=v.contentControlProperties.type||(s=i.characterFormat,v.contentControlProperties.color,this.renderImgBorder(i,t,n,"black","Solid",.5,s.baselineAlignment))),d&&this.pageContext.restore()},i.prototype.renderTableOutline=function(e){var t=new Ml(this.documentHelper),i=e,n=(e.width=this.documentHelper.layout.getTableWidth(i),i.isBidiTable?t.getTableRightBorder(i.tableFormat.borders):t.getTableLeftBorder(i.tableFormat.borders)),r=j.convertPointToPixel(n.getLineWidth());this.renderSingleBorder(n.color,e.x-e.margin.left-r/2,e.y,e.x-e.margin.left-r/2,e.y+e.height,r,n.lineStyle),n=t.getTableTopBorder(i.tableFormat.borders),r=j.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x-e.margin.left-r,e.y-r/2,e.x+e.width+r+e.margin.right,e.y-r/2,r,n.lineStyle),n=i.isBidiTable?t.getTableLeftBorder(i.tableFormat.borders):t.getTableRightBorder(i.tableFormat.borders),r=j.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x+e.width+e.margin.right+r/2,e.y,e.x+e.width+e.margin.right+r/2,e.y+e.height,r,n.lineStyle),n=t.getTableBottomBorder(i.tableFormat.borders),r=j.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x-e.margin.left-r,e.y+e.height-r/2,e.x+e.width+r+e.margin.right,e.y+e.height-r/2,r,n.lineStyle)},i.prototype.renderTableCellOutline=function(e,t){var e=e.layout,i=t,n=0,r=0,o=0,s=0,a=0,l=t.ownerTable.isBidiTable,s=(i.cellFormat.borders,t.containerWidget instanceof dh&&(r=t.margin.bottom-t.containerWidget.bottomBorderWidth,n=t.margin.top-t.containerWidget.topBorderWidth),o=t.margin.left-t.leftBorderWidth,t.margin.right-t.rightBorderWidth),a=_.isNullOrUndefined(i.ownerRow)||"Exactly"!==i.ownerRow.rowFormat.heightType?!_.isNullOrUndefined(i.ownerRow)&&[i.ownerRow].length<=1?Math.max(j.convertPointToPixel(i.ownerRow.rowFormat.height),t.height)+n+r:t.height+n+r:j.convertPointToPixel(i.ownerRow.rowFormat.height)+n+r,d=l?N.getCellRightBorder(i):N.getCellLeftBorder(i),h=0,a=(h=j.convertPointToPixel(d.getLineWidth()),this.renderCellBackground(a,t,o,s,h),h);if(0===i.index||1===i.cellFormat.rowSpan||1<i.cellFormat.rowSpan&&0===i.columnIndex)this.renderSingleBorder(d.color,t.x-o-h,t.y-t.margin.top,t.x-o-h,t.y+t.height+r,h,d.lineStyle);else for(var c=0;c<i.ownerTable.childWidgets.length;c++){for(var p=i.ownerTable.childWidgets[c],u=void 0,g=0;g<p.childWidgets.length;g++){var m=p.childWidgets[g];if(m.columnIndex+m.cellFormat.columnSpan-1==i.columnIndex-1){u=m;break}if(p.childWidgets[g].columnIndex>=i.columnIndex&&p.childWidgets[g].previousWidget){u=p.childWidgets[g].previousWidget;break}}if(u&&u.columnIndex+u.cellFormat.columnSpan-1==i.columnIndex-1){var f=l?N.getCellLeftBorder(u):N.getCellRightBorder(u),y=j.convertPointToPixel(f.getLineWidth()),o=i.margin.left-y;if(!(u.y+u.height<i.y))if(u.y<i.y&&u.y+u.height>i.y)this.renderSingleBorder(f.color,i.x-o-y,i.y-n,i.x-o-y,u.y+u.height+u.margin.bottom,y,f.lineStyle);else if(u.y===i.y||u.y>i.y&&u.y+u.height<i.y+i.height)this.renderSingleBorder(f.color,i.x-o-y,u.y-u.margin.top,i.x-o-y,u.y+u.height+u.margin.bottom,y,f.lineStyle);else if(u.y<i.y+i.height&&u.y+u.height>=i.y+i.height)this.renderSingleBorder(f.color,i.x-o-y,u.y-u.margin.top,i.x-o-y,u.y+u.height+r,y,f.lineStyle);else if(u.y>i.y+i.height)break}}if(i.updatedTopBorders&&1<i.updatedTopBorders.length)for(var v=t.x-t.margin.left-a/2,w=t.y-t.margin.top,b=0;b<i.updatedTopBorders.length;b++){var x=i.updatedTopBorders[b];"None"!==(d=x.border).lineStyle&&d.lineWidth<N.getCellTopBorder(i).lineWidth&&(d.lineWidth=N.getCellTopBorder(i).lineWidth),_.isNullOrUndefined(d)||(h=j.convertPointToPixel(d.getLineWidth()),this.renderSingleBorder(d.color,v,w+h/2,v+x.width,w+h/2,h,d.lineStyle),v+=x.width)}else{d=N.getCellTopBorder(i);h=j.convertPointToPixel(d.getLineWidth());this.renderSingleBorder(d.color,t.x-t.margin.left-a/2,t.y-t.margin.top+h/2,t.x+t.width+t.margin.right+0,t.y-t.margin.top+h/2,h,d.lineStyle)}for(var C=!1,C=l?0===i.columnIndex:i.cellIndex===i.ownerRow.childWidgets.length-1,I=i.containerWidget.getPreviousRowSpannedCells(),k=!1,F=0;F<I.length;F++){var P=I[F];if(i.rowIndex<P.rowIndex+P.cellFormat.rowSpan&&i.columnIndex<P.columnIndex){k=!0;break}}!(0<i.ownerTable.tableFormat.cellSpacing||C)||!l&&i.columnIndex+i.cellFormat.columnSpan!==i.ownerTable.tableHolder.columns.length&&k||(d=l?N.getCellLeftBorder(i):N.getCellRightBorder(i),h=j.convertPointToPixel(d.getLineWidth()),this.renderSingleBorder(d.color,t.x+t.width+t.margin.right-h/2,t.y-t.margin.top,t.x+t.width+t.margin.right-h/2,t.y+t.height+r,h,d.lineStyle));var T,C=i.ownerRow.nextWidget,S=!1,H=void 0;_.isNullOrUndefined(C)||(T=void(C.lastChild&&(H=(T=C.lastChild).columnIndex+T.cellFormat.columnSpan)),(T=C)instanceof dh&&t.containerWidget instanceof dh&&t.containerWidget.containerWidget instanceof K&&(S=-1!==t.containerWidget.containerWidget.childWidgets.indexOf(T))),(0<i.ownerTable.tableFormat.cellSpacing||i.ownerRow.rowIndex===i.ownerTable.childWidgets.length-1||1<i.cellFormat.rowSpan&&i.ownerRow.rowIndex+i.cellFormat.rowSpan>=i.ownerTable.childWidgets.length||!S||this.isRenderHeader||H&&C.childWidgets.length<i.ownerRow.childWidgets.length&&H<i.columnIndex+i.cellFormat.columnSpan||!_.isNullOrUndefined(i.cellFormat.borders.bottom)&&"Cleared"!==i.cellFormat.borders.bottom.lineStyle&&1===i.cellFormat.rowSpan&&!l&&(!_.isNullOrUndefined(C)&&t.x<C.firstChild.x-C.firstChild.margin.left&&0<C.rowFormat.gridBefore&&(0!==C.rowFormat.beforeWidth||0!==C.rowFormat.gridBeforeWidth)||!_.isNullOrUndefined(C)&&t.x+t.width>C.lastChild.x+C.lastChild.width+C.lastChild.margin.right&&0<C.rowFormat.gridAfter&&(0!==C.rowFormat.afterWidth||0!==C.rowFormat.gridAfterWidth)))&&(T=i.cellFormat.borders.bottom,d=(_.isNullOrUndefined(T)||"Cleared"!==T.lineStyle)&&1<i.cellFormat.rowSpan&&i.ownerRow.rowIndex+i.cellFormat.rowSpan===i.ownerTable.childWidgets.length?i.getBorderBasedOnPriority(i.getBorderBasedOnPriority(i.cellFormat.borders.bottom,i.ownerRow.rowFormat.borders.bottom),i.ownerTable.tableFormat.borders.bottom):N.getCellBottomBorder(i),S=t.x-t.margin.left-a/2,T=t.x+t.width+t.margin.right,!(H&&C.childWidgets.length<i.ownerRow.childWidgets.length&&H<i.columnIndex+i.cellFormat.columnSpan||_.isNullOrUndefined(C)||l||!(0<C.rowFormat.gridAfter)||0===C.rowFormat.afterWidth&&0===C.rowFormat.gridAfterWidth||_.isNullOrUndefined(C.lastChild)||_.isNullOrUndefined(N.getCellTopBorder(C.lastChild))||"None"===N.getCellTopBorder(C.lastChild).lineStyle)&&t.x<C.lastChild.x+C.lastChild.width+C.lastChild.margin.right&&(S=C.lastChild.x+C.lastChild.width+C.lastChild.margin.right),!(H&&C.childWidgets.length<i.ownerRow.childWidgets.length&&H<i.columnIndex+i.cellFormat.columnSpan||_.isNullOrUndefined(C)||l||!(0<C.rowFormat.gridBefore)||0===C.rowFormat.beforeWidth&&0===C.rowFormat.gridBeforeWidth||_.isNullOrUndefined(C.firstChild)||_.isNullOrUndefined(N.getCellTopBorder(C.firstChild))||"None"===N.getCellTopBorder(C.firstChild).lineStyle)&&t.x+t.width>C.firstChild.x-C.firstChild.margin.left&&(T=C.firstChild.x-C.firstChild.margin.left),h=j.convertPointToPixel(d.getLineWidth()),this.renderSingleBorder(d.color,S,t.y+t.height+r+h/2,T,t.y+t.height+r+h/2,h,d.lineStyle)),d=e.getCellDiagonalUpBorder(i),0<(h=j.convertPointToPixel(d.getLineWidth()))&&this.renderSingleBorder(d.color,t.x-o,t.y+t.height+r,t.x+t.width+s,t.y-n,h,d.lineStyle),d=e.getCellDiagonalDownBorder(i),0<(h=j.convertPointToPixel(d.getLineWidth()))&&this.renderSingleBorder(d.color,t.x-o,t.y-n,t.x+t.width+s,t.y+t.height+r,h,d.lineStyle)},i.prototype.renderCellBackground=function(e,t,i,n,r){var o=t.cellFormat,s=("#ffffff"===o.shading.backgroundColor?t.ownerTable.tableFormat:o).shading.backgroundColor,a=t.x-i-r,l=t.margin.top-t.containerWidget.topBorderWidth,l=t.y-l,i=t.width+i+n+r/2;0<t.ownerRow.rowFormat.revisions.length&&(s="Insertion"===t.ownerRow.rowFormat.revisions[t.ownerRow.rowFormat.revisions.length-1].revisionType?"#e1f2fa":"#fce6f4"),this.pageContext.beginPath(),"empty"!==s&&(this.pageContext.fillStyle=j.getColor(s),this.pageContext.fillRect(this.getScaledValue(a,1),this.getScaledValue(l,2),this.getScaledValue(i),this.getScaledValue(e)),this.pageContext.closePath()),o.shading.hasValue("foregroundColor")&&"TextureNone"!==o.shading.textureStyle&&(this.pageContext.beginPath(),this.pageContext.fillStyle=this.drawTextureStyle(o.shading.textureStyle,j.getColor(o.shading.foregroundColor),j.getColor(o.shading.backgroundColor),"empty"===o.shading.foregroundColor,"empty"===o.shading.backgroundColor),this.pageContext.fillRect(this.getScaledValue(a,1),this.getScaledValue(l,2),this.getScaledValue(i),this.getScaledValue(e)),this.pageContext.closePath())},i.prototype.drawTextureStyle=function(e,t,i,n,r){var o;return r&&(i="#ffffff"),n&&(t="#000000"),-1<e.indexOf("Percent")?(o=e.replace("Texture","").replace("Percent","").replace("Pt","."),o=parseInt(o),this.getForeColor(t,i,o,n,r)):"TextureSolid"===e?t:"#FFFFFF"},i.prototype.getForeColor=function(e,t,i,n,r){var e=j.convertHexToRgb(e),t=j.convertHexToRgb(t),o=this.getColorValue(e.r,t.r,i,n,r),s=this.getColorValue(e.g,t.g,i,n,r),e=this.getColorValue(e.b,t.b,i,n,r);return"#"+j.convertRgbToHex(o)+j.convertRgbToHex(s)+j.convertRgbToHex(e)},i.prototype.getColorValue=function(e,t,i,n,r){return 100==i?e:n?r?Math.round(255*(1-i/100)):Math.round(t*(1-i/100)):r?Math.round(e*(i/100)):t+Math.round(e*(i/100))-Math.round(t*(i/100))},i.prototype.renderSingleBorder=function(e,t,i,n,r,o,s){this.pageContext.beginPath(),this.pageContext.moveTo(this.getScaledValue(t,1),this.getScaledValue(i,2)),this.pageContext.lineTo(this.getScaledValue(n,1),this.getScaledValue(r,2)),this.pageContext.lineWidth=this.getScaledValue(o),this.pageContext.strokeStyle=j.getColor(e),"None"!==s&&"Cleared"!==s&&this.pageContext.stroke(),this.pageContext.closePath()},i.prototype.getScaledValue=function(e,t){return this.isPrinting?e:(_.isNullOrUndefined(t)&&(t=0),e*this.documentHelper.zoomFactor+(1===t?this.pageLeft:2===t?this.pageTop:0))},i.prototype.checkRevisionType=function(e){for(var t=[],i=e.revisions.length,n=0;n<i;n++){var r=e.revisions[n],o=this.documentHelper.authors.get(r.author);t.push({type:r.revisionType,color:o})}return t},i.prototype.getRevisionColor=function(e){if(1===e.length)return e[0].color;for(var t=0;t<e.length;t++)if("Deletion"===e[t].type||"MoveFrom"===e[t].type)return e[t].color;return 0<e.length?e[0].color:void 0},i.prototype.getRevisionType=function(e,t){if(0!==e.length)for(var i=0;i<e.length;i++){var n=void 0;if(t&&("Insertion"===e[i].type||"MoveTo"===e[i].type))return n=e[i],this.pageContext.fillStyle=j.getColor(n.color),e.splice(i,1),n;if(!t&&("Deletion"===e[i].type||"MoveFrom"===e[i].type))return n=e[i],this.pageContext.fillStyle=j.getColor(n.color),e.splice(i,1),n}},i.prototype.getFormfieldInLine=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t]instanceof Z&&!_.isNullOrUndefined(e.children[t].formFieldData))return e.children[t]},i.prototype.destroy=function(){this.documentHelper=void 0,_.isNullOrUndefined(this.pageCanvasIn)||(this.pageCanvasIn.innerHTML=""),this.pageCanvasIn=void 0},i);function i(e){this.commentMarkDictionary=new T,this.isPrinting=!1,this.isExporting=!1,this.pageLeft=0,this.pageTop=0,this.pageIndex=-1,this.isFieldCode=!1,this.isRenderHeader=!1,this.leftPosition=0,this.topPosition=0,this.height=0,this.fieldStacks=[],this.documentHelper=e}Jl.prototype.setZoomFactor=function(){this.onZoomFactorChanged(),_.isNullOrUndefined(this.documentHelper.selection)||this.documentHelper.selection.updateCaretPosition(),this.documentHelper.updateTouchMarkPosition(),_.isNullOrUndefined(this.documentHelper.owner.imageResizerModule)||this.documentHelper.owner.imageResizerModule.updateImageResizerPosition(),this.documentHelper.owner.fireZoomFactorChange()},Object.defineProperty(Jl.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Jl.prototype.onZoomFactorChanged=function(){5<this.documentHelper.zoomFactor?this.documentHelper.zoomFactor=5:this.documentHelper.zoomFactor<.1&&(this.documentHelper.zoomFactor=.1),this.zoom()},Jl.prototype.zoom=function(){var e=this.viewer;this.documentHelper.clearContent(),e.handleZoom(),this.documentHelper.updateFocus()},Jl.prototype.destroy=function(){this.documentHelper=void 0};var Xl=Jl;function Jl(e){var i=this;this.onMouseWheelInternal=function(e){var t;!0===e.ctrlKey&&(e.preventDefault(),e.pageX-i.documentHelper.viewerContainer.offsetLeft<i.documentHelper.pageContainer.offsetWidth)&&(t=(t=(t=void 0)!==navigator?navigator.userAgent.match("Firefox"):t)?e.detail<0:_.Browser.isIE?0<e.wheelDelta:e.deltaY<0,e=i.documentHelper.zoomFactor,t?e<=4.9?e+=.1:e=5:.2<=e?e-=.1:e=.1,i.documentHelper.zoomFactor=e)},this.documentHelper=e}Ql.prototype.initUserDialog=function(e,t){this.target=_.createElement("div",{className:"e-de-user-dlg"});var i=e.getConstant("Enter User"),i=_.createElement("div",{innerHTML:i,className:"e-bookmark-dlgfields"}),i=(this.target.appendChild(i),_.createElement("div",{className:"e-de-user-dlg-common"})),n=(this.target.appendChild(i),_.createElement("div",{className:"e-de-user-dlg-list"})),t=(i.appendChild(n),t&&n.classList.add("e-de-rtl"),this.textBoxInput=_.createElement("input",{className:"e-input e-de-user-dlg-textbox-input",attrs:{autofocus:"true"}}),this.textBoxInput.setAttribute("type","text"),n.appendChild(this.textBoxInput),this.textBoxInput.addEventListener("keyup",this.onKeyUpOnDisplayBox),_.createElement("button",{innerHTML:e.getConstant("Add"),attrs:{type:"button"}})),n=(n.appendChild(t),t.addEventListener("click",this.addButtonClick),this.addButton=new H.Button({cssClass:"e-de-user-add-btn"}),this.addButton.disabled=!0,this.addButton.appendTo(t),this.addButton.addEventListener("click",this.addButtonClick),_.createElement("div")),t=(i.appendChild(n),_.createElement("div",{innerHTML:e.getConstant("Users"),className:"e-de-user-dlg-user"})),i=(n.appendChild(t),_.createElement("div"));n.appendChild(i),this.userList=new F.ListView({cssClass:"e-de-user-listview"}),this.userList.appendTo(i)},Ql.prototype.bindListData=function(e){-1===this.documentHelper.userCollection.indexOf(e)&&this.documentHelper.userCollection.push(e),this.userList&&(this.userList.dataSource=this.documentHelper.userCollection.slice(),this.userList.dataBind())},Ql.prototype.validateUserName=function(e){var t;return-1!==e.indexOf("@")&&-1!==(e=e.split("@")[1]).indexOf(".")&&(t=(e=e.split("."))[1],!(2<e.length||4<t.length||t.length<2))},Ql.prototype.destroy=function(){this.textBoxInput&&(this.textBoxInput=void 0),this.addButton&&(this.addButton.destroy(),this.addButton=void 0),this.userList&&(this.userList.destroy(),this.userList=void 0),this.documentHelper=void 0};var Yl=Ql;function Ql(e){var t=this;this.show=function(){var e=new _.L10n("documenteditor",t.documentHelper.owner.defaultLocale);e.setLocale(t.documentHelper.owner.locale),t.target||t.initUserDialog(e,t.documentHelper.owner.enableRtl),t.documentHelper.dialog.header=e.getConstant("Add Users"),t.documentHelper.dialog.height="auto",t.documentHelper.dialog.width="auto",t.documentHelper.dialog.content=t.target,t.documentHelper.dialog.beforeOpen=t.loadUserDetails,t.documentHelper.dialog.close=t.documentHelper.updateFocus,t.documentHelper.dialog.buttons=[{click:t.okButtonClick,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat",isPrimary:!0}},{click:t.hideDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat"}},{click:t.deleteButtonClick,buttonModel:{content:e.getConstant("Delete"),cssClass:"e-flat e-user-delete"}}],t.documentHelper.dialog.dataBind(),t.documentHelper.dialog.show()},this.loadUserDetails=function(){t.userList.dataSource=t.documentHelper.userCollection.slice(),t.userList.dataBind(),t.documentHelper.restrictEditingPane.addedUser.dataSource=t.documentHelper.userCollection.slice(),t.documentHelper.restrictEditingPane.addedUser.dataBind()},this.okButtonClick=function(){t.documentHelper.restrictEditingPane.isAddUser=!0,t.documentHelper.restrictEditingPane.showStopProtectionPane(!1),t.documentHelper.restrictEditingPane.addUserCollection(),t.documentHelper.restrictEditingPane.isAddUser=!1,t.documentHelper.dialog.hide()},this.hideDialog=function(){t.textBoxInput.value="",t.documentHelper.dialog.hide()},this.onKeyUpOnDisplayBox=function(){t.addButton.disabled=""===t.textBoxInput.value},this.addButtonClick=function(){t.validateUserName(t.textBoxInput.value)?(t.bindListData(t.textBoxInput.value),t.textBoxInput.value=""):C.DialogUtility.alert("Invalid user name")},this.deleteButtonClick=function(){var e=t.documentHelper.userCollection.indexOf(t.userList.getSelectedItems().text);-1<e&&(t.documentHelper.userCollection.splice(e,1),t.userList.dataSource=t.documentHelper.userCollection.slice(),t.userList.dataBind())},this.documentHelper=e}Object.defineProperty(ed.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),ed.prototype.initDialog=function(e){this.target=_.createElement("div",{className:"e-de-enforce"});var t=_.createElement("div",{className:"e-de-container-row"}),i=(this.passwordTextBox=_.createElement("input",{attrs:{type:"password",autofocus:"true"},className:"e-input"}),t.appendChild(this.passwordTextBox),_.createElement("div"));this.confirmPasswordTextBox=_.createElement("input",{attrs:{type:"password"},className:"e-input"}),i.appendChild(this.confirmPasswordTextBox),this.target.appendChild(t),this.target.appendChild(i),new D.TextBox({placeholder:e.getConstant("Enter new password"),floatLabelType:"Always",cssClass:"e-de-enforce-dlg-input"},this.passwordTextBox),new D.TextBox({placeholder:e.getConstant("Reenter new password to confirm"),floatLabelType:"Always"},this.confirmPasswordTextBox)},ed.prototype.destroy=function(){this.documentHelper=void 0,this.owner=void 0};var $l=ed;function ed(e,t){var i=this;this.show=function(){i.localeValue=new _.L10n("documenteditor",i.viewer.owner.defaultLocale),i.localeValue.setLocale(i.viewer.owner.locale),i.target||i.initDialog(i.localeValue),i.documentHelper.dialog.header=i.localeValue.getConstant("Start Enforcing Protection"),i.documentHelper.dialog.height="auto",i.documentHelper.dialog.content=i.target,i.documentHelper.dialog.width="auto",i.documentHelper.dialog.buttons=[{click:i.okButtonClick,buttonModel:{content:i.localeValue.getConstant("Ok"),cssClass:"e-flat",isPrimary:!0}},{click:i.hideDialog,buttonModel:{content:i.localeValue.getConstant("Cancel"),cssClass:"e-flat"}}],i.passwordTextBox.value="",i.confirmPasswordTextBox.value="",i.documentHelper.dialog.show()},this.hideDialog=function(){i.passwordTextBox.value="",i.confirmPasswordTextBox.value="",i.documentHelper.dialog.hide()},this.okButtonClick=function(){i.passwordTextBox.value!==i.confirmPasswordTextBox.value?C.DialogUtility.alert(i.localeValue.getConstant("Password Mismatch")):(i.password=_.SanitizeHtmlHelper.sanitize(i.passwordTextBox.value),i.viewer.owner.editorModule.addProtection(i.password,i.owner.protectionType))},this.documentHelper=e,this.owner=t}Object.defineProperty(id.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),id.prototype.initDialog=function(e){var t=this.viewer.owner.containerId+"_enforce_protection",t=(this.target=_.createElement("div",{id:t,className:"e-de-enforce"}),_.createElement("div")),e=_.createElement("div",{className:"e-de-unprotect-dlg-title",innerHTML:e.getConstant("Password")});this.passwordTextBox=_.createElement("input",{attrs:{type:"password"},id:this.viewer.owner.containerId+"_display_text",className:"e-input e-de-enforce-dlg-input"}),t.appendChild(e),t.appendChild(this.passwordTextBox),this.target.appendChild(t)},id.prototype.destroy=function(){this.documentHelper=void 0,this.owner=void 0};var td=id;function id(e,t){var i=this;this.show=function(){i.localObj=new _.L10n("documenteditor",i.viewer.owner.defaultLocale),i.localObj.setLocale(i.viewer.owner.locale),i.target||i.initDialog(i.localObj),i.documentHelper.dialog.header="Unprotect Document",i.documentHelper.dialog.height="auto",i.documentHelper.dialog.width="auto",i.documentHelper.dialog.content=i.target,i.documentHelper.dialog.buttons=[{click:i.okButtonClick,buttonModel:{content:i.localObj.getConstant("Ok"),cssClass:"e-flat",isPrimary:!0}},{click:i.hideDialog,buttonModel:{content:i.localObj.getConstant("Cancel"),cssClass:"e-flat"}}],i.documentHelper.dialog.dataBind(),i.passwordTextBox.value="",i.documentHelper.dialog.show()},this.okButtonClick=function(){var e=i.passwordTextBox.value;e.length==="".length&&""===e?C.DialogUtility.alert(i.localObj.getConstant("The password is incorrect")):i.viewer.owner.editorModule.stopProtection(e)},this.hideDialog=function(){i.passwordTextBox.value="",i.documentHelper.dialog.hide()},this.documentHelper=e,this.owner=t}Object.defineProperty(rd.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),rd.prototype.showHideRestrictPane=function(e){this.restrictPane||(this.localObj=new _.L10n("documenteditor",this.viewer.owner.defaultLocale),this.localObj.setLocale(this.viewer.owner.locale),this.initPane(this.localObj,this.documentHelper.owner.enableRtl)),e?(this.restrictPane.style.display="block",this.isShowRestrictPane=!0,this.documentHelper.selection.isHighlightEditRegion=!0,this.wireEvents(),this.documentHelper.updateViewerSize(),this.loadPaneValue(),this.addUserCollection()):(this.closePane(),this.documentHelper.updateFocus()),this.documentHelper.owner.triggerResize()},rd.prototype.initPane=function(e,t){this.restrictPane=_.createElement("div",{className:"e-de-restrict-pane"}),t&&this.restrictPane.classList.add("e-rtl");var t=_.createElement("div",{className:"e-de-rp-whole-header"}),i=_.createElement("div",{innerHTML:e.getConstant("Restrict Editing"),className:"e-de-rp-header"}),i=(this.closeButton=_.createElement("button",{className:"e-de-rp-close-icon e-de-close-icon e-btn e-flat e-icon-btn",attrs:{type:"button"}}),this.closeButton.setAttribute("aria-label",this.localObj.getConstant("Close")),t.appendChild(this.closeButton),t.appendChild(i),_.createElement("span",{className:"e-de-op-close-icon e-de-close-icon e-btn-icon e-icons"}));this.closeButton.appendChild(i),this.restrictPane.appendChild(t),this.initRestrictEditingPane(e),this.documentHelper.optionsPaneContainer.setAttribute("style","display:inline-flex;"),this.documentHelper.optionsPaneContainer.insertBefore(this.restrictPane,this.documentHelper.viewerContainer)},rd.prototype.initRestrictEditingPane=function(e){this.restrictPaneWholeDiv=_.createElement("div");var t=_.createElement("div",{className:"e-de-rp-sub-div"}),i=_.createElement("div",{innerHTML:e.getConstant("Formatting restrictions"),className:"e-de-rp-format"}),i=(t.appendChild(i),_.createElement("input",{attrs:{type:"checkbox"}})),i=(t.appendChild(i),this.allowFormat=this.createCheckBox(e.getConstant("Allow formatting"),i),this.restrictPaneWholeDiv.appendChild(t),_.createElement("div",{className:"e-de-rp-sub-div"})),t=(_.createElement("input",{attrs:{type:"checkbox"}}),_.createElement("input",{className:"e-prop-font-style"})),n=(i.appendChild(t),[{Value:"Read only",Name:e.getConstant("Read only")},{Value:"Filling in forms",Name:e.getConstant("Filling in forms")},{Value:"Comments",Name:e.getConstant("Comments")},{Value:"Tracked changes",Name:e.getConstant("Tracked changes")}]),n=(this.protectionTypeDrop=new U.DropDownList({dataSource:n,cssClass:"e-de-prop-dropdown",floatLabelType:"Always",placeholder:e.getConstant("Editing restrictions"),fields:{text:"Name",value:"Value"},enableRtl:this.documentHelper.owner.enableRtl}),this.protectionTypeDrop.value="Read only",this.protectionTypeDrop.appendTo(t),this.restrictPaneWholeDiv.appendChild(i),this.userWholeDiv=_.createElement("div",{className:"e-de-rp-sub-div"}),_.createElement("div",{innerHTML:e.getConstant("Exceptions Optional"),className:"e-de-rp-format"})),t=(this.userWholeDiv.appendChild(n),_.createElement("div",{innerHTML:e.getConstant("Select Part Of Document And User"),className:"e-de-rp-sub-content-div"})),i=(this.userWholeDiv.appendChild(t),_.createElement("div",{className:"e-de-rp-user"})),n=(this.userWholeDiv.appendChild(i),this.addedUser=new F.ListView({cssClass:"e-de-user-listView",dataSource:[{text:"Everyone"}],showCheckBox:!0,select:this.selectHandler.bind(this),enableRtl:this.documentHelper.owner.enableRtl}),this.addedUser.appendTo(i),this.addUser=_.createElement("button",{className:"e-btn e-primary e-flat e-de-rp-mu-btn",innerHTML:e.getConstant("More users")+"...",attrs:{type:"button"}}),this.addUser.setAttribute("aria-label",e.getConstant("More users")),this.userWholeDiv.appendChild(this.addUser),this.restrictPaneWholeDiv.appendChild(this.userWholeDiv),_.createElement("div",{className:"e-de-rp-enforce"})),t=(this.restrictPaneWholeDiv.appendChild(n),this.enforceProtection=_.createElement("button",{innerHTML:e.getConstant("Enforcing Protection"),className:"e-btn e-de-rp-btn-enforce",attrs:{type:"button"}}),this.enforceProtection.setAttribute("aria-label",e.getConstant("Enforcing Protection")),n.appendChild(this.enforceProtection),this.restrictPane.appendChild(this.restrictPaneWholeDiv),this.stopProtectionDiv=_.createElement("div",{styles:"display:none"}),_.createElement("div",{innerHTML:e.getConstant("Your permissions"),className:"e-de-rp-stop-div1"})),i=(this.stopProtectionDiv.appendChild(t),_.createElement("div",{className:"e-de-rp-stop-div2"})),n=(this.stopProtectionDiv.appendChild(i),e.getConstant("Protected Document")),t=(this.contentDiv1=_.createElement("div",{innerHTML:n}),i.appendChild(this.contentDiv1),e.getConstant("ReadOnlyProtection")),n=(this.contentDiv2=_.createElement("div",{innerHTML:t}),i.appendChild(this.contentDiv2),this.stopReadOnlyOptions=_.createElement("div"),this.stopProtectionDiv.appendChild(this.stopReadOnlyOptions),_.createElement("div",{className:"e-de-rp-enforce-nav"})),t=_.createElement("button",{innerHTML:e.getConstant("Find Next Region I Can Edit"),className:"e-btn e-de-rp-nav-btn",attrs:{type:"button"}}),i=(n.appendChild(t),t.addEventListener("click",this.navigateNextRegion.bind(this)),this.stopReadOnlyOptions.appendChild(n),_.createElement("div",{className:"e-de-rp-enforce-nav"})),t=_.createElement("button",{innerHTML:e.getConstant("Show All Regions I Can Edit"),className:"e-btn e-de-rp-nav-btn",attrs:{type:"button"}}),n=(i.appendChild(t),t.addEventListener("click",this.showAllRegion),this.stopReadOnlyOptions.appendChild(i),_.createElement("div",{className:"e-de-rp-nav-lbl e-de-rp-more-less"})),t=_.createElement("input",{attrs:{type:"checkbox"},className:"e-btn e-de-rp-nav-btn"}),i=(n.appendChild(t),this.stopReadOnlyOptions.appendChild(n),this.highlightCheckBox=new H.CheckBox({label:e.getConstant("Highlight the regions I can edit"),change:this.changeHighlightOptions.bind(this),enableRtl:this.documentHelper.owner.enableRtl},t),_.createElement("div",{className:"e-de-rp-enforce"}));this.stopProtection=_.createElement("button",{innerHTML:e.getConstant("Stop Protection"),className:"e-btn e-de-rp-btn-stop-enforce",attrs:{type:"button"}}),i.appendChild(this.stopProtection),this.stopProtectionDiv.appendChild(i),this.restrictPane.appendChild(this.stopProtectionDiv)},rd.prototype.showStopProtectionPane=function(e){switch(e?(this.stopProtectionDiv.style.display="block",this.restrictPaneWholeDiv.style.display="none"):(this.stopProtectionDiv.style.display="none",this.restrictPaneWholeDiv.style.display="block"),this.documentHelper.protectionType){case"ReadOnly":case"CommentsOnly":this.stopReadOnlyOptions.style.display="block";break;default:this.stopReadOnlyOptions.style.display="none"}this.documentHelper.owner.showHideRulers(),this.documentHelper.owner.triggerResize()},rd.prototype.wireEvents=function(){this.addUser.addEventListener("click",this.addUserDialog.show),this.enforceProtection.addEventListener("click",this.protectDocument.bind(this)),this.stopProtection.addEventListener("click",this.stopProtectionTriggered.bind(this)),this.closeButton.addEventListener("click",this.closePane),this.allowFormat.addEventListener("change",this.enableFormatting.bind(this)),this.protectionTypeDrop.addEventListener("change",this.protectionTypeDropChanges.bind(this)),this.highlightCheckBox.addEventListener("change",this.highlightClicked.bind(this))},rd.prototype.changeHighlightOptions=function(){var e=this;this.documentHelper.owner.documentEditorSettings.highlightEditableRanges=this.highlightCheckBox.checked,setTimeout(function(){e.documentHelper&&e.documentHelper.owner.focusIn()},10)},rd.prototype.enableFormatting=function(e){this.documentHelper.restrictFormatting=!e.checked},rd.prototype.stopProtectionTriggered=function(e){!_.isNullOrUndefined(this.documentHelper.saltValue)&&""!==this.documentHelper.saltValue||!_.isNullOrUndefined(this.documentHelper.hashValue)&&""!==this.documentHelper.hashValue?this.unProtectDialog.show():this.documentHelper.owner.editorModule.unProtectDocument()},rd.prototype.protectionTypeDropChanges=function(e){switch(e.value){case"Read only":this.protectionType="ReadOnly",this.userWholeDiv.style.display="block",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("ReadOnlyProtection"),this.previousProtectionType=e.previousItemData.Value;break;case"Filling in forms":this.protectionType="FormFieldsOnly",this.userWholeDiv.style.display="none",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("FormFieldsOnly"),this.previousProtectionType=e.previousItemData.Value,this.showRemovedIgnoreDialog();break;case"Comments":this.protectionType="CommentsOnly",this.userWholeDiv.style.display="block",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("CommentsOnly"),this.previousProtectionType=e.previousItemData.Value;break;case"Tracked changes":this.protectionType="RevisionsOnly",this.userWholeDiv.style.display="none",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("TrackChangesOnly"),this.previousProtectionType=e.previousItemData.Value,this.showRemovedIgnoreDialog();break;default:this.protectionType="NoProtection",this.addedUser.uncheckAllItems(),this.viewer.owner.editorModule.removeAllEditRestrictions()}},rd.prototype.showRemovedIgnoreDialog=function(){this.documentHelper.selection&&0<this.documentHelper.editRanges.length&&(this.documentHelper.dialog.height=" Auto",this.documentHelper.dialog.width=" 600px",this.documentHelper.dialog.header=this.localObj.getConstant("Information"),this.documentHelper.dialog.content=this.localObj.getConstant("RemovedIgnoreExceptions")+"<br><br>"+this.localObj.getConstant("RemovedIgnore"),this.documentHelper.dialog.buttons=[{click:this.onYesButtonClick,buttonModel:{content:this.localObj.getConstant("Yes")}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel")}},{click:this.onNoButtonClick,buttonModel:{content:this.localObj.getConstant("No")}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show())},rd.prototype.selectHandler=function(e){e.isChecked?(this.viewer.owner.editorModule.insertEditRangeElement(e.text),e.event.target.classList.add("e-check")):this.viewer.owner.editorModule.removeUserRestrictions(e.text)},rd.prototype.highlightClicked=function(e){this.documentHelper.selection.isHighlightEditRegion=e.checked},rd.prototype.protectDocument=function(){this.enforceProtectionDialog.show()},rd.prototype.createCheckBox=function(e,t){e=new H.CheckBox({label:e,enableRtl:this.documentHelper.owner.enableRtl});return e.appendTo(t),e},rd.prototype.loadPaneValue=function(){switch(this.allowFormat.checked=!this.documentHelper.restrictFormatting,this.documentHelper.protectionType){case"ReadOnly":this.protectionTypeDrop.value="Read only";break;case"FormFieldsOnly":this.protectionTypeDrop.value="Filling in forms";break;case"CommentsOnly":this.protectionTypeDrop.value="Comments";break;case"RevisionsOnly":this.protectionTypeDrop.value="Tracked changes"}this.highlightCheckBox.checked=this.documentHelper.owner.documentEditorSettings.highlightEditableRanges,this.addedUser.enablePersistence=!0,this.addedUser.dataSource=this.usersCollection.slice(),this.addedUser.dataBind(),this.showStopProtectionPane(this.documentHelper.isDocumentProtected)},rd.prototype.navigateNextRegion=function(){this.documentHelper.selection.navigateToNextEditingRegion()},rd.prototype.addUserCollection=function(){if(this.documentHelper.selection&&0<this.documentHelper.selection.editRangeCollection.length)for(var e=0;e<this.documentHelper.selection.editRangeCollection.length;e++){var t=this.documentHelper.selection.editRangeCollection[e];""!==t.user&&-1===this.usersCollection.indexOf(t.user)&&this.usersCollection.push(t.user),""!==t.group&&-1===this.usersCollection.indexOf(t.group)&&this.usersCollection.push(t.group)}this.addedUser.dataSource=this.documentHelper.userCollection.slice(),this.addedUser.dataBind()},rd.prototype.updateUserInformation=function(){var e,t;this.addedUser.uncheckAllItems(),this.documentHelper.selection.checkSelectionIsAtEditRegion&&(e=this.documentHelper.selection.getEditRangeStartElement())&&(-1<(t=this.addedUser.dataSource.indexOf(e.user))&&this.addedUser.element.querySelectorAll("li")[t].querySelector(".e-icons").classList.add("e-check"),-1<(t=this.addedUser.dataSource.indexOf(e.group)))&&this.addedUser.element.querySelectorAll("li")[t].querySelector(".e-icons").classList.add("e-check")},rd.prototype.destroy=function(){this.addUserDialog&&this.addUserDialog.destroy(),this.addUserDialog=void 0,this.enforceProtectionDialog&&this.enforceProtectionDialog.destroy(),this.enforceProtectionDialog=void 0,this.unProtectDialog&&this.unProtectDialog.destroy(),this.unProtectDialog=void 0,this.base64&&this.base64.destroy(),this.base64=void 0,this.addedUser&&(this.addedUser.destroy(),this.addedUser=void 0),this.allowFormat&&(this.allowFormat.destroy(),this.allowFormat=void 0),this.protectionTypeDrop&&(this.protectionTypeDrop.destroy(),this.protectionTypeDrop=void 0),this.highlightCheckBox&&(this.highlightCheckBox.destroy(),this.highlightCheckBox=void 0),this.addUser&&(this.addUser.innerHTML="",this.addUser.remove(),this.addUser=void 0),this.restrictPane&&(this.restrictPane.innerHTML="",this.restrictPane.remove(),this.restrictPane=void 0),this.enforceProtection&&(this.enforceProtection.innerHTML="",this.enforceProtection.remove(),this.enforceProtection=void 0),this.stopProtection&&(this.stopProtection.innerHTML="",this.stopProtection.remove(),this.stopProtection=void 0),this.stopProtectionDiv&&(this.stopProtectionDiv.innerHTML="",this.stopProtectionDiv.remove(),this.stopProtectionDiv=void 0),this.stopReadOnlyOptions&&(this.stopReadOnlyOptions.innerHTML="",this.stopReadOnlyOptions.remove(),this.stopReadOnlyOptions=void 0),this.contentDiv1&&(this.contentDiv1.innerHTML="",this.contentDiv1.remove(),this.contentDiv1=void 0),this.contentDiv2&&(this.contentDiv2.innerHTML="",this.contentDiv2.remove(),this.contentDiv2=void 0),this.closeButton&&(this.closeButton.innerHTML="",this.closeButton.remove(),this.closeButton=void 0),this.userWholeDiv&&(this.userWholeDiv.innerHTML="",this.userWholeDiv.remove(),this.userWholeDiv=void 0),this.restrictPaneWholeDiv&&(this.restrictPaneWholeDiv.innerHTML="",this.restrictPaneWholeDiv.remove(),this.restrictPaneWholeDiv=void 0),this.usersCollection=[],this.usersCollection=void 0,this.previousProtectionType=void 0,this.currentHashValue=void 0,this.currentSaltValue=void 0,this.documentHelper=void 0};var nd=rd;function rd(e){var t=this;this.addRemove=!0,this.protectionType="ReadOnly",this.previousProtectionType="Read only",this.isShowRestrictPane=!1,this.isAddUser=!1,this.usersCollection=["Everyone"],this.closePane=function(){t.isShowRestrictPane=!1,t.restrictPane.style.display="none",t.documentHelper.owner.showHideRulers(),t.documentHelper.owner.triggerResize()},this.onYesButtonClick=function(){t.viewer.owner.editorModule.removeAllEditRestrictions(),t.documentHelper.dialog.hide()},this.onCancelButtonClick=function(e){t.protectionTypeDrop.value=t.previousProtectionType,t.documentHelper.dialog.hide()},this.onNoButtonClick=function(){t.documentHelper.dialog.hide()},this.showAllRegion=function(){t.documentHelper.selection.showAllEditingRegion()},this.documentHelper=e,this.addUserDialog=new Yl(e),this.enforceProtectionDialog=new $l(e,this),this.unProtectDialog=new td(e,this),this.base64=new ol}sd.prototype.initPopup=function(){var e=_.createElement("div",{className:"e-de-form-popup"});this.textBoxContainer=this.initTextBoxInput(),e.appendChild(this.textBoxContainer),e.appendChild(this.initNumericTextBox()),e.appendChild(this.initDatePicker()),e.appendChild(this.initDropDownList()),this.target=e,this.owner.documentHelper.viewerContainer.appendChild(e)},sd.prototype.initTextBoxInput=function(){var e=_.createElement("div",{className:"e-de-txt-field"}),t=_.createElement("input",{className:"e-de-txt-form"}),i=new D.TextBox,n=(this.textBoxInput=t,_.createElement("div",{className:"e-de-cmt-action-button"})),r=_.createElement("button"),o=_.createElement("button");return r.addEventListener("click",this.applyTextFormFieldValue),o.addEventListener("click",this.closeButton),e.appendChild(t),n.appendChild(r),n.appendChild(o),e.appendChild(n),i.appendTo(t),new H.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},r),new H.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},o),this.textBoxInstance=i,e},sd.prototype.initNumericTextBox=function(){var e=_.createElement("div",{className:"e-de-num-field"}),t=_.createElement("input",{className:"e-de-txt-form"}),i=new D.NumericTextBox,n=(this.numberInput=t,_.createElement("div",{className:"e-de-cmt-action-button"})),r=_.createElement("button"),o=_.createElement("button");return r.addEventListener("click",this.applyNumberFormFieldValue),o.addEventListener("click",this.closeButton),e.appendChild(t),n.appendChild(r),n.appendChild(o),e.appendChild(n),i.appendTo(t),new H.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},r),new H.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},o),this.numericTextBoxInstance=i,e},sd.prototype.initDatePicker=function(){var e=_.createElement("div",{className:"e-de-date-field"}),t=_.createElement("input",{className:"e-de-txt-form"}),i=new v.DateTimePicker({strictMode:!0,change:this.enableDisableDatePickerOkButton}),n=(this.dateInput=t,_.createElement("div",{className:"e-de-cmt-action-button"})),r=_.createElement("button"),o=_.createElement("button");return r.addEventListener("click",this.applyDateFormFieldValue),o.addEventListener("click",this.closeButton),e.appendChild(t),n.appendChild(r),n.appendChild(o),e.appendChild(n),i.appendTo(t),this.dataPickerOkButton=new H.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},r),new H.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},o),this.datePickerInstance=i,e},sd.prototype.initDropDownList=function(){var e=_.createElement("div",{className:"e-de-ddl-field"}),t=_.createElement("input",{className:"e-de-txt-form"}),i=new U.DropDownList,n=(this.dropDownInput=t,_.createElement("div",{className:"e-de-cmt-action-button"})),r=_.createElement("button"),o=_.createElement("button");return r.addEventListener("click",this.applyDropDownFormFieldValue),o.addEventListener("click",this.closeButton),e.appendChild(t),n.appendChild(r),n.appendChild(o),e.appendChild(n),i.appendTo(t),new H.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},r),new H.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},o),this.ddlInstance=i,e},sd.prototype.showPopUp=function(e){var t,i,n,r,o,s=this;e&&(this.formField=e,this.owner.selectionModule.selectField(),_.isNullOrUndefined(this.target)&&this.initPopup(),_.classList(this.target,[],["e-de-txt-form","e-de-num-form","e-de-date-form","e-de-ddl-form"]),(t=e.formFieldData)&&(t instanceof Ch?(r=e.resultText,o=RegExp(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi"),""===r.replace(o,"")&&(r=""),o=t.maxLength,r=r||"","Text"===(n=t.type)||"Calculation"===n?(_.classList(this.target,["e-de-txt-form"],[]),i=this.textBoxInput,this.textBoxInstance.value=r):"Number"===t.type?(_.classList(this.target,["e-de-num-form"],[]),i=this.numberInput,this.numericTextBoxInstance.format=t.format,this.numericTextBoxInstance.value=parseFloat(r.replace(/,/gi,""))):"Date"===n&&(_.classList(this.target,["e-de-date-form"],[]),i=this.dateInput,-1!==(n=t.format).indexOf("am/pm")&&(n=n.replace(/am\/pm/gi,"a")),this.datePickerInstance.format=n,this.datePickerInstance.value=new Date(r),this.dataPickerOkButton.disabled=!0),i&&(0<o?i.maxLength=o:i.removeAttribute("maxlength"),setTimeout(function(){i.focus()}))):t instanceof Sh&&(_.classList(this.target,["e-de-ddl-form"],[]),this.ddlInstance.refresh(),this.ddlInstance.dataSource=t.dropdownItems,this.ddlInstance.index=t.selectedIndex,setTimeout(function(){s.ddlInstance.showPopup()},50)),n=this.owner.selectionModule.getLeftInternal(e.line,e,0),r=e.line.height*this.owner.documentHelper.zoomFactor,o=this.owner.selectionModule.getTooltipPosition(e.line,n,this.target,!0),this.popupObject||(this.popupObject=new C.Popup(this.target,{height:"auto",width:"auto",relateTo:this.owner.documentHelper.viewerContainer.parentElement,position:{X:o.x,Y:o.y+r}})),this.target.style.display="block",this.popupObject.show()),this.owner.documentHelper.isFormFilling=!0)},sd.prototype.destroy=function(){this.formField&&this.formField.destroy(),this.formField=void 0,this.owner=void 0};var od=sd;function sd(e){var i=this;this.applyTextFormFieldValue=function(){i.owner.editorModule.updateFormField(i.formField,i.textBoxInstance.value),i.owner.trigger(se,{fieldName:i.formField.formFieldData.name,value:i.formField.resultText,isCanceled:!1}),i.hidePopup()},this.applyNumberFormFieldValue=function(){i.owner.editorModule.updateFormField(i.formField,i.numberInput.value.toString()),i.owner.trigger(se,{fieldName:i.formField.formFieldData.name,value:i.formField.resultText,isCanceled:!1}),i.hidePopup()},this.applyDateFormFieldValue=function(){_.isNullOrUndefined(i.datePickerInstance.value)||(i.owner.editorModule.updateFormField(i.formField,i.dateInput.value),i.owner.trigger(se,{fieldName:i.formField.formFieldData.name,value:i.formField.resultText,isCanceled:!1}),i.hidePopup())},this.applyDropDownFormFieldValue=function(){i.owner.editorModule.updateFormField(i.formField,i.ddlInstance.index),i.owner.trigger(se,{fieldName:i.formField.formFieldData.name,value:i.formField.formFieldData.selectedIndex,isCanceled:!1}),i.hidePopup()},this.enableDisableDatePickerOkButton=function(e){e.isInteracted&&(i.dataPickerOkButton.disabled=!1)},this.closeButton=function(){var e=i.formField,t=(i.hidePopup(),{fieldName:e.formFieldData.name});e.formFieldData instanceof Ch?t.value=e.resultText:e.formFieldData instanceof Fh?t.value=e.formFieldData.checked:t.value=e.formFieldData.selectedIndex,t.isCanceled=!0,i.owner.trigger(se,t)},this.hidePopup=function(){i.owner.documentHelper.isFormFilling=!1,i.formField=void 0,i.target&&(i.target.style.display="none"),i.popupObject&&(i.popupObject.hide(),i.popupObject.destroy(),i.popupObject=void 0)},this.owner=e}ld.prototype.initPopup=function(){var e=_.createElement("div",{className:"e-de-form-popup"});e.appendChild(this.initDropDownList()),this.target=e,this.owner.documentHelper.viewerContainer.appendChild(e)},ld.prototype.initDropDownList=function(){var e=_.createElement("div",{className:"e-de-ddl-field"}),t=_.createElement("input",{className:"e-de-txt-form"}),i=new U.DropDownList({fields:{text:"value"}}),n=(this.dropDownInput=t,_.createElement("div",{className:"e-de-cmt-action-button"})),r=_.createElement("button"),o=_.createElement("button");return r.addEventListener("click",this.applyDropDownFormFieldValue),o.addEventListener("click",this.closeButton),e.appendChild(t),n.appendChild(r),n.appendChild(o),e.appendChild(n),i.appendTo(t),new H.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},r),new H.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},o),this.ddlInstance=i,e},ld.prototype.showPopUp=function(e){var t,i,n=this;e&&(this.contenControl=e,_.isNullOrUndefined(this.target)&&this.initPopup(),_.classList(this.target,[],["e-de-txt-form","e-de-num-form","e-de-date-form","e-de-ddl-form"]),_.classList(this.target,["e-de-ddl-form"],[]),this.ddlInstance.refresh(),t=e.contentControlProperties.contentControlListItems.map(function(e){var t,i={};for(t in e)i[""+t]=e[""+t];return i}),this.ddlInstance.dataSource=t,setTimeout(function(){n.ddlInstance.showPopup()},50),t=this.owner.selectionModule.getLeftInternal(e.line,e,0),i=e.line.height*this.owner.documentHelper.zoomFactor,e=this.owner.selectionModule.getTooltipPosition(e.line,t,this.target,!0),this.popupObject||(this.popupObject=new C.Popup(this.target,{height:"auto",width:"auto",relateTo:this.owner.documentHelper.viewerContainer.parentElement,position:{X:e.x,Y:e.y+i}})),this.target.style.display="block",this.popupObject.show())},ld.prototype.destroy=function(){this.contenControl&&this.contenControl.destroy(),this.contenControl=void 0,this.owner=void 0};var ad=ld;function ld(e){var t=this;this.applyDropDownFormFieldValue=function(){t.owner.editorModule.dropDownChange(t.contenControl,t.ddlInstance.text),t.hidePopup()},this.enableDisableDatePickerOkButton=function(e){e.isInteracted&&(t.dataPickerOkButton.disabled=!1)},this.closeButton=function(){t.hidePopup()},this.hidePopup=function(){t.contenControl=void 0,t.target&&(t.target.style.display="none"),t.popupObject&&(t.popupObject.hide(),t.popupObject.destroy(),t.popupObject=void 0)},this.owner=e}Object.defineProperty(hd.prototype,"setNoChangesVisibility",{get:function(){return this.noChangesVisibleInternal},set:function(e){this.isChangesTabVisible=!e,this.noChangeDivElement.style.display=e?"block":"none",this.noChangesVisibleInternal=e,this.enableDisableToolbarItem(!e),this.commentReviewPane.reviewTab.hideTab(1,e),this.owner.notify("reviewPane",{changes:!e,comment:this.commentReviewPane.isCommentTabVisible})},enumerable:!0,configurable:!0}),Object.defineProperty(hd.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(e){var t=_.select(".e-de-trckchanges-inner-select",this.changesInfoDiv);_.isNullOrUndefined(e)?_.isNullOrUndefined(t)||t.classList.remove("e-de-trckchanges-inner-select"):(e!==this.currentSelectedRevisionInternal||_.isNullOrUndefined(t))&&(t&&t.classList.remove("e-de-trckchanges-inner-select"),0<this.changes.length)&&this.changes.containsKey(e)&&this.changes.get(e).singleInnerDiv.classList.add("e-de-trckchanges-inner-select"),this.currentSelectedRevisionInternal=e,t=_.select(".e-de-trckchanges-inner-select",this.changesInfoDiv),_.isNullOrUndefined(t)||t.parentElement.scrollIntoView({block:"nearest"})},enumerable:!0,configurable:!0}),hd.prototype.initTrackChangePane=function(){this.changes=new T,this.renderedChanges=new T,this.trackChangeDiv=_.createElement("div",{className:"e-de-tc-pane"}),this.trackChangeDiv.appendChild(this.initPaneHeader()),this.changesInfoDiv=_.createElement("div",{id:"e-de-tc-pane-revision",styles:"overflow:auto",className:this.owner.documentEditorSettings.showHiddenMarks?"":"e-de-tc-hide-para-mark"}),this.trackChangeDiv.appendChild(this.changesInfoDiv),this.noChangeDivElement=_.createElement("div",{styles:"display:none;",className:"e-de-tc-no-chng"}),this.noChangeDivElement.textContent=this.locale.getConstant("No changes"),this.changesInfoDiv.appendChild(this.noChangeDivElement),this.updateTrackChanges()},hd.prototype.showHiddenParaMark=function(){this.owner.documentEditorSettings.showHiddenMarks?this.changesInfoDiv.classList.contains("e-de-tc-hide-para-mark")&&this.changesInfoDiv.classList.remove("e-de-tc-hide-para-mark"):this.changesInfoDiv.classList.contains("e-de-tc-hide-para-mark")||this.changesInfoDiv.classList.add("e-de-tc-hide-para-mark")},hd.prototype.initPaneHeader=function(){var t=this;this.toolbarElement=_.createElement("div",{className:"e-de-track-toolbar"}),this.toolbar=new k.Toolbar({enableRtl:this.owner.enableRtl,items:[{text:this.locale.getConstant("User")+":",cssClass:"e-de-track-toolbar-overlay",disabled:!0},{template:_.createElement("div",{id:"e-de-user-list",attrs:{role:"button"}})},{type:"Separator"},{text:this.locale.getConstant("View")+":",cssClass:"e-de-track-toolbar-overlay",disabled:!0},{template:_.createElement("div",{id:"e-de-revision-list",attrs:{role:"button"}})},{prefixIcon:"e-de-nav-left-arrow e-de-tc-tbr",align:"Right",cssClass:"e-de-nvgte-left",tooltipText:this.locale.getConstant("Previous Changes"),click:this.navigatePreviousChanges.bind(this)},{prefixIcon:"e-de-nav-right-arrow e-de-tc-tbr",align:"Right",cssClass:"e-de-nvgte-right",tooltipText:this.locale.getConstant("Next Changes"),click:this.navigateNextChanges.bind(this)},{template:_.createElement("div",{id:"e-de-menu-option",attrs:{role:"button"}}),align:"Right",cssClass:"e-de-tc-tbr",tooltipText:this.locale.getConstant("More Options")+"..."}]}),this.toolbar.appendTo(this.toolbarElement),_.select(".e-de-nvgte-left",this.toolbarElement).firstChild.classList.add("e-tc-nvgte");_.select(".e-de-nvgte-right",this.toolbarElement).firstChild.classList.add("e-tc-nvgte");var e=_.select("#e-de-user-list",this.toolbarElement),e=(this.userDropDownitems=[{text:this.locale.getConstant("All")}],this.userDropDown={items:this.userDropDownitems,cssClass:"e-de-track-pane-drop-btn e-tc-btn-bg-clr",select:this.onUserSelect.bind(this),beforeOpen:this.onUserOpen.bind(this),beforeItemRender:function(e){t.beforeDropDownItemRender(e,t.selectedUser)}},this.userDropDownButton=new w.DropDownButton(this.userDropDown),this.userDropDownButton.appendTo(e),this.userDropDownButton.content=this.getSpanView(this.userDropDown.items[0].text,0),_.select("#e-de-revision-list",this.toolbarElement));this.viewTypeitems=[{text:this.locale.getConstant("All")},{text:this.locale.getConstant("Inserted")},{text:this.locale.getConstant("Deleted")}],this.viewTypeDropDownButton=new w.DropDownButton({items:this.viewTypeitems,cssClass:"e-de-track-pane-drop-btn e-tc-btn-bg-clr",select:this.onTypeSelect.bind(this),beforeItemRender:function(e){t.beforeDropDownItemRender(e,t.selectedType)}}),this.viewTypeDropDownButton.content=this.getSpanView(this.viewTypeitems[0].text,1),this.viewTypeDropDownButton.appendTo(e),this.menuoptionEle=_.select("#e-de-menu-option",this.toolbarElement);e={items:[{text:this.locale.getConstant("Accept all")},{text:this.locale.getConstant("Reject all")}],select:this.onMenuSelect.bind(this),iconCss:"e-de-menu-icon",cssClass:"e-caret-hide e-tc-btn-bg-clr"};return this.menuDropDownButton=new w.DropDownButton(e),this.menuDropDownButton.appendTo(this.menuoptionEle),this.toolbarElement},hd.prototype.beforeDropDownItemRender=function(e,t){e.element.innerHTML="<span></span>"+e.item.text;var i=e.element.children[0];e.item.text===t?(i.style.marginRight="10px",i.style.alignSelf="center",i.setAttribute("class","e-de-selected-item e-icons")):(e.element.children[0].style.marginRight="25px",e.element.children[0].classList.remove("e-de-selected-item"))},hd.prototype.onUserOpen=function(e){e=e.element;e.style.maxHeight="200px",e.style.overflowY="auto"},hd.prototype.enableDisableToolbarItem=function(e){var t=this.toolbar.element.querySelectorAll(".e-de-tc-tbr");this.owner&&this.owner.viewer&&(this.toolbar.enableItems(t[0].parentElement.parentElement,e),this.toolbar.enableItems(t[1].parentElement.parentElement,e),this.toolbar.enableItems(t[2],e))},hd.prototype.getSpanView=function(e,t){return(0===t?'<span class="e-de-track-span-user">':'<span class="e-de-track-span-view">')+e+"</span>"},hd.prototype.onMenuSelect=function(e){var t=this,e=e.item.text;e.match(this.locale.getConstant("Accept all"))?setTimeout(function(){t.owner.revisionsInternal.handleRevisionCollection(!0,t.sortedRevisions)},0):e.match(this.locale.getConstant("Reject all"))&&setTimeout(function(){t.owner.revisionsInternal.handleRevisionCollection(!1,t.sortedRevisions)},0),this.updateUsers()},hd.prototype.onSelection=function(e){this.currentSelectedRevision=e},hd.prototype.onUserSelect=function(e){e=e.item.text;this.selectedUser=e,this.userDropDownButton.content=this.getSpanView(e,0),this.sortCollectionToDisplay()},hd.prototype.onTypeSelect=function(e){e=e.item.text;this.selectedType=e,this.viewTypeDropDownButton.content=this.getSpanView(e,1),this.sortCollectionToDisplay()},hd.prototype.updateMenuOptions=function(){var e;this.selectedType!==this.locale.getConstant("All")&&(e=this.selectedType===this.locale.getConstant("Inserted")?this.locale.getConstant("Insertion"):this.locale.getConstant("Deletion")),this.selectedUser===this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+this.locale.getConstant("Changes"),this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+this.locale.getConstant("Changes")):this.selectedUser===this.locale.getConstant("All")&&this.selectedType!==this.locale.getConstant("All")?(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+e,this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+e):this.selectedUser!==this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+this.locale.getConstant("Changes")+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser,this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+this.locale.getConstant("Changes")+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser):(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+e+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser,this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+e+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser),this.owner.documentHelper.isDocumentProtected||this.owner.isReadOnly?this.menuDropDownButton.disabled=!0:this.menuDropDownButton.disabled=!1},hd.prototype.sortCollectionToDisplay=function(){var e=!1;this.sortedRevisions=[],this.updateMenuOptions();for(var t=0;t<this.changes.length;t++){var i=this.changes.get(this.revisions[t]),n=i.outerSingleDiv;this.selectedUser===this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?n.style.display="block":this.selectedUser===this.locale.getConstant("All")&&this.selectedType!==this.locale.getConstant("All")?this.locale.getConstant(i.revisionType)===this.selectedType?n.style.display="block":n.style.display="none":this.selectedUser!==this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?i.user===this.selectedUser?n.style.display="block":n.style.display="none":i.user===this.selectedUser&&this.locale.getConstant(i.revisionType)===this.selectedType?n.style.display="block":n.style.display="none","block"===n.style.display&&this.sortedRevisions.push(this.revisions[t]),e=!0}this.setNoChangesVisibility=!e},hd.prototype.enableDisableButton=function(e){this.enableButtons=e,this.updateTrackChanges()},hd.prototype.isUpdateTrackChanges=function(e){var t=!1,i=!1;return _.isNullOrUndefined(this.changesInfoDiv)||(1===this.changesInfoDiv.childNodes.length&&"e-de-tc-no-chng"==this.changesInfoDiv.childNodes[0].className?i=!0:e!==this.changesInfoDiv.childNodes.length&&(t=!0)),t=i||0<e?!0:t},hd.prototype.updateCurrentTrackChanges=function(e){var t;if(_.isNullOrUndefined(e)||(t=this.owner.trackChangesPane.changes.get(e)),!_.isNullOrUndefined(t)&&0<e.range.length){for(var i=t.singleInnerDiv.querySelector("#textDiv");i.firstChild;)i.removeChild(i.firstChild);t.layoutElementText(e.range,i)}_.isNullOrUndefined(e)||0!==e.range.length||this.owner.revisions.remove(e)},hd.prototype.updateTrackChanges=function(e){if(e||_.isNullOrUndefined(e)){if(this.owner.isUpdateTrackChanges){for(var t=0;t<this.tableRevisions.keys.length;t++){var i=this.tableRevisions.keys[t],n=this.revisions.indexOf(i),r=this.tableRevisions.get(i)[this.tableRevisions.get(i).length-1]===i;_.isNullOrUndefined(this.changes)||(this.changes.get(i),r&&!_.isNullOrUndefined(this.changesInfoDiv)&&(r=this.changes.get(i),this.changesInfoDiv.removeChild(r.outerSingleDiv))),this.renderedChanges.containsKey(i)&&this.renderedChanges.remove(i),this.changes.containsKey(i)&&this.changes.remove(i),this.revisions.splice(n,1)}this.tableRevisions.clear()}else this.tableRevisions.clear(),this.renderedChanges.clear(),this.removeAllChanges();if(this.enableButtons||this.menuoptionEle.classList.contains("e-de-overlay")?!this.menuoptionEle.classList.contains("e-de-overlay")||this.owner.documentHelper.isDocumentProtected||this.owner.isReadOnly||this.menuoptionEle.classList.remove("e-de-overlay"):this.menuoptionEle.classList.add("e-de-overlay"),this.isChangesTabVisible=!0,this.owner.notify("reviewPane",{comment:this.commentReviewPane.isCommentTabVisible,changes:this.isChangesTabVisible}),this.owner.isUpdateTrackChanges){for(var o=0,t=0;t<this.owner.revisions.changes.length;t++){i=this.owner.revisions.changes[t],d=this.owner.revisions.changes[t].range[0];if(this.changes.containsKey(i)){var s=this.renderedChanges.get(i);_.isNullOrUndefined(s)||(this.enableButtons?s.acceptButtonElement.classList.contains("e-de-overlay")&&!this.owner.documentHelper.isTrackedOnlyMode&&(s.acceptButtonElement.classList.remove("e-de-overlay"),s.rejectButtonElement.classList.remove("e-de-overlay")):s.acceptButtonElement.classList.contains("e-de-overlay")||(s.acceptButtonElement.classList.add("e-de-overlay"),s.rejectButtonElement.classList.add("e-de-overlay")),o++)}else if(d instanceof Ya)if(1<(l=this.groupTableRevisions(this.owner.revisions.changes,t)).length){0===o&&(o=t);for(p=void 0,u=0;u<l.length;u++){m=l[u];0===u?(s=new cd(this.owner,this),this.changesInfoDiv.insertBefore(s.createSingleChangesDiv(m),this.changesInfoDiv.children[o+1]),this.revisions.splice(t,0,m),this.changes.add(m,s),this.renderedChanges.add(m,s),p=this.changes.get(i)):(g=m.range[0],p.appendRowToTable(g,u),this.revisions.splice(t+u,0,m),this.changes.add(m,p)),this.tableRevisions.add(m,l)}o++}else{s=new cd(this.owner,this);this.changesInfoDiv.insertBefore(s.createSingleChangesDiv(i),this.changesInfoDiv.children[t+1]),this.revisions.splice(t,0,i),this.changes.add(i,s),this.renderedChanges.add(i,s),this.tableRevisions.add(i,l)}}for(var a=document.getElementsByClassName("e-de-track-chngs-count").length,t=0;t<a;t++)document.getElementsByClassName("e-de-track-chngs-count")[t].innerHTML=this.locale.getConstant("Changes")+" "+(t+1).toString()+" "+this.locale.getConstant("of")+" "+a.toString()}else{for(t=0;t<this.owner.revisions.changes.length;t++){var l,i=this.owner.revisions.changes[t],d=this.owner.revisions.changes[t].range[0];if(!((d instanceof X||d instanceof Z)&&d.paragraph.containerWidget instanceof Xd&&_.isNullOrUndefined(d.paragraph.containerWidget.sectionFormat))){if(d instanceof X&&d.paragraph.containerWidget instanceof Xd){var h=d.paragraph.containerWidget.headerFooterType,c=this.owner.selectionModule.sectionFormat;if(!("EvenFooter"!==h&&"EvenHeader"!==h&&"OddFooter"!==h&&"OddHeader"!==h||c.differentOddAndEvenPages))continue;if(("FirstPageHeader"===h||"FirstPageFooter"===h)&&!c.differentFirstPage)continue}if(!this.changes.containsKey(i))if(d instanceof Ya)if(1<(l=this.groupTableRevisions(this.owner.revisions.changes,t)).length)for(var p=void 0,u=0;u<l.length;u++){var g,m=l[u];0===u?(this.addChanges(m),p=this.changes.get(i)):(g=m.range[0],p.appendRowToTable(g,u),this.revisions.push(m),this.changes.add(m,p)),this.tableRevisions.add(m,l)}else this.addChanges(i);else this.addChanges(i)}}for(t=0;t<this.renderedChanges.keys.length;t++)(p=this.renderedChanges.get(this.renderedChanges.keys[t])).updateRevisionIndexAndCount(t+1,this.renderedChanges.keys.length)}this.sortCollectionToDisplay(),this.updateUsers(),e&&(this.currentSelectedRevision=this.currentSelectedRevisionInternal,this.updateHeight(),this.owner.resize())}else this.currentSelectedRevision=void 0},hd.prototype.groupTableRevisions=function(e,t){for(var i=e[t],n=[i],r=i.revisionType,o=i.range[0].ownerBase,s=o.ownerTable,a=o.index,l=this.owner.documentHelper.layout.getParentTable(s),d=t+1;d<e.length;d++){var h=e[d],c=h.revisionType,p=h.range[0];if(!(p instanceof Ya)){var u=void 0;if(p instanceof B?u=p.ownerBase:p instanceof mh&&(u=p.line.paragraph),u instanceof G&&u.isInsideTable){g=u.associatedCell.ownerTable,u=this.owner.documentHelper.layout.getParentTable(g);if(s.equals(g)||!s.equals(g)&&!_.isNullOrUndefined(l)&&l.equals(u))continue}break}var u=p.ownerBase,g=u.ownerTable,p=u.index;if(s.equals(g)||_.isNullOrUndefined(l)||!l.equals(this.owner.documentHelper.layout.getParentTable(g))){if(r!==c||i.author!==h.author||!s.equals(g)||a+1!==p)break;n.push(h),a=p}}return n},hd.prototype.updateUsers=function(){0<this.users.length&&(this.userDropDownButton.removeItems(this.users),this.users=[]);for(var e=0;e<this.revisions.length;e++)-1===this.users.indexOf(this.revisions[e].author)&&(this.users.push(this.revisions[e].author),this.userDropDownButton.items.push({text:this.revisions[e].author}))},hd.prototype.updateHeight=function(){var e=this.commentReviewPane.reviewTab.getRootElement().getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height;this.changesInfoDiv.style.height=this.commentReviewPane.parentPaneElement.clientHeight-this.toolbarElement.clientHeight-e-2+"px"},hd.prototype.removeAllChanges=function(){for(;1<this.changesInfoDiv.childNodes.length;)this.changesInfoDiv.removeChild(this.changesInfoDiv.lastChild);if(this.revisions=[],this.changes&&0<this.changes.length){for(var e=0;e<this.changes.length;e++){var t=this.changes.keys[e];this.changes.get(t).clear()}this.changes.clear()}},hd.prototype.clear=function(){this.removeAllChanges(),this.selectedUser=this.locale.getConstant("All"),this.userDropDownButton.content=this.getSpanView(this.selectedUser,0),this.selectedType=this.locale.getConstant("All"),this.viewTypeDropDownButton.content=this.getSpanView(this.selectedType,1),this.currentSelectedRevision=void 0},hd.prototype.destroy=function(){if(this.changes&&0<this.changes.length){for(var e=0;e<this.changes.length;e++){var t=this.changes.keys[e];this.changes.get(t).destroy()}this.changes.clear()}this.changes=void 0,this.toolbar&&(this.toolbar.destroy(),this.toolbar=void 0),this.closeButton&&this.closeButton.parentElement&&this.closeButton.parentElement.removeChild(this.closeButton),this.closeButton=void 0,this.userDropDownButton&&(this.userDropDownButton.destroy(),this.userDropDownButton=void 0),this.menuDropDownButton&&(this.menuDropDownButton.destroy(),this.menuDropDownButton=void 0),this.viewTypeDropDownButton&&(this.viewTypeDropDownButton.destroy(),this.viewTypeDropDownButton=void 0),this.userDropDown&&(this.userDropDown=void 0),0<this.users.length&&(this.users=[],this.users=void 0),this.trackChangeDiv&&(this.trackChangeDiv.innerHTML="",this.trackChangeDiv.parentElement)&&this.trackChangeDiv.parentElement.removeChild(this.trackChangeDiv),this.trackChangeDiv=void 0,this.changesInfoDiv&&(this.changesInfoDiv.innerHTML="",this.changesInfoDiv.parentElement)&&this.changesInfoDiv.parentElement.removeChild(this.changesInfoDiv),this.changesInfoDiv=void 0,this.commentReviewPane&&(this.commentReviewPane=void 0),this.tableRevisions&&(this.tableRevisions.destroy(),this.tableRevisions=void 0),this.renderedChanges&&(this.renderedChanges.destroy(),this.renderedChanges=void 0),this.currentSelectedRevisionInternal=void 0,this.selectedUser=void 0,this.selectedType=void 0,this.sortedRevisions=[],this.sortedRevisions=void 0,this.viewTypeitems=[],this.viewTypeitems=void 0,this.userDropDownitems=[],this.userDropDownitems=void 0,this.revisions=[],this.revisions=void 0,this.owner=void 0},hd.prototype.addChanges=function(e){var t=new cd(this.owner,this);this.changesInfoDiv.appendChild(t.createSingleChangesDiv(e)),this.enableButtons?t.acceptButtonElement.classList.contains("e-de-overlay")&&!this.owner.documentHelper.isTrackedOnlyMode&&(t.acceptButtonElement.classList.remove("e-de-overlay"),t.rejectButtonElement.classList.remove("e-de-overlay")):t.acceptButtonElement.classList.contains("e-de-overlay")||(t.acceptButtonElement.classList.add("e-de-overlay"),t.rejectButtonElement.classList.add("e-de-overlay")),this.revisions.push(e),this.changes.add(e,t),this.renderedChanges.add(e,t)},hd.prototype.navigatePreviousChanges=function(){this.revisionNavigateInternal(!1)},hd.prototype.navigateNextChanges=function(){this.revisionNavigateInternal(!0)},hd.prototype.revisionNavigateInternal=function(e){var t,i,n=this.renderedChanges.keys;if(!this.currentSelectedRevisionInternal){if(0===n.length)return;this.currentSelectedRevision=n[0]}this.currentSelectedRevision&&(i=this.currentSelectedRevision,t=(n=n).indexOf(i),i=e?t===n.length-1?n[0]:n[t+1]:0===t?n[n.length-1]:n[t-1],(this.owner.documentHelper.currentSelectedRevision=i).range[0]instanceof Ya?(e=this.groupTableRevisions(this.owner.revisions.changes,this.owner.revisions.changes.indexOf(i)),this.owner.selectionModule.selectTableRevision(e)):this.owner.selectionModule.selectRevision(i)),this.currentSelectedRevision=this.owner.documentHelper.currentSelectedRevision};var dd=hd;function hd(e,t){this.users=[],this.enableButtons=!0,this.viewTypeitems=[],this.sortedRevisions=[],this.noChangesVisibleInternal=!0,this.isTrackingPageBreak=!1,this.tableRevisions=new T,this.owner=e,this.commentReviewPane=t,this.locale=new _.L10n("documenteditor",this.owner.defaultLocale),this.locale.setLocale(this.owner.locale),this.selectedUser=this.locale.getConstant("All"),this.selectedType=this.locale.getConstant("All"),this.initTrackChangePane(),this.commentReviewPane.reviewTab.items[1].content=this.trackChangeDiv,_.Browser.isIE||this.commentReviewPane.reviewTab.refresh(),this.owner.enableRtl?this.closeButton=_.createElement("button",{className:"e-de-close-icon e-btn e-flat e-icon-btn",id:"close",attrs:{type:"button",style:"position:absolute;top:6px;left:1px"}}):this.closeButton=_.createElement("button",{className:"e-de-close-icon e-btn e-flat e-icon-btn",id:"close",attrs:{type:"button",style:"position:absolute;top:6px;right:1px"}}),this.closeButton.title=this.locale.getConstant("Close"),this.closeButton.setAttribute("aria-label",this.locale.getConstant("Close"));e=_.createElement("span",{className:"e-de-op-close-icon e-de-close-icon e-btn-icon e-icons"});this.closeButton.appendChild(e),this.commentReviewPane.reviewTab.element.appendChild(this.closeButton),this.closeButton.addEventListener("click",this.commentReviewPane.closePane.bind(this.commentReviewPane))}pd.prototype.updateRevisionIndexAndCount=function(e,t){this.changesCount.innerHTML=this.locale.getConstant("Changes")+" "+e.toString()+" "+this.locale.getConstant("of")+" "+t.toString()},pd.prototype.createSingleChangesDiv=function(e){this.revision=e,this.user=e.author,this.outerSingleDiv=_.createElement("div",{className:"e-de-tc-outer"}),this.singleInnerDiv=_.createElement("div",{className:"e-de-trckchanges-inner"}),this.singleInnerDiv.addEventListener("click",this.selectRevision.bind(this)),this.outerSingleDiv.appendChild(this.singleInnerDiv);var t=_.createElement("div",{className:"e-de-track-usernme-div"}),i=_.createElement("div",{innerHTML:e.author,className:"e-de-track-user-nme"}),i=(_.isNullOrUndefined(e.author)||(t.style.display="flex",this.owner.documentHelper.getAvatar(t,i,void 0,e)),_.createElement("div")),i=("Insertion"===e.revisionType?(this.revisionType="Inserted",i.innerHTML=this.locale.getConstant("Inserted").toUpperCase(),i.classList.add("e-de-track-insert")):"Deletion"===e.revisionType?(this.revisionType="Deleted",i.innerHTML=this.locale.getConstant("Deleted").toUpperCase(),i.classList.add("e-de-track-delete")):"MoveFrom"===e.revisionType?(this.revisionType="MoveFrom",i.innerHTML=this.locale.getConstant("Move From").toUpperCase(),i.classList.add("e-de-track-delete"),i.style.whiteSpace="nowrap"):"MoveTo"===e.revisionType&&(this.revisionType="MoveTo",i.innerHTML=this.locale.getConstant("Move To").toUpperCase(),i.classList.add("e-de-track-insert"),i.style.whiteSpace="nowrap"),t.appendChild(i),this.singleInnerDiv.appendChild(t),_.createElement("div",{className:"e-de-track-date",innerHTML:j.getModifiedDate(e.date)})),t=(this.singleInnerDiv.appendChild(i),_.createElement("div",{id:"textDiv",className:"e-de-track-chngs-text"})),i=(this.layoutElementText(e.range,t),this.singleInnerDiv.appendChild(t),_.createElement("div",{styles:"display:inline-block;width:100%"})),t=(this.singleInnerDiv.appendChild(i),_.createElement("div",{styles:"float:left;"})),t=(this.acceptButtonElement=_.createElement("button",{className:"e-de-track-accept-button"}),this.acceptButton=new H.Button({cssClass:"e-outline e-success",content:this.locale.getConstant("Accept")}),this.acceptButtonElement.setAttribute("aria-label",this.locale.getConstant("Accept")),t.appendChild(this.acceptButtonElement),i.appendChild(t),this.acceptButton.appendTo(this.acceptButtonElement),this.owner.documentHelper.isTrackedOnlyMode&&this.acceptButtonElement.classList.add("e-de-overlay"),this.acceptButtonElement.addEventListener("click",this.acceptButtonClick.bind(this)),t=_.createElement("div",{styles:"float:left;"}),this.rejectButtonElement=_.createElement("button",{className:"e-de-track-reject-button"}),this.rejectButton=new H.Button({cssClass:"e-outline e-danger",content:this.locale.getConstant("Reject")}),this.rejectButtonElement.setAttribute("aria-label",this.locale.getConstant("Reject")),t.appendChild(this.rejectButtonElement),i.appendChild(t),this.rejectButton.appendTo(this.rejectButtonElement),this.owner.documentHelper.isTrackedOnlyMode&&this.rejectButtonElement.classList.add("e-de-overlay"),this.rejectButtonElement.addEventListener("click",this.rejectButtonClick.bind(this)),this.changesCount=_.createElement("div",{className:"e-de-track-chngs-count",styles:"float:right;"}),this.owner.revisions.changes.indexOf(e)+1),e=this.owner.revisions.changes.length;return this.changesCount.innerHTML=this.locale.getConstant("Changes")+" "+t.toString()+" "+this.locale.getConstant("of")+" "+e.toString(),i.appendChild(this.changesCount),this.outerSingleDiv},pd.prototype.appendRowToTable=function(e,t){this.tableElement.insertRow();for(var i=0;i<e.ownerBase.childWidgets.length;i++)this.tableElement.rows[t].insertCell(),this.tableElement.rows[t].cells[i].classList.add("e-de-tc-tble-cell")},pd.prototype.selectRevision=function(){var e;this.revision.range[0]instanceof Ya?(e=this.trackChangesPane.groupTableRevisions(this.owner.revisions.changes,this.owner.revisions.changes.indexOf(this.revision)),this.owner.selectionModule.selectTableRevision(e)):(this.owner.selectionModule.selectRevision(this.revision),this.trackChangesPane.onSelection(this.revision))},pd.prototype.layoutElementText=function(e,t){for(var i="",n=!(t.style.width="100%"),r=!1,o=0;o<e.length;o++){var s,a,l=e[o];if(l instanceof Z&&1===l.fieldType)n=!1;else if((r=l instanceof Z&&0===l.fieldType&&(s=this.owner.selectionModule.getFieldCode(l)).match("HYPERLINK ")&&e[e.indexOf(l.fieldEnd)-1]instanceof X?!0:r)&&l instanceof Z&&(2===l.fieldType||1===l.fieldType))r=n=!1;else if(!(n||l instanceof Lc))if(l instanceof Z&&0===l.fieldType&&(n=!0),l instanceof X)i+=l.text;else if(l instanceof Z&&0===l.fieldType){if((s=this.owner.selectionModule.getFieldCode(l)).match("TOC ")||s.match("Toc"))return i+="<Table of Content>",void t.appendChild(this.addSpan(i));s.match("HYPERLINK ")&&!r||s.match("MERGEFIELD")||s.match("FORMTEXT")||s.match("PAGE ")?i+=this.owner.editorModule.retrieveFieldResultantText(l.fieldEnd):l.formFieldData&&(d=this.owner.documentHelper.textHelper.repeatChar(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),5),""!==i&&(t.appendChild(this.addSpan(i)),i=""),l.formFieldData instanceof Ch?t.appendChild(this.addSpan(""===l.formFieldData.defaultValue?d:l.formFieldData.defaultValue,"e-de-tc-field")):l.formFieldData instanceof Sh?t.appendChild(this.addSpan(0<l.formFieldData.dropdownItems.length?l.formFieldData.dropdownItems[0]:d,"e-de-tc-field")):t.appendChild(this.addSpan(l.formFieldData.checked?String.fromCharCode(9745):String.fromCharCode(9744),"e-de-tc-field")))}else if(l instanceof Ic){""!==i&&(t.appendChild(this.addSpan(i)),i="");var d=_.createElement("img");d.setAttribute("src",this.owner.documentHelper.getImageString(l)),d.classList.add("e-de-tc-shrink-img"),t.appendChild(d)}else{if(l instanceof Ya){this.tableElement=_.createElement("table"),this.tableElement.classList.add("e-de-track-chng-table"),this.tableElement.insertRow();for(var h=0;h<l.ownerBase.childWidgets.length;h++)this.tableElement.rows[0].insertCell(),this.tableElement.rows[0].cells[h].classList.add("e-de-tc-tble-cell");return void t.appendChild(this.tableElement)}l instanceof B&&(""!==i&&(t.appendChild(this.addSpan(i)),i=""),a="¶",l.ownerBase instanceof G&&l.ownerBase.isEndsWithPageBreak&&(a="............Page Break............"+a),t.appendChild(this.addSpan(a,"e-de-tc-pmark")),t.appendChild(_.createElement("br")))}}t.appendChild(this.addSpan(i))},pd.prototype.addSpan=function(e,t){var i=_.createElement("span");return i.textContent=e,t&&i.classList.add(t),i},pd.prototype.acceptButtonClick=function(){this.revision.accept(),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget()},pd.prototype.rejectButtonClick=function(){this.revision.reject(),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget()},pd.prototype.removeFromParentCollec=function(){this.trackChangesPane.changes.containsKey(this.revision)&&this.trackChangesPane.changes.remove(this.revision),-1!==this.trackChangesPane.revisions.indexOf(this.revision)&&this.trackChangesPane.revisions.splice(this.trackChangesPane.revisions.indexOf(this.revision),1),0===this.trackChangesPane.changes.length&&(this.trackChangesPane.setNoChangesVisibility=!0),this.trackChangesPane.updateUsers()},pd.prototype.clear=function(){this.removeFromParentCollec(),this.acceptButton&&(this.acceptButton.destroy(),this.acceptButton=void 0),this.rejectButton&&(this.rejectButton.destroy(),this.rejectButton=void 0),this.acceptButtonElement&&(this.acceptButtonElement.innerHTML="",this.acceptButtonElement.parentElement&&this.acceptButtonElement.parentElement.removeChild(this.acceptButtonElement),this.acceptButtonElement=void 0),this.rejectButtonElement&&(this.rejectButtonElement.innerHTML="",this.rejectButtonElement.parentElement&&this.rejectButtonElement.parentElement.removeChild(this.rejectButtonElement),this.rejectButtonElement=void 0),this.tableElement&&(this.tableElement.innerHTML="",this.tableElement.parentElement&&this.tableElement.parentElement.removeChild(this.tableElement),this.tableElement=void 0),this.singleInnerDiv&&(this.singleInnerDiv.innerHTML="",this.singleInnerDiv.parentElement&&this.singleInnerDiv.parentElement.removeChild(this.singleInnerDiv),this.singleInnerDiv=void 0),this.outerSingleDiv&&(this.outerSingleDiv.innerHTML="",this.outerSingleDiv.parentElement&&this.outerSingleDiv.parentElement.removeChild(this.outerSingleDiv),this.outerSingleDiv=void 0)},pd.prototype.destroy=function(){this.acceptButton&&(this.acceptButton.destroy(),this.acceptButton=void 0),this.rejectButton&&(this.rejectButton.destroy(),this.rejectButton=void 0),this.acceptButtonElement&&(this.acceptButtonElement.innerHTML="",this.acceptButtonElement.parentElement&&this.acceptButtonElement.parentElement.removeChild(this.acceptButtonElement),this.acceptButtonElement=void 0),this.rejectButtonElement&&(this.rejectButtonElement.innerHTML="",this.rejectButtonElement.parentElement&&this.rejectButtonElement.parentElement.removeChild(this.rejectButtonElement),this.rejectButtonElement=void 0),this.tableElement&&(this.tableElement.innerHTML="",this.tableElement.parentElement&&this.tableElement.parentElement.removeChild(this.tableElement),this.tableElement=void 0),this.singleInnerDiv&&(this.singleInnerDiv.innerHTML="",this.singleInnerDiv.parentElement&&this.singleInnerDiv.parentElement.removeChild(this.singleInnerDiv),this.singleInnerDiv=void 0),this.outerSingleDiv&&(this.outerSingleDiv.innerHTML="",this.outerSingleDiv.parentElement&&this.outerSingleDiv.parentElement.removeChild(this.outerSingleDiv),this.outerSingleDiv=void 0),this.revision=void 0,this.user=void 0,this.revisionType=void 0,this.trackChangesPane=void 0,this.owner=void 0};var cd=pd;function pd(e,t){this.owner=e,this.locale=new _.L10n("documenteditor",this.owner.defaultLocale),this.locale.setLocale(this.owner.locale),this.trackChangesPane=t}Object.defineProperty(gd.prototype,"fontTypeface",{get:function(){return this.fntTypeface},set:function(e){this.fntTypeface=e},enumerable:!0,configurable:!0}),Object.defineProperty(gd.prototype,"fontSchemeList",{get:function(){return this.fntSchemeList},set:function(e){this.fntSchemeList=e},enumerable:!0,configurable:!0}),gd.prototype.copyFormat=function(e){_.isNullOrUndefined(e)||(this.fntTypeface=e.fntTypeface,this.fntSchemeList=e.fntSchemeList)},gd.prototype.destroy=function(){this.fntTypeface=void 0,this.fntSchemeList=void 0};var ud=gd;function gd(){this.fntTypeface=new T,this.fntSchemeList=[],this.fntTypeface=new T,this.fntSchemeList=[]}Object.defineProperty(fd.prototype,"fontSchemeName",{get:function(){return this.schemeName},set:function(e){this.schemeName=e},enumerable:!0,configurable:!0}),Object.defineProperty(fd.prototype,"majorFontScheme",{get:function(){return this.majFontScheme},set:function(e){this.majFontScheme=e},enumerable:!0,configurable:!0}),Object.defineProperty(fd.prototype,"minorFontScheme",{get:function(){return this.minFontScheme},set:function(e){this.minFontScheme=e},enumerable:!0,configurable:!0}),fd.prototype.copyFormat=function(e){_.isNullOrUndefined(e)||(this.schemeName=e.schemeName,this.majFontScheme.copyFormat(e.majFontScheme),this.minFontScheme.copyFormat(e.minFontScheme))},fd.prototype.destroy=function(){this.schemeName=void 0,this.majFontScheme=void 0,this.minFontScheme=void 0};var md=fd;function fd(e){this.majFontScheme=new ud,this.minFontScheme=new ud}Object.defineProperty(vd.prototype,"name",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),Object.defineProperty(vd.prototype,"typeface",{get:function(){return this.fontTypeface},set:function(e){this.fontTypeface=e},enumerable:!0,configurable:!0}),Object.defineProperty(vd.prototype,"panose",{get:function(){return this.pnose},set:function(e){this.pnose=e},enumerable:!0,configurable:!0}),vd.prototype.copyFormat=function(e){_.isNullOrUndefined(e)||(this.fontName=e.fontName,this.fontTypeface=e.fontTypeface,this.pnose=e.panose)},vd.prototype.destroy=function(){this.fontName=void 0,this.fontTypeface=void 0,this.pnose=void 0};var yd=vd;function vd(){}Object.defineProperty(bd.prototype,"fontScheme",{get:function(){return this.fntScheme},set:function(e){this.fntScheme=e},enumerable:!0,configurable:!0}),bd.prototype.copyFormat=function(e){_.isNullOrUndefined(e)||this.fntScheme.copyFormat(e.fntScheme)},bd.prototype.destroy=function(){this.fntScheme=void 0};var wd=bd;function bd(e){this.fntScheme=new md}xd=function(e,t){return(xd=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}))(e,t)};var xd,pl=function(e,t){function i(){this.constructor=e}xd(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},Cd=function(o,s,a,l){return new(a=a||Promise)(function(e,t){function i(e){try{r(l.next(e))}catch(e){t(e)}}function n(e){try{r(l.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},Id=function(n,r){var o,s,a,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,s=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))l.label=t[1];else if(6===t[0]&&l.label<a[1])l.label=a[1],a=t;else{if(!(a&&l.label<a[2])){a[2]&&l.ops.pop(),l.trys.pop();continue}l.label=a[2],l.ops.push(t)}}t=r.call(n,l)}catch(e){t=[6,e],s=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},kd=(Object.defineProperty(n.prototype,"visibleBounds",{get:function(){return this.visibleBoundsIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"containerCanvas",{get:function(){return _.isNullOrUndefined(this.containerCanvasIn)&&(this.containerCanvasIn=document.createElement("canvas"),this.containerCanvasIn.getContext("2d").save()),_.isNullOrUndefined(this.pageContainer)||this.containerCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.containerCanvasIn),this.containerCanvasIn},enumerable:!0,configurable:!0}),n.prototype.openTextFile=function(e){this.layout.isTextFormat=!0;for(var t=[],i=(t=(e=e.replace(/\r\n/g,"\n")).split("\n"),new z),n=(i.sectionFormat=new Ma(i),i.childWidgets=[],new G),r=new uh(n),o=0;o<t.length;o++)if(o===t.length-1&&0===t[o].length)n.childWidgets.push(r),(n.containerWidget=i).childWidgets.push(n);else{var s=new G,a=new uh(s);if(0<t[o].length)if(90<t[o].length)for(var l=0,d=90,h=void 0,c=t[o].length/90+1,p=0;p<c;){c-1!=p||(d=t[o].length%90);var u,h=t[o].substring(l,d);(u=new X).text=h,a.children.push(u),u.line=a,p++,d+=90,l+=90}else(u=new X).text=t[o],a.children.push(u),u.line=a;s.childWidgets.push(a),(s.containerWidget=i).childWidgets.push(s)}this.onDocumentChanged([i]),this.layout.isTextFormat=!1},Object.defineProperty(n.prototype,"selectionCanvas",{get:function(){return _.isNullOrUndefined(this.selectionCanvasIn)&&(this.selectionCanvasIn=document.createElement("canvas"),this.selectionCanvas.getContext("2d").save()),_.isNullOrUndefined(this.pageContainer)||this.selectionCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.selectionCanvasIn),this.selectionCanvasIn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"containerContext",{get:function(){return this.containerCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentRenderingPage",{get:function(){if(0!==this.pages.length)return this.pages[this.pages.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"zoomFactor",{get:function(){return this.zoomFactorInternal},set:function(e){this.zoomFactorInternal!==e&&(this.preZoomFactor=this.zoomFactor,this.zoomFactorInternal=e,this.zoomModule.setZoomFactor(),this.owner.zoomFactor=e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selection",{get:function(){return this.owner.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionStartPage",{get:function(){return this.selectionStartPageIn},set:function(e){this.selectionStartPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionEndPage",{get:function(){return this.selectionEndPageIn},set:function(e){this.selectionEndPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dialog",{get:function(){return this.dialogInternal||this.initDialog(this.owner.enableRtl),this.dialogInternal},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dialog2",{get:function(){return this.dialogInternal2||this.initDialog2(this.owner.enableRtl),this.dialogInternal2},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dialog3",{get:function(){return this.dialogInternal3||this.initDialog3(this.owner.enableRtl),this.dialogInternal3},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentSelectedComment",{get:function(){return this.currentSelectedCommentInternal},set:function(e){this.owner&&this.owner.commentReviewPane&&(this.owner.commentReviewPane.previousSelectedComment=this.currentSelectedCommentInternal),this.currentSelectedCommentInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(e){this.currentSelectedRevisionInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isInlineFormFillProtectedMode",{get:function(){return this.isFormFillProtectedMode&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isFormFillProtectedMode",{get:function(){return this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isCommentOnlyMode",{get:function(){return this.isDocumentProtected&&"CommentsOnly"===this.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isTrackedOnlyMode",{get:function(){return this.isDocumentProtected&&"RevisionsOnly"===this.protectionType},enumerable:!0,configurable:!0}),n.prototype.initalizeStyles=function(){this.preDefinedStyles.add("Normal",'{"type":"Paragraph","name":"Normal","next":"Normal"}'),this.preDefinedStyles.add("Heading 1",'{"type":"Paragraph","name":"Heading 1","basedOn":"Normal","next":"Normal","link":"Heading 1 Char","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":12.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level1"}}'),this.preDefinedStyles.add("Heading 2",'{"type":"Paragraph","name":"Heading 2","basedOn":"Normal","next":"Normal","link":"Heading 2 Char","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level2"}}'),this.preDefinedStyles.add("Heading 3",'{"type":"Paragraph","name":"Heading 3","basedOn":"Normal","next":"Normal","link":"Heading 3 Char","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level3"}}'),this.preDefinedStyles.add("Heading 4",'{"type":"Paragraph","name":"Heading 4","basedOn":"Normal","next":"Normal","link":"Heading 4 Char","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level4"}}'),this.preDefinedStyles.add("Heading 5",'{"type":"Paragraph","name":"Heading 5","basedOn":"Normal","next":"Normal","link":"Heading 5 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level5"}}'),this.preDefinedStyles.add("Heading 6",'{"type":"Paragraph","name":"Heading 6","basedOn":"Normal","next":"Normal","link":"Heading 6 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level6"}}'),this.preDefinedStyles.add("Heading 7",'{"type":"Paragraph","name":"Heading 7","basedOn":"Normal","next":"Normal","link":"Heading 7 Char","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level7"}}'),this.preDefinedStyles.add("Heading 8",'{"type":"Paragraph","name":"Heading 8","basedOn":"Normal","next":"Normal","link":"Heading 8 Char","characterFormat":{"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level8"}}'),this.preDefinedStyles.add("Heading 9",'{"type":"Paragraph","name":"Heading 9","basedOn":"Normal","next":"Normal","link":"Heading 9 Char","characterFormat":{"fontSize":10.5,"italic":true,"fontFamily":"Calibri Light","fontColor":"#333333"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level9"}}'),this.preDefinedStyles.add("Default Paragraph Font",'{"type":"Character","name":"Default Paragraph Font"}'),this.preDefinedStyles.add("Heading 1 Char",'{"type":"Character","name":"Heading 1 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 2 Char",'{"type":"Character","name":"Heading 2 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 3 Char",'{"type":"Character","name":"Heading 3 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor": "#1F3763"}}'),this.preDefinedStyles.add("Heading 4 Char",'{"type":"Character","name":"Heading 4 Char","basedOn":"Default Paragraph Font","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 5 Char",'{"type":"Character","name":"Heading 5 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 6 Char",'{"type":"Character","name":"Heading 6 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"}}'),this.preDefinedStyles.add("Heading 7 Char",'{"type":"Character","name":"Heading 7 Char","basedOn":"Default Paragraph Font","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#1F3763"}}'),this.preDefinedStyles.add("Heading 8 Char",'{"type":"Character","name":"Heading 8 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333"}}'),this.preDefinedStyles.add("Heading 9 Char",'{"type":"Character","name":"Heading 9 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":10.5,"italic":true,"fontFamily":"Calibri Light","fontColor":"#333333"}}'),this.preDefinedStyles.add("Hyperlink",'{"type":"Character","name":"Hyperlink","basedOn":"Default Paragraph Font","next":"Normal","characterFormat":{"fontColor":"#0563C1","underline": "Single"}}'),this.preDefinedStyles.add("TOC 1",'{"type":"Paragraph","name":"TOC 1","basedOn":"Normal","next":"Normal","paragraphFormat":{"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 2",'{"type":"Paragraph","name":"TOC 2","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :11.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 3",'{"type":"Paragraph","name":"TOC 3","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :22.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 4",'{"type":"Paragraph","name":"TOC 4","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :33.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 5",'{"type":"Paragraph","name":"TOC 5","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :44.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 6",'{"type":"Paragraph","name":"TOC 6","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :55.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 7",'{"type":"Paragraph","name":"TOC 7","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :66.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 8",'{"type":"Paragraph","name":"TOC 8","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :77.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 9",'{"type":"Paragraph","name":"TOC 9","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :88.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Header",'{"type":"Paragraph","name":"Header","basedOn":"Normal","next":"Header","paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple"}}'),this.preDefinedStyles.add("Footer",'{"type":"Paragraph","name":"Footer","basedOn":"Normal","next":"Footer","paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple"}}')},n.prototype.clearDocumentItems=function(){this.owner.editorModule&&this.owner.editorModule.clear(),this.owner.searchModule&&this.owner.searchModule.clearSearchHighlight(),this.owner.selectionModule&&this.owner.selectionModule.clear(),this.editRanges.clear(),this.headersFooters=[],this.fields=[],this.formFields=[],this.currentSelectedComment=void 0,this.currentSelectedRevision=void 0;for(var e=0;e<this.comments.length;e++){var t=this.comments[e].commentStart;t&&t.destroy()}if(this.comments=[],this.bookmarks.clear(),this.endBookmarksUpdated=[],this.styles.clear(),this.stylesMap.clear(),this.pages&&0<this.pages.length){for(e=0;e<this.pages.length;e++)this.pages[e].componentDestroy();this.pages=[]}if(this.authors.clear(),this.revisionsInternal.clear(),this.owner.revisions.clear(),this.characterFormat.clearFormat(),this.themeFontLanguage.clearFormat(),this.paragraphFormat.clearFormat(),this.owner.trackChangesPane&&this.owner.trackChangesPane.clear(),this.setDefaultCharacterValue(this.characterFormat),this.setDefaultParagraphValue(this.paragraphFormat),this.owner.commentReviewPane&&this.owner.commentReviewPane.clear(),this.isHeaderFooter=!1,this.defaultTabWidth=36,this.isDocumentProtected=!1,this.protectionType="NoProtection",this.restrictFormatting=!1,this.hashValue="",this.saltValue="",this.userCollection=[],this.formFillPopup&&this.formFillPopup.hidePopup(),this.contentDropDown&&this.contentDropDown.hidePopup(),this.customXmlData.clear(),this.fontSubstitutionTable.clear(),this.images.clear(),this.contentControlCollection=[],this.backgroundColor="#FFFFFF",this.endnotes.clear(),this.footnotes.clear(),this.footnoteCollection=[],this.endnoteCollection=[],this.lists&&0<this.lists.length)for(e=0;e<this.lists.length;e++)this.lists[e].clear();this.lists=[],this.abstractLists=[],this.themes=new wd,this.hasThemes=!1,this.isRestartNumbering=!1},n.prototype.setDefaultDocumentFormat=function(){this.owner.parser.parseCharacterFormat(0,this.owner.characterFormat,this.characterFormat),this.owner.parser.parseParagraphFormat(0,this.owner.paragraphFormat,this.paragraphFormat)},n.prototype.setDefaultCharacterValue=function(e){e.bold=!1,e.italic=!1,e.fontFamily="Calibri",e.fontSize=11,e.underline="None",e.strikethrough="None",e.fontSizeBidi=11,e.fontFamilyBidi="Calibri",e.baselineAlignment="Normal",e.highlightColor="NoColor",e.allCaps=!1},n.prototype.setDefaultParagraphValue=function(e){e.leftIndent=0,e.rightIndent=0,e.firstLineIndent=0,e.textAlignment="Left",e.beforeSpacing=0,e.afterSpacing=0,e.lineSpacing=1,e.lineSpacingType="Multiple",e.bidi=!1,e.keepWithNext=!1,e.keepLinesTogether=!1,e.widowControl=!0,e.outlineLevel="BodyText"},n.prototype.getAbstractListById=function(e,t){if(!_.isNullOrUndefined(this.abstractLists))for(var i=0;i<this.abstractLists.length;i++){var n=this.abstractLists[i];if(!_.isNullOrUndefined(n)){if(t&&n.nsid===e)return n;if(n.abstractListId===e)return n}}},n.prototype.getListById=function(e,t){if(!_.isNullOrUndefined(this.lists))for(var i=0;i<this.lists.length;i++){var n=this.lists[i];if(!_.isNullOrUndefined(n)){if(t&&n.nsid===e)return n;if(n.listId===e)return n}}},n.getListLevelNumber=function(e){return e.ownerBase instanceof Wl?e.ownerBase.levelNumber:e.ownerBase instanceof Hl&&!_.isNullOrUndefined(e.ownerBase.levels)?e.ownerBase.levels.indexOf(e):-1},n.prototype.getImageString=function(e){var t=this.images.get(parseInt(e.imageString)),e=e.isMetaFile&&".svg"!==j.formatClippedString(t[0]).extension||".tif"===j.formatClippedString(t[0]).extension?t[1]:t[0];return e},n.prototype.addBase64StringInCollection=function(a){return Cd(this,void 0,void 0,function(){var t,i,n,r,o,s;return Id(this,function(e){for(t=0<this.images.length?Math.max.apply(Math,this.images.keys)+1:0,i=!0,n=[],r=0;r<this.images.length;r++){if(o=this.images.keys[parseInt(r.toString(),10)],s=this.images.get(o),a.isMetaFile&&a.metaFileImageString===s[0]){t=o,i=!1;break}if(a.imageString===s[0]){t=o,i=!1;break}}return i&&(a.isMetaFile?(n.push(a.metaFileImageString),n.push(""===a.imageString?a.metaFileImageString:a.imageString)):n.push(a.imageString),this.images.add(t,n)),a.isMetaFile&&(a.metaFileImageString=t.toString()),a.imageString=t.toString(),[2]})})},n.prototype.getBookmarks=function(e){for(var t=[],i=0;i<this.bookmarks.keys.length;i++){var n=this.bookmarks.keys[i];!e&&0===n.indexOf("_")||t.push(n)}return t},n.prototype.selectComment=function(e){var t=this;this.owner.selectionModule&&this.owner.commentReviewPane&&(this.owner.showComments=!0,setTimeout(function(){t.owner&&t.owner.selectionModule&&t.owner.selectionModule.selectComment(e)}))},n.prototype.showComments=function(e){this.owner&&e&&this.owner.enableComment&&this.owner.trigger(ve,{type:"Comment"}),this.owner.commentReviewPane.reviewTab.hideTab(0,!1),this.owner.commentReviewPane.reviewTab.hideTab(1,!1),this.owner.commentReviewPane.showHidePane(e&&this.owner.enableComment,"Comments")},n.prototype.showRevisions=function(e){this.showRevision=e,this.owner&&e&&this.owner.trigger(ve,{type:"comment"}),!e&&this.owner.showComments?(this.owner.commentReviewPane.reviewTab.hideTab(0,!1),this.owner.commentReviewPane.showHidePane(!0,"Comments")):(this.owner.commentReviewPane.showHidePane(e,"Changes"),this.owner.enableComment,this.showRevision=!1),e&&this.owner.trackChangesPane.enableDisableButton(!this.owner.isReadOnly&&!this.isDocumentProtected)},n.prototype.initializeComponents=function(){var e,t=this.owner.element;_.isNullOrUndefined(t)||(this.optionsPaneContainer=_.createElement("div",{className:"e-documenteditor-optionspane"}),this.optionsPaneContainer.contentEditable="false",t.appendChild(this.optionsPaneContainer),this.owner.enableRtl&&(e="direction:ltr;"),this.viewerContainer=_.createElement("div",{id:this.owner.containerId+"_viewerContainer"}),this.viewerContainer.style.cssText="position:relative;backgroundColor:#FBFBFB;overflow:auto;"+e,this.optionsPaneContainer.appendChild(this.viewerContainer),this.viewerContainer.tabIndex=-1,this.viewerContainer.style.outline="none",this.pageContainer=_.createElement("div",{id:this.owner.containerId+"_pageContainer",className:"e-de-background"}),this.viewerContainer.appendChild(this.pageContainer),this.pageContainer.style.top="0px",this.pageContainer.style.left="0px",this.pageContainer.style.position="relative",this.pageContainer.style.pointerEvents="none",_.Browser.isDevice?this.createEditableDiv(t):this.createEditableIFrame(),this.owner.enableImageResizerMode&&this.owner.imageResizerModule.initializeImageResizer(),this.updateViewerSizeInternal(t),this.layout=new Ml(this),this.textHelper=new Bl(this),this.zoomModule=new Xl(this),this.initTouchEllipse(),this.wireEvent(),this.restrictEditingPane=new nd(this),this.owner.commentReviewPane=new Iu(this.owner),this.owner.trackChangesPane=new dd(this.owner,this.owner.commentReviewPane),C.createSpinner({target:this.owner.element,cssClass:"e-spin-overlay"}))},n.prototype.measureScrollbarWidth=function(e){var t=document.createElement("div"),e=(t.setAttribute("style","visibility:hidden;overflow:scroll"),e.appendChild(t),document.createElement("div"));t.appendChild(e),this.scrollbarWidth=t.getBoundingClientRect().width-e.getBoundingClientRect().width,t.parentNode.removeChild(t)},n.prototype.createEditableDiv=function(e){this.editableDiv=document.createElement("div"),this.editableDiv.contentEditable=this.owner.isReadOnlyMode?"false":"true",this.editableDiv.style.position="fixed",this.editableDiv.style.left="-150em",this.editableDiv.style.width="100%",this.editableDiv.style.height="100%",this.editableDiv.id=e.id+"_editableDiv",document.body.appendChild(this.editableDiv)},n.prototype.createEditableIFrame=function(){this.iframe=_.createElement("iframe",{attrs:{scrolling:"no",title:"Document Editor",style:"pointer-events:none;position:absolute;left:0px;top:0px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden",tabindex:"0"},className:"e-de-text-target"}),this.viewerContainer.appendChild(this.iframe),this.initIframeContent()},n.prototype.initIframeContent=function(){var e="background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;",e='<!DOCTYPE html><html lang="'+this.owner.locale+'"><head></head><body spellcheck="false" style='+e+' ><div contenteditable="true" style='+e+"></div></body></html>";_.isNullOrUndefined(this.iframe.contentDocument)||(this.iframe.contentDocument.open(),this.iframe.contentDocument.write(e),this.iframe.contentDocument.close(),this.editableDiv=this.iframe.contentDocument.body.children[0])},n.prototype.wireEvent=function(){_.isNullOrUndefined(this.owner.selectionModule)||this.selection.initCaret(),this.wireInputEvents(),_.isNullOrUndefined(this.iframe)||this.iframe.addEventListener("load",this.onIframeLoad.bind(this)),this.viewerContainer.addEventListener("scroll",this.scrollHandler),this.viewerContainer.addEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.addEventListener("keydown",this.onKeyDownInternal),this.viewerContainer.addEventListener("mousemove",this.onMouseMoveInternal),this.viewerContainer.addEventListener("mouseleave",this.onMouseLeaveInternal),this.viewerContainer.addEventListener("mouseenter",this.onMouseEnterInternal),this.viewerContainer.addEventListener("contextmenu",this.onContextMenu),this.viewerContainer.addEventListener("dblclick",this.onDoubleTap),this.viewerContainer.addEventListener("mouseup",this.onMouseUpInternal),window.addEventListener("resize",this.onWindowResize),window.addEventListener("keyup",this.onKeyUpInternal),window.addEventListener("mouseup",this.onImageResizer),window.addEventListener("touchend",this.onImageResizer),window.addEventListener("copy",this.onCopy),this.viewerContainer.addEventListener("touchstart",this.onTouchStartInternal),this.viewerContainer.addEventListener("touchmove",this.onTouchMoveInternal),this.viewerContainer.addEventListener("touchend",this.onTouchUpInternal),void 0!==navigator&&navigator.userAgent.match("Firefox")&&this.viewerContainer.addEventListener("DOMMouseScroll",this.zoomModule.onMouseWheelInternal),this.viewerContainer.addEventListener("mousewheel",this.zoomModule.onMouseWheelInternal),this.editableDiv.addEventListener("focus",this.updateFocus)},n.prototype.wireInputEvents=function(){_.isNullOrUndefined(this.editableDiv)||(this.editableDiv.addEventListener("paste",this.onPaste),_.Browser.isDevice?this.editableDiv.addEventListener("input",this.onTextInputInternal):(this.editableDiv.addEventListener("keypress",this.onKeyPressInternal),"chrome"===_.Browser.info.name&&this.editableDiv.addEventListener("textInput",this.onTextInput)),this.editableDiv.addEventListener("blur",this.onFocusOut),this.editableDiv.addEventListener("keydown",this.onKeyDownInternal),this.editableDiv.addEventListener("compositionstart",this.compositionStart),this.editableDiv.addEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.addEventListener("compositionend",this.compositionEnd))},n.prototype.onIframeLoad=function(){_.isNullOrUndefined(this.iframe)||0!==this.iframe.contentDocument.body.children.length||(this.initIframeContent(),this.wireInputEvents())},n.prototype.getEditableDivTextContent=function(){return this.editableDiv.textContent},n.prototype.updateAuthorIdentity=function(){for(var e=this.owner.revisions.changes,t=0;t<e.length;t++)this.getAuthorColor(e[t].author)},n.prototype.getAvatar=function(e,t,i,n){var r,o,s;_.isNullOrUndefined(i)?o=n.author:(o=i.author,r=i.initial),_.isNullOrUndefined(o)||(n=_.createElement("div",{className:"e-de-cmt-avatar"}),(i=_.createElement("div",{className:"e-de-ff-cmt-avatar"})).style.backgroundColor=this.owner.documentHelper.getAuthorColor(o),""===r||_.isNullOrUndefined(r)?(s=(o=o.split(" "))[0].charAt(0),1<o.length&&""!==o[o.length-1]&&(s+=o[o.length-1][0]),i.innerText=s.toUpperCase()):2<r.length?i.innerText=r.substring(0,2):i.innerText=r,n.appendChild(i),n.appendChild(t),e.appendChild(n))},n.prototype.getAuthorColor=function(e){var t;return this.authors.containsKey(e)?this.authors.get(e):(t=0===this.authors.length?"#b5082e":this.generateRandomColor(),this.authors.add(e,t),t)},n.prototype.generateRandomColor=function(){return["#b5082e","#2e97d3","#bb00ff","#f37e43","#03a60b","#881824","#e09a2b","#50565e"][this.authors.length%8]},n.prototype.positionEditableTarget=function(){var e=this.selection.getRect(this.selection.start),t=this.selection.getSelectionPage(this.selection.start),i=t.bodyWidgets[0].sectionFormat,t=t.boundingRectangle.x+j.convertPointToPixel(i.leftMargin)*this.zoomFactor,n=e.y,i=i.pageWidth-i.leftMargin-i.rightMargin,r="left:"+t+"px;",r=(r+="top:"+n+"px;")+"width:"+j.convertPointToPixel(i)*this.zoomFactor+"px;";this.iframe.setAttribute("style",r+="height:250px;outline-style:none;position:absolute");n=(n=(n=(n="background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;")+"text-indent:"+(e.x-t)+"px;color:transparent;pointer-events:none;outline-style:none;")+"font-size:"+j.convertPointToPixel(this.selection.characterFormat.fontSize)*this.zoomFactor+"px;")+"font-family"+this.selection.characterFormat.fontFamily+";";this.editableDiv.setAttribute("style",n+="overflow:hidden;text-decoration:none;white-space:normal;")},n.prototype.initDialog=function(e){this.dialogInternal||(this.dialogTarget1=_.createElement("div",{className:"e-de-dlg-target"}),this.dialogTarget1.contentEditable="false",document.body.appendChild(this.dialogTarget1),e&&this.dialogTarget1.classList.add("e-de-rtl"),this.dialogInternal=new C.Dialog({target:this.owner.documentEditorSettings.popupTarget,showCloseIcon:!0,allowDragging:!0,enableRtl:e,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"center"},zIndex:this.owner.zIndex+20,animationSettings:{effect:"None"}}),this.dialogInternal.isStringTemplate=!0,this.dialogInternal.open=this.selection.hideCaret,this.dialogInternal.beforeClose=this.updateFocus,this.dialogInternal.appendTo(this.dialogTarget1))},n.prototype.initDialog3=function(e){this.dialogInternal3||(this.dialogTarget3=_.createElement("div",{className:"e-de-dlg-target"}),this.dialogTarget3.contentEditable="false",document.body.appendChild(this.dialogTarget3),e&&this.dialogTarget3.classList.add("e-de-rtl"),this.dialogInternal3=new C.Dialog({target:this.owner.documentEditorSettings.popupTarget,showCloseIcon:!0,allowDragging:!0,enableRtl:e,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"center"},zIndex:this.owner.zIndex,animationSettings:{effect:"None"}}),this.dialogInternal3.isStringTemplate=!0,this.dialogInternal3.open=this.selection.hideCaret,this.dialogInternal3.beforeClose=this.updateFocus,this.dialogInternal3.appendTo(this.dialogTarget3))},n.prototype.hideDialog=function(){this.dialog.hide(),this.updateFocus()},n.prototype.initDialog2=function(e){this.dialogInternal2||(this.dialogTarget2=_.createElement("div",{className:"e-de-dlg-target"}),this.dialogTarget2.contentEditable="false",document.body.appendChild(this.dialogTarget2),e&&this.dialogTarget2.classList.add("e-de-rtl"),this.dialogInternal2=new C.Dialog({target:this.owner.documentEditorSettings.popupTarget,showCloseIcon:!0,allowDragging:!0,enableRtl:e,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"Top"},zIndex:this.owner.zIndex+10}),this.dialogInternal2.isStringTemplate=!0,this.dialogInternal2.appendTo(this.dialogTarget2))},n.prototype.getBase64=function(t,o,s){return Cd(this,void 0,void 0,function(){return Id(this,function(e){return[2,new Promise(function(n,e){var r=new Image;r.onload=function(){var e=Math.max(1,window.devicePixelRatio||1),t=document.createElement("canvas"),i=(t.width=o*e,t.height=s*e,t.getContext("2d")),e=(i.scale(e,e),i.drawImage(r,0,0,o,s),t.toDataURL("image/png",1));n(e)},r.onerror=function(){e()},t&&(j.startsWith(t,"http://")||j.startsWith(t,"https://"))&&fetch(t).then(function(e){return e.blob()}).then(function(n){return new Promise(function(e,t){var i=new FileReader;i.onloadend=function(){return e(i.result)},i.onerror=t,i.readAsDataURL(n)})}).then(function(e){r.src=e}).catch(function(){e()})})]})})},n.prototype.clearContent=function(){if(this.containerContext.clearRect(0,0,this.containerCanvas.width,this.containerCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContainer)for(var e=this.pageContainer.getElementsByClassName("e-de-cmt-mark"),t=0;t<e.length;t++)e[t].style.display="none";if(this.pageContainer)for(var i=this.pageContainer.getElementsByClassName("e-de-lock-mark"),t=0;t<i.length;t++)i[t].style.display="none"},n.prototype.onDocumentChanged=function(e,t){var i=this;this.clearContent(),this.owner.editorModule&&(this.owner.editorModule.tocStyles={},this.owner.editorModule.tocBookmarkId=0),this.heightInfoCollection={},this.owner.isDocumentLoaded=!1,this.viewer.columnLayoutArea.clear(),this.layout.isDocumentContainsRtl=!1,this.layout.isMultiColumnDoc=!1,this.updateAuthorIdentity();for(var n=0;n<this.pages.length;n++)for(var r=0;r<this.pages[n].bodyWidgets.length;r++)this.pages[n].bodyWidgets[r].destroy();if(this.pages=[],_.isNullOrUndefined(this.renderedLists)||this.renderedLists.clear(),_.isNullOrUndefined(this.renderedLevelOverrides)||(this.renderedLevelOverrides=[]),_.isNullOrUndefined(this.owner.editorHistoryModule)||this.owner.editorHistoryModule.destroy(),this.owner.isDocumentLoaded=!0,this.owner.isUpdateTrackChanges=!1,this.layout.isInitialLoad=!0,this.layout.footHeight=0,this.layout.footnoteHeight=0,this.layout.layoutItems(e,!1),this.owner.selectionModule&&(this.selection.previousSelectedFormField=void 0,0<this.formFields.length&&this.owner.selectionModule.highlightFormFields(),this.owner.selectionModule.editRangeCollection=[],this.owner.selectionModule.selectRange(this.owner.documentStart,this.owner.documentStart),this.isDocumentProtected&&"FormFieldsOnly"==this.protectionType&&this.owner.selectionModule.navigateToNextFormField(),this.isDocumentProtected)&&this.restrictEditingPane.showHideRestrictPane(!0),!_.isNullOrUndefined(t)&&this.owner.editorModule&&this.owner.editorModule.intializeDefaultStyles(),this.owner.enableCollaborativeEditing&&this.owner.collaborativeEditingHandlerModule&&this.owner.enableEditor){if(this.owner.editorModule.isRemoteAction=!0,this.owner.editorModule.isIncrementalSave=!0,t&&!_.isNullOrUndefined(t[Ea[0]])&&!_.isNullOrUndefined(0<t[Ea[0]].length))for(var o=0;o<t[Ea[0]].length;o++)this.owner.collaborativeEditingHandlerModule.applyRemoteAction("action",t[Ea[0]][o]);this.owner.editorModule.isRemoteAction=!1,this.owner.editorModule.isIncrementalSave=!1,this.owner.selectionModule.selectRange(this.owner.documentStart,this.owner.documentStart)}this.owner.optionsPaneModule&&this.owner.optionsPaneModule.showHideOptionsPane(!1),this.restrictEditingPane.restrictPane&&!this.isDocumentProtected&&this.restrictEditingPane.showHideRestrictPane(!1),!_.isNullOrUndefined(this.owner.selectionModule)&&this.owner.selectionModule.isViewPasteOptions&&(this.owner.selectionModule.isViewPasteOptions=!1,this.owner.selectionModule.showHidePasteOptions(void 0,void 0)),this.owner.fireDocumentChange(),this.owner.showHideRulers(),setTimeout(function(){!_.isNullOrUndefined(i.owner)&&i.owner.showRevisions&&i.showRevisions(!0),_.isNullOrUndefined(i.owner)||(i.owner.isUpdateTrackChanges=!0)});e=document.getElementById("container_editorPICTURE_CONTENT_CONTROL");_.isNullOrUndefined(e)||this.owner.renderPictureContentControlElement(this.owner,!1,!1)},n.prototype.initTouchEllipse=function(){var e="height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5",t=" height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;box-sizing: unset;",i=(this.touchStart=_.createElement("div",{className:"e-touch-ellipse",styles:e}),_.createElement("div",{styles:t})),e=(this.touchEnd=_.createElement("div",{className:"e-touch-ellipse",styles:e}),this.touchStart.style.display="none",_.createElement("div",{styles:t}));this.touchStart.appendChild(i),this.touchEnd.appendChild(e),this.touchEnd.style.display="none",this.viewerContainer.appendChild(this.touchStart),this.viewerContainer.appendChild(this.touchEnd)},n.prototype.updateTouchMarkPosition=function(){var e,t,i;"none"===this.touchStart.style.display||_.isNullOrUndefined(this.selection)||(this.selection.isEmpty?this.selection.updateCaretPosition():(e=this.selection.getCaretBottom(this.selection.start,!1),i=(t=this.selection.getPage(this.selection.start.paragraph)).boundingRectangle.y-this.owner.viewer.pageGap*(this.pages.indexOf(t)+1)*this.zoomFactor+this.owner.viewer.pageGap*(this.pages.indexOf(t)+1),this.touchStart.style.left=t.boundingRectangle.x+(Math.round(this.selection.start.location.x)*this.zoomFactor-14)+"px",this.touchStart.style.top=i+e*this.zoomFactor+"px",this.selection.isEmpty||(e=this.selection.getCaretBottom(this.selection.end,!1),t=this.selection.getPage(this.selection.end.paragraph)),this.touchEnd.style.left=t.boundingRectangle.x+(Math.round(this.selection.end.location.x)*this.zoomFactor-14)+"px",this.touchEnd.style.top=i+e*this.zoomFactor+"px"))},n.prototype.autoScrollOnSelection=function(i){var n=this;this.scrollMoveTimer&&(i.y<=0||50<i.y||i.y<this.viewerContainer.offsetHeight-50)?(clearInterval(this.scrollMoveTimer),this.scrollMoveTimer=0):i.y<60?(clearInterval(this.scrollMoveTimer),this.scrollMoveTimer=setInterval(function(){n.viewerContainer.scrollTop-=20,setTimeout(function(){var e=n.owner.viewer.findFocusedPage(i,!n.owner.enableHeaderAndFooter),t=n.getLineWidget(e);n.selection.updateTextPosition(t,e)},200)},200)):i.y>this.viewerContainer.offsetHeight-70&&(clearInterval(this.scrollMoveTimer),this.scrollMoveTimer=setInterval(function(){n.viewerContainer.scrollTop+=20,setTimeout(function(){var e=n.owner.viewer.findFocusedPage(i,!n.owner.enableHeaderAndFooter),t=n.getLineWidget(e);n.selection.updateTextPosition(t,e)},200)},200))},n.prototype.scrollForwardOnSelection=function(e){var t;this.viewerContainer&&(this.viewerContainer.scrollTop=this.viewerContainer.scrollTop+200,e=this.owner.viewer.findFocusedPage(e,!this.owner.enableHeaderAndFooter),t=this.owner.selectionModule.end,this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||(this.skipScrollToPosition=!0,this.owner.selectionModule.moveTextPosition(e,t,!0)))},n.prototype.scrollBackwardOnSelection=function(e){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop-200;var e=this.owner.viewer.findFocusedPage(e,!this.owner.enableHeaderAndFooter),t=this.owner.selectionModule.end;this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||(this.skipScrollToPosition=!0,this.owner.selectionModule.moveTextPosition(e,t,!0))},n.prototype.navigateToEndNote=function(e,t,i){for(var n,r=this.pages.length-1;0<=r&&(n=this.pages[r].endnoteWidget,!_.isNullOrUndefined(n));){for(var o=0;o<n.bodyWidgets.length;o++)if(_.isNullOrUndefined(n.bodyWidgets[o].previousSplitWidget)){var s=n.bodyWidgets[o].footNoteReference;if(e.text===s.text){t.setPositionParagraph(n.bodyWidgets[o].childWidgets[0].childWidgets[0],0),i.setPositionParagraph(n.bodyWidgets[o].childWidgets[0].childWidgets[0],0),this.selection.selectRange(t,i);break}}r--}},n.prototype.moveSelectedContent=function(){this.isDragStarted=!1;var e,t,i,n=this.owner.editor.getSelectionInfo(!0),r=(this.owner.selection.start.paragraph.isInsideTable&&(n=this.owner.selection.updateSelectionInfo(n)),this.selection.getTextPosBasedOnLogicalIndex(n.start)),n=this.selection.getTextPosBasedOnLogicalIndex(n.end),r=this.selection.getParagraphInfo(r),n=this.selection.getParagraphInfo(n),o=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),s=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),a=this.selection.getTextPosBasedOnLogicalIndex(o),l=this.selection.getTextPosBasedOnLogicalIndex(s),d=this.selection.getHierarchicalIndex(this.dragStartParaInfo.paragraph,this.dragStartParaInfo.offset.toString()),h=this.selection.getHierarchicalIndex(this.dragEndParaInfo.paragraph,this.dragEndParaInfo.offset.toString()),d=this.selection.getTextPosBasedOnLogicalIndex(d),h=this.selection.getTextPosBasedOnLogicalIndex(h);a.isExistBefore(d)||l.isExistAfter(h)?(this.owner.editorModule.initComplexHistory("DragAndDropContent"),this.selection.start=d,this.selection.end=h,(e=this.owner.enableLocalPaste)||(this.owner.enableLocalPaste=!0),i=!1,((t=this.dragEndParaInfo.paragraph.getLength())<this.dragEndParaInfo.offset||!this.dragStartParaInfo.paragraph.equals(this.dragEndParaInfo.paragraph))&&(i=!0),this.owner.editorModule.cut(),this.dragEndParaInfo.paragraph.equals(r.paragraph)&&this.dragEndParaInfo.offset<r.offset&&!this.owner.enableTrackChanges&&(t-=this.dragEndParaInfo.paragraph.getLength(),r.offset-=t,n.offset-=t,o=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),s=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())),i&&this.dragEndParaInfo.paragraph.equals(n.paragraph)||(o=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),s=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())),a=this.selection.getTextPosBasedOnLogicalIndex(o),l=this.selection.getTextPosBasedOnLogicalIndex(s),this.selection.start=a,this.selection.end=l,this.owner.editorModule.copiedTextContent="",this.owner.editorModule.paste(),e||(this.owner.enableLocalPaste=!1),this.owner.editorHistoryModule.updateComplexHistory()):this.owner.selectionModule.selectPosition(d,h),this.dragStartParaInfo=void 0,this.dragEndParaInfo=void 0,this.selection.caret.classList.add("e-de-cursor-animation")},n.prototype.isSelectionInListText=function(e){var t=this.getLineWidget(e);if(!_.isNullOrUndefined(t)&&t.children[0]instanceof Y){var i=this.getLeftValue(t),n=t.children[0].width,r=t.children[0].height;if(this.isInsideRect(i,t.paragraph.y,n,r,e))return this.selectionLineWidget=t,!0}return!1},n.prototype.isInShapeBorder=function(e,t){if(!_.isNullOrUndefined(e)){var i=e.width,n=e.height;if(this.isInsideRect(e.x-e.margin.left,e.y-e.margin.top,i,n,t)){if(e instanceof Ic)return!0;if(e instanceof uc){var r=e.lineFormat.weight;if(!this.isInsideRect(e.x+r,e.y+r+e.textFrame.marginTop,i-2*r,n-(2*r+e.textFrame.marginTop+e.textFrame.marginBottom),t))return!0}}}return!1},n.prototype.isInsideRect=function(e,t,i,n,r){return r.x>e&&r.x<=e+i&&r.y>t&&r.y<=t+n},n.prototype.getLeftValue=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat,i=(this.selection.isParagraphFirstLine(e)&&("Right"===i.textAlignment?t=(t-=j.convertPointToPixel(i.firstLineIndent))-j.convertPointToPixel(i.leftIndent):t+=j.convertPointToPixel(i.firstLineIndent)),e.children[0]);return i instanceof Y&&(t+=i.margin.left),t},n.prototype.isLeftButtonPressed=function(e){return this.isTouchInput=!1,1===(e.which||e.button)},n.prototype.updateSelectionOnTouch=function(e,t){this.zoomX=void 0,this.zoomY=void 0,!this.isMouseDown||this.isSelectionChangedOnMouseMoved||_.isNullOrUndefined(this.currentPage)||_.isNullOrUndefined(this.owner.selectionModule.start)||(_.isNullOrUndefined(this.currentSelectedComment)||!this.owner.commentReviewPane||this.owner.commentReviewPane.commentPane.isEditMode||(this.currentSelectedComment=void 0),0===this.touchDownOnSelectionMark&&(this.updateTextPositionForSelection(new nl(t.x,t.y),this.tapCount),2===this.tapCount)&&this.selection.checkAndEnableHeaderFooter(e,t),this.owner.selectionModule.isEmpty&&this.selection.updateCaretPosition(),this.selection.checkForCursorVisibility())},n.prototype.getTouchOffsetValue=function(e){var t=this.viewerContainer.getBoundingClientRect(),i=e.touches[0],e=(i=_.isNullOrUndefined(i)?e.changedTouches[0]:i).clientX-t.left,i=i.clientY-t.top;return new nl(e,i)},n.prototype.onPinchInInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor-.01;t<5&&2<t&&(t-=.01),this.zoomFactor=t=t<.1?.1:t},n.prototype.onPinchOutInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor+.01;2<t&&(t+=.01),this.zoomFactor=t=5<t?5:t},n.prototype.getPageWidth=function(e){return e.boundingRectangle.width},n.prototype.removePage=function(e){this.currentPage===e&&(this.currentPage=void 0),e.headerWidgetIn&&(e.headerWidgetIn.page=void 0),e.footerWidgetIn&&(e.footerWidgetIn.page=void 0),e.headerWidget&&(e.headerWidget.page=void 0),e.footerWidget&&(e.footerWidget.page=void 0);for(var t,i=this.pages.indexOf(e),n=(-1<i&&this.pages.splice(i,1),_.isNullOrUndefined(this.owner.viewer.visiblePages)||-1<this.owner.viewer.visiblePages.indexOf(e)&&(t=this.owner.viewer.visiblePages.indexOf(e),this.owner.viewer.visiblePages.splice(t,1)),0);n<this.pages.length;n++)this.pages[n].boundingRectangle.height;e.boundingRectangle.height;var r=20;if(0<i&&(r+=this.pages[i-1].boundingRectangle.bottom),-1!==i)for(n=i;n<this.pages.length;n++)(e=this.pages[n]).boundingRectangle=new Rd(e.boundingRectangle.x,r,e.boundingRectangle.width,e.boundingRectangle.height),r=e.boundingRectangle.bottom+20,!(0<e.bodyWidgets.length)||_.isNullOrUndefined(e.bodyWidgets[0].firstChild)||e.bodyWidgets[0].firstChild instanceof K&&e.bodyWidgets[0].firstChild.header||(e.repeatHeaderRowTableWidget=!1)},n.prototype.updateViewerSize=function(){var t=this,e=this.owner.getDocumentEditorElement();this.updateViewerSizeInternal(e),this.owner.viewer.updateScrollBars(),this.owner.viewer instanceof Wd&&!_.isNullOrUndefined(this.owner)&&!_.isNullOrUndefined(e)&&(this.resizerTimer&&clearTimeout(this.resizerTimer),this.resizerTimer=setTimeout(function(){var e;_.isNullOrUndefined(t.owner)||(e=void 0,e=_.isNullOrUndefined(t.visibleBounds)?0:t.visibleBounds.width,_.isNullOrUndefined(t.owner.viewer.preVisibleWidth)&&(t.owner.viewer.preVisibleWidth=0),_.isNullOrUndefined(t.visibleBounds)||e===t.owner.viewer.preVisibleWidth||(t.owner.editorModule.layoutWholeDocument(),t.owner.viewer.preVisibleWidth=e),t.resizerTimer&&clearTimeout(t.resizerTimer))},50)),_.isNullOrUndefined(this.selection)||this.selection.updateCaretPosition()},n.prototype.triggerAutoResizeInterval=function(){var t=this,i=0,n=this.owner.element,e={cancel:!1},r=(this.owner.notify(Ee,e),(n=_.isNullOrUndefined(e.element)?n:e.element).style.visibility="hidden",C.showSpinner(n),0),e=this.owner.documentEditorSettings.autoResizeSettings.interval;this.isAutoResizeCanStart?i=setInterval(function(){r++;var e=t.owner.element.getBoundingClientRect();0!==e.width&&0!==e.height?(e={cancel:t.isAutoResizeCanStart=!1},t.owner.notify(Oe,e),clearInterval(i),e.cancel||t.owner.resize(),C.hideSpinner(n),n.style.visibility="visible"):r>t.owner.documentEditorSettings.autoResizeSettings.iterationCount&&(clearInterval(i),C.hideSpinner(n),n.style.visibility="visible")},e):(C.hideSpinner(n),n.style.visibility="visible")},n.prototype.updateViewerSizeInternal=function(e){var t,i,n,r,o,s,a;_.isNullOrUndefined(e)||(t=getComputedStyle(e),s=parseFloat(t.height.replace("px","")),t=parseFloat(t.width.replace("px","")),this.isAutoResizeCanStart=0===t&&0===s,i=(i=a=0)<s?s:200,s=this.restrictEditingPane&&this.restrictEditingPane.isShowRestrictPane?this.getComputedWidth(this.restrictEditingPane.restrictPane):void 0,n=this.owner.optionsPaneModule&&this.owner.optionsPaneModule.isOptionsPaneShow?this.getComputedWidth(this.owner.optionsPaneModule.optionsPane):void 0,r=0,this.owner.commentReviewPane&&this.owner.commentReviewPane.parentPaneElement&&(r=this.getComputedWidth(this.owner.commentReviewPane.parentPaneElement)),o=this.owner.xmlPaneModule&&this.owner.xmlPaneModule.isXmlPaneShow?this.getComputedWidth(this.owner.xmlPaneModule.element):void 0,a=s||n||r||o?(s=s||0,0<t-(s=(s+=n||0)+(r||0)+(o||0))?t-s:200):0<t?t:200,this.viewerContainer.style.height=i.toString()+"px",this.viewerContainer.style.width=Math.ceil(a)+"px",this.visibleBoundsIn=new Rd(0,0,a,i),this.containerCanvas.width=a,this.containerCanvas.height=i,this.containerCanvas.style.width=a+"px",this.containerCanvas.style.height=i+"px",this.selectionCanvas.width=a,this.selectionCanvas.height=i,this.selectionCanvas.style.width=a+"px",this.selectionCanvas.style.height=i+"px",this.measureScrollbarWidth(e))},n.prototype.getComputedWidth=function(e){e=getComputedStyle(e);return"block"===e.display?parseFloat(e.width.replace("px","")):0},n.prototype.insertPage=function(e,t){-1<this.pages.indexOf(t)&&this.pages.splice(this.pages.indexOf(t),1),this.pages.splice(e,0,t);var i=20;0<e&&(i+=this.pages[e-1].boundingRectangle.bottom);for(var n=e;n<this.pages.length;n++)(t=this.pages[n]).boundingRectangle=new Rd(t.boundingRectangle.x,i,t.boundingRectangle.width,t.boundingRectangle.height),i=t.boundingRectangle.bottom+20},n.prototype.updateTextPositionForSelection=function(e,t){var i=this.getLineWidget(e);_.isNullOrUndefined(i)||this.selection.updateTextPosition(i,e),1<t&&(this.isMouseDown=!1,this.useTouchSelectionMark=!1,0===this.pages.length||_.isNullOrUndefined(this.currentPage)||_.isNullOrUndefined(this.owner.selectionModule.start)||(t%2==0?this.owner.selectionModule.selectCurrentWord():this.isDragStarted||this.owner.selectionModule.selectParagraph()))},n.prototype.scrollToPosition=function(e,t,i,n){if(this.skipScrollToPosition||this.isWebPrinting||this.owner.editorModule&&this.owner.editorModule.isRemoteAction)this.skipScrollToPosition=!1;else if(!(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizing||this.isMouseDownInFooterRegion||this.isRowOrCellResizing)){var r=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!0);if(!_.isNullOrUndefined(r)){this.selection.getTop(r),(r=this.isMouseDown&&(a=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!1),o=this.selection.getTop(a),a!==r)&&t.location.y>=o?a:r).height;var o=this.selection.getPage(r.paragraph),s=(this.currentPage=o,0),a=0;this.owner.viewer instanceof Sd,this.owner.viewer;if(!_.isNullOrUndefined(o)){var r=o.boundingRectangle.width,a=((s=(this.visibleBounds.width-r*this.zoomFactor)/2)<30&&(s=30),o.boundingRectangle.y*this.zoomFactor+(this.pages.indexOf(o)+1)*this.owner.viewer.pageGap*(1-this.zoomFactor)),r=this.owner.viewer.containerTop,l=this.owner.viewer.containerLeft,d=this.visibleBounds.height,h=this.selection.updateCaretSize(this.owner.selectionModule.end,!0),c=h.topMargin,h=h.height,p=(s+=t.location.x*this.zoomFactor,a+=(t.location.y+c)*this.zoomFactor,n?this.viewerContainer.scrollTop=a-96:a<r+20?this.viewerContainer.scrollTop=a-10:r+d<a+h&&(this.viewerContainer.scrollTop=a+h-d+10),i||this.selection.updateCaretToPage(e,o),this.viewerContainer.offsetWidth-this.viewerContainer.clientWidth);if(s<l)this.viewerContainer.scrollLeft=s-this.pageContainer.offsetWidth/100*20;else if(l+this.visibleBounds.width<s+p)for(this.viewerContainer.scrollLeft=l+this.pageContainer.offsetWidth/100*15+p;s<this.owner.viewer.containerWidth&&this.viewerContainer.scrollLeft+this.visibleBounds.width<s+p&&(this.viewerContainer.scrollLeft=this.viewerContainer.scrollLeft+this.pageContainer.offsetWidth/100*15+p,0!==this.viewerContainer.scrollLeft););}}}},n.prototype.getLineWidget=function(e){return this.getLineWidgetInternal(e,!1)},n.prototype.getLineWidgetInternal=function(e,t){var i=void 0;if(!_.isNullOrUndefined(this.currentPage)){var n,r,o,s=void 0;if(this.owner.enableHeaderAndFooter)return u=(r=this.currentPage).boundingRectangle.height,n=Math.max(r.headerWidget.y+r.headerWidget.height,j.convertPointToPixel(r.bodyWidgets[0].sectionFormat.topMargin))*this.zoomFactor,o=j.convertPointToPixel(r.bodyWidgets[0].sectionFormat.footerDistance),r=r.boundingRectangle.height-Math.max(r.footerWidget.height+o,2*o),t?s=this.isBlockInHeader(this.selection.start.paragraph)?this.currentPage.headerWidget:this.currentPage.footerWidget:e.y<=u&&e.y>=r?s=this.currentPage.footerWidget:0<=e.y&&e.y<=n&&(s=this.currentPage.headerWidget),_.isNullOrUndefined(s)?void 0:(o=this.checkFloatingItems(s,e,t)).isShapeSelected?o.isInShapeBorder?o.element.line:this.selection.getLineWidgetBodyWidget(o.element.textFrame,e):this.selection.getLineWidgetBodyWidget(s,e);for(var a=void 0,l=void 0,d=0;d<this.currentPage.bodyWidgets.length;d++){var h=this.currentPage.bodyWidgets[d],a=this.checkFloatingItems(h,e,t,!1),l=this.checkFloatingItems(h,e,t,!0);if(a.isShapeSelected||l.isShapeSelected)break}if(a.isShapeSelected&&!this.isEmptyShape(a)){if(a.isInShapeBorder)return a.element.line;a.element instanceof uc&&(i=this.selection.getLineWidgetBodyWidget(a.element.textFrame,e))}else if(t&&this.isFootnoteWidget){if(void 0!==this.selection.start.paragraph.bodyWidget.footNoteReference&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof q&&"Footnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,e);if(void 0!==this.selection.start.paragraph.bodyWidget.footNoteReference&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof q&&"Endnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,e)}else{if(!t&&this.currentPage.footnoteWidget&&this.isInFootnoteWidget(this.currentPage.footnoteWidget,e))(i=this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,e))&&(this.isFootnoteWidget=!0);else if(!t&&this.currentPage.endnoteWidget&&this.isInFootnoteWidget(this.currentPage.endnoteWidget,e))(i=this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,e))&&(this.isFootnoteWidget=!0);else for(var c=0;c<this.currentPage.bodyWidgets.length;c++){var p=this.currentPage.bodyWidgets[c];if(c<this.currentPage.bodyWidgets.length-1&&e.x<=p.x+p.width&&(i=this.selection.getLineWidgetBodyWidget(p,e,!0),!_.isNullOrUndefined(i))&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y){this.isFootnoteWidget=!1;break}if(e.x>p.x+p.width&&this.layout.getNextWidgetHeight(p)>=e.y&&p.y<=e.y&&(_.isNullOrUndefined(p.nextRenderedWidget)||!(this.layout.getNextWidgetHeight(p.nextRenderedWidget)>=e.y&&p.nextRenderedWidget.y<=e.y))&&(i=this.selection.getLineWidgetBodyWidget(p,e,!0),!_.isNullOrUndefined(i))&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y){this.isFootnoteWidget=!1;break}if(c==this.currentPage.bodyWidgets.length-1&&(i=this.selection.getLineWidgetBodyWidget(p,e,!0),!_.isNullOrUndefined(i))&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y){this.isFootnoteWidget=!1;break}if(e.x<p.x&&c<this.currentPage.bodyWidgets.length-1){if(i=this.selection.getLineWidgetBodyWidget(p,e,!0),!_.isNullOrUndefined(i)&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y){this.isFootnoteWidget=!1;break}if(!_.isNullOrUndefined(i)&&c===this.currentPage.bodyWidgets.length-1){this.isFootnoteWidget=!1;break}}}var u=this.checkInlineShapeItems(i,e,t);if(u.isShapeSelected){if(u.isInShapeBorder)return u.element.line;u.element instanceof uc&&(i=this.selection.getLineWidgetBodyWidget(u.element.textFrame,e))}else if(!this.checkPointIsInLine(i,e)&&l.isShapeSelected){if(l.isInShapeBorder)return l.element.line;l.element instanceof uc&&(i=this.selection.getLineWidgetBodyWidget(l.element.textFrame,e))}}}return i},n.prototype.checkInlineShapeItems=function(e,t,i){var n,r=!1,o=!1,s=this.selection.isInShape,a=i&&s;if(!_.isNullOrUndefined(e)&&0<e.children.length)if(a){a=this.owner.selectionModule.getCurrentTextFrame();a&&(n=a.containerShape,r=!0)}else{for(var l=0;l<e.children.length;l++)if(e.children[l]instanceof uc&&"Inline"===e.children[l].textWrappingStyle&&(n=e.children[l],t.x<n.x+n.margin.left+n.width)&&t.x>n.x&&t.y<n.y+n.margin.top+n.height&&t.y>n.y){r=!0,this.isInShapeBorder(n,t)&&(o=!0);break}i&&!s&&(r=!1)}return{element:n,caretPosition:t,isInShapeBorder:o,isShapeSelected:r}},n.prototype.checkPointIsInLine=function(e,t){if(!_.isNullOrUndefined(e)&&0<e.children.length){for(var i,n=e.paragraph.x,r=this.selection.getTop(e),o=e.children.indexOf(e.children[0]);o<e.children.length;o++)if(!((i=e.children[o])instanceof hc&&"Inline"!==i.textWrappingStyle)){if(t.x<n+i.margin.left+i.width+i.padding.left&&t.x>n&&t.y<r+e.height&&t.y>r)return!0;n+=i.margin.left+i.width+i.padding.left}}else if(!_.isNullOrUndefined(e)&&0===e.children.length){var n=e.paragraph.x,s=this.selection.getTop(e);if(t.x<n+e.width&&t.x>n&&t.y<s+e.height&&t.y>s)return!0}return!1},n.prototype.isInFootnoteWidget=function(e,t){for(var i=0;i<e.bodyWidgets.length;i++)for(var n=0;n<e.bodyWidgets[i].childWidgets.length;n++){var r=e.bodyWidgets[i].childWidgets[n];if(r instanceof Vd&&r.y<=t.y&&r.y+r.height>=t.y)return!0}return!1},n.prototype.checkFloatingItems=function(e,t,i,n){var r,o=!1,s=!1,a=this.selection.isInShape,l=i&&a;if(0<e.floatingElements.length){this.currentPage;if(e.floatingElements.sort(function(e,t){return e instanceof K||t instanceof K?0:e.zOrderPosition-t.zOrderPosition}),l){l=this.owner.selectionModule.getCurrentTextFrame();l&&(r=l.containerShape,o=!0)}else{for(var d=e.floatingElements.length-1;0<=d;d--)if(!(e.floatingElements[d]instanceof K||(!_.isNullOrUndefined(n)&&n?"Behind"!==e.floatingElements[d].textWrappingStyle:"Behind"===e.floatingElements[d].textWrappingStyle))&&(r=e.floatingElements[d],t.x<r.x+r.margin.left+r.width)&&t.x>r.x&&t.y<r.y+r.margin.top+r.height&&t.y>r.y){o=!0,this.isInShapeBorder(r,t)&&(s=!0);break}i&&!a&&(o=!1)}}return{element:r,caretPosition:t,isShapeSelected:o,isInShapeBorder:s}},n.prototype.isBlockInHeader=function(e){for(;!(e.containerWidget instanceof Xd);){if(!e.containerWidget)return!1;(e=e.containerWidget)instanceof fc&&(e=e.containerShape.paragraph)}return-1!==e.containerWidget.headerFooterType.indexOf("Header")},n.prototype.clearSelectionHighlight=function(){this.isControlPressed&&this.isMouseDown;this.owner.selectionModule.clearSelectionHighlightInSelectedWidgets()&&this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height)},n.prototype.removeEmptyPages=function(e){for(var t=!1,i=!1,n=this.selection.startPage-1,r=0;r<this.pages.length;r++){for(var o,s=this.pages[r],a=0;a<s.bodyWidgets.length;a++)0!==s.bodyWidgets.length&&0!==s.bodyWidgets[a].childWidgets.length||1<=s.bodyWidgets.length&&(o=s.bodyWidgets.indexOf(s.bodyWidgets[a]),s.bodyWidgets.splice(o,1),a--);if(s.bodyWidgets.length<=0){if(r===this.pages.length-1&&this.owner.viewer instanceof Sd&&-1!==this.owner.viewer.visiblePages.indexOf(this.pages[r])&&(t=!0),!_.isNullOrUndefined(s.endnoteWidget)&&0<s.endnoteWidget.bodyWidgets.length){var l=s.endnoteWidget,d=s.previousPage;if(!_.isNullOrUndefined(d)){_.isNullOrUndefined(d.endnoteWidget)&&(d.endnoteWidget=new q,d.endnoteWidget.footNoteType="Endnote",d.endnoteWidget.page=d);for(var h=0;h<l.bodyWidgets.length;h++){var c,p=l.bodyWidgets[h],u=!1;0<d.endnoteWidget.bodyWidgets.length&&(c=d.endnoteWidget.bodyWidgets[d.endnoteWidget.bodyWidgets.length-1],p.index===c.index)&&p.footNoteReference===c.footNoteReference&&(c.combineWidget(this.owner.viewer),l.bodyWidgets.splice(h,1),u=!0),u||(l.bodyWidgets.splice(h,1),p.index=d.endnoteWidget.bodyWidgets.length,d.endnoteWidget.bodyWidgets.push(p),p.containerWidget=d.endnoteWidget,p.page=d),h--}_.isNullOrUndefined(s.endnoteWidget)||0!==s.endnoteWidget.bodyWidgets.length||(s.endnoteWidget=void 0),t=!(i=!0)}}_.isNullOrUndefined(this.pages[r])||this.removePage(this.pages[r]),r--}}_.isNullOrUndefined(this.pages[n])||((s=this.pages[n]).headerWidget&&(s.headerWidget.page=s),s.footerWidget&&(s.footerWidget.page=s)),i&&!e&&this.layout.reLayoutEndnote(),t&&this.scrollToBottom()},n.prototype.scrollToBottom=function(){var e,t;this.selection.start.paragraph&&this.selection.start.paragraph.bodyWidget&&(e=this.selection.start.paragraph.bodyWidget.page,t=this.visibleBounds.height,this.viewerContainer.scrollTop=e.boundingRectangle.bottom-t)},n.prototype.getFieldResult=function(e,t){if(!_.isNullOrUndefined(t)&&!_.isNullOrUndefined(this.selection)&&!_.isNullOrUndefined(e)){var i,n,e=this.selection.getFieldCode(e).split("*"),r=e[0].replace(/[^\w\s]/gi,"").trim().toLowerCase(),o="";switch(""==(o=1<e.length&&" MERGEFORMAT"!==e[1]?e[1].replace(/[^\w\s]/gi,"").trim():o)&&(o=t.bodyWidgets[0].sectionFormat.pageNumberStyle),r=-1!==r.indexOf(" ")?r.split(" ")[0]:r){case"page":return t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0!==t.sectionIndex?(i=t.sectionIndex,n=t.previousPage,this.isRestartNumbering=!0,i!==n.sectionIndex&&n.bodyWidgets[n.bodyWidgets.length-1].sectionIndex!==i?t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber:(1===n.currentPageNum&&i!==n.sectionIndex&&(n.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber),t.currentPageNum=n.currentPageNum+1)):t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0===t.sectionIndex?t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber+t.index:!_.isNullOrUndefined(t.previousPage)&&(t.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering&&1===t.previousPage.currentPageNum||this.isRestartNumbering&&1!==t.previousPage.currentPageNum)?(t.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering&&(this.isRestartNumbering=!0),t.currentPageNum=t.previousPage.currentPageNum+1):t.currentPageNum=t.index+1,this.getFieldText(o,t.currentPageNum);case"numpages":return this.getFieldText(o,t.documentHelper.pages.length);case"sectionpages":for(var s=t.sectionIndex,a=0,l=0;l<t.documentHelper.pages.length;l++)if(t.documentHelper.pages[l].sectionIndex===s)a++;else if(0!==a)break;return this.getFieldText(o,a)}}return""},n.prototype.getFieldText=function(e,t){switch(e){case"ALPHABETIC":return this.layout.getAsLetter(t).toUpperCase();case"alphabetic":return this.layout.getAsLetter(t).toLowerCase();case"roman":return this.layout.getAsRoman(t).toLowerCase();case"ROMAN":case"RomanUpper":return this.layout.getAsRoman(t).toUpperCase();case"RomanLower":return this.layout.getAsRoman(t).toLowerCase();case"LetterUpper":return this.layout.getAsLetter(t).toUpperCase();case"LetterLower":return this.layout.getAsLetter(t).toLowerCase();default:return t.toString()}},n.prototype.isEmptyShape=function(e){return e.element instanceof Ic||0===e.element.textFrame.childWidgets.length},n.prototype.destroy=function(){if(_.isNullOrUndefined(this.owner)||this.unWireEvent(),this.styles&&(this.styles.destroy(),this.styles=void 0),this.stylesMap&&(this.stylesMap.destroy(),this.stylesMap=void 0),this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.themeFontLanguage&&(this.themeFontLanguage.destroy(),this.themeFontLanguage=void 0),this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.pages&&0<this.pages.length){for(var e=0;e<this.pages.length;e++)this.pages[e].componentDestroy();this.pages=[]}if(this.pages=void 0,this.lists&&0<this.lists.length){for(e=0;e<this.lists.length;e++)this.lists[e].destroy();this.lists=[]}if(this.lists=void 0,this.formFillPopup&&(this.formFillPopup.destroy(),this.formFillPopup=void 0),this.contentDropDown&&(this.contentDropDown.destroy(),this.contentDropDown=void 0),this.L10n=void 0,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.fieldStacks=[],this.fieldStacks=void 0,this.splittedCellWidgets=[],this.splittedCellWidgets=void 0,this.fields=[],this.fields=void 0,this.abstractLists=[],this.abstractLists=void 0,_.isNullOrUndefined(this.owner)||this.renderedLists.destroy(),this.renderedLists=void 0,_.isNullOrUndefined(this.owner)||this.authors.destroy(),this.authors=void 0,_.isNullOrUndefined(this.owner)||this.revisionsInternal.destroy(),this.revisionsInternal=void 0,_.isNullOrUndefined(this.owner)||this.preDefinedStyles.destroy(),this.preDefinedStyles=void 0,_.isNullOrUndefined(this.owner)||this.bookmarks.destroy(),this.bookmarks=void 0,_.isNullOrUndefined(this.owner)||this.editRanges.destroy(),this.editRanges=void 0,_.isNullOrUndefined(this.owner)||this.customXmlData.destroy(),_.isNullOrUndefined(this.owner)||this.images.destroy(),_.isNullOrUndefined(this.owner)||this.fontSubstitutionTable.destroy(),this.fontSubstitutionTable=void 0,this.customXmlData=void 0,this.images=void 0,this.blockToShift=void 0,this.cachedPages=[],this.cachedPages=void 0,this.comments&&0<this.comments.length){for(e=0;e<this.comments.length;e++)this.comments[e].destroy();this.comments=[]}this.comments=void 0,this.compositionEnd=void 0,this.compositionStart=void 0,this.compositionUpdated=void 0,this.contentControlCollection=[],this.contentControlCollection=void 0,this.renderedLevelOverrides=[],this.renderedLevelOverrides=void 0,this.headersFooters=[],this.headersFooters=void 0,this.listParagraphs=[],this.listParagraphs=void 0,this.formFields=[],this.formFields=void 0,this.fieldCollection=[],this.fieldCollection=void 0,this.userCollection=[],this.userCollection=void 0,this.footnotes&&(this.footnotes.componentDestroy(),this.footnotes=void 0),this.endnotes&&(this.endnotes.componentDestroy(),this.endnotes=void 0),this.zoomModule&&(this.zoomModule.destroy(),this.zoomModule=void 0),this.footnoteCollection=[],this.footnoteCollection=void 0,this.endnoteCollection=[],this.endnoteCollection=void 0,this.restrictEditingPane&&(this.restrictEditingPane.destroy(),this.restrictEditingPane=void 0),this.layout&&this.layout.destroy(),this.layout=void 0,_.isNullOrUndefined(this.render)||this.render.destroy(),this.render=void 0,this.dialogInternal&&this.dialogInternal.destroy(),this.dialogInternal=void 0,this.dialogInternal2&&(this.dialogInternal2.destroy(),this.dialogInternal2=void 0),this.dialogInternal3&&(this.dialogInternal3.destroy(),this.dialogInternal3=void 0),this.dialogTarget1&&this.dialogTarget1.parentElement&&this.dialogTarget1.parentElement.removeChild(this.dialogTarget1),this.dialogTarget1=void 0,this.dialogTarget2&&this.dialogTarget2.parentElement&&this.dialogTarget2.parentElement.removeChild(this.dialogTarget2),this.dialogTarget2=void 0,this.dialogTarget3&&this.dialogTarget3.parentElement&&this.dialogTarget3.parentElement.removeChild(this.dialogTarget3),this.dialogTarget3=void 0,_.isNullOrUndefined(this.touchStart)||(this.touchStart.innerHTML="",_.isNullOrUndefined(this.touchStart.parentElement))||this.touchStart.parentElement.removeChild(this.touchStart),this.touchStart=void 0,this.textHelper&&this.textHelper.destroy(),this.textHelper=void 0,_.isNullOrUndefined(this.touchEnd)||(this.touchEnd.innerHTML="",_.isNullOrUndefined(this.touchEnd.parentElement))||this.touchEnd.parentElement.removeChild(this.touchEnd),this.touchEnd=void 0,_.isNullOrUndefined(this.containerCanvasIn)||(this.containerCanvasIn.innerHTML="",_.isNullOrUndefined(this.containerCanvasIn.parentElement))||this.containerCanvasIn.parentElement.removeChild(this.containerCanvasIn),this.containerCanvasIn=void 0,_.isNullOrUndefined(this.selectionCanvasIn)||(this.selectionCanvasIn.innerHTML="",_.isNullOrUndefined(this.selectionCanvasIn.parentElement))||this.selectionCanvasIn.parentElement.removeChild(this.selectionCanvasIn),this.selectionCanvasIn=void 0,_.isNullOrUndefined(this.editableDiv)||(this.editableDiv.innerHTML="",_.isNullOrUndefined(this.editableDiv.parentElement))||this.editableDiv.parentElement.removeChild(this.editableDiv),this.editableDiv=void 0,_.isNullOrUndefined(this.pageContainer)||(this.pageContainer.innerHTML="",_.isNullOrUndefined(this.pageContainer.parentElement))||this.pageContainer.parentElement.removeChild(this.pageContainer),this.pageContainer=void 0,_.isNullOrUndefined(this.viewerContainer)||(this.viewerContainer.innerHTML="",_.isNullOrUndefined(this.viewerContainer.parentElement))||this.viewerContainer.parentElement.removeChild(this.viewerContainer),_.isNullOrUndefined(this.iframe)||(this.iframe.innerHTML="",_.isNullOrUndefined(this.iframe.parentElement)||this.iframe.parentElement.removeChild(this.iframe),this.iframe=void 0),this.optionsPaneContainer&&(this.optionsPaneContainer.innerHTML="",_.isNullOrUndefined(this.optionsPaneContainer.parentElement)||this.optionsPaneContainer.parentElement.removeChild(this.optionsPaneContainer)),this.optionsPaneContainer=void 0,this.visibleBoundsIn=void 0,this.mouseDownOffset=void 0,this.viewerContainer=void 0,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.currentSelectedCommentInternal=void 0,this.currentSelectedRevisionInternal=void 0,this.owner=void 0,this.heightInfoCollection=void 0,this.isRestartNumbering=!1},n.prototype.unWireEvent=function(){this.viewerContainer.removeEventListener("scroll",this.scrollHandler),this.viewerContainer.removeEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.removeEventListener("mousemove",this.onMouseMoveInternal),_.Browser.isDevice?this.editableDiv.removeEventListener("input",this.onTextInputInternal):(this.editableDiv.removeEventListener("keypress",this.onKeyPressInternal),"chrome"===_.Browser.info.name&&this.editableDiv.removeEventListener("textInput",this.onTextInput)),this.editableDiv.removeEventListener("paste",this.onPaste),this.viewerContainer.removeEventListener("contextmenu",this.onContextMenu),this.editableDiv.removeEventListener("blur",this.onFocusOut),this.editableDiv.removeEventListener("keydown",this.onKeyDownInternal),this.editableDiv.removeEventListener("compositionstart",this.compositionStart),this.editableDiv.removeEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.removeEventListener("compositionend",this.compositionEnd),this.viewerContainer.removeEventListener("mouseup",this.onMouseUpInternal),_.isNullOrUndefined(this.iframe)||this.iframe.removeEventListener("load",this.onIframeLoad),this.viewerContainer.removeEventListener("dblclick",this.onDoubleTap),window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("keyup",this.onKeyUpInternal),window.removeEventListener("mouseup",this.onImageResizer),window.removeEventListener("touchend",this.onImageResizer),window.removeEventListener("copy",this.onCopy),void 0!==navigator&&navigator.userAgent.match("Firefox")&&this.viewerContainer.removeEventListener("DOMMouseScroll",this.zoomModule.onMouseWheelInternal),this.viewerContainer.removeEventListener("mousewheel",this.zoomModule.onMouseWheelInternal)},n.prototype.updateCursor=function(e){var t,i,n,r,o,s=void 0,a=this.viewerContainer,l=new nl(e.offsetX,e.offsetY),l=this.owner.viewer.findFocusedPage(l,!0),d=this.getLineWidget(l),h=this.owner.isReadOnlyMode?void 0:this.owner.editorModule,c=!!h&&h.tableResize.isInRowResizerArea(l),h=!!h&&h.tableResize.isInCellResizerArea(l),p=(this.selection.checkAllFloatingElements(d,l),""),u=(this.owner.enableImageResizerMode&&(u=this.owner.imageResizerModule.getImagePoint(l),this.owner.imageResizerModule.selectedResizeElement=u.selectedElement,p=u.resizePosition),0),g=void 0,m=(this.checkPointIsInLine(d,l),_.isNullOrUndefined(d)||(u=this.selection.getLineStartLeft(d),s=this.selection.getHyperLinkFieldInCurrentSelection(d,l),_.isNullOrUndefined(s)&&(g=this.selection.getHyperLinkFieldInCurrentSelection(d,l,!0)),_.isNullOrUndefined(s)||0!==(n=this.selection.getFieldCode(s)).toLowerCase().indexOf("ref ")||n.match("\\h")||(s=void 0),n=this.selection.updateTextPositionIn(d,void 0,0,l,!0),t=this.selection.getLeft(d),i=this.selection.getTop(d),_.isNullOrUndefined(s)&&!_.isNullOrUndefined(g)&&this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType&&!this.isFormFilling?this.selection.setHyperlinkContentToToolTip(g,d,l.x,!0):this.selection.setHyperlinkContentToToolTip(s,d,l.x,!1),g&&(r=g.formFieldData instanceof Ch&&"Text"===g.formFieldData.type,"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode)&&r&&(g=void 0),this.owner.enableLockAndEdit&&(r=!1,(o=(o=d.paragraph).isInsideTable?this.layout.getParentTable(o):o).locked&&o.lockedBy!==this.owner.currentUser&&(r=!0),m=(m=d.paragraph.bodyWidget.sectionFormat).pageWidth-m.rightMargin-m.leftMargin,m=j.convertPointToPixel(m)*this.zoomFactor,this.viewer instanceof Wd&&(m=(this.visibleBounds.width-5*this.viewer.padding.right)/this.zoomFactor),r&&l.x>=u&&l.x<u+m?this.selection.setLockInfoTooptip(d,l.x,o.lockedBy):this.selection.setLockInfoTooptip(void 0,l.x,""))),_.isNullOrUndefined(d)||_.isNullOrUndefined(void 0)&&"Pages"==this.owner.layoutType&&(r=this.selection.getFootNoteElementInCurrentSelection(d,l))instanceof Bh&&this.selection.setFootnoteContentToToolTip(r,d,l.x),this.isIosDevice?e.metaKey:e.ctrlKey);!_.isNullOrUndefined(s)&&(m&&this.owner.useCtrlClickToFollowHyperlink||!this.owner.useCtrlClickToFollowHyperlink)||g?_.isNullOrUndefined(g)?a.style.cursor="pointer":this.isFormFillProtectedMode&&(a.style.cursor="default"):(l.x>=u&&e.offsetX<this.visibleBounds.width-(this.visibleBounds.width-this.viewerContainer.clientWidth)&&e.offsetY<this.visibleBounds.height-(this.visibleBounds.height-this.viewerContainer.clientHeight)?this.selection.isEmpty?a.style.cursor="text":a.style.cursor=this.selection.checkCursorIsInSelection(d,l)?"default":"text":a.style.cursor="default",_.isNullOrUndefined(p)||""===p?!_.isNullOrUndefined(n)&&n.isImageSelected&&t<l.x&&i<l.y&&t+d.width>l.x&&i+d.height>l.y&&(a.style.cursor="move"):(!this.owner.imageResizerModule.isShapeResize||this.owner.imageResizerModule.isShapeResize&&"move"!==p)&&(a.style.cursor=p),c?a.style.cursor="row-resize":h&&(a.style.cursor="col-resize"))},n.prototype.updateDialogTabHeight=function(e,t){var i=e.getElementsByClassName("e-dlg-header-content")[0],n=e.getElementsByClassName("e-dlg-content")[0],r=e.getElementsByClassName("e-footer-content")[0],n=getComputedStyle(n),o=getComputedStyle(e),s=parseInt(n.paddingTop,10),a=parseInt(n.paddingBottom,10),s=(isNaN(s)?0:s)+(isNaN(a)?0:a),a=parseInt(o.borderTop,10),l=parseInt(o.borderBottom,10),a=(isNaN(a)?0:a)+(isNaN(l)?0:l),l=e.offsetHeight-(i.offsetHeight+r.offsetHeight+s+a),i=(t.style.height=l+"px",parseInt(n.paddingLeft,10)),r=parseInt(n.paddingRight,10),s=(isNaN(i)?0:i)+(isNaN(r)?0:r),a=parseInt(o.borderLeft,10),t=parseInt(o.borderRight,10),l=(isNaN(a)?0:a)+(isNaN(t)?0:t);return e.offsetWidth-(s+l)},n.prototype.canRenderBorder=function(e){var t,i,n,r,o=!1,s=!1,a=e.previousRenderedWidget,l=e.nextRenderedWidget,d=this.getParagraphLeftPosition(e),h=0,c=0;return!_.isNullOrUndefined(a)&&a instanceof G&&(h=this.getParagraphLeftPosition(a)),!_.isNullOrUndefined(l)&&l instanceof G&&(c=this.getParagraphLeftPosition(l)),{skipTopBorder:o=!_.isNullOrUndefined(a)&&a instanceof G&&d===h&&(t=this.checkEqualBorder(e.paragraphFormat.borders.top,a.paragraphFormat.borders.top),i=this.checkEqualBorder(e.paragraphFormat.borders.bottom,a.paragraphFormat.borders.bottom),n=this.checkEqualBorder(e.paragraphFormat.borders.left,a.paragraphFormat.borders.left),r=this.checkEqualBorder(e.paragraphFormat.borders.right,a.paragraphFormat.borders.right),t)&&i&&n&&r&&!_.isNullOrUndefined(a.paragraphFormat.borders.horizontal)&&"None"===a.paragraphFormat.borders.horizontal.lineStyle?!0:o,skipBottomBorder:s=!_.isNullOrUndefined(l)&&l instanceof G&&(d===c||this.owner.documentHelper.layout.isInitialLoad&&this.skipBottomBorder(e,l))&&(t=this.checkEqualBorder(e.paragraphFormat.borders.top,l.paragraphFormat.borders.top),i=this.checkEqualBorder(e.paragraphFormat.borders.bottom,l.paragraphFormat.borders.bottom),n=this.checkEqualBorder(e.paragraphFormat.borders.left,l.paragraphFormat.borders.left),r=this.checkEqualBorder(e.paragraphFormat.borders.right,l.paragraphFormat.borders.right),i)&&t&&n&&r?!0:s}},n.prototype.checkEqualBorder=function(e,t){return _.isNullOrUndefined(e)||_.isNullOrUndefined(t)?!(!_.isNullOrUndefined(e)||!_.isNullOrUndefined(t)):e.isEqualFormat(t)},n.prototype.getParagraphLeftPosition=function(e){var t=0;return e.paragraphFormat.firstLineIndent<0&&(t=j.convertPointToPixel(Math.abs(e.paragraphFormat.firstLineIndent)),t=parseFloat(t.toFixed(5))),e.isEmpty()&&("Left"!==e.paragraphFormat.textAlignment&&"Justify"!==e.paragraphFormat.textAlignment||"Justify"===e.paragraphFormat.textAlignment&&e.paragraphFormat.bidi)?e.clientX>t?e.clientX-t:e.clientX:e.x>t?e.x-t:e.x},n.prototype.skipBottomBorder=function(e,t){var i,n;return e.paragraphFormat.leftIndent===t.paragraphFormat.leftIndent||(i=e.paragraphFormat.firstLineIndent<0?Math.abs(e.paragraphFormat.firstLineIndent):0,n=t.paragraphFormat.firstLineIndent<0?Math.abs(t.paragraphFormat.firstLineIndent):0,(e.paragraphFormat.leftIndent>i?e.paragraphFormat.leftIndent-i:0)==(t.paragraphFormat.leftIndent>n?t.paragraphFormat.leftIndent-n:0))},n.prototype.isPageInVisibleBound=function(e,t){var i=this.visibleBounds.height,n=this.viewerContainer.scrollTop,e=e.boundingRectangle.height*this.zoomFactor;return n<=t&&t<=n+i||n<=t+e&&t+e<=n+i||t<=n&&n+i<=t+e},n.prototype.getFirstParagraphInCell=function(e){e=e.childWidgets[0];return e instanceof G?e:this.getFirstParagraphInFirstCell(e)},n.prototype.getFirstParagraphInFirstCell=function(e){if(!_.isNullOrUndefined(e.childWidgets)&&0<e.childWidgets.length)return e=e.childWidgets[0].childWidgets[0].childWidgets[0],this.getFirstParagraphBlock(e)},n.prototype.getLastParagraphInLastCell=function(e){if(!_.isNullOrUndefined(e.childWidgets)&&0<e.childWidgets.length)return e=e.lastChild.lastChild.lastChild,this.getLastParagraphBlock(e)},n.prototype.getFirstParagraphBlock=function(e){return e instanceof G?e:e instanceof K?this.getFirstParagraphInFirstCell(e):void 0},n.prototype.getLastParagraphBlock=function(e){return e instanceof G?e:e instanceof K?this.getLastParagraphInLastCell(e):void 0},n.prototype.getLastParagraphInFirstRow=function(e){if(0<e.childWidgets.length)return e=e.firstChild.lastChild.lastChild,this.getLastParagraphBlock(e)},n.prototype.getFirstParagraphInLastRow=function(e){if(0<e.childWidgets.length)return e=e.childWidgets[e.childWidgets.length-1].childWidgets[0].childWidgets[0],this.getFirstParagraphBlock(e)},n.prototype.addToStylesMap=function(e){var t,i={},n={};_.isNullOrUndefined(e)||(t=this.owner?this.L10n.getConstant(e.name):e.name,i.StyleName=""===t?e.name:t,"Paragraph"==e.type&&(n.paragraphFormat={},j.writeParagraphFormat(n.paragraphFormat,!0,e.paragraphFormat)),n.characterFormat={},j.writeCharacterFormat(n.characterFormat,!0,e.characterFormat),i.Style=this.parseStyle(JSON.stringify(n)),_.isNullOrUndefined(e.type)||(i.type=e.type,"Paragraph"!=i.type)||_.isNullOrUndefined(e.link)||(i.type="Linked"),i.IconClass="Paragraph"==i.type?"e-list-icon e-de-listview-icon e-de-e-paragraph-style-mark e-icons":"Character"==i.type?"e-list-icon e-de-listview-icon e-de-e-character-style-mark e-icons":"e-list-icon e-de-listview-icon e-de-e-linked-style-mark e-icons",this.stylesMap.get(i.type)?this.stylesMap.get(i.type).push(i):this.stylesMap.add(i.type,[i]))},n.prototype.parseStyle=function(e){var t="",e=JSON.parse(e),i="";if(!_.isNullOrUndefined(e.characterFormat.baselineAlignment)&&"Normal"!==e.characterFormat.baselineAlignment){var n="";switch(e.characterFormat.baselineAlignment){case"Superscript":n="super";break;case"Subscript":n="sub"}1<n.length&&(t+="vertical-align:"+n+";")}return _.isNullOrUndefined(e.characterFormat.underline)||"None"===e.characterFormat.underline||(i+="underline "),_.isNullOrUndefined(e.characterFormat.strikethrough)||"None"===e.characterFormat.strikethrough||(i+="line-through "),_.isNullOrUndefined(e.characterFormat.fontSize)||(t+="font-size:"+e.characterFormat.fontSize+"px;"),_.isNullOrUndefined(e.characterFormat.fontFamily)||(t+="font-family:"+e.characterFormat.fontFamily+";"),!_.isNullOrUndefined(e.characterFormat.bold)&&e.characterFormat.bold&&(t+="font-weight:bold;"),!_.isNullOrUndefined(e.characterFormat.italic)&&e.characterFormat.italic&&(t+="font-style:italic;"),1<i.length&&(t+="text-decoration:"+i+";"),t},n);function n(e){var l=this;this.isCompleted=!0,this.isCopying=!1,this.isSelectionCompleted=!0,this.scrollbarWidth=0,this.isWebPrinting=!1,this.isHeaderFooter=!1,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.fieldStacks=[],this.showRevision=!1,this.splittedCellWidgets=[],this.tableLefts=[],this.tapCount=0,this.timer=-1,this.isTimerStarted=!1,this.isFirstLineFitInShiftWidgets=!1,this.preZoomFactor=0,this.preDifference=-1,this.isDragging=!1,this.fieldEndParagraph=void 0,this.fieldToLayout=void 0,this.backgroundColor="#FFFFFF",this.isMouseDown=!1,this.isMouseEntered=!1,this.scrollMoveTimer=0,this.isSelectionChangedOnMouseMoved=!1,this.isControlPressed=!1,this.isTouchInput=!1,this.isTouchMoved=!1,this.useTouchSelectionMark=!1,this.touchDownOnSelectionMark=0,this.isComposingIME=!1,this.lastComposedText="",this.isCompositionStart=!1,this.isCompositionUpdated=!1,this.isCompositionCanceled=!1,this.isCompositionEnd=!1,this.prefix="",this.suffix="",this.fields=[],this.heightInfoCollection={},this.defaultTabWidth=36,this.dontUseHtmlParagraphAutoSpacing=!1,this.allowSpaceOfSameStyleInTable=!1,this.alignTablesRowByRow=!1,this.compatibilityMode="Word2013",this.lists=[],this.comments=[],this.authors=new T,this.revisionsInternal=new T,this.commentUserOptionId=1,this.abstractLists=[],this.styles=new xl,this.stylesMap=new T,this.preDefinedStyles=void 0,this.isRowOrCellResizing=!1,this.endBookmarksUpdated=[],this.formFields=[],this.isMouseDownInFooterRegion=!1,this.pageFitTypeIn="None",this.fieldCollection=[],this.isPageField=!1,this.mouseDownOffset=new nl(0,0),this.zoomFactorInternal=1,this.moveCaretPosition=0,this.isTextInput=!1,this.isScrollHandler=!1,this.triggerElementsOnLoading=!1,this.triggerSpellCheck=!1,this.restrictFormatting=!1,this.protectionType="NoProtection",this.isDocumentProtected=!1,this.hashValue="",this.saltValue="",this.userCollection=[],this.cachedPages=[],this.skipScrollToPosition=!1,this.isIosDevice=!1,this.isMobileDevice=!1,this.isFormFilling=!1,this.fontSubstitutionTable=void 0,this.themes=new wd,this.hasThemes=!1,this.footnotes=new Oh,this.endnotes=new Oh,this.isFootnoteWidget=!1,this.isDragStarted=!1,this.isMouseDownInSelection=!1,this.isBookmarkInserted=!0,this.isAutoResizeCanStart=!1,this.isRestartNumbering=!1,this.onTextInput=function(e){l.isComposingIME||(e.preventDefault(),e=e.data,l.owner.editorModule.handleTextInput(e))},this.compositionStart=function(){_.Browser.isDevice||l.owner.isReadOnlyMode||(l.isComposingIME=!0,l.positionEditableTarget(),l.owner.editorHistoryModule&&l.owner.editorModule.initComplexHistory("IMEInput")),l.isCompositionStart=!0},this.compositionUpdated=function(){l.isComposingIME&&!l.owner.isReadOnlyMode&&setTimeout(function(){l.owner.editorModule.insertIMEText(l.getEditableDivTextContent(),!0)},0),l.isCompositionUpdated=!0},this.compositionEnd=function(e){var t;l.isComposingIME&&!l.owner.isReadOnlyMode&&(""!==(t=l.getEditableDivTextContent())&&l.owner.editorModule.insertIMEText(t,!1),l.isComposingIME=!1,l.lastComposedText="",l.iframe.setAttribute("style","pointer-events:none;position:absolute;left:"+l.owner.viewer.containerLeft+"px;top:"+l.owner.viewer.containerTop+"px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden"),l.editableDiv.innerHTML="",l.owner.editorHistoryModule)&&(""!==t&&(l.owner.editorModule.isSkipOperationsBuild=l.owner.enableCollaborativeEditing),l.owner.editorHistoryModule.updateComplexHistory(),""===t&&(l.owner.editorModule.isSkipOperationsBuild=l.owner.enableCollaborativeEditing,l.owner.editorHistoryModule.undo(),l.owner.editorHistoryModule.redoStack.pop()),l.owner.editorModule.isSkipOperationsBuild=!1),e.preventDefault(),l.isCompositionUpdated=!1,l.isCompositionEnd=!0},this.onImageResizer=function(e){!_.isNullOrUndefined(l.owner)&&!_.isNullOrUndefined(l.owner.imageResizerModule)&&l.owner.imageResizerModule.isImageResizerVisible&&l.owner.imageResizerModule.isImageResizing&&(e instanceof MouseEvent?l.onMouseUpInternal(e):e instanceof TouchEvent&&l.onTouchUpInternal(e)),l.scrollMoveTimer&&(l.isMouseEntered=!0,clearInterval(l.scrollMoveTimer))},this.onKeyPressInternal=function(e){var t,i=e.which||e.keyCode,n=(l.triggerElementsOnLoading=!1,!(!e.ctrlKey&&!e.metaKey)||17===i),i=e.altKey||18===i;(n=_.Browser.isIE&&i?n&&!1:n)&&"v"===e.key||n&&"a"===e.key||(n||l.isControlPressed&&_.Browser.isIE)&&"p"===e.key?_.Browser.isIE&&(l.isControlPressed=!1):((!l.owner.isReadOnlyMode&&l.owner.editorModule.canEditContentControl||"FormFieldsOnly"===l.owner.documentHelper.protectionType&&l.owner.editorModule.canEditContentControl&&!_.isNullOrUndefined(l.owner.documentHelper.selection)&&l.owner.documentHelper.selection.checkContentControlLocked()||!_.isNullOrUndefined(l.selection)&&l.selection.isInlineFormFillMode())&&(i="",(t=e.keyCode||e.charCode)?i=String.fromCharCode(t):e.key&&(i=e.key)," "===i||"\r"===i||"\b"===i||i===String.fromCharCode(27)||n?" "===i&&(l.triggerSpellCheck=!0,l.owner.editorModule.handleTextInput(" "),l.triggerSpellCheck=!1):l.owner.editorModule.handleTextInput(i),e.preventDefault()),l.owner.focusIn())},this.onTextInputInternal=function(e){l.owner.isReadOnlyMode?l.editableDiv.innerText="":l.owner.editorModule.onTextInputInternal()},this.onCopy=function(e){!l.isCopying||_.isNullOrUndefined(l.selection)||l.selection.isEmpty||(l.owner.selection.onCopy(e),e.preventDefault())},this.onPaste=function(e){(!l.owner.isReadOnlyMode&&l.owner.editorModule.canEditContentControl||l.selection.isInlineFormFillMode())&&l.owner.editorModule.pasteInternal(e),l.editableDiv.innerText="",e.preventDefault()},this.onFocusOut=function(){_.isNullOrUndefined(l.selection)||l.owner.contextMenuModule&&l.owner.contextMenuModule.contextMenuInstance&&"block"===l.owner.contextMenuModule.contextMenuInstance.element.style.display||l.selection.hideCaret()},this.updateFocus=function(){l.owner.enableCollaborativeEditing&&l.owner.editorModule.isRemoteAction||(_.isNullOrUndefined(l.currentSelectedComment)||l.owner.commentReviewPane.commentPane.isEditMode?!l.selection||l.isMobileDevice&&l.owner.isReadOnly||(void 0===navigator||_.Browser.isDevice||_.Browser.isIE||navigator.userAgent.match("Edge")||_.isNullOrUndefined(l.iframe)||l.iframe.focus(),_.isNullOrUndefined(l.editableDiv)||l.editableDiv.focus(),l.selection.showCaret()):(l.owner.commentReviewPane&&l.owner.commentReviewPane.commentPane.isEditMode&&l.owner.commentReviewPane.commentPane.selectComment(l.currentSelectedComment),l.selection.hideCaret()))},this.scrollHandler=function(){l.scrollTimer&&clearTimeout(l.scrollTimer),l.clearContent(),l.isScrollHandler=!0,_.Browser.isDevice||l.isComposingIME||(l.iframe.style.top=l.owner.viewer.containerTop+"px",l.iframe.style.left=l.owner.viewer.containerLeft+"px"),l.owner.hRuler&&(document.getElementById(l.owner.element.id+"_hRulerBottom").style.top=l.viewerContainer.scrollTop+"px",e=document.getElementById(l.owner.element.id+"_markIndicator"))&&(e.style.top=l.viewerContainer.scrollTop+"px"),l.owner.vRuler&&(document.getElementById(l.owner.element.id+"_vRulerBottom").style.left=l.viewerContainer.scrollLeft+"px",e=document.getElementById(l.owner.element.id+"_markIndicator"))&&(e.style.left=l.viewerContainer.scrollLeft+"px"),l.owner.rulerHelper&&!_.isNullOrUndefined(l.owner.rulerHelper.vRulerBottom)&&(l.owner.rulerHelper.vRulerBottom.style.height=l.pageContainer.offsetHeight+"px"),l.owner.viewer.updateScrollBars();var e=l.owner.viewer.containerTop+l.visibleBounds.height-(l.owner.viewer.padding.top+l.owner.viewer.padding.bottom);e>l.pageContainer.offsetHeight&&(l.viewerContainer.scrollTop=l.owner.viewer.containerTop-(e-l.pageContainer.offsetHeight)),l.owner.viewer instanceof Sd&&!_.isNullOrUndefined(l.owner)&&l.owner.fireViewChange(),l.isScrollHandler=!1,l.scrollTimer=setTimeout(function(){l.isScrollHandler||_.isNullOrUndefined(l.owner)||!l.owner.isSpellCheck||(l.isScrollToSpellCheck=!0,l.owner.viewer.updateScrollBars())},200)},this.onWindowResize=function(){!_.isNullOrUndefined(l.owner)&&l.owner.isContainerResize?l.owner.isContainerResize=!1:(l.resizeTimer&&clearTimeout(l.resizeTimer),l.resizeTimer=setTimeout(function(){_.isNullOrUndefined(l.owner)||_.isNullOrUndefined(l.owner.element)||(l.updateViewerSize(),l.owner.rulerHelper&&l.owner.documentEditorSettings&&l.owner.documentEditorSettings.showRuler&&l.owner.rulerHelper.updateRuler(l.owner,!0),l.owner.enableCollaborativeEditing&&l.owner.collaborativeEditingHandlerModule&&l.owner.collaborativeEditingHandlerModule.updateCaretPosition(),l.clearContent(),l.owner.viewer.updateScrollBars(),_.isNullOrUndefined(l.selection)||l.selection.updateCaretPosition(),l.updateTouchMarkPosition(),l.owner.contextMenuModule&&l.owner.contextMenuModule.contextMenuInstance&&l.owner.contextMenuModule.contextMenuInstance.close(),l.resizeTimer&&clearTimeout(l.resizeTimer))},200))},this.onContextMenu=function(e){l.owner.contextMenuModule&&(l.isMouseDown&&(l.isMouseDown=!1),l.owner.contextMenuModule.onContextMenuInternal(e),l.updateFocus())},this.onMouseDownInternal=function(e){var t,i=e.target;l.owner.focusIn(),!_.isNullOrUndefined(i)&&i!==l.viewerContainer||l.owner.isTableMarkerDragging||l.isTouchInput||e.offsetX>l.visibleBounds.width-(l.visibleBounds.width-l.viewerContainer.clientWidth)||e.offsetY>l.visibleBounds.height-(l.visibleBounds.height-l.viewerContainer.clientHeight)||(l.isFootnoteWidget=!1,_.isNullOrUndefined(l.selection))||(l.updateCursor(e),l.formFillPopup&&l.formFillPopup.hidePopup(),l.contentDropDown&&l.contentDropDown.hidePopup(),l.isLeftButtonPressed(e)&&!l.owner.isReadOnlyMode&&l.owner.enableImageResizerMode&&!_.isNullOrUndefined(l.owner.imageResizerModule.selectedResizeElement)&&(l.selection.isInShape&&(i=l.owner.selectionModule.getCurrentTextFrame().containerShape,l.selection.selectShape(i)),l.owner.imageResizerModule.isImageResizing=!0),e.preventDefault(),l.isTouchInput||l.selection.hideCaret(),i=new nl(e.offsetX,e.offsetY),t=l.owner.viewer.findFocusedPage(i,!0,!0),l.mouseDownOffset.x=t.x,l.mouseDownOffset.y=t.y,l.isMouseDownInFooterRegion=l.selection.isCursorInsidePageRect(i,l.currentPage)&&l.selection.isCursorInFooterRegion(i,l.currentPage),l.isSelectionChangedOnMouseMoved=!1,l.owner.isReadOnlyMode||!l.owner.editorModule.tableResize.isInCellResizerArea(t)&&!l.owner.editorModule.tableResize.isInRowResizerArea(t)?(e.ctrlKey&&(l.isControlPressed=!0),l.owner.selectionModule.isEmpty&&(l.useTouchSelectionMark=!1),i=l.getLineWidget(t),3===e.which&&!l.owner.selectionModule.isEmpty&&l.selection.checkCursorIsInSelection(i,t)?e.preventDefault():(l.owner&&l.owner.documentEditorSettings&&l.owner.documentEditorSettings.allowDragAndDrop&&!l.owner.selectionModule.isEmpty&&l.selection.checkCursorIsInSelection(i,t)&&(l.isMouseDownInSelection=!0),l.isTouchInput=!1,l.isMouseDown=!0,l.updateFocus(),l.timer=setTimeout(function(){l.tapCount++,1<l.tapCount&&(l.tapCount=1),l.isScrollHandler||_.isNullOrUndefined(l.owner)||!l.owner.isSpellCheck||(l.isScrollToSpellCheck=!0,l.owner.viewer.updateScrollBars())},100))):(l.selection.hideCaret(),l.isMouseDown=!0,l.isSelectionChangedOnMouseMoved=!1,l.isLeftButtonPressed(e)&&(l.owner.editorModule.tableResize.startingPoint.x=t.x,l.owner.editorModule.tableResize.startingPoint.y=t.y,l.owner.editorModule.tableResize.handleResize(t))))},this.onMouseMoveInternal=function(e){var t,i,n,r,o,s,a;!_.isNullOrUndefined(e.target)&&e.target!==l.viewerContainer||l.owner.isTableMarkerDragging||(e.preventDefault(),_.isNullOrUndefined(l.selection))||(!l.owner.isReadOnlyMode&&l.owner.enableImageResizerMode&&l.owner.imageResizerModule.isImageResizing?l.owner.imageResizerModule.isImageMoveToNextPage||l.owner.imageResizerModule.handleImageResizingOnMouse(e):(t=new nl(e.offsetX,e.offsetY),i=l.owner.viewer.findFocusedPage(t,!l.owner.enableHeaderAndFooter),n=l.getLineWidget(i),l.isMouseDown&&(_.isNullOrUndefined(l.currentPage)||(r=i.x,o=i.y,!l.owner.isReadOnlyMode&&l.isRowOrCellResizing?(a=l.owner.editorModule.tableResize.currentResizingTable,s=l.selection.setPositionForBlock(a,!0),a=l.selection.setPositionForBlock(a,!1),l.owner.documentHelper.isDocumentProtected&&!l.selection.checkSelectionIsAtEditRegion(s,a)||l.owner.editorModule.tableResize.handleResizing(i)):((!l.isDragStarted&&l.isMouseDownInSelection&&l.isLeftButtonPressed(e)&&!l.owner.selectionModule.isEmpty&&l.selection.checkCursorIsInSelection(n,i)||!l.owner.isReadOnlyMode&&l.owner.enableImageResizerMode&&!l.isDragStarted&&l.isLeftButtonPressed(e)&&!l.owner.selectionModule.isEmpty&&!_.isNullOrUndefined(n)&&l.owner.imageResizerModule.selectedImageWidget.containsKey(n)&&!l.owner.imageResizerModule.isImageResizing)&&(l.isDragStarted=!0,l.isMouseDownInSelection=!1,l.selection.isForward?(l.dragStartParaInfo=l.selection.getParagraphInfo(l.selection.start),l.dragEndParaInfo=l.selection.getParagraphInfo(l.selection.end)):(l.dragStartParaInfo=l.selection.getParagraphInfo(l.selection.end),l.dragEndParaInfo=l.selection.getParagraphInfo(l.selection.start)),l.selection.caret.classList.remove("e-de-cursor-animation")),l.isTouchInput||l.isSelectionChangedOnMouseMoved||0<l.touchDownOnSelectionMark||l.isDragStarted||l.updateTextPositionForSelection(i,1),l.isLeftButtonPressed(e)&&!l.isDragStarted&&(e.preventDefault(),s=l.owner.selectionModule.end,a=new nl(r,o),l.owner.enableImageResizerMode&&l.owner.imageResizerModule.isImageResizerVisible&&!l.owner.imageResizerModule.isShapeResize||(l.isCompleted=!1,l.owner.selectionModule.moveTextPosition(a,s)),l.isSelectionChangedOnMouseMoved=!0),l.isDragStarted&&l.isLeftButtonPressed(e)&&(l.autoScrollOnSelection(t),l.selection.updateTextPosition(n,i)))),l.selection.checkForCursorVisibility()),l.isRowOrCellResizing||l.isSelectionChangedOnMouseMoved||l.updateCursor(e),l.isRowOrCellResizing&&l.selection.hideCaret()))},this.onMouseLeaveInternal=function(e){e.preventDefault();var t,i=new nl(e.offsetX,e.offsetY);l.isMouseDown&&(t=l.viewerContainer.scrollTop,clearInterval(l.scrollMoveTimer),e.offsetY+t>t?l.scrollMoveTimer=setInterval(function(){l.scrollForwardOnSelection(i)},100):l.scrollMoveTimer=setInterval(function(){l.scrollBackwardOnSelection(i)},100),l.isMouseEntered)&&(l.isMouseEntered=!1),l.isDragStarted&&(l.selection.hideCaret(),l.scrollMoveTimer)&&(clearInterval(l.scrollMoveTimer),l.scrollMoveTimer=0)},this.onMouseEnterInternal=function(e){l.isMouseEntered||l.owner.viewer.updateScrollBars(),l.isMouseEntered=!0,l.scrollMoveTimer&&clearInterval(l.scrollMoveTimer),!l.isLeftButtonPressed(e)&&l.isDragStarted&&(l.selection.caret.classList.contains("e-de-cursor-animation")||l.selection.caret.classList.add("e-de-cursor-animation"),l.isDragStarted=!1),!l.isLeftButtonPressed(e)&&l.isMouseDown&&l.onMouseUpInternal(e)},this.onDoubleTap=function(e){if(l.owner.focusIn(),(_.isNullOrUndefined(e.target)||e.target===l.viewerContainer)&&!_.isNullOrUndefined(l.selection)){l.isTouchInput=!1;var e=new nl(e.offsetX,e.offsetY),t=l.owner.viewer.findFocusedPage(e,!0);if(!l.selection.checkAndEnableHeaderFooter(e,l.owner.viewer.findFocusedPage(e,!0))){e=l.getLineWidget(t);if(!_.isNullOrUndefined(e)){e=l.selection.getHyperLinkFieldInCurrentSelection(e,t,!0);if(_.isNullOrUndefined(e)&&(e=l.selection.getCurrentFormField()),l.isDocumentProtected||!l.owner.enableFormField||l.owner.isReadOnlyMode)l.isDocumentProtected&&e&&e.formFieldData instanceof Ch&&"Text"===e.formFieldData.type&&l.selection.selectField();else{t=l.selection.getFormFieldType(e);if(t)switch(""!==t.toString()&&l.selection.selectField(e),t){case"Text":l.owner.textFormFieldDialogModule.show();break;case"CheckBox":l.owner.checkBoxFormFieldDialogModule.show();break;case"DropDown":l.owner.dropDownFormFieldDialogModule.show()}}var e=l.selection.start.clone(),t=l.selection.end.clone(),i=e.currentWidget.getInline(e.offset,0).element;if("Pages"===l.owner.layoutType)if(i instanceof Bh)if("Footnote"===i.footnoteType){for(var n=l.currentPage.footnoteWidget,r=void 0,r=0;r<=n.bodyWidgets.length;r++){var o=n.bodyWidgets[r].footNoteReference;if(i.text===o.text)break}e.setPositionParagraph(n.bodyWidgets[r].childWidgets[0].childWidgets[0],0),t.setPositionParagraph(n.bodyWidgets[r].childWidgets[0].childWidgets[0],0),l.selection.selectRange(e,t)}else l.navigateToEndNote(i,e,t);else i instanceof X&&(l.selection.isinEndnote||l.selection.isinFootnote)&&l.selection.footnoteReferenceElement(e,t,i);!l.selection.isEmpty||_.isNullOrUndefined(l.currentPage)||_.isNullOrUndefined(l.owner.selectionModule.start)||(l.owner.selectionModule.selectCurrentWord(),l.selection.checkForCursorVisibility(),l.tapCount=2)}}}},this.onMouseUpInternal=function(e){var t,i,n,r,o;!_.isNullOrUndefined(e.target)&&e.target!==l.viewerContainer||l.owner.isTableMarkerDragging||(e.preventDefault(),l.isListTextSelected=!1,r=new nl(e.offsetX,e.offsetY),t=l.owner.viewer.findFocusedPage(r,!0),_.isNullOrUndefined(l.selection)||(o=1,_.Browser.isIE?o=l.tapCount:2<e.detail&&(o=e.detail),l.isRowOrCellResizing&&l.owner.editorModule.tableResize.updateResizingHistory(t),!_.isNullOrUndefined(l.owner.editor)&&l.selection.checkContentControlLocked()&&l.owner.editorModule.insertContentControlPlaceholder(),!l.isMouseDown||l.isSelectionChangedOnMouseMoved||_.isNullOrUndefined(l.currentPage)||_.isNullOrUndefined(l.owner.selectionModule.start)||l.owner.enableImageResizerMode&&l.owner.imageResizerModule.isImageResizing||(0!==l.touchDownOnSelectionMark||l.isRowOrCellResizing||(e.shiftKey?(n=l.owner.selectionModule.end,l.owner.selectionModule.moveTextPosition(t,n)):(l.updateTextPositionForSelection(t,o),l.owner.selectionModule.isImageSelected?(n=l.owner.getImageContentControl())instanceof E&&"Picture"==n.contentControlProperties.type&&(n=l.owner.picturePositionY,l.owner.renderPictureContentControlElement(l.owner,!0,!1,n)):l.owner.renderPictureContentControlElement(l.owner,!1,!1)),_.Browser.isIE&&2===o&&l.selection.checkAndEnableHeaderFooter(r,t)),l.selection.checkForCursorVisibility(),_.isNullOrUndefined(l.currentSelectedComment))||!l.owner.commentReviewPane||l.owner.commentReviewPane.commentPane.isEditMode||(l.currentSelectedComment=void 0),n=l.isIosDevice?e.metaKey:e.ctrlKey,_.isNullOrUndefined(l.owner.editorModule)||_.isNullOrUndefined(l.owner.selectionModule)||(o=l.owner.editorModule.getContentControl(),r=l.owner.selectionModule.checkContentControlLocked(),(_.isNullOrUndefined(o)||o.contentControlProperties.lockContents||l.isDocumentProtected||!r||0!==e.button)&&(_.isNullOrUndefined(o)||o.contentControlProperties.lockContents||"FormFieldsOnly"!=l.protectionType||0!==e.button)||"CheckBox"===o.contentControlProperties.type&&(l.owner.editor.toggleContentControlCheckBox(o),o.contentControlProperties.isTemporary)&&l.owner.editor.removeContentControl(),o&&l.selection.selectPlaceHolderText(o)),_.isNullOrUndefined(l.currentPage)||_.isNullOrUndefined(l.owner.selectionModule.start)||!l.owner.selectionModule.isEmpty&&!l.owner.selectionModule.isImageSelected||!(n&&l.owner.useCtrlClickToFollowHyperlink||!l.owner.useCtrlClickToFollowHyperlink)||!0!==l.isLeftButtonPressed(e)||l.selection.navigateHyperLinkOnEvent(t,!1),l.isMouseDown&&l.isLeftButtonPressed(e)&&l.isDocumentProtected&&"FormFieldsOnly"===l.protectionType&&l.selection?(r=l.getLineWidget(t),i=l.selection.getHyperLinkFieldInCurrentSelection(r,t,!0),(i=_.isNullOrUndefined(i)?l.selection.getCurrentFormField(!0):i)&&i.formFieldData&&i.formFieldData.enabled&&!l.selection.isInlineFormFillMode(i)&&(o={fieldName:i.formFieldData.name},i.formFieldData instanceof Ch?o.value=i.resultText:i.formFieldData instanceof Fh?o.value=i.formFieldData.checked:o.value=i.formFieldData.selectedIndex,o.isCanceled=!1,"Popup"===l.owner.documentEditorSettings.formFieldSettings.formFillingMode&&(l.selection.previousSelectedFormField,l.selection.getCurrentFormField()),l.owner.trigger(ae,o),o.isCanceled||("Popup"===l.owner.documentEditorSettings.formFieldSettings.formFillingMode&&!(i.formFieldData instanceof Fh)||i.formFieldData instanceof Ch&&"Text"!==i.formFieldData.type||i.formFieldData instanceof Sh?l.formFillPopup.showPopUp(i):(l.owner.editorModule.toggleCheckBoxFormField(i),o.value=i.formFieldData.checked,o.isCanceled=!1,l.owner.trigger(se,o)))),!i&&l.isFormFillProtectedMode&&l.selection.navigateToNextFormField()):l.isMouseDown&&(0<l.formFields.length&&((i=l.selection.getCurrentFormField(!0))&&i.formFieldData instanceof Ch?l.selection.selectField():l.isLeftButtonPressed(e)&&i&&i.formFieldData instanceof Sh&&(n=i.line.getOffset(i,0),r=l.selection.getPhysicalPositionInternal(i.line,n,!1),l.selection.selectInternal(i.line,i,0,r))),l.isSelectionChangedOnMouseMoved)&&l.selection.fireSelectionChanged(!0),!l.owner.isReadOnlyMode&&l.isSelectionInListText(t)&&l.selection.selectListText(),!l.owner.isReadOnlyMode&&l.owner.enableImageResizerMode&&l.owner.imageResizerModule.isImageResizing&&(l.owner.imageResizerModule.mouseUpInternal(),l.scrollToPosition(l.owner.selectionModule.start,l.owner.selectionModule.end),l.owner.imageResizerModule.isImageResizing=!1),l.owner.enableImageResizerMode&&l.owner.imageResizerModule.isImageResizerVisible&&!_.isNullOrUndefined(l.selection.caret)&&(l.selection.caret.style.display="none"),l.isDragStarted&&(l.isDragging=!0,l.moveSelectedContent(),l.isDragging=!1),l.isMouseDown&&l.updateFocus(),l.isMouseDownInSelection=!1,l.isMouseDown=!1,l.isFootnoteWidget=!1,l.isSelectionChangedOnMouseMoved=!1,l.isTouchInput=!1,l.useTouchSelectionMark=!0,l.isControlPressed=!1,l.isListTextSelected&&l.selection.hideCaret(),l.owner.enableImageResizerMode&&((o=l.owner.imageResizerModule).isImageResizing=!1,o.isImageMoveToNextPage=!1,o.leftValue=void 0,o.topValue=void 0),l.isMouseDownInFooterRegion=!1),l.selection&&(l.selection.isCellPrevSelected=!1),0<l.owner.documentHelper.contentControlCollection.length&&(l.clearContent(),l.owner.documentHelper.viewer.updateScrollBars()))},this.onTouchStartInternal=function(e){var t,i,n;l.selection&&(l.isTouchMoved=!1,l.isCompositionStart=!1,l.isCompositionEnd=!1,l.isCompositionUpdated=!1,l.isCompositionCanceled=!0,l.isTouchInput=!0,l.isTimerStarted?1===l.tapCount?l.tapCount=2:(l.tapCount=3,l.isTimerStarted=!1):(l.isTimerStarted=!0,l.tapCount=1),1===e.touches.length&&(l.zoomX=e.touches[0].clientX,l.zoomY=e.touches[0].clientY,l.owner.selectionModule.isEmpty&&(l.useTouchSelectionMark=!1),l.isMouseDown=!0,l.isSelectionChangedOnMouseMoved=!1,t=void 0,l.isMouseDown&&(t=l.getTouchOffsetValue(e)),t=l.owner.viewer.findFocusedPage(t,!0,!0),l.owner.enableImageResizerMode&&(i=l.owner.imageResizerModule.getImagePointOnTouch(t),l.owner.imageResizerModule.selectedResizeElement=i.selectedElement),l.owner.enableImageResizerMode&&!_.isNullOrUndefined(l.owner.imageResizerModule.selectedResizeElement)&&(l.owner.imageResizerModule.isImageResizing=!0),_.Browser.isDevice&&(l.editableDiv.contentEditable=l.owner.isReadOnlyMode?"false":"true"),i=l.owner.selectionModule.end.location.x,n=l.selection.getCaretBottom(l.owner.selectionModule.end,l.owner.selectionModule.isEmpty)+9,l.touchDownOnSelectionMark=(t.y<=n&&t.y>=n-20||t.y>=n&&t.y<=n+20)&&(t.x<=i&&t.x>=i-20||t.x>=i&&t.x<=i+20)?1:0,l.owner.selectionModule.isEmpty||0!==l.touchDownOnSelectionMark||(i=l.owner.selectionModule.start.location.x,n=l.selection.getCaretBottom(l.owner.selectionModule.start,!1)+9,l.touchDownOnSelectionMark=(t.y<=n&&t.y>=n-20||t.y>=n&&t.y<=n+20)&&(t.x<=i&&t.x>=i-20||t.x>=i&&t.x<=i+20)?2:0)),!_.isNullOrUndefined(l.owner.contextMenuModule)&&l.owner.contextMenuModule.contextMenuInstance&&l.owner.contextMenuModule.contextMenuInstance.close(),(l.touchDownOnSelectionMark||1<e.touches.length)&&e.preventDefault(),l.longTouchTimer=setTimeout(l.onLongTouch,500,e),l.timer=setTimeout(function(){l.isTimerStarted=!1},200),l.owner.focusIn())},this.onLongTouch=function(e){var t,i,n,r,o,s,a;_.isNullOrUndefined(l.owner)||_.isNullOrUndefined(l.viewerContainer)||l.isTouchMoved||1!==e.touches.length||(t=l.getTouchOffsetValue(e),i=l.owner.viewer.findFocusedPage(t,!0),n=l.selection.start,r=l.selection.end,a=!1,l.selection.isForward||(n=l.selection.end,r=l.selection.start),o=n.location,s=r.location,a=n.currentWidget!==r.currentWidget?!(i.x>=o.x&&i.x<=s.x||i.y>=o.y&&i.y<=s.y):!(i.x>=o.x&&i.x<=s.x&&i.y>=o.y&&i.y<=s.y),1===e.changedTouches.length&&a&&(l.updateSelectionOnTouch(t,i),l.isMouseDown=!1,l.touchDownOnSelectionMark=0,l.useTouchSelectionMark=!0,l.isSelectionChangedOnMouseMoved=!1),l.selection.isEmpty&&l.selection.selectCurrentWord(),!_.isNullOrUndefined(l.owner.contextMenuModule)&&l.owner.contextMenuModule.contextMenuInstance&&l.owner.contextMenuModule.onContextMenuInternal(e))},this.onTouchMoveInternal=function(e){l.isTouchMoved=!0;var t,i,n,r=e.touches;if(!_.isNullOrUndefined(l.selection)){if(l.owner.editorModule&&l.owner.enableImageResizerMode&&l.owner.imageResizerModule.isImageResizing)return e.preventDefault(),void(l.owner.imageResizerModule.isImageMoveToNextPage||(l.owner.imageResizerModule.handleImageResizingOnTouch(e),l.selection.caret.style.display="none"));l.isMouseDown&&(t=l.getTouchOffsetValue(e),t=l.owner.viewer.findFocusedPage(t,!0),0<l.touchDownOnSelectionMark&&(l.isCompleted=!1,e.preventDefault(),n=t.y,i=l.owner.selectionModule.end,t.y<=26?n-=t.y<0?0:t.y+.5:n-=36.5,i=2===l.touchDownOnSelectionMark?l.selection.start:l.selection.end,t=new nl(t.x,n),l.owner.selectionModule.moveTextPosition(t,i),l.isSelectionChangedOnMouseMoved=!0),l.selection.checkForCursorVisibility(),l.updateTouchMarkPosition())}1<r.length&&(e.preventDefault(),l.isMouseDown=!1,l.zoomX=(r[0].clientX+r[1].clientX)/2,l.zoomY=(r[0].clientY+r[1].clientY)/2,n=Math.sqrt(Math.pow(r[0].clientX-r[1].clientX,2)+Math.pow(r[0].clientY-r[1].clientY,2)),-1<l.preDifference?n>l.preDifference?l.onPinchOutInternal(e):n<l.preDifference&&l.onPinchInInternal(e):l.zoomFactor<2?-1!==l.preDifference&&n>l.preDifference&&l.onPinchInInternal(e):-1===l.preDifference&&2<l.zoomFactor&&n>l.preDifference&&l.onPinchInInternal(e),l.preDifference=n),l.longTouchTimer&&(clearTimeout(l.longTouchTimer),l.longTouchTimer=void 0)},this.onTouchUpInternal=function(e){var t,i;_.isNullOrUndefined(l.selection)||(t=l.getTouchOffsetValue(e),i=l.owner.viewer.findFocusedPage(t,!0),1===e.changedTouches.length&&((!l.isTouchMoved||l.owner.enableImageResizerMode&&l.owner.imageResizerModule.isImageResizing)&&(l.updateSelectionOnTouch(t,i),_.isNullOrUndefined(l.currentPage)||_.isNullOrUndefined(l.selection.start)||l.isSelectionChangedOnMouseMoved||!(l.selection.isEmpty||l.selection.isImageField()&&(!l.owner.enableImageResizerMode||l.owner.enableImageResizerMode&&!l.owner.imageResizerModule.isImageResizing))||l.selection.navigateHyperLinkOnEvent(i,!0)),l.isSelectionChangedOnMouseMoved&&l.selection.fireSelectionChanged(!0),l.isMouseDown=!1,l.touchDownOnSelectionMark=0,l.useTouchSelectionMark=!0,l.isSelectionChangedOnMouseMoved=!1),l.owner.enableImageResizerMode&&l.owner.imageResizerModule.isImageResizing&&(l.owner.imageResizerModule.mouseUpInternal(),l.owner.imageResizerModule.isImageResizing=!1,l.owner.imageResizerModule.isImageMoveToNextPage=!1,l.scrollToPosition(l.owner.selectionModule.start,l.owner.selectionModule.end)),l.owner.enableImageResizerMode&&l.owner.imageResizerModule.isImageResizerVisible&&l.isTouchInput&&(l.touchStart.style.display="none",l.touchEnd.style.display="none"),e.preventDefault()),l.preDifference=-1,l.isTouchInput=!1,l.longTouchTimer&&(clearTimeout(l.longTouchTimer),l.longTouchTimer=void 0),l.isTimerStarted||(l.tapCount=1),l.isListTextSelected&&l.selection.hideCaret(),l.owner.focusIn()},this.onKeyUpInternal=function(e){_.Browser.isDevice&&e.target===l.editableDiv&&window.getSelection().anchorOffset!==l.prefix.length&&l.selection.setEditableDivCaretPosition(l.editableDiv.innerText.length),!e.ctrlKey&&17!==e.keyCode&&17!==e.which||(l.isControlPressed=!1)},this.onKeyDownInternal=function(e){if(_.isNullOrUndefined(e.target)||e.target===l.editableDiv){l.owner.focusIn();var t=!1,i={event:e,isHandled:!1,source:l.owner};if(l.owner.trigger(Ie,i),!i.isHandled){var i=e.which||e.keyCode,n=!(!e.ctrlKey&&!e.metaKey)||17===i,r=e.shiftKey||16===i,o=e.altKey||18===i;if(n&&!r&&!o)switch(i){case 80:e.preventDefault(),l.owner.print(),t=!0;break;case 83:e.preventDefault(),l.owner.save(""===l.owner.documentName?"sample":l.owner.documentName,"Sfdt"),t=!0}8!==e.keyCode&&46!==e.keyCode&&!_.isNullOrUndefined(l.owner.editor)&&l.selection.checkContentControlLocked()&&l.owner.editorModule.insertContentControlPlaceholder(),t||_.isNullOrUndefined(l.selection)||l.selection.onKeyDownInternal(e,n,r,o),!_.isNullOrUndefined(l.owner.documentHelper)&&0<l.owner.documentHelper.contentControlCollection.length&&(l.clearContent(),l.owner.documentHelper.viewer.updateScrollBars()),t&&e.preventDefault(),l.timer=setTimeout(function(){l.isScrollHandler||_.isNullOrUndefined(l.owner)||!l.owner.isSpellCheck||(l.isScrollToSpellCheck=!0,l.owner.viewer.updateScrollBars())},100)}}},this.owner=e,this.pages=[],this.lists=[],this.abstractLists=[],this.render=new Zl(this),this.characterFormat=new B(this),this.themeFontLanguage=new B(this),this.paragraphFormat=new Xa(this),this.renderedLists=new T,this.renderedLevelOverrides=[],this.headersFooters=[],this.styles=new xl,this.stylesMap=new T,this.owner&&(this.L10n=new _.L10n("documenteditor",this.owner.defaultLocale),this.L10n.setLocale(this.owner.locale)),this.preDefinedStyles=new T,this.initalizeStyles(),this.bookmarks=new T,this.editRanges=new T,this.isIosDevice="undefined"!=typeof window&&/Mac|iPad|iPod/i.test(navigator.userAgent),this.isMobileDevice="undefined"!=typeof window&&/Android|Windows Phone|webOS/i.test(navigator.userAgent),this.formFillPopup=new od(this.owner),this.contentDropDown=new ad(this.owner),this.customXmlData=new T,this.fontSubstitutionTable=new T,this.contentControlCollection=[],this.footnoteCollection=[],this.endnoteCollection=[],this.themes=new wd,this.images=new T}Object.defineProperty(Pd.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(Pd.prototype,"pageFitType",{get:function(){return this.pageFitTypeIn},set:function(e){this.pageFitTypeIn=e,this.onPageFitTypeChanged(this.pageFitTypeIn)},enumerable:!0,configurable:!0}),Pd.prototype.updateClientArea=function(e,t,i){_.isNullOrUndefined(e)||(n=e.sectionFormat,this.columnLayoutArea.setColumns(n));var n,r,o,s,a,l,d,h,c=0,p=0;this instanceof Wd?((c=(this.documentHelper.visibleBounds.width-4*this.padding.right-2*this.padding.left)/this.documentHelper.zoomFactor)<0&&(c=0),p=Number.POSITIVE_INFINITY,this.clientArea=new Rd(this.padding.left/this.documentHelper.zoomFactor,0,c,p)):(r=0,h=a=48,o=j.convertPointToPixel(n.pageHeight),s=j.convertPointToPixel(n.bottomMargin),_.isNullOrUndefined(n)||(r=j.convertPointToPixel(n.topMargin),a=j.convertPointToPixel(n.headerDistance),h=j.convertPointToPixel(n.footerDistance)),d=!1,_.isNullOrUndefined(t.headerWidget)||(d=t.headerWidget.isEmpty,0<=r?d&&!this.owner.enableHeaderAndFooter||(r=Math.min(Math.max(a+t.headerWidget.height,r),o/100*40)):r=Math.abs(r)),a=.667+s,_.isNullOrUndefined(t.footerWidget)||(d=t.footerWidget.isEmpty,l=_.isNullOrUndefined(t.footnoteWidget)?0:t.footnoteWidget.height,l=Math.min(l,(o-r-a)/100*90),0<=a?d&&!this.owner.enableHeaderAndFooter||(a=.667+Math.min(o/100*40,Math.max(h+t.footerWidget.height,s))):a=Math.abs(a),a+=l),_.isNullOrUndefined(n)||(c=j.convertPointToPixel(n.pageWidth-n.leftMargin-n.rightMargin),p=o-r-a),c<0&&(c=0),d=new Rd(j.convertPointToPixel(n.leftMargin),r,c,o-r-a),t.footnoteWidget&&i&&!this.documentHelper.owner.editorModule.isFootNote&&0!==t.footnoteWidget.y&&this.clientArea.y+this.clientArea.height>t.footnoteWidget.y&&(h=this.clientArea.y+this.clientArea.height-t.footnoteWidget.y,this.clientArea.height-=h/2),0!==e.page.bodyWidgets[0].columnIndex&&this.owner.editorModule.updateColumnIndex(e,!1),this.setClientArea(e,d)),this.clientActiveArea=new Rd(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},Pd.prototype.setClientArea=function(e,t){this.clientArea=this.columnLayoutArea.getColumnBoundsByBodyWidget(e,t),e.x=this.clientArea.x,e.width=this.clientArea.width},Pd.prototype.updateClientAreaTopOrLeft=function(e,t){t&&(this.clientActiveArea.y=this.clientActiveArea.y+e.topBorderWidth,this.clientActiveArea.x=this.clientActiveArea.x+e.leftBorderWidth)},Pd.prototype.updateClientAreaForTable=function(e){this.clientActiveArea.x=this.clientArea.x=e.x,this.clientActiveArea.width=this.clientArea.width=e.width},Pd.prototype.updateClientAreaForRow=function(e,t){e=e.ownerTable;t||(this.clientActiveArea.x=this.clientArea.x=e.x,this.clientActiveArea.width=this.clientArea.width=e.width,this.clientArea=new Rd(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new Rd(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height))},Pd.prototype.updateClientAreaForCell=function(e,t){var i=e.ownerRow,n=e;t?(this.clientActiveArea.x=this.clientArea.x=n.x,this.clientActiveArea.y=n.y,this.clientActiveArea.width=this.clientArea.width=0<n.width?n.width:0,this instanceof Sd&&(this.clientActiveArea.height=Number.POSITIVE_INFINITY)):(this.clientActiveArea.x=this.clientArea.x=n.x+n.width+n.margin.right,i.x+i.width-this.clientArea.x<0?this.clientActiveArea.width=this.clientArea.width=0:this.clientActiveArea.width=this.clientArea.width=i.x+i.width-this.clientArea.x,this.clientActiveArea.y=n.y-n.margin.top-j.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing),e.ownerTable.isInsideTable||(this.clientActiveArea.height=0<this.clientArea.bottom-i.y?this.clientArea.bottom-i.y:0,!e.ownerTable.wrapTextAround&&0<this.documentHelper.layout.existFootnoteHeight&&(t=this.clientActiveArea.height-this.documentHelper.layout.existFootnoteHeight,this.clientActiveArea.height=t<0?0:t))),this.clientArea=new Rd(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new Rd(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)},Pd.prototype.updateClientAreaForTextBoxShape=function(e,t,i){var n,r,o,s;"Inline"!==e.textWrappingStyle||i||(e.y=this.clientActiveArea.y,e.x=this.clientActiveArea.x),t&&(i=j.convertPointToPixel(e.textFrame.marginLeft),t=j.convertPointToPixel(e.textFrame.marginRight),n=j.convertPointToPixel(e.textFrame.marginTop),r=j.convertPointToPixel(e.textFrame.marginBottom),o=e.width,s=Number.POSITIVE_INFINITY,this.clientArea=new Rd(e.x+i,e.y+n,o-i-t,s-n-r),this.clientActiveArea=new Rd(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height))},Pd.prototype.updateClientAreaByWidgetFootNote=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},Pd.prototype.updateClientAreaForTextWrap=function(e){this.clientActiveArea=new Rd(e.x,e.y,e.width,e.height)},Pd.prototype.updateBoundsBasedOnTextWrap=function(e){var t=e-this.clientActiveArea.y;this.clientActiveArea.y=e,this.clientActiveArea.height=this.clientActiveArea.height-t},Pd.prototype.updateBoundsBasedOnTextWrapTable=function(e){var t=e-this.clientArea.y;this.clientArea.y=e,this.clientArea.height=this.clientArea.height-t,this.clientActiveArea=new Rd(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},Pd.prototype.updateClientAreaByWidget=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},Pd.prototype.updateClientAreaLocation=function(e,t){e.x=t.x,e.y=t.y,e.width=t.width},Pd.prototype.updateClientAreaForBlock=function(e,t,i,n,r){var o,s,a=j.convertPointToPixel(e.leftIndent),l=j.convertPointToPixel(e.rightIndent),d=e.bidi,h=0;t?e instanceof K&&i?(t=i[0],e.bodyWidget.sectionFormat.columns.length<=1&&(this.clientActiveArea.x=this.clientArea.x=t.x,this.clientActiveArea.width=this.clientArea.width=t.width),(t=i[i.length-1]).x=this.clientActiveArea.x,t.y=this.clientActiveArea.y):(e instanceof K&&!_.isNullOrUndefined(e.tableFormat)&&(e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Left"!==(o=this.tableAlignmentForBidi(e,d)))&&(i=(i=0)===(i=j.convertPointToPixel(e.tableHolder.getTotalWidth(0)))?0===e.tableHolder.tableWidth?e.getTableClientWidth(e.getOwnerWidth(!1)):e.tableHolder.tableWidth:i,this.owner.editorModule&&this.owner.editorModule.tableResize.currentResizingTable===e&&0===this.owner.editorModule.tableResize.resizerPosition&&(i=j.convertPointToPixel(e.tableHolder.tableWidth)),a="Center"===o?(this.documentHelper.isRowOrCellResizing||(i=e.getTableCellWidth()),(this.clientArea.width-i)/2):this.clientArea.width-i,d&&(l=a-=j.convertPointToPixel(e.leftIndent)),e.isInsideTable,this.documentHelper.tableLefts.push(a)),h=this.clientArea.width-(a+j.convertPointToPixel(e.rightIndent)),s=this.clientArea.x+(d?l:a),h=0<h?h:0,this.clientActiveArea.x=this.clientArea.x=s,this.clientActiveArea.width=this.clientArea.width=h,n&&this.updateParagraphYPositionBasedonTextWrap(e,new Rd(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)),r&&(e instanceof G?this.updateParagraphXPositionBasedOnTextWrap(e):this.updateTableXPositionBasedOnTextWrap(e))):(e instanceof K&&!_.isNullOrUndefined(e.tableFormat)&&(o=this.tableAlignmentForBidi(e,d),e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Left"!==o)&&0<this.documentHelper.tableLefts.length&&(a=this.documentHelper.tableLefts.pop(),d)&&(l=a),h=this.clientArea.width+a+j.convertPointToPixel(e.rightIndent),s=this.clientArea.x-(d?l:a),h=0<h?h:0,this.clientActiveArea.x=this.clientArea.x=s,this.clientActiveArea.width=this.clientArea.width=h),this.clientArea=new Rd(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new Rd(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)},Pd.prototype.updateParagraphYPositionBasedonTextWrap=function(e,t){var i=e.bodyWidget,n=this.clientActiveArea;if(i&&0<i.floatingElements.length&&e instanceof G&&!(e.containerWidget instanceof fc)&&!e.isInsideTable&&!(e.containerWidget instanceof q)){var r="Word2013"===this.documentHelper.compatibilityMode,o=e,s=o.isEmpty(),a=o.height;if(0===a&&(a=this.documentHelper.textHelper.getParagraphMarkSize(o.characterFormat).Height),!o.isInHeaderFooter||o.isInsideTable||r){var l=t.y,d=!1,h=(i.floatingElements.sort(function(e,t){return e.y-t.y}),i.floatingElements.sort(function(e,t){return e.x-t.x}),o.previousRenderedWidget);h&&h instanceof K&&h.wrapTextAround&&!s&&!o.isContainsShapeAlone()&&r&&t.y<h.y&&(t.y=h.y);for(var c=0;c<i.floatingElements.length;c++){var p,u,g,m,f,y,v=i.floatingElements[c],w=!1,w=v instanceof hc?v.paragraph.isInHeaderFooter:v.bodyWidget instanceof Xd;o.isInsideTable&&v instanceof K&&!v.isInsideTable||(p=this.getTextWrappingBound(v),u=v instanceof K?"Square":v.textWrappingStyle,g=v instanceof K?"Both":v.textWrappingType,n.x>p.right+24)||n.right<p.x-24||((t.y+(v instanceof K&&!s&&0===o.floatingElements.length?a:o.height)>p.y||d)&&t.y<p.bottom&&"Inline"!==u&&"TopAndBottom"!==u&&"InFrontOfText"!==u&&"Behind"!==u?(y=0,m=j.convertPointToPixel(o.paragraphFormat.rightIndent),f=j.convertPointToPixel(o.paragraphFormat.firstLineIndent),f=!s&&o.childWidgets[0].isFirstLine()&&0<f?f:0,y=(y=t.x>=p.x&&"Left"!==g?m:y)<0?y:0,t.x<p.x&&t.x>p.x&&"Left"!==g?(t.right>p.x&&(t.width=t.width-(t.right-p.right)),t.width<24?(!r&&v instanceof K&&h===v||(this.updateBoundsBasedOnTextWrap(p.bottom),t=this.clientActiveArea),((!s&&o.childWidgets[0].isFirstLine()||s)&&r||!w)&&(o.y=this.clientActiveArea.y)):t.x=p.right):t.x>=p.x&&t.x<p.right?(t.width=t.width-(p.right-t.x)-y,(t.width<24||d)&&(t.width=this.clientActiveArea.right-p.right-y,f=!1,t.width<24||d)?(this.clientActiveArea.x+24<p.x&&(m=this.getIntersectingItemBounds(i.floatingElements,v,l),!_.isNullOrUndefined(m))&&m.bottom<=p.bottom&&(this.updateBoundsBasedOnTextWrap(m.bottom),t=this.clientActiveArea,f=!0,o.x=m.x),r&&!f&&(v instanceof K&&h===v?this.updateBoundsBasedOnTextWrapTable(p.bottom):this.updateBoundsBasedOnTextWrap(p.bottom),t=this.clientActiveArea),((!s&&o.childWidgets[0].isFirstLine()||s)&&r||!w)&&(o.y=this.clientActiveArea.y)):t.x=p.right):p.x>t.x&&t.right>p.x&&(t.width=p.x-t.x,t.width<24)&&(t.width=this.clientActiveArea.right-p.right-y,t.width<24?(!r&&v instanceof K&&h===v||(this.updateBoundsBasedOnTextWrap(p.bottom),t=this.clientActiveArea),((!s&&o.childWidgets[0].isFirstLine()||s)&&r||!w)&&(o.y=this.clientActiveArea.y)):t.x=p.right)):0<i.floatingElements.length&&(t.y>=p.y&&t.y<p.bottom||t.y+a>=p.y&&t.y+a<p.bottom)&&"TopAndBottom"===u&&(!r&&v instanceof K&&h===v||(this.updateBoundsBasedOnTextWrap(p.bottom),!r&&(!s&&o.childWidgets[0].isFirstLine()||s)&&(d=!0)),(!s&&o.childWidgets[0].isFirstLine()||s)&&r||!w)&&(o.y=this.clientActiveArea.y))}}}},Pd.prototype.updateParagraphXPositionBasedOnTextWrap=function(e){var t="Word2013"===this.documentHelper.compatibilityMode,i=e.containerWidget,n=this.clientActiveArea;if(this instanceof Sd&&!_.isNullOrUndefined(i)&&e instanceof G&&!_.isNullOrUndefined(i.page)&&!_.isNullOrUndefined(i.page.headerWidget)){var r=i.page.headerWidget.floatingElements;if(0<r.length&&(!e.isInHeaderFooter||e.isInsideTable||t)&&!(e.containerWidget instanceof q)&&!(e.bodyWidget instanceof fc))for(var o=e,s=0;s<r.length;s++){var a,l,d=r[s];o.isInsideTable&&d instanceof K&&!d.isInsideTable||(a=this.getTextWrappingBound(d),l=d instanceof K?"Square":d.textWrappingStyle,d instanceof K||d.textWrappingType,o.isInsideTable)||n.x>a.right+24||n.right<a.x-24||0<r.length&&n.y+o.height>a.y&&n.y<a.bottom&&"Inline"!==l&&"TopAndBottom"!==l&&"InFrontOfText"!==l&&"Behind"!==l&&(d=j.convertPointToPixel(o.paragraphFormat.rightIndent),"Left"!=o.paragraphFormat.textAlignment&&n.x<a.x&&n.x+o.width>a.x?o.x=n.x:n.x>=a.x&&n.x<a.right&&!o.paragraphFormat.bidi?(n.width=n.width-(a.right-n.x)-d,n.width<24?(n.width=this.clientActiveArea.right-a.right-d,n.width<24?(o.x=n.x,n.width=n.width,n.height=a.bottom-n.x,n.y=a.bottom):n.x=a.right):("Word2007"===this.documentHelper.compatibilityMode||n.y<=a.bottom)&&j.convertPointToPixel(o.paragraphFormat.leftIndent)+j.convertPointToPixel(o.paragraphFormat.firstLineIndent)+n.x<a.right&&(n.x=a.right)):(a.x-24>n.x&&n.right>a.x||n.x>a.x&&n.x>a.right)&&(o.x=n.x))}}},Pd.prototype.updateTableXPositionBasedOnTextWrap=function(e){var t=j.convertPointToPixel(e.childWidgets[0].getFirstRowWidth()),i=e.bodyWidget;if(this instanceof Sd&&!_.isNullOrUndefined(i)&&!_.isNullOrUndefined(i.page)&&!_.isNullOrUndefined(i.page.headerWidget)){var n=i.page.headerWidget.floatingElements;if(!(!(0<n.length)||e.isInHeaderFooter&&e.isInsideTable&&"Word2013"!==this.documentHelper.compatibilityMode||e.containerWidget instanceof fc))for(var r=this.clientActiveArea,o=0;o<n.length;o++){var s=n[o],a=this.getTextWrappingBound(s),l=s instanceof K?"Square":s.textWrappingStyle,s=(s instanceof K?s.positioning:s).allowOverlap,d=this.documentHelper.getFirstParagraphInFirstCell(e),d=this.documentHelper.textHelper.getParagraphMarkSize(d.characterFormat).Height,h=e.childWidgets[0]instanceof dh?e.childWidgets[0].height:0,h=(d<h&&(d=h),j.convertPointToPixel(e.getTableClientWidth(e.getContainerWidth())));this.clientArea.x>a.right+24||this.clientArea.right<a.x-24||this.isFloatingItemIntersect(e,r,a,l,s,d,h)&&r.x>=a.x&&r.x<a.right&&(r.width=r.width-(a.right-r.x),(r.width<24||r.width<t&&0<t)&&(r.width=this.clientActiveArea.right-a.right,r.width<24||r.width<t&&0<t&&this.clientArea.right<=t+a.right)?(l=a.bottom>r.y?a.bottom-r.y:0,r.y=a.bottom,r.width=this.clientArea.width,r.height=r.height-l):r.x=a.right,this.updateClientAreaForTextWrap(r))}}},Pd.prototype.isFloatingItemIntersect=function(e,t,i,n,r,o,s){return(Math.round(t.y+o)>=Math.round(i.y)&&Math.round(t.y)<Math.round(i.bottom)||Math.round(t.y+o)<=Math.round(i.bottom)&&Math.round(t.y+o)>=Math.round(i.y))&&"Inline"!==n&&"TopAndBottom"!==n&&"InFrontOfText"!==n&&"Behind"!==n&&!(r&&null!==e.tableFormat&&e.wrapTextAround&&e.positioning.allowOverlap)},Pd.prototype.getIntersectingItemBounds=function(e,t,i){e=this.getMinBottomFloatingItem(e,this.getIntersectingFloatingItems(e,t,i));if(!_.isNullOrUndefined(e))return this.getTextWrappingBound(e)},Pd.prototype.getMinBottomFloatingItem=function(e,t){var i=-1,n=Number.MAX_VALUE,r=0;e.sort(function(e,t){return e.x-t.x});for(var o=0;o<t.length;o++){var s=e[o],a=this.getTextWrappingBound(s);n>a.bottom&&(s&&t.indexOf(s)+1<t.length?r++:(n=a.bottom,i=t.indexOf(s)))}return i-r==0?t[i]:null},Pd.prototype.getIntersectingFloatingItems=function(e,t,i){for(var n=[],r=0;r<e.length;r++){var o=e[r],s=this.getTextWrappingBound(o),a=this.getTextWrappingBound(t);i<=s.bottom&&a.bottom>=s.bottom&&s.right>this.clientActiveArea.x&&s.x<a.x&&n.push(o)}return n},Pd.prototype.getTextWrappingBound=function(e){var t=0,i=0,n=0,r=0,o=0;return e instanceof hc?(t=e.distanceLeft,i=e.distanceTop,n=e.distanceRight,r=e.distanceBottom,o=e.width):(o=e.getTableCellWidth(),t=e.positioning.distanceLeft,i=e.positioning.distanceTop,n=e.positioning.distanceRight,r=e.positioning.distanceBottom),new Rd(e.x-t,e.y-i,o+t+n,e.height+i+r)},Pd.prototype.tableAlignmentForBidi=function(e,t){e=e.tableFormat.tableAlignment;return t&&("Left"===e?e="Right":"Right"===e&&(e="Left")),e},Pd.prototype.cutFromLeft=function(e){(e=e<this.clientActiveArea.x?this.clientActiveArea.x:e)>this.clientActiveArea.right&&this.textWrap&&(e=this.clientActiveArea.right),this.clientActiveArea.width=this.clientActiveArea.right>e?this.clientActiveArea.right-e:0,this.clientActiveArea.x=e},Pd.prototype.cutFromTop=function(e){(e=e<this.clientActiveArea.y?this.clientActiveArea.y:e)>this.clientActiveArea.bottom&&(e=this.clientActiveArea.bottom),this.clientActiveArea.height=this.clientActiveArea.bottom-e,this.clientActiveArea.x=this.clientArea.x,this.clientActiveArea.width=this.clientArea.width,this.clientActiveArea.y=e},Pd.prototype.updateClientWidth=function(e){this.clientActiveArea.x-=e,0<this.clientActiveArea.width+e?this.clientActiveArea.width+=e:this.clientActiveArea.width=0},Pd.prototype.findFocusedPage=function(e,t,i){var n=new nl(e.x,e.y);n.x+=this.documentHelper.viewerContainer.scrollLeft,n.y+=this.documentHelper.viewerContainer.scrollTop;for(var r=0;r<this.documentHelper.pages.length;r++){var o=this.documentHelper.pages[r],s=(o.boundingRectangle.y-this.pageGap*(r+1))*this.documentHelper.zoomFactor+this.pageGap*(r+1),a=o.boundingRectangle.height*this.documentHelper.zoomFactor+this.pageGap,l=o.boundingRectangle.x,d=void 0,d=this instanceof Sd?(o.boundingRectangle.right-l)*this.documentHelper.zoomFactor+l:o.boundingRectangle.right+l;if(s<=n.y&&s+a>=n.y)return t&&(this.documentHelper.currentPage=o,i)&&(_.isNullOrUndefined(o.headerWidget)||(o.headerWidget.page=o),_.isNullOrUndefined(o.footerWidget)||(o.footerWidget.page=o)),n.y=(n.y-s)/this.documentHelper.zoomFactor,n.x>d?n.x=o.boundingRectangle.right:n.x<l?n.x=0:n.x=(n.x-l)/this.documentHelper.zoomFactor,n}return n},Pd.prototype.getPageHeightAndWidth=function(e,t,i,n){for(var r=e=0;r<this.documentHelper.pages.length;r++)e+=this.documentHelper.pages[r].boundingRectangle.height;for(r=t=0;r<this.documentHelper.pages.length;r++)t<this.documentHelper.pages[r].boundingRectangle.width&&(t=this.documentHelper.pages[r].boundingRectangle.width);return{height:e,width:t,viewerWidth:this.documentHelper.visibleBounds.width,viewerHeight:this.documentHelper.visibleBounds.height}},Pd.prototype.renderVisiblePages=function(){if(!(_.isNullOrUndefined(this.visiblePages)||this.visiblePages.length<1)){this.documentHelper.clearContent();for(var e=0;e<this.visiblePages.length;e++){var t=this.visiblePages[e],i=t.boundingRectangle.width*this.documentHelper.zoomFactor,n=t.boundingRectangle.height*this.documentHelper.zoomFactor,r=t.boundingRectangle.x,o=(t.boundingRectangle.y-this.pageGap*(e+1))*this.documentHelper.zoomFactor+this.pageGap*(e+1);this.owner.viewer.renderPage(t,r,o,i,n)}}},Pd.prototype.handleZoom=function(){var e=this.documentHelper.preZoomFactor,t=null,i=0,n=!1;this.documentHelper.selection&&_.isNullOrUndefined(this.documentHelper.zoomX&&_.isNullOrUndefined(this.documentHelper.zoomY))&&(s=c=0,a=this.documentHelper.selection.getPage(this.documentHelper.selection.end.currentWidget.paragraph),(c=(this.documentHelper.visibleBounds.width-a.boundingRectangle.width*e)/2)<30&&(c=30),s=a.boundingRectangle.y*e+(this.documentHelper.pages.indexOf(a)+1)*this.pageGap*(1-e),l=(a=this.documentHelper.selection.updateCaretSize(this.owner.selectionModule.end,!0)).topMargin,a.height,c+=this.documentHelper.selection.end.location.x*e,s+=(this.documentHelper.selection.end.location.y+l)*e,c>=this.containerLeft)&&c<=this.documentHelper.visibleBounds.width&&s>=this.containerTop&&s<=this.containerTop+this.documentHelper.visibleBounds.height&&(n=!0);for(var r=0;r<this.documentHelper.pages.length;r++)i+=this.documentHelper.pages[r].boundingRectangle.height;for(var o=0,r=0;r<this.documentHelper.pages.length;r++)o<this.documentHelper.pages[r].boundingRectangle.width&&(o=this.documentHelper.pages[r].boundingRectangle.width);var s,a=i*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap*(1-this.documentHelper.zoomFactor)-this.documentHelper.visibleBounds.height,l=o*this.documentHelper.zoomFactor-this.documentHelper.visibleBounds.width;if(this.documentHelper.visibleBounds.width-o*this.documentHelper.zoomFactor<60&&(l+=60),0<a){var d=this.containerTop;if(0<this.visiblePages.length){for(var h=((t=this.visiblePages[0]).boundingRectangle.y-(t.index+1)*this.pageGap)*e+(t.index+1)*this.pageGap,c=this.documentHelper.zoomY,p=d+(c=_.isNullOrUndefined?this.documentHelper.visibleBounds.height/2:c);p>h+t.boundingRectangle.height*e;){var u=t.index+1;if(u===this.documentHelper.pages.length)break;h=((t=this.documentHelper.pages[u]).boundingRectangle.y-(t.index+1)*this.pageGap)*e+(t.index+1)*this.pageGap}d=(t.boundingRectangle.y-(t.index+1)*this.pageGap)*this.documentHelper.zoomFactor+(t.index+1)*this.pageGap+(p-h<0?p-h:(p-h)*(this.documentHelper.zoomFactor/e))-c,c=this.documentHelper.visibleBounds.height/2}this.documentHelper.viewerContainer.scrollTop=d}else this.documentHelper.viewerContainer.scrollTop=0;0<l?(d=this.containerLeft,0<this.visiblePages.length&&(null===t&&(t=this.visiblePages[0]),s=this.documentHelper.zoomX,_.isNullOrUndefined(s)&&(s=this.documentHelper.visibleBounds.width/2),a=t.boundingRectangle.width*e/t.boundingRectangle.width,d=t.boundingRectangle.x+((c=d+s)-t.boundingRectangle.x<0?c-t.boundingRectangle.x:(c-t.boundingRectangle.x)*(this.documentHelper.zoomFactor/a))-s,s=this.documentHelper.visibleBounds.width/2),this.documentHelper.viewerContainer.scrollLeft=d):this.documentHelper.viewerContainer.scrollLeft=0,this.updateScrollBars(),n&&this.documentHelper.scrollToPosition(this.documentHelper.selection.start,this.documentHelper.selection.end),this instanceof Wd&&this.owner.editorModule.layoutWholeDocument()},Pd.prototype.updateCanvasWidthAndHeight=function(e,t,i,n,r,o){this instanceof Sd?this.documentHelper.visibleBounds.width!==this.documentHelper.viewerContainer.clientWidth?e-=this.documentHelper.visibleBounds.width-this.documentHelper.viewerContainer.clientWidth:t<i&&(e-=this.documentHelper.viewerContainer.offsetWidth-this.documentHelper.viewerContainer.clientWidth):t<i&&(e-=this.documentHelper.scrollbarWidth,n-=this.documentHelper.scrollbarWidth),e<n&&(t-=this.documentHelper.scrollbarWidth),r=e<n?n:e,o=t<i?i:t,parseInt(this.documentHelper.pageContainer.style.width.replace("px",""),10)===r&&parseInt(this.documentHelper.pageContainer.style.height.replace("px",""),10)===r||(this.documentHelper.pageContainer.style.width=r.toString()+"px",this.documentHelper.pageContainer.style.height=o.toString()+"px");var s=Math.max(1,window.devicePixelRatio||1);return this.documentHelper.containerCanvas.width===Math.floor(e*s)&&this.documentHelper.containerCanvas.height===Math.floor(t*s)||(this.documentHelper.containerCanvas.width=e*s,this.documentHelper.containerCanvas.height=t*s,this.documentHelper.containerCanvas.style.width=e+"px",this.documentHelper.containerCanvas.style.height=t+"px",this.documentHelper.containerContext.scale(s,s),this.documentHelper.selectionCanvas.width=e*s,this.documentHelper.selectionCanvas.height=t*s,this.documentHelper.selectionCanvas.style.width=e+"px",this.documentHelper.selectionCanvas.style.height=t+"px",this.documentHelper.selectionContext.scale(s,s)),{height:o,width:r,viewerWidth:e,viewerHeight:t,containerHeight:i,containerWidth:n}},Pd.prototype.updateScrollBarPosition=function(e,t,i,n,r,o){this.owner.viewer.containerTop=this.documentHelper.viewerContainer.scrollTop,this.owner.viewer.containerWidth=e,this.documentHelper.containerCanvas.style.position="absolute",this.documentHelper.containerCanvas.style.top=this.owner.viewer.containerTop.toString()+"px",this.documentHelper.selectionCanvas.style.position="absolute",this.documentHelper.selectionCanvas.style.top=this.owner.viewer.containerTop.toString()+"px",this.owner.viewer.containerLeft=this.documentHelper.viewerContainer.scrollLeft,this.documentHelper.containerCanvas.style.left=this.owner.viewer.containerLeft+"px",this.documentHelper.selectionCanvas.style.left=this.owner.viewer.containerLeft+"px"},Pd.prototype.destroy=function(){this.clientArea=void 0,this.clientActiveArea=void 0},Pd.prototype.componentDestroy=function(){this.clientArea=void 0,this.clientActiveArea=void 0,this.owner=void 0};var Fd=Pd;function Pd(e){this.visiblePages=[],this.padding=new Ad(10,10,30,10),this.textWrap=!0,this.pageFitTypeIn="None",this.containerTop=0,this.containerWidth=0,this.containerLeft=0,this.owner=e,this.columnLayoutArea=new Ed(this)}pl(Hd,Td=Fd),Object.defineProperty(Hd.prototype,"pageGap",{get:function(){return this.owner.pageGap},enumerable:!0,configurable:!0}),Object.defineProperty(Hd.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Hd.prototype.createNewPage=function(e,t){var i=this.pageGap,n=(0<this.documentHelper.pages.length&&(i=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom+this.pageGap),new vp(this.documentHelper));return this.updatePageBoundingRectangle(e,n,i),_.isNullOrUndefined(t)?this.documentHelper.pages.push(n):this.documentHelper.pages.splice(t,0,n),n.bodyWidgets.push(e),n.bodyWidgets[n.bodyWidgets.length-1].page=n,this.updateClientArea(e,n),this.documentHelper.layout.layoutHeaderFooter(e,this,n),this.updateClientArea(e,n),this.documentHelper.layout.footnoteHeight=0,n},Hd.prototype.updatePageBoundingRectangle=function(e,t,i){var n=_.isNullOrUndefined(e.sectionFormat)?816:j.convertPointToPixel(e.sectionFormat.pageWidth),e=_.isNullOrUndefined(e.sectionFormat)?1056:j.convertPointToPixel(e.sectionFormat.pageHeight),r=(this.documentHelper.visibleBounds.width-n*this.documentHelper.zoomFactor)/2;r<this.pageLeft&&(r=this.pageLeft),t.boundingRectangle=new Rd(r,i,n,e)},Hd.prototype.onPageFitTypeChanged=function(e){var t,i=this.documentHelper.visibleBounds.width,n=this.documentHelper.visibleBounds.height,r=this.visiblePages[0].bodyWidgets[0],o=j.convertPointToPixel(r.sectionFormat.pageWidth),s=j.convertPointToPixel(r.sectionFormat.pageHeight);switch(e){case"FitOnePage":0<n&&0<s&&((t=(this.documentHelper.visibleBounds.height-2*this.pageGap-(this.pageGap-2))/s)===this.documentHelper.zoomFactor?_.isNullOrUndefined(this.owner.selectionModule)||_.isNullOrUndefined(this.owner.selectionModule.start)||_.isNullOrUndefined(this.owner.selectionModule.end)||this.documentHelper.scrollToPosition(this.owner.selectionModule.start,this.owner.selectionModule.end):this.documentHelper.zoomFactor=t);break;case"FitPageWidth":0<i&&0<o&&(this.documentHelper.zoomFactor=(this.documentHelper.visibleBounds.width-80)/o);break;default:this.documentHelper.zoomFactor=1}},Hd.prototype.getCurrentPageHeaderFooter=function(e,t){return this.getCurrentHeaderFooter(this.getHeaderFooterType(e,t),e.index)},Hd.prototype.getHeaderFooterType=function(e,t){var i=t?"OddHeader":"OddFooter",n=e.page;return e.sectionFormat.differentFirstPage&&(_.isNullOrUndefined(n.previousPage)||!_.isNullOrUndefined(n.previousPage)&&n.sectionIndex!==n.previousPage.sectionIndex&&n.previousPage.bodyWidgets[n.previousPage.bodyWidgets.length-1].sectionIndex!==n.bodyWidgets[0].sectionIndex)?i=t?"FirstPageHeader":"FirstPageFooter":e.sectionFormat.differentOddAndEvenPages&&(n.index+1)%2==0&&(i=t?"EvenHeader":"EvenFooter"),i},Hd.prototype.getCurrentHeaderFooter=function(e,t){if(this.documentHelper.headersFooters[t]){var i=this.getHeaderFooter(e),n=this.documentHelper.headersFooters[t][i];if(!n){for(var r=0<t?t-1:t;!n&&-1!==r;)n=this.documentHelper.headersFooters[r][i],r--;n||((n=this.createHeaderFooterWidget(e)).isEmpty=!0),0==t&&(this.documentHelper.headersFooters[t][i]=n)}return n}if(0<t)return this.getCurrentHeaderFooter(e,t-1)},Hd.prototype.createHeaderFooterWidget=function(e){var t=new Xd(e),i=new G;return i.childWidgets.push(new uh(i)),e=-1!==e.indexOf("Header")?this.documentHelper.styles.findByName("Header"):this.documentHelper.styles.findByName("Footer"),i.paragraphFormat.baseStyle=e,i.paragraphFormat.listFormat.baseStyle=e,t.childWidgets.push(i),i.containerWidget=t},Hd.prototype.getHeaderFooter=function(e){switch(e){case"OddHeader":return 0;case"OddFooter":return 1;case"EvenHeader":return 2;case"EvenFooter":return 3;case"FirstPageHeader":return 4;case"FirstPageFooter":return 5}},Hd.prototype.updateHFClientArea=function(e,t){var i=j.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin);i<0&&(i=0),this.clientArea=new Rd(j.convertPointToPixel(e.leftMargin),t?j.convertPointToPixel(e.headerDistance):j.convertPointToPixel(e.pageHeight-e.footerDistance),i,Number.POSITIVE_INFINITY),this.clientActiveArea=new Rd(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},Hd.prototype.updateHeaderFooterClientAreaWithTop=function(e,t,i){this.updateHFClientArea(e,t),t||i.footerWidget.y<this.clientActiveArea.y&&(this.clientActiveArea.y=i.footerWidget.y,this.clientActiveArea.height=Number.POSITIVE_INFINITY)},Hd.prototype.updateFootnoteClientArea=function(e,t,i,n){var r=j.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),o=j.convertPointToPixel(e.leftMargin),s=j.convertPointToPixel(e.bottomMargin),a=j.convertPointToPixel(e.footerDistance),e=j.convertPointToPixel(e.pageHeight)-Math.max(a+t.page.footerWidget.height,s);this.clientArea=new Rd(o,e,r,Number.POSITIVE_INFINITY),this.clientActiveArea=new Rd(this.clientArea.x,this.clientArea.y,this.clientArea.width,Number.POSITIVE_INFINITY)},Hd.prototype.scrollToPage=function(e){for(var t=0,i=0;i<this.documentHelper.pages.length&&(t=this.documentHelper.pages[i].boundingRectangle.y-this.pageGap/2,i!==e);i++);this.documentHelper.viewerContainer.scrollTop=t,this.updateScrollBars()},Hd.prototype.updateScrollBars=function(){var e=this.getPageHeightAndWidth(0,0,0,0),t=e.width*this.documentHelper.zoomFactor+2*this.pageLeft,i=e.height*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap,n=this.updateCanvasWidthAndHeight(e.viewerWidth,e.viewerHeight,i,t,e.width,e.height),i=n.containerHeight,t=n.containerWidth;this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4;for(var r=0;r<this.documentHelper.pages.length;r++){var o=(n.width-this.documentHelper.pages[r].boundingRectangle.width*this.documentHelper.zoomFactor)/2;o>this.pageLeft?this.documentHelper.pages[r].boundingRectangle=new Rd(o,this.documentHelper.pages[r].boundingRectangle.y,this.documentHelper.pages[r].boundingRectangle.width,this.documentHelper.pages[r].boundingRectangle.height):this.documentHelper.pages[r].boundingRectangle=new Rd(this.pageLeft,this.documentHelper.pages[r].boundingRectangle.y,this.documentHelper.pages[r].boundingRectangle.width,this.documentHelper.pages[r].boundingRectangle.height)}this.updateScrollBarPosition(t,i,n.viewerWidth,n.viewerHeight,n.width,n.height),this.updateVisiblePages(),this.documentHelper.isScrollToSpellCheck=!1},Hd.prototype.updateVisiblePages=function(){this.visiblePages=[];for(var e=0;e<this.documentHelper.pages.length;e++){var t=this.documentHelper.pages[e],i=(t.boundingRectangle.y-this.pageGap*(e+1))*this.documentHelper.zoomFactor+this.pageGap*(e+1),n=t.boundingRectangle.x;this.documentHelper.isPageInVisibleBound(t,i)&&this.addVisiblePage(t,n,i)}},Hd.prototype.addVisiblePage=function(t,i,n){var e,r=this,o=t.boundingRectangle.width*this.documentHelper.zoomFactor,s=t.boundingRectangle.height*this.documentHelper.zoomFactor;this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===t&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(i,n,o,s),this.visiblePages.push(t),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.spellCheckerModule.enableOptimizedSpellCheck&&(this.owner.documentHelper.triggerElementsOnLoading||this.owner.documentHelper.isScrollHandler)&&(this.documentHelper.cachedPages.indexOf(t.index)<0||this.owner.editorModule.isPasteContentCheck)&&(this.owner.documentHelper.cachedPages.push(t.index),e=void 0,0<(e=this.owner.editorModule.isPasteContentCheck?_.isNullOrUndefined(this.owner.editorModule.copiedTextContent)?"":this.owner.editorModule.copiedTextContent:this.documentHelper.owner.spellCheckerModule.getPageContent(t)).trim().length)?(t.allowNextPageRendering=!1,_.isNullOrUndefined(this.owner)||_.isNullOrUndefined(this.owner.spellCheckerModule)||this.owner.spellCheckerModule.updateUniqueWords(j.getSpellCheckData(e)),this.owner.spellCheckerModule.callSpellChecker(this.owner.spellCheckerModule.languageID,e,!0,!1,!1,!0).then(function(e){e=JSON.parse(e);_.isNullOrUndefined(r.owner)||(_.isNullOrUndefined(r.owner.spellCheckerModule)||r.owner.spellCheckerModule.updateUniqueWords(e.SpellCollection),_.isNullOrUndefined(t)||(t.allowNextPageRendering=!0),_.isNullOrUndefined(r.documentHelper))||(r.documentHelper.triggerElementsOnLoading=!0,r.documentHelper.triggerSpellCheck=!0,r.documentHelper.triggerElementsOnLoading=!0,r.renderPage(t,i,n,o,s),r.documentHelper.triggerSpellCheck=!1,r.documentHelper.triggerElementsOnLoading=!1)})):this.renderPage(t,i,n,o,s)},Hd.prototype.renderPage=function(e,t,i,n,r){this.documentHelper.render.renderWidgets(e,t-this.owner.viewer.containerLeft,i-this.owner.viewer.containerTop,n,r)};var Td,Sd=Hd;function Hd(e){var t=Td.call(this,e)||this;return t.pageLeft=30,t.owner=e,t}pl(Od,Nd=Fd),Object.defineProperty(Od.prototype,"documentHelper",{get:function(){try{return this.owner.documentHelper}catch(e){}},enumerable:!0,configurable:!0}),Object.defineProperty(Od.prototype,"pageGap",{get:function(){return 0},enumerable:!0,configurable:!0}),Od.prototype.createNewPage=function(e,t){var i,n=0;return 0<this.documentHelper.pages.length&&(n=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom),i=new vp(this.documentHelper),0===this.documentHelper.pages.length?i.boundingRectangle=new Rd(10,n,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height):i.boundingRectangle=new Rd(10,n-20,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height),this.documentHelper.pages.push(i),this.updateClientArea(void 0,i),i.bodyWidgets.push(e),i.bodyWidgets[i.bodyWidgets.length-1].page=i},Od.prototype.onPageFitTypeChanged=function(e){this.documentHelper.zoomFactor=1},Od.prototype.scrollToPage=function(e){this.updateScrollBars()},Od.prototype.getContentHeight=function(){for(var e=0,t=0;t<this.documentHelper.pages.length;t++){var i=this.documentHelper.pages[t];0===t?(e+=this.padding.top,i.boundingRectangle.y=this.padding.top):i.boundingRectangle.y=this.documentHelper.pages[t-1].boundingRectangle.bottom,i.boundingRectangle.height=i.bodyWidgets[0].height,e+=i.bodyWidgets[0].height,t===this.documentHelper.pages.length-1&&(e+=this.padding.bottom)}return e},Od.prototype.getContentWidth=function(){for(var e=this.documentHelper.visibleBounds.width,t=e,i=0;i<this.documentHelper.pages.length;i++){for(var n,r=this.documentHelper.pages[i],o=0;o<r.bodyWidgets[0].childWidgets.length;o++)r.bodyWidgets[0].childWidgets[o]instanceof K&&(n=r.bodyWidgets[0].childWidgets[o],t<(n=j.convertPointToPixel(n.getTableWidth())*this.documentHelper.zoomFactor+4*this.padding.left+4*this.padding.right+r.boundingRectangle.x))&&(t=e=n);r.boundingRectangle.width=e}return e},Od.prototype.updateScrollBars=function(){var e=this.getPageHeightAndWidth(0,0,0,0),t=this.getContentWidth()*this.documentHelper.zoomFactor,i=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom,e=this.updateCanvasWidthAndHeight(e.viewerWidth,e.viewerHeight,i,t,e.width,e.height);this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4,this.updateScrollBarPosition(t,i,e.viewerWidth,e.viewerHeight,e.width,e.height),this.updateVisiblePages(),this.documentHelper.isScrollToSpellCheck=!1},Od.prototype.updateVisiblePages=function(){this.visiblePages=[];for(var e=this.documentHelper.visibleBounds.height,t=this.documentHelper.viewerContainer.scrollTop,i=0;i<this.documentHelper.pages.length;i++){var n,r=(n=this.documentHelper.pages[i]).boundingRectangle.y*this.documentHelper.zoomFactor,o=n.boundingRectangle.height*this.documentHelper.zoomFactor;(t<=r&&r<=t+e||t<=r+o&&r+o<=t+e||r<=t&&t+e<=r+o)&&this.addVisiblePage(n,this.padding.left,r)}},Od.prototype.addVisiblePage=function(t,i,n){var e,r=this,o=this.getContentWidth(),s=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom;this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===t&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(i,n,o,s),this.visiblePages.push(t),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.spellCheckerModule.enableOptimizedSpellCheck&&(this.owner.documentHelper.triggerElementsOnLoading||this.owner.documentHelper.isScrollHandler)&&(this.documentHelper.cachedPages.indexOf(t.index)<0||this.owner.editorModule.isPasteContentCheck)&&(this.owner.documentHelper.cachedPages.push(t.index),e=void 0,0<(e=this.owner.editorModule.isPasteContentCheck?_.isNullOrUndefined(this.owner.editorModule.copiedTextContent)?"":this.owner.editorModule.copiedTextContent:this.documentHelper.owner.spellCheckerModule.getPageContent(t)).trim().length)?(t.allowNextPageRendering=!1,_.isNullOrUndefined(this.owner)||_.isNullOrUndefined(this.owner.spellCheckerModule)||this.owner.spellCheckerModule.updateUniqueWords(j.getSpellCheckData(e)),this.owner.spellCheckerModule.callSpellChecker(this.owner.spellCheckerModule.languageID,e,!0,!1,!1,!0).then(function(e){e=JSON.parse(e);_.isNullOrUndefined(r.owner)||(_.isNullOrUndefined(r.owner)||_.isNullOrUndefined(r.owner.spellCheckerModule)||r.owner.spellCheckerModule.updateUniqueWords(e.SpellCollection),t.allowNextPageRendering=!0,_.isNullOrUndefined(r.documentHelper))||(r.documentHelper.triggerSpellCheck=!0,r.documentHelper.triggerElementsOnLoading=!0,r.renderPage(t,i,n,o,s),r.documentHelper.triggerSpellCheck=!1,r.documentHelper.triggerElementsOnLoading=!1)})):this.renderPage(t,i,n,o,s)},Od.prototype.renderPage=function(e,t,i,n,r){this.documentHelper.render.renderWidgets(e,t-this.owner.viewer.containerLeft,i-this.owner.viewer.containerTop,n,r)};var Nd,Wd=Od;function Od(e){var t=Nd.call(this,e)||this;return t.visiblePages=[],t.owner=e,t}Object.defineProperty(Ld.prototype,"currentIndex",{get:function(){return this.currentIndexIn},set:function(e){0<=e&&(this.currentIndexIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(Ld.prototype,"columnCount",{get:function(){var e;return e=0<(e=_.isNullOrUndefined(this.columnIn)?e:this.numberOfColumnsIn)?e:1},enumerable:!0,configurable:!0}),Ld.prototype.setColumns=function(e){if(this.pageWidth=j.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),this.numberOfColumnsIn=e.numberOfColumns,!_.isNullOrUndefined(e.columns)){for(var t=e.columns,i=[],n=0;n<e.numberOfColumns;n++){var r=this.defaultSpaceIn,o=0,o=(!_.isNullOrUndefined(t)&&0<t.length&&(r=t[n].space,o=t[n].width),this.getColumnObj(o,r,e.numberOfColumns,e.equalWidth));o.index=n,i.push(o)}this.columnIn=i}},Ld.prototype.clear=function(){this.currentIndexIn=0,this.defaultSpaceIn=36,this.columnIn=null,this.pageWidth=0},Ld.prototype.reset=function(){this.currentIndex=0},Ld.prototype.getColumnBounds=function(e,t){var i=this.currentIndexIn;return this.getColumnBoundsByIndex(i,t)},Ld.prototype.getColumnBoundsByBodyWidget=function(e,t){e=e.columnIndex;return this.getColumnBoundsByIndex(e,t)},Ld.prototype.getNextColumnByBodyWidget=function(e){e=e.columnIndex;return this.getColumnByIndex(e+1)},Ld.prototype.getColumnByIndex=function(e){if(0<=e&&e<this.columnCount&&!_.isNullOrUndefined(this.columnIn)&&0<this.columnIn.length)return this.columnIn[e]},Ld.prototype.getColumnObj=function(e,t,i,n){var r=(i-1)*t,o=new Da;return!n&&0!==e||_.isNullOrUndefined(this.pageWidth)||(e=(this.pageWidth-r)/i),o.width=e,o.space=t,o},Ld.prototype.getColumnBoundsByIndex=function(e,t){var i=new Rd(t.x,t.y,t.width,t.height);if(0<=e&&0<this.columnIn.length){var n;if(!_.isNullOrUndefined(this.columnIn[e])){t=this.getColumnByIndex(e),i.width=t.width;for(var r=0;r<e;r++)n=this.columnIn[r],i.x+=n.width,i.x+=n.space}}return i};var Ed=Ld;function Ld(e){this.viewerIn=e,this.clear()}Bd=function(e,t){return(Bd=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}))(e,t)};var Bd,pl=function(e,t){function i(){this.constructor=e}Bd(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},Rd=(Object.defineProperty(Md.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(Md.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Md.prototype.isIntersecting=function(e){return!(e.y>this.bottom||this.y>e.bottom||e.x>this.right||this.x>e.right)},Md.prototype.clone=function(){return new Md(this.x,this.y,this.width,this.height)},Md);function Md(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n}var Ad=function(e,t,i,n){this.right=10,this.left=10,this.top=10,this.bottom=10,this.right=e,this.left=t,this.top=i,this.bottom=n},Dd=(Ud.prototype.clone=function(){return new Ud(this.left,this.top,this.right,this.bottom)},Ud.prototype.destroy=function(){this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0},Ud);function Ud(e,t,i,n){this.left=e,this.top=t,this.right=i,this.bottom=n}Object.defineProperty(zd.prototype,"indexInOwner",{get:function(){return this instanceof z&&this.page?(this.containerWidget instanceof q?this.containerWidget:this.page).bodyWidgets.indexOf(this):this.containerWidget&&this.containerWidget.childWidgets?this.containerWidget.childWidgets.indexOf(this):this instanceof q?0:-1},enumerable:!0,configurable:!0}),Object.defineProperty(zd.prototype,"firstChild",{get:function(){return 0<this.childWidgets.length?this.childWidgets[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(zd.prototype,"lastChild",{get:function(){return this.childWidgets&&0<this.childWidgets.length?this.childWidgets[this.childWidgets.length-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(zd.prototype,"previousWidget",{get:function(){var e=this,t=this.indexInOwner;return e=e instanceof z?0<t?e.page.bodyWidgets[t-1]:void 0:0<t?e.containerWidget.childWidgets[t-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(zd.prototype,"nextWidget",{get:function(){var e=this,t=this.indexInOwner;if(-1!==t)return e=e instanceof z?t<e.page.bodyWidgets.length-1?e.page.bodyWidgets[t+1]:void 0:t<e.containerWidget.childWidgets.length-1?e.containerWidget.childWidgets[t+1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(zd.prototype,"previousRenderedWidget",{get:function(){var e=this,t=this.indexInOwner;if(!(t<0)){if(e instanceof z)if(0<t&&!(e.containerWidget instanceof q))e=e.page.bodyWidgets[t-1];else if(e.containerWidget instanceof q&&!e.page.documentHelper.owner.editorModule.removeEditRange){if(t<=0)return;e=e.containerWidget.bodyWidgets[t-1]}else e=(i=e.page.previousPage)&&0<i.bodyWidgets.length?i.bodyWidgets[i.bodyWidgets.length-1]:void 0;else if(e instanceof q)for(var i=e.page;i.previousPage&&(e=(i=i.previousPage).footnoteWidget,_.isNullOrUndefined(e)););else if(0<t)e=e.containerWidget.childWidgets[t-1];else{var n=void 0;for(e.containerWidget instanceof N?n=e.containerWidget.getPreviousSplitWidget():e.containerWidget&&e.containerWidget.containerWidget instanceof q&&"Endnote"===e.containerWidget.containerWidget.footNoteType?n=e.containerWidget.previousWidget||e.containerWidget.previousRenderedWidget:e.containerWidget instanceof dh||e.containerWidget instanceof Xd||e.containerWidget&&e.containerWidget.containerWidget instanceof q||(n=e.containerWidget.previousRenderedWidget);n&&0===n.childWidgets.length&&(n=n.previousRenderedWidget,!_.isNullOrUndefined(n)););e=n&&n.constructor===e.containerWidget.constructor?n.lastChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(zd.prototype,"nextRenderedWidget",{get:function(){var e=this,t=this.indexInOwner;if(!(t<0)){if(e instanceof z)if(t<e.page.bodyWidgets.length-1&&!(e.containerWidget instanceof q))e=e.page.bodyWidgets[t+1];else if(e.containerWidget instanceof q){if(t>=e.containerWidget.bodyWidgets.length-1&&!e.page.documentHelper.owner.editorModule.removeEditRange)return;e=e.containerWidget.bodyWidgets[t+1]}else e=e.page.allowNextPageRendering&&(i=e.page.nextPage)&&0<i.bodyWidgets.length?i.bodyWidgets[0]:void 0;else if(e instanceof q)for(var i=e.page;i.allowNextPageRendering&&i.nextPage&&(e=(i=i.nextPage).footnoteWidget,_.isNullOrUndefined(e)););else if(t<e.containerWidget.childWidgets.length-1)e=e.containerWidget.childWidgets[t+1];else{var n=void 0;for(e.containerWidget instanceof N?n=e.containerWidget.getNextSplitWidget():e.containerWidget&&e.containerWidget.containerWidget instanceof q&&"Endnote"===e.containerWidget.containerWidget.footNoteType?n=e.containerWidget.nextWidget||e.containerWidget.nextRenderedWidget:e.containerWidget instanceof dh||e.containerWidget instanceof Xd||e.containerWidget&&e.containerWidget.containerWidget instanceof q||(n=e.containerWidget.nextRenderedWidget);n&&0===n.childWidgets.length&&!(n instanceof N)&&(n=n.nextRenderedWidget,!_.isNullOrUndefined(n)););e=n&&n.constructor===e.containerWidget.constructor?n.firstChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(zd.prototype,"previousSplitWidget",{get:function(){var e=this;if(e instanceof N)return e.getPreviousSplitWidget();var t=e.previousRenderedWidget;if(e instanceof z&&t instanceof z&&e.equals(t)&&!(e.containerWidget instanceof q&&"Endnote"===e.containerWidget.footNoteType))return t;if(t instanceof Qd&&e.index===t.index&&e.equals(t))return t;if(e instanceof z&&e.containerWidget instanceof q&&"Endnote"===e.containerWidget.footNoteType&&!_.isNullOrUndefined(e.page.previousPage)&&!_.isNullOrUndefined(e.page.previousPage.endnoteWidget)){if((t=e.page.previousPage.endnoteWidget.bodyWidgets[e.page.previousPage.endnoteWidget.bodyWidgets.length-1])&&t instanceof z&&e.index===t.index&&e.equals(t))return t}else if(e instanceof Qd&&e.bodyWidget&&e.bodyWidget.containerWidget instanceof q&&"Endnote"===e.bodyWidget.containerWidget.footNoteType&&!_.isNullOrUndefined(e.bodyWidget.page.previousPage)&&!_.isNullOrUndefined(e.bodyWidget.page.previousPage.endnoteWidget)&&0<e.bodyWidget.page.previousPage.endnoteWidget.bodyWidgets.length){var i=e.bodyWidget.page.previousPage.endnoteWidget,i=i.bodyWidgets[i.bodyWidgets.length-1];if((t=i.childWidgets[i.childWidgets.length-1])&&t instanceof Qd&&e.index===t.index&&e.equals(t))return t}},enumerable:!0,configurable:!0}),Object.defineProperty(zd.prototype,"nextSplitWidget",{get:function(){var e=this;if(e instanceof N)return e.getNextSplitWidget();var t=e.nextRenderedWidget;if(e instanceof z&&t instanceof z&&e.equals(t)&&!(e.containerWidget instanceof q&&"Endnote"===e.containerWidget.footNoteType))return t;if(t instanceof Qd&&e.index===t.index&&e.equals(t))return t;if(e instanceof z&&e.containerWidget instanceof q&&"Endnote"===e.containerWidget.footNoteType&&!_.isNullOrUndefined(e.page.nextPage)&&!_.isNullOrUndefined(e.page.nextPage.endnoteWidget)){if((t=e.page.nextPage.endnoteWidget.bodyWidgets[0])&&t instanceof z&&e.index===t.index&&e.equals(t))return t}else if(e instanceof Qd&&e.bodyWidget&&e.bodyWidget.containerWidget instanceof q&&"Endnote"===e.bodyWidget.containerWidget.footNoteType&&!_.isNullOrUndefined(e.bodyWidget.page.nextPage)&&!_.isNullOrUndefined(e.bodyWidget.page.nextPage.endnoteWidget)&&0<e.bodyWidget.page.nextPage.endnoteWidget.bodyWidgets.length&&(t=e.bodyWidget.page.nextPage.endnoteWidget.bodyWidgets[0].childWidgets[0])&&t instanceof Qd&&e.index===t.index&&e.equals(t))return t},enumerable:!0,configurable:!0}),zd.prototype.getPreviousSplitWidgets=function(){for(var e=[],t=this.previousSplitWidget;t&&(e.unshift(t),!(t=t.previousSplitWidget)||t!=t.previousSplitWidget););return e},zd.prototype.getSplitWidgets=function(){for(var e=this.getPreviousSplitWidgets(),t=this;t;)e.push(t),t=t.nextSplitWidget;return e},zd.prototype.combineWidget=function(e){var t=this,i=this.getSplitWidgets();if(1<i.length)for(t=i.shift();0<i.length;){var n=i.shift();t.combine(n,e)}return t instanceof K&&t.combineRows(e),t},zd.prototype.combine=function(e,t){var i,n;0<e.childWidgets.length&&((i=this.lastChild)instanceof K?i.combineWidget(t):(n=e.firstChild,!(e instanceof K)&&i instanceof zd&&n instanceof zd&&i.index===n.index&&i.combine(e.childWidgets.shift(),t)),this.addWidgets(e.childWidgets),e.childWidgets=[]),e.destroyInternal(t)},zd.prototype.addWidgets=function(e){for(;0<e.length;){var t,i=e.shift();if(i instanceof uh&&this instanceof G?(i.paragraph=this).height+=i.height:i instanceof zd&&(t=this.lastChild,i.containerWidget=this,i.y=t instanceof zd?t.y+t.height:this.y,this.height+=i.height),i instanceof dh)for(var n=this.childWidgets[this.childWidgets.length-1],r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];if(1<o.cellFormat.rowSpan)for(var s=0;s<i.childWidgets.length;s++){var a=i.childWidgets[s];if(a.columnIndex===o.columnIndex&&a.isSplittedCell&&a.cellFormat.rowSpan===o.cellFormat.rowSpan){for(var l=0;l<a.childWidgets.length;l++){var d=a.childWidgets[l];a.childWidgets.splice(d.indexInOwner,1),o.childWidgets.push(d),d.containerWidget=o,l--}a.ownerRow.childWidgets.splice(a.indexInOwner,1),a.containerWidget=void 0,s--}}}this.childWidgets.push(i)}},zd.prototype.removeChild=function(e){-1<e&&e<this.childWidgets.length&&this.childWidgets.splice(e,1)},zd.prototype.destroy=function(){if(this.childWidgets)for(;0<this.childWidgets.length;){var e=this.childWidgets.pop();(e instanceof uh||e instanceof zd)&&e.destroy()}this.childWidgets=void 0,this.containerWidget&&this.containerWidget.removeChild(this.indexInOwner),this.containerWidget=void 0,this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.index=void 0},zd.prototype.componentDestroy=function(){if(this.childWidgets)for(;0<this.childWidgets.length;){var e=this.childWidgets.pop();(e instanceof uh||e instanceof zd)&&e.componentDestroy()}this.childWidgets=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.index=void 0,this.containerWidget=void 0};var Vd=zd;function zd(){this.childWidgets=[],this.x=0,this.y=0,this.width=0,this.height=0,this.index=0}pl(jd,qd=Vd),Object.defineProperty(jd.prototype,"sectionFormat",{get:function(){return this instanceof z?this.sectionFormatIn:this.page&&!_.isNullOrUndefined(this.page.bodyWidgets)?this.page.bodyWidgets[0].sectionFormat:void 0},set:function(e){this instanceof z&&(this.sectionFormatIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(jd.prototype,"sectionIndex",{get:function(){var e=0;return this instanceof z?e=this.index:this.page&&(e=this.page.bodyWidgets[0].index),e},enumerable:!0,configurable:!0}),jd.prototype.getHierarchicalIndex=function(e){return e=this instanceof z?this.index+";"+e:this instanceof q?"Footnote"===this.footNoteType?"FN;"+e:"EN;"+e:-1!==this.headerFooterType.indexOf("Header")?"H;"+e:"F;"+e,_.isNullOrUndefined(this.page)?e:this.page.documentHelper.pages.indexOf(this.page)+";"+e},jd.prototype.componentDestroy=function(){this.sectionFormatIn&&this.sectionFormatIn.destroy(),this.sectionFormatIn=void 0,this.floatingElements=[],this.removedHeaderFooters=[],this.footNoteReference=void 0,this.page=void 0,qd.prototype.componentDestroy.call(this)};var qd,_d=jd;function jd(){var e=null!==qd&&qd.apply(this,arguments)||this;return e.floatingElements=[],e.footNoteReference=void 0,e.sectionFormatIn=void 0,e.columnIndex=0,e.isWord2010NextColumn=!1,e}pl(Kd,Gd=_d),Kd.prototype.equals=function(e){return e instanceof Kd&&e.sectionFormat===this.sectionFormat},Kd.prototype.getHierarchicalIndex=function(e){return e=this.containerWidget instanceof q?(e=this.containerWidget.bodyWidgets.indexOf(this)+";"+e,"Footnote"===this.containerWidget.footNoteType?"FN;"+e:"EN;"+e):this.page&&-1!==this.page.bodyWidgets.indexOf(this)?this.page.bodyWidgets.indexOf(this)+";"+e:this.index+";"+e,_.isNullOrUndefined(this.page)?e:this.page.documentHelper.pages.indexOf(this.page)+";"+e},Kd.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t]instanceof K){var i=this.childWidgets[t],n=0;if(i.wrapTextAround&&(n=i.getTableCellWidth()),!i.wrapTextAround&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e);if(i.wrapTextAround&&i.x<=e.x&&i.x+n>=e.x&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e)}var r=void 0;return r=0<this.childWidgets.length?(this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1]:this.childWidgets[0]).getTableCellWidget(e):r},Kd.prototype.destroyInternal=function(e){var t;this.height;if(!_.isNullOrUndefined(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i];if(0 instanceof G,n.destroyInternal(e),_.isNullOrUndefined(this.childWidgets))break;i--}this.childWidgets=void 0}_.isNullOrUndefined(this.page)||(t=this.indexInOwner,-1<this.indexInOwner&&(this.page.bodyWidgets.splice(t,1),0===this.page.bodyWidgets.length?this.page.destroy():this instanceof Xd&&this.page.headerWidget===this?this.page.headerWidget=void 0:this instanceof Xd&&this.page.footerWidget===this&&(this.page.footerWidget=void 0),this.page=void 0)),this.destroy()},Kd.prototype.destroy=function(){this.sectionFormatIn=void 0,this.page&&this.page.headerWidgetIn&&(this.page.headerWidgetIn.page=void 0),this.page&&this.page.footerWidgetIn&&(this.page.footerWidgetIn.page=void 0),this.page=void 0,Gd.prototype.destroy.call(this)},Kd.prototype.componentDestroy=function(){Gd.prototype.componentDestroy.call(this)};var Gd,z=Kd;function Kd(){return Gd.call(this)||this}pl(Jd,Zd=_d),Jd.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t]instanceof K){var i=this.childWidgets[t],n=0;if(i.wrapTextAround&&(n=i.getTableCellWidth()),!i.wrapTextAround&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e);if(i.wrapTextAround&&i.x<=e.x&&i.x+n>=e.x&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e)}var r=void 0;return r=0<this.childWidgets.length?(this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1]:this.childWidgets[0]).getTableCellWidget(e):r},Jd.prototype.equals=function(e){return e instanceof Jd&&e.containerWidget===this.containerWidget},Jd.prototype.clone=function(){for(var e=new Jd(this.headerFooterType),t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t].clone();e.childWidgets.push(i),i.index=t,i.containerWidget=e}return e.isEmpty=this.isEmpty,e.x=this.x,e.y=this.y,e.height=0,e.width=0,e},Jd.prototype.destroyInternal=function(e){this.page=void 0,Zd.prototype.destroy.call(this)},Jd.prototype.componentDestroy=function(){Zd.prototype.componentDestroy.call(this),this.parentHeaderFooter=void 0};var Zd,Xd=Jd;function Jd(e){var t=Zd.call(this)||this;return t.isEmpty=!1,t.headerFooterType=e,t}pl($d,Yd=Vd),Object.defineProperty($d.prototype,"bodyWidget",{get:function(){for(var e=this;e.containerWidget;){if(e.containerWidget instanceof fc){var t=e.containerWidget.containerShape.line.paragraph;if(t)return t.bodyWidget}else if(e.containerWidget instanceof _d)return e.containerWidget;e=e.containerWidget}},enumerable:!0,configurable:!0}),Object.defineProperty($d.prototype,"leftIndent",{get:function(){return this instanceof G&&this.paragraphFormat instanceof Xa?this.paragraphFormat.leftIndent:this instanceof K&&this.tableFormat instanceof Fl?this.tableFormat.leftIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty($d.prototype,"rightIndent",{get:function(){return this instanceof G&&this.paragraphFormat instanceof Xa?this.paragraphFormat.rightIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty($d.prototype,"isInsideTable",{get:function(){return this.containerWidget instanceof N},enumerable:!0,configurable:!0}),Object.defineProperty($d.prototype,"isInHeaderFooter",{get:function(){return this.bodyWidget instanceof Xd},enumerable:!0,configurable:!0}),Object.defineProperty($d.prototype,"associatedCell",{get:function(){if(this.containerWidget instanceof N)return this.containerWidget},enumerable:!0,configurable:!0}),$d.prototype.isPageBreak=function(){var e=!1;return e=this instanceof G&&null!=this&&1===this.childWidgets.length&&1===this.firstChild.children.length?this.firstChild.children[0].isPageBreak:e},$d.prototype.isColumnBreak=function(){var e=!1;return e=this instanceof G&&null!=this&&1===this.childWidgets.length&&1===this.firstChild.children.length?this.firstChild.children[0].isColumnBreak:e},$d.prototype.getHierarchicalIndex=function(e){if(e=this.containerWidget.childWidgets.indexOf(this)+";"+e,!_.isNullOrUndefined(this.containerWidget)){if(this.containerWidget instanceof fc)return this.containerWidget.getHierarchicalIndex(e);if(this.containerWidget instanceof $d)return this.containerWidget.getHierarchicalIndex(e);this.containerWidget instanceof _d&&(e=this.containerWidget.getHierarchicalIndex(e))}return e},$d.prototype.getIndex=function(){return this instanceof G||this instanceof K?this.containerWidget.childWidgets.indexOf(this):this instanceof dh?this.ownerTable.childWidgets.indexOf(this):this instanceof N?this.ownerRow.childWidgets.indexOf(this):0},$d.prototype.getContainerWidth=function(){if(this.isInsideTable){if(this instanceof K&&"Auto"===this.tableFormat.preferredWidthType&&this.associatedCell.ownerTable.isGridUpdated){for(var e=0,t=this.associatedCell.cellFormat.columnSpan,i=this.associatedCell.columnIndex,n=0;n<t;n++)e+=this.associatedCell.ownerTable.tableHolder.columns[i].preferredWidth,i++;if(0<e)return e}return this.associatedCell.getCellWidth(this)}var r,o,s,a;return this.containerWidget instanceof fc?(r=this.containerWidget.containerShape,j.convertPixelToPoint(r.width)-j.convertPixelToPoint(r.textFrame.marginLeft)-j.convertPixelToPoint(r.textFrame.marginRight)):(o=(r=this.bodyWidget).sectionFormat,s=0,!_.isNullOrUndefined(r.page)&&!_.isNullOrUndefined(r.page.documentHelper)&&"Word2013"!==r.page.documentHelper.compatibilityMode&&!this.isInsideTable&&this instanceof K&&(s=(a=this.firstChild).firstChild.leftMargin+a.lastChild.rightMargin),r instanceof z&&1<o.columns.length?(a=r.columnIndex,j.convertPixelToPoint(o.columns[a].width)):o.pageWidth-(o.leftMargin+o.rightMargin)+s)},Object.defineProperty($d.prototype,"bidi",{get:function(){return this instanceof G&&this.paragraphFormat instanceof Xa?this.paragraphFormat.bidi:this instanceof K&&this.tableFormat instanceof Fl&&this.tableFormat.bidi},enumerable:!0,configurable:!0}),$d.prototype.componentDestroy=function(){Yd.prototype.componentDestroy.call(this),this.contentControlProperties=void 0};var Yd,Qd=$d;function $d(){var e=null!==Yd&&Yd.apply(this,arguments)||this;return e.isLayouted=!1,e.isFieldCodeBlock=!1,e.locked=!1,e.lockedBy="",e}pl(th,eh=_d),th.prototype.getMinimumAndMaximumWordWidth=function(e,t){throw new Error("Method not implemented.")},th.prototype.getTableCellWidget=function(e){},th.prototype.equals=function(e){return e instanceof th&&e.containerWidget===this.containerWidget},th.prototype.clone=function(){for(var e=new th,t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t].clone();e.childWidgets.push(i),i.index=t,i.containerWidget=e}return e.block=this.block,e},th.prototype.destroyInternal=function(e){this.block=void 0,eh.prototype.destroy.call(this)},th.prototype.componentDestroy=function(){if(this.bodyWidgets&&0<this.bodyWidgets.length){for(var e=0;e<this.bodyWidgets.length;e++)this.bodyWidgets[e].componentDestroy();this.bodyWidgets=[]}this.bodyWidgets=void 0,this.block=void 0,eh.prototype.componentDestroy.call(this)};var eh,q=th;function th(){var e=null!==eh&&eh.apply(this,arguments)||this;return e.bodyWidgets=[],e}pl(nh,ih=Qd),Object.defineProperty(nh.prototype,"isEndsWithPageBreak",{get:function(){return 0<this.childWidgets.length&&this.lastChild.isEndsWithPageBreak},enumerable:!0,configurable:!0}),Object.defineProperty(nh.prototype,"isEndsWithColumnBreak",{get:function(){return 0<this.childWidgets.length&&this.lastChild.isEndsWithColumnBreak},enumerable:!0,configurable:!0}),nh.prototype.equals=function(e){return e instanceof nh&&e.paragraphFormat===this.paragraphFormat},nh.prototype.isContainsShapeAlone=function(){for(var e=!1,t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],n=0;n<i.children.length;n++){var r=i.children[n];if(!(r instanceof hc)||r instanceof hc&&"Inline"===r.textWrappingStyle)return!1;e=!0}return!!e},nh.prototype.isEmpty=function(){if(!_.isNullOrUndefined(this.childWidgets)&&0!==this.childWidgets.length)for(var e=0;e<this.childWidgets.length;e++)for(var t=this.childWidgets[e],i=0;i<t.children.length;i++){var n=t.children[i];if(0!==n.length&&(n instanceof X||n instanceof Ic||n instanceof J||n instanceof Sc||n instanceof Wc||n instanceof Lc||n instanceof uc||n instanceof E||n instanceof Z&&j.isLinkedFieldCharacter(n)))return!1}return!0},nh.prototype.getInline=function(e,t){for(var i=void 0,n=0,r=!1,o=this.getSplitWidgets(),s=0;s<o.length;s++)for(var a=o[s],l=0;l<a.childWidgets.length;l++)for(var d=a.childWidgets[l],h=0;h<d.children.length;h++)if(!((i=d.children[h])instanceof Y)){if((r=!r&&(i instanceof X||i instanceof Ic||i instanceof uc||i instanceof J||i instanceof Z&&j.isLinkedFieldCharacter(i))||i instanceof Lc?!0:r)&&e<=n+i.length)return{element:i,index:t=e-n};n+=i.length}return{element:i,index:t=n<e?_.isNullOrUndefined(i)?e:i.length:t}},nh.prototype.getLength=function(){var e=0;if(!_.isNullOrUndefined(this.childWidgets))for(var t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],n=0;n<i.children.length;n++){var r=i.children[n];r instanceof Y||(e+=r.length)}return e},nh.prototype.getTotalLength=function(){for(var e=0,t=this.getSplitWidgets(),i=0;i<t.length;i++)e+=t[i].getLength();return e},nh.prototype.getTableCellWidget=function(e){},nh.prototype.getMinimumAndMaximumWordWidth=function(e,t){if(e=j.convertPointToPixel(e),t=j.convertPointToPixel(t),0<this.childWidgets.length){for(var i,n=this.childWidgets[0].children[0],r="",o=new T,s=[];;){if(n instanceof X&&""!==n.text?(o.add(n,r.length),r+=n.text):n instanceof Z&&0===n.fieldType?(i=n,_.isNullOrUndefined(i.fieldEnd)||(n=_.isNullOrUndefined(i.fieldSeparator)?i.fieldEnd:i.fieldSeparator)):n instanceof Ic&&s.push(n.width),_.isNullOrUndefined(n)||_.isNullOrUndefined(n.nextNode))break;n=n.nextNode}for(var a,l=new RegExp("\\b\\w+\\b","g"),d=[];!_.isNullOrUndefined(a=l.exec(r));)d.push(a);for(var h=0;h<d.length;h++){for(var c,p=d[h],u=0,r="",g="",m=p.index,f=p.index,y=0;y<o.keys.length;y++){var v=o.keys[y],w=o.get(v),b=v.length;if(f<=w+b&&(c=f-w,p.index+p[0].length<=w+b?m=p.index+p[0].length-(w+c):f+=m=b-c,g+=r=v.text.substring(c,c+m)),""!==r&&(u+=this.bodyWidget.page.documentHelper.textHelper.getWidth(r,v.characterFormat,v.scriptType)),g===p[0])break}0!==u&&(0===e||e<u)&&(e=u)}var x=0,x=(0<s.length&&(x=Math.max.apply(null,s)),(0===e||e<x)&&(e=x),this.measureParagraph());(0===t||t<x)&&(t=x)}var C,x=0;return this.isEmpty()||0!=this.floatingElements.length||_.isNullOrUndefined(this.paragraphFormat)||!(0<this.paragraphFormat.leftIndent)||_.isNullOrUndefined(this.associatedCell)||_.isNullOrUndefined(this.associatedCell.cellFormat)||"Point"!==this.associatedCell.cellFormat.preferredWidthType||(C=this.paragraphFormat.leftIndent+this.paragraphFormat.firstLineIndent)+e>this.associatedCell.cellFormat.preferredWidth&&(x=C),{maximumWordWidth:j.convertPixelToPoint(t),minimumWordWidth:j.convertPixelToPoint(e)+x}},nh.prototype.measureParagraph=function(){for(var e,t=0,i=this.childWidgets[0].children[0];i instanceof X&&""!==i.text?t+=this.bodyWidget.page.documentHelper.textHelper.getWidth(i.text,i.characterFormat,i.scriptType):i instanceof Z&&0===i.fieldType?null!=(e=i).fieldEnd&&(i=_.isNullOrUndefined(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator):i instanceof Ic&&(t+=i.width),!_.isNullOrUndefined(i)&&!_.isNullOrUndefined(i.nextNode);)i=i.nextNode;return 0<this.leftIndent&&(t+=this.leftIndent),0<this.rightIndent&&(t+=this.rightIndent),t},nh.prototype.isArabicChar=function(e){return e>=String.fromCharCode(1536)&&e<=String.fromCharCode(1791)||e>=String.fromCharCode(1872)&&e<=String.fromCharCode(1919)||e>=String.fromCharCode(2208)&&e<=String.fromCharCode(2303)||e>=String.fromCharCode(64336)&&e<=String.fromCharCode(65023)||e>=String.fromCharCode(65136)&&e<=String.fromCharCode(65279)},nh.prototype.isHebrewChar=function(e){return e>=String.fromCharCode(1424)&&e<=String.fromCharCode(1535)||e>=String.fromCharCode(64285)&&e<=String.fromCharCode(64335)},nh.prototype.isHindiChar=function(e){return e>=String.fromCharCode(2304)&&e<=String.fromCharCode(2431)||e>=String.fromCharCode(43232)&&e<=String.fromCharCode(43263)||e>=String.fromCharCode(7376)&&e<=String.fromCharCode(7423)},nh.prototype.isKoreanChar=function(e){return e>=String.fromCharCode(44032)&&e<=String.fromCharCode(55203)||e>=String.fromCharCode(4352)&&e<=String.fromCharCode(4607)||e>=String.fromCharCode(12592)&&e<=String.fromCharCode(12687)||e>=String.fromCharCode(43360)&&e<=String.fromCharCode(43391)||e>=String.fromCharCode(55216)&&e<=String.fromCharCode(55295)||e>=String.fromCharCode(44032)&&e<=String.fromCharCode(55215)},nh.prototype.isJapanese=function(e){return e>=String.fromCharCode(12448)&&e<=String.fromCharCode(12543)||e>=String.fromCharCode(12352)&&e<=String.fromCharCode(12447)},nh.prototype.isThaiCharacter=function(e){return e>=String.fromCharCode(3584)&&e<=String.fromCharCode(3711)},nh.prototype.isChineseChar=function(e){return e>=String.fromCharCode(19968)&&e<=String.fromCharCode(40959)||e>=String.fromCharCode(13312)&&e<=String.fromCharCode(19903)||e>=String.fromCharCode(55360)&&e<=String.fromCharCode(55401)||e>=String.fromCharCode(56320)&&e<=String.fromCharCode(57055)||e>=String.fromCharCode(43360)&&e<=String.fromCharCode(43391)||e>=String.fromCharCode(65280)&&e<=String.fromCharCode(65519)||e>=String.fromCharCode(12288)&&e<=String.fromCharCode(12351)},nh.prototype.getFontScriptType=function(e){return this.isHindiChar(e)?V.FontScriptType.Hindi:this.isKoreanChar(e)?V.FontScriptType.Korean:this.isJapanese(e)?V.FontScriptType.Japanese:this.isChineseChar(e)?V.FontScriptType.Chinese:this.isArabicChar(e)?V.FontScriptType.Arabic:this.isHebrewChar(e)?V.FontScriptType.Hebrew:this.isThaiCharacter(e)?V.FontScriptType.Thai:V.FontScriptType.English},nh.prototype.splitTextByFontScriptType=function(e,t){var i=[];if(!_.isNullOrUndefined(e)&&(_.isNullOrUndefined(e)||""!==e)){for(var n="",r=V.FontScriptType.English,o=V.FontScriptType.English,s=/[\uD800-\uDFFF]/,a=0;a<e.length;a++)e[a]==String.fromCharCode(32)||s.test(e[a])||(o=this.getFontScriptType(e[a])),""!=n&&o!==r&&(i.push(n),t.push(r),n=""),n+=e[a],r=o;""!=n&&(i.push(n),t.push(o),n="")}return i},nh.prototype.splitTextRangeByScriptType=function(e){var t=!1,i=1;if(0<this.childWidgets.length){for(var n=this.childWidgets[e],r=e+1;r<this.childWidgets.length;r++){for(var o=this.childWidgets[r],s=0;s<o.children.length;s++){var a=o.children[s];n.children.push(a),a.line=n}this.childWidgets.splice(r,1),r--}for(r=0;r<n.children.length;r+=i){var l=n.children[r],i=1,d=void 0;if(l instanceof X&&(d=l),l instanceof Z&&0==l.fieldType?t=!0:l instanceof Z&&2===l.fieldType&&(t=!1),null!=d&&!t){var h=[],c=this.splitTextByFontScriptType(d.text,h);if(1<c.length)for(var p=0;p<c.length;p++){var u,g=c[p];0<p?((u=d.clone()).text=g,u.scriptType=h[p],n.children.splice(r+p,0,u),u.line=n,i++,0<d.revisions.length&&this.updateTextElementInRevisionRange(d,u)):(d.text=g,d.scriptType=h[p])}else 0<c.length&&(d.scriptType=h[0]);h.length=0}}}},nh.prototype.splitLtrAndRtlText=function(e){var t={value:null},i=1,n={value:null},r=[],o=!1,s=this.bodyWidget.page.documentHelper.textHelper;if(0<this.childWidgets.length){for(var a=this.childWidgets[e],l=0;l<a.children.length;l+=i){var d=a.children[l],i=1,h=void 0;if(d instanceof X&&(h=d),d instanceof Z&&0==d.fieldType?o=!0:d instanceof Z&&2===d.fieldType&&(o=!1),null!=h&&!o){var c=h.text,p=h.characterFormat.bidi,u=!1,g=r.length,m=(p&&(u=s.isRightToLeftLanguage(d.characterFormat.localeIdBidi)),s.splitTextByConsecutiveLtrAndRtl(c,p,u,r,t,n));if(1<m.length)for(var f=0;f<m.length;f++){var y,c=m[f];0<f?((y=h.clone()).text=c,y.characterRange=r[f+g],a.children.splice(l+f,0,y),y.line=a,i++,0<h.revisions.length&&this.updateTextElementInRevisionRange(h,y)):(h.text=c,h.characterRange=r[g])}else 0<m.length&&(h.characterRange=r[g])}}r.length=0}},nh.prototype.updateTextElementInRevisionRange=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=n.range.indexOf(e);n.range.splice(r+1,0,t),t.revisions.push(n),t.removedIds=[]}},nh.prototype.combineconsecutiveRTL=function(e){for(var t=!1,i=this.bodyWidget.page.documentHelper.textHelper,n=e;n<this.childWidgets.length;n++)for(var r=this.childWidgets[n],o=0;o<=r.children.length-2;o++){var s,a=r.children[o];a instanceof Z&&0===a.fieldType?t=!0:a instanceof Z&&2===a.fieldType&&(t=!1),!t&&a instanceof X&&r.children[o+1]instanceof X&&(s=r.children[o+1],((a=a).characterFormat.complexScript&&a.scriptType==s.scriptType||a.characterFormat.bidi&&a.scriptType!==V.FontScriptType.Hebrew&&a.characterRange==V.CharacterRangeType.RightToLeft&&s.characterRange==V.CharacterRangeType.RightToLeft)&&0<a.text.length&&0<s.text.length&&!i.isWordSplitChar(a.text[a.text.length-1])&&!i.isWordSplitChar(s.text[0])&&a.characterFormat.isEqualFormat(s.characterFormat)&&this.compareRevisions(a.revisions,s.revisions)||a.characterRange==V.CharacterRangeType.RightToLeft&&s.characterRange==V.CharacterRangeType.RightToLeft&&0<a.text.length&&0<s.text.length&&i.isWordSplitChar(a.text[a.text.length-1])&&i.isWordSplitChar(s.text[0])&&a.characterFormat.isEqualFormat(s.characterFormat)&&this.compareRevisions(a.revisions,s.revisions))&&(a.text=a.text+s.text,r.children.splice(o+1,1),o--)}},nh.prototype.compareRevisions=function(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0},nh.prototype.clone=function(){var e=new nh;e.paragraphFormat.copyFormat(this.paragraphFormat),e.characterFormat.copyFormat(this.characterFormat);for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t].clone();e.childWidgets.push(i);for(var n=0;n<i.children.length;n++){var r=i.children[n];(r instanceof Ic&&"Inline"!==r.textWrappingStyle||r instanceof uc)&&e.floatingElements.push(r)}i.paragraph=e}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e.absoluteXPosition=_.isNullOrUndefined(this.absoluteXPosition)?void 0:{width:this.absoluteXPosition.width,x:this.absoluteXPosition.x},this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},nh.prototype.destroyInternal=function(e){var t=this.height;if(!_.isNullOrUndefined(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){if(this.childWidgets[i].destroy(),1===this.childWidgets.length&&_.isNullOrUndefined(this.childWidgets[0].children)&&(this.childWidgets=void 0),_.isNullOrUndefined(this.childWidgets))break;i--}this.childWidgets=void 0}_.isNullOrUndefined(this.containerWidget)||_.isNullOrUndefined(this.containerWidget.childWidgets)||-1===this.containerWidget.childWidgets.indexOf(this)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=t,this.containerWidget=void 0),this.hasOwnProperty("absoluteXPosition")&&delete this.absoluteXPosition,this.destroy()},nh.prototype.destroy=function(){this.paragraphFormat=void 0,this.characterFormat=void 0,ih.prototype.destroy.call(this)},nh.prototype.componentDestroy=function(){this.paragraphFormat&&this.paragraphFormat.destroy(),this.paragraphFormat=void 0,this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,ih.prototype.componentDestroy.call(this)};var ih,G=nh;function nh(){var e=ih.call(this)||this;return e.isSectionBreak=!1,e.isChangeDetected=!1,e.clientX=void 0,e.floatingElements=[],e.paragraphFormat=new Xa(e),e.characterFormat=new B(e),e}oh.prototype.clone=function(){var e=new oh;return e.allowOverlap=this.allowOverlap,e.distanceTop=this.distanceTop,e.distanceRight=this.distanceRight,e.distanceLeft=this.distanceLeft,e.distanceBottom=this.distanceBottom,e.verticalAlignment=this.verticalAlignment,e.verticalOrigin=this.verticalOrigin,e.verticalPosition=this.verticalPosition,e.horizontalAlignment=this.horizontalAlignment,e.horizontalOrigin=this.horizontalOrigin,e.horizontalPosition=this.horizontalPosition,e};var rh=oh;function oh(){}pl(ah,sh=Qd),Object.defineProperty(ah.prototype,"isGridUpdated",{get:function(){return(4&this.flags)>>2!=0},set:function(e){this.flags=251&this.flags|(e?1:0)<<2},enumerable:!0,configurable:!0}),Object.defineProperty(ah.prototype,"continueHeader",{get:function(){return(2&this.flags)>>1!=0},set:function(e){this.flags=253&this.flags|(e?1:0)<<1},enumerable:!0,configurable:!0}),Object.defineProperty(ah.prototype,"header",{get:function(){return 0!=(1&this.flags)},set:function(e){this.flags=254&this.flags|(e?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(ah.prototype,"isBidiTable",{get:function(){return(16&this.flags)>>4!=0},set:function(e){this.flags=239&this.flags|(e?1:0)<<4},enumerable:!0,configurable:!0}),ah.prototype.equals=function(e){return e instanceof ah&&e.tableFormat===this.tableFormat},ah.prototype.combineRows=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];if(!_.isNullOrUndefined(i.firstChild)&&0!==i.firstChild.index&&1===i.getSplitWidgets().length)for(var n=0;n<i.childWidgets.length;n++)i.childWidgets[n].index--;0===i.childWidgets.length?(i.destroy(),t--):i.combineCells(e)}},ah.prototype.contains=function(e){if(this.equals(e.ownerTable))return!0;for(;e.ownerTable.isInsideTable;){if(this.equals(e.ownerTable))return!0;e=e.ownerTable.associatedCell}return this.equals(e.ownerTable)},ah.prototype.getOwnerWidth=function(e){var t;return 0<=(t=this.getContainerWidth()-this.leftIndent-this.rightIndent)?t:0},ah.prototype.getTableWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++){for(var i=0,n=this.childWidgets[t],r=0;r<n.childWidgets.length;r++)i+=n.childWidgets[r].cellFormat.cellWidth;e<i&&(e=i)}return e},ah.prototype.getTableCellWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++){for(var i=0,n=this.childWidgets[t],r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r],s=o.width;0===s&&((s=o.cellFormat.cellWidth)>o.cellFormat.preferredWidth&&0!==o.cellFormat.preferredWidth&&"Percent"!==o.cellFormat.preferredWidthType&&(s=o.cellFormat.preferredWidth),s=j.convertPointToPixel(s-(o.margin.left+o.margin.right))),i+=s+o.margin.left+o.margin.right}e<i&&(e=i)}return e},ah.prototype.getTableClientWidth=function(e){return"Point"===this.tableFormat.preferredWidthType&&0<this.tableFormat.preferredWidth?e=this.tableFormat.preferredWidth:"Percent"===this.tableFormat.preferredWidthType&&0<this.tableFormat.preferredWidth&&(e=e*this.tableFormat.preferredWidth/100),e},ah.prototype.getCellWidth=function(e,t,i,n){var r=e;return"Percent"===t?r=e*i/100:"Point"===t?r=e:!_.isNullOrUndefined(n)&&0===n.cellFormat.cellWidth&&0===n.cellFormat.preferredWidth&&"Auto"===n.cellFormat.preferredWidthType&&"Percent"===n.ownerTable.tableFormat.preferredWidthType&&n.ownerTable.isInsideTable?r=i-this.tableHolder.getTotalWidth(0):_.isNullOrUndefined(n)||(r=this.getMinimumPreferredWidth(n)),r},ah.prototype.getMinimumPreferredWidth=function(e){return 0===e.cellFormat.preferredWidth&&0!==e.cellFormat.cellWidth?e.cellFormat.cellWidth:e.getMinimumPreferredWidth()},ah.prototype.fitCellsToClientArea=function(e){for(var t=e/this.getTableWidth(),i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i];n.rowFormat.gridAfterWidth*=t,n.rowFormat.gridBeforeWidth*=t;for(var r=0;r<n.childWidgets.length;r++)n.childWidgets[r].cellFormat.cellWidth*=t,n.childWidgets[r].cellFormat.preferredWidth*=t}},ah.prototype.getTableCellWidget=function(e){for(var t=void 0,i=0;i<this.childWidgets.length;i++)if(this.childWidgets[i].y<=e.y&&this.childWidgets[i].y+this.childWidgets[i].height>=e.y){t=this.childWidgets[i].getTableCellWidget(e);break}return t},ah.prototype.calculateGrid=function(e){var t=[],i=[],n=[],r=this.getOwnerWidth(!0),o=this.getTableClientWidth(r);this.tableCellInfo=new T;for(var s=0;s<this.childWidgets.length;s++){var a=this.childWidgets[s],l=new T,d=a.rowFormat,h=a.rowFormat.gridBefore,c=0,p=(t.indexOf(c)<0&&(t.push(c),i.push(c)),c+=this.getCellWidth(d.gridBeforeWidth,d.gridBeforeWidthType,o,null),parseFloat(c.toFixed(2)));t.indexOf(p)<0&&(t.push(p),i.push(c));for(var u=0;u<a.childWidgets.length;u++){for(var g,m,f=a.childWidgets[u],y=0;y<n.length;y++)n[y].columnIndex<h||(g=n[y].cellFormat.rowSpan,m=!0,n[y].columnIndex>h?(m=!1,u===a.childWidgets.length-1&&0<a.rowFormat.gridAfter&&(c+=this.getCellWidth(n[y].cellFormat.preferredWidth,n[y].cellFormat.preferredWidthType,o,null))):(c+=this.getCellWidth(n[y].cellFormat.preferredWidth,n[y].cellFormat.preferredWidthType,o,null),h=n[y].columnIndex+n[y].cellFormat.columnSpan),(m=m||u!==a.childWidgets.length-1?m:!0)&&s-n[y].ownerRow.rowIndex==g-1&&(n.splice(y,1),y--));if(1<f.cellFormat.rowSpan)if(0===n.length||n[n.length-1].columnIndex<=h)n.push(f);else for(var v=n.length;0<v;v--)n[v-1].columnIndex>h&&n.splice(v-1,0,f);l.containsKey(f.cellIndex)||l.add(f.cellIndex,parseFloat((c-p).toFixed(2))),h+=f.cellFormat.columnSpan,c+=this.getCellWidth(f.cellFormat.preferredWidth,f.cellFormat.preferredWidthType,o,null);var w=parseFloat(c.toFixed(2));t.indexOf(w)<0&&(t.push(w),i.push(c)),u===a.childWidgets.length-1&&0<d.gridAfter&&(c+=this.getCellWidth(d.gridAfterWidth,"Point",o,null),t.indexOf(parseFloat(c.toFixed(2)))<0&&(t.push(parseFloat(c.toFixed(2))),i.push(c)),h+=d.gridAfter),this.tableCellInfo.containsKey(a.rowIndex)||this.tableCellInfo.add(a.rowIndex,l)}}t.sort(function(e,t){return e-t}),i.sort(function(e,t){return e-t}),0<this.tableHolder.columns.length&&(t.length-1!==this.tableHolder.columns.length||e)&&this.updateColumnSpans(t,o,i),this.tableCellInfo.clear(),this.tableCellInfo=void 0},ah.prototype.updateColumnSpans=function(e,t,i){for(var n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n];0<=r.rowFormat.gridBeforeWidth&&(r.rowFormat.gridBefore=r.getGridCount(e,void 0,-1,t,i));for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o],a=r.getGridCount(e,s,s.getIndex(),t,i);0<a&&s.cellFormat.columnSpan!==a&&(s.cellFormat.columnSpan=a)}0<=r.rowFormat.gridAfterWidth&&(r.rowFormat.gridAfter=r.getGridCount(e,void 0,r.childWidgets.length,t,i))}},ah.prototype.getMinimumAndMaximumWordWidth=function(e,t){this.checkTableColumns();var i=this.tableHolder.isAllColumnHasPointWidthType(),n=i?this.tableHolder.getTotalWidth(0):this.tableHolder.getTotalWidth(1);return{minimumWordWidth:e=e<n?n:e,maximumWordWidth:t=t<(n=i?n:this.tableHolder.getTotalWidth(2))?n:t}},ah.prototype.checkTableColumns=function(){this.isGridUpdated||(!this.isAutoFit()&&0!==this.tableHolder.columns.length||this.buildTableColumns(),this.isGridUpdated=!1)},ah.prototype.isAutoFit=function(){var e=this.bodyWidget;return!_.isNullOrUndefined(e)&&!_.isNullOrUndefined(e.page)&&e.page.documentHelper.layout.getParentTable(this).tableFormat.allowAutoFit},ah.prototype.buildTableColumns=function(){if(!this.isGridUpdated){this.tableHolder.resetColumns();var e=0,t=[],i="Auto"===this.tableFormat.preferredWidthType,n=this.tableFormat.allowAutoFit,e=!(!_.isNullOrUndefined(this.bodyWidget.page)&&this.bodyWidget.page.viewer instanceof Wd&&n)||this.isInsideTable||this.containerWidget instanceof fc?this.getOwnerWidth(!0):j.convertPixelToPoint(this.bodyWidget.page.viewer.clientArea.width-3*this.bodyWidget.page.viewer.padding.right);e=this.tableFormat.preferredWidth>e?this.tableFormat.preferredWidth:e;for(var r=i&&0===this.tableFormat.preferredWidth&&!n,o=this.getTableClientWidth(e),s=this.getContainerWidth(),a=(r&&!this.isDefaultFormatUpdated&&n&&this.splitWidthToTableCells(o,r),!1),l=0;l<this.childWidgets.length;l++){var d=this.childWidgets[l],h=d.rowFormat,c=0,p=0,u=new Tp,g=0;0<h.gridBefore&&(0!==d.rowFormat.beforeWidth||0!==d.rowFormat.gridBeforeWidth)&&(!this.bodyWidget.page.documentHelper.alignTablesRowByRow||"Left"===d.ownerTable.tableFormat.tableAlignment||"Word2003"===this.bodyWidget.page.documentHelper.compatibilityMode&&0<d.ownerTable.firstChild.rowFormat.gridAfter)&&(p=this.getCellWidth(h.gridBeforeWidth,d.rowFormat.gridAfterWidthType,o,null),u.minimumWidth=p,this.tableHolder.addColumns(c,c=h.gridBefore,p,u,g=p,"Point"));for(var m=0;m<d.childWidgets.length;m++){var f=d.childWidgets[m];(1<f.cellFormat.rowSpan||1<f.cellFormat.columnSpan)&&(a=!0),0===t.length&&(f.columnIndex=c);for(var y=0;y<t.length;y++){var v,w,b=t[y];b.columnIndex<c?f.columnIndex=c:(w=1,v=!0,w=b.cellFormat.rowSpan,b.columnIndex>c?(f.columnIndex=c,v=!1):(u=b.getCellSizeInfo(n),p=this.getCellWidth(b.cellFormat.preferredWidth,b.cellFormat.preferredWidthType,o,b),0<this.tableHolder.columns.length?this.tableHolder.addColumns(c,c=this.tableHolder.columns.indexOf(b.ownerColumn)+b.cellFormat.columnSpan,p,u,g+=p,f.cellFormat.preferredWidthType):this.tableHolder.addColumns(c,c=b.columnIndex+b.cellFormat.columnSpan,p,u,g+=p,f.cellFormat.preferredWidthType),f.columnIndex=c),(v=v||m!==d.childWidgets.length-1?v:!0)&&l-b.ownerRow.rowIndex==w-1&&(t.splice(y,1),y--))}if(1<f.cellFormat.rowSpan)if(0===t.length||t[t.length-1].columnIndex<=c)t.push(f);else{for(var x=0,C=t.length;0<C;C--)t[C-1].columnIndex>c&&(x=C-1);t.splice(x,0,f)}u=f.getCellSizeInfo(n),p=this.getCellWidth(f.cellFormat.preferredWidth,f.cellFormat.preferredWidthType,o,f),this.tableHolder.addColumns(c,c+=f.cellFormat.columnSpan,p,u,g+=p,f.cellFormat.preferredWidthType),m===d.childWidgets.length-1&&0<h.gridAfterWidth&&(p=this.getCellWidth(h.gridAfterWidth,"Point",o,null),u.minimumWordWidth=u.maximumWordWidth=u.minimumWidth=p,this.tableHolder.addColumns(c,c+=h.gridAfter,p,u,g+=p,"Point"))}}r&&!this.isDefaultFormatUpdated&&(this.isDefaultFormatUpdated=!0),this.tableHolder.validateColumnWidths(),n?this.tableHolder.autoFitColumn(e,o,i,this.isInsideTable,n,a,this.leftIndent+this.rightIndent,s):this.tableHolder.fitColumns(e,o,i,n,this.leftIndent+this.rightIndent),this.setWidthToCells(o,i)}},ah.prototype.setWidthToCells=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i],r=n.rowFormat;0<r.gridBefore&&(r.beforeWidth=this.tableHolder.getCellWidth(0,r.gridBefore,e));for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];("Auto"===this.tableFormat.preferredWidthType&&"Percent"===s.cellFormat.preferredWidthType||this.isInsideTable&&"Percent"===this.tableFormat.preferredWidthType&&"Point"===s.cellFormat.preferredWidthType&&("Auto"===this.containerWidget.cellFormat.preferredWidthType||"Percent"===this.containerWidget.cellFormat.preferredWidthType))&&0!==s.cellFormat.cellWidth||(s.cellFormat.cellWidth=this.tableHolder.getCellWidth(s.columnIndex,s.cellFormat.columnSpan,e))}0<r.gridAfter&&(r.afterWidth=this.tableHolder.getCellWidth(0,r.gridAfter,e))}},ah.prototype.updateProperties=function(e,t,i){if(e&&(this.tableFormat.allowAutoFit="FixedColumnWidth"!==i),this!==t)t.updateProperties(!1,t,i);else if("FixedColumnWidth"===i){this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto";for(var n=0;n<this.childWidgets.length;n++)for(var r=this.childWidgets[n],o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];s.cellFormat.preferredWidthType="Point",s.cellFormat.preferredWidth=s.cellFormat.cellWidth}}else if("FitToWindow"===i){var a=this.tableHolder.getTotalWidth(0);this.tableFormat.leftIndent=0,this.tableFormat.preferredWidth=100,this.tableFormat.preferredWidthType="Percent";for(n=0;n<this.childWidgets.length;n++)for(var l=this.childWidgets[n],d=0;d<l.childWidgets.length;d++)"Percent"!==(h=l.childWidgets[d]).cellFormat.preferredWidthType&&(h.cellFormat.preferredWidthType="Percent",h.cellFormat.preferredWidth=h.cellFormat.cellWidth/a*100)}else{this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto";for(n=0;n<this.childWidgets.length;n++){(l=this.childWidgets[n]).rowFormat.beforeWidth=0,l.rowFormat.gridBefore=0,l.rowFormat.gridBeforeWidth=0,l.rowFormat.gridBeforeWidthType="Auto",l.rowFormat.afterWidth=0,l.rowFormat.gridAfter=0,l.rowFormat.gridAfterWidth=0,l.rowFormat.gridAfterWidthType="Auto";for(var h,o=0;o<l.childWidgets.length;o++)(h=l.childWidgets[o]).cellFormat.preferredWidth=0,h.cellFormat.preferredWidthType="Auto"}}},ah.prototype.getMaxRowWidth=function(e){for(var t=0,i=0;i<this.childWidgets.length;i++){for(var n=this.childWidgets[i],r=0,o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];r+=this.getCellWidth(s.cellFormat.preferredWidth,s.cellFormat.preferredWidthType,e,s)}t<r&&(t=r)}return t},ah.prototype.updateWidth=function(e){var t=this.tableHolder.getTotalWidth(0),i=this.getOwnerWidth(!0),n=this.getTableClientWidth(i);n<=t&&"Auto"===this.tableFormat.preferredWidthType&&(this.tableFormat.preferredWidthType="Point"),"Auto"!==this.tableFormat.preferredWidthType&&("Point"===this.tableFormat.preferredWidthType?this.tableFormat.preferredWidth=this.getMaxRowWidth(n):this.tableFormat.preferredWidth=t/i*100)},ah.prototype.convertPointToPercent=function(e,t){e=e/t*100;return(e=Math.round(e))<100?e:100},ah.prototype.updateChildWidgetLeft=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i];n.x=e,n.updateChildWidgetLeft(e,t)}},ah.prototype.shiftWidgetsForRtlTable=function(e,t){var i=t.x,n=e.right,r=0;t.tableFormat&&0<t.tableFormat.cellSpacing&&(r=t.tableFormat.cellSpacing);for(var o=0;o<t.childWidgets.length;o++)for(var s=t.childWidgets[o],a=n-(s.x-i),l=0;l<s.childWidgets.length;l++){var d=s.childWidgets[l];a-=d.width+d.margin.left+d.margin.right-d.rightBorderWidth+r,d.updateWidgetLeft(a+d.margin.left)}},ah.prototype.clone=function(){var e=new ah;e.tableHolder=this.tableHolder.clone(),e.tableFormat.copyFormat(this.tableFormat),this.wrapTextAround&&(e.wrapTextAround=this.wrapTextAround,e.positioning=this.positioning.clone());for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t].clone();e.childWidgets.push(i),i.containerWidget=e,i.index=t}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e.isBidiTable=this.isBidiTable,e.containerWidget=this.containerWidget,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},ah.getTableOf=function(e){var t;if(e instanceof qa)return t=dh.getRowOf(e),_.isNullOrUndefined(t)?e.ownerBase instanceof Fl&&e.ownerBase.ownerBase instanceof ah?e.ownerBase.ownerBase:void 0:t.ownerTable},ah.prototype.fitChildToClientArea=function(){var e=this.getContainerWidth();Math.round(e)<Math.round(this.getTableWidth())&&this.fitCellsToClientArea(e);for(var t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++)r.childWidgets[o]instanceof ah&&r.childWidgets[o].fitChildToClientArea()},ah.prototype.getColumnCellsForSelection=function(e,t){for(var i=[],n=e.columnIndex,r=t.columnIndex+t.cellFormat.columnSpan,o=0;o<this.childWidgets.length;o++)for(var s=this.childWidgets[o],a=0;a<s.childWidgets.length;a++){var l=s.childWidgets[a],d=l.columnIndex,h=l.cellFormat.columnSpan;n<d+h&&d+h<r||n<d&&d<r?i.indexOf(l)<0&&i.push(l):(n<d&&d<r&&d+h<r||d<n&&r<d+h||d===n||d+h===r)&&i.indexOf(l)<0&&i.push(l)}return i},ah.prototype.splitWidthToTableCells=function(e,t){for(var i=0;i<this.childWidgets.length;i++)this.childWidgets[i].splitWidthToRowCells(e,t)},ah.prototype.insertTableRowsInternal=function(e,t,i){for(var n=e.length-1;0<=n;n--){var r=e.splice(n,1)[0];(r.containerWidget=this).childWidgets.splice(t,0,r)}this.updateRowIndex(t),this.isGridUpdated=!1,i&&(this.calculateGrid(!0),this.buildTableColumns()),this.isGridUpdated=!0},ah.prototype.updateRowIndex=function(e){for(var t=e;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.index=t;for(var n=0;n<i.childWidgets.length;n++)i.childWidgets[n].index=n,i.childWidgets[n].rowIndex=i.rowIndex;e++}},ah.prototype.getCellStartOffset=function(e){var t,i=0;return i=e&&this.tableCellInfo&&this.tableCellInfo.containsKey(e.ownerRow.rowIndex)&&(t=this.tableCellInfo.get(e.ownerRow.rowIndex)).containsKey(e.cellIndex)?t.get(e.cellIndex):i},ah.prototype.destroyInternal=function(e){var t=this.height;if(!_.isNullOrUndefined(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){var n=void 0,n=this.childWidgets[i];if(_.isNullOrUndefined(n)||n.destroyInternal(e),_.isNullOrUndefined(this.childWidgets))break;i--}this.childWidgets=void 0}_.isNullOrUndefined(this.containerWidget)||(this.containerWidget instanceof z&&-1!==this.containerWidget.floatingElements.indexOf(this)&&this.containerWidget.floatingElements.splice(this.containerWidget.floatingElements.indexOf(this),1),_.isNullOrUndefined(this.containerWidget.childWidgets)||(-1!==this.containerWidget.childWidgets.indexOf(this)&&this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=t),this.containerWidget=void 0),this.destroy()},ah.prototype.destroy=function(){this.tableFormat=void 0,this.spannedRowCollection&&this.spannedRowCollection.destroy(),this.spannedRowCollection=void 0,this.tableHolder=void 0,this.flags=void 0,this.leftMargin=void 0,this.topMargin=void 0,this.rightMargin=void 0,this.bottomMargin=void 0,this.headerHeight=void 0,this.isDefaultFormatUpdated=void 0,sh.prototype.destroy.call(this)},ah.prototype.componentDestroy=function(){this.tableFormat&&this.tableFormat.destroy(),this.tableFormat=void 0,this.spannedRowCollection&&this.spannedRowCollection.destroy(),this.spannedRowCollection=void 0,this.tableHolder&&this.tableHolder.destroy(),this.tableHolder=void 0,this.flags=void 0,this.leftMargin=void 0,this.topMargin=void 0,this.rightMargin=void 0,this.bottomMargin=void 0,this.headerHeight=void 0,this.isDefaultFormatUpdated=void 0,sh.prototype.componentDestroy.call(this)};var sh,K=ah;function ah(){var e=sh.call(this)||this;return e.flags=0,e.leftMargin=0,e.topMargin=0,e.rightMargin=0,e.bottomMargin=0,e.isDefaultFormatUpdated=!1,e.isContainInsideTable=!1,e.footnoteElement=[],e.margin=new Dd(e.leftMargin,e.topMargin,e.rightMargin,e.bottomMargin),e.leftBorderWidth=0,e.rightBorderWidth=0,e.topBorderWidth=0,e.bottomBorderWidth=0,e.tableFormat=new Fl(e),e.tableHolder=new bp,e.spannedRowCollection=new T,e}pl(hh,lh=Qd),Object.defineProperty(hh.prototype,"rowIndex",{get:function(){return this.containerWidget?this.containerWidget.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(hh.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof K)return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(hh.prototype,"nextRow",{get:function(){var e=this.indexInOwner;if(-1<e&&e<this.ownerTable.childWidgets.length-1)return this.ownerTable.childWidgets[e+1]},enumerable:!0,configurable:!0}),hh.prototype.equals=function(e){return e instanceof hh&&e.rowFormat===this.rowFormat},hh.prototype.combineCells=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.combineWidget(e),_.isNullOrUndefined(i.cellFormat)||1!==i.cellFormat.rowSpan?_.isNullOrUndefined(i.cellFormat)&&t--:(i.height,i.margin.top,i.margin.bottom,this.height-this.ownerTable.tableFormat.cellSpacing<i.height&&(this.height=this.ownerTable.tableFormat.cellSpacing+i.height))}},hh.getRowOf=function(e){var t;if(e instanceof qa)return t=N.getCellOf(e),_.isNullOrUndefined(t)?e.ownerBase instanceof Ya&&e.ownerBase.ownerBase instanceof hh?e.ownerBase.ownerBase:void 0:t.ownerRow},hh.prototype.getCell=function(e,t,i){for(var n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n];if(r.rowIndex===e&&(_.isNullOrUndefined(i)?r.columnIndex===t:r.cellIndex===i))return r}},hh.prototype.getCellUsingColumnIndex=function(e,t){for(var i,n=0;n<this.childWidgets.length;n++)if((i=this.childWidgets[n]).rowIndex===e&&i.columnIndex===t)return i;if(i=this.getCell(e,t),!_.isNullOrUndefined(i))return i},hh.prototype.splitWidthToRowCells=function(e,t){for(var i=this.childWidgets,n=e/i.length,r=0;r<i.length;r++)if(t&&0===i[r].cellFormat.preferredWidth)i[r].cellFormat.preferredWidth=n,this.ownerTable.isDefaultFormatUpdated=!1;else{if(t){this.ownerTable.isDefaultFormatUpdated=!0;break}i[r].cellFormat.preferredWidth=n}},hh.prototype.getGridCount=function(e,t,i,n,r){var o=0,s=0,a=this.ownerTable,l=this.rowFormat,s=-1===i?a.getCellWidth(l.gridBeforeWidth,l.gridBeforeWidthType,n,null):(o+=a.getCellWidth(l.gridBeforeWidth,l.gridBeforeWidthType,n,null),0<=i&&(o+=a.getCellStartOffset(t)),i<this.childWidgets.length?a.getCellWidth(t.cellFormat.preferredWidth,t.cellFormat.preferredWidthType,n,null):a.getCellWidth(l.gridAfterWidth,l.gridAfterWidthType,n,null)),i=r[e.indexOf(o)],t=this.getOffsetIndex(e,o),a=parseFloat((s+o).toFixed(2)),l=parseFloat((s+i).toFixed(2))===a||_.isNullOrUndefined(i)?this.getOffsetIndex(e,o+s):this.getOffsetIndex(e,i+s);return l-t},hh.prototype.getOffsetIndex=function(e,t){t=parseFloat(t.toFixed(2));var i=0;if(0<=e.indexOf(t))i=e.indexOf(t);else{for(var n=0;n<e.length;n++)if(e[n]>t)return n;i=e.length-1}return i},hh.prototype.getCellOffset=function(e,t){for(var i=0,n=this.ownerTable,r=0;r<this.childWidgets.length;r++){var o=this.childWidgets[r].cellFormat;if(r===e)break;i+=n.getCellWidth(o.preferredWidth,o.preferredWidthType,t,null)}return i},hh.prototype.updateRowBySpannedCells=function(){for(var e=this.getPreviousRowSpannedCells(),t=this.rowIndex,i=0;i<e.length;i++){var n=e[i];t<=n.ownerRow.rowIndex+n.cellFormat.rowSpan-1&&--n.cellFormat.rowSpan}},hh.prototype.getPreviousRowSpannedCells=function(e){for(var t=[],i=e?this:this.previousWidget;!_.isNullOrUndefined(i);){for(var n=0;n<i.childWidgets.length;n++){var r=i.childWidgets[n];1<r.cellFormat.rowSpan&&t.splice(0,0,r)}i=i.previousWidget}return t},hh.prototype.isCellsHaveSameWidthUnit=function(){if(0<this.childWidgets.length)for(var e=this.childWidgets[0].cellFormat.preferredWidthType,t=1;t<this.childWidgets.length;t++)if(e!=this.childWidgets[t].cellFormat.preferredWidthType)return!1;return!0},hh.prototype.updateUniformWidthUnitForCells=function(){for(var e=0;e<this.childWidgets.length;e++){var t=this.childWidgets[e];t.cellFormat.preferredWidthType="Point",t.cellFormat.preferredWidth=t.cellFormat.cellWidth}},hh.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=Math.round(this.childWidgets[t].x);if(i-this.childWidgets[t].margin.left-1<=e.x&&i+this.childWidgets[t].width>=e.x)return this.childWidgets[t];if(t===this.childWidgets.length-1&&this.childWidgets[t].x+this.childWidgets[t].width+1<=e.x)return this.childWidgets[t]}var n=void 0;return n=0<this.childWidgets.length?(this.childWidgets[0].x<=e.x?this.childWidgets[this.childWidgets.length-1]:this.childWidgets[0]).getTableCellWidget(e):n},hh.prototype.getFirstRowWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++)e+=this.childWidgets[t].getCellWidth(this.ownerTable);return e},hh.prototype.getCellWidget=function(e,t){var i=this.ownerTable.tableHolder.getValidColumnIndex(e),n=(e<i&&(t-=i-e,e=i),0);0<this.rowFormat.gridBefore&&(n+=this.rowFormat.gridBefore);for(var r=0;r<this.childWidgets.length;r++){var o=this.childWidgets[r],s=o.cellFormat.columnSpan;if(n<o.columnIndex&&(n<=e||n<e+t)&&o.columnIndex>e)return null;if((o.columnIndex<=e||o.columnIndex<e+t)&&o.columnIndex+s>e)return o;if(o.columnIndex>e)break;n+=s}return null},hh.prototype.getVerticalMergeStartCell=function(e,t){var i,n,r=this.ownerTable.tableHolder.columns;return 0<this.rowFormat.gridBefore&&this.rowFormat.gridBefore>e+t?null:(i=this.getCellWidget(e,t),_.isNullOrUndefined(i)?e+this.rowFormat.gridAfter!==r.length&&(r=this.previousWidget,_.isNullOrUndefined(r)||(n=r.getVerticalMergeStartCell(e,t)),!_.isNullOrUndefined(n))&&1<n.cellFormat.rowSpan&&this.index===n.rowIndex+n.cellFormat.rowSpan-1?n:null:i)},hh.prototype.getMinimumAndMaximumWordWidth=function(e,t){return{minimumWordWidth:e,maximumWordWidth:t}},hh.prototype.destroyInternal=function(e){var t=this.height;if(!_.isNullOrUndefined(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){if(this.childWidgets[i].destroyInternal(e),_.isNullOrUndefined(this.childWidgets))break;i--}this.childWidgets=void 0}_.isNullOrUndefined(this.containerWidget)||_.isNullOrUndefined(this.containerWidget.childWidgets)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),(_.isNullOrUndefined(this.containerWidget.childWidgets)||0===this.containerWidget.childWidgets.length)&&this.containerWidget instanceof K?this.containerWidget.destroyInternal(e):this.containerWidget.containerWidget instanceof z&&(this.containerWidget.containerWidget.height-=t),this.containerWidget.height-=t),this.destroy()},hh.prototype.clone=function(){var e=new hh;e.rowFormat.copyFormat(this.rowFormat),e.topBorderWidth=this.topBorderWidth,e.bottomBorderWidth=this.bottomBorderWidth,e.isRenderBookmarkEnd=this.isRenderBookmarkEnd;for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t].clone();e.childWidgets.push(i),i.containerWidget=e,i.index=t,i.rowIndex=this.rowIndex}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},hh.prototype.updateChildWidgetLeft=function(e,t){var i=0;0<this.ownerTable.tableFormat.cellSpacing&&(i=this.ownerTable.tableFormat.cellSpacing);for(var n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n];e+=i+r.margin.left,r.x=e,r.updateChildWidgetLeft(r.x,t),e+=r.width+r.margin.right}},hh.prototype.shiftWidgetForRtlTable=function(){for(var e=this.ownerTable,t=e.x,i=0,n=(null!=e.tableFormat&&0<e.tableFormat.cellSpacing&&(i=e.tableFormat.cellSpacing),e=j.convertPointToPixel(e.getTableWidth()),this.x),r=t+e-(n-t),o=0,s=0;s<this.childWidgets.length;s++){var a=this.childWidgets[s],l=0;(l=_.isNullOrUndefined(a.previousWidget)?l:a.previousWidget.columnIndex+a.previousWidget.cellFormat.columnSpan)<a.columnIndex&&(o=j.convertPointToPixel(a.ownerTable.tableHolder.getPreviousSpannedCellWidth(l,a.columnIndex)),0===l)&&(o-=i/2),r-=a.width+a.margin.left+a.margin.right+i,a.updateWidgetLeft(r+a.margin.left-o)}},hh.prototype.destroy=function(){this.rowFormat=void 0,this.topBorderWidth=void 0,this.bottomBorderWidth=void 0,lh.prototype.destroy.call(this)},hh.prototype.componentDestroy=function(){this.rowFormat&&this.rowFormat.destroy(),this.rowFormat=void 0,this.topBorderWidth=void 0,this.bottomBorderWidth=void 0,this.isRenderBookmarkEnd=void 0,lh.prototype.componentDestroy.call(this)};var lh,dh=hh;function hh(){var e=lh.call(this)||this;return e.isRenderBookmarkEnd=!1,e.topBorderWidth=0,e.bottomBorderWidth=0,e.rowFormat=new Ya(e),e.editRangeID=new T,e}pl(ph,ch=Qd),Object.defineProperty(ph.prototype,"ownerColumn",{get:function(){return this.ownerTable.tableHolder.columns[this.columnIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(ph.prototype,"leftMargin",{get:function(){return this.cellFormat&&this.cellFormat.hasValue("leftMargin")?this.cellFormat.leftMargin:!_.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("leftMargin")?this.ownerRow.rowFormat.leftMargin:_.isNullOrUndefined(this.ownerTable)||_.isNullOrUndefined(this.ownerTable.tableFormat)||!this.ownerTable.tableFormat.hasValue("leftMargin")?0:this.ownerTable.tableFormat.leftMargin},enumerable:!0,configurable:!0}),Object.defineProperty(ph.prototype,"topMargin",{get:function(){return this.cellFormat&&this.cellFormat.hasValue("topMargin")?this.cellFormat.topMargin:!_.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("topMargin")?this.ownerRow.rowFormat.topMargin:_.isNullOrUndefined(this.ownerTable)||_.isNullOrUndefined(this.ownerTable.tableFormat)||!this.ownerTable.tableFormat.hasValue("topMargin")?0:this.ownerTable.tableFormat.topMargin},enumerable:!0,configurable:!0}),Object.defineProperty(ph.prototype,"rightMargin",{get:function(){return this.cellFormat&&this.cellFormat.hasValue("rightMargin")?this.cellFormat.rightMargin:!_.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("rightMargin")?this.ownerRow.rowFormat.rightMargin:_.isNullOrUndefined(this.ownerTable)||_.isNullOrUndefined(this.ownerTable.tableFormat)||!this.ownerTable.tableFormat.hasValue("rightMargin")?0:this.ownerTable.tableFormat.rightMargin},enumerable:!0,configurable:!0}),Object.defineProperty(ph.prototype,"bottomMargin",{get:function(){return this.cellFormat&&this.cellFormat.hasValue("bottomMargin")?this.cellFormat.bottomMargin:!_.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("bottomMargin")?this.ownerRow.rowFormat.bottomMargin:_.isNullOrUndefined(this.ownerTable)||_.isNullOrUndefined(this.ownerTable.tableFormat)||!this.ownerTable.tableFormat.hasValue("bottomMargin")?0:this.ownerTable.tableFormat.bottomMargin},enumerable:!0,configurable:!0}),Object.defineProperty(ph.prototype,"cellIndex",{get:function(){return this.ownerRow?this.ownerRow.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(ph.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof dh)return this.containerWidget.ownerTable},enumerable:!0,configurable:!0}),Object.defineProperty(ph.prototype,"ownerRow",{get:function(){return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(ph.prototype,"sizeInfo",{get:function(){return this.sizeInfoInternal},enumerable:!0,configurable:!0}),ph.prototype.equals=function(e){return e instanceof ph&&e.cellFormat===this.cellFormat},ph.prototype.getContainerTable=function(){for(var e=this.ownerTable;e instanceof K&&e.associatedCell instanceof ph;)e=e.associatedCell.getContainerTable();return e},ph.prototype.getPreviousSplitWidget=function(){if(this.containerWidget instanceof dh){var e=this.containerWidget;do{if(e=e.previousRenderedWidget,_.isNullOrUndefined(e)||e.index<this.rowIndex)break;var t=e.getCell(this.rowIndex,this.columnIndex);if(t&&this.equals(t))return t}while(e)}},ph.prototype.getNextSplitWidget=function(){var e=this.cellFormat.rowSpan;if(this.containerWidget instanceof dh){var t=this.containerWidget;do{if(t=t.nextRenderedWidget,_.isNullOrUndefined(t)||t.index>this.rowIndex+e)break;var i=t.getCell(this.rowIndex,this.columnIndex);if(i&&this.equals(i))return i}while(t)}},ph.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t].y<=e.y&&this.childWidgets[t].y+this.childWidgets[t].height>=e.y)return this.childWidgets[t].getTableCellWidget(e);var i=void 0;return i=0<this.childWidgets.length?(this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1]:this.childWidgets[0]).getTableCellWidget(e):i},ph.prototype.updateWidth=function(e){"Point"===this.cellFormat.preferredWidthType?this.cellFormat.preferredWidth=e:"Percent"===this.cellFormat.preferredWidthType&&(this.cellFormat.preferredWidth=this.convertPointToPercent(e)),this.cellFormat.cellWidth=e},ph.prototype.getCellWidth=function(e){var t=this.ownerTable,i=t?t.getTableClientWidth(t.getOwnerWidth(!0)):0,n=i,r=_.isNullOrUndefined(this.leftMargin)?0:this.leftMargin,o=_.isNullOrUndefined(this.rightMargin)?0:this.rightMargin;return t&&"Auto"===t.tableFormat.preferredWidthType&&t.tableFormat.allowAutoFit?n=0===this.cellFormat.preferredWidth?i:"Percent"===this.cellFormat.preferredWidthType?this.cellFormat.preferredWidth*i/100-r-o:this.cellFormat.preferredWidth-r-o:"Percent"===this.cellFormat.preferredWidthType?n=this.cellFormat.preferredWidth*i/100-r-o:"Point"===this.cellFormat.preferredWidthType&&(n=e instanceof K&&"Percent"===e.tableFormat.preferredWidthType?this.cellFormat.cellWidth-r-o:this.cellFormat.preferredWidth-r-o),n},ph.prototype.convertPointToPercent=function(e){var t=this.ownerTable.getOwnerWidth(!0),e=e/this.ownerTable.getTableClientWidth(t)*100;return(e=Math.round(e))<100?e:100},ph.getCellLeftBorder=function(e){var t=void 0,i=e.cellFormat.borders,n=_.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,r=_.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;return _.isNullOrUndefined(i.left)||(t=i.left),_.isNullOrUndefined(t)&&(t=e.getLeftBorderToRenderByHierarchy(t,n,r)),t=0<e.ownerTable.tableFormat.cellSpacing?e.getLeftBorderToRenderByHierarchy(t,n,r):(i=this.getPreviousCell(e),e.getPreviousCellLeftBorder(t,i)),t=_.isNullOrUndefined(t)?new Va(e.cellFormat.borders):t},ph.getPreviousCell=function(e){var t,i=void 0;return _.isNullOrUndefined(e.previousWidget)||(t=e.previousWidget).columnIndex+t.cellFormat.columnSpan===e.columnIndex&&(i=t),i},ph.prototype.getLeftBorderWidth=function(){var e=0;return e=null!==this.cellFormat&&null!==this.cellFormat.borders?ph.getCellLeftBorder(this).getLineWidth():e},ph.prototype.getRightBorderWidth=function(){var e=0;this.ownerTable;return e=null!==this.cellFormat&&null!==this.cellFormat.borders?ph.getCellRightBorder(this).getLineWidth():e},ph.prototype.getCellSpacing=function(){var e=this.ownerTable&&this.ownerTable.tableFormat?this.ownerTable.tableFormat.cellSpacing:0;return 1===this.ownerRow.childWidgets.length?2*e:0===this.cellIndex||this.cellIndex===this.ownerRow.childWidgets.length-1?e+e/2:e},ph.prototype.getCellSizeInfo=function(e){var t=!0,i=void 0,e=(_.isNullOrUndefined(this.bodyWidget)||_.isNullOrUndefined(this.bodyWidget.page)||_.isNullOrUndefined(this.bodyWidget.page.documentHelper)||(i=this.bodyWidget.page.documentHelper.layout),_.isNullOrUndefined(i)||_.isNullOrUndefined(i.currentCell)||(t=!1,this===i.currentCell&&(t=!0)),t&&!this.sizeInfo.hasMinimumWidth&&(this.sizeInfo.minimumWidth=this.getMinimumPreferredWidth()),e&&t&&!this.sizeInfo.hasMinimumWordWidth&&(i=this.getMinimumAndMaximumWordWidth(0,0),this.sizeInfo.minimumWordWidth=i.minimumWordWidth+this.sizeInfo.minimumWidth,this.sizeInfo.maximumWordWidth=i.maximumWordWidth+this.sizeInfo.minimumWidth),new Tp);return e.minimumWidth=this.sizeInfo.minimumWidth,e.minimumWordWidth=this.sizeInfo.minimumWordWidth,e.maximumWordWidth=this.sizeInfo.maximumWordWidth,e},ph.prototype.getMinimumPreferredWidth=function(){return this.leftMargin+this.rightMargin+this.getLeftBorderWidth()+this.getRightBorderWidth()+this.getCellSpacing()},ph.prototype.getPreviousCellLeftBorder=function(e,t){var i;return!_.isNullOrUndefined(t)&&(_.isNullOrUndefined(e)||"None"!==e.lineStyle||e.hasNoneStyle)||_.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl||(e=this.getLeftBorderToRenderByHierarchy(e,dh.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders)),_.isNullOrUndefined(t)?e:(i=void 0,_.isNullOrUndefined(t.cellFormat.borders)||_.isNullOrUndefined(t.cellFormat.borders.right)||"None"===t.cellFormat.borders.right.lineStyle||(i=t.cellFormat.borders.right),_.isNullOrUndefined(i)||"None"===i.lineStyle?_.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl?e:this.getLeftBorderToRenderByHierarchy(e,dh.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(i,e))},ph.prototype.getBorderBasedOnPriority=function(e,t){var i,n,r,o,s,a,l,d,h,c;return _.isNullOrUndefined(e)?t:_.isNullOrUndefined(t)?e:(i=e.getBorderWeight())===(n=t.getBorderWeight())?(r=e.getPrecedence())===(o=t.getPrecedence())?(h=(a=j.convertHexToRgb(e.color)).r,s=a.g,a=a.b,d=(c=j.convertHexToRgb(t.color)).r,l=c.g,(h=h+a+2*s)===(c=d+(d=c.b)+2*l)&&(h=a+2*s)===(c=d+2*l)?s!==l&&l<s?t:e:c<h?t:e):o<r?e:t:n<i?e:t},ph.prototype.getLeftBorderToRenderByHierarchy=function(e,t,i){var n,r=ph.getCellOf(e.ownerBase);return _.isNullOrUndefined(r)||(n=!1,(0===r.columnIndex||0===r.cellIndex&&0<r.ownerRow.rowFormat.gridBefore)&&(n=!0),r=!1,_.isNullOrUndefined(t.left)||"None"===t.left.lineStyle||!t.left.isBorderDefined||_.isNullOrUndefined(e)||"None"!==e.lineStyle||!e.isBorderDefined||e.hasValue("color")||(r=!0),(_.isNullOrUndefined(e)||"None"!==e.lineStyle||e.isBorderDefined&&!r)&&!_.isNullOrUndefined(e))||(n?(e=t.left,(!_.isNullOrUndefined(e)&&"None"===e.lineStyle||_.isNullOrUndefined(e))&&(e=i.left)):(e=t.vertical,(!_.isNullOrUndefined(e)&&"None"===e.lineStyle||_.isNullOrUndefined(e))&&(e=i.vertical))),e},ph.getCellRightBorder=function(e){var t=void 0,i=e.cellFormat.borders,n=_.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,r=_.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;return _.isNullOrUndefined(i.right)||(t=i.right),_.isNullOrUndefined(t)&&(t=e.getRightBorderToRenderByHierarchy(t,n,r)),t=0<e.ownerTable.tableFormat.cellSpacing?e.getRightBorderToRenderByHierarchy(t,n,r):(i=this.getNextCell(e),e.getAdjacentCellRightBorder(t,i)),t=_.isNullOrUndefined(t)?new Va(e.cellFormat.borders):t},ph.getNextCell=function(e){var t,i=void 0,n=e.cellFormat.columnSpan;return _.isNullOrUndefined(e.nextWidget)||(t=e.nextWidget,e.columnIndex+n===t.columnIndex&&(i=t)),i},ph.prototype.getAdjacentCellRightBorder=function(e,t){var i;return!_.isNullOrUndefined(t)&&(_.isNullOrUndefined(e)||"None"!==e.lineStyle||e.hasNoneStyle)||_.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl||(e=this.getRightBorderToRenderByHierarchy(e,dh.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders)),_.isNullOrUndefined(t)?e:(i=void 0,_.isNullOrUndefined(t.cellFormat.borders)||_.isNullOrUndefined(t.cellFormat.borders.left)||"None"===t.cellFormat.borders.left.lineStyle||(i=t.cellFormat.borders.left),_.isNullOrUndefined(i)||"None"===i.lineStyle?_.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl?e:this.getRightBorderToRenderByHierarchy(e,dh.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,i))},ph.prototype.getRightBorderToRenderByHierarchy=function(e,t,i){var n,r=ph.getCellOf(e.ownerBase);return _.isNullOrUndefined(r)||(n=!1,r.columnIndex+r.cellFormat.columnSpan!==r.ownerTable.tableHolder.columns.length&&r.cellIndex!==r.ownerRow.childWidgets.length-1||(n=!0),r=!1,_.isNullOrUndefined(t.right)||"None"===t.right.lineStyle||!t.right.isBorderDefined||_.isNullOrUndefined(e)||"None"!==e.lineStyle||!e.isBorderDefined||e.hasValue("color")||(r=!0),(_.isNullOrUndefined(e)||"None"!==e.lineStyle||e.isBorderDefined&&!r)&&!_.isNullOrUndefined(e))||(n?(e=t.right,(!_.isNullOrUndefined(e)&&"None"===e.lineStyle||_.isNullOrUndefined(e))&&(e=i.right)):(e=t.vertical,(!_.isNullOrUndefined(e)&&"None"===e.lineStyle||_.isNullOrUndefined(e))&&(e=i.vertical))),e},ph.getCellTopBorder=function(e){var t=void 0,i=e.cellFormat.borders,n=_.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,r=_.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;return _.isNullOrUndefined(i.top)||(t=i.top),_.isNullOrUndefined(t)&&(t=e.getTopBorderToRenderByHierarchy(t,n,r)),t=0<e.ownerTable.tableFormat.cellSpacing?e.getTopBorderToRenderByHierarchy(t,n,r):(i=e.getTopAdjacentCell(),e.getPreviousCellTopBorder(t,i)),t=_.isNullOrUndefined(t)?new Va(e.cellFormat.borders):t},ph.prototype.getTopAdjacentCell=function(){var e,t=this.ownerRow.previousWidget;return e=_.isNullOrUndefined(t)?e:t.getVerticalMergeStartCell(this.columnIndex,this.cellFormat.columnSpan)},ph.prototype.getPreviousCellTopBorder=function(e,t){var i;return!_.isNullOrUndefined(t)&&(_.isNullOrUndefined(e)||"None"!==e.lineStyle||e.hasNoneStyle)||_.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl||(e=this.getTopBorderToRenderByHierarchy(e,dh.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders)),_.isNullOrUndefined(t)?e:(i=void 0,_.isNullOrUndefined(t.cellFormat.borders)||_.isNullOrUndefined(t.cellFormat.borders.bottom)||(i=this.getBottomBorderToRenderByHierarchy(t.cellFormat.borders.bottom,t.ownerRow.rowFormat.borders,t.ownerTable.tableFormat.borders)),_.isNullOrUndefined(i)||"None"===i.lineStyle?_.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl?e:this.getTopBorderToRenderByHierarchy(e,dh.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,i))},ph.prototype.getTopBorderToRenderByHierarchy=function(e,t,i){var n,r=ph.getCellOf(e.ownerBase);return _.isNullOrUndefined(r)||(r=_.isNullOrUndefined(r.ownerRow.previousWidget),n=!1,_.isNullOrUndefined(t.top)||"None"===t.top.lineStyle||!t.top.isBorderDefined||_.isNullOrUndefined(e)||"None"!==e.lineStyle||!e.isBorderDefined||e.hasValue("color")||(n=!0),(_.isNullOrUndefined(e)||"None"!==e.lineStyle||e.isBorderDefined&&!n)&&!_.isNullOrUndefined(e))||(r?(e=t.top,(!_.isNullOrUndefined(e)&&"None"===e.lineStyle||_.isNullOrUndefined(e))&&(e=i.top)):(e=t.horizontal,(!_.isNullOrUndefined(e)&&"None"===e.lineStyle||_.isNullOrUndefined(e))&&(e=i.horizontal))),e},ph.getCellBottomBorder=function(e){var t=void 0,i=e.cellFormat.borders,n=_.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,r=_.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(_.isNullOrUndefined(i.bottom)||(t=i.bottom),_.isNullOrUndefined(t)&&(t=e.getBottomBorderToRenderByHierarchy(t,n,r)),0<e.ownerTable.tableFormat.cellSpacing)t=e.getBottomBorderToRenderByHierarchy(t,n,r);else{var i=void 0,o=void 0,s=e.cellFormat.rowSpan;if(1===s)o=e.ownerRow.nextWidget;else if(1<s){var a=e.containerWidget;do{if(a=a.nextWidget,_.isNullOrUndefined(a))break;if(a.index===e.rowIndex+s){o=a;break}}while(a)}_.isNullOrUndefined(o)||(i=o.getCellWidget(e.columnIndex,e.cellFormat.columnSpan)),t=e.getAdjacentCellBottomBorder(t,i)}return t=_.isNullOrUndefined(t)?new Va(e.cellFormat.borders):t},ph.prototype.getAdjacentCellBottomBorder=function(e,t){var i;return!_.isNullOrUndefined(t)&&(_.isNullOrUndefined(e)||"None"!==e.lineStyle||e.hasNoneStyle)||_.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl||(e=this.getBottomBorderToRenderByHierarchy(e,dh.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders)),_.isNullOrUndefined(t)?e:(i=void 0,_.isNullOrUndefined(t.cellFormat.borders)||_.isNullOrUndefined(t.cellFormat.borders.top)||"None"===t.cellFormat.borders.top.lineStyle||(i=t.cellFormat.borders.top),_.isNullOrUndefined(i)||"None"===i.lineStyle?_.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl?e:this.getBottomBorderToRenderByHierarchy(e,dh.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,i))},ph.prototype.getBottomBorderToRenderByHierarchy=function(e,t,i){var n,r=ph.getCellOf(e.ownerBase);return _.isNullOrUndefined(r)||(r=_.isNullOrUndefined(r.ownerRow.nextWidget),n=!1,_.isNullOrUndefined(t.bottom)||"None"===t.bottom.lineStyle||!t.bottom.isBorderDefined||_.isNullOrUndefined(e)||"None"!==e.lineStyle||!e.isBorderDefined||e.hasValue("color")||(n=!0),(_.isNullOrUndefined(e)||"None"!==e.lineStyle||e.isBorderDefined&&!n)&&!_.isNullOrUndefined(e))||(r?(e=t.bottom,(!_.isNullOrUndefined(e)&&"None"===e.lineStyle||_.isNullOrUndefined(e))&&(e=i.bottom)):(e=t.horizontal,(!_.isNullOrUndefined(e)&&"None"===e.lineStyle||_.isNullOrUndefined(e))&&(e=i.horizontal))),e},ph.getCellOf=function(e){return e instanceof qa&&e.ownerBase instanceof Tl&&e.ownerBase.ownerBase instanceof ph?e.ownerBase.ownerBase:void 0},ph.prototype.updateWidgetLeft=function(e){this.x=e,this.updateChildWidgetLeft(e)},ph.prototype.updateChildWidgetLeft=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var n,r=this.childWidgets[i];r.x=e,t&&r instanceof G&&(r.x=e+j.convertPointToPixel(r.leftIndent)),r instanceof K&&((r=r).updateChildWidgetLeft(e,t),r.isBidiTable)&&(n=new Rd(r.x,r.y,r.width,r.height),r.shiftWidgetsForRtlTable(n,r))}},ph.prototype.getMinimumAndMaximumWordWidth=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].getMinimumAndMaximumWordWidth(e,t);e=n.minimumWordWidth,t=n.maximumWordWidth}return{minimumWordWidth:e,maximumWordWidth:t}},ph.prototype.destroyInternal=function(e){if(!_.isNullOrUndefined(this.childWidgets)){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];0 instanceof G,i.destroyInternal(e),t--}this.childWidgets=void 0,_.isNullOrUndefined(e.documentHelper.selection)||e.documentHelper.selection.selectedWidgets.containsKey(this)&&e.documentHelper.selection.selectedWidgets.remove(this)}this.destroy()},ph.prototype.clone=function(){var e=new ph;e.cellFormat.copyFormat(this.cellFormat);for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t].clone();e.childWidgets.push(i),i.containerWidget=e,i.index=t}return e.leftBorderWidth=this.leftBorderWidth,e.rightBorderWidth=this.rightBorderWidth,e.isRenderBookmarkEnd=this.isRenderBookmarkEnd,e.isRenderBookmarkStart=this.isRenderBookmarkStart,this.margin&&(e.margin=this.margin.clone()),e.columnIndex=this.columnIndex,e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},ph.prototype.destroy=function(){this.cellFormat=void 0,this.rowIndex=void 0,this.columnIndex=void 0,this.isSplittedCell=void 0,ch.prototype.destroy.call(this)},ph.prototype.componentDestroy=function(){this.cellFormat&&this.cellFormat.destroy(),this.cellFormat=void 0,this.contentControlProperties=void 0,this.rowIndex=void 0,this.columnIndex=void 0,this.isRenderBookmarkStart=void 0,this.isRenderBookmarkEnd=void 0,ch.prototype.componentDestroy.call(this)};var ch,N=ph;function ph(){var e=ch.call(this)||this;return e.rowIndex=-1,e.sizeInfoInternal=new Tp,e.updatedTopBorders=[],e.isRenderBookmarkStart=!1,e.isRenderBookmarkEnd=!1,e.isRenderEditRangeStart=!1,e.isRenderEditRangeEnd=!1,e.isSplittedCell=!1,e.margin=new Dd(e.leftMargin,e.topMargin,e.rightMargin,e.bottomMargin),e.leftBorderWidth=0,e.rightBorderWidth=0,e.cellFormat=new Tl(e),e}Object.defineProperty(gh.prototype,"renderedElements",{get:function(){return _.isNullOrUndefined(this.layoutedElements)?this.children:this.layoutedElements},enumerable:!0,configurable:!0}),Object.defineProperty(gh.prototype,"indexInOwner",{get:function(){return this.paragraph&&this.paragraph.childWidgets?this.paragraph.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(gh.prototype,"nextLine",{get:function(){var e=this.paragraph,t=this.indexInOwner;if(t<=e.childWidgets.length-2)return e.childWidgets[t+1];if(e.nextSplitWidget){t=e.nextSplitWidget.firstChild;if(t instanceof gh&&t.paragraph.equals(this.paragraph))return t}},enumerable:!0,configurable:!0}),Object.defineProperty(gh.prototype,"previousLine",{get:function(){var e=this.paragraph,t=this.indexInOwner,i=e.previousSplitWidget;if(0<t)return e.childWidgets[t-1];if(i instanceof G){e=i.lastChild;if(e instanceof gh&&e.paragraph.equals(this.paragraph))return e}},enumerable:!0,configurable:!0}),Object.defineProperty(gh.prototype,"isEndsWithPageBreak",{get:function(){if(0<this.children.length){var e=this.children[this.children.length-1];if(e instanceof X)return e.isPageBreak}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(gh.prototype,"isEndsWithColumnBreak",{get:function(){if(0<this.children.length){var e=this.children[this.children.length-1];if(e instanceof X)return e.isColumnBreak}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(gh.prototype,"isEndsWithLineBreak",{get:function(){if(0<this.children.length){var e=this.children[this.children.length-1];if(e instanceof X)return"\v"===e.text}return!1},enumerable:!0,configurable:!0}),gh.prototype.isFirstLine=function(){var e=this.indexInOwner;return!!(-1<e&&(void 0===this.paragraph.previousSplitWidget||this.paragraph.previousSplitWidget instanceof G&&(this.paragraph.previousSplitWidget.isEndsWithColumnBreak||this.paragraph.previousSplitWidget.isEndsWithPageBreak)))&&0===e},gh.prototype.isLastLine=function(){var e=this.indexInOwner;return-1<e&&void 0===this.paragraph.nextSplitWidget&&e===this.paragraph.childWidgets.length-1},gh.prototype.getOffset=function(e,t){if(_.isNullOrUndefined(e))return t;for(var i=t,n=e.line,r=0;r<n.children.length;r++){var o=n.children[r];if(e===o)break;o instanceof Y||(i+=o.length)}return i},gh.prototype.getEndOffset=function(){for(var e=0,t=0,i=0;i<this.children.length;i++){var n=this.children[i];0===n.length||n instanceof Y||((n instanceof X||n instanceof up||n instanceof Wc||n instanceof Ic||n instanceof Sc||n instanceof J||n instanceof E||n instanceof Z&&j.isLinkedFieldCharacter(n))&&(e=t+n.length),t+=n.length)}return e},gh.prototype.getInline=function(e,t,i,n,r){i=_.isNullOrUndefined(i)?this.paragraph.bidi:i;var o=void 0,s=0,a=!1;if(0===this.children.length&&this.previousLine){i=this.previousLine.children[this.previousLine.children.length-1];if(i instanceof X&&"\v"===i.text)return{element:o=this.previousLine.children[this.previousLine.children.length-1],index:t=1}}for(var l,d=0;d<this.children.length;d++)if(!((o=this.children[d])instanceof Y)){if((a=!a&&(o instanceof X||o instanceof Ic||o instanceof uc||o instanceof E||o instanceof J||o instanceof Sc||o instanceof Wc||o instanceof up||o instanceof Z&&j.isLinkedFieldCharacter(o))?!0:a)&&e<=s+o.length)return o instanceof X&&" "===o.text&&0===o.revisions.length&&n&&!r?(l=this.getNextTextElement(this,d+1),{element:o=_.isNullOrUndefined(l)?o:l,index:t=_.isNullOrUndefined(l)?e-s:0}):e===s+o.length&&this.children[d+1]instanceof Bh?{element:this.children[d+1],index:t}:{element:o,index:t=e-s};s+=o.length}return{element:o,index:t=s<e?_.isNullOrUndefined(o)?e:o.length:t}},gh.prototype.isEndnoteLineWidget=function(){return!_.isNullOrUndefined(this.paragraph.containerWidget)&&this.paragraph.containerWidget.containerWidget instanceof q&&"Endnote"===this.paragraph.containerWidget.containerWidget.footNoteType},gh.prototype.getNextTextElement=function(e,t){return t<e.children.length-1&&e.children[t]?e.children[t]:null},gh.prototype.getHierarchicalIndex=function(e){return e=this.paragraph.childWidgets.indexOf(this)+";"+e,this.paragraph instanceof Qd?this.paragraph.getHierarchicalIndex(e):e},gh.prototype.clone=function(){for(var e=new gh(void 0),t=0;t<this.children.length;t++){var i=this.children[t].clone();e.children.push(i),i.line=e}return e.width=this.width,e.height=this.height,_.isNullOrUndefined(this.margin)||(e.margin=this.margin.clone()),e},gh.prototype.destroy=function(){if(!_.isNullOrUndefined(this.children)){for(var e=0;e<this.children.length;e++)this.children[e].destroy();this.children=[]}this.children=void 0,this.paragraph&&this.paragraph.removeChild(this.indexInOwner),this.paragraph=void 0,this.x=void 0,this.y=void 0,this.width=void 0},gh.prototype.componentDestroy=function(){if(!_.isNullOrUndefined(this.children)){for(var e=0;e<this.children.length;e++)this.children[e].componentDestroy();this.children=[]}this.children=void 0,this.paragraph=void 0,this.layoutedElements=[],this.layoutedElements=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0};var uh=gh;function gh(e){this.children=[],this.x=0,this.y=0,this.width=0,this.height=0,this.marginTop=0,this.maxBaseLine=0,this.skipClipImage=!1,this.paragraph=e}Object.defineProperty(fh.prototype,"isPageBreak",{get:function(){return this instanceof X&&"\f"===this.text},enumerable:!0,configurable:!0}),Object.defineProperty(fh.prototype,"isColumnBreak",{get:function(){return this instanceof X&&this.text===String.fromCharCode(14)},enumerable:!0,configurable:!0}),Object.defineProperty(fh.prototype,"isValidNodeForTracking",{get:function(){return!(this instanceof J||this instanceof up||this instanceof Wc||this instanceof Sc||this instanceof E)},enumerable:!0,configurable:!0}),Object.defineProperty(fh.prototype,"isCheckBoxElement",{get:function(){return this instanceof X&&!_.isNullOrUndefined(this.text)&&(this.text===String.fromCharCode(9745)||this.text===String.fromCharCode(9744))},enumerable:!0,configurable:!0}),fh.prototype.linkFieldCharacter=function(e){this instanceof Z&&(0===this.fieldType?_.isNullOrUndefined(this.fieldEnd)&&(this.linkFieldTraversingForward(this.line,this,this),-1===e.fields.indexOf(this)&&e.fields.push(this),_.isNullOrUndefined(this.formFieldData)||-1!==e.formFields.indexOf(this)||e.layout.isInsertFormField||e.formFields.push(this)):2===this.fieldType?(_.isNullOrUndefined((e=this).fieldBegin)&&this.linkFieldTraversingBackwardSeparator(this.line,e,e),_.isNullOrUndefined(e.fieldBegin)||(e.fieldBegin.fieldSeparator=e,_.isNullOrUndefined(e.fieldEnd)&&this.linkFieldTraversingForward(this.line,e.fieldBegin,e)&&(e.fieldEnd=e.fieldBegin.fieldEnd),e.fieldEnd&&(e.fieldEnd.fieldSeparator=e))):_.isNullOrUndefined(this.fieldBegin)&&this.linkFieldTraversingBackward(this.line,this,this))},fh.prototype.linkFieldTraversingBackward=function(e,t,i){for(var n=e.children.length-1,r=n=-1<e.children.indexOf(i)?e.children.indexOf(i)-1:n;0<=r;r--){var o=e.children[r];if(o instanceof Z)if(0===o.fieldType){if(_.isNullOrUndefined(o.fieldEnd))return t.fieldBegin=o,_.isNullOrUndefined(o.fieldEnd)&&(o.fieldEnd=t),t.fieldSeparator&&_.isNullOrUndefined(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=o,_.isNullOrUndefined(o.fieldSeparator))&&(o.fieldSeparator=t.fieldSeparator),!_.isNullOrUndefined(t.fieldBegin)}else 2===o.fieldType&&_.isNullOrUndefined(o.fieldEnd)&&((t.fieldSeparator=o).fieldEnd=t,_.isNullOrUndefined(o.fieldBegin)||(t.fieldBegin=o.fieldBegin))}return e.previousLine?this.linkFieldTraversingBackward(e.previousLine,t,this):e.paragraph.previousRenderedWidget instanceof G&&0<e.paragraph.previousRenderedWidget.childWidgets.length&&(i=e.paragraph.previousRenderedWidget,this.linkFieldTraversingBackward(i.childWidgets[i.childWidgets.length-1],t,this)),!0},fh.prototype.linkFieldTraversingForward=function(e,t,i){for(var n=0,r=n=-1<e.children.indexOf(i)?e.children.indexOf(i)+1:n;r<e.children.length;r++){var o=e.children[r];if(o instanceof Z){if(1===o.fieldType)return _.isNullOrUndefined(o.fieldBegin)&&(t.fieldEnd=o),t.fieldEnd&&_.isNullOrUndefined(t.fieldEnd.fieldBegin)&&(t.fieldEnd.fieldBegin=t),!0;if(_.isNullOrUndefined(t.fieldSeparator)){if(2!==o.fieldType||!_.isNullOrUndefined(o.fieldBegin))return!1;if(t.fieldSeparator=o,t.fieldSeparator&&_.isNullOrUndefined(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=t),!_.isNullOrUndefined(o.fieldEnd))return t.fieldEnd=o.fieldEnd,t.fieldSeparator.fieldEnd=t.fieldEnd,!0}}}return e.nextLine?this.linkFieldTraversingForward(e.nextLine,t,this):e.paragraph.nextRenderedWidget instanceof G&&0<e.paragraph.nextRenderedWidget.childWidgets.length?this.linkFieldTraversingForward(e.paragraph.nextRenderedWidget.childWidgets[0],t,this):e.paragraph.nextRenderedWidget instanceof K&&(i=(i=e.paragraph.nextRenderedWidget).getSplitWidgets().pop(),!_.isNullOrUndefined(i.nextRenderedWidget))&&i.nextRenderedWidget instanceof G&&0<i.nextRenderedWidget.childWidgets.length&&this.linkFieldTraversingForward(i.nextRenderedWidget.childWidgets[0],t,this),!0},fh.prototype.linkFieldTraversingBackwardSeparator=function(e,t,i){for(var n=e.children.length-1,r=n=-1<e.children.indexOf(i)?e.children.indexOf(i)-1:n;0<=r;r--){var o=e.children[r];if(o instanceof Z&&o instanceof Z&&0===o.fieldType)return _.isNullOrUndefined(o.fieldSeparator)&&(t.fieldBegin=o),!_.isNullOrUndefined(t.fieldBegin)}if(e.previousLine)this.linkFieldTraversingBackwardSeparator(e.previousLine,t,this);else{if(!(e.paragraph.previousRenderedWidget instanceof G&&0<e.paragraph.previousRenderedWidget.childWidgets.length))return!0;e=e.paragraph.previousRenderedWidget.childWidgets[e.paragraph.previousRenderedWidget.childWidgets.length-1],this.linkFieldTraversingBackwardSeparator(e,t,this)}return!0},Object.defineProperty(fh.prototype,"length",{get:function(){return this.getLength()},enumerable:!0,configurable:!0}),Object.defineProperty(fh.prototype,"indexInOwner",{get:function(){return this.line instanceof uh&&this.line.children?this.line.children.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(fh.prototype,"previousElement",{get:function(){var e=this.indexInOwner;if(0<e&&e<this.line.children.length)return this.line.children[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(fh.prototype,"nextElement",{get:function(){var e=this.indexInOwner;if(-1<e&&e<this.line.children.length-1)return this.line.children[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(fh.prototype,"nextNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);return e<this.line.children.length-1?this.line.children[e+1]:t<this.line.paragraph.childWidgets.length-1?this.line.paragraph.childWidgets[t+1].children[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(fh.prototype,"nextValidNodeForTracking",{get:function(){for(var e=this;!_.isNullOrUndefined(e)&&(e instanceof J||e instanceof up||e instanceof Wc||e instanceof Sc||e instanceof E);)e=e.nextNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(fh.prototype,"previousValidNodeForTracking",{get:function(){for(var e=this;!_.isNullOrUndefined(e)&&(e instanceof J||e instanceof up||e instanceof Wc||e instanceof Sc||e instanceof E);)e=e.previousNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(fh.prototype,"previousNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);return 0<e?this.line.children[e-1]:0<t?(e=this.line.paragraph.childWidgets[t-1]).children[e.children.length-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(fh.prototype,"paragraph",{get:function(){if(this.line)return this.line.paragraph},enumerable:!0,configurable:!0}),fh.prototype.destroy=function(){var e;!_.isNullOrUndefined(this.line)&&this.line.children&&-1<this.line.children.indexOf(this)&&(e=this.line.children.indexOf(this),this.line.children.splice(e,1)),this.line=void 0,this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},fh.prototype.componentDestroy=function(){this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.padding&&this.padding.destroy(),this.padding=void 0,this.contentControlProperties=void 0,this.line=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},fh.objectCharacter=String.fromCharCode(65532);var mh=fh;function fh(){this.x=0,this.y=0,this.width=0,this.height=0,this.isWidthUpdated=!1,this.margin=new Dd(0,0,0,0),this.padding=new Dd(0,0,0,0),this.characterFormat=void 0,this.isRightToLeft=!1,this.canTrigger=!1,this.ischangeDetected=!1,this.isVisible=!1,this.isSpellChecked=!1,this.revisions=[],this.canTrack=!1,this.removedIds=[],this.isMarkedForRevision=!1,this.skipformFieldLength=!1,this.characterRange=void 0,this.characterFormat=new B(this),this.margin=new Dd(0,0,0,0)}pl(vh,yh=mh),Object.defineProperty(vh.prototype,"fieldBegin",{get:function(){return this.fieldBeginInternal},set:function(e){this.fieldBeginInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(vh.prototype,"fieldSeparator",{get:function(){return this.fieldSeparatorInternal},set:function(e){this.fieldSeparatorInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(vh.prototype,"fieldEnd",{get:function(){return this.fieldEndInternal},set:function(e){this.fieldEndInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(vh.prototype,"resultText",{get:function(){if(!_.isNullOrUndefined(this.formFieldData)&&0===this.fieldType&&!_.isNullOrUndefined(this.fieldSeparator)&&!_.isNullOrUndefined(this.fieldEnd)){var e=this.fieldSeparator.nextElement,t="";do{if(e instanceof X&&(t+=e.text),(e=e.nextNode)===this.fieldEnd)break}while(e);return t}},enumerable:!0,configurable:!0}),vh.prototype.getLength=function(){return 1},vh.prototype.clone=function(){var e=new vh(this.fieldType);if(0!==this.fieldType||_.isNullOrUndefined(this.formFieldData)||(e.formFieldData=this.formFieldData.clone()),e.characterFormat.copyFormat(this.characterFormat),this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,!_.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(0<this.revisions.length)for(var t=0;t<this.revisions.length;t++){var i=this.revisions[t];e.revisions.push(i.clone())}}else 0<this.revisions.length?(e.removedIds=$a.cloneRevisions(this.revisions),this.fieldEnd&&(e.hasFieldEnd=this.hasFieldEnd)):(e.removedIds=this.removedIds.slice(),_.isNullOrUndefined(this.fieldEnd)||_.isNullOrUndefined(this.fieldEnd.paragraph)||this.fieldEnd.paragraph.containerWidget instanceof N||(e.hasFieldEnd=this.hasFieldEnd));return e.fieldCodeType=this.fieldCodeType,e},vh.prototype.destroy=function(){this.fieldType=void 0,this.hasFieldEnd=void 0,this.fieldBeginInternal=void 0,this.fieldEndInternal=void 0,this.fieldSeparatorInternal=void 0,yh.prototype.destroy.call(this)},vh.prototype.componentDestroy=function(){this.formFieldData&&this.formFieldData.destroy(),this.formFieldData=void 0,this.fieldCodeType=void 0,this.fieldBeginInternal=void 0,this.fieldEndInternal=void 0,this.fieldSeparatorInternal=void 0,yh.prototype.componentDestroy.call(this)};var yh,Z=vh;function vh(e){var t=yh.call(this)||this;return t.fieldType=0,t.fieldCodeType="",t.hasFieldEnd=!1,t.fieldBeginInternal=void 0,t.fieldSeparatorInternal=void 0,t.fieldEndInternal=void 0,t.fieldType=e,t}bh.prototype.destroy=function(){this.name=void 0,this.helpText=void 0,this.statusText=void 0};var wh=bh;function bh(){this.name="",this.enabled=!0,this.helpText="",this.statusText=""}pl(Ih,xh=wh),Ih.prototype.clone=function(){var e=new Ih;return e.type=this.type,e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.maxLength=this.maxLength,e.defaultValue=this.defaultValue,e.format=this.format,e},Ih.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,format:this.format,helpText:this.helpText,maxLength:this.maxLength,type:this.type,name:this.name}},Ih.prototype.copyFieldInfo=function(e){_.isNullOrUndefined(e.defaultValue)||(this.defaultValue=e.defaultValue),_.isNullOrUndefined(e.enabled)||(this.enabled=e.enabled),_.isNullOrUndefined(e.format)||(this.format=e.format),_.isNullOrUndefined(e.helpText)||(this.helpText=e.helpText),_.isNullOrUndefined(e.maxLength)||(this.maxLength=e.maxLength),_.isNullOrUndefined(e.type)||(this.type=e.type)},Ih.prototype.destroy=function(){this.format=void 0,this.defaultValue=void 0,xh.prototype.destroy.call(this)};var xh,Ch=Ih;function Ih(){var e=null!==xh&&xh.apply(this,arguments)||this;return e.type="Text",e.maxLength=0,e.defaultValue="",e.format="",e}pl(Ph,kh=wh),Ph.prototype.clone=function(){var e=new Ph;return e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.sizeType=this.sizeType,e.size=this.size,e.defaultValue=this.defaultValue,e.checked=this.checked,e},Ph.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,helpText:this.helpText,size:this.size,sizeType:this.sizeType,name:this.name}},Ph.prototype.copyFieldInfo=function(e){_.isNullOrUndefined(e.defaultValue)||(this.defaultValue=e.defaultValue,this.checked=e.defaultValue),_.isNullOrUndefined(e.enabled)||(this.enabled=e.enabled),_.isNullOrUndefined(e.size)||(this.size=e.size),_.isNullOrUndefined(e.helpText)||(this.helpText=e.helpText),_.isNullOrUndefined(e.sizeType)||(this.sizeType=e.sizeType)},Ph.prototype.destroy=function(){kh.prototype.destroy.call(this)};var kh,Fh=Ph;function Ph(){var e=null!==kh&&kh.apply(this,arguments)||this;return e.sizeType="Auto",e.size=11,e.defaultValue=!1,e.checked=!1,e}pl(Hh,Th=wh),Hh.prototype.clone=function(){var e=new Hh;return e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.dropdownItems=this.dropdownItems.slice(),e.selectedIndex=this.selectedIndex,e},Hh.prototype.getFormFieldInfo=function(){return{dropdownItems:this.dropdownItems.slice(),enabled:this.enabled,helpText:this.helpText,name:this.name}},Hh.prototype.copyFieldInfo=function(e){_.isNullOrUndefined(e.dropdownItems)||(this.dropdownItems=e.dropdownItems),_.isNullOrUndefined(e.enabled)||(this.enabled=e.enabled),_.isNullOrUndefined(e.helpText)||(this.helpText=e.helpText)},Hh.prototype.destroy=function(){this.dropdownItems=[],this.dropdownItems=void 0,Th.prototype.destroy.call(this)};var Th,Sh=Hh;function Hh(){var e=null!==Th&&Th.apply(this,arguments)||this;return e.dropdownItems=[],e.selectedIndex=0,e}pl(Wh,Nh=mh),Wh.prototype.getLength=function(){return this.text?this.text.length:0},Wh.prototype.clone=function(){var e=new Wh;if(e.characterFormat.copyFormat(this.characterFormat),e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.baselineOffset=this.baselineOffset,!_.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(0<this.revisions.length)for(var t=0;t<this.revisions.length;t++){var i=this.revisions[t];e.revisions.push(i.clone())}}else this.paragraph&&this.paragraph.isInsideTable&&this.paragraph.containerWidget instanceof N&&this.paragraph.containerWidget.ownerRow.rowFormat.isHeader?e.revisions=this.revisions:0<this.revisions.length?e.removedIds=$a.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.width=this.width,e.height=this.height,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},Wh.prototype.destroy=function(){this.text=void 0,Nh.prototype.destroy.call(this)},Wh.prototype.componentDestroy=function(){this.text=void 0,Nh.prototype.componentDestroy.call(this)};var Nh,X=Wh;function Wh(){var e=Nh.call(this)||this;return e.baselineOffset=0,e.text="",e.trimEndWidth=0,e.ignoreOnceItems=[],e.istextCombined=!1,e.scriptType=V.FontScriptType.English,e.renderedFontFamily=void 0,e.errorCollection=[],e}Eh.prototype.clear=function(){if(this.separator){for(var e=0;e<this.separator.length;e++)this.separator[e].destroy();this.separator=[]}if(this.continuationSeparator){for(e=0;e<this.continuationSeparator.length;e++)this.continuationSeparator[e].destroy();this.continuationSeparator=[]}if(this.continuationNotice){for(e=0;e<this.continuationNotice.length;e++)this.continuationNotice[e].destroy();this.continuationNotice=[]}},Eh.prototype.destroy=function(){this.separator=[],this.continuationSeparator=[],this.continuationNotice=[]},Eh.prototype.componentDestroy=function(){if(this.separator){for(var e=0;e<this.separator.length;e++)this.separator[e].componentDestroy();this.separator=[]}if(this.separator=void 0,this.continuationSeparator){for(e=0;e<this.continuationSeparator.length;e++)this.continuationSeparator[e].componentDestroy();this.continuationSeparator=[]}if(this.continuationSeparator=void 0,this.continuationNotice){for(e=0;e<this.continuationNotice.length;e++)this.continuationNotice[e].componentDestroy();this.continuationNotice=[]}this.continuationNotice=void 0};var Oh=Eh;function Eh(){this.separator=[],this.continuationNotice=[],this.continuationSeparator=[]}pl(Rh,Lh=X),Rh.prototype.clone=function(){var e=new Rh;e.text=this.text,e.characterFormat.copyFormat(this.characterFormat),e.height=this.height,e.footnoteType=this.footnoteType,e.width=this.width,e.symbolCode=this.symbolCode;for(var t=0;t<this.bodyWidget.childWidgets.length;t++){var i=this.bodyWidget.childWidgets[t];(i instanceof G||i instanceof K)&&(i=this.bodyWidget.childWidgets[t].clone()),e.bodyWidget.childWidgets.push(i)}if(e.bodyWidget.page=this.bodyWidget.page,!_.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(0<this.revisions.length)for(t=0;t<this.revisions.length;t++){var n=this.revisions[t];e.revisions.push(n.clone())}}else 0<this.revisions.length?e.removedIds=$a.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return this.margin&&(e.margin=this.margin.clone()),e},Rh.prototype.getLength=function(){return 1},Rh.prototype.destroy=function(){this.symbolCode="",this.symbolFontName="",this.customMarker=""},Rh.prototype.componentDestroy=function(){this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.symbolCode="",this.symbolFontName="",this.customMarker="",this.bodyWidget&&this.bodyWidget.componentDestroy(),this.bodyWidget=void 0,Lh.prototype.componentDestroy.call(this)};var Lh,Bh=Rh;function Rh(){var e=Lh.call(this)||this;return e.isLayout=!1,e.bodyWidget=new z,e.bodyWidget.footNoteReference=e}pl(Dh,Mh=X),Object.defineProperty(Dh.prototype,"start",{get:function(){return this.startIn},set:function(e){this.startIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Dh.prototype,"end",{get:function(){return this.endIn},set:function(e){this.endIn=e},enumerable:!0,configurable:!0}),Dh.prototype.destroy=function(){this.start=void 0,this.end=void 0},Dh.prototype.componentDestroy=function(){this.startIn&&this.startIn.destroy(),this.startIn=void 0,this.endIn&&this.endIn.destroy(),this.endIn=void 0,Mh.prototype.componentDestroy.call(this)};var Mh,Ah=Dh;function Dh(){var e=Mh.call(this)||this;return e.startIn=void 0,e.endIn=void 0,e}pl(zh,Uh=X),Object.defineProperty(zh.prototype,"text",{get:function(){return this.fieldText},set:function(e){this.fieldText=e},enumerable:!0,configurable:!0}),zh.prototype.clone=function(){var e=new zh;if(e.characterFormat.copyFormat(this.characterFormat),e.fieldBegin=this.fieldBegin,e.text=this.text,this.margin&&(e.margin=this.margin.clone()),!_.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(0<this.revisions.length)for(var t=0;t<this.revisions.length;t++){var i=this.revisions[t];e.revisions.push(i.clone())}}else 0<this.revisions.length?e.removedIds=$a.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.width=this.width,e.height=this.height,e},zh.prototype.componentDestroy=function(){this.fieldText=void 0,this.fieldBegin=void 0,Uh.prototype.componentDestroy.call(this)};var Uh,Vh=zh;function zh(){var e=Uh.call(this)||this;return e.fieldText="",e}pl(jh,qh=X),jh.prototype.destroy=function(){this.tabText=void 0,this.tabLeader=void 0},jh.prototype.componentDestroy=function(){this.tabText=void 0,this.tabLeader=void 0,qh.prototype.componentDestroy.call(this)},jh.prototype.clone=function(){var e=new jh;if(e.characterFormat.copyFormat(this.characterFormat),e.tabText=this.tabText,e.tabLeader=this.tabLeader,e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,!_.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(0<this.revisions.length)for(var t=0;t<this.revisions.length;t++){var i=this.revisions[t];e.revisions.push(i.clone())}}else 0<this.revisions.length?e.removedIds=$a.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e};var qh,_h=jh;function jh(){var e=qh.call(this)||this;return e.tabText="",e.tabLeader="None",e}pl(Kh,Gh=mh),Object.defineProperty(Kh.prototype,"bookmarkType",{get:function(){return this.bookmarkTypeIn},enumerable:!0,configurable:!0}),Object.defineProperty(Kh.prototype,"properties",{get:function(){return this.propertiesIn},set:function(e){this.propertiesIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Kh.prototype,"name",{get:function(){return this.nameIn},set:function(e){this.nameIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Kh.prototype,"reference",{get:function(){return this.refereneceIn},set:function(e){this.refereneceIn=e},enumerable:!0,configurable:!0}),Kh.prototype.getLength=function(){return 1},Kh.prototype.destroy=function(){this.name=void 0,this.reference=void 0,this.bookmarkTypeIn=void 0},Kh.prototype.componentDestroy=function(){this.name=void 0,this.reference=void 0,this.bookmarkTypeIn=void 0,Gh.prototype.componentDestroy.call(this)},Kh.prototype.clone=function(){var e=new Kh(this.bookmarkType);return e.name=this.name,e.reference=this.reference,e.properties=this.properties,this.margin&&(e.margin=this.margin.clone()),0<this.revisions.length?e.removedIds=$a.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice(),e.width=this.width,e.height=this.height,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e};var Gh,J=Kh;function Kh(e){var t=Gh.call(this)||this;return t.bookmarkTypeIn=0,t.refereneceIn=void 0,t.nameIn="",t.bookmarkTypeIn=e,t}pl(Xh,Zh=mh),Xh.prototype.getLength=function(){return 1},Xh.prototype.clone=function(){var e=new Xh(this.contentControlWidgetType);if(e.characterFormat.copyFormat(this.characterFormat),e.contentControlProperties=this.contentControlProperties,e.contentControlWidgetType=this.contentControlWidgetType,this.margin&&(e.margin=this.margin.clone()),!_.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(0<this.revisions.length)for(var t=0;t<this.revisions.length;t++){var i=this.revisions[t];e.revisions.push(i.clone())}}else 0<this.revisions.length?e.removedIds=$a.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.type=this.type,e.width=this.width,e.height=this.height,e.reference=this.reference,e},Xh.prototype.destroy=function(){this.contentControlProperties=void 0,this.contentControlWidgetType=void 0,Zh.prototype.destroy.call(this)},Xh.prototype.componentDestroy=function(){this.contentControlProperties&&(this.contentControlProperties.destroy(),this.contentControlProperties=void 0),this.contentControlWidgetType=void 0,Zh.prototype.componentDestroy.call(this)};var Zh,E=Xh;function Xh(e){var t=Zh.call(this)||this;return t.contentControlWidgetType=e,t.contentControlProperties=new Jh(e),t}Yh.prototype.destroy=function(){this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.xmlMapping&&(this.xmlMapping.destroy(),this.xmlMapping=void 0),this.lockContentControl=void 0,this.lockContents=void 0,this.tag=void 0,this.color=void 0,this.title=void 0,this.appearance=void 0,this.type=void 0,this.hasPlaceHolderText=void 0,this.multiline=void 0,this.isTemporary=void 0,this.isChecked=void 0,this.dateCalendarType=void 0,this.dateStorageFormat=void 0,this.dateDisplayLocale=void 0,this.dateDisplayFormat=void 0},Yh.prototype.clone=function(){var e=new Yh(this.contentControlWidgetType);if(e.lockContentControl=this.lockContentControl,e.lockContents=this.lockContents,e.tag=this.tag,e.color=this.color,e.title=this.title,e.appearance=this.appearance,e.type=this.type,e.hasPlaceHolderText=this.hasPlaceHolderText,e.multiline=this.multiline,e.isTemporary=this.isTemporary,e.isChecked=this.isChecked,e.dateCalendarType=this.dateCalendarType,e.dateStorageFormat=this.dateStorageFormat,e.dateDisplayLocale=this.dateDisplayLocale,e.dateDisplayFormat=this.dateDisplayFormat,0<this.contentControlListItems.length)for(var t=0;t<this.contentControlListItems.length;t++)e.contentControlListItems.push(this.contentControlListItems[t].clone());return this.checkedState&&(e.checkedState=this.checkedState.clone()),this.uncheckedState&&(e.uncheckedState=this.uncheckedState.clone()),this.xmlMapping&&(e.xmlMapping=this.xmlMapping.clone()),e};var Jh=Yh;function Yh(e){this.contentControlListItems=[],this.contentControlWidgetType=e,this.characterFormat=new B}$h.prototype.destroy=function(){this.displayText=void 0,this.value=void 0},$h.prototype.clone=function(){var e=new $h;return e.displayText=this.displayText,e.value=this.value,e};var Qh=$h;function $h(){}tc.prototype.destroy=function(){this.font=void 0,this.value=void 0},tc.prototype.clone=function(){var e=new tc;return e.font=this.font,e.value=this.value,e};var ec=tc;function tc(){}nc.prototype.destroy=function(){this.isMapped=void 0,this.isWordMl=void 0,this.prefixMapping=void 0,this.xPath=void 0,this.storeItemId=void 0,this.customXmlPart=void 0},nc.prototype.clone=function(){var e=new nc;return e.isMapped=this.isMapped,e.isWordMl=this.isWordMl,e.prefixMapping=this.prefixMapping,e.xPath=this.xPath,e.storeItemId=this.storeItemId,this.customXmlPart&&(e.customXmlPart=this.customXmlPart.clone()),e};var ic=nc;function nc(){}oc.prototype.destroy=function(){this.id=void 0,this.xml=void 0},oc.prototype.clone=function(){var e=new oc;return e.id=this.id,e.xml=this.xml,e};var rc=oc;function oc(){}pl(lc,sc=mh),lc.prototype.getLength=function(){return 1},lc.prototype.clone=function(){return new uc};var sc,ac=lc;function lc(){var e=null!==sc&&sc.apply(this,arguments)||this;return e.name="",e.alternateText="",e.title="",e}pl(cc,dc=ac);var dc,hc=cc;function cc(){var e=null!==dc&&dc.apply(this,arguments)||this;return e.verticalPosition=0,e.horizontalPosition=0,e.textWrappingStyle="Inline",e.distanceBottom=0,e.distanceLeft=0,e.distanceRight=0,e.distanceTop=0,e}pl(gc,pc=hc),gc.prototype.clone=function(){var e=new gc;if(e.characterFormat.copyFormat(this.characterFormat),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.shapeId=this.shapeId,e.name=this.name,e.alternateText=this.alternateText,e.title=this.title,e.widthScale=this.widthScale,e.heightScale=this.heightScale,e.visible=this.visible,e.verticalPosition=this.verticalPosition,e.verticalAlignment=this.verticalAlignment,e.verticalOrigin=this.verticalOrigin,e.verticalRelativePercent=this.verticalRelativePercent,e.horizontalPosition=this.horizontalPosition,e.horizontalAlignment=this.horizontalAlignment,e.horizontalOrigin=this.horizontalOrigin,e.horizontalRelativePercent=this.horizontalRelativePercent,e.heightRelativePercent=this.heightRelativePercent,e.widthRelativePercent=this.widthRelativePercent,e.zOrderPosition=this.zOrderPosition,e.allowOverlap=this.allowOverlap,e.textWrappingStyle=this.textWrappingStyle,e.textWrappingType=this.textWrappingType,e.distanceBottom=this.distanceBottom,e.distanceLeft=this.distanceLeft,e.distanceRight=this.distanceRight,e.distanceTop=this.distanceTop,e.editingPoints=this.editingPoints,e.layoutInCell=this.layoutInCell,e.lockAnchor=this.lockAnchor,e.autoShapeType=this.autoShapeType,this.lineFormat&&(e.lineFormat=this.lineFormat.clone()),this.fillFormat&&(e.fillFormat=this.fillFormat.clone()),this.textFrame&&(e.textFrame=this.textFrame.clone(),e.textFrame.containerShape=e),this.margin&&(e.margin=this.margin.clone()),!_.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(0<this.revisions.length)for(var t=0;t<this.revisions.length;t++){var i=this.revisions[t];e.revisions.push(i.clone())}}else 0<this.revisions.length?e.removedIds=$a.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e};var pc,uc=gc;function gc(){return null!==pc&&pc.apply(this,arguments)||this}pl(yc,mc=Vd),yc.prototype.equals=function(){return!1},yc.prototype.destroyInternal=function(){},yc.prototype.getHierarchicalIndex=function(e){var t=this.containerShape.line,i=t.getOffset(this.containerShape,0).toString();return t.getHierarchicalIndex(i)},yc.prototype.getTableCellWidget=function(){},yc.prototype.clone=function(){var e=new yc;e.textVerticalAlignment=this.textVerticalAlignment,e.marginBottom=this.marginBottom,e.marginLeft=this.marginLeft,e.marginRight=this.marginRight,e.marginTop=this.marginTop;for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t].clone();e.childWidgets.push(i),i.index=t,i.containerWidget=e}return e};var mc,fc=yc;function yc(){var e=null!==mc&&mc.apply(this,arguments)||this;return e.marginLeft=0,e.marginRight=0,e.marginTop=0,e.marginBottom=0,e}wc.prototype.clone=function(){var e=new wc;return e.lineFormatType=this.lineFormatType,e.color=this.color,e.weight=this.weight,e.dashStyle=this.dashStyle,e.line=this.line,e};var vc=wc;function wc(){}xc.prototype.clone=function(){var e=new xc;return e.color=this.color,e.fill=this.fill,e};var bc=xc;function xc(){}pl(kc,Cc=hc),Object.defineProperty(kc.prototype,"isCrop",{get:function(){return this.crop},set:function(e){var t;(this.crop=e)&&((t=e=0)!==this.left?this.cropX=this.left*this.cropWidthScale/100:this.cropX=0,0!==this.top?this.cropY=this.top*this.cropHeightScale/100:this.cropY=0,0!==this.right&&(e=this.right*this.cropWidthScale/100),0!==this.bottom&&(t=this.bottom*this.cropHeightScale/100),this.cropWidth=this.cropWidthScale-(this.cropX+e),this.cropHeight=this.cropHeightScale-(this.cropY+t))},enumerable:!0,configurable:!0}),Object.defineProperty(kc.prototype,"isInlineImage",{get:function(){return this.isInlineImageIn},enumerable:!0,configurable:!0}),Object.defineProperty(kc.prototype,"element",{get:function(){return _.isNullOrUndefined(this.imgElement)&&(this.imgElement=document.createElement("img")),this.imgElement},enumerable:!0,configurable:!0}),Object.defineProperty(kc.prototype,"length",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(kc.prototype,"imageString",{get:function(){return this.imageStr},set:function(e){this.imageStr=e},enumerable:!0,configurable:!0}),kc.prototype.getLength=function(){return 1},kc.prototype.clone=function(){var e=new kc(this.isInlineImage);if(e.characterFormat.copyFormat(this.characterFormat),e.imageString=this.imageString,e.element.src=this.element.src,e.isMetaFile=this.isMetaFile,e.isCompressed=this.isCompressed,e.metaFileImageString=this.metaFileImageString,e.width=this.width,e.height=this.height,e.top=this.top,e.left=this.left,e.bottom=this.bottom,e.right=this.right,e.cropHeightScale=this.cropHeightScale,e.cropWidthScale=this.cropWidthScale,e.cropX=this.cropX,e.cropY=this.cropY,e.isCrop=this.isCrop,e.x=this.x,e.y=this.y,this.margin&&(e.margin=this.margin.clone()),!_.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(0<this.revisions.length)for(var t=0;t<this.revisions.length;t++){var i=this.revisions[t];e.revisions.push(i.clone())}}else 0<this.revisions.length?e.removedIds=$a.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.name=this.name,e.alternateText=this.alternateText,e.title=this.title,e.visible=this.visible,e.widthScale=this.widthScale,e.heightScale=this.heightScale,e.verticalPosition=this.verticalPosition,e.verticalOrigin=this.verticalOrigin,e.verticalAlignment=this.verticalAlignment,e.horizontalPosition=this.horizontalPosition,e.horizontalOrigin=this.horizontalOrigin,e.horizontalAlignment=this.horizontalAlignment,e.allowOverlap=this.allowOverlap,e.textWrappingStyle=this.textWrappingStyle,e.textWrappingType=this.textWrappingType,e.layoutInCell=this.layoutInCell,e.zOrderPosition=this.zOrderPosition,e},kc.prototype.destroy=function(){this.imgElement=void 0,this.imageString=void 0,this.isInlineImageIn=void 0,Cc.prototype.destroy.call(this)};var Cc,Ic=kc;function kc(e){var t=Cc.call(this)||this;return t.imageStr="",t.imgElement=void 0,t.isInlineImageIn=!0,t.crop=!1,t.left=0,t.top=0,t.right=0,t.bottom=0,t.isMetaFile=!1,t.isCompressed=!1,t.isInlineImageIn=e,t}pl(Pc,Fc=mh),Pc.prototype.getLength=function(){return this.text?this.text.length:0},Pc.prototype.clone=function(){var e=new Pc(this.listLevel,this.isFollowCharacter);return e.text=this.text,e.baselineOffset=this.baselineOffset,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,e},Pc.prototype.destroy=function(){this.text=void 0,Fc.prototype.destroy.call(this)};var Fc,Y=Pc;function Pc(e,t){var i=Fc.call(this)||this;return i.baselineOffset=0,i.trimEndWidth=0,i.isFollowCharacter=!1,i.listLevel=e,i.isFollowCharacter=t,i}pl(Hc,Tc=mh),Hc.prototype.getLength=function(){return 1},Hc.prototype.destroy=function(){this.editRangeStart=void 0},Hc.prototype.clone=function(){var e=new Hc;return e.editRangeStart=this.editRangeStart,e.editRangeId=this.editRangeId,e};var Tc,Sc=Hc;function Hc(){var e=Tc.call(this)||this;return e.editRangeStart=void 0,e.editRangeId=-1,e}pl(Oc,Nc=mh),Oc.prototype.getLength=function(){return 1},Oc.prototype.renderLockMark=function(e,t){var i;_.isNullOrUndefined(this.editRangeMark)&&(e=e===this.user?"you":this.user,this.editRangeMark=document.createElement("div"),this.editRangeMark.style.display="none",this.editRangeMark.classList.add("e-de-lock-mark"),(i=document.createElement("span")).className="e-icons e-de-ctnr-lock",this.editRangeMark.appendChild(i),this.editRangeMark.title=t.getConstant("This region is locked by")+" "+e),this.line&&_.isNullOrUndefined(this.editRangeMark.parentElement)&&this.line.paragraph.bodyWidget.page.documentHelper.pageContainer.appendChild(this.editRangeMark)},Oc.prototype.removeEditRangeMark=function(){this.editRangeMark&&(this.editRangeMark.parentElement.removeChild(this.editRangeMark),this.editRangeMark=void 0)},Oc.prototype.destroy=function(){this.user=void 0,this.columnFirst=void 0,this.columnLast=void 0},Oc.prototype.clone=function(){var e=new Oc;return e.columnFirst=this.columnFirst,e.columnLast=this.columnLast,e.user=this.user,e.group=this.group,e.editRangeEnd=this.editRangeEnd,e.editRangeId=this.editRangeId,e};var Nc,Wc=Oc;function Oc(){var e=Nc.call(this)||this;return e.columnFirst=-1,e.columnLast=-1,e.user="",e.group="",e.editRangeId=-1,e}pl(Bc,Ec=Ic),Bc.prototype.getLength=function(){return 1},Object.defineProperty(Bc.prototype,"title",{get:function(){return this.chartTitle},set:function(e){this.chartTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"type",{get:function(){return this.chartType},set:function(e){this.chartType=e},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"chartGapWidth",{get:function(){return this.gapWidth},set:function(e){this.gapWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"chartOverlap",{get:function(){return this.overlap},set:function(e){this.overlap=e},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"targetElement",{get:function(){return _.isNullOrUndefined(this.div)&&(this.div=_.createElement("div")),this.div},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"officeChart",{get:function(){return this.officeChartInternal},set:function(e){e&&(this.officeChartInternal=e,this.officeChartInternal.chart.loaded=this.onChartLoaded.bind(this))},enumerable:!0,configurable:!0}),Bc.prototype.onChartLoaded=function(){var t=this;this.officeChart.convertChartToImage(this.officeChart.chart,this.width,this.height).then(function(e){t.imageString=e,t.element.src=e})},Bc.prototype.clone=function(){var e=new Bc;e.chartTitle=this.chartTitle,e.chartType=this.chartType,e.height=this.height,e.width=this.width,e.gapWidth=this.gapWidth,e.overlap=this.overlap;for(var t=0;t<this.chartCategory.length;t++){var i=this.chartCategory[t].clone();e.chartCategory.push(i)}for(t=0;t<this.chartSeries.length;t++){var n=this.chartSeries[t].clone();e.chartSeries.push(n)}return e.chartArea=this.chartArea.clone(),e.chartPlotArea=this.chartPlotArea.clone(),e.chartLegend=this.chartLegend.clone(),e.chartTitleArea=this.chartTitleArea.clone(),e.chartPrimaryCategoryAxis=this.chartPrimaryCategoryAxis.clone(),e.chartPrimaryValueAxis=this.chartPrimaryValueAxis.clone(),e.chartDataTable=this.chartDataTable.clone(),e},Bc.prototype.destroy=function(){Ec.prototype.destroy.call(this),this.officeChartInternal&&(this.officeChartInternal.chart.loaded=void 0,this.officeChartInternal.destroy(),this.officeChartInternal=void 0),this.div&&(this.div=void 0),this.chartTitle=void 0,this.chartType=void 0,this.chartArea=void 0,this.chartPlotArea=void 0,this.chartCategory=[],this.chartSeries=[],this.chartTitleArea=void 0,this.chartLegend=void 0,this.chartPrimaryCategoryAxis=void 0,this.chartPrimaryValueAxis=void 0,this.chartDataTable=void 0,this.chartElement=void 0};var Ec,Lc=Bc;function Bc(){var e=Ec.call(this)||this;return e.chartTitle="",e.chartType="",e.chartElement=void 0,e.chartCategory=[],e.chartSeries=[],e.chartArea=new Rc,e.chartPlotArea=new Rc,e.chartTitleArea=new ep,e.chartLegend=new zc,e.chartPrimaryCategoryAxis=new lp,e.chartPrimaryValueAxis=new lp,e.chartDataTable=new hp,e}Object.defineProperty(Mc.prototype,"chartForeColor",{get:function(){return this.foreColor},set:function(e){this.foreColor=e},enumerable:!0,configurable:!0}),Mc.prototype.clone=function(){var e=new Mc;return e.foreColor=this.foreColor,e},Mc.prototype.destroy=function(){this.foreColor=void 0};var Rc=Mc;function Mc(){}Object.defineProperty(Dc.prototype,"xName",{get:function(){return this.categoryXName},set:function(e){this.categoryXName=e},enumerable:!0,configurable:!0}),Dc.prototype.clone=function(){var e=new Dc;e.categoryXName=this.categoryXName;for(var t=0;t<this.chartData.length;t++){var i=this.chartData[t].clone();e.chartData.push(i)}return e},Dc.prototype.destroy=function(){this.categoryXName=void 0,this.chartData=[]};var Ac=Dc;function Dc(){this.categoryXName="",this.chartData=[]}Object.defineProperty(Vc.prototype,"yAxisValue",{get:function(){return this.yValue},set:function(e){this.yValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(Vc.prototype,"xAxisValue",{get:function(){return this.xValue},set:function(e){this.xValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(Vc.prototype,"bubbleSize",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),Vc.prototype.clone=function(){var e=new Vc;return e.yValue=this.yValue,e.xValue=this.xValue,e.size=this.size,e},Vc.prototype.destroy=function(){this.xValue=void 0,this.yValue=void 0,this.size=void 0};var Uc=Vc;function Vc(){}Object.defineProperty(qc.prototype,"chartLegendPostion",{get:function(){return this.legendPostion},set:function(e){this.legendPostion=e},enumerable:!0,configurable:!0}),qc.prototype.clone=function(){var e=new qc;return e.legendPostion=this.legendPostion,e.chartTitleArea=this.chartTitleArea.clone(),e},qc.prototype.destroy=function(){this.legendPostion=void 0,this.chartTitleArea=void 0};var zc=qc;function qc(){this.chartTitleArea=new ep}Object.defineProperty(jc.prototype,"seriesName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(jc.prototype,"firstSliceAngle",{get:function(){return this.sliceAngle},set:function(e){this.sliceAngle=e},enumerable:!0,configurable:!0}),Object.defineProperty(jc.prototype,"doughnutHoleSize",{get:function(){return this.holeSize},set:function(e){this.holeSize=e},enumerable:!0,configurable:!0}),jc.prototype.clone=function(){var e=new jc;e.name=this.name,e.sliceAngle=this.sliceAngle,e.holeSize=this.holeSize,e.errorBar=this.errorBar.clone(),e.dataLabels=this.dataLabels.clone(),e.seriesFormat=this.seriesFormat.clone();for(var t=0;t<this.chartDataFormat.length;t++){var i=this.chartDataFormat[t].clone();e.chartDataFormat.push(i)}for(t=0;t<this.trendLines.length;t++){var n=this.trendLines[t].clone();e.trendLines.push(n)}return e},jc.prototype.destroy=function(){this.name=void 0,this.errorBar=void 0,this.trendLines=void 0,this.chartDataFormat=[]};var _c=jc;function jc(){this.chartDataFormat=[],this.trendLines=[],this.errorBar=new Gc,this.dataLabels=new Jc,this.seriesFormat=new Zc}Object.defineProperty(Kc.prototype,"errorType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty(Kc.prototype,"errorDirection",{get:function(){return this.direction},set:function(e){this.direction=e},enumerable:!0,configurable:!0}),Object.defineProperty(Kc.prototype,"errorEndStyle",{get:function(){return this.endStyle},set:function(e){this.endStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(Kc.prototype,"numberValue",{get:function(){return this.errorValue},set:function(e){this.errorValue=e},enumerable:!0,configurable:!0}),Kc.prototype.clone=function(){var e=new Kc;return e.type=this.type,e.errorDirection=this.errorDirection,e.endStyle=this.endStyle,e.errorValue=this.errorValue,e},Kc.prototype.destroy=function(){this.type=void 0,this.errorDirection=void 0,this.endStyle=void 0};var Gc=Kc;function Kc(){}Object.defineProperty(Xc.prototype,"markerStyle",{get:function(){return this.style},set:function(e){this.style=e},enumerable:!0,configurable:!0}),Object.defineProperty(Xc.prototype,"markerColor",{get:function(){return this.color},set:function(e){this.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(Xc.prototype,"numberValue",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),Xc.prototype.clone=function(){var e=new Xc;return e.style=this.style,e.color=this.color,e.size=this.size,e},Xc.prototype.destroy=function(){this.style=void 0,this.color=void 0,this.size=void 0};var Zc=Xc;function Xc(){}Object.defineProperty(Yc.prototype,"labelPosition",{get:function(){return this.position},set:function(e){this.position=e},enumerable:!0,configurable:!0}),Object.defineProperty(Yc.prototype,"fontName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(Yc.prototype,"fontColor",{get:function(){return this.color},set:function(e){this.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(Yc.prototype,"fontSize",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),Object.defineProperty(Yc.prototype,"isLegendKey",{get:function(){return this.isLegend},set:function(e){this.isLegend=e},enumerable:!0,configurable:!0}),Object.defineProperty(Yc.prototype,"isBubbleSize",{get:function(){return this.isBubble},set:function(e){this.isBubble=e},enumerable:!0,configurable:!0}),Object.defineProperty(Yc.prototype,"isCategoryName",{get:function(){return this.isCategory},set:function(e){this.isCategory=e},enumerable:!0,configurable:!0}),Object.defineProperty(Yc.prototype,"isSeriesName",{get:function(){return this.isSeries},set:function(e){this.isSeries=e},enumerable:!0,configurable:!0}),Object.defineProperty(Yc.prototype,"isValue",{get:function(){return this.isValueEnabled},set:function(e){this.isValueEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(Yc.prototype,"isPercentage",{get:function(){return this.isPercentageEnabled},set:function(e){this.isPercentageEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(Yc.prototype,"isLeaderLines",{get:function(){return this.showLeaderLines},set:function(e){this.showLeaderLines=e},enumerable:!0,configurable:!0}),Yc.prototype.clone=function(){var e=new Yc;return e.position=this.position,e.name=this.name,e.color=this.color,e.size=this.size,e.isBubble=this.isBubble,e.isLegend=this.isLegend,e.isCategory=this.isCategory,e.isSeries=this.isSeries,e.isValueEnabled=this.isValueEnabled,e.isPercentageEnabled=this.isPercentageEnabled,e.showLeaderLines=this.showLeaderLines,e},Yc.prototype.destroy=function(){this.position=void 0};var Jc=Yc;function Yc(){}Object.defineProperty($c.prototype,"trendLineType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty($c.prototype,"trendLineName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty($c.prototype,"interceptValue",{get:function(){return this.intercept},set:function(e){this.intercept=e},enumerable:!0,configurable:!0}),Object.defineProperty($c.prototype,"forwardValue",{get:function(){return this.forward},set:function(e){this.forward=e},enumerable:!0,configurable:!0}),Object.defineProperty($c.prototype,"backwardValue",{get:function(){return this.backward},set:function(e){this.backward=e},enumerable:!0,configurable:!0}),Object.defineProperty($c.prototype,"isDisplayRSquared",{get:function(){return this.displayRSquared},set:function(e){this.displayRSquared=e},enumerable:!0,configurable:!0}),Object.defineProperty($c.prototype,"isDisplayEquation",{get:function(){return this.displayEquation},set:function(e){this.displayEquation=e},enumerable:!0,configurable:!0}),$c.prototype.clone=function(){var e=new $c;return e.type=this.type,e.name=this.name,e.forward=this.forward,e.backward=this.backward,e.intercept=this.intercept,e.displayEquation=this.displayEquation,e.displayRSquared=this.displayRSquared,e},$c.prototype.destroy=function(){this.type=void 0,this.name=void 0,this.forward=void 0,this.backward=void 0};var Qc=$c;function $c(){}Object.defineProperty(tp.prototype,"chartfontName",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),Object.defineProperty(tp.prototype,"chartFontSize",{get:function(){return this.fontSize},set:function(e){this.fontSize=e},enumerable:!0,configurable:!0}),tp.prototype.clone=function(){var e=new tp;return e.fontName=this.fontName,e.fontSize=this.fontSize,e.dataFormat=this.dataFormat.clone(),e.layout=this.layout.clone(),e},tp.prototype.destroy=function(){this.fontName=void 0,this.fontSize=void 0,this.dataFormat=void 0,this.layout=void 0};var ep=tp;function tp(){this.dataFormat=new ip,this.layout=new sp}np.prototype.clone=function(){var e=new np;return e.fill=this.fill.clone(),e.line=this.line.clone(),e},np.prototype.destroy=function(){this.fill=void 0,this.line=void 0};var ip=np;function np(){this.fill=new rp,this.line=new rp}Object.defineProperty(op.prototype,"color",{get:function(){return this.fillColor},set:function(e){this.fillColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(op.prototype,"rgb",{get:function(){return this.fillRGB},set:function(e){this.fillRGB=e},enumerable:!0,configurable:!0}),op.prototype.clone=function(){var e=new op;return e.fillColor=this.fillColor,e.fillRGB=this.fillRGB,e},op.prototype.destroy=function(){this.fillColor=void 0,this.fillRGB=void 0};var rp=op;function op(){}Object.defineProperty(ap.prototype,"chartLayoutLeft",{get:function(){return this.layoutX},set:function(e){this.layoutX=e},enumerable:!0,configurable:!0}),Object.defineProperty(ap.prototype,"chartLayoutTop",{get:function(){return this.layoutY},set:function(e){this.layoutY=e},enumerable:!0,configurable:!0}),ap.prototype.clone=function(){var e=new ap;return e.layoutX=this.layoutX,e.layoutY=this.layoutY,e},ap.prototype.destroy=function(){this.layoutX=void 0,this.layoutY=void 0};var sp=ap;function ap(){}Object.defineProperty(dp.prototype,"majorTick",{get:function(){return this.majorTickMark},set:function(e){this.majorTickMark=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"minorTick",{get:function(){return this.minorTickMark},set:function(e){this.minorTickMark=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"tickPosition",{get:function(){return this.tickLabelPostion},set:function(e){this.tickLabelPostion=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"minorGridLines",{get:function(){return this.hasMinorGridLines},set:function(e){this.hasMinorGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"majorGridLines",{get:function(){return this.hasMajorGridLines},set:function(e){this.hasMajorGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"interval",{get:function(){return this.majorUnit},set:function(e){this.majorUnit=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"isAutoInternal",{get:function(){return this.isAutoMajor},set:function(e){this.isAutoMajor=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"max",{get:function(){return this.maximumValue},set:function(e){this.maximumValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"min",{get:function(){return this.minimumValue},set:function(e){this.minimumValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"categoryAxisTitle",{get:function(){return this.title},set:function(e){this.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"categoryAxisType",{get:function(){return this.categoryType},set:function(e){this.categoryType=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"categoryNumberFormat",{get:function(){return this.numberFormat},set:function(e){this.numberFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"axisFontSize",{get:function(){return this.fontSize},set:function(e){this.fontSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(dp.prototype,"axisFontName",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),dp.prototype.clone=function(){var e=new dp;return e.title=this.title,e.categoryType=this.categoryType,e.numberFormat=this.numberFormat,e.fontSize=this.fontSize,e.fontName=this.fontName,e.hasMajorGridLines=this.hasMajorGridLines,e.hasMinorGridLines=this.hasMinorGridLines,e.minimumValue=this.minimumValue,e.maximumValue=this.maximumValue,e.majorUnit=this.majorUnit,e.isAutoMajor=this.isAutoMajor,e.majorTickMark=this.majorTickMark,e.minorTickMark=this.minorTickMark,e.tickLabelPostion=this.tickLabelPostion,e.chartTitleArea=this.chartTitleArea.clone(),e},dp.prototype.destroy=function(){this.title=void 0,this.categoryType=void 0,this.numberFormat=void 0,this.chartTitleArea=void 0,this.minimumValue=void 0,this.maximumValue=void 0,this.fontSize=void 0,this.fontName=void 0,this.majorUnit=void 0,this.majorTickMark=void 0,this.minorTickMark=void 0,this.tickLabelPostion=void 0};var lp=dp;function dp(){this.chartTitleArea=new ep}Object.defineProperty(cp.prototype,"showSeriesKeys",{get:function(){return this.isSeriesKeys},set:function(e){this.isSeriesKeys=e},enumerable:!0,configurable:!0}),Object.defineProperty(cp.prototype,"hasHorzBorder",{get:function(){return this.isHorzBorder},set:function(e){this.isHorzBorder=e},enumerable:!0,configurable:!0}),Object.defineProperty(cp.prototype,"hasVertBorder",{get:function(){return this.isVertBorder},set:function(e){this.isVertBorder=e},enumerable:!0,configurable:!0}),Object.defineProperty(cp.prototype,"hasBorders",{get:function(){return this.isBorders},set:function(e){this.isBorders=e},enumerable:!0,configurable:!0}),cp.prototype.clone=function(){var e=new cp;return e.isSeriesKeys=this.isSeriesKeys,e.isHorzBorder=this.isHorzBorder,e.isVertBorder=this.isVertBorder,e.isBorders=this.isBorders,e},cp.prototype.destroy=function(){this.isSeriesKeys=void 0,this.isHorzBorder=void 0,this.isVertBorder=void 0,this.isBorders=void 0};var hp=cp;function cp(){}pl(gp,pp=mh),Object.defineProperty(gp.prototype,"comment",{get:function(){return this.commentInternal},set:function(e){this.commentInternal=e},enumerable:!0,configurable:!0}),gp.prototype.getLength=function(){return 1},gp.prototype.clone=function(){var e=new gp(this.commentType);return e.commentId=this.commentId,e.commentType=this.commentType,_.isNullOrUndefined(this.commentInternal)||(e.commentInternal=this.commentInternal.clone()),e},gp.prototype.renderCommentMark=function(e,t){for(var i,n,r=this.line.paragraph.bodyWidget.page.documentHelper,o=r.render.commentMarkDictionary,s=(0===this.commentType&&_.isNullOrUndefined(this.commentMark)&&(this.commentMark=document.createElement("div"),this.commentMark.style.display="none",this.commentMark.classList.add("e-de-cmt-mark"),(i=document.createElement("span")).classList.add("e-icons"),i.classList.add("e-de-cmt-mark-icon"),this.commentMark.appendChild(i)),this.line&&_.isNullOrUndefined(this.commentMark.parentElement)&&(r.pageContainer.appendChild(this.commentMark),this.commentMark.addEventListener("click",this.selectComment.bind(this))),!1),a=0;a<o.length;a++)if(this.elementsOverlap(o.keys[a],e,t)){s=!0,n=o.keys[a];break}if(s){for(var l=!0,a=0;a<o.get(n).length;a++)if(o.get(n)[a]===this){l=!1;break}l&&o.get(n).push(this)}else o.add(this.commentMark,[this]);for(a=0;a<o.length;a++){var d=o.keys[a];if(1==o.get(d).length&&o.get(d)[0].commentMark&&(o.get(d)[0].commentMark.firstElementChild.classList.contains("e-de-multi-cmt-mark")?_.classList(o.get(d)[0].commentMark.firstElementChild,["e-de-cmt-mark-icon"],["e-de-multi-cmt-mark"]):o.get(d)[0].commentInternal.isResolved&&o.get(d)[0].commentMark.firstElementChild.classList.contains("e-de-cmt-mark-icon")?_.classList(o.get(d)[0].commentMark.firstElementChild,["e-de-cmt-resolve-icon"],["e-de-cmt-mark-icon"]):!o.get(d)[0].commentInternal.isResolved&&o.get(d)[0].commentMark.firstElementChild.classList.contains("e-de-cmt-resolve-icon")&&_.classList(o.get(d)[0].commentMark.firstElementChild,["e-de-cmt-mark-icon"],["e-de-cmt-resolve-icon"])),1<o.get(d).length)for(var h=0;h<o.get(d).length;h++){for(var c=!0,p=0;p<o.get(d).length;p++)if(o.get(d)[p].commentInternal&&!o.get(d)[p].commentInternal.isResolved){c=!1;break}o.get(d)[h].commentMark&&(o.get(d)[h].commentMark.firstElementChild.classList.contains("e-de-cmt-mark-icon")?_.classList(o.get(d)[h].commentMark.firstElementChild,["e-de-multi-cmt-mark"],["e-de-cmt-mark-icon"]):!c&&o.get(d)[h].commentMark.firstElementChild.classList.contains("e-de-multi-cmt-resolve")?_.classList(o.get(d)[h].commentMark.firstElementChild,["e-de-multi-cmt-mark"],["e-de-multi-cmt-resolve"]):c&&_.classList(o.get(d)[h].commentMark.firstElementChild,["e-de-multi-cmt-resolve"],["e-de-multi-cmt-mark"]))}}},gp.prototype.elementsOverlap=function(e,t,i){var n=e.offsetWidth,r=e.offsetHeight,o=parseFloat(e.style.top),e=parseFloat(e.style.left),s=o+r,a=e+n,t=parseFloat(t),i=parseFloat(i);return!(t+r<o||a<i||s<t||i+n<e)},gp.prototype.selectComment=function(){for(var e=this.line.paragraph.bodyWidget.page.documentHelper,t=e.render.commentMarkDictionary,i=this.commentMark.style.top,n=this.commentMark.style.left,r=0,o=[],s=0;s<t.keys.length;s++)if(this.elementsOverlap(t.keys[s],i,n)){o=t.get(t.keys[s]);break}if(e.owner.documentHelper.currentSelectedComment){for(s=0;s<o.length;s++)if(o[s].comment===e.owner.documentHelper.currentSelectedComment){r=s;break}r<o.length-1?r+=1:r=0}else r=0;e.owner&&(e.owner.commentReviewPane.commentPane.isEditMode?e.owner.showComments=!0:e.selectComment(o[r].comment))},gp.prototype.removeCommentMark=function(){this.commentMark&&this.commentMark.parentElement&&(this.commentMark.removeEventListener("click",this.selectComment.bind(this)),this.commentMark.parentElement.removeChild(this.commentMark))},gp.prototype.destroy=function(){this.commentMark&&this.removeCommentMark(),this.commentMark=void 0,this.commentInternal=void 0,this.commentId=void 0,pp.prototype.componentDestroy.call(this)};var pp,up=gp;function gp(e){var t=pp.call(this)||this;return t.commentType=0,t.commentId="",t.commentType=e,t}pl(yp,mp=up),Object.defineProperty(yp.prototype,"commentStart",{get:function(){return this.commentStartIn},set:function(e){this.commentStartIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(yp.prototype,"commentEnd",{get:function(){return this.commentEndIn},set:function(e){this.commentEndIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(yp.prototype,"author",{get:function(){return this.authorIn},set:function(e){this.authorIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(yp.prototype,"initial",{get:function(){return this.initialIn},set:function(e){this.initialIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(yp.prototype,"isResolved",{get:function(){return this.done},set:function(e){this.done=e},enumerable:!0,configurable:!0}),Object.defineProperty(yp.prototype,"date",{get:function(){return this.createdDate},enumerable:!0,configurable:!0}),Object.defineProperty(yp.prototype,"text",{get:function(){return this.textIn},set:function(e){this.textIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(yp.prototype,"mentions",{get:function(){return this.mentionsIn},set:function(e){this.mentionsIn=e},enumerable:!0,configurable:!0}),yp.prototype.getLength=function(){return 1},yp.prototype.clone=function(){var e=new yp(this.date);return e.author=this.author,e.initial=this.initial,e.commentId=this.commentId,e.replyComments=this.replyComments,e.isResolved=this.isResolved,e.text=this.text,e},yp.prototype.destroy=function(){if(this.replyComments&&0<this.replyComments.length){for(var e=0;e<this.replyComments.length;e++)this.replyComments[e].destroy();this.replyComments=[]}this.replyComments=void 0,this.commentStartIn&&(this.commentStartIn.destroy(),this.commentStartIn=void 0),this.commentEndIn&&(this.commentEndIn.destroy(),this.commentEndIn=void 0),this.commentId=void 0,this.createdDate=void 0,this.initialIn=void 0,this.textIn=void 0,this.authorIn=void 0,this.ownerComment=void 0,mp.prototype.destroy.call(this)};var mp,fp=yp;function yp(e){var t=mp.call(this,0)||this;return t.authorIn="",t.initialIn="",t.done=!1,t.textIn="",t.isReply=!1,t.ownerComment=void 0,t.mentionsIn=[],t.createdDate=e,t.replyComments=[],t}Object.defineProperty(wp.prototype,"headerWidget",{get:function(){return!_.isNullOrUndefined(this.headerWidgetIn)&&this.headerWidgetIn.parentHeaderFooter?this.headerWidgetIn.parentHeaderFooter:this.headerWidgetIn},set:function(e){this.headerWidgetIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(wp.prototype,"footerWidget",{get:function(){return!_.isNullOrUndefined(this.footerWidgetIn)&&this.footerWidgetIn.parentHeaderFooter?this.footerWidgetIn.parentHeaderFooter:this.footerWidgetIn},set:function(e){this.footerWidgetIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(wp.prototype,"index",{get:function(){return this.documentHelper?this.documentHelper.pages.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(wp.prototype,"previousPage",{get:function(){var e=this.index;if(0<e)return this.documentHelper.pages[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(wp.prototype,"nextPage",{get:function(){var e=this.index;if(e<this.documentHelper.pages.length-1)return this.documentHelper.pages[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(wp.prototype,"sectionIndex",{get:function(){return 0<this.bodyWidgets.length?this.bodyWidgets[0].index:-1},enumerable:!0,configurable:!0}),Object.defineProperty(wp.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),wp.prototype.destroy=function(){this.headerWidget&&this.headerWidget.page===this&&(this.headerWidget.page=void 0),this.footerWidget&&this.footerWidget.page===this&&(this.footerWidget.page=void 0),this.headerWidgetIn&&!_.isNullOrUndefined(this.headerWidgetIn.parentHeaderFooter)&&(this.viewer&&this.documentHelper.owner.editorModule&&(this.documentHelper.owner.editorModule.removeFieldInWidget(this.headerWidgetIn),this.documentHelper.owner.editorModule.removeFieldInWidget(this.headerWidgetIn,!1,!0)),this.headerWidgetIn.destroy(),this.headerWidget=void 0),this.footerWidgetIn&&!_.isNullOrUndefined(this.footerWidgetIn.parentHeaderFooter)&&(this.viewer&&this.documentHelper.owner.editorModule&&(this.documentHelper.owner.editorModule.removeFieldInWidget(this.footerWidgetIn),this.documentHelper.owner.editorModule.removeFieldInWidget(this.footerWidgetIn,!1,!0)),this.footerWidgetIn.destroy(),this.footerWidgetIn=void 0),this.bodyWidgets=[],this.bodyWidgets=void 0,_.isNullOrUndefined(this.documentHelper)||_.isNullOrUndefined(this.documentHelper.pages)||this.documentHelper.removePage(this),this.documentHelper=void 0},wp.prototype.componentDestroy=function(){if(this.headerWidgetIn&&(this.headerWidgetIn.componentDestroy(),this.headerWidgetIn=void 0),this.footerWidgetIn&&(this.footerWidgetIn.componentDestroy(),this.footerWidgetIn=void 0),this.bodyWidgets){for(var e=0;e<this.bodyWidgets.length;e++)this.bodyWidgets[e].componentDestroy();this.bodyWidgets=[],this.bodyWidgets=void 0}this.documentHelper=void 0};var vp=wp;function wp(e){this.boundingRectangle=new Rd(96,96,816,1056),this.repeatHeaderRowTableWidget=!1,this.bodyWidgets=[],this.headerWidgetIn=void 0,this.footerWidgetIn=void 0,this.footnoteWidget=void 0,this.endnoteWidget=void 0,this.currentPageNum=1,this.allowNextPageRendering=!0,this.documentHelper=e}Object.defineProperty(xp.prototype,"columns",{get:function(){return this.tableColumns},enumerable:!0,configurable:!0}),xp.prototype.resetColumns=function(){for(var e=0;e<this.tableColumns.length;e++)this.tableColumns[e].destroy();this.tableColumns=[]},xp.prototype.getPreviousSpannedCellWidth=function(e,t){for(var i=0,n=e;n<t;n++)i+=this.tableColumns[n].preferredWidth;return i},xp.prototype.addColumns=function(e,t,i,n,r,o){for(var s=this.columns.length;s<t;s++)this.columns.push(new Cp);for(var a=0,l=e;l<t;l++)a+=this.columns[l].preferredWidth;!(1<t-e)&&a<i&&(this.columns[t-1].preferredWidth+=i-a),n.minimumWordWidth>this.columns[t-1].minimumWordWidth&&(this.columns[t-1].minimumWordWidth=n.minimumWordWidth),n.maximumWordWidth>this.columns[t-1].maximumWordWidth&&(this.columns[t-1].maximumWordWidth=n.maximumWordWidth),n.minimumWidth>this.columns[t-1].minimumWidth&&(this.columns[t-1].minimumWidth=n.minimumWidth),r>this.columns[t-1].endOffset&&(this.columns[t-1].endOffset=r),this.columns[t-1].widthType=o},xp.prototype.getTotalWidth=function(e){for(var t=0,i=0;i<this.columns.length;i++){var n=this.columns[i];t+=0===e?n.preferredWidth:1===e?n.minimumWordWidth:2===e?n.maximumWordWidth:n.minimumWidth}return t},xp.prototype.isFitColumns=function(e,t,i){var n=this.getTotalWidth(0);if(this.tableWidth=i&&n<t?n:t,n!==this.tableWidth)for(var r=this.tableWidth/n,r=isNaN(r)||r==1/0?1:r,o=0;o<this.columns.length;o++){var s=this.columns[o];if(r*s.preferredWidth<s.minWidth)return!1}return!0},xp.prototype.isAllColumnHasPointWidthType=function(){for(var e=!0,t=0;t<this.columns.length;t++)"Point"!=this.columns[t].widthType&&(e=!1);return e},xp.prototype.autoFitColumn=function(e,t,i,n,r,o,s,a){for(var l=0,d=0,h=0,c=!0,p=0,u=[],g=0;g<this.columns.length;g++){0===(b=this.columns[g]).minimumWordWidth&&0===b.maximumWordWidth&&0===b.minWidth&&(b.minimumWordWidth=b.preferredWidth,b.maximumWordWidth=b.preferredWidth,b.minWidth=b.preferredWidth),"Point"!==b.widthType&&(c=!1);var m=0,f=(l+=b.preferredWidth>b.maximumWordWidth?b.preferredWidth:b.maximumWordWidth,d+=b.preferredWidth>b.minimumWordWidth?b.preferredWidth:b.minimumWordWidth,0!==b.preferredWidth&&b.preferredWidth>b.minimumWordWidth?b.preferredWidth:b.minimumWordWidth);h+=0<(m=b.maximumWordWidth-f)?m:0,b.preferredWidth<b.minimumWordWidth?p+=b.minimumWordWidth-b.preferredWidth:u.push(g)}if(l<=t){for(g=0;g<this.columns.length;g++)"Point"===(b=this.columns[g]).widthType?b.preferredWidth<b.minimumWordWidth&&(b.preferredWidth=b.minimumWordWidth):b.preferredWidth<b.maximumWordWidth&&(b.preferredWidth=b.maximumWordWidth);i||this.fitColumns(e,t,i,r)}else{var y,v=this.getTotalWidth(0);if(c&&!o&&e<d&&(v<e&&(p-=e-v),0<u.length)&&0<p){for(var w=p/this.columns.length,g=0;g<this.columns.length;g++){var b=this.columns[g];-1===u.indexOf(g)?v>b.minimumWordWidth&&(b.preferredWidth=b.minimumWordWidth):(b.preferredWidth=b.preferredWidth-w,b.preferredWidth<b.minimumWordWidth&&(b.preferredWidth=b.minimumWordWidth))}v=this.getTotalWidth(0)}if(!i)return y=!1,t<d&&d+(_.isNullOrUndefined(s)?0:s)<e&&(y=!0),void this.fitColumns(e,y?d:t,i,r);if(d<=t||d<=e){var x=t<e?e:t;x-=d;for(g=0;g<this.columns.length;g++)"Point"!==(b=this.columns[g]).widthType&&((0===b.preferredWidth||b.preferredWidth<b.minimumWordWidth)&&(b.preferredWidth=b.minimumWordWidth),k=x*((m=0<(m=b.maximumWordWidth-b.preferredWidth)?m:0)/h),b.preferredWidth+=isNaN(k)?0:k)}else{var C=this.getTotalWidth(1),s=this.getTotalWidth(3);if(2112<s)for(var I=2112/this.columns.length,g=0;g<this.columns.length;g++)this.columns[g].preferredWidth=I;else{x=0;if(s<e&&1<=e-s&&!c||c&&!o&&e<C){x=e-s;for(g=0;g<this.columns.length;g++){var k=x*(b=this.columns[g]).minimumWordWidth/C;k=isNaN(k)?0:k,b.preferredWidth=(0==b.minimumWidth?1:b.minimumWidth)+k}}else if(e<v)for(k=e/v,g=0;g<this.columns.length;g++)(b=this.columns[g]).preferredWidth=b.preferredWidth*k}}}this.tableWidth=this.getTotalWidth(0)},xp.prototype.getValidColumnIndex=function(e){for(var t=0,i=0;i<this.columns.length;i++){var n=this.columns[i];if(i<e)t=n.endOffset;else{if(t!==n.endOffset)break;e++}}return e},xp.prototype.fitColumns=function(e,t,i,n,r){_.isNullOrUndefined(r)&&(r=0);var o=this.getTotalWidth(0);if(i&&(o-=r),this.tableWidth=i?o:t,o!==this.tableWidth)for(var s=this.tableWidth/o,s=isNaN(s)||s==1/0?1:s,a=0;a<this.columns.length;a++){var l,d=this.columns[a];"Percent"===d.widthType&&!i&&!n&&o>this.tableWidth?0!==a&&d.endOffset>this.tableWidth&&(l=this.getCellWidth(0,a+1,t))>this.tableWidth&&(d.preferredWidth-=l-this.tableWidth,0===d.preferredWidth||d.preferredWidth<d.minimumWidth)&&(d.preferredWidth=0<d.minimumWidth?d.minimumWidth:1,this.columns[0].preferredWidth-=d.preferredWidth):d.preferredWidth=s*d.preferredWidth}},xp.prototype.getCellWidth=function(e,t,i){for(var n=0,r=0;r<t;r++)n+=this.tableColumns[r+e].preferredWidth;return n},xp.prototype.validateColumnWidths=function(){for(var e=0;e<this.columns.length;e++)0===e?this.columns[e].preferredWidth!==this.columns[e].endOffset&&(this.columns[e].preferredWidth=this.columns[e].endOffset):this.columns[e-1].endOffset+this.columns[e].preferredWidth<this.columns[e].endOffset&&(0===this.columns[e-1].endOffset?this.columns[e].preferredWidth=this.columns[e].endOffset-this.getPreviousValidOffset(e-2):this.columns[e].preferredWidth=this.columns[e].endOffset-this.columns[e-1].endOffset)},xp.prototype.getPreviousValidOffset=function(e){for(var t=e;0<=t;t--)if(0!==this.columns[t].endOffset)return this.columns[t].endOffset;return 0},xp.prototype.clone=function(){var e=new xp;e.tableWidth=this.tableWidth;for(var t=0;t<this.columns.length;t++)e.columns.push(this.columns[t].clone());return e},xp.prototype.destroy=function(){if(!_.isNullOrUndefined(this.tableColumns))for(var e=0;e<this.tableColumns.length;e++)this.tableColumns[e].destroy();this.tableColumns=[],this.tableColumns=void 0,this.tableWidth=void 0};var bp=xp;function xp(){this.tableColumns=[],this.tableWidth=0}Ip.prototype.clone=function(){var e=new Ip;return e.preferredWidth=this.preferredWidth,e.minWidth=this.minWidth,e.maxWidth=this.maxWidth,e},Ip.prototype.destroy=function(){this.preferredWidth=void 0,this.minWidth=void 0,this.maxWidth=void 0};var Cp=Ip;function Ip(){this.preferredWidth=0,this.minWidth=0,this.maxWidth=0,this.endOffset=0,this.minimumWordWidth=0,this.maximumWordWidth=0,this.minimumWidth=0}function kp(){}function Fp(){}var Pp,Tp=function(){this.minimumWordWidth=0,this.maximumWordWidth=0,this.minimumWidth=0,this.hasMinimumWidth=!1,this.hasMinimumWordWidth=!1,this.hasMaximumWordWidth=!1},Sp=(pl(Hp,Pp=X),Hp.prototype.clone=function(){var e=Pp.prototype.clone.call(this);return e.breakClearType=this.breakClearType,e},Hp.prototype.destroy=function(){this.breakClearType=void 0,Pp.prototype.destroy.call(this)},Hp.prototype.componentDestroy=function(){this.breakClearType=void 0,Pp.prototype.componentDestroy.call(this)},Hp);function Hp(){return Pp.call(this)||this}function Np(){}pl(Ep,Wp=X),Ep.prototype.getLength=function(){return 1},Ep.prototype.clone=function(){var e=new Ep;if(e.characterFormat.copyFormat(this.characterFormat),e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.baselineOffset=this.baselineOffset,!_.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(0<this.revisions.length)for(var t=0;t<this.revisions.length;t++){var i=this.revisions[t];e.revisions.push(i.clone())}}else 0<this.revisions.length?e.removedIds=$a.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.width=this.width,e.height=this.height,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e};var Wp,Op=Ep;function Ep(){return null!==Wp&&Wp.apply(this,arguments)||this}var Lp="_contextmenu_lock",Bp="_contextmenu_unlock",Rp="_contextmenu_copy",Mp="_contextmenu_cut",Ap="_contextmenu_paste",Dp="_add_comment",Up="_contextmenu_update_field",Vp="_contextmenu_edit_field",zp="_contextmenu_hyperlink",qp="_contextmenu_open_hyperlink",_p="_contextmenu_copy_hyperlink",jp="_contextmenu_remove_hyperlink",Gp="_properties",Kp="_contextmenu_edit_hyperlink",Zp="_contextmenu_font_dialog",Xp="_contextmenu_paragraph_dialog",Jp="_contextmenu_table_dialog",Yp="_contextmenu_insert_table",Qp="_contextmenu_delete_table",$p="_contextmenu_insert_above",eu="_contextmenu_insert_below",tu="_contextmenu_insert_right",iu="_contextmenu_insert_left",nu="_contextmenu_complete_table_delete",ru="_contextmenu_delete_row",ou="_contextmenu_delete_column",su="_contextmenu_merge_cell",au="_contextmenu_auto_fit",lu="_contextmenu_auto_fit_contents",du="_contextmenu_auto_fit_window",hu="_contextmenu_fixed_column_width",cu="_contextmenu_continue_numbering",pu="_contextmenu_restart_at",uu="_contextmenu_spelling_dialog",gu="_contextmenu_otherSuggestions_spellcheck_",mu="_contextmenu_no_suggestion",fu="_contextmenu_accept_changes",yu="_contextmenu_reject_changes",vu="_contextmenu_note_options",wu="_remove_content_control",bu="_content_control_properties",xu=(Object.defineProperty(Cu.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(Cu.prototype,"spellChecker",{get:function(){try{return this.documentHelper.owner.spellCheckerModule}catch(e){}},enumerable:!0,configurable:!0}),Cu.prototype.getModuleName=function(){return"ContextMenu"},Cu.prototype.initContextMenu=function(e,t){var i=this,n=this.documentHelper.owner.element.id,r=(this.contextMenu=document.createElement("div"),this.contextMenu.id=this.documentHelper.owner.containerId+"e-de-contextmenu",document.body.appendChild(this.contextMenu),document.createElement("ul")),r=(r.contentEditable="false",r.style.width="auto",r.id=this.documentHelper.owner.containerId+"e-de-contextmenu-list",r.style.listStyle="none",r.style.margin="0px",r.style.maxHeight="auto",r.oncontextmenu=this.disableBrowserContextmenu,this.contextMenu.appendChild(r),this.menuItems=[{text:e.getConstant("Lock"),iconCss:"e-icons e-de-ctnr-lock",id:n+Lp},{text:e.getConstant("Unlock"),iconCss:"e-icons",id:n+Bp},{text:e.getConstant("Cut"),iconCss:"e-icons e-de-cut",id:n+Mp},{text:e.getConstant("Copy"),iconCss:"e-icons e-de-copy",id:n+Rp},{text:e.getConstant("Paste"),iconCss:"e-icons e-de-paste",id:n+Ap},{separator:!0},{text:e.getConstant("Remove Content Control"),iconCss:"e-icons",id:n+wu},{text:e.getConstant("Content Control Properties"),iconCss:"e-icons e-de-formproperties",id:n+bu},{separator:!0},{text:e.getConstant("New Comment"),iconCss:"e-icons e-de-cmt-add",id:n+Dp},{separator:!0},{text:e.getConstant("Accept Changes"),iconCss:"e-icons e-de-acceptchange",id:n+fu},{text:e.getConstant("Reject Changes"),iconCss:"e-icons e-de-rejectchange",id:n+yu},{text:e.getConstant("Update Field"),iconCss:"e-icons e-de-update-field",id:n+Up},{text:e.getConstant("Edit Field")+"...",iconCss:"e-icons e-de-edit_field",id:n+Vp},{text:e.getConstant("Continue Numbering"),iconCss:"e-icons e-de-continue-numbering",id:n+cu},{text:e.getConstant("Restart At")+" 1",iconCss:"e-icons e-de-restart-at",id:n+pu},{separator:!0},{text:e.getConstant("Hyperlink")+"...",iconCss:"e-icons e-de-insertlink",id:n+zp},{text:e.getConstant("Edit Hyperlink")+"...",iconCss:"e-icons e-de-edit-hyperlink",id:n+Kp},{text:e.getConstant("Open Hyperlink"),iconCss:"e-icons e-de-open-hyperlink",id:n+qp},{text:e.getConstant("Copy Hyperlink"),iconCss:"e-icons e-de-copy-hyperlink",id:n+_p},{text:e.getConstant("Remove Hyperlink"),iconCss:"e-icons e-de-remove-hyperlink",id:n+jp},{text:e.getConstant("Properties"),iconCss:"e-icons e-de-formproperties",id:n+Gp},{separator:!0},{text:e.getConstant("Font")+"...",iconCss:"e-icons e-de-fonts",id:n+Zp},{text:e.getConstant("Paragraph")+"...",iconCss:"e-icons e-de-paragraph",id:n+Xp},{text:e.getConstant("Notes Options")+"...",id:n+vu},{separator:!0},{text:e.getConstant("Table Properties")+"...",id:n+Jp,iconCss:"e-icons e-de-table"},{text:e.getConstant("Merge Cells"),id:n+su,iconCss:"e-icons e-de-ctnr-mergecell"},{text:e.getConstant("AutoFit"),id:n+au,iconCss:"e-icons",items:[{text:e.getConstant("AutoFit to Contents"),id:n+lu,iconCss:"e-icons e-de-icon-autofit e-de-autofit-contents"},{text:e.getConstant("AutoFit to Window"),id:n+du,iconCss:"e-icons e-de-icon-auto-fitwindow e-de-autofit-window"},{text:e.getConstant("Fixed Column Width"),id:n+hu,iconCss:"e-icons e-de-icon-fixed-columnwidth e-de-fixed-column"}]},{text:e.getConstant("Insert"),id:n+Yp,iconCss:"e-icons",items:[{text:e.getConstant("Insert Above"),id:n+$p,iconCss:"e-icons e-de-insertabove"},{text:e.getConstant("Insert Below"),id:n+eu,iconCss:"e-icons e-de-insertbelow"},{text:e.getConstant("Insert Left"),id:n+iu,iconCss:"e-icons e-de-insertleft"},{text:e.getConstant("Insert Right"),id:n+tu,iconCss:"e-icons e-de-insertright"}]},{text:e.getConstant("Delete"),id:n+Qp,iconCss:"e-icons",items:[{text:e.getConstant("Delete Table"),id:n+nu,iconCss:"e-icons e-de-delete-table"},{text:e.getConstant("Delete Row"),id:n+ru,iconCss:"e-icons e-de-deleterow"},{text:e.getConstant("Delete Column"),id:n+ou,iconCss:"e-icons e-de-deletecolumn"}]}],{target:"#"+this.documentHelper.owner.containerId+"e-de-contextmenu",enableRtl:t,items:this.addMenuItems(this.menuItems),cssClass:"e-de-contextmenu-wrapper",select:function(e){e=e.element.id;i.handleContextMenuItem(e)}});this.contextMenuInstance=new k.ContextMenu(r,"#"+this.documentHelper.owner.containerId+"e-de-contextmenu-list"),this.contextMenuInstance.beforeOpen=function(){for(var e=0;e<i.customMenuItems.length;e++)void 0!==i.customMenuItems[e].id?i.ids[e]=i.customMenuItems[e].id:i.ids[e]=i.customMenuItems[e+1].id;if(i.documentHelper.owner.fireCustomContextMenuBeforeOpen(i.ids),i.enableCustomContextMenu)for(e=0;e<i.menuItems.length;e++)void 0!==i.menuItems[e].id?document.getElementById(i.menuItems[e].id).style.display="none":document.getElementById(i.menuItems[e-1].id).nextSibling.style.display="none";i.viewer&&i.documentHelper.selection&&(_.classList(i.documentHelper.selection.caret,[],["e-de-cursor-animation"]),i.documentHelper.selection.showCaret())},_.isNullOrUndefined(this.documentHelper.owner.documentEditorSettings.popupTarget)||this.documentHelper.owner.documentEditorSettings.popupTarget.append(document.getElementsByClassName("e-de-contextmenu-wrapper")[0]),this.contextMenuInstance.onClose=function(){i.viewer&&i.documentHelper.selection&&(_.classList(i.documentHelper.selection.caret,["e-de-cursor-animation"],[]),n+Zp!==i.itemsmenu)&&n+zp!==i.itemsmenu&&n+Jp!==i.itemsmenu&&n+Xp!==i.itemsmenu&&i.documentHelper.updateFocus()}},Cu.prototype.disableBrowserContextmenu=function(){return!1},Cu.prototype.openPasteDialog=function(){var e=this,t=_.createElement("div"),i=_.createElement("div"),n=_.createElement("p"),r=this.locale.getConstant("Paste Content Dialog"),r=(this.documentHelper.isIosDevice?n.textContent=r+" Command + V.":n.textContent=r+" Ctrl + V.",i.appendChild(n),t.appendChild(i),_.createElement("div"));this.pasteCheckBoxDialog=_.createElement("input",{attrs:{type:"checkbox"}}),r.appendChild(this.pasteCheckBoxDialog),new H.CheckBox({label:this.locale.getConstant("Paste Content CheckBox")}).appendTo(this.pasteCheckBoxDialog),t.appendChild(r),JSON.parse(localStorage.getItem("ej_de_hidePasteAlert"))||C.DialogUtility.alert({title:this.locale.getConstant("Information"),content:t,okButton:{text:this.locale.getConstant("Ok")},showCloseIcon:!0,closeOnEscape:!0,animationSettings:{effect:"Zoom"},close:function(){e.pasteCheckBoxDialog.checked&&localStorage.setItem("ej_de_hidePasteAlert","true")}})},Cu.prototype.handleContextMenuItem=function(e){var t=this.documentHelper.owner.element.id;switch(this.itemsmenu=e){case t+Lp:this.documentHelper.owner.collaborativeEditingModule&&this.documentHelper.owner.collaborativeEditingModule.lockContent(this.documentHelper.owner.currentUser);break;case t+Bp:this.documentHelper.owner.collaborativeEditingModule&&this.documentHelper.owner.collaborativeEditingModule.unlockContent(this.documentHelper.owner.currentUser);break;case t+Rp:this.documentHelper.selection.copy();break;case t+Mp:this.documentHelper.owner.editorModule.cut();break;case t+Ap:this.documentHelper.owner.isReadOnlyMode||(this.documentHelper.owner.enableLocalPaste?this.documentHelper.owner.editorModule.pasteInternal(void 0):this.openPasteDialog());break;case t+Dp:this.documentHelper.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||(this.documentHelper.owner.editorModule.isUserInsert=!0,this.documentHelper.owner.editorModule.insertComment(),this.documentHelper.owner.editorModule.isUserInsert=!1);break;case t+Up:var i=this.documentHelper.owner.isReadOnlyMode;!this.documentHelper.selection.isReferenceField()||i&&"FormFieldsOnly"!==this.documentHelper.protectionType?this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.editorModule.updateToc():this.documentHelper.selection.updateRefField();break;case t+Vp:this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.tableOfContentsDialogModule.show();break;case t+Zp:this.documentHelper.owner.fontDialogModule&&this.documentHelper.owner.fontDialogModule.showFontDialog();break;case t+wu:!_.isNullOrUndefined(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked&&this.documentHelper.owner.editor.removeContentControl();break;case t+bu:!_.isNullOrUndefined(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked&&this.documentHelper.owner.contentControlPropertiesDialogModule&&this.documentHelper.owner.contentControlPropertiesDialogModule.show();break;case t+qp:this.documentHelper.selection.navigateHyperlink();break;case t+_p:this.documentHelper.selection.copyHyperlink();break;case t+Kp:case t+zp:this.documentHelper.owner.hyperlinkDialogModule&&this.documentHelper.owner.hyperlinkDialogModule.show();break;case t+jp:this.documentHelper.owner.editorModule.removeHyperlink();break;case t+Xp:this.documentHelper.owner.paragraphDialogModule&&this.documentHelper.owner.paragraphDialogModule.show();break;case t+Jp:this.documentHelper.owner.tablePropertiesDialogModule.show();break;case t+su:this.documentHelper.owner.editorModule.mergeCells();break;case t+$p:this.documentHelper.owner.editorModule.insertRow(!0);break;case t+eu:this.documentHelper.owner.editorModule.insertRow(!1);break;case t+iu:this.documentHelper.owner.editorModule.insertColumn(!0);break;case t+tu:this.documentHelper.owner.editorModule.insertColumn(!1);break;case t+nu:this.documentHelper.owner.editorModule.deleteTable();break;case t+ru:this.documentHelper.owner.editorModule.deleteRow();break;case t+ou:this.documentHelper.owner.editorModule.deleteColumn();break;case t+cu:this.documentHelper.owner.editorModule.applyContinueNumbering();break;case t+pu:this.documentHelper.owner.editorModule.applyRestartNumbering(this.documentHelper.selection);break;case t+lu:this.documentHelper.owner.editorModule.autoFitTable("FitToContents");break;case t+du:this.documentHelper.owner.editorModule.autoFitTable("FitToWindow");break;case t+hu:this.documentHelper.owner.editorModule.autoFitTable("FixedColumnWidth");break;case t+uu:i=this.spellChecker.retriveText();this.currentContextInfo=null,this.documentHelper.owner.spellCheckDialogModule.show(i.text,i.element);break;case t+fu:this.documentHelper.selection.handleAcceptReject(!0);break;case t+yu:this.documentHelper.selection.handleAcceptReject(!1);break;case t+Gp:i=this.documentHelper.selection.getCurrentFormField();i instanceof Z&&(i.formFieldData instanceof Ch?this.documentHelper.owner.textFormFieldDialogModule.show():i.formFieldData instanceof Fh?this.documentHelper.owner.checkBoxFormFieldDialogModule.show():i.formFieldData instanceof Sh&&this.documentHelper.owner.dropDownFormFieldDialogModule.show());break;case t+vu:this.documentHelper.owner.showFootNotesDialog();break;default:var i=this.documentHelper.owner.element.id+gu;e.substring(0,i.length)!==i?this.documentHelper.owner.fireCustomContextMenuSelect(e):(i=e.substring(e.lastIndexOf("_")+1),this.callSelectedOption(i))}},Cu.prototype.callSelectedOption=function(e){"Add to Dictionary"===e?this.spellChecker.handleAddToDictionary():"Ignore All"===e?this.spellChecker.handleIgnoreAllItems():this.spellChecker.manageReplace(e)},Cu.prototype.addCustomMenu=function(e,t,i){var n=JSON.parse(j.sanitizeString(JSON.stringify(e)));this.destroy(),0===this.spellContextItems.length&&(this.customItems=e);for(var r=0;r<n.length;r++)this.customMenuItems.push(n[r]),this.customMenuItems[r].id=this.documentHelper.owner.element.id+this.customMenuItems[r].id;this.enableCustomContextMenu=t,this.enableCustomContextMenuBottom=i,this.initContextMenu(this.locale)},Cu.prototype.addMenuItems=function(e){return this.enableCustomContextMenuBottom?e.concat(this.customMenuItems):this.customMenuItems.concat(e)},Cu.prototype.showContextMenuOnSel=function(e){var t,i=!(e instanceof MouseEvent),n=0,r=0;i?(n=(t=this.documentHelper.getTouchOffsetValue(e)).x,r=t.y):(r=(_.Browser.isIE?e.clientY:e.y)+document.body.scrollTop+document.documentElement.scrollTop,n=(_.Browser.isIE?e.clientX:e.x)+document.body.scrollLeft+document.documentElement.scrollLeft),this.showHideElements(this.documentHelper.selection)&&(i&&(this.documentHelper.isMouseDown=!1),this.contextMenuInstance.open(r,n),e.preventDefault())},Cu.prototype.hideSpellContextItems=function(){if(0<this.spellContextItems.length)for(var e=0;e<this.spellContextItems.length;e++){var t=document.getElementById(this.documentHelper.owner.element.id+this.spellContextItems[e].id);_.isNullOrUndefined(t)||(t.style.display="none")}},Cu.prototype.processSuggestions=function(e,t,i){this.spellContextItems=this.constructContextmenu(e,t),this.addCustomMenu(this.spellContextItems),this.noSuggestion=document.getElementById(this.documentHelper.owner.element.id+mu),_.isNullOrUndefined(this.noSuggestion)||(this.noSuggestion.style.display="block",_.classList(this.noSuggestion,["e-disabled"],["e-focused"])),this.showContextMenuOnSel(i)},Cu.prototype.constructContextmenu=function(e,t){var i=0<this.customItems.length?this.customItems.slice():[];if(_.isNullOrUndefined(e)||0===e.length)i.push({text:this.locale.getConstant("no suggestions"),id:mu,classList:["e-focused"],iconCss:""});else for(var n=0;n<e.length;n++)i.push({text:e[n],id:gu+e[n],iconCss:""});return i.push({separator:!0,id:"_contextmenu_suggestion_separator"}),!_.isNullOrUndefined(t)&&1<t.length?(i.push({text:this.locale.getConstant("More Suggestion"),items:t}),i.push({separator:!0,id:"_contextmenu_moreSuggestion_separator"})):i.push({text:this.locale.getConstant("Add to Dictionary"),id:"_contextmenu_otherSuggestions_spellcheck_Add to Dictionary",iconCss:""}),i.push({text:this.locale.getConstant("Ignore Once"),id:"_contextmenu_otherSuggestions_spellcheck_Ignore Once",iconCss:""}),i.push({text:this.locale.getConstant("Ignore All"),id:"_contextmenu_otherSuggestions_spellcheck_Ignore All",iconCss:""}),i.push({separator:!0,id:"_contextmenu_change_separator"}),i.push({text:this.locale.getConstant("Spelling"),id:uu,iconCss:"e-icons e-de-spellcheck",items:[]}),i.push({separator:!0,id:"_contextmenu_spelling_separator"}),i},Cu.prototype.showHideElements=function(e){if(_.isNullOrUndefined(e))return!1;e.hideToolTip();var t=this.documentHelper.owner,i=t.element.id,n=document.getElementById(i+Lp),r=document.getElementById(i+Bp),o=document.getElementById(i+Rp),s=document.getElementById(i+Mp),a=document.getElementById(i+Ap),l=document.getElementById(i+Up),d=document.getElementById(i+Vp),h=document.getElementById(i+Zp),c=document.getElementById(i+Xp),p=document.getElementById(i+Jp),u=document.getElementById(i+Yp),g=document.getElementById(i+Qp),m=document.getElementById(i+su),f=document.getElementById(i+zp),y=document.getElementById(i+qp),v=document.getElementById(i+Kp),w=document.getElementById(i+_p),b=document.getElementById(i+jp),x=document.getElementById(i+Gp),C=document.getElementById(i+cu),I=document.getElementById(i+pu),k=document.getElementById(i+au),F=document.getElementById(i+Dp),P=document.getElementById(i+vu),T=document.getElementById(i+wu),S=document.getElementById(i+bu),n=(this.documentHelper.owner.enableLockAndEdit?this.documentHelper.editRanges.containsKey(this.documentHelper.owner.currentUser)?(n.style.display="none",r.style.display="block",this.documentHelper.selection.isSelectionInEditRegion()?_.classList(r,["e-blankicon"],["e-disabled"]):_.classList(r,["e-disabled","e-blankicon"],[])):(n.style.display="block",this.documentHelper.owner.collaborativeEditingModule&&this.documentHelper.owner.collaborativeEditingModule.canLock()?_.classList(r,["e-disabled"],[]):_.classList(r,[],["e-disabled"]),r.style.display="none"):(n.style.display="none",r.style.display="none"),!1),r=(s.style.display="none",a.style.display="none",a.nextSibling.style.display="none",document.getElementById(i+fu)),i=document.getElementById(i+yu),H=(f.style.display="none",P.style.display="none",P.nextSibling.style.display="none",h.previousSibling.style.display="none",y.style.display="none",w.style.display="none",v.style.display="none",b.style.display="none",b.nextSibling.style.display="none",x.style.display="none",m.style.display="none",k.style.display="none",h.style.display="none",c.style.display="none",T.style.display="none",S.style.display="none",u.style.display="none",g.style.display="none",p.style.display="none",l.style.display="none",e.getHyperlinkField()),N=!1,W=(r.style.display="none",i.style.display="none",this.documentHelper.owner.editor.getContentControl()),O=this.documentHelper.owner.getImageContentControl(),T=(!_.isNullOrUndefined(W)&&W instanceof E&&!W.contentControlProperties.lockContentControl&&!this.documentHelper.owner.isReadOnlyMode||O instanceof E&&!O.contentControlProperties.lockContentControl&&"Picture"==O.contentControlProperties.type&&!this.documentHelper.owner.isReadOnlyMode?T.style.display="block":T.style.display="none",!this.documentHelper.owner.isReadOnlyMode&&!_.isNullOrUndefined(W)&&W instanceof E||O instanceof E&&"Picture"==O.contentControlProperties.type&&!this.documentHelper.owner.isReadOnlyMode?(S.style.display="block",S.nextSibling.style.display="block"):(S.style.display="none",S.nextSibling.style.display="none"),H instanceof Z&&e.isReferenceField(H)&&(N=!0),H instanceof Z&&N&&("FormFieldsOnly"===this.documentHelper.protectionType||!this.documentHelper.owner.isReadOnlyMode)&&(l.style.display="block"),d.style.display="none",C.style.display="none",I.style.display="none",I.nextSibling.style.display="none",e.isEmpty),W=(_.classList(s,T?["e-disabled"]:[],T?[]:["e-disabled"]),_.classList(o,T?["e-disabled"]:[],T?[]:["e-disabled"]),this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.enableHeaderAndFooter||!this.documentHelper.owner.enableComment);return F.style.display=W?"none":"block",this.documentHelper.isCommentOnlyMode&&(F.style.display="block"),F.nextSibling.style.display=W?"none":"block",t.isReadOnlyMode?!_.isNullOrUndefined(H)&&H instanceof Z&&(y.style.display="block",w.style.display="block"):(this.viewer&&this.documentHelper.owner&&this.documentHelper.owner.commentReviewPane&&this.documentHelper.owner.commentReviewPane.commentPane.isEditMode?_.classList(F,["e-disabled"],[]):_.classList(F,[],["e-disabled"]),r.previousSibling.style.display="none",s.style.display="block",a.style.display="block",a.nextSibling.style.display="block",_.classList(u,["e-blankicon"],[]),_.classList(g,["e-blankicon"],[]),_.classList(d,["e-blankicon"],[]),_.classList(k,["e-blankicon"],[]),_.Browser.isIE||JSON.parse(localStorage.getItem("ej_de_hidePasteAlert"))&&(O=t.enableLocalPaste&&!_.isNullOrUndefined(t.editorModule.copiedData),_.classList(a,O?[]:["e-disabled"],O?["e-disabled"]:[])),"TableOfContents"===e.contextType?(l.style.display="block",d.style.display="block"):(S=e.start,o=e.end,"List"===e.contextType&&"Bullet"!==t.selectionModule.getListLevel(S.paragraph).listLevelPattern&&(C.style.display="block",I.style.display="block",I.nextSibling.style.display="block"),S.paragraph.isInsideTable&&(!o.paragraph.isInsideTable||S.paragraph.associatedCell!==o.paragraph.associatedCell||e.isCellSelected(S.paragraph.associatedCell,S,o))?f.classList.add("e-disabled"):f.classList.contains("e-disabled")&&f.classList.remove("e-disabled"),H instanceof Z&&!N?(y.style.display="block",e.isImageField()||(w.style.display="block"),t.hyperlinkDialogModule&&(v.style.display="block"),b.style.display="block",b.nextSibling.style.display="block",n=!0,x.style.display="none"):t.hyperlinkDialogModule&&(f.style.display="block",h.previousSibling.style.display="block",n=!0),e.isFormField()&&this.documentHelper.owner.enableFormField&&(f.style.display="none",x.style.display="block"),H instanceof Z&&N&&(f.style.display="none",l.style.display="block")),this.documentHelper.owner.selectionModule.start.paragraph.isInsideTable&&this.documentHelper.owner.selectionModule.end.paragraph.isInsideTable&&(t.tablePropertiesDialogModule&&(p.style.display="block"),u.style.display="block",g.style.display="block",this.documentHelper.owner.editorModule.canMergeCells()&&(m.style.display="block"),k.style.display=this.documentHelper.selection.isTableSelected()?"block":"none"),this.documentHelper.owner.fontDialogModule&&(h.style.display="block"),this.documentHelper.owner.paragraphDialogModule?c.style.display="block":n||this.documentHelper.owner.fontDialogModule||W||(F.nextSibling.style.display="none"),"Image"===e.contextType&&(h.style.display="none",c.style.display="none",h.previousSibling.style.display="none",b.nextSibling.style.display="none"),this.documentHelper.selection.hasRevisions()&&(r.previousSibling.style.display=this.documentHelper.owner.enableHeaderAndFooter?"none":"block",this.documentHelper.isTrackedOnlyMode?(r.style.display="none",i.style.display="none"):(r.style.display="block",i.style.display="block")),(this.documentHelper.selection.isinFootnote||this.documentHelper.selection.isinEndnote)&&(P.style.display="block")),!0},Cu.prototype.destroy=function(){this.contextMenuInstance&&this.contextMenuInstance.destroy(),this.contextMenuInstance=void 0,this.contextMenu&&this.contextMenu.parentElement&&(this.contextMenu.parentElement.removeChild(this.contextMenu),this.contextMenu.innerHTML=""),this.contextMenu=void 0,this.menuItems=[],this.customMenuItems=[],this.ids=[]},Cu.prototype.componentDestroy=function(){this.contextMenuInstance&&this.contextMenuInstance.destroy(),this.contextMenuInstance=void 0,this.contextMenu&&this.contextMenu.parentElement&&(this.contextMenu.parentElement.removeChild(this.contextMenu),this.contextMenu.innerHTML=""),this.contextMenu=void 0,this.menuItems=[],this.menuItems=void 0,this.customMenuItems=[],this.customMenuItems=void 0,this.ids=[],this.ids=void 0,this.customItems=[],this.customItems=void 0,this.spellContextItems=[],this.spellContextItems=void 0,this.documentHelper=void 0},Cu);function Cu(e){var o=this;this.contextMenuInstance=void 0,this.menuItems=[],this.customMenuItems=[],this.ids=[],this.spellContextItems=[],this.customItems=[],this.onContextMenuInternal=function(t){var i,n,r;0 instanceof MouseEvent;o.documentHelper.owner.isSpellCheck&&o.spellChecker.allowSpellCheckAndSuggestion&&(t.preventDefault(),o.currentContextInfo=o.spellChecker.findCurretText(),r=o.spellChecker.manageSpecialCharacters(o.currentContextInfo.text,void 0,!0),!_.isNullOrUndefined(r))&&o.spellChecker.errorWordCollection.containsKey(r)?(o.spellChecker.currentContextInfo=o.currentContextInfo,o.spellChecker.errorSuggestions.containsKey(r)?(n=o.spellChecker.errorSuggestions.get(r).slice(),i=o.spellChecker.handleSuggestions(n),o.processSuggestions(n,i,t)):o.spellChecker.enableOptimizedSpellCheck?o.spellChecker.callSpellChecker(o.spellChecker.languageID,r,!1,!0,!1,!1).then(function(e){e=JSON.parse(e);n=e.Suggestions,_.isNullOrUndefined(o.documentHelper)||(_.isNullOrUndefined(n)||(o.spellChecker.errorSuggestions.add(r,n.slice()),i=o.spellChecker.handleSuggestions(n)),o.processSuggestions(n,i,t))}):o.processSuggestions(n,i,t)):(o.hideSpellContextItems(),o.showContextMenuOnSel(t))},_.isNullOrUndefined(e)||(this.documentHelper=e,this.locale=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.locale.setLocale(this.documentHelper.owner.locale),this.initContextMenu(this.locale,this.documentHelper.owner.enableRtl))}Object.defineProperty(ku.prototype,"previousSelectedComment",{get:function(){return this.previousSelectedCommentInt},set:function(e){if(!_.isNullOrUndefined(e)&&e!==this.previousSelectedCommentInt&&this.commentPane.comments.containsKey(e)){var t=this.commentPane.getCommentStart(e).commentMark,i=(t&&(_.classList(t,[],["e-de-cmt-mark-selected"]),this.commentPane.removeSelectionMark("e-de-cmt-selection"),this.commentPane.removeSelectionMark("e-de-cmt-mark-selected")),this.commentPane.comments.get(e));i.hideDrawer();for(var n=0;n<e.replyComments.length;n++)(i=this.commentPane.comments.get(e.replyComments[n]))&&(i.hideDrawer(),i.hideMenuItems())}this.previousSelectedCommentInt=e},enumerable:!0,configurable:!0}),ku.prototype.selectReviewTab=function(e){"Changes"===e?this.reviewTab.select(1):this.reviewTab.select(0)},ku.prototype.showHidePane=function(e,t){this.parentPaneElement&&(this.updateTabHeaderWidth(),e?(this.parentPaneElement.style.display="block","Changes"===t&&this.owner.showRevisions?(this.isCommentTabVisible=!1,this.owner.notify("reviewPane",{comment:this.isCommentTabVisible,changes:!0}),this.reviewTab.select(1)):(this.owner.trackChangesPane.isChangesTabVisible=!1,this.owner.notify("reviewPane",{comment:!0,changes:this.owner.trackChangesPane.isChangesTabVisible,isUserClosed:!1}),this.reviewTab.select(0)),this.owner.trackChangesPane.updateTrackChanges(this.owner.showRevisions),this.commentPane.updateCommentStatus()):this.parentPaneElement.style.display="none",this.owner.showRevisions||(this.owner.trackChangesPane.isChangesTabVisible=!1,this.owner.notify("reviewPane",{comment:this.isCommentTabVisible,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.reviewTab.hideTab(1,!0)),this.owner.showComments||(this.isCommentTabVisible=!1,this.owner.notify("reviewPane",{comment:this.isCommentTabVisible,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.reviewTab.hideTab(0,!0))),e&&(this.enableDisableItems(),this.commentPane.updateHeight()),this.owner&&(this.owner.resize(),this.owner.enableAutoFocus)&&this.owner.documentHelper.updateFocus()},ku.prototype.reviewPaneHelper=function(e){var t=this;if(_.isNullOrUndefined(e.isUserClosed)){if(this.isUserClosed)return}else{if(e.isUserClosed===this.isUserClosed)return;this.isUserClosed=e.isUserClosed,this.owner&&setTimeout(function(){t.owner&&t.owner.resize()},10)}_.isNullOrUndefined(e.comment)&&_.isNullOrUndefined(e.changes)||(e.comment||e.changes?"none"===this.parentPaneElement.style.display&&(this.parentPaneElement.style.display="block"):this.parentPaneElement.style.display="none",this.owner&&setTimeout(function(){t.owner&&t.owner.resize()},10))},ku.prototype.updateTabHeaderWidth=function(){var e=this.reviewTab.getRootElement().getElementsByClassName("e-tab-wrap");e[0].style.padding="0 8px",e[1].style.padding="0 8px"},ku.prototype.initReviewPane=function(e){var t=this.owner.documentHelper.optionsPaneContainer;t.style.display="flex",this.initPaneHeader(e),t.appendChild(this.addReviewTab(e)),this.initCommentPane(),this.owner.on("reviewPane",this.reviewPaneHelper,this)},ku.prototype.addReviewTab=function(e){var t=_.createElement("div",{innerHTML:e.getConstant("Comments")}),e=_.createElement("div",{innerHTML:e.getConstant("Changes")}),t=(this.parentPaneElement=_.createElement("div",{styles:"height:100%;overflow:auto;display:none",className:"e-de-review-pane"}),this.element=_.createElement("div",{className:"e-de-property-tab",id:this.owner.element.id+"Review_Tab"}),[{header:{text:t},content:this.reviewPane},{header:{text:e}}]);return this.reviewTab=new k.Tab({items:t,selected:this.onTabSelection,animation:{previous:{effect:"None"},next:{effect:"None"}}}),this.reviewTab.appendTo(this.element),this.owner.enableRtl&&(this.reviewTab.enableRtl=!0),this.reviewTab.enablePersistence=!0,this.parentPaneElement.appendChild(this.element),this.parentPaneElement},ku.prototype.initPaneHeader=function(e){return this.headerContainer=_.createElement("div"),this.reviewPane=_.createElement("div",{className:"e-de-cmt-pane"}),this.owner.enableRtl&&_.classList(this.reviewPane,["e-rtl"],[]),this.headerContainer.appendChild(this.initToolbar(e)),this.reviewPane.appendChild(this.headerContainer),this.reviewPane.style.display="block",this.reviewPane},ku.prototype.closePane=function(){var e;this.commentPane&&this.commentPane.isEditMode?!_.isNullOrUndefined(this.commentPane.currentEditingComment)&&this.commentPane.isInsertingReply&&""===this.commentPane.currentEditingComment.replyViewTextBox.innerText?(this.owner.documentHelper.currentSelectedComment=void 0,this.commentPane.currentEditingComment.cancelReply(),this.owner.showComments=!1):this.isNewComment||!_.isNullOrUndefined(this.commentPane.currentEditingComment)&&this.commentPane.isInsertingReply&&""!==this.commentPane.currentEditingComment.replyViewTextBox.innerText||!_.isNullOrUndefined(this.commentPane.currentEditingComment)&&!this.commentPane.isInsertingReply&&this.commentPane.currentEditingComment.textArea.innerText!==this.commentPane.currentEditingComment.comment.text?((e=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.owner.locale),this.confirmDialog=C.DialogUtility.confirm({title:e.getConstant("Un-posted comments"),content:e.getConstant("Discard Comment"),okButton:{text:e.getConstant("Discard"),click:this.discardButtonClick.bind(this)},cancelButton:{text:e.getConstant("Cancel"),click:this.closeDialogUtils.bind(this)},showCloseIcon:!0,closeOnEscape:!0,animationSettings:{effect:"Zoom"},position:{X:"center",Y:"center"}})):(this.owner.documentHelper.currentSelectedComment=void 0,this.commentPane.currentEditingComment.cancelEditing(),this.owner.showComments=!1):(this.owner.showComments=!1,this.owner.documentHelper.currentSelectedComment=void 0,this.owner.documentHelper.currentSelectedRevision=void 0,this.owner.notify("reviewPane",{changes:!1,comment:!1,isUserClosed:!0}))},ku.prototype.discardButtonClick=function(){this.commentPane.currentEditingComment&&(this.isNewComment,this.commentPane.currentEditingComment&&this.commentPane.isInsertingReply?this.commentPane.currentEditingComment.cancelReply():this.commentPane.currentEditingComment.cancelEditing(),this.owner.documentHelper.currentSelectedComment=void 0,this.closeDialogUtils(),this.owner.showComments=!1)},ku.prototype.closeDialogUtils=function(){this.confirmDialog.close(),this.confirmDialog=void 0},ku.prototype.initToolbar=function(e){return this.toolbarElement=_.createElement("div"),this.toolbar=new k.Toolbar({items:[{prefixIcon:"e-de-new-cmt e-de-cmt-tbr",tooltipText:e.getConstant("New Comment"),text:e.getConstant("New Comment"),click:this.insertComment.bind(this)},{prefixIcon:"e-de-nav-left-arrow e-de-cmt-tbr",align:"Right",tooltipText:e.getConstant("Previous Comment"),click:this.navigatePreviousComment.bind(this)},{prefixIcon:"e-de-nav-right-arrow e-de-cmt-tbr",align:"Right",tooltipText:e.getConstant("Next Comment"),click:this.navigateNextComment.bind(this)}],enableRtl:this.owner.enableRtl}),this.toolbar.appendTo(this.toolbarElement),this.toolbarElement},ku.prototype.insertComment=function(){this.owner&&this.owner.editorModule&&(this.owner.editorModule.isUserInsert=!0,this.owner.editorModule.insertComment(""),this.owner.editorModule.isUserInsert=!1)},ku.prototype.addComment=function(e,t,i){this.isNewComment=t,this.selectReviewTab("Comments"),this.owner.documentHelper.currentSelectedComment=e,this.commentPane.insertComment(e),t||(this.commentPane.comments.get(e).cancelEditing(),this.enableDisableToolbarItem()),i&&this.selectComment(e)},ku.prototype.deleteComment=function(e){this.commentPane&&this.commentPane.deleteComment(e)},ku.prototype.selectComment=function(e){this.commentPane.isEditMode||(e.isReply&&(e=e.ownerComment),this.owner&&this.owner.viewer&&this.owner.documentHelper.currentSelectedComment!==e&&(this.owner.documentHelper.currentSelectedComment=e),this.commentPane.selectComment(e))},ku.prototype.resolveComment=function(e){this.commentPane.resolveComment(e)},ku.prototype.reopenComment=function(e){this.commentPane.reopenComment(e)},ku.prototype.addReply=function(e,t,i){this.isNewComment=t,this.postReply=!0,this.commentPane.insertReply(e),this.postReply=!1,t||(this.commentPane.comments.get(e).cancelEditing(),this.enableDisableToolbarItem()),i&&this.selectComment(e.ownerComment)},ku.prototype.navigatePreviousComment=function(){this.owner&&this.owner.editorModule&&this.owner.selectionModule.navigatePreviousComment()},ku.prototype.navigateNextComment=function(){this.owner&&this.owner.editorModule&&this.owner.selectionModule.navigateNextComment()},ku.prototype.enableDisableItems=function(){this.enableDisableToolbarItem();for(var e=this.commentPane.comments.keys,t=0;t<e.length;t++){var i=this.commentPane.comments.get(e[t]);this.owner.isReadOnly?(_.isNullOrUndefined(i.replyViewTextBox)||(i.replyViewTextBox.style.display="none"),i.menuBar.style.display="none",i.resolveView&&(i.resolveView.style.display="none")):(_.isNullOrUndefined(i.replyViewTextBox)||(i.replyViewTextBox.style.display="block"),i.menuBar.style.display="block",i.resolveView&&(i.resolveView.style.display=""))}},ku.prototype.enableDisableToolbarItem=function(){var e,t;this.toolbar&&(e=!0,this.commentPane.isEditMode&&(e=!this.commentPane.isEditMode),this.owner.isReadOnly&&(e=!this.owner.isReadOnly),t=this.toolbar.element.querySelectorAll(".e-de-cmt-tbr"),this.toolbar.enableItems(t[0].parentElement.parentElement,e),e&&this.owner&&this.owner.viewer&&(e=!(0===this.owner.documentHelper.comments.length)),this.toolbar.enableItems(t[1].parentElement.parentElement,e),this.toolbar.enableItems(t[2].parentElement.parentElement,e))},ku.prototype.initCommentPane=function(){this.commentPane=new Fu(this.owner,this),this.commentPane.initCommentPane()},ku.prototype.layoutComments=function(){for(var e=0;e<this.owner.documentHelper.comments.length;e++){var t=this.owner.documentHelper.comments[e];if(this.isUnreferredComment(t))this.owner.documentHelper.comments.splice(e,1),e--;else{for(var i=0;i<t.replyComments.length;i++)this.isUnreferredComment(t.replyComments[i])&&(t.replyComments.splice(i,1),i--);this.commentPane.addComment(t)}}},ku.prototype.isUnreferredComment=function(e){return!(!_.isNullOrUndefined(e.commentStart)&&!_.isNullOrUndefined(e.commentEnd))},ku.prototype.clear=function(){this.previousSelectedCommentInt=void 0,this.isNewComment=!1,this.isUserClosed=!1,this.isNewComment=!1,this.commentPane.clear()},ku.prototype.discardComment=function(e){e&&(this.owner.editorHistoryModule?(0<this.owner.editorHistoryModule.undoStack.length&&"InsertComment"===this.owner.editorHistoryModule.undoStack[this.owner.editorHistoryModule.undoStack.length-1].action&&(this.owner.editorHistoryModule.undo(),this.owner.editorHistoryModule.redoStack.pop()),this.owner.editorModule.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.owner.editorModule.deleteCommentInternal(e),this.owner.editorModule.isSkipOperationsBuild=!1):this.owner.editorModule&&this.owner.editorModule.deleteCommentInternal(e))},ku.prototype.destroy=function(){this.commentPane&&this.commentPane.destroy(),this.commentPane=void 0,this.toolbar&&this.toolbar.destroy(),this.toolbar=void 0,this.toolbarElement&&this.toolbarElement.parentElement&&this.toolbarElement.parentElement.removeChild(this.toolbarElement),this.toolbarElement=void 0,this.headerContainer&&this.headerContainer.parentElement&&this.headerContainer.parentElement.removeChild(this.headerContainer),this.headerContainer=void 0,this.previousSelectedCommentInt=void 0,this.reviewPane&&this.reviewPane.parentElement&&this.reviewPane.parentElement.removeChild(this.reviewPane),this.owner.isDestroyed||this.owner.off("reviewPane",this.reviewPaneHelper),_.isNullOrUndefined(this.reviewTab)||this.reviewTab.destroy(),this.reviewTab=void 0,_.isNullOrUndefined(this.confirmDialog)||this.confirmDialog.destroy(),this.confirmDialog=void 0,_.isNullOrUndefined(this.previousSelectedCommentInt)||this.previousSelectedCommentInt.destroy(),this.previousSelectedCommentInt=void 0,this.reviewPane&&(this.reviewPane.innerHTML="",this.reviewPane.parentElement)&&this.reviewPane.parentElement.removeChild(this.reviewPane),this.reviewPane=void 0,this.parentPaneElement&&(this.parentPaneElement.innerHTML="",this.parentPaneElement.parentElement)&&this.parentPaneElement.parentElement.removeChild(this.parentPaneElement),this.parentPaneElement=void 0,this.owner=void 0};var Iu=ku;function ku(e){var t=this,e=(this.isNewComment=!1,this.isUserClosed=!1,this.postReply=!1,this.selectedTab=0,this.onTabSelection=function(e){e.preventFocus=!0,t.selectedTab=e.selectedIndex,(1===t.selectedTab?t.owner.trackChangesPane:t.commentPane).updateHeight(),setTimeout(function(){t.owner&&t.owner.resize()},10)},this.owner=e,new _.L10n("documenteditor",this.owner.defaultLocale));e.setLocale(this.owner.locale),this.initReviewPane(e),this.parentPaneElement.style.display="none"}Object.defineProperty(Pu.prototype,"isEditMode",{get:function(){return this.isEditModeInternal},set:function(e){this.isEditModeInternal=e;for(var t=this.comments.keys,i=0;i<t.length;i++){var n=this.comments.get(t[i]);e?n.menuBar.style.display="none":n.comment.isReply||(n.menuBar.style.display="block")}this.parentPane&&this.parentPane.enableDisableToolbarItem(),this.owner&&(this.isEditModeInternal?this.owner.trigger(ue):this.owner.trigger(ge))},enumerable:!0,configurable:!0}),Pu.prototype.initCommentPane=function(){this.commentPane=_.createElement("div",{className:"e-de-cmt-container e-de-scrollbar-hide"});var e=new _.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.noCommentIndicator=_.createElement("div",{className:"e-de-cmt-no-cmt",innerHTML:e.getConstant("No comments in this document")}),this.commentPane.appendChild(this.noCommentIndicator),this.parent.appendChild(this.commentPane)},Pu.prototype.addComment=function(e){var t=new Tu(this.owner,this,e),i=t.layoutComment(!1);this.comments.add(e,t),this.commentPane.appendChild(i);for(var n=0;n<e.replyComments.length;n++){var r=new Tu(this.owner,this,e.replyComments[n]);this.comments.add(e.replyComments[n],r),i.insertBefore(r.layoutComment(!0),t.replyViewContainer)}this.updateCommentStatus(),t.hideDrawer()},Pu.prototype.updateHeight=function(){var e=this.parentPane.reviewTab.getRootElement().getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height;this.commentPane.style.height=this.parentPane.parentPaneElement.clientHeight-this.parentPane.headerContainer.clientHeight-e+"px"},Pu.prototype.insertReply=function(e){var t=e.ownerComment,i=this.comments.get(t),n=new Tu(this.owner,this,e),r=(this.comments.add(e,n),n.layoutComment(!0)),e=t.replyComments.indexOf(e);e===t.replyComments.length-1?i.parentElement.insertBefore(r,i.replyViewContainer):(t=t.replyComments[e+1],i.parentElement.insertBefore(r,this.comments.get(t).parentElement)),n.editComment()},Pu.prototype.insertComment=function(e){var t=new Tu(this.owner,this,e),i=t.layoutComment(!1);this.comments.add(e,t),this.owner.documentHelper.comments.indexOf(e)===this.owner.documentHelper.comments.length-1?this.commentPane.appendChild(i):(e=this.owner.documentHelper.comments.indexOf(e),e=this.comments.get(this.owner.documentHelper.comments[e+1]).parentElement,this.commentPane.insertBefore(i,e),i.focus()),this.updateCommentStatus(),t.editComment()},Pu.prototype.removeSelectionMark=function(e){if(this.parent)for(var t=this.parent.getElementsByClassName(e),i=0;i<t.length;i++)_.classList(t[i],[],[e])},Pu.prototype.selectComment=function(e){var t,i;this.removeSelectionMark("e-de-cmt-selection"),(e=e.isReply?e.ownerComment:e)&&(this.owner.notify("reviewPane",{comment:!0,changes:this.owner.trackChangesPane.isChangesTabVisible}),(i=(t=this.comments.get(e)).parentElement)&&(_.classList(i,["e-de-cmt-selection"],[]),i.focus()),(i=this.getCommentStart(e)).commentMark||i.renderCommentMark(),_.classList(i.commentMark,["e-de-cmt-mark-selected"],[]),t.showDrawer())},Pu.prototype.getCommentStart=function(e){var t=new _.L10n("documenteditor",this.owner.defaultLocale),i=(t.setLocale(this.owner.locale),void 0);return void 0!==(i=e&&e.commentStart?e.commentStart:i).commentMark&&(i.commentMark.title=t.getConstant("Click to see this comment")),this.getFirstCommentInLine(i)},Pu.prototype.getFirstCommentInLine=function(e){for(var t=0;t<e.line.children.length;t++){var i=e.line.children[t];if(i instanceof up&&0===i.commentType)return i}return e},Pu.prototype.deleteComment=function(e){var t=this.comments.get(e);if(!_.isNullOrUndefined(t)){_.isNullOrUndefined(this.currentEditingComment)||t.comment.commentId!=this.currentEditingComment.comment.commentId||(this.isEditMode=!1,this.currentEditingComment=void 0),t.parentElement&&t.parentElement.parentElement&&t.parentElement.parentElement.removeChild(t.parentElement);for(var i=0;i<e.replyComments.length;i++){var n=e.replyComments[i];this.comments.containsKey(n)&&this.comments.remove(n)}this.comments.remove(e),t.destroy()}this.updateCommentStatus()},Pu.prototype.resolveComment=function(e){e=this.comments.get(e);e&&e.resolveComment()},Pu.prototype.reopenComment=function(e){e=this.comments.get(e);e&&e.reopenComment()},Pu.prototype.updateCommentStatus=function(){0===this.owner.documentHelper.comments.length?(this.noCommentIndicator.parentElement||this.commentPane.appendChild(this.noCommentIndicator),this.noCommentIndicator.style.display="block",this.parentPane.isCommentTabVisible=!1,this.owner.notify("reviewPane",{comment:!1,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.parentPane.reviewTab.hideTab(0)):this.owner.showComments&&(this.parentPane.isCommentTabVisible=!0,this.noCommentIndicator.style.display="none",this.owner.notify("reviewPane",{comment:!0,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.parentPane.reviewTab.hideTab(0,!1)),this.parentPane&&this.parentPane.enableDisableToolbarItem()},Pu.prototype.clear=function(){this.isEditMode=!1,this.currentEditingComment=void 0,this.isInsertingReply=!1,this.removeChildElements(),this.commentPane.innerHTML="",this.updateCommentStatus()},Pu.prototype.removeChildElements=function(){for(var e=this.comments.keys,t=0;t<e.length;t++)this.comments.get(e[t]).destroy();this.comments.clear()},Pu.prototype.destroy=function(){this.removeChildElements(),this.noCommentIndicator&&this.noCommentIndicator&&this.noCommentIndicator.parentElement.removeChild(this.noCommentIndicator),this.noCommentIndicator=void 0,this.commentPane&&(this.commentPane.innerHTML="",this.commentPane.parentElement)&&this.commentPane.parentElement.removeChild(this.commentPane),this.commentPane=void 0,this.parent&&(this.parent.innerHTML="",this.parent.parentElement)&&this.parent.parentElement.removeChild(this.parent),this.parent=void 0,this.parentPane=void 0,this.currentEditingComment=void 0,this.owner=void 0};var Fu=Pu;function Pu(e,t){this.isEditModeInternal=!1,this.isInsertingReply=!1,this.owner=e,this.parentPane=t,this.parent=t.reviewPane,this.comments=new T}Su.prototype.layoutComment=function(e){var t="e-de-cmt-sub-container",e=((this.isReply=e)&&(t+=" e-de-cmt-reply"),new _.L10n("documenteditor",this.owner.defaultLocale));return e.setLocale(this.owner.locale),this.parentElement=_.createElement("div",{className:t}),this.initCommentHeader(e),this.initCommentView(e),this.initDateView(),this.comment.isReply?this.menuBar.style.display="none":(this.parentElement.tabIndex=0,this.initReplyView(e),this.initResolveOption(e),this.initDrawer(),this.comment.isResolved&&this.resolveComment()),this.commentView.addEventListener("mouseenter",this.showMenuItems.bind(this)),this.commentView.addEventListener("mouseleave",this.hideMenuItemOnMouseLeave.bind(this)),this.parentElement},Su.prototype.initCommentHeader=function(e){var t=_.createElement("div",{className:"e-de-cmt-view"}),i=(this.resolveDiv=_.createElement("div",{className:"e-de-cmt-view"}),_.createElement("div",{className:"e-de-cmt-view"})),n=_.createElement("div",{className:"e-de-resolve-mark"}),r=_.createElement("span",{className:"e-de e-icons e-check"}),o=_.createElement("span",{className:""}),r=(o.innerHTML="Resolved",r.style.display="inline-block",n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center",n.style.width="20px",n.style.height="20px",n.style.borderRadius="100%",n.style.marginRight="6px",n.appendChild(r),i.appendChild(n),i.appendChild(o),this.resolveDiv.appendChild(i),i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",this.resolveDiv.style.display="none",_.createElement("div",{className:"e-de-cmt-author"})),n=(r.style.marginTop="8px",_.createElement("div",{className:"e-de-cmt-author-name"})),o=(n.textContent=this.comment.author,_.isNullOrUndefined(this.comment.author)||(r.style.display="flex",this.owner.documentHelper.getAvatar(r,n,this.comment,void 0)),this.menuBar=_.createElement("button",{className:"e-de-cp-option",attrs:{type:"button"}}),[{text:e.getConstant("Edit")},{text:e.getConstant("Delete")},{text:e.getConstant("Reply")},{text:e.getConstant("Resolve")}]),i=new w.DropDownButton({items:this.isReply?o.splice(0,2):o,select:this.userOptionSelectEvent.bind(this),iconCss:"e-de-menu-icon",cssClass:"e-caret-hide",enableRtl:this.owner.enableRtl});this.menuBar.title=e.getConstant("More Options")+"...",i.appendTo(this.menuBar),r.appendChild(this.menuBar),this.dropDownButton=i,t.appendChild(r),this.commentView=t,this.parentElement.appendChild(t),t.addEventListener("click",this.selectComment.bind(this))},Su.prototype.selectComment=function(){var e;this.commentPane&&(this.commentPane.isEditMode?this.commentPane.isEditMode&&this.commentPane.isInsertingReply&&this.commentPane.currentEditingComment&&""===this.commentPane.currentEditingComment.replyViewTextBox.innerText&&((e=(e=this.comment)&&e.isReply?this.comment.ownerComment:e)&&this.owner.documentHelper.currentSelectedComment===e||(this.commentPane.currentEditingComment.cancelReply(),this.owner.selectionModule.selectComment(this.comment))):this.owner.selectionModule.selectComment(this.comment))},Su.prototype.initCommentView=function(e){this.commentText=_.createElement("div",{className:"e-de-cmt-readonly e-mention"}),this.commentText.innerHTML=this.comment.text,this.commentView.appendChild(this.commentText),this.initEditView(e)},Su.prototype.initEditView=function(e){var t=this,i=(this.textAreaContainer=_.createElement("div",{styles:"display:none"}),this.textArea=_.createElement("div",{className:"e-de-cmt-textarea e-input"}),this.textArea.addEventListener("paste",function(e){t.updatePastedText(e,t.textArea)}),this.textArea.style.borderWidth="0 0 2px 0",this.textArea.setAttribute("placeholder",e.getConstant("Type your comment here")),this.editMention=new U.Mention({dataSource:this.owner.documentEditorSettings.mentionSettings.dataSource,fields:this.owner.documentEditorSettings.mentionSettings.fields,select:this.onSelect.bind(this)}),this.textArea.innerHTML=this.comment.text,this.textArea.addEventListener("keydown",this.updateTextAreaHeight.bind(this)),this.textArea.addEventListener("keyup",this.enableDisablePostButton.bind(this)),_.createElement("div",{className:"e-de-cmt-action-button"})),n=_.createElement("button",{className:"e-de-cmt-post-btn e-btn e-flat",attrs:{type:"button"}}),r=(this.postButton=new H.Button({cssClass:"e-btn e-flat e-primary e-de-overlay",iconCss:"e-de-cmt-post",disabled:!0},n),n.addEventListener("click",this.postComment.bind(this)),n.title=e.getConstant("Post"),n.setAttribute("aria-label",e.getConstant("Post")),_.createElement("button",{className:"e-de-cmt-cancel-btn e-btn e-flat",attrs:{type:"button"}}));this.cancelButton=new H.Button({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-cancel"},r),r.title=e.getConstant("Cancel"),r.setAttribute("aria-label",e.getConstant("Cancel")),r.addEventListener("click",this.cancelEditing.bind(this)),i.appendChild(n),i.appendChild(r),i.style.marginTop="8px",this.textAreaContainer.appendChild(this.textArea),this.textAreaContainer.appendChild(i),this.commentView.appendChild(this.textAreaContainer),this.editMention.appendTo(this.textArea)},Su.prototype.updatePastedText=function(e,t){e.preventDefault();var e=e.clipboardData.getData("text/plain");e&&(e=this.convertToHtml(e),t.innerHTML=t.innerHTML+e),this.enableDisableReplyPostButton()},Su.prototype.convertToHtml=function(e){return e.split(/(?:\r?\n|\r)/).map(function(e){return e?"<div>"+e+"</div>":"<div><br></div>"}).join("")},Su.prototype.onSelect=function(e){this.owner.documentEditorSettings.mentionSettings.fields;var t={},e=e.itemData;t.text=e[this.owner.documentEditorSettings.mentionSettings.fields.text],t.value=e[this.owner.documentEditorSettings.mentionSettings.fields.value],this.itemData.push(t)},Su.prototype.initDateView=function(){this.commentDate=_.createElement("div",{className:"e-de-cmt-date"}),this.commentDate.innerText=j.getModifiedDate(this.comment.date),this.commentView.appendChild(this.commentDate)},Su.prototype.initDrawer=function(){this.drawerElement=_.createElement("div",{styles:"display:none;",className:"e-de-cmt-drawer-cnt"});var e=_.createElement("div",{className:"e-de-cmt-drawer"}),t=_.createElement("span");e.appendChild(t),this.drawerElement.appendChild(e),this.drawerSpanElement=t,this.drawerAction=e,this.drawerAction.addEventListener("click",this.showOrHideDrawer.bind(this)),this.parentElement.appendChild(this.drawerElement)},Su.prototype.initReplyView=function(e){var t=this,i=(this.replyViewContainer=_.createElement("div",{className:"e-de-cmt-rply-view"}),this.commentPane.parentPane.isNewComment&&(this.replyViewContainer.style.display="none"),this.replyViewTextBox=_.createElement("div",{className:"e-de-cmt-textarea e-input"}),this.replyViewTextBox.addEventListener("paste",function(e){t.updatePastedText(e,t.replyViewTextBox)}),this.replyViewTextBox.style.borderWidth="0 0 1px 0",this.replyViewTextBox.setAttribute("placeholder",e.getConstant("Reply")),this.replyViewTextBox.addEventListener("click",this.enableReplyView.bind(this)),this.replyViewTextBox.addEventListener("keydown",this.updateReplyTextAreaHeight.bind(this)),this.replyViewTextBox.addEventListener("keyup",this.enableDisableReplyPostButton.bind(this)),_.createElement("div",{styles:"display:none",className:"e-de-cmt-action-button"})),n=_.createElement("button",{className:"e-de-cmt-post-btn e-de-overlay e-btn e-flat",attrs:{type:"button"}}),r=(this.replyPostButton=new H.Button({cssClass:"e-btn e-flat e-primary",iconCss:"e-de-cmt-post",disabled:!0},n),this.replyMention=new U.Mention({dataSource:this.owner.documentEditorSettings.mentionSettings.dataSource,fields:this.owner.documentEditorSettings.mentionSettings.fields,select:this.onSelect.bind(this)}),n.addEventListener("click",this.postReply.bind(this)),n.title=e.getConstant("Post"),_.createElement("button",{className:"e-de-cmt-cancel-btn e-btn e-flat",attrs:{type:"button"}}));r.setAttribute("aria-label",e.getConstant("Cancel")),this.replyCancelButton=new H.Button({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-cancel"},r),r.addEventListener("click",this.cancelReply.bind(this)),r.title=e.getConstant("Cancel"),i.appendChild(n),i.appendChild(r),i.style.marginTop="8px",this.replyFooter=i,this.replyViewContainer.appendChild(this.replyViewTextBox),this.replyViewContainer.appendChild(i),this.parentElement.appendChild(this.replyViewContainer),this.replyMention.appendTo(this.replyViewTextBox)},Su.prototype.initResolveOption=function(e){var t=_.createElement("div",{className:"e-de-cmt-resolve-btn"}),i=_.createElement("div",{className:"e-de-cmt-resolve-btn"}),n=_.createElement("div",{className:"e-de-cmt-resolve-btn"}),r=_.createElement("button",{className:"e-de-cmt-post-btn e-btn e-flat",attrs:{type:"button"}}),o=(this.reopenButton=new H.Button({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-reopen"},r),r.title=e.getConstant("Reopen"),r.setAttribute("aria-label",e.getConstant("Reopen")),r.addEventListener("click",this.reopenButtonClick.bind(this)),_.createElement("button",{className:"e-de-cmt-cancel-btn e-btn e-flat",attrs:{type:"button"}}));o.title=e.getConstant("Delete"),o.setAttribute("aria-label",e.getConstant("Delete")),this.deleteButton=new H.Button({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-delete"},o),o.addEventListener("click",this.deleteComment.bind(this)),t.appendChild(r),t.appendChild(o),i.appendChild(this.resolveDiv),n.appendChild(r),n.appendChild(o),t.appendChild(i),i.appendChild(n),i.style.display="flex",i.style.justifyContent="space-between",i.style.alignItems="center",n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center",n.style.marginTop="0px",this.resolveView=t,this.parentElement.appendChild(t)},Su.prototype.reopenButtonClick=function(){this.owner.editorModule.reopenComment(this.comment)},Su.prototype.deleteComment=function(){var e={author:this.comment.author,cancel:!1},e=(this.owner.trigger(fe,e),{author:this.comment.author,cancel:e.cancel,type:"Delete",mentions:this.comment.mentions});this.owner.trigger(me,e),e.cancel||this.owner.editorModule.deleteCommentInternal(this.comment)},Su.prototype.updateReplyTextAreaHeight=function(e){var t=this;e&&this.preventKeyboardShortcuts(e),setTimeout(function(){var e;_.isNullOrUndefined(t.replyViewTextBox)||(t.replyViewTextBox.style.height="auto",e=t.replyViewTextBox.scrollHeight,t.replyViewTextBox.style.height=e+"px")})},Su.prototype.preventKeyboardShortcuts=function(e){var t=e.which||e.keyCode,i=!(!e.ctrlKey&&!e.metaKey)||17===t,n=e.shiftKey||16===t,r=e.altKey||18===t,r=i&&66===t||i&&73===t||i&&85===t||r&&n&&53===t||i&&190===t||i&&188===t||i&&n&&76===t||i&&n&&55===t||i&&220===t||i&&n&&76===t||i&&n&&69===t||i&&n&&82===t||i&&n&&74===t||n&&9===t||i&&r&&49<=t&&t<=54||i&&n&&81===t?!0:!1;r&&(e.preventDefault(),e.stopPropagation())},Su.prototype.enableDisableReplyPostButton=function(){this.replyPostButton.disabled=""===this.replyViewTextBox.innerText,this.replyPostButton.disabled?_.classList(this.replyPostButton.element,["e-de-overlay"],[]):this.replyPostButton.element.classList.contains("e-de-overlay")&&_.classList(this.replyPostButton.element,[],["e-de-overlay"])},Su.prototype.enableReplyView=function(){var e=this,t={author:this.comment.author,cancel:!1,type:"Reply",mentions:this.comment.mentions};this.owner.trigger(me,t),t.cancel&&"Reply"===t.type||this.commentPane.isEditMode||((this.commentPane.currentEditingComment=this).commentPane.isInsertingReply=!0,this.owner.documentHelper.currentSelectedComment!==this.comment&&this.owner.selectionModule.selectComment(this.comment),this.commentPane.isEditMode=!0,this.replyFooter.style.display="block",setTimeout(function(){e.replyViewTextBox.focus()}))},Su.prototype.postReply=function(){var e=this.replyViewTextBox.innerHTML;this.cancelReply(),this.updateReplyTextAreaHeight(),this.owner.editorModule.replyComment(this.comment,e,this.itemData),this.owner.editorModule.isSkipOperationsBuild||this.owner.editorModule.isRemoteAction||this.owner.fireContentChange(),this.owner.editorModule.isSkipOperationsBuild=!1},Su.prototype.cancelReply=function(){this.commentPane.currentEditingComment=void 0,this.commentPane.isInsertingReply=!0,this.commentPane.isEditMode=!1,this.replyPostButton.disabled=!0,this.replyViewTextBox.innerText="",this.replyFooter.style.display="none"},Su.prototype.updateTextAreaHeight=function(e){var t=this;e&&this.preventKeyboardShortcuts(e),setTimeout(function(){var e;_.isNullOrUndefined(t.textArea)||(t.textArea.style.height="auto",e=t.textArea.scrollHeight,t.textArea.style.height=e+"px")})},Su.prototype.showMenuItems=function(){!this.comment.isReply||this.owner.isReadOnly||this.commentPane.isEditMode||_.isNullOrUndefined(this.comment)||this.comment.isResolved||(this.menuBar.style.display="block");var e=this.commentPane.getCommentStart(this.comment);_.isNullOrUndefined(e)||_.isNullOrUndefined(e.commentMark)||e.commentMark.classList.add("e-de-cmt-mark-hover")},Su.prototype.hideMenuItemOnMouseLeave=function(){var e;this.comment.isReply&&this.owner.documentHelper.currentSelectedComment!==this.comment.ownerComment&&this.hideMenuItems(),this.commentPane&&(e=this.commentPane.getCommentStart(this.comment),_.isNullOrUndefined(e)||_.isNullOrUndefined(e.commentMark)||e.commentMark.classList.remove("e-de-cmt-mark-hover"))},Su.prototype.hideMenuItems=function(){this.menuBar.style.display="none"},Su.prototype.enableDisablePostButton=function(){this.postButton.disabled=""===this.textArea.innerText,this.postButton.disabled?_.classList(this.postButton.element,["e-de-overlay"],[]):this.postButton.element.classList.contains("e-de-overlay")&&_.classList(this.postButton.element,[],["e-de-overlay"])},Su.prototype.editComment=function(){var e=this;if(!_.isNullOrUndefined(this.commentPane.parentPane)&&!this.commentPane.parentPane.postReply){var t={author:this.comment.author,cancel:!1,type:"Edit",mentions:this.comment.mentions};if(this.owner.trigger(me,t),t.cancel&&"Edit"===t.type)return}(this.commentPane.currentEditingComment=this).commentPane.isInsertingReply=!1,this.commentPane.isEditMode=!0,this.commentText.style.display="none",this.textAreaContainer.style.display="block",this.commentDate.style.display="none",this.menuBar.style.display="none",this.updateTextAreaHeight(),setTimeout(function(){e.textArea&&e.textArea.focus()})},Su.prototype.resolveComment=function(){_.classList(this.parentElement,["e-de-cmt-resolved"],[]),this.resolveDiv.style.display="inline";var e=new _.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.dropDownButton.items=[{text:e.getConstant("Reopen")},{text:e.getConstant("Delete")}]},Su.prototype.reopenComment=function(){_.classList(this.parentElement,[],["e-de-cmt-resolved"]),this.resolveDiv.style.display="none";var e=new _.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.dropDownButton.items=[{text:e.getConstant("Edit")},{text:e.getConstant("Delete")},{text:e.getConstant("Reply")},{text:e.getConstant("Resolve")}],this.showDrawer()},Su.prototype.postComment=function(){this.itemData&&(this.comment.mentions=this.itemData,this.itemData=[]);var e,t={author:this.comment.author,cancel:!1,type:"Post",text:this.textArea.innerText,mentions:this.comment.mentions};this.owner.trigger(me,t),t.cancel&&"Post"===t.type||(t=this.textArea.innerHTML,this.owner.editorModule&&""!=this.comment.text&&this.comment.text!=t&&(this.owner.editorModule.initHistory("EditComment"),e={commentId:this.comment.commentId,text:this.comment.text},this.owner.editorHistoryModule.currentBaseHistoryInfo.modifiedProperties.push(e),this.owner.editorHistoryModule.currentBaseHistoryInfo.removedNodes.push(this.comment),this.owner.editorHistoryModule.updateHistory()),this.commentText.innerHTML=t,this.comment.text=t,this.showCommentView(),this.commentPane&&this.commentPane.parentPane&&(this.commentPane.parentPane.isNewComment=!1),_.isNullOrUndefined(this.replyViewContainer)||(this.replyViewContainer.style.display=""),this.owner.editorModule.isSkipOperationsBuild)||this.owner.editorModule.isRemoteAction||this.owner.fireContentChange()},Su.prototype.showCommentView=function(){this.commentPane.isEditMode=!1,this.textAreaContainer.style.display="none",this.commentText.style.display="block",this.commentDate.style.display="block",this.menuBar.style.display="block"},Su.prototype.cancelEditing=function(){var e;this.showCommentView(),this.textArea.innerHTML=this.comment.text.trim(),this.commentPane.parentPane.isNewComment&&(this.commentPane&&this.commentPane.parentPane&&(this.commentPane.parentPane.isNewComment=!1),(e=this.owner).editorModule.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.commentPane.parentPane.discardComment(this.comment),e.editorModule.isSkipOperationsBuild=!1)},Su.prototype.showOrHideDrawer=function(){this.isDrawerExpand?this.hideDrawer():this.showDrawer()},Su.prototype.hideDrawer=function(){if(this.parentElement){var e=new _.L10n("documenteditor",this.owner.defaultLocale),t=(e.setLocale(this.owner.locale),this.parentElement.getElementsByClassName("e-de-cmt-sub-container"));if(1<t.length){for(var i=1;i<t.length;i++)t[i].style.display="none";this.drawerElement.style.display="block",_.classList(this.drawerSpanElement,[],["e-de-nav-up"]),this.drawerSpanElement.innerText="+"+(t.length-1)+" "+e.getConstant("more")+"..."}this.isDrawerExpand=!1}},Su.prototype.showDrawer=function(){if(this.parentElement){var e=this.parentElement.getElementsByClassName("e-de-cmt-sub-container");if(1<e.length){for(var t=0;t<e.length;t++)e[t].style.display="block";this.drawerElement.style.display="block",this.drawerSpanElement.innerText="",_.classList(this.drawerSpanElement,["e-de-nav-up"],[])}this.isDrawerExpand=!0}},Su.prototype.userOptionSelectEvent=function(e){var e=e.item.text,t=new _.L10n("documenteditor",this.owner.defaultLocale);switch(t.setLocale(this.owner.locale),e){case t.getConstant("Edit"):this.editComment();break;case t.getConstant("Reply"):this.enableReplyView();break;case t.getConstant("Delete"):this.deleteComment();break;case t.getConstant("Resolve"):this.owner.editorModule.resolveComment(this.comment);break;case t.getConstant("Reopen"):this.owner.editorModule.reopenComment(this.comment)}},Su.prototype.unwireEvent=function(){this.drawerAction&&this.drawerAction.removeEventListener("click",this.showOrHideDrawer.bind(this)),this.textArea&&(this.textArea.removeEventListener("keydown",this.updateTextAreaHeight.bind(this)),this.textArea.removeEventListener("keyup",this.enableDisablePostButton.bind(this))),this.postButton&&this.postButton.removeEventListener("click",this.postComment.bind(this)),this.cancelButton&&this.cancelButton.removeEventListener("click",this.cancelEditing.bind(this)),this.commentView&&(this.commentView.removeEventListener("click",this.selectComment.bind(this)),this.commentView.removeEventListener("mouseenter",this.showMenuItems.bind(this)),this.commentView.removeEventListener("mouseleave",this.hideMenuItemOnMouseLeave.bind(this)))},Su.prototype.destroy=function(){this.unwireEvent(),this.comment&&(this.comment=void 0),this.dropDownButton&&this.dropDownButton.destroy(),this.dropDownButton=void 0,this.postButton&&this.postButton.destroy(),this.postButton=void 0,this.cancelButton&&this.cancelButton.destroy(),this.cancelButton=void 0,this.replyPostButton&&(this.replyPostButton.destroy(),this.replyPostButton=void 0),this.replyCancelButton&&(this.replyCancelButton.destroy(),this.replyCancelButton=void 0),this.reopenButton&&(this.reopenButton.destroy(),this.reopenButton=void 0),this.deleteButton&&(this.deleteButton.destroy(),this.deleteButton=void 0),this.parentElement&&(this.parentElement.innerHTML="",this.parentElement.parentElement)&&this.parentElement.parentElement.removeChild(this.parentElement),this.parentElement=void 0,this.commentView&&(this.commentView.innerHTML="",this.commentView.parentElement)&&this.commentView.parentElement.removeChild(this.commentView),this.commentView=void 0,this.replyViewContainer=void 0,this.replyViewTextBox=void 0,this.replyFooter=void 0,this.resolveView=void 0,this.menuBar=void 0,this.drawerAction=void 0,this.commentText=void 0,this.commentDate=void 0,this.textAreaContainer=void 0,this.textArea=void 0,this.drawerElement=void 0,this.drawerSpanElement=void 0,this.commentPane=void 0,this.owner=void 0};var Tu=Su;function Su(e,t,i){this.isReply=!1,this.isDrawerExpand=!1,this.itemData=[],this.owner=e,this.comment=i,this.commentPane=t}Nu.prototype.getModuleName=function(){return"HyperlinkDialog"},Nu.prototype.initHyperlinkDialog=function(e,t){this.target=_.createElement("div",{className:"e-de-hyperlink"});var i=_.createElement("div"),n=_.createElement("div",{className:"e-de-dlg-container"}),n=(this.displayTextBox=_.createElement("input",{className:"e-input"}),this.displayTextBox.addEventListener("keyup",this.onKeyUpOnDisplayBox),n.appendChild(this.displayTextBox),i.appendChild(n),this.addressText=_.createElement("div",{className:"e-de-dlg-container"}),this.urlTextBox=_.createElement("input",{className:"e-input",attrs:{autofocus:"true"}}),this.urlTextBox.addEventListener("input",this.onKeyUpOnUrlBox),this.urlTextBox.addEventListener("keyup",this.onKeyUpOnUrlBox),this.addressText.appendChild(this.urlTextBox),i.appendChild(this.addressText),_.createElement("div",{className:"e-de-dlg-container"})),n=(this.screenTipTextBox=_.createElement("input",{className:"e-input"}),this.screenTipTextBox.addEventListener("keyup",this.onScreenTipTextBox),n.appendChild(this.screenTipTextBox),i.appendChild(n),this.bookmarkDiv=_.createElement("div",{styles:"display:none;"}),_.createElement("div",{className:"e-de-dlg-container"})),r=_.createElement("input"),r=(n.appendChild(r),this.bookmarkDropdown=new U.DropDownList({dataSource:[],change:this.onBookmarkchange,noRecordsTemplate:e.getConstant("No bookmarks found"),placeholder:e.getConstant("Bookmark"),floatLabelType:"Always"}),this.bookmarkDropdown.appendTo(r),this.bookmarkDiv.appendChild(n),i.appendChild(this.bookmarkDiv),_.createElement("div")),n=_.createElement("input",{attrs:{type:"checkbox"}});r.appendChild(n),this.bookmarkCheckbox=new H.CheckBox({label:e.getConstant("Use bookmarks"),enableRtl:t,change:this.onUseBookmarkChange}),this.bookmarkCheckbox.appendTo(n),i.appendChild(r),this.target.appendChild(i),new D.TextBox({placeholder:e.getConstant("Text to display"),floatLabelType:"Always"},this.displayTextBox),new D.TextBox({placeholder:e.getConstant("Address"),floatLabelType:"Always"},this.urlTextBox),new D.TextBox({placeholder:e.getConstant("ScreenTip text"),floatLabelType:"Always"},this.screenTipTextBox)},Nu.prototype.show=function(){this.localObj=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localObj.setLocale(this.documentHelper.owner.locale),this.target||this.initHyperlinkDialog(this.localObj,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=this.localObj.getConstant("Insert Hyperlink"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.onInsertButtonClick,buttonModel:{content:this.localObj.getConstant("Ok"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel"),cssClass:"e-flat e-hyper-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.beforeOpen=this.loadHyperlinkDialog,this.documentHelper.dialog.close=this.closeHyperlinkDialog,this.documentHelper.dialog.show()},Nu.prototype.hide=function(){this.closeHyperlinkDialog()},Nu.prototype.enableOrDisableInsertButton=function(){_.isNullOrUndefined(this.insertButton)||(this.bookmarkCheckbox.checked?this.insertButton.disabled=""===this.bookmarkDropdown.value||null==this.bookmarkDropdown.value:this.insertButton.disabled=""===this.urlTextBox.value||""===this.displayTextBox.value)},Nu.prototype.onInsertHyperlink=function(){var e=_.SanitizeHtmlHelper.sanitize(this.displayTextBox.value.trim()),t=this.urlTextBox.value.trim(),i=((j.startsWith(t,"http://")||j.startsWith(t,"https://"))&&(t=_.SanitizeHtmlHelper.sanitize(t.replace(/\s/g,""))),_.SanitizeHtmlHelper.sanitize(this.screenTipTextBox.value.trim())),n=!1;_.isNullOrUndefined(this.bookmarkDropdown.value)||""===this.bookmarkDropdown.value||!0!==this.bookmarkCheckbox.checked||(t=this.bookmarkDropdown.value,n=!0),""===t?this.documentHelper.hideDialog():(""!==i&&(t=t+'"\\o "'+i),e=""===e&&""!==t?t:this.displayTextBox.value,_.isNullOrUndefined(this.navigationUrl)?(i=(this.documentHelper.selection.text!==e||-1===this.documentHelper.selection.text.indexOf("\r"))&&!this.displayTextBox.disabled,this.documentHelper.owner.editorModule.insertHyperlinkInternal(t,e,i,n)):this.documentHelper.owner.editorModule.editHyperlink(this.documentHelper.selection,t,e,n),this.documentHelper.hideDialog(),this.navigationUrl=void 0)},Nu.prototype.clearValue=function(){this.displayTextBox.value="",this.urlTextBox.value="",this.screenTipText="",this.screenTipTextBox.value="",this.displayText="",this.displayTextBox.disabled=!1,this.bookmarks=[]},Nu.prototype.destroy=function(){this.displayTextBox&&(this.displayTextBox.innerHTML="",this.displayTextBox=void 0),this.urlTextBox&&(this.urlTextBox.parentElement.removeChild(this.urlTextBox),this.urlTextBox=void 0),this.screenTipTextBox&&(this.screenTipTextBox.parentElement.removeChild(this.screenTipTextBox),this.screenTipTextBox=void 0),this.documentHelper=void 0,_.isNullOrUndefined(this.target)||(this.target.parentElement&&this.target.parentElement.removeChild(this.target),this.target.innerHTML="",this.target=void 0)};var Hu=Nu;function Nu(e){var r=this;this.displayText="",this.navigationUrl=void 0,this.screenTipText="",this.bookmarkDropdown=void 0,this.bookmarkCheckbox=void 0,this.bookmarks=[],this.onKeyUpOnUrlBox=function(e){13===e.keyCode?""!==r.displayTextBox.value&&""!==r.urlTextBox.value&&r.onInsertHyperlink():("www."===(e=r.urlTextBox.value).substring(0,4).toLowerCase()&&(r.urlTextBox.value="http://"+e),""===r.displayText&&(r.displayTextBox.value=e),r.enableOrDisableInsertButton())},this.onKeyUpOnDisplayBox=function(){r.displayText=r.displayTextBox.value,r.enableOrDisableInsertButton()},this.onScreenTipTextBox=function(){r.screenTipText=r.screenTipTextBox.value},this.onInsertButtonClick=function(){r.onInsertHyperlink()},this.onCancelButtonClick=function(){r.documentHelper.dialog.hide(),r.clearValue(),r.documentHelper.updateFocus()},this.loadHyperlinkDialog=function(){r.documentHelper.updateFocus(),r.bookmarks=[];for(var e=0;e<r.documentHelper.bookmarks.keys.length;e++){var t=r.documentHelper.bookmarks.keys[parseInt(e.toString(),10)];0!==t.indexOf("_")&&r.bookmarks.push(t)}var i,n=r.documentHelper.selection.getHyperlinkField();_.isNullOrUndefined(n)?(r.displayText=r.documentHelper.selection.getText(!0),""!==r.displayText&&(-1!==r.displayText.indexOf(String.fromCharCode(65532))||-1!==r.displayText.indexOf("\r")&&-1!==r.displayText.lastIndexOf("\r")&&-1!==r.displayText.slice(0,-1).indexOf("\r")?(r.displayTextBox.value="<<Selection in document>>",r.displayTextBox.disabled=!0):r.displayTextBox.value=r.displayText)):(_.isNullOrUndefined(n.fieldSeparator)||(i=r.documentHelper.selection.getHyperlinkDisplayText(n.fieldSeparator.line.paragraph,n.fieldSeparator,n.fieldEnd,!1,void 0),r.displayText=i.displayText,r.displayTextBox.disabled=i.isNestedField),r.displayTextBox.value=r.displayText,r.screenTipTextBox.value=r.documentHelper.selection.getLinkText(n,!1),i=r.documentHelper.selection.getLinkText(n,!0),r.urlTextBox.value=r.navigationUrl=i,r.documentHelper.dialog.header=r.localObj.getConstant("Edit Hyperlink")),r.bookmarkDiv.style.display="none",r.addressText.style.display="block",r.urlTextBox.style.display="block",r.bookmarkCheckbox.checked=!1,r.bookmarkDropdown.dataSource=r.documentHelper.bookmarks.keys,r.insertButton=document.getElementsByClassName("e-hyper-insert")[0],r.enableOrDisableInsertButton(),r.urlTextBox.focus(),"none"!==r.documentHelper.selection.caret.style.display&&(r.documentHelper.selection.caret.style.display="none")},this.closeHyperlinkDialog=function(){r.clearValue(),r.documentHelper.updateFocus()},this.onUseBookmarkChange=function(e){e.checked?(r.bookmarkDiv.style.display="block",r.bookmarkDropdown.dataSource=r.bookmarks,r.addressText.style.display="none",r.urlTextBox.style.display="none"):(r.bookmarkDiv.style.display="none",r.addressText.style.display="block",r.urlTextBox.style.display="block"),r.enableOrDisableInsertButton()},this.onBookmarkchange=function(){""!==r.bookmarkDropdown.value&&(r.insertButton.disabled=!1)},this.documentHelper=e}Ou.prototype.getModuleName=function(){return"TableDialog"},Ou.prototype.initTableDialog=function(e){this.target=_.createElement("div",{className:"e-de-insert-table"});var t=_.createElement("div"),i=_.createElement("div",{className:"e-de-container-row"}),n=(this.columnsCountBox=_.createElement("input",{attrs:{type:"text"}}),i.appendChild(this.columnsCountBox),this.columnsCountBox.setAttribute("aria-labelledby",e.getConstant("Insert Table")),_.createElement("div"));this.rowsCountBox=_.createElement("input",{attrs:{type:"text"}}),n.appendChild(this.rowsCountBox),t.appendChild(i),t.appendChild(n),this.target.appendChild(t),this.rowValueTextBox=new D.NumericTextBox({format:"#",value:2,min:1,strictMode:!0,enablePersistence:!1,placeholder:e.getConstant("Number of rows"),floatLabelType:"Always"}),this.rowValueTextBox.appendTo(this.rowsCountBox),this.rowsCountBox.setAttribute("aria-labelledby",e.getConstant("Number of rows")),this.columnValueTexBox=new D.NumericTextBox({format:"#",value:2,min:1,strictMode:!0,enablePersistence:!1,placeholder:e.getConstant("Number of columns"),floatLabelType:"Always"}),this.columnsCountBox.setAttribute("aria-labelledby",e.getConstant("Number of columns")),t.setAttribute("aria-labelledby",e.getConstant("Insert Table")),t.setAttribute("aria-describedby",e.getConstant("Insert Table")),this.columnValueTexBox.appendTo(this.columnsCountBox)},Ou.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.localeValue=e,this.target||this.initTableDialog(e),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog.header=e.getConstant("Insert Table"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.onInsertTableClick,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-ok",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cancel"}}],this.rowValueTextBox.value=2,this.columnValueTexBox.value=2,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.columnValueTexBox.focusIn(),this.documentHelper.dialog.show()},Ou.prototype.destroy=function(){if(this.columnsCountBox&&(this.columnsCountBox.parentElement&&this.columnsCountBox.parentElement.removeChild(this.columnsCountBox),this.columnsCountBox=void 0),this.rowsCountBox&&(this.rowsCountBox.parentElement&&this.rowsCountBox.parentElement.removeChild(this.rowsCountBox),this.rowsCountBox=void 0),this.columnValueTexBox&&(this.columnValueTexBox.destroy(),this.columnValueTexBox=void 0),this.rowValueTextBox&&(this.rowValueTextBox.destroy(),this.rowValueTextBox=void 0),this.columnsCountBox=void 0,this.rowsCountBox=void 0,this.documentHelper=void 0,!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}};var Wu=Ou;function Ou(e){var i=this;this.onCancelButtonClick=function(){i.documentHelper.dialog.hide(),i.documentHelper.updateFocus()},this.onInsertTableClick=function(){var e,t;i.columnValueTexBox.value<1||i.columnValueTexBox.value>i.documentHelper.owner.documentEditorSettings.maximumColumns?(e=i.localeValue.getConstant("Number of columns must be between")+" 1 "+i.localeValue.getConstant("and")+" "+i.documentHelper.owner.documentEditorSettings.maximumColumns.toString(),C.DialogUtility.alert(e).enableRtl=i.documentHelper.owner.enableRtl):i.rowValueTextBox.value<1||i.rowValueTextBox.value>i.documentHelper.owner.documentEditorSettings.maximumRows?(e=i.localeValue.getConstant("Number of rows must be between")+" 1 "+i.localeValue.getConstant("and")+" "+i.documentHelper.owner.documentEditorSettings.maximumColumns.toString(),C.DialogUtility.alert(e).enableRtl=i.documentHelper.owner.enableRtl):i.rowValueTextBox.value<=i.documentHelper.owner.documentEditorSettings.maximumRows&&i.columnValueTexBox.value<=i.documentHelper.owner.documentEditorSettings.maximumColumns&&(e=i.rowValueTextBox.value,t=i.columnValueTexBox.value,_.isNullOrUndefined(e)&&_.isNullOrUndefined(t)||i.documentHelper.owner.editorModule.insertTable(e,t),i.documentHelper.hideDialog())},this.documentHelper=e}Lu.prototype.getModuleName=function(){return"BookmarkDialog"},Lu.prototype.initBookmarkDialog=function(e,t,i){var n=this.documentHelper.owner.containerId+"_insert_bookmark",n=(this.target=_.createElement("div",{id:n,className:"e-de-bookmark"}),e.getConstant("Bookmark name")+":"),n=_.createElement("div",{innerHTML:n,className:"e-bookmark-dlgfields"}),n=(this.target.appendChild(n),_.createElement("div",{className:"e-bookmark-common"})),r=(this.target.appendChild(n),_.createElement("div",{className:"e-bookmark-list"})),i=(n.appendChild(r),i&&r.classList.add("e-de-rtl"),_.createElement("div",{className:"e-bookmark-textboxdiv"})),i=(r.appendChild(i),this.textBoxInput=_.createElement("input",{className:"e-input e-bookmark-textbox-input",id:"bookmark_text_box",attrs:{autofocus:"true"}}),this.textBoxInput.setAttribute("type","text"),this.textBoxInput.setAttribute("aria-label",e.getConstant("Bookmark name")),i.appendChild(this.textBoxInput),_.createElement("div",{className:"e-bookmark-listViewDiv",id:"bookmark_listview",attrs:{tabindex:"-1",role:"listbox"}})),r=(i.setAttribute("aria-label",e.getConstant("BookMarkList")),r.appendChild(i),this.listviewInstance=new F.ListView({dataSource:t,cssClass:"e-bookmark-listview"}),void 0===t||0===t.length),t=(this.listviewInstance.appendTo(i),this.listviewInstance.addEventListener("select",this.selectHandler),_.createElement("div",{className:"e-bookmark-button"})),i=(n.appendChild(t),_.createElement("div",{className:"e-bookmark-addbutton"})),n=(t.appendChild(i),_.createElement("button",{innerHTML:e.getConstant("Add"),id:"add",attrs:{type:"button"}})),i=(n.setAttribute("aria-label",e.getConstant("Add")),i.appendChild(n),this.addButton=new H.Button({cssClass:"e-button-custom"}),this.addButton.disabled=!0,this.addButton.appendTo(n),this.textBoxInput.addEventListener("input",this.onKeyUpOnTextBox),this.textBoxInput.addEventListener("keyup",this.onKeyUpOnTextBox),n.addEventListener("click",this.addBookmark),_.createElement("div",{className:"e-bookmark-deletebutton"})),n=(t.appendChild(i),_.createElement("button",{innerHTML:e.getConstant("Delete"),id:"delete",attrs:{type:"button"}})),i=(n.setAttribute("aria-label",e.getConstant("Delete")),i.appendChild(n),this.deleteButton=new H.Button({cssClass:"e-button-custom"}),this.deleteButton.disabled=r,this.deleteButton.appendTo(n),n.addEventListener("click",this.deleteBookmark),_.createElement("div",{className:"e-bookmark-gotobutton"})),n=(t.appendChild(i),_.createElement("button",{innerHTML:e.getConstant("Go To"),id:"goto",attrs:{type:"button"}}));n.setAttribute("aria-label",e.getConstant("Go To")),i.appendChild(n),this.gotoButton=new H.Button({cssClass:"e-button-custom"}),this.gotoButton.disabled=r,this.gotoButton.appendTo(n),n.addEventListener("click",this.gotoBookmark)},Lu.prototype.show=function(){var e=this.documentHelper.getBookmarks(),t=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale),this.initBookmarkDialog(t,e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=t.getConstant("Bookmark"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.removeObjects.bind(this),buttonModel:{content:t.getConstant("Cancel"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}}],this.documentHelper.dialog.dataBind(),void 0!==e&&0!==e.length&&(t=e[0],this.listviewInstance.selectItem(t)),this.documentHelper.dialog.show()},Lu.prototype.enableOrDisableButton=function(){var e=this.textBoxInput.value.trim();_.isNullOrUndefined(this.addButton)||(this.addButton.disabled=!/^[_a-zA-Z0-9]+$/.test(e))},Lu.prototype.focusTextBox=function(e){this.textBoxInput.value=e;var t=document.getElementById("bookmark_text_box");t.setSelectionRange(0,e.length),t.focus(),this.enableOrDisableButton()},Lu.prototype.removeObjects=function(){this.documentHelper.hideDialog()},Lu.prototype.destroy=function(){this.textBoxInput&&(this.textBoxInput.remove(),this.textBoxInput=void 0),this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.documentHelper=void 0};var Eu=Lu;function Lu(e){var t=this;this.onKeyUpOnTextBox=function(){t.enableOrDisableButton()},this.addBookmark=function(){t.documentHelper.owner.editorModule.insertBookmark(_.SanitizeHtmlHelper.sanitize(t.textBoxInput.value)),t.documentHelper.hideDialog()},this.selectHandler=function(e){t.focusTextBox(e.text)},this.gotoBookmark=function(){t.documentHelper.selection.selectBookmark(t.textBoxInput.value)},this.deleteBookmark=function(){t.documentHelper.owner.editorModule.deleteBookmark(t.textBoxInput.value),t.show()},this.documentHelper=e}Ru.prototype.getModuleName=function(){return"TableOfContentsDialog"},Ru.prototype.initTableOfContentDialog=function(e,t){var i=this.documentHelper.owner.containerId,n=(this.target=_.createElement("div",{id:i+"_toc_dialog",className:"e-de-toc-dlg-container"}),_.createElement("div",{id:"general_div",className:"e-de-toc-dlg-sub-container"})),r=(this.target.appendChild(n),_.createElement("div",{id:i+"_genLabel",className:"e-de-toc-dlg-main-heading",styles:"margin-bottom: 13px;",innerHTML:e.getConstant("General")})),r=(n.appendChild(r),_.createElement("div",{className:"e-de-container-row"})),o=_.createElement("div",{className:"e-de-subcontainer-left"}),s=(r.appendChild(o),_.createElement("div",{className:"e-de-subcontainer-right"})),r=(r.appendChild(s),n.appendChild(r),_.createElement("div",{className:"e-de-dlg-row"})),a=_.createElement("div",{className:"e-de-subcontainer-left"}),l=(r.appendChild(a),_.createElement("div",{className:"e-de-subcontainer-right"})),d=(r.appendChild(l),_.createElement("div",{className:"e-de-toc-dlg-sub-container"})),h=_.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_pageNumber"}),c=(d.appendChild(h),_.createElement("div",{className:"e-de-toc-dlg-sub-container"})),p=_.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_rightAlign"}),h=(c.appendChild(p),this.pageNumber=new H.CheckBox({label:e.getConstant("Show page numbers"),enableRtl:t,checked:!0,change:this.changePageNumberValue}),this.rightAlign=new H.CheckBox({label:e.getConstant("Right align page numbers"),enableRtl:t,checked:!0,change:this.changeRightAlignValue}),this.pageNumber.appendTo(h),this.rightAlign.appendTo(p),_.createElement("div",{className:"e-de-container-row"})),p=_.createElement("div",{className:"e-de-subcontainer-left"}),u=_.createElement("div"),g=_.createElement("label",{className:"e-de-toc-dlg-heading",innerHTML:e.getConstant("Tab leader")+":"}),g=(u.appendChild(g),_.createElement("div",{id:"tabLeader_div"})),m=_.createElement("select",{id:i+"_tabLeader",innerHTML:'<option value="None">('+e.getConstant("None").toLocaleLowerCase()+')</option><option value="Dot" selected>....................</option><option value="Hyphen">-------------------</option><option value="Underscore">____________</option>'}),u=(g.appendChild(m),p.appendChild(u),p.appendChild(g),o.appendChild(d),o.appendChild(c),h.appendChild(p),this.tabLeader=new U.DropDownList({enableRtl:t}),this.tabLeader.appendTo(m),_.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_hyperlink"})),g=(s.appendChild(u),this.hyperlink=new H.CheckBox({label:e.getConstant("Use hyperlinks instead of page numbers"),cssClass:"e-de-toc-label",enableRtl:t,checked:!0}),this.hyperlink.appendTo(u),_.createElement("div",{className:"e-de-subcontainer-right"})),d=_.createElement("div",{className:"e-de-toc-dlg-show-level-div"}),o=_.createElement("label",{className:"e-de-toc-dlg-heading",innerHTML:e.getConstant("Show levels")+":"}),c=(d.appendChild(o),_.createElement("div",{className:"e-de-toc-dlg-showlevel-div"})),p=_.createElement("input",{id:i+"_showLevel",attrs:{type:"text","aria-label":"showLevel"}}),m=(c.appendChild(p),g.appendChild(d),g.appendChild(c),h.appendChild(g),n.appendChild(h),this.showLevel=new D.NumericTextBox({format:"#",value:3,min:1,max:9,change:this.changeShowLevelValue.bind(this)}),this.showLevel.appendTo(p),t&&(this.hyperlink.cssClass="e-de-toc-label-rtl",d.classList.add("e-de-rtl"),c.classList.add("e-de-rtl"),l.classList.add("e-de-rtl")),_.createElement("div",{className:"e-de-toc-dlg-main-heading e-de-toc-dlg-build-table",innerHTML:e.getConstant("Build table of contents from")+":"})),s=(n.appendChild(r),_.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_style"})),u=(a.appendChild(m),a.appendChild(s),this.style=new H.CheckBox({label:e.getConstant("Styles"),enableRtl:t,checked:!0,change:this.changeStyleValue}),this.style.appendTo(s),_.createElement("TABLE",{styles:"margin-top:3px;"})),o=_.createElement("tr"),g=_.createElement("td",{styles:"width:120px;padding-left:10px;"}),h=_.createElement("label",{innerHTML:e.getConstant("Available styles"),className:"e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading",id:this.target.id+"_availableLabel"}),p=(g.appendChild(h),_.createElement("td")),d=_.createElement("label",{innerHTML:e.getConstant("TOC level")+":",className:"e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading",id:this.target.id+"_tocLabel"}),c=(p.appendChild(d),o.appendChild(g),o.appendChild(p),u.appendChild(o),_.createElement("div",{id:"table_div",className:"e-de-toc-table-div"})),n=_.createElement("TABLE"),r=_.createElement("tr"),m=_.createElement("td"),s=_.createElement("label",{innerHTML:e.getConstant("Heading")+" 1",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading1Label"}),h=(m.appendChild(s),_.createElement("td")),d=(this.heading1=_.createElement("input",{id:"_heading1",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 1"}}),this.heading1.value="1",this.heading1.addEventListener("keyup",this.changeStyle),h.appendChild(this.heading1),r.appendChild(m),r.appendChild(h),_.createElement("tr")),g=_.createElement("td"),p=_.createElement("label",{innerHTML:e.getConstant("Heading")+" 2",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading2Label"}),o=(g.appendChild(p),_.createElement("td")),s=(this.heading2=_.createElement("input",{id:"_heading2",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 2"}}),this.heading2.value="2",this.heading2.addEventListener("keyup",this.changeStyle),o.appendChild(this.heading2),d.appendChild(g),d.appendChild(o),_.createElement("tr")),m=_.createElement("td"),h=_.createElement("label",{innerHTML:e.getConstant("Heading")+" 3",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading3Label"}),p=(m.appendChild(h),_.createElement("td")),g=(this.heading3=_.createElement("input",{id:"_heading3",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 3"}}),this.heading3.value="3",this.heading3.addEventListener("keyup",this.changeStyle),p.appendChild(this.heading3),s.appendChild(m),s.appendChild(p),_.createElement("tr")),o=_.createElement("td"),h=_.createElement("label",{innerHTML:e.getConstant("Heading")+" 4",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading4Label"}),m=(o.appendChild(h),_.createElement("td")),p=(this.heading4=_.createElement("input",{id:"_heading4",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 4"}}),this.heading4.addEventListener("keyup",this.changeStyle),m.appendChild(this.heading4),g.appendChild(o),g.appendChild(m),_.createElement("tr")),h=_.createElement("td"),o=_.createElement("label",{innerHTML:e.getConstant("Heading")+" 5",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading5Label"}),m=(h.appendChild(o),_.createElement("td")),o=(this.heading5=_.createElement("input",{id:"_heading5",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 5"}}),this.heading5.addEventListener("keyup",this.changeStyle),m.appendChild(this.heading5),p.appendChild(h),p.appendChild(m),_.createElement("tr")),h=_.createElement("td"),m=_.createElement("label",{innerHTML:e.getConstant("Heading")+" 6",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading6Label"}),m=(h.appendChild(m),_.createElement("td")),h=(this.heading6=_.createElement("input",{id:"_heading6",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 6"}}),this.heading6.addEventListener("keyup",this.changeStyle),m.appendChild(this.heading6),o.appendChild(h),o.appendChild(m),_.createElement("tr")),m=_.createElement("td"),f=_.createElement("label",{innerHTML:e.getConstant("Heading")+" 7",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading7Label"}),f=(m.appendChild(f),_.createElement("td")),m=(this.heading7=_.createElement("input",{id:"_heading7",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 7"}}),this.heading7.addEventListener("keyup",this.changeStyle),f.appendChild(this.heading7),h.appendChild(m),h.appendChild(f),_.createElement("tr")),f=_.createElement("td"),y=_.createElement("label",{innerHTML:e.getConstant("Heading")+" 8",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading8Label"}),y=(f.appendChild(y),_.createElement("td")),f=(this.heading8=_.createElement("input",{id:"_heading8",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 8"}}),this.heading8.addEventListener("keyup",this.changeStyle),y.appendChild(this.heading8),m.appendChild(f),m.appendChild(y),_.createElement("tr")),y=_.createElement("td"),v=_.createElement("label",{innerHTML:e.getConstant("Heading")+" 9",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading9Label"}),v=(y.appendChild(v),_.createElement("td")),y=(this.heading9=_.createElement("input",{id:"_heading9",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 9"}}),this.heading9.addEventListener("keyup",this.changeStyle),v.appendChild(this.heading9),f.appendChild(y),f.appendChild(v),_.createElement("tr")),v=_.createElement("td"),w=_.createElement("label",{innerHTML:e.getConstant("Normal"),className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_normalLabel"}),w=(v.appendChild(w),_.createElement("td")),v=(this.normal=_.createElement("input",{id:"_normal",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Normal")}}),this.normal.addEventListener("keyup",this.changeHeadingStyle),w.appendChild(this.normal),y.appendChild(v),y.appendChild(w),t&&(this.normal.classList.add("e-de-rtl"),this.heading1.classList.add("e-de-rtl"),this.heading2.classList.add("e-de-rtl"),this.heading3.classList.add("e-de-rtl"),this.heading4.classList.add("e-de-rtl"),this.heading5.classList.add("e-de-rtl"),this.heading6.classList.add("e-de-rtl"),this.heading7.classList.add("e-de-rtl"),this.heading8.classList.add("e-de-rtl"),this.heading9.classList.add("e-de-rtl")),n.appendChild(r),n.appendChild(d),n.appendChild(s),n.appendChild(g),n.appendChild(p),n.appendChild(o),n.appendChild(h),n.appendChild(m),n.appendChild(f),n.appendChild(y),c.appendChild(n),_.createElement("div",{className:"e-de-toc-styles-table-div"})),w=(v.appendChild(u),v.appendChild(c),a.appendChild(v),_.createElement("div",{id:"fields_div",styles:"display: flex;"})),r=(a.appendChild(w),_.createElement("div",{id:"out_div"})),d=_.createElement("div",{id:"outline_div",className:"e-de-toc-dlg-sub-container e-de-toc-dlg-outline-levels"}),s=_.createElement("input",{attrs:{type:"checkbox"},id:"_outline"}),g=(d.appendChild(s),r.appendChild(d),w.appendChild(r),this.outline=new H.CheckBox({label:e.getConstant("Outline levels"),enableRtl:t,checked:!0,cssClass:"e-de-outline-rtl"}),this.outline.appendTo(s),_.createElement("div",{className:"e-de-toc-reset-button"})),p=(w.appendChild(g),_.createElement("button",{innerHTML:e.getConstant("Reset"),id:"reset",attrs:{type:"button"}}));g.appendChild(p);new H.Button({cssClass:"e-btn e-flat"}).appendTo(p),p.addEventListener("click",this.reset);o=_.createElement("div",{id:i+"_tocStylesLabel",className:"e-de-toc-dlg-main-heading",innerHTML:e.getConstant("Styles")+":"}),l.appendChild(o),h=_.createElement("div"),l.appendChild(h),this.textBoxInput=_.createElement("input",{className:"e-input",attrs:{"aria-label":"Type of TOC"}}),this.textBoxInput.setAttribute("type","text"),h.appendChild(this.textBoxInput),m=_.createElement("div",{className:"e-de-toc-list-view"}),f=this.styleLocaleValue(["TOC 1","TOC 2","TOC 3","TOC 4","TOC 5","TOC 6","TOC 7","TOC 8","TOC 9"],e),this.listViewInstance=new F.ListView({dataSource:f,cssClass:"e-toc-list-view"}),this.listViewInstance.appendTo(m),this.listViewInstance.addEventListener("select",this.selectHandler),l.appendChild(m),y=_.createElement("div",{className:"e-de-toc-modify-button"}),l.appendChild(y),n=_.createElement("button",{innerHTML:e.getConstant("Modify")+"...",id:"modify",attrs:{type:"button"}});y.appendChild(n),new H.Button({cssClass:"e-btn e-flat"}).appendTo(n),n.addEventListener("click",this.showStyleDialog),t&&(g.classList.add("e-de-rtl"),o.classList.add("e-de-rtl"),h.classList.add("e-de-rtl"),m.classList.add("e-de-rtl"),y.classList.add("e-de-rtl"))},Ru.prototype.styleLocaleValue=function(e,t){for(var i=[],n=0;n<e.length;n++)i.push(t.getConstant(e[n]));return i},Ru.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initTableOfContentDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog3.header=e.getConstant("Table of Contents"),this.documentHelper.dialog3.position={X:"center",Y:"center"},this.documentHelper.dialog3.width="auto",this.documentHelper.dialog3.height="auto",this.documentHelper.dialog3.content=this.target,this.documentHelper.dialog3.beforeOpen=this.loadTableofContentDialog,this.documentHelper.dialog3.close=this.closeTableOfContentDialog,this.documentHelper.dialog3.buttons=[{click:this.applyTableOfContentProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-toc-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-toc-cancel"}}],this.documentHelper.dialog3.dataBind(),this.documentHelper.dialog3.show()},Ru.prototype.changeShowLevelValue=function(e){switch(e.value){case 1:this.changeByValue(["1",null,null,null,null,null,null,null,null]);break;case 2:this.changeByValue(["1","2",null,null,null,null,null,null,null]);break;case 3:this.changeByValue(["1","2","3",null,null,null,null,null,null]);break;case 4:this.changeByValue(["1","2","3","4",null,null,null,null,null]);break;case 5:this.changeByValue(["1","2","3","4","5",null,null,null,null]);break;case 6:this.changeByValue(["1","2","3","4","5","6",null,null,null]);break;case 7:this.changeByValue(["1","2","3","4","5","6","7",null,null]);break;case 8:this.changeByValue(["1","2","3","4","5","6","7","8",null]);break;case 9:this.changeByValue(["1","2","3","4","5","6","7","8","9"])}},Ru.prototype.changeByValue=function(e){this.heading1.value=e[0],this.heading2.value=e[1],this.heading3.value=e[2],this.heading4.value=e[3],this.heading5.value=e[4],this.heading6.value=e[5],this.heading7.value=e[6],this.heading8.value=e[7],this.heading9.value=e[8]},Ru.prototype.initAlertDialog=function(e){var t=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),e=(t.setLocale(this.documentHelper.owner.locale),e?t.getConstant("The number must be between"):t.getConstant("The Invalid number"));C.DialogUtility.alert({title:t.getConstant("Information"),content:e,closeOnEscape:!0,showCloseIcon:!0,position:{X:"center",Y:"center"}}).enableRtl=this.documentHelper.owner.enableRtl},Ru.prototype.checkLevel=function(){""!==this.heading1.value&&(this.showLevel.value=1),""!==this.heading2.value&&(this.showLevel.value=2),""!==this.heading3.value&&(this.showLevel.value=3),""!==this.heading4.value&&(this.showLevel.value=4),""!==this.heading5.value&&(this.showLevel.value=5),""!==this.heading6.value&&(this.showLevel.value=6),""!==this.heading7.value&&(this.showLevel.value=7),""!==this.heading8.value&&(this.showLevel.value=8),""!==this.heading9.value&&(this.showLevel.value=9)},Ru.prototype.getElementValue=function(e){switch(e){case this.heading1:return"1";case this.heading2:return"2";case this.heading3:return"3";case this.heading4:return"4";case this.heading5:return"5";case this.heading6:return"6";case this.heading7:return"7";case this.heading8:return"8";case this.heading9:return"9";default:return"1"}},Ru.prototype.getHeadingLevel=function(e){switch(e){case 1:return parseInt(this.heading1.value);case 2:return parseInt(this.heading2.value);case 3:return parseInt(this.heading3.value);case 4:return parseInt(this.heading4.value);case 5:return parseInt(this.heading5.value);case 6:return parseInt(this.heading6.value);case 7:return parseInt(this.heading7.value);case 8:return parseInt(this.heading8.value);case 9:return parseInt(this.heading9.value);default:return 0}},Ru.prototype.applyLevelSetting=function(e){for(var t=0,i=0,n=!(e.levelSettings={}),r=1;r<=e.endLevel;r++){var o=this.getTOCInputValue(r);if(r===(l=this.getHeadingLevel(r))&&o.match(/^[0-9]+$/))0===t&&(t=r,n=!1),n||(i=r);else{if(n=!0,!o.match(/^[0-9]+$/))return this.initAlertDialog(!1),!1;if(l<1||9<l)return this.initAlertDialog(!0),!1;o="Heading "+r.toString();e.levelSettings[o]=l}}if(e.startLevel=t,e.endLevel=i)for(var s=i+1;s<=9;s++){var a=this.getTOCInputValue(s),l=this.getHeadingLevel(s);if(!a.match(/^[0-9]+$/)&&""!==a)return this.initAlertDialog(!1),!1;if(l<1||9<l)return this.initAlertDialog(!0),!1}if(""!==this.normal.value){var d=parseInt(this.normal.value);if(!this.normal.value.match(/^[0-9]+$/))return this.initAlertDialog(!1),!1;if(d<1||9<d)return this.initAlertDialog(!0),!1;e.levelSettings.Normal=d}return!0},Ru.prototype.getTOCInputValue=function(e){switch(e){case 1:return this.heading1.value;case 2:return this.heading2.value;case 3:return this.heading3.value;case 4:return this.heading4.value;case 5:return this.heading5.value;case 6:return this.heading6.value;case 7:return this.heading7.value;case 8:return this.heading8.value;case 9:return this.heading9.value;default:return""}},Ru.prototype.destroy=function(){if(this.pageNumber&&(this.pageNumber.destroy(),this.pageNumber=void 0),this.rightAlign&&(this.rightAlign.destroy(),this.rightAlign=void 0),this.tabLeader&&(this.tabLeader.destroy(),this.tabLeader=void 0),this.showLevel&&(this.showLevel.destroy(),this.showLevel=void 0),this.hyperlink&&(this.hyperlink.destroy(),this.hyperlink=void 0),this.style&&(this.style.destroy(),this.style=void 0),this.outline&&(this.outline.destroy(),this.outline=void 0),this.listViewInstance&&(this.listViewInstance.destroy(),this.listViewInstance=void 0),this.heading1=void 0,this.heading2=void 0,this.heading3=void 0,this.heading4=void 0,this.heading5=void 0,this.heading6=void 0,this.heading7=void 0,this.heading8=void 0,this.heading9=void 0,this.normal=void 0,this.textBoxInput=void 0,this.documentHelper=void 0,!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}};var Bu=Ru;function Ru(e){var n=this;this.loadTableofContentDialog=function(){n.documentHelper.updateFocus(),n.pageNumber.checked=!0,n.rightAlign.disabled=!1,n.rightAlign.checked=!0,n.tabLeader.enabled=!0,n.hyperlink.checked=!0,n.style.checked=!0,n.outline.checked=!0,n.outline.disabled=!1,n.showLevel.enabled=!0},this.closeTableOfContentDialog=function(){n.unWireEventsAndBindings(),n.documentHelper.updateFocus()},this.onCancelButtonClick=function(){n.documentHelper.dialog3.hide(),n.unWireEventsAndBindings(),n.documentHelper.updateFocus()},this.selectHandler=function(e){n.textBoxInput.value=e.text;var t=n.textBoxInput;t.setSelectionRange(0,e.text.length),t.focus()},this.showStyleDialog=function(){_.isNullOrUndefined(n.documentHelper.owner.styleDialogModule)||n.documentHelper.owner.styleDialogModule.show(n.textBoxInput.value)},this.reset=function(){n.showLevel.enabled=!0,n.showLevel.value=3,n.outline.disabled=!1,n.outline.checked=!0;n.changeByValue(["1","2","3",null,null,null,null,null,null]),n.normal.value=null},this.changeStyle=function(e){var t,i=0;_.isNullOrUndefined(e.srcElement.value)||(t=e.srcElement.value,i=parseInt(t),t.match(/^[0-9]+$/)||""===t?i<1||9<i?n.initAlertDialog(!0):t!==n.getElementValue(e.srcElement)&&""!==t?n.showLevel.enabled=!1:(n.showLevel.enabled=!0,n.checkLevel()):n.initAlertDialog(!1))},this.changeHeadingStyle=function(e){var t,i=0;_.isNullOrUndefined(e.srcElement.value)||(t=e.srcElement.value,i=parseInt(t),t.match(/^[0-9]+$/)||""===t?i<1||9<i?n.initAlertDialog(!0):(n.showLevel.enabled=""===t,n.normal===e.srcElement&&(n.outline.checked=!1,n.outline.disabled=!0)):n.initAlertDialog(!1))},this.changePageNumberValue=function(e){e.checked?(n.rightAlign.checked=!0,n.rightAlign.disabled=!1,n.tabLeader.enabled=!0):(n.rightAlign.disabled=!0,n.tabLeader.enabled=!1)},this.changeRightAlignValue=function(e){e.checked?n.tabLeader.enabled=!0:n.tabLeader.enabled=!1},this.changeStyleValue=function(e){e.checked?(n.heading1.disabled=!1,n.heading2.disabled=!1,n.heading3.disabled=!1,n.heading4.disabled=!1,n.heading5.disabled=!1,n.heading6.disabled=!1,n.heading7.disabled=!1,n.heading8.disabled=!1,n.heading9.disabled=!1,n.normal.disabled=!1):(n.heading1.disabled=!0,n.heading2.disabled=!0,n.heading3.disabled=!0,n.heading4.disabled=!0,n.heading5.disabled=!0,n.heading6.disabled=!0,n.heading7.disabled=!0,n.heading8.disabled=!0,n.heading9.disabled=!0,n.normal.disabled=!0)},this.applyTableOfContentProperties=function(){var e={startLevel:1,endLevel:n.showLevel.value,includeHyperlink:n.hyperlink.checked,includePageNumber:n.pageNumber.checked,rightAlign:n.rightAlign.checked,tabLeader:n.tabLeader.value,includeOutlineLevels:n.outline.checked};n.applyLevelSetting(e)&&(n.documentHelper.owner.editorModule.insertTableOfContents(e),n.documentHelper.dialog3.hide(),n.documentHelper.updateFocus())},this.unWireEventsAndBindings=function(){n.pageNumber.checked=!1,n.rightAlign.checked=!1,n.tabLeader&&(n.tabLeader.value=""),n.hyperlink.checked=!1,n.style.checked=!1,n.outline.checked=!1,n.normal&&(n.normal.value="")},this.documentHelper=e}Au.prototype.getModuleName=function(){return"PageSetupDialog"},Au.prototype.initPageSetupDialog=function(e,t){this.target=_.createElement("div");var i=_.createElement("div"),n=(this.target.appendChild(i),this.marginTab=_.createElement("div",{styles:"position: relative;",className:"e-de-dlg-tab-first-child"}),this.paperTab=_.createElement("div",{styles:"position: relative;",className:"e-de-dlg-tab-first-child"}),this.layoutTab=_.createElement("div",{styles:"position: relative;",className:"e-de-dlg-tab-first-child"}),_.createElement("div",{className:"e-de-page-setup-ppty-tab"})),r=_.createElement("div",{className:"e-tab-header"}),o=_.createElement("div",{innerHTML:e.getConstant("Margin")}),s=_.createElement("div",{innerHTML:e.getConstant("Paper")}),a=_.createElement("div",{innerHTML:e.getConstant("Layout")}),r=(r.appendChild(o),r.appendChild(s),r.appendChild(a),_.createElement("div")),l=_.createElement("div"),d=_.createElement("div");r.appendChild(this.marginTab),l.appendChild(this.paperTab),d.appendChild(this.layoutTab),i.appendChild(n),this.initMarginProperties(this.marginTab,e,t),this.initPaperSizeProperties(this.paperTab,e,t),this.initLayoutProperties(this.layoutTab,e,t),new k.Tab({items:[{header:{text:o},content:r},{header:{text:s},content:l},{header:{text:a},content:d}],enableRtl:t},n).isStringTemplate=!0,this.target.addEventListener("keyup",this.keyUpInsertPageSettings)},Au.prototype.initMarginProperties=function(e,t,i){var n=_.createElement("div"),r=_.createElement("div",{className:"e-de-container-row"}),o=(n.appendChild(r),_.createElement("div",{className:"e-de-container-row"})),s=(n.appendChild(o),i&&(r.classList.add("e-de-rtl"),o.classList.add("e-de-rtl")),_.createElement("input",{attrs:{type:"text"}})),a=_.createElement("input",{attrs:{type:"text"}}),l=_.createElement("div",{className:"e-de-subcontainer-left"}),l=(l.appendChild(s),r.appendChild(l),_.createElement("div",{className:"e-de-subcontainer-right"})),r=(l.appendChild(a),r.appendChild(l),_.createElement("input",{attrs:{type:"text"},id:this.target.id+"_left"})),l=_.createElement("input",{attrs:{type:"text"}}),d=_.createElement("div",{className:"e-de-subcontainer-left"}),d=(d.appendChild(r),o.appendChild(d),_.createElement("div",{className:"e-de-subcontainer-right"})),o=(d.appendChild(l),o.appendChild(d),e.appendChild(n),this.topMarginBox=new D.NumericTextBox({value:71,max:1584,min:-1584,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Top")}),this.topMarginBox.appendTo(s),this.leftMarginBox=new D.NumericTextBox({value:73,max:1584,min:0,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Left")}),this.leftMarginBox.appendTo(r),this.bottomMarginBox=new D.NumericTextBox({value:72,max:1584,min:-1584,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Bottom")}),this.bottomMarginBox.appendTo(a),this.rightMarginBox=new D.NumericTextBox({value:74,max:1584,min:0,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Right")}),this.rightMarginBox.appendTo(l),_.createElement("div")),d=_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:t.getConstant("Orientation")}),n=_.createElement("div",{styles:"display: flex;"}),s=(s.setAttribute("aria-labelledby",t.getConstant("Top")),a.setAttribute("aria-labelledby",t.getConstant("Bottom")),r.setAttribute("aria-labelledby",t.getConstant("Left")),l.setAttribute("aria-labelledby",t.getConstant("Right")),_.createElement("div",{id:"_portraitDiv",styles:i?"padding-left: 30px;":"padding-right: 30px;"})),a=_.createElement("input",{attrs:{type:"radiobutton"}}),r=_.createElement("div",{id:"_landscapeDiv"}),l=_.createElement("input",{attrs:{type:"radiobutton"}});s.appendChild(a),r.appendChild(l),n.appendChild(s),n.appendChild(r),o.appendChild(d),o.appendChild(n),this.portrait=new H.RadioButton({label:t.getConstant("Portrait"),checked:!0,enableRtl:i,change:this.onPortrait}),this.landscape=new H.RadioButton({label:t.getConstant("Landscape"),enableRtl:i,change:this.onLandscape}),this.portrait.appendTo(a),this.landscape.appendTo(l),e.appendChild(o),a.setAttribute("aria-label",t.getConstant("Portrait")),l.setAttribute("aria-label",t.getConstant("Landscape"))},Au.prototype.initPaperSizeProperties=function(e,t,i){var n=_.createElement("div",{className:"e-de-container-row"}),r=_.createElement("div",{className:"e-de-subcontainer-left"}),o=(n.appendChild(r),_.createElement("div",{className:"e-de-subcontainer-right"})),s=(n.appendChild(o),i&&(r.classList.add("e-de-rtl"),o.classList.add("e-de-rtl")),_.createElement("input",{attrs:{type:"text"}})),r=(r.appendChild(s),_.createElement("input",{attrs:{type:"text"}})),o=(o.appendChild(r),e.appendChild(n),this.widthBox=new D.NumericTextBox({value:612,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Width")}),this.widthBox.appendTo(s),this.heightBox=new D.NumericTextBox({value:792,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Height")}),this.heightBox.appendTo(r),s.setAttribute("arial-label",t.getConstant("Width")),r.setAttribute("arial-label",t.getConstant("Height")),_.createElement("div")),n=_.createElement("select",{styles:"width:170px;padding-bottom: 20px;",innerHTML:'<option value="letter">'+t.getConstant("Letter")+'</option><option value="tabloid">'+t.getConstant("Tabloid")+'</option><option value="legal">'+t.getConstant("Legal")+'</option><option value="statement">'+t.getConstant("Statement")+'</option><option value="executive">'+t.getConstant("Executive")+'</option><option value="a3">'+t.getConstant("A3")+'</option><option value="a4">'+t.getConstant("A4")+'</option><option value="a5">'+t.getConstant("A5")+'</option><option value="b4">'+t.getConstant("B4")+'</option><option value="b5">'+t.getConstant("B5")+'</option><option value="customsize">'+t.getConstant("Custom Size")+"</option>"});o.appendChild(n),this.paperSize=new U.DropDownList({change:this.changeByPaperSize,width:"170px",enableRtl:i}),this.paperSize.appendTo(n),this.paperSize.htmlAttributes={"aria-labelledby":"PaperSize","aria-describedby":"PaperSize"},e.appendChild(o)},Au.prototype.initLayoutProperties=function(e,t,i){var n=_.createElement("div",{className:"e-de-dlg-container"}),r=_.createElement("div",{styles:"height: 27px;"}),o=_.createElement("input",{attrs:{type:"checkbox"}}),s=(r.appendChild(o),_.createElement("div",{styles:"height: 27px;"})),a=_.createElement("input",{attrs:{type:"checkbox"}}),r=(r.setAttribute("aria-label",t.getConstant("Different first page")),s.setAttribute("aria-label",t.getConstant("Different odd and even")),s.appendChild(a),n.appendChild(r),n.appendChild(s),this.checkBox1=new H.CheckBox({label:t.getConstant("Different odd and even"),enableRtl:i}),this.checkBox2=new H.CheckBox({label:t.getConstant("Different first page"),enableRtl:i}),this.checkBox1.appendTo(o),this.checkBox2.appendTo(a),e.appendChild(n),_.createElement("div")),s=_.createElement("label",{className:"e-de-para-dlg-heading",innerHTML:t.getConstant("From edge")}),o=(r.appendChild(s),e.appendChild(r),_.createElement("div",{className:"e-de-dlg-row"})),a=_.createElement("div",{className:"e-de-subcontainer-left"}),n=(o.appendChild(a),_.createElement("div",{className:"e-de-subcontainer-right"})),s=(o.appendChild(n),i&&(n.classList.add("e-de-rtl"),a.classList.add("e-de-rtl")),_.createElement("input",{attrs:{type:"text"}})),r=(a.appendChild(s),_.createElement("input",{attrs:{type:"text"}}));n.appendChild(r),e.appendChild(o),this.headerBox=new D.NumericTextBox({value:612,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Header")}),this.headerBox.appendTo(s),this.footerBox=new D.NumericTextBox({value:792,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Footer")}),this.footerBox.appendTo(r),s.setAttribute("aria-labelledby",t.getConstant("Header")),r.setAttribute("aria-labelledby",t.getConstant("Footer"))},Au.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),e=(e.setLocale(this.documentHelper.owner.locale),this.target||this.initPageSetupDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=e.getConstant("Page Setup"),this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadPageSetupDialog,this.documentHelper.dialog.close=this.closePageSetupDialog,this.documentHelper.dialog.buttons=[{click:this.applyPageSetupProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-layout-ppty-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-layout-ppty-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),this.documentHelper.dialog.element);e&&this.documentHelper.updateDialogTabHeight(e,this.target)},Au.prototype.setPageSize=function(e,t,i){this.paperSize.value=e&&612===t&&792===i||!e&&792===t&&612===i?"letter":e&&792===t&&1224===i||!e&&1224===t&&792===i?"tabloid":e&&612===t&&1008===i||!e&&1008===t&&612===i?"legal":e&&392===t&&612===i||!e&&392===t&&612===i?"statement":e&&522===t&&756===i||!e&&756===t&&522===i?"executive":e&&841.9===t&&1190.5===i||!e&&1190.5===t&&841.9===i?"a3":e&&595.3===t&&841.9===i||!e&&841.9===t&&595.3===i?"a4":e&&419.6===t&&595.3===i||!e&&595.3===t&&419.6===i?"a5":e&&728.5===t&&1031.8===i||!e&&1031.8===t&&728.5===i?"b4":e&&515.9===t&&728.5===i||!e&&728.5===t&&515.9===i?"b5":"customsize"},Au.prototype.destroy=function(){if(this.topMarginBox&&(this.topMarginBox.destroy(),this.topMarginBox=void 0),this.leftMarginBox&&(this.leftMarginBox.destroy(),this.leftMarginBox=void 0),this.bottomMarginBox&&(this.bottomMarginBox.destroy(),this.bottomMarginBox=void 0),this.rightMarginBox&&(this.rightMarginBox.destroy(),this.rightMarginBox=void 0),this.headerBox&&(this.headerBox.destroy(),this.headerBox=void 0),this.footerBox&&(this.footerBox.destroy(),this.footerBox=void 0),this.widthBox&&(this.widthBox.destroy(),this.widthBox=void 0),this.heightBox&&(this.heightBox.destroy(),this.heightBox=void 0),this.paperSize&&(this.paperSize.destroy(),this.paperSize=void 0),this.checkBox1&&(this.checkBox1.destroy(),this.checkBox1=void 0),this.checkBox2&&(this.checkBox2.destroy(),this.checkBox2=void 0),this.portrait&&(this.portrait.destroy(),this.portrait=void 0),this.landscape&&(this.landscape.destroy(),this.landscape=void 0),this.documentHelper=void 0,!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}};var Mu=Au;function Au(e){var h=this;this.isPortrait=!0,this.loadPageSetupDialog=function(){h.documentHelper.updateFocus();var e=h.documentHelper.selection.sectionFormat;h.topMarginBox.value=e.topMargin,h.leftMarginBox.value=e.leftMargin,h.bottomMarginBox.value=e.bottomMargin,h.rightMarginBox.value=e.rightMargin,h.widthBox.value=e.pageWidth,h.heightBox.value=e.pageHeight,h.checkBox1.checked=e.differentOddAndEvenPages,h.checkBox2.checked=e.differentFirstPage,h.headerBox.value=e.headerDistance,h.footerBox.value=e.footerDistance,h.widthBox.value>h.heightBox.value?h.landscape.checked=!0:h.portrait.checked=!0,h.setPageSize(h.portrait.checked,parseFloat(e.pageWidth.toFixed(1)),parseFloat(e.pageHeight.toFixed(1)))},this.closePageSetupDialog=function(){h.unWireEventsAndBindings(),h.documentHelper.updateFocus()},this.onCancelButtonClick=function(){h.documentHelper.dialog.hide(),h.unWireEventsAndBindings(),h.documentHelper.updateFocus()},this.keyUpInsertPageSettings=function(e){13===e.keyCode&&h.applyPageSetupProperties()},this.applyPageSetupProperties=function(){var e=new Ma,t=new _.L10n("documenteditor",h.documentHelper.owner.defaultLocale),i=(t.setLocale(h.documentHelper.owner.locale),h.documentHelper.selection.sectionFormat);if(e.bottomMargin=h.bottomMarginBox.value,e.topMargin=h.topMarginBox.value,e.leftMargin=h.leftMarginBox.value,e.rightMargin=h.rightMarginBox.value,e.pageWidth=h.widthBox.value,e.pageHeight=h.heightBox.value,e.differentOddAndEvenPages=h.checkBox1.checked,e.differentFirstPage=h.checkBox2.checked,e.headerDistance=h.headerBox.value,e.footerDistance=h.footerBox.value,h.widthBox.value<h.leftMarginBox.value+h.rightMarginBox.value)C.DialogUtility.alert(t.getConstant("Left and right margins."));else if(h.widthBox.value<h.leftMarginBox.value+h.rightMarginBox.value+36)C.DialogUtility.alert(t.getConstant("Column width cannot be less than 36 pt."));else if(Math.abs(h.topMarginBox.value+h.bottomMarginBox.value)>h.heightBox.value)C.DialogUtility.alert(t.getConstant("The top/bottom margins are too large for the page height in some sections."));else{e.numberOfColumns=i.numberOfColumns,e.equalWidth=i.equalWidth,e.lineBetweenColumns=i.lineBetweenColumns;for(var n=[],r=j.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),o=0;o<i.columns.length;o++){var s=new Da,a=j.convertPointToPixel(i.columns[parseInt(o.toString(),10)].width),l=j.convertPointToPixel(i.columns[parseInt(o.toString(),10)].space),d=(i.numberOfColumns-1)*l;!i.equalWidth&&0!==a||_.isNullOrUndefined(r)||(a=(r-d)/i.numberOfColumns),s.width=a,s.space=l,s.index=o,n.push(s)}e.columns=n,i.pageHeight===e.pageHeight&&i.pageWidth===e.pageWidth&&(e.breakCode=i.breakCode),h.documentHelper.owner.editorModule.onApplySectionFormat(void 0,e),h.documentHelper.hideDialog()}},this.changeByPaperSize=function(e){e=e.value;h.documentHelper.selection.sectionFormat.pageWidth>h.documentHelper.selection.sectionFormat.pageHeight||h.landscape.checked?(h.isPortrait=!1,h.portrait.checked=!1):h.isPortrait=!0,"letter"===e?h.isPortrait?(h.widthBox.value=612,h.heightBox.value=792):(h.widthBox.value=792,h.heightBox.value=612):"tabloid"===e?h.isPortrait?(h.widthBox.value=792,h.heightBox.value=1224):(h.widthBox.value=1224,h.heightBox.value=792):"legal"===e?h.isPortrait?(h.widthBox.value=612,h.heightBox.value=1008):(h.widthBox.value=1008,h.heightBox.value=612):"statement"===e?h.isPortrait?(h.widthBox.value=392,h.heightBox.value=612):(h.widthBox.value=612,h.heightBox.value=392):"executive"===e?h.isPortrait?(h.widthBox.value=522,h.heightBox.value=756):(h.widthBox.value=756,h.heightBox.value=522):"a3"===e?h.isPortrait?(h.widthBox.value=841.9,h.heightBox.value=1190.55):(h.widthBox.value=1190.55,h.heightBox.value=841.9):"a4"===e?h.isPortrait?(h.widthBox.value=595.3,h.heightBox.value=841.9):(h.widthBox.value=841.9,h.heightBox.value=595.3):"a5"===e?h.isPortrait?(h.widthBox.value=419.55,h.heightBox.value=595.3):(h.widthBox.value=595.3,h.heightBox.value=419.55):"b4"===e?h.isPortrait?(h.widthBox.value=728.5,h.heightBox.value=1031.8):(h.widthBox.value=1031.8,h.heightBox.value=728.5):"b5"===e?h.isPortrait?(h.widthBox.value=515.9,h.heightBox.value=728.5):(h.widthBox.value=728.5,h.heightBox.value=515.9):"customsize"===e&&(h.isPortrait,h.widthBox.value=h.documentHelper.selection.sectionFormat.pageWidth,h.heightBox.value=h.documentHelper.selection.sectionFormat.pageHeight)},this.onPortrait=function(){h.landscape.checked=!1;var e=h.widthBox.value,t=h.heightBox.value;t<e&&(h.widthBox.value=t,h.heightBox.value=e)},this.onLandscape=function(){h.portrait.checked=!1;var e=h.widthBox.value,t=h.heightBox.value;e<t&&(h.widthBox.value=t,h.heightBox.value=e)},this.unWireEventsAndBindings=function(){h.paperSize.value=void 0,h.topMarginBox.value=void 0,h.bottomMarginBox.value=void 0,h.leftMarginBox.value=void 0,h.rightMarginBox.value=void 0,h.headerBox.value=void 0,h.footerBox.value=void 0,h.widthBox.value=void 0,h.heightBox.value=void 0,h.checkBox1.checked=!1,h.checkBox2.checked=!1,h.portrait.checked=!1,h.landscape.checked=!1},this.documentHelper=e}Object.defineProperty(Uu.prototype,"owner",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Uu.prototype.getModuleName=function(){return"ParagraphDialog"},Uu.prototype.initParagraphDialog=function(e){var t=_.createElement("div"),i=_.createElement("div"),n=this.documentHelper.owner.containerId,r=_.createElement("div",{className:"e-de-dlg-tab-first-child e-de-para-dlg-container"}),t=((this.target=t).appendChild(i),_.createElement("div",{styles:"width:400px;"})),o=_.createElement("div"),s=_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("General")}),s=(o.appendChild(s),_.createElement("div",{className:"e-de-container-row"})),a=(o.appendChild(s),_.createElement("div",{className:"e-de-subcontainer-left"})),s=(s.appendChild(a),_.createElement("select",{id:n+"_Alignment",innerHTML:'<option value="Center">'+e.getConstant("Center")+'</option><option value="Left">'+e.getConstant("Left")+'</option><option value="Right">'+e.getConstant("Right")+'</option><option value="Justify">'+e.getConstant("Justify")+"</option>"})),l=_.createElement("select",{id:n+"_Outline",innerHTML:'<option value="BodyText">'+e.getConstant("BodyText")+'</option><option value="Level1">'+e.getConstant("Level1")+'</option><option value="Level2">'+e.getConstant("Level2")+'</option><option value="Level3">'+e.getConstant("Level3")+'</option><option value="Level4">'+e.getConstant("Level4")+'</option><option value="Level5">'+e.getConstant("Level5")+'</option><option value="Level6">'+e.getConstant("Level6")+'</option><option value="Level7">'+e.getConstant("Level7")+'</option><option value="Level8">'+e.getConstant("Level8")+'</option><option value="Level9">'+e.getConstant("Level9")+"</option>"}),a=(a.appendChild(s),a.setAttribute("aria-labelledby",s.innerText),a.appendChild(l),a.setAttribute("aria-labelledby",l.innerText),_.createElement("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Direction")})),d=(this.directionDiv=_.createElement("div",{className:"e-de-container-row"}),_.createElement("div",{className:"e-de-rtl-btn-div"})),h=_.createElement("input",{id:n+"_rtlEle"}),c=(d.appendChild(h),this.directionDiv.appendChild(d),this.documentHelper.owner.enableRtl),d=(c&&d.classList.add("e-de-rtl"),_.createElement("div",{className:"e-de-ltr-btn-div"})),p=_.createElement("input",{id:n+"_ltrEle"}),d=(d.appendChild(p),this.directionDiv.appendChild(d),o.appendChild(a),o.appendChild(this.directionDiv),this.rtlButton=new H.RadioButton({label:e.getConstant("Right-to-left"),enableRtl:c,value:"rtl",cssClass:"e-small",change:this.changeBidirectional}),this.rtlButton.appendTo(h),h.setAttribute("aria-label",e.getConstant("Right-to-left")),this.ltrButton=new H.RadioButton({label:e.getConstant("Left-to-right"),enableRtl:c,value:"ltr",cssClass:"e-small",change:this.changeBidirectional}),this.ltrButton.appendTo(p),p.setAttribute("aria-label",e.getConstant("Left-to-right")),_.createElement("div")),a=_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Indentation")}),h=(d.appendChild(a),_.createElement("div",{className:"e-de-container-row"})),p=(d.appendChild(h),_.createElement("div",{className:"e-de-container-row"})),a=(d.appendChild(p),_.createElement("div",{className:"e-de-subcontainer-left"})),u=(h.appendChild(a),_.createElement("div",{className:"e-de-subcontainer-right"})),h=(h.appendChild(u),_.createElement("div",{className:"e-de-subcontainer-left"})),g=(p.appendChild(h),_.createElement("div",{className:"e-de-subcontainer-right"})),p=(p.appendChild(g),_.createElement("div")),m=_.createElement("div"),f=(p.appendChild(m),_.createElement("div",{className:"e-de-container-row"})),y=(p.appendChild(f),_.createElement("div",{className:"e-de-container-row"})),v=(p.appendChild(y),_.createElement("input",{attrs:{type:"checkbox"},id:n+"_contextSpacing"})),f=(f.appendChild(v),_.createElement("input",{id:n+"_leftIndent",attrs:{type:"text"}})),w=_.createElement("input",{id:n+"_rightIndent",attrs:{type:"text"}}),a=(a.appendChild(f),a.setAttribute("aria-labelledby",e.getConstant("Indent from left")),u.appendChild(w),u.setAttribute("aria-labelledby",e.getConstant("Indent from right")),_.createElement("select",{id:n+"_special",innerHTML:'<option value="None">'+e.getConstant("None")+'</option><option value="First Line">'+e.getConstant("First line")+'</option><option value="Hanging">'+e.getConstant("Hanging")+"</option> "})),u=_.createElement("input",{id:n+"_By",attrs:{type:"text"}}),h=(h.setAttribute("aria-labelledby","Special"),h.appendChild(a),g.appendChild(u),g.setAttribute("aria-labelledby","By"),_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Spacing")})),g=_.createElement("div",{className:"e-de-container-row"}),b=_.createElement("div",{className:"e-de-subcontainer-left"}),x=_.createElement("input",{id:n+"_beforeSpacing",attrs:{type:"text"}}),C=_.createElement("div",{className:"e-de-subcontainer-right"}),I=_.createElement("input",{id:n+"_afterSpacing",attrs:{type:"text"}}),h=(m.appendChild(h),m.appendChild(g),b.appendChild(x),g.appendChild(b),C.appendChild(I),g.appendChild(C),_.createElement("div",{className:"e-de-subcontainer-left"})),m=_.createElement("select",{id:n+"_lineSpacing",innerHTML:'<option value="At least">'+e.getConstant("At least")+'</option><option value="Exactly">'+e.getConstant("Exactly")+'</option><option value="Multiple">'+e.getConstant("Multiple")+"</option>"}),g=_.createElement("div",{className:"e-de-subcontainer-right"}),n=_.createElement("input",{id:n+"_lineSpacingAt",attrs:{type:"text"}});h.appendChild(m),y.appendChild(h),g.appendChild(n),y.appendChild(g),t.appendChild(o),t.appendChild(d),t.appendChild(p),r.appendChild(t),this.leftIndentIn=new D.NumericTextBox({format:"n1",value:0,min:-1584,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("Before text"),change:this.changeLeftIndent}),this.leftIndentIn.appendTo(f),this.rightIndentIn=new D.NumericTextBox({format:"n1",value:0,min:-1584,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("After text"),change:this.changeRightIndent}),this.rightIndentIn.appendTo(w),this.byIn=new D.NumericTextBox({format:"n1",value:0,min:0,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("By"),change:this.changeFirstLineIndent}),this.byIn.appendTo(u),this.beforeSpacingIn=new D.NumericTextBox({format:"n1",value:0,min:-1,max:1584,step:6,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("Before"),change:this.changeBeforeSpacing,focus:this.focusBeforeSpacing,blur:this.blurBeforeSpacing}),this.beforeSpacingIn.appendTo(x),b.getElementsByClassName("e-input-group-icon e-spin-down")[0].addEventListener("click",this.clickBeforeSpacing),this.afterSpacingIn=new D.NumericTextBox({format:"n1",value:0,min:-1,max:1584,step:6,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("After"),change:this.changeAfterSpacing,focus:this.focusAfterSpacing,blur:this.blurAfterSpacing}),this.afterSpacingIn.appendTo(I);C.getElementsByClassName("e-input-group-icon e-spin-down")[0].addEventListener("click",this.clickAfterSpacing),this.atIn=new D.NumericTextBox({format:"n1",value:0,min:1,max:1584,step:.5,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("At"),change:this.changeLineSpacingValue}),this.special=new U.DropDownList({change:this.changeByValue,enableRtl:c,floatLabelType:"Always",placeholder:e.getConstant("Special")}),this.special.appendTo(a),this.lineSpacing=new U.DropDownList({change:this.changeBySpacing,enableRtl:c,floatLabelType:"Always",placeholder:e.getConstant("Line Spacing"),htmlAttributes:{"aria-labelledby":e.getConstant("Line Spacing")}}),this.lineSpacing.appendTo(m),this.alignment=new U.DropDownList({change:this.changeByTextAlignment,enableRtl:c,floatLabelType:"Always",placeholder:e.getConstant("Alignment"),htmlAttributes:{"aria-labelledby":e.getConstant("Alignment")}}),this.alignment.appendTo(s),this.outlineLevel=new U.DropDownList({change:this.changeByOutlineLevel,enableRtl:c,floatLabelType:"Always",placeholder:e.getConstant("OutlineLevel"),htmlAttributes:{"aria-labelledby":e.getConstant("OutlineLevel")}}),this.outlineLevel.appendTo(l),this.atIn.appendTo(n),this.contextSpacing=new H.CheckBox({change:this.changeContextualSpacing,label:e.getConstant("Contextual Spacing"),enableRtl:c}),this.contextSpacing.appendTo(v),v.setAttribute("aria-labelledby",e.getConstant("Contextual Spacing")),r.addEventListener("keyup",this.keyUpParagraphSettings),c&&(C.classList.add("e-de-rtl"),g.classList.add("e-de-rtl"));h=_.createElement("div",{className:"e-de-dlg-tab-first-child"}),y=_.createElement("div",{className:"e-de-para-dlg-sub-container"}),this.paginationDiv=y,o=_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Pagination")}),y.appendChild(o),d=_.createElement("div",{styles:"display:block"}),y.appendChild(d),p=_.createElement("div",{styles:"display:block"}),y.appendChild(p),t=_.createElement("div",{styles:"display:block"}),y.appendChild(t),f=_.createElement("input",{attrs:{type:"checkbox"}}),p.appendChild(f),this.keepWithNext=new H.CheckBox({change:this.changeKeepWithNext,label:e.getConstant("Keep With Next"),enableRtl:c,cssClass:"e-de-para-dlg-cs-check-box"}),this.keepWithNext.appendTo(f),f.setAttribute("aria-label",e.getConstant("Keep With Next")),w=_.createElement("input",{attrs:{type:"checkbox"}}),t.appendChild(w),this.keepLinesTogether=new H.CheckBox({change:this.changeKeepLinesTogether,label:e.getConstant("Keep Lines Together"),enableRtl:c,cssClass:"e-de-para-dlg-cs-check-box"}),this.keepLinesTogether.appendTo(w),w.setAttribute("aria-label",e.getConstant("Keep Lines Together")),u=_.createElement("input",{attrs:{type:"checkbox"}}),d.appendChild(u),this.widowControlIn=new H.CheckBox({change:this.changeWidowControl,label:e.getConstant("WidowControl"),enableRtl:c,cssClass:"e-de-para-dlg-cs-check-box"}),this.widowControlIn.appendTo(u),u.setAttribute("aria-label",e.getConstant("WidowControl")),h.appendChild(y),x=[{header:{text:e.getConstant("Indents and Spacing")},content:r},{header:{text:e.getConstant("Line and Page Breaks")},content:h}];this.tabObj=new k.Tab({items:x,enableRtl:c,animation:{previous:{effect:"None"},next:{effect:"None"}}},i),this.tabObj.isStringTemplate=!0},Uu.prototype.changeAlignmentByBidi=function(){"Left"===this.textAlignment?this.textAlignment="Right":"Right"===this.textAlignment&&(this.textAlignment="Left"),_.isNullOrUndefined(this.textAlignment)?0===this.alignment.index?this.textAlignment="Center":this.textAlignment="Justify":this.alignment.index=this.getAlignmentValue(this.textAlignment)},Uu.prototype.getAlignmentValue=function(e){e="Center"===e?0:"Left"===e?1:"Right"===e?2:3;return e},Uu.prototype.isHeadingStyle=function(){var e=this.documentHelper.selection.paragraphFormat.styleName;return"Heading 1"===e||"Heading 2"===e||"Heading 3"===e||"Heading 4"===e||"Heading 5"===e||"Heading 6"===e||"Heading 7"===e||"Heading 8"===e||"Heading 9"===e},Uu.prototype.getOutlineValue=function(e){e="BodyText"===e?0:"Level1"===e?1:"Level2"===e?2:"Level3"===e?3:"Level4"===e?4:"Level5"===e?5:"Level6"===e?6:"Level7"===e?7:"Level8"===e?8:9;return e},Uu.prototype.onParagraphFormat=function(e){var t=this.documentHelper.selection,i=e.bidi&&-1!==t.paragraphFormat.listId;i||(this.documentHelper.layout.isBidiReLayout=!0),this.documentHelper.owner.editorModule.setPreviousBlockToLayout(),this.documentHelper.owner.editorModule.initHistory("ParagraphFormat"),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.selection.isEmpty?(this.documentHelper.owner.editorModule.applyParaFormatProperty(t.start.paragraph,void 0,e,!1),this.documentHelper.owner.editorModule.isMeasureParaWidth=!0,this.documentHelper.owner.editorModule.layoutItemBlock(t.start.paragraph,!1),this.documentHelper.owner.editorModule.isMeasureParaWidth=!0):this.documentHelper.owner.editorModule.updateSelectionParagraphFormatting("ParagraphFormat",e,!1),this.documentHelper.owner.editorModule.reLayout(t),i||(this.documentHelper.layout.isBidiReLayout=!1)},Uu.prototype.show=function(e){e?(this.isStyleDialog=!0,this.paragraphFormat=e):this.isStyleDialog=!1;var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),e=(e.setLocale(this.documentHelper.owner.locale),this.target||this.initParagraphDialog(e),this.loadParagraphDialog(),this.documentHelper.dialog.header=e.getConstant("Paragraph"),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.buttons=[{click:this.openTabDialog,buttonModel:{content:e.getConstant("Tabs")+"....",cssClass:"e-flat e-de-para-tab",enableRtl:this.documentHelper.owner.enableRtl}},{click:this.applyParagraphFormat,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-para-okay",isPrimary:!0}},{click:this.closeParagraphDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-para-cancel"}}],this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.alignment.focusIn(),this.documentHelper.dialog.show(),this.documentHelper.dialog.element);e&&(e=this.documentHelper.updateDialogTabHeight(e,this.target),this.paginationDiv.style.width=e.toString()+"px")},Uu.prototype.destroy=function(){if(this.afterSpacingIn&&(this.afterSpacingIn.destroy(),this.afterSpacingIn=void 0),this.beforeSpacingIn&&(this.beforeSpacingIn.destroy(),this.beforeSpacingIn=void 0),this.leftIndentIn&&(this.leftIndentIn.destroy(),this.leftIndentIn=void 0),this.rightIndentIn&&(this.rightIndentIn.destroy(),this.rightIndentIn=void 0),this.byIn&&(this.byIn.destroy(),this.byIn=void 0),this.special&&(this.special.destroy(),this.special=void 0),this.atIn&&(this.atIn.destroy(),this.atIn=void 0),this.alignment&&(this.alignment.change=void 0,this.alignment.destroy()),this.alignment=void 0,this.outlineLevel&&(this.outlineLevel.change=void 0,this.outlineLevel.destroy()),this.outlineLevel=void 0,this.lineSpacing&&(this.lineSpacing.change=void 0,this.lineSpacing.destroy()),this.lineSpacing=void 0,this.special&&(this.special.change=void 0,this.special.destroy()),this.special=void 0,!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0,this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.documentHelper=void 0}};var Du=Uu;function Uu(e){var n=this;this.leftIndent=void 0,this.rightIndent=void 0,this.beforeSpacing=void 0,this.afterSpacing=void 0,this.spaceBeforeAuto=!1,this.spaceAfterAuto=!1,this.textAlignment=void 0,this.paraOutlineLevel=void 0,this.firstLineIndent=void 0,this.lineSpacingIn=void 0,this.lineSpacingType=void 0,this.paragraphFormat=void 0,this.bidi=void 0,this.contextualSpacing=void 0,this.isStyleDialog=!1,this.directionDiv=void 0,this.keepWithNextValue=void 0,this.keepLineTogetherValue=void 0,this.widowControlValue=void 0,this.tabObj=void 0,this.keyUpParagraphSettings=function(e){13===e.keyCode&&n.applyParagraphFormat()},this.changeBeforeSpacing=function(e){var t=new _.L10n("documenteditor",n.documentHelper.owner.defaultLocale);t.setLocale(n.documentHelper.owner.locale),-1===e.value?(n.beforeSpacingIn.element.value=t.getConstant("Auto"),n.beforeSpacingIn.step=1,n.spaceBeforeAuto=!0,n.beforeSpacing=5):(n.beforeSpacing=e.value,n.beforeSpacingIn.step=6,n.spaceBeforeAuto=!1)},this.focusBeforeSpacing=function(e){var t=new _.L10n("documenteditor",n.documentHelper.owner.defaultLocale);t.setLocale(n.documentHelper.owner.locale),-1===e.value&&(n.beforeSpacingIn.element.value=t.getConstant("Auto"))},this.blurBeforeSpacing=function(e){var t,i=new _.L10n("documenteditor",n.documentHelper.owner.defaultLocale);i.setLocale(n.documentHelper.owner.locale),-1===e.value&&(t=n.beforeSpacingIn,setTimeout(function(){t.element.value=i.getConstant("Auto")},0))},this.clickBeforeSpacing=function(){var e=new _.L10n("documenteditor",n.documentHelper.owner.defaultLocale);e.setLocale(n.documentHelper.owner.locale),"-1.0"===n.beforeSpacingIn.element.value&&(n.beforeSpacingIn.element.value=e.getConstant("Auto"))},this.changeAfterSpacing=function(e){var t=new _.L10n("documenteditor",n.documentHelper.owner.defaultLocale);t.setLocale(n.documentHelper.owner.locale),-1===e.value?(n.afterSpacingIn.element.value=t.getConstant("Auto"),n.afterSpacingIn.step=1,n.spaceAfterAuto=!0,n.afterSpacing=5):(n.afterSpacing=e.value,n.afterSpacingIn.step=6,n.spaceAfterAuto=!1)},this.focusAfterSpacing=function(e){var t=new _.L10n("documenteditor",n.documentHelper.owner.defaultLocale);t.setLocale(n.documentHelper.owner.locale),-1===e.value&&(n.afterSpacingIn.element.value=t.getConstant("Auto"))},this.blurAfterSpacing=function(e){var t,i=new _.L10n("documenteditor",n.documentHelper.owner.defaultLocale);i.setLocale(n.documentHelper.owner.locale),-1===e.value&&(t=n.afterSpacingIn,setTimeout(function(){t.element.value=i.getConstant("Auto")},0))},this.clickAfterSpacing=function(){var e=new _.L10n("documenteditor",n.documentHelper.owner.defaultLocale);e.setLocale(n.documentHelper.owner.locale),"-1.0"===n.afterSpacingIn.element.value&&(n.afterSpacingIn.element.value=e.getConstant("Auto"))},this.changeLeftIndent=function(e){n.leftIndent=e.value},this.changeRightIndent=function(e){n.rightIndent=e.value},this.changeLineSpacingValue=function(e){n.lineSpacingIn=e.value},this.changeFirstLineIndent=function(e){n.firstLineIndent=e.value,2===n.special.index&&(n.firstLineIndent=-n.firstLineIndent,n.leftIndent=n.leftIndentIn.value+e.value)},this.changeByTextAlignment=function(e){n.textAlignment=e.value},this.changeByOutlineLevel=function(e){n.paraOutlineLevel=e.value},this.changeBidirectional=function(e){"ltr"===e.value?(n.rtlButton.checked=!n.ltrButton.checked,n.bidi=!1):(n.ltrButton.checked=!n.rtlButton.checked,n.bidi=!0),n.changeAlignmentByBidi()},this.changeContextualSpacing=function(e){n.contextualSpacing=e.checked},this.changeKeepWithNext=function(e){n.keepWithNextValue=e.checked},this.changeKeepLinesTogether=function(e){n.keepLineTogetherValue=e.checked},this.changeWidowControl=function(e){n.widowControlValue=e.checked},this.changeByValue=function(){var e=n.documentHelper.selection.paragraphFormat;switch(n.special.index){case 0:0!==e.firstLineIndent&&(n.byIn.value=0,n.leftIndent=n.leftIndentIn.value);break;case 1:0===e.firstLineIndent||_.isNullOrUndefined(e.firstLineIndent)?n.byIn.value=.1:e.firstLineIndent<0&&(n.byIn.value=-e.firstLineIndent,Math.abs(e.firstLineIndent)<=n.leftIndent)&&(n.leftIndent=e.firstLineIndent+n.leftIndent);break;case 2:0===e.firstLineIndent||_.isNullOrUndefined(e.firstLineIndent)?e.firstLineIndent=-.1:0<e.firstLineIndent&&(n.byIn.value=e.firstLineIndent,_.isNullOrUndefined(n.leftIndent)?n.leftIndent=e.firstLineIndent:n.leftIndent=n.leftIndent+e.firstLineIndent)}},this.changeBySpacing=function(){if(!_.isNullOrUndefined(n.lineSpacing))switch(n.lineSpacing.index){case 0:n.lineSpacingType="AtLeast",n.atIn.value=12;break;case 1:n.lineSpacingType="Exactly",n.atIn.value=12;break;case 2:n.lineSpacingType="Multiple",n.atIn.value=1}},this.loadParagraphDialog=function(){n.isStyleDialog?n.directionDiv.classList.add("e-de-disabledbutton"):n.directionDiv.classList.remove("e-de-disabledbutton"),e=n.paragraphFormat||n.documentHelper.selection.paragraphFormat;var e,t=n.getAlignmentValue(e.textAlignment),t=(n.alignment.index=t,n.getOutlineValue(e.outlineLevel)),t=(n.outlineLevel.index=t,n.isHeadingStyle()?n.outlineLevel.readonly=!0:n.outlineLevel.readonly=!1,e.spaceBeforeAuto?n.beforeSpacingIn.value=-1:-1===e.beforeSpacing?n.beforeSpacingIn.value=void 0:n.beforeSpacingIn.value=e.beforeSpacing,e.spaceAfterAuto?n.afterSpacingIn.value=-1:-1===e.afterSpacing?n.afterSpacingIn.value=void 0:n.afterSpacingIn.value=e.afterSpacing,n.leftIndentIn.value=e.leftIndent,n.rightIndentIn.value=e.rightIndent,n.byIn.value=Math.abs(e.firstLineIndent),n.lineSpacing.index);n.keepWithNextValue=void 0,n.keepLineTogetherValue=void 0,n.widowControlValue=void 0,0<e.firstLineIndent?n.special.index=1:e.firstLineIndent<0&&(n.special.index=2,n.leftIndentIn.value=e.leftIndent-n.byIn.value),t="AtLeast"===e.lineSpacingType?0:"Exactly"===e.lineSpacingType?1:2,n.lineSpacing.index=t,n.atIn.value=e.lineSpacing,"none"!==n.documentHelper.selection.caret.style.display&&(n.documentHelper.selection.caret.style.display="none"),e.bidi?(n.rtlButton.checked=!0,n.ltrButton.checked=!1):(n.ltrButton.checked=!0,n.rtlButton.checked=!1),_.isNullOrUndefined(e.keepWithNext)?n.keepWithNext.indeterminate=!0:n.keepWithNext.checked=e.keepWithNext,_.isNullOrUndefined(e.keepLinesTogether)?n.keepLinesTogether.indeterminate=!0:n.keepLinesTogether.checked=e.keepLinesTogether,_.isNullOrUndefined(e.widowControl)?n.widowControlIn.indeterminate=!0:n.widowControlIn.checked=e.widowControl,n.contextSpacing.checked=e.contextualSpacing},this.applyParagraphFormat=function(){var e,t,i=n.paragraphFormat?(e=n.paragraphFormat,!1):!((e=new Xa).borders=void 0);_.isNullOrUndefined(n.beforeSpacing)||(e.beforeSpacing=n.beforeSpacing),_.isNullOrUndefined(n.afterSpacing)||(e.afterSpacing=n.afterSpacing),_.isNullOrUndefined(n.spaceBeforeAuto)||(e.spaceBeforeAuto=n.spaceBeforeAuto),_.isNullOrUndefined(n.spaceAfterAuto)||(e.spaceAfterAuto=n.spaceAfterAuto),_.isNullOrUndefined(n.lineSpacingType)||(e.lineSpacingType=n.lineSpacingType),_.isNullOrUndefined(n.leftIndent)||(e.leftIndent=n.leftIndent),_.isNullOrUndefined(n.rightIndent)||(e.rightIndent=n.rightIndent),_.isNullOrUndefined(n.lineSpacingIn)||(e.lineSpacing=n.lineSpacingIn),_.isNullOrUndefined(n.firstLineIndent)||(e.firstLineIndent=Math.abs(n.firstLineIndent),2===n.special.index&&(e.firstLineIndent=-e.firstLineIndent,e.leftIndent=n.leftIndentIn.value+n.byIn.value)),_.isNullOrUndefined(n.paraOutlineLevel)||(e.outlineLevel=n.paraOutlineLevel),_.isNullOrUndefined(n.bidi)||(e.bidi=n.bidi),_.isNullOrUndefined(n.textAlignment)||(t=n.textAlignment,e.bidi&&("Right"===t?t="Left":"Left"===t&&(t="Right")),e.textAlignment=t),_.isNullOrUndefined(n.contextualSpacing)||(e.contextualSpacing=n.contextualSpacing),_.isNullOrUndefined(n.keepWithNextValue)?n.documentHelper.selection.paragraphFormat.keepWithNext&&(e.keepWithNext=n.documentHelper.selection.paragraphFormat.keepWithNext):e.keepWithNext=n.keepWithNextValue,_.isNullOrUndefined(n.keepLineTogetherValue)?n.documentHelper.selection.paragraphFormat.keepLinesTogether&&(e.keepLinesTogether=n.documentHelper.selection.paragraphFormat.keepLinesTogether):e.keepLinesTogether=n.keepLineTogetherValue,_.isNullOrUndefined(n.widowControlValue)?n.documentHelper.selection.paragraphFormat.widowControl&&(e.widowControl=n.documentHelper.selection.paragraphFormat.widowControl):e.widowControl=n.widowControlValue,i?n.onParagraphFormat(e):n.documentHelper.owner.styleDialogModule.updateParagraphFormat(),n.documentHelper.hideDialog()},this.openTabDialog=function(){n.documentHelper.hideDialog(),n.documentHelper.owner.tabDialogModule.show()},this.closeParagraphDialog=function(){n.leftIndent=void 0,n.afterSpacing=void 0,n.beforeSpacing=void 0,n.firstLineIndent=void 0,n.textAlignment=void 0,n.paraOutlineLevel=void 0,n.rightIndent=void 0,n.lineSpacingIn=void 0,n.lineSpacingType=void 0,n.paragraphFormat=void 0,n.documentHelper.hideDialog()},this.documentHelper=e}zu.prototype.getListLevel=function(e){var t=this.getLevelOverride(e);return _.isNullOrUndefined(t)||_.isNullOrUndefined(t.overrideListLevel)?this.abstractList.levels[parseInt(e.toString(),10)]:t.overrideListLevel},zu.prototype.getLevelOverride=function(e){for(var t=0;t<this.levelOverrides.length;t++)if(this.levelOverrides[parseInt(t.toString(),10)]instanceof Wl){var i=this.levelOverrides[parseInt(t.toString(),10)];if(i.levelNumber===e)return i}},zu.prototype.clear=function(){if(!_.isNullOrUndefined(this.levelOverrides)){for(var e=0;e<this.levelOverrides.length;e++)this.levelOverrides[parseInt(e.toString(),10)].clear();this.levelOverrides=[]}this.abstractList&&this.abstractList.clear(),this.abstractList=void 0},zu.prototype.destroy=function(){if(!_.isNullOrUndefined(this.levelOverrides)){for(var e=0;e<this.levelOverrides.length;e++)this.levelOverrides[parseInt(e.toString(),10)].destroy();this.levelOverrides=[]}this.levelOverrides=void 0,this.abstractList&&(this.abstractList.destroy(),this.abstractList=void 0),this.abstractListId=void 0,this.listId=void 0,this.sourceListId=void 0},zu.prototype.mergeList=function(e){_.isNullOrUndefined(this.abstractListId)||-1===this.abstractListId||(this.abstractListId=e.abstractListId),_.isNullOrUndefined(this.listId)||-1===this.listId||(this.listId=e.listId),_.isNullOrUndefined(this.sourceListId)||-1===this.sourceListId||(this.sourceListId=e.sourceListId),_.isNullOrUndefined(this.levelOverrides)||0===this.levelOverrides.length||(this.levelOverrides=e.levelOverrides)},zu.prototype.clone=function(){for(var e=new zu,t=0;t<this.levelOverrides.length;t++)e.levelOverrides.push(this.levelOverrides[parseInt(t.toString(),10)].clone());return e};var Vu=zu;function zu(){this.nsid=-1,this.listId=-1,this.sourceListId=-1,this.abstractListId=-1,this.abstractList=void 0,this.levelOverrides=[]}Object.defineProperty(_u.prototype,"levelNumber",{get:function(){return this.levelNumberIn},set:function(e){this.levelNumberIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(_u.prototype,"list",{get:function(){return this.listIn},set:function(e){_.isNullOrUndefined(e)?this.createList():this.listIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(_u.prototype,"listLevel",{get:function(){var e;if(!_.isNullOrUndefined(this.list)&&0<=this.levelNumber&&this.levelNumber<9)return(_.isNullOrUndefined(this.dialog.documentHelper.getAbstractListById(this.list.abstractListId))?(this.dialog.documentHelper.lists.push(this.list),e=this.list.abstractList,this.list.abstractList||((e=new Hl).abstractListId=this.list.abstractListId),this.dialog.documentHelper.abstractLists.push(e),(e=this.dialog.documentHelper.getAbstractListById(this.list.abstractListId)).levels.length<=this.levelNumber&&this.dialog.documentHelper.layout.addListLevels(this.list.abstractList),e):(this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels.length<=this.levelNumber&&this.dialog.documentHelper.layout.addListLevels(this.list.abstractList),this.dialog.documentHelper.getAbstractListById(this.list.abstractListId))).levels[this.levelNumber]},enumerable:!0,configurable:!0}),Object.defineProperty(_u.prototype,"listLevelPattern",{get:function(){return _.isNullOrUndefined(this.listLevel)?"Arabic":this.listLevel.listLevelPattern},set:function(e){_.isNullOrUndefined(this.listLevel)||(this.listLevel.listLevelPattern=e)},enumerable:!0,configurable:!0}),Object.defineProperty(_u.prototype,"followCharacter",{get:function(){return _.isNullOrUndefined(this.listLevel)?"None":this.listLevel.followCharacter},set:function(e){_.isNullOrUndefined(this.listLevel)||(this.listLevel.followCharacter=e)},enumerable:!0,configurable:!0}),_u.prototype.createList=function(){this.list=new Vu,this.list.listId=this.dialog.documentHelper.lists.length+1;var e=new Hl,t=(e.abstractListId=this.dialog.documentHelper.abstractLists.length+1,this.list.abstractListId=e.abstractListId,this.list.abstractList=e,this.dialog.documentHelper.lists.push(this.list),new El(e));t.paragraphFormat=new Xa(t),t.paragraphFormat.leftIndent=48,t.paragraphFormat.firstLineIndent=-24,t.characterFormat=new B(t),t.numberFormat="%1.",t.startAt=1,e.levels.push(t),this.dialog.documentHelper.abstractLists.push(e)},_u.prototype.addListLevels=function(){if(!_.isNullOrUndefined(this.list)&&!_.isNullOrUndefined(this.list.abstractListId))for(var e=this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels.length;e<9;e++){var t=new El(this.dialog.documentHelper.getAbstractListById(this.list.abstractListId));t.characterFormat=new B(t),t.paragraphFormat=new Xa(t),t.paragraphFormat.leftIndent=48*(e+1),t.paragraphFormat.firstLineIndent=-24,t.numberFormat="%"+(e+1).toString()+".",t.listLevelPattern="Arabic",t.followCharacter="Tab",t.startAt=1,t.restartLevel=e,this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels.push(t)}},_u.prototype.destroy=function(){this.dialog&&this.listIn&&this.dialog.documentHelper.layout.clearInvalidList(this.listIn),this.listIn=void 0,this.levelNumberIn=void 0,this.listLevelPattern=void 0};var qu=_u;function _u(){this.listIn=void 0,this.levelNumberIn=void 0,this.dialog=void 0,this.levelNumber=0}Object.defineProperty(Gu.prototype,"listLevel",{get:function(){if(!_.isNullOrUndefined(this.viewModel))return this.viewModel.listLevel},enumerable:!0,configurable:!0}),Object.defineProperty(Gu.prototype,"list",{get:function(){if(!_.isNullOrUndefined(this.viewModel))return this.viewModel.list},enumerable:!0,configurable:!0}),Object.defineProperty(Gu.prototype,"levelNumber",{get:function(){return this.listLevel.ownerBase instanceof Wl?this.listLevel.ownerBase.levelNumber:this.listLevel.ownerBase instanceof Hl&&!_.isNullOrUndefined(this.listLevel.ownerBase.levels)?this.listLevel.ownerBase.levels.indexOf(this.listLevel):-1},enumerable:!0,configurable:!0}),Object.defineProperty(Gu.prototype,"owner",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Gu.prototype.getModuleName=function(){return"ListDialog"},Gu.prototype.showListDialog=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),t=(e.setLocale(this.documentHelper.owner.locale),!1),i=(this.target||(this.initListDialog(e,this.documentHelper.owner.enableRtl),t=!0),this.isListCharacterFormat=!0,this.documentHelper.dialog2.header=e.getConstant("Define new Multilevel list"),this.documentHelper.dialog2.height="auto",this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.content=this.target,this.documentHelper.owner.enableRtl),n=i?"e-flat e-list-dlg-font e-de-dlg-target.e-de-rtl e-font-rtl":"e-flat e-list-dlg-font e-font";this.documentHelper.dialog2.buttons=[{click:this.showFontDialog,buttonModel:{content:e.getConstant("Font"),cssClass:n}},{click:this.onApplyList,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-list-dlg",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-list-dlg"}}],this.documentHelper.dialog2.element;this.documentHelper.dialog2.dataBind(),t&&this.wireAndBindEvent(e,i),this.documentHelper.dialog2.beforeOpen=this.loadListDialog,this.documentHelper.dialog2.close=this.closeListDialog,this.documentHelper.dialog2.position={X:"center",Y:"top"},this.documentHelper.dialog2.show()},Gu.prototype.initListDialog=function(e,t){var i=this.documentHelper.owner.containerId,n=(this.target=_.createElement("div",{id:i+"_insert_list",className:"e-de-list-dlg"}),_.createElement("div",{innerHTML:'<label id="'+i+'_listLevellabel" style="display:block;" class=e-de-list-ddl-header-list-level>'+e.getConstant("List level")+'</label><label id="'+i+'_modifyLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Choose level to modify")+'</label><select style="height:20px;width:43%" id="'+i+'_listLevel"><option>'+e.getConstant("Level")+" 1</option><option>"+e.getConstant("Level")+" 2</option><option>"+e.getConstant("Level")+" 3</option><option>"+e.getConstant("Level")+" 4</option><option>"+e.getConstant("Level")+" 5</option><option>"+e.getConstant("Level")+" 6</option><option>"+e.getConstant("Level")+" 7</option><option>"+e.getConstant("Level")+" 8</option><option>"+e.getConstant("Level")+" 9</option></select>"})),n=(this.target.appendChild(n),_.createElement("div")),r=t?'<div style="float:right;display:block;width:241px;">':'<div style="float:left;display:block;">',o=_.createElement("div",{innerHTML:r+'<label id="'+i+'_numberFormatLabel" style="display:block;" class=e-de-list-ddl-header>'+e.getConstant("Number format")+'</label><label id="'+i+'_numberStyleLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Number style for this level")+'</label><select style="height:20px;width:100%" id="'+i+'_numberStyle"><option>'+e.getConstant("Arabic")+"</option><option>"+e.getConstant("UpRoman")+"</option><option>"+e.getConstant("LowRoman")+"</option><option>"+e.getConstant("UpLetter")+"</option><option>"+e.getConstant("LowLetter")+"</option><option>"+e.getConstant("Number")+"</option><option>"+e.getConstant("Leading zero")+"</option><option>"+e.getConstant("Bullet")+"</option><option>"+e.getConstant("Ordinal")+"</option><option>"+e.getConstant("Ordinal Text")+"</option><option>"+e.getConstant("Special")+"</option><option>"+e.getConstant("For East")+'</option></select><label id="'+i+'_startAtLabel" style="display:block;" class=e-de-list-ddl-subheaderbottom>'+e.getConstant("Start at")+'</label><input type="text" id="'+i+'_startAt">'}),n=(n.appendChild(o),this.numberFormatDiv=_.createElement("div",{className:"e-de-list-dlg-subdiv",innerHTML:'<div><div><label id="'+i+'_formatLabel" style="display:inline-block;width:86%" class=e-de-list-ddl-subheader>'+e.getConstant("Enter formatting for number")+'</label><button type="button" id="'+i+'_list_info" class="e-control e-btn e-primary e-de-list-format-info">i</button></div><input style=width:180px; type="text" id="'+i+'_numberFormat" aria-label="numberFormat" class=e-input></div><label id="'+i+'_restartLabel" style="display:block;" class=e-de-list-ddl-subheaderbottom>'+e.getConstant("Restart list after")+'</label><select style="height:20px;width:100%" id="'+i+'_restartBy"><option>'+e.getConstant("No Restart")+"</option></select></div>"}),n.appendChild(this.numberFormatDiv),this.target.appendChild(n),_.createElement("div",{innerHTML:r+'<label id="'+i+'_IndentsLabel" style='+(o=t?"display:block;position:relative; ":"display:block; ")+"class=e-de-list-ddl-header>"+e.getConstant("Position")+'</label><label id="'+i+'_textIndentLabel" style='+o+"class=e-de-list-ddl-subheader>"+e.getConstant("Text indent at")+'</label><input type="text" id="'+i+'_textIndent"><label id="'+i+'_followCharacterLabel" style='+o+"class=e-de-list-ddl-subheaderbottom>"+e.getConstant("Follow number with")+'</label><select style="height:20px;width:100%" id="'+i+'_followCharacter"><option>'+e.getConstant("Tab character")+"</option><option>"+e.getConstant("Space")+"</option><option>"+e.getConstant("Nothing")+'</option></select></div><div id="e-de-list-dlg-div" class="e-de-list-dlg-div"><label id="'+i+'_alignedAtLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Aligned at")+'</label><input type="text" id="'+i+'_alignedAt"></div>'}));this.target.appendChild(n)},Gu.prototype.wireAndBindEvent=function(e,t){var i=this.documentHelper.owner.containerId,n=(t&&(document.getElementById("e-de-list-dlg-div").classList.add("e-de-rtl"),this.numberFormatDiv.classList.add("e-de-rtl")),document.getElementById(i+"_startAt")),r=(n.setAttribute("aria-label","startAt"),document.getElementById(i+"_textIndent")),o=(r.setAttribute("aria-label","textIndent"),document.getElementById(i+"_alignedAt")),n=(o.setAttribute("aria-label","alignedAt"),this.startAt=new D.NumericTextBox({format:"#",decimals:0,min:0,max:50,width:"180px",enablePersistence:!1}),this.startAt.addEventListener("change",this.onStartValueChanged),this.startAt.appendTo(n),this.textIndent=new D.NumericTextBox({format:"#",decimals:0,min:0,max:1584,width:"180px",step:4,enablePersistence:!1}),this.textIndent.addEventListener("change",this.onTextIndentChanged),this.textIndent.appendTo(r),this.alignedAt=new D.NumericTextBox({format:"#",max:1584,step:6,width:"180px",enablePersistence:!1}),this.alignedAt.addEventListener("change",this.onAlignedAtValueChanged),this.alignedAt.appendTo(o),document.getElementById(i+"_listLevel")),r=(this.listLevelElement=new U.DropDownList({popupHeight:"150px",width:"180px",enableRtl:t,change:this.onListLevelValueChanged}),this.listLevelElement.appendTo(n),document.getElementById(i+"_followCharacter")),o=(this.followNumberWith=new U.DropDownList({popupHeight:"150px",width:"180px",enableRtl:t,change:this.onFollowCharacterValueChanged}),this.followNumberWith.appendTo(r),document.getElementById(i+"_numberStyle")),n=(this.numberStyle=new U.DropDownList({popupHeight:"150px",width:"180px",enableRtl:t,change:this.onLevelPatternValueChanged}),this.numberStyle.appendTo(o),this.numberFormat=document.getElementById(i+"_numberFormat"),this.numberFormat.addEventListener("change",this.onNumberFormatChanged),document.getElementById(i+"_restartBy")),r=(this.restartBy=new U.DropDownList({popupHeight:"150px",width:"180px",enableRtl:t}),this.restartBy.appendTo(n),document.getElementById(i+"_list_info"));this.formatInfoToolTip=new C.Tooltip({width:200}),this.formatInfoToolTip.content=e.getConstant("Number format tooltip information"),this.formatInfoToolTip.position="RightTop",this.formatInfoToolTip.appendTo(r)},Gu.prototype.updateRestartLevelBox=function(){for(var e=this.documentHelper.owner.containerId,t=document.getElementById(e+"_listLevel"),i=document.getElementById(e+"_restartBy"),n=0;n<i.options.length;)i.options.remove(n);if(0!==t.selectedIndex)for(n=t.selectedIndex;0<n;n--){var r=document.createElement("option");r.value="Level "+n,r.innerHTML="Level "+n,i.appendChild(r)}(e=document.createElement("option")).value="No Restart",e.innerHTML="No Restart",i.appendChild(e),i.selectedIndex=0},Gu.prototype.listPatternConverter=function(e){switch(e){case"Arabic":return 0;case"UpRoman":return 1;case"LowRoman":return 2;case"UpLetter":return 3;case"LowLetter":return 4;case"Number":return 5;case"LeadingZero":return 6;case"Bullet":return 7;case"Ordinal":return 8;case"OrdinalText":return 9;case"Special":return 10;case"FarEast":return 11;default:return 12}},Gu.prototype.followCharacterConverter=function(e){switch(e){case"Tab":return 0;case"Space":return 1;default:return 2}},Gu.prototype.calculateAlignedAt=function(){return this.viewModel.listLevel.paragraphFormat.firstLineIndent<0?this.viewModel.listLevel.paragraphFormat.leftIndent+this.viewModel.listLevel.paragraphFormat.firstLineIndent:this.viewModel.listLevel.paragraphFormat.firstLineIndent},Gu.prototype.updateDialogValues=function(){_.isNullOrUndefined(this.listLevel.characterFormat)&&(this.listLevel.characterFormat=new B(this.viewModel.listLevel)),_.isNullOrUndefined(this.listLevel.paragraphFormat)&&(this.listLevel.paragraphFormat=new Xa(this.viewModel.listLevel)),_.isNullOrUndefined(this.viewModel)||_.isNullOrUndefined(this.viewModel.listLevel)||(this.startAt.value=this.viewModel.listLevel.startAt,this.textIndent.value=this.viewModel.listLevel.paragraphFormat.leftIndent,this.alignedAt.value=this.calculateAlignedAt(),this.followNumberWith.index=this.followCharacterConverter(this.viewModel.followCharacter),this.numberFormat.value=this.viewModel.listLevel.numberFormat,this.numberFormat.style.fontFamily=this.viewModel.listLevel.characterFormat.fontFamily,this.numberStyle.index=this.listPatternConverter(this.viewModel.listLevelPattern),this.listLevelElement.index=this.viewModel.levelNumber)},Gu.prototype.updateCharacterFormat=function(e){this.listLevel.characterFormat.copyFormat(e)},Gu.prototype.disposeBindingForListUI=function(){this.followNumberWith.index=-1,this.numberFormat.value=" ",this.numberStyle.index=-1,this.listLevelElement.index=-1,this.restartBy.index=-1,this.viewModel.destroy()},Gu.prototype.destroy=function(){if(this.alignedAt&&this.alignedAt.destroy(),this.alignedAt=void 0,this.dialog=void 0,this.followNumberWith&&this.followNumberWith.destroy(),this.followNumberWith=void 0,this.listLevelElement&&this.listLevelElement.destroy(),this.listLevelElement=void 0,this.textIndent&&this.textIndent.destroy(),this.textIndent=void 0,this.startAt&&this.startAt.destroy(),this.startAt=void 0,this.numberStyle&&this.numberStyle.destroy(),this.numberStyle=void 0,this.numberFormat=void 0,this.restartBy&&this.restartBy.destroy(),this.restartBy=void 0,!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}this.documentHelper=void 0,this.viewModel=void 0};var ju=Gu;function Gu(e){var i=this;this.dialog=void 0,this.target=void 0,this.documentHelper=void 0,this.viewModel=void 0,this.startAt=void 0,this.textIndent=void 0,this.alignedAt=void 0,this.listLevelElement=void 0,this.followNumberWith=void 0,this.numberStyle=void 0,this.numberFormat=void 0,this.restartBy=void 0,this.isListCharacterFormat=!1,this.onTextIndentChanged=function(e){e.isInteracted&&(i.viewModel.listLevel.paragraphFormat.leftIndent=e.value)},this.onStartValueChanged=function(e){!e.isInteracted||_.isNullOrUndefined(i.viewModel)||_.isNullOrUndefined(i.viewModel.listLevel)||(i.viewModel.listLevel.startAt=e.value)},this.onListLevelValueChanged=function(e){i.viewModel.levelNumber=parseInt(e.value.slice(e.value.length-1),10)-1,_.isNullOrUndefined(i.listLevel)||(i.updateDialogValues(),i.updateRestartLevelBox())},this.onNumberFormatChanged=function(e){i.viewModel.listLevel.numberFormat=e.target.value},this.onAlignedAtValueChanged=function(e){e.isInteracted&&(i.viewModel.listLevel.paragraphFormat.firstLineIndent=i.alignedAt.value-i.viewModel.listLevel.paragraphFormat.leftIndent)},this.onFollowCharacterValueChanged=function(e){e.isInteracted&&(i.viewModel.followCharacter=e.value)},this.onLevelPatternValueChanged=function(e){var t;e.isInteracted&&(i.viewModel.listLevelPattern=e.value,e="%"+(i.levelNumber+1).toString(),t=document.getElementById(i.documentHelper.owner.containerId+"_numberFormat"),"Bullet"===i.listLevel.listLevelPattern?i.listLevel.numberFormat=String.fromCharCode(61623):("None"===i.listLevel.listLevelPattern&&(i.listLevel.numberFormat=""),i.listLevel.numberFormat.match(e)||"None"===i.listLevel.listLevelPattern||(i.listLevel.numberFormat=e+".")),t.value=i.listLevel.numberFormat)},this.loadListDialog=function(){i.documentHelper.updateFocus(),_.isNullOrUndefined(i.documentHelper.owner)||(i.viewModel=new qu,0<(i.viewModel.dialog=i).documentHelper.selection.paragraphFormat.listLevelNumber&&(i.viewModel.levelNumber=i.documentHelper.selection.paragraphFormat.listLevelNumber),i.viewModel.list=i.documentHelper.selection.paragraphFormat.getList(),_.isNullOrUndefined(i.listLevel))||(i.updateDialogValues(),"none"!==i.documentHelper.selection.caret.style.display&&(i.documentHelper.selection.caret.style.display="none"))},this.showFontDialog=function(){i.documentHelper.owner.fontDialogModule.showFontDialog(i.listLevel.characterFormat,!0)},this.onApplyList=function(){_.isNullOrUndefined(i.owner)||i.documentHelper.selection.paragraphFormat.setList(i.list,!0),i.documentHelper.dialog2.hide(),i.documentHelper.updateFocus()},this.onCancelButtonClick=function(){i.disposeBindingForListUI(),i.documentHelper.dialog2.hide(),i.documentHelper.updateFocus(),i.isListCharacterFormat=!1},this.closeListDialog=function(){i.disposeBindingForListUI(),i.documentHelper.updateFocus(),i.isListCharacterFormat=!1},this.documentHelper=e,this.viewModel=new qu}Zu.prototype.getModuleName=function(){return"StyleDialog"},Zu.prototype.initStyleDialog=function(e,t){this.localObj=e,this.target=_.createElement("div",{className:"e-de-style-dialog"});var i=_.createElement("div"),n=_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Properties")}),n=(i.appendChild(n),_.createElement("div",{className:"e-de-container-row"})),r=(i.appendChild(n),_.createElement("div",{className:"e-de-subcontainer-left"})),o=(n.appendChild(r),_.createElement("input",{className:"e-input e-de-style-dlg-name-input"})),o=(o.addEventListener("keyup",this.updateOkButton),o.addEventListener("input",this.updateOkButton),o.addEventListener("blur",this.updateNextStyle),r.appendChild(o),new D.TextBox({placeholder:e.getConstant("Name")+":",floatLabelType:"Always"},o),_.createElement("div",{className:"e-de-subcontainer-right"})),n=(n.appendChild(o),_.createElement("div")),s=_.createElement("select"),s=(s.innerHTML='<option value="Paragraph">'+e.getConstant("Paragraph")+'</option><option value="Character">'+e.getConstant("Character")+'</option><option value="Linked Style">'+e.getConstant("Linked Style")+"</option>",n.appendChild(s),this.styleType=new U.DropDownList({change:this.styleTypeChange,popupHeight:"253px",enableRtl:t,placeholder:e.getConstant("Style type")+":",floatLabelType:"Always"}),this.styleType.appendTo(s),o.appendChild(n),_.createElement("div",{className:"e-de-container-row"})),o=(i.appendChild(s),_.createElement("div",{className:"e-de-subcontainer-left"})),n=(s.appendChild(o),_.createElement("div",{className:"e-de-style-style-based-on-div"})),a=_.createElement("input"),a=(n.appendChild(a),this.styleBasedOn=new U.DropDownList({dataSource:[],select:this.styleBasedOnChange,popupHeight:"253px",enableRtl:t,placeholder:e.getConstant("Style based on")+":",floatLabelType:"Always"}),this.styleBasedOn.appendTo(a),o.appendChild(n),_.createElement("div",{className:"e-de-subcontainer-right"})),n=(s.appendChild(a),t&&(r.classList.add("e-de-rtl"),o.classList.add("e-de-rtl"),a.classList.add("e-de-rtl")),_.createElement("div")),s=_.createElement("input"),r=(n.appendChild(s),this.styleParagraph=new U.DropDownList({dataSource:[],select:this.styleParagraphChange,popupHeight:"253px",enableRtl:t,placeholder:e.getConstant("Style for following paragraph")+":",floatLabelType:"Always"}),this.styleParagraph.appendTo(s),a.appendChild(n),_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Formatting")})),o=(i.appendChild(r),_.createElement("div",{className:"e-de-style-options-div"})),s=(i.appendChild(o),_.createElement("div",{styles:"display:flex;margin-bottom: 14px;"})),a=(o.appendChild(s),this.createFontOptions(s,t),_.createElement("div",{styles:"display:flex",className:"e-style-paragraph"}));o.appendChild(a),this.createParagraphOptions(a),this.createFormatDropdown(i,e,t),this.target.appendChild(i)},Zu.prototype.createFormatDropdown=function(e,t,i){var n=this,r=_.createElement("button",{id:"style_format_dropdown",innerHTML:t.getConstant("Format"),attrs:{type:"button"}}),e=(r.style.height="31px",e.appendChild(r),[{text:t.getConstant("Font")+"...",id:"style_font"},{text:t.getConstant("Paragraph")+"...",id:"style_paragraph"},{text:t.getConstant("Numbering")+"...",id:"style_numbering"}]);this.styleDropdwn=new w.DropDownButton({items:e,cssClass:"e-de-style-format-dropdwn",enableRtl:i,beforeItemRender:function(e){n.styleType.value===t.getConstant("Character")?("style_paragraph"===e.item.id&&e.element.classList.add("e-disabled"),"style_numbering"===e.item.id&&e.element.classList.add("e-disabled")):("style_paragraph"===e.item.id&&e.element.classList.remove("e-disabled"),"style_numbering"===e.item.id&&e.element.classList.remove("e-disabled"))}}),this.styleDropdwn.appendTo(r),this.styleDropdwn.addEventListener("select",this.openDialog)},Zu.prototype.createFontOptions=function(e,t){for(var i=this,n=_.createElement("input",{id:this.target.id+"_fontName"}),r=_.initializeCSPTemplate(function(e){return'<span style="font-family: '+e.FontName+';">'+e.FontName+"</span>"}),o=(e.appendChild(n),this.fontFamily=new U.ComboBox({dataSource:void 0,query:(new b.Query).select(["FontName"]),fields:{text:"FontName",value:"value"},allowCustom:!0,width:"123px",popupWidth:"123px",cssClass:"e-style-font-fmaily-right",enableRtl:t,change:this.fontFamilyChanged,showClearButton:!1,itemTemplate:r}),this.fontFamily.appendTo(n),this.fontFamily.isStringTemplate=!0,this.documentHelper.owner.documentEditorSettings.fontFamilies),s=0;s<o.length;s++){var a=o[s];this.fontFamily.addItem({FontName:a,value:a},s)}this.fontFamily.focus=function(){i.fontFamily.element.select()},this.fontFamily.element.parentElement.setAttribute("title",this.localObj.getConstant("Font"));var r=_.createElement("input"),n=(e.appendChild(r),this.fontSize=new U.ComboBox({dataSource:[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],width:"73px",cssClass:"e-style-font-fmaily-right",enableRtl:t,change:this.fontSizeUpdate}),this.fontSize.showClearButton=!1,this.fontSize.appendTo(r),_.createElement("div",{className:"e-de-style-font-group-button"})),r=(e.appendChild(n),this.bold=this.createButtonElement(n,"e-de-bold","e-de-style-bold-button-size",this.documentHelper.owner.containerId+"_style_bold"),this.bold.setAttribute("aria-label","bold"),this.bold.addEventListener("click",this.setBoldProperty),this.italic=this.createButtonElement(n,"e-de-italic","e-de-style-icon-button-size",this.documentHelper.owner.containerId+"_style_italic"),this.italic.setAttribute("aria-label","italic"),this.italic.addEventListener("click",this.setItalicProperty),this.underline=this.createButtonElement(n,"e-de-underline","e-de-style-icon-button-size",this.documentHelper.owner.containerId+"_style_underline"),this.underline.setAttribute("aria-label","underline"),this.underline.addEventListener("click",this.setUnderlineProperty),_.createElement("input",{attrs:{type:"color"},className:"e-de-style-icon-button-size"})),n=(e.appendChild(r),this.documentHelper.owner.documentEditorSettings.colorPickerSettings),e=n.columns,l=n.createPopupOnClick,d=n.disabled,h=n.enablePersistence,c=(n.enableRtl,n.inline),p=n.mode,u=n.modeSwitcher,g=n.noColor,m=n.presetColors,n=n.showButtons;this.fontColor=new D.ColorPicker({cssClass:"e-de-style-font-color-picker",enableRtl:t,change:this.fontColorUpdate,locale:this.documentHelper.owner.locale,enableOpacity:!1,mode:p,modeSwitcher:u,showButtons:n,columns:e,createPopupOnClick:l,disabled:d,enablePersistence:h,inline:c,noColor:g,presetColors:m}),this.documentHelper.fontColor=this.fontColor,this.fontColor.appendTo(r)},Zu.prototype.createParagraphOptions=function(e){var t=this,i=_.createElement("div",{className:"e-de-style-paragraph-group-button"}),i=(e.appendChild(i),this.leftAlign=this.createButtonElement(i,"e-de-align-left","e-de-style-icon-button-size"),this.leftAlign.setAttribute("aria-label","leftAlign"),this.leftAlign.addEventListener("click",this.setLeftAlignment),this.centerAlign=this.createButtonElement(i,"e-de-align-center","e-de-style-icon-button-size"),this.centerAlign.setAttribute("aria-label","centerAlign"),this.centerAlign.addEventListener("click",this.setCenterAlignment),this.rightAlign=this.createButtonElement(i,"e-de-align-right","e-de-style-icon-button-size"),this.rightAlign.setAttribute("aria-label","rightAlign"),this.rightAlign.addEventListener("click",this.setRightAlignment),this.justify=this.createButtonElement(i,"e-de-justify","e-de-style-icon-button-last-size"),this.justify.setAttribute("aria-label","justify"),this.justify.addEventListener("click",this.setJustifyAlignment),_.createElement("div",{className:"e-de-style-paragraph-group-button"})),i=(e.appendChild(i),this.singleLineSpacing=this.createButtonElement(i,"e-de-single-spacing","e-de-style-icon-button-first-size"),this.singleLineSpacing.setAttribute("aria-label","singleLineSpacing"),this.singleLineSpacing.addEventListener("click",function(){t.lineSpacing=1,t.updateParagraphFormat()}),this.onePointFiveLineSpacing=this.createButtonElement(i,"e-de-one-point-five-spacing","e-de-style-icon-button-size"),this.onePointFiveLineSpacing.setAttribute("aria-label","onePointFiveLineSpacing"),this.onePointFiveLineSpacing.addEventListener("click",function(){t.lineSpacing=1.5,t.updateParagraphFormat()}),this.doubleLineSpacing=this.createButtonElement(i,"e-de-double-spacing","e-de-style-icon-button-last-size"),this.doubleLineSpacing.setAttribute("aria-label","doubleLineSpacing"),this.doubleLineSpacing.addEventListener("click",function(){t.lineSpacing=2,t.updateParagraphFormat()}),_.createElement("div",{className:"e-de-style-paragraph-group-button"})),n=(e.appendChild(i),this.createButtonElement(i,"e-de-before-spacing","e-de-style-icon-button-first-size")),i=(n.setAttribute("aria-label","beforeSpacing"),this.createButtonElement(i,"e-de-after-spacing","e-de-style-icon-button-last-size")),n=(i.setAttribute("aria-label","afterSpacing"),n.addEventListener("click",this.increaseBeforeAfterSpacing),i.addEventListener("click",this.decreaseBeforeAfterSpacing),_.createElement("div",{className:"e-de-style-paragraph-indent-group-button"})),i=(e.appendChild(n),this.createButtonElement(n,"e-de-indent","e-de-style-icon-button-first-size")),e=(i.setAttribute("aria-label","decreaseIndent"),i.addEventListener("click",function(){36<=t.leftIndent?t.leftIndent-=36:t.leftIndent=0}),this.createButtonElement(n,"e-de-outdent","e-de-style-icon-button-size"));e.setAttribute("aria-label","increaseindent"),e.addEventListener("click",function(){t.leftIndent+=36})},Zu.prototype.createButtonElement=function(e,t,i,n){var r=_.createElement("button",{attrs:{type:"button"}});return _.isNullOrUndefined(n)||(r.id=n),e.appendChild(r),new H.Button({iconCss:t,cssClass:i}).appendTo(r),r},Zu.prototype.toggleDisable=function(){this.styleType.value===this.localObj.getConstant("Character")?(this.styleParagraph.enabled=!1,this.target.getElementsByClassName("e-style-paragraph").item(0).setAttribute("style","display:flex;pointer-events:none;opacity:0.5")):(this.styleParagraph.enabled=!0,this.target.getElementsByClassName("e-style-paragraph").item(0).removeAttribute("style"),this.target.getElementsByClassName("e-style-paragraph").item(0).setAttribute("style","display:flex")),this.styleBasedOn.enabled=!0},Zu.prototype.show=function(e,t){var i=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),n=(this.isEdit=!_.isNullOrUndefined(e)&&0<e.length,this.editStyleName=e,this.abstractList=new Hl,this.documentHelper.styles.findByName(e));this.style=this.isEdit?n||this.getStyle(e):new ul,i.setLocale(this.documentHelper.owner.locale),this.target||this.initStyleDialog(i,this.documentHelper.owner.enableRtl),this.isEdit?this.styleType.value=this.style instanceof fl?"Character":"Paragraph":this.styleType.value="Paragraph",_.isNullOrUndefined(t)&&(t=i.getConstant("Create New Style")),this.documentHelper.dialog2.header=t,this.documentHelper.dialog2.height="auto",this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.content=this.target,this.documentHelper.dialog2.buttons=[{click:this.onOkButtonClick,buttonModel:{content:i.getConstant("Ok"),cssClass:"e-flat e-style-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat e-style-cancel"}}],this.toggleDisable(),this.documentHelper.dialog2.dataBind(),this.documentHelper.dialog2.beforeOpen=this.loadStyleDialog,this.documentHelper.dialog2.close=this.closeStyleDialog,this.documentHelper.dialog2.position={X:"center",Y:"center"},this.documentHelper.dialog2.show()},Zu.prototype.updateList=function(){var t=this.style.paragraphFormat.listFormat.listId;-1<t&&(0!==this.documentHelper.lists.filter(function(e){return e.listId===t}).length&&(this.documentHelper.lists=this.documentHelper.lists.filter(function(e){return e.listId!==t})),this.documentHelper.lists.push(this.style.paragraphFormat.listFormat.list)),-1!==this.abstractList.abstractListId&&this.documentHelper.abstractLists.push(this.abstractList)},Zu.prototype.createLinkStyle=function(e,t){var i=t?this.documentHelper.styles.findByName(e+" Char","Character"):new fl;return i.type="Character",i.name=e+" Char",i.characterFormat=this.style.characterFormat.cloneFormat(),i.basedOn=this.style.basedOn,t||this.documentHelper.styles.push(i),this.documentHelper.styles.findByName(i.name,"Character")},Zu.prototype.updateCharacterFormat=function(e){_.isNullOrUndefined(e)||(this.characterFormat=e.cloneFormat()),this.fontFamily.value=this.characterFormat.fontFamily,this.fontSize.value=this.characterFormat.fontSize;e=this.characterFormat.fontColor;this.fontColor.value="empty"===e||"#00000000"===e?"#000000":e,this.fontButtonClicked()},Zu.prototype.updateParagraphFormat=function(e){_.isNullOrUndefined(e)||(this.paragraphFormat=e.cloneFormat(),this.textAlignment=e.textAlignment,this.lineSpacing=e.lineSpacing),_.isNullOrUndefined(this.paragraphFormat)||("Left"===this.textAlignment?(this.leftAlign.classList.contains("e-active")||this.leftAlign.classList.add("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Right"===this.textAlignment?(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")||this.rightAlign.classList.add("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Center"===this.textAlignment?(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")||this.centerAlign.classList.add("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Justify"===this.textAlignment&&(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")||this.justify.classList.add("e-active")),1===this.lineSpacing?(this.singleLineSpacing.classList.add("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.remove("e-active")):1.5===this.lineSpacing?(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.add("e-active"),this.doubleLineSpacing.classList.remove("e-active")):2===this.lineSpacing?(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.add("e-active")):(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.remove("e-active")))},Zu.prototype.enableOrDisableOkButton=function(){_.isNullOrUndefined(this.okButton)||(this.okButton.disabled=""===this.styleNameElement.value)},Zu.prototype.getTypeValue=function(e){e=_.isNullOrUndefined(e)?this.styleType.value:e;return"Linked Style"===e||"Paragraph"===e?"Paragraph":"Character"},Zu.prototype.updateStyleNames=function(e,t){for(var i,n,r,o=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),s=(o.setLocale(this.documentHelper.owner.locale),this.documentHelper.styles.getStyleNames(e)),a=[],l=0;l<s.length;l++)""===(r=o.getConstant(s[parseInt(l.toString(),10)]))&&(r=s[parseInt(l.toString(),10)]),a.push(r);this.styleParagraph.dataSource=a,this.styleParagraph.index=null,t?(this.styleBasedOn.dataSource=a.filter(function(e){return e!==t}),this.styleBasedOn.index=null,(i=this.getStyle(t)).basedOn instanceof String||_.isNullOrUndefined(i.basedOn)?this.styleBasedOn.enabled=!1:this.styleBasedOn.index=-1<s.indexOf(i.basedOn.name)?s.indexOf(i.basedOn.name):0,"Paragraph"===i.type?_.isNullOrUndefined(i.link)?this.styleType.index=0:this.styleType.index=2:this.styleType.index=1,_.isNullOrUndefined(i.next)||(i=i.next.name,n=0,-1<s.indexOf(i)&&(n=s.indexOf(i)),this.styleParagraph.index=n,this.isUserNextParaUpdated=i!==t)):(this.styleBasedOn.dataSource=a,this.styleBasedOn.index=null,n=0,this.documentHelper.owner.selectionModule&&(r=void 0,r=("Character"===e?this.documentHelper.owner.selectionModule.characterFormat:this.documentHelper.owner.selectionModule.paragraphFormat).styleName,n=s.indexOf(r)),this.styleBasedOn.index=n,this.styleParagraph.index=0),this.isEdit?this.styleType.enabled=!1:this.styleType.enabled=!0},Zu.prototype.getStyle=function(e){return _.isNullOrUndefined(this.documentHelper.styles.findByName(e))&&this.documentHelper.owner.editorModule.createStyle(this.documentHelper.preDefinedStyles.get(e)),this.documentHelper.styles.findByName(e)},Zu.prototype.destroy=function(){if(!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.fontColor&&(this.fontColor.destroy(),this.fontColor=void 0),this.fontSize&&(this.fontSize.destroy(),this.fontSize=void 0),this.fontFamily&&(this.fontFamily.destroy(),this.fontFamily=void 0),this.styleType&&(this.styleType.destroy(),this.styleType=void 0),this.styleBasedOn&&(this.styleBasedOn.destroy(),this.styleBasedOn=void 0),this.styleParagraph&&(this.styleParagraph.destroy(),this.styleParagraph=void 0),this.onlyThisDocument&&this.onlyThisDocument.destroy(),this.onlyThisDocument=void 0,this.template&&(this.template.destroy(),this.template=void 0),this.style&&(this.style.destroy(),this.style=void 0),this.abstractList&&(this.abstractList.destroy(),this.abstractList=void 0),this.numberingBulletDialog&&(this.numberingBulletDialog.destroy(),this.numberingBulletDialog=void 0),this.styleDropdwn&&(this.styleDropdwn.destroy(),this.styleDropdwn=void 0),this.textAlignment&&(this.textAlignment=void 0),this.lineSpacing&&(this.lineSpacing=void 0),this.leftIndent&&(this.leftIndent=void 0),this.beforeSpacing&&(this.beforeSpacing=void 0),this.afterSpacing&&(this.afterSpacing=void 0),this.documentHelper=void 0};var Ku=Zu;function Zu(e){var s=this;this.target=void 0,this.styleType=void 0,this.styleBasedOn=void 0,this.styleParagraph=void 0,this.onlyThisDocument=void 0,this.template=void 0,this.fontFamily=void 0,this.fontSize=void 0,this.characterFormat=void 0,this.paragraphFormat=void 0,this.textAlignment=void 0,this.lineSpacing=void 0,this.leftIndent=void 0,this.beforeSpacing=void 0,this.afterSpacing=void 0,this.openDialog=function(e){switch(e.item.id){case"style_font":s.showFontDialog();break;case"style_paragraph":s.showParagraphDialog();break;case"style_numbering":s.showNumberingBulletDialog()}},this.setBoldProperty=function(){s.characterFormat.bold=!s.characterFormat.bold,s.fontButtonClicked()},this.setItalicProperty=function(){s.characterFormat.italic=!s.characterFormat.italic,s.fontButtonClicked()},this.setUnderlineProperty=function(){s.characterFormat.underline="None"===s.characterFormat.underline?"Single":"None",s.fontButtonClicked()},this.fontButtonClicked=function(){s.characterFormat.bold?s.bold.classList.contains("e-active")||s.bold.classList.add("e-active"):s.bold.classList.contains("e-active")&&s.bold.classList.remove("e-active"),s.characterFormat.italic?s.italic.classList.contains("e-active")||s.italic.classList.add("e-active"):s.italic.classList.contains("e-active")&&s.italic.classList.remove("e-active"),void 0!==s.characterFormat.underline&&"None"!==s.characterFormat.underline?s.underline.classList.contains("e-active")||(s.underline.classList.add("e-active"),s.characterFormat.underline="Single"):s.underline.classList.contains("e-active")&&(s.underline.classList.remove("e-active"),s.characterFormat.underline="None")},this.fontSizeUpdate=function(e){s.characterFormat.fontSize=e.value},this.fontFamilyChanged=function(e){s.characterFormat.fontFamily=e.value.toString()},this.fontColorUpdate=function(e){s.characterFormat.fontColor=e.currentValue.hex},this.setLeftAlignment=function(){"Left"===s.textAlignment?s.textAlignment="Justify":s.textAlignment="Left",s.updateParagraphFormat()},this.setRightAlignment=function(){"Right"===s.textAlignment?s.textAlignment="Left":s.textAlignment="Right",s.updateParagraphFormat()},this.setCenterAlignment=function(){"Center"===s.textAlignment?s.textAlignment="Left":s.textAlignment="Center",s.updateParagraphFormat()},this.setJustifyAlignment=function(){"Justify"===s.textAlignment?s.textAlignment="Left":s.textAlignment="Justify",s.updateParagraphFormat()},this.increaseBeforeAfterSpacing=function(){s.beforeSpacing+=6,s.afterSpacing+=6},this.decreaseBeforeAfterSpacing=function(){6<=s.beforeSpacing?s.beforeSpacing-=6:s.beforeSpacing=0,6<=s.afterSpacing?s.afterSpacing-=6:s.afterSpacing=0},this.updateNextStyle=function(e){var t,e=e.srcElement.value;s.getTypeValue()!==s.localObj.getConstant("Paragraph")||_.isNullOrUndefined(e)||""===e||s.isUserNextParaUpdated||(t=s.documentHelper.styles.getStyleNames(s.getTypeValue()),(t=s.isEdit?t.filter(function(e){return e!==s.editStyleName}):t).push(e),s.styleParagraph.dataSource=t,s.styleParagraph.index=null,s.styleParagraph.index=t.indexOf(e))},this.updateOkButton=function(){s.target.getElementsByClassName("e-input e-de-style-dlg-name-input").item(0).value;s.enableOrDisableOkButton()},this.styleTypeChange=function(e){var t;e.isInteracted&&(t=void 0,"Character"===e.value&&(s.style=new fl,t="Character"),"Paragraph"!==e.value&&"Linked Style"!==e.value||(s.style=new ul,t="Paragraph"),s.toggleDisable(),s.updateStyleNames(t))},this.styleBasedOnChange=function(){},this.styleParagraphChange=function(e){e.isInteracted&&(s.isUserNextParaUpdated=!0)},this.showFontDialog=function(){_.isNullOrUndefined(s.documentHelper.owner.fontDialogModule)||s.documentHelper.owner.showFontDialog(s.characterFormat),s.updateCharacterFormat()},this.showParagraphDialog=function(){_.isNullOrUndefined(s.documentHelper.owner.paragraphDialogModule)||s.documentHelper.owner.showParagraphDialog(s.paragraphFormat)},this.showNumberingBulletDialog=function(){s.numberingBulletDialog=new Xu(s.documentHelper),s.style instanceof ul&&!_.isNullOrUndefined(s.style.paragraphFormat)&&s.numberingBulletDialog.showNumberBulletDialog(s.style.paragraphFormat.listFormat,s.abstractList)},this.onOkButtonClick=function(){var e=s.documentHelper.owner.stylesDialogModule.getStyleName(_.SanitizeHtmlHelper.sanitize(s.styleNameElement.value));if(!(0<e.length))throw new Error("Enter valid Style name");var t,i,n,r,o=s.documentHelper.styles.findByName(e);_.isNullOrUndefined(o)?((r=new("Paragraph"===s.getTypeValue()?ul:fl)).copyStyle(s.style),"Character"===s.getTypeValue()&&r.characterFormat.copyFormat(s.characterFormat),t=s.documentHelper.styles.findByName(s.documentHelper.owner.stylesDialogModule.getStyleName(s.styleBasedOn.value)),"Paragraph"!==s.styleType.value&&"Linked Style"!==s.styleType.value||(e===s.documentHelper.owner.stylesDialogModule.getStyleName(s.styleParagraph.value)?r.next=r:r.next=s.documentHelper.styles.findByName(s.documentHelper.owner.stylesDialogModule.getStyleName(s.styleParagraph.value)),s.updateList()),r.link="Linked Style"===s.styleType.value?s.createLinkStyle(e):void 0,r.type=s.getTypeValue(),r.name=e,r.basedOn=t,s.documentHelper.styles.push(r),s.documentHelper.addToStylesMap(r),t=e,s.documentHelper.owner.editorHistoryModule.initializeHistory("ModifyStyle"),s.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo&&"ModifyStyle"===s.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.action&&(n=r instanceof ul?r.paragraphFormat.listFormat.listId:-1,(n=s.documentHelper.owner.getStyleObject(r,n)).isNew=!0,s.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.modifiedProperties.push(n),s.applyParagraphFormat()),s.documentHelper.owner.editorHistoryModule.updateHistory(),r=s.style instanceof ul?s.style.paragraphFormat.listFormat.listId:-1,s.documentHelper.owner.setStyleData(t,r),s.documentHelper.owner.editorModule.isSkipOperationsBuild="Character"===s.styleType.value&&s.documentHelper.owner.enableCollaborativeEditing,s.documentHelper.owner.editorModule.applyStyle(t,!0),s.documentHelper.owner.editorModule.isSkipOperationsBuild=!1,s.documentHelper.owner.notify(Ne,{})):(s.documentHelper.owner.editorHistoryModule.initializeHistory("ModifyStyle"),"Paragraph"!==s.styleType.value&&"Linked Style"!==s.styleType.value||s.updateList(),s.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo&&"ModifyStyle"===s.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.action&&(i=o instanceof ul?o.paragraphFormat.listFormat.listId:-1,n=s.documentHelper.owner.getStyleObject(o,i),s.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.modifiedProperties.push(n),s.applyParagraphFormat()),s.documentHelper.owner.editorHistoryModule.updateHistory(),s.style.type=s.getTypeValue(),s.style.basedOn=s.documentHelper.styles.findByName(s.documentHelper.owner.stylesDialogModule.getStyleName(s.styleBasedOn.value)),"Paragraph"!==s.styleType.value&&"Linked Style"!==s.styleType.value||(s.style.next=s.documentHelper.styles.findByName(s.documentHelper.owner.stylesDialogModule.getStyleName(s.styleParagraph.value)),s.style.characterFormat.assignFormat(s.characterFormat),s.style.paragraphFormat.assignFormat(s.paragraphFormat,!0),s.style.link="Linked Style"===s.styleType.value?s.createLinkStyle(e,s.isEdit):void 0),s.style.name=o.name,t=o.name,s.style,r=s.style instanceof ul?s.style.paragraphFormat.listFormat.listId:-1,s.documentHelper.owner.setStyleData(t,r),s.documentHelper.owner.isShiftingEnabled=!0,s.documentHelper.owner.editorModule.isSkipOperationsBuild=s.documentHelper.owner.enableCollaborativeEditing,s.documentHelper.owner.editorModule.layoutWholeDocument(),s.documentHelper.owner.editorModule.isSkipOperationsBuild=!1,s.documentHelper.owner.isShiftingEnabled=!1),s.documentHelper.dialog2.hide(),s.documentHelper.updateFocus(),s.style,s.documentHelper.updateFocus()},this.loadStyleDialog=function(){var e;s.documentHelper.updateFocus(),s.isUserNextParaUpdated=!1,s.styleNameElement=s.target.getElementsByClassName("e-input e-de-style-dlg-name-input").item(0),s.styleNameElement.value=null,s.isEdit||(s.styleType.index=0),s.isEdit&&((e=new _.L10n("documenteditor",s.documentHelper.owner.defaultLocale)).setLocale(s.documentHelper.owner.locale),""===(e=e.getConstant(s.editStyleName))&&(e=s.editStyleName),s.styleNameElement.value=e,e=s.editStyleName),s.okButton=s.documentHelper.dialog2.element.getElementsByClassName("e-flat e-style-okay").item(0),s.enableOrDisableOkButton(),s.updateStyleNames(s.getTypeValue(),e),s.updateCharacterFormat(s.style.characterFormat),s.updateParagraphFormat(s.style.paragraphFormat)},this.applyParagraphFormat=function(){_.isNullOrUndefined(s.paragraphFormat)&&(s.paragraphFormat=new Xa),_.isNullOrUndefined(s.textAlignment)||(s.paragraphFormat.textAlignment=s.textAlignment),_.isNullOrUndefined(s.beforeSpacing)||(s.paragraphFormat.beforeSpacing=s.beforeSpacing),_.isNullOrUndefined(s.afterSpacing)||(s.paragraphFormat.afterSpacing=s.afterSpacing),_.isNullOrUndefined(s.leftIndent)||(s.paragraphFormat.leftIndent=s.leftIndent),_.isNullOrUndefined(s.lineSpacing)||(s.paragraphFormat.lineSpacing=s.lineSpacing),s.updateParagraphFormat()},this.onCancelButtonClick=function(){s.style=void 0,s.characterFormat=void 0,s.paragraphFormat=void 0,s.textAlignment=void 0,s.lineSpacing=void 0,s.leftIndent=void 0,s.beforeSpacing=void 0,s.afterSpacing=void 0,s.documentHelper.dialog2.hide(),s.documentHelper.updateFocus()},this.closeStyleDialog=function(){s.documentHelper.updateFocus(),s.textAlignment=void 0,s.lineSpacing=void 0,s.leftIndent=void 0,s.beforeSpacing=void 0,s.afterSpacing=void 0},this.documentHelper=e}Ju.prototype.getModuleName=function(){return"BulletsAndNumberingDialog"},Ju.prototype.initNumberingBulletDialog=function(e){var t=this.documentHelper.owner.containerId,i=(this.target=_.createElement("div",{id:t+"_insertNumberBulletDialog",className:"e-de-number-bullet-dlg"}),_.createElement("div",{id:t+"_tabNumberBulletDialog",className:"e-de-tab-number-bullet-dlg"}));this.target.appendChild(i),this.createNumberList(t,e),this.createBulletList(t,e),this.tabObj=new k.Tab({items:[{header:{text:_.createElement("div",{innerHTML:e.getConstant("Numbering")})},content:this.numberListDiv},{header:{text:_.createElement("div",{innerHTML:e.getConstant("Bullets")})},content:this.bulletListDiv}],heightAdjustMode:"None",width:"auto",selecting:this.onTabSelect.bind(this)}),this.tabObj.isStringTemplate=!0,this.tabObj.appendTo(i)},Ju.prototype.onTabSelect=function(e){e.preventFocus=!0,1===e.selectingIndex&&(this.bulletListDiv.style.display="block")},Ju.prototype.createNumberList=function(e,t){this.numberListDiv=_.createElement("div",{className:"e-de-style-numbered-list",id:e+"_Number"});var e=this.numberListDiv,i=_.createElement("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail"}),t=(e.appendChild(i),this.createNumberNoneListTag(i,t)),n=this.createNumberListTag(i,"1.","2.","3.","e-de-list-numbered-number-dot"),r=this.createNumberListTag(i,"1)","2)","3)","e-de-list-numbered-number-brace"),o=this.createNumberListTag(i,"I.","II.","III.","e-de-list-numbered-up-roman"),s=this.createNumberListTag(i,"A.","B.","C.","e-de-list-numbered-up-letter"),a=this.createNumberListTag(i,"a.","b.","c.","e-de-numbered-low-letter-dot"),l=this.createNumberListTag(i,"a)","b)","c)","e-de-list-numbered-low-letter-brace"),i=this.createNumberListTag(i,"i.","ii.","iii.","e-de-list-numbered-low-roman");t.addEventListener("click",this.numberListClick),n.addEventListener("click",this.numberListClick),r.addEventListener("click",this.numberListClick),o.addEventListener("click",this.numberListClick),s.addEventListener("click",this.numberListClick),l.addEventListener("click",this.numberListClick),a.addEventListener("click",this.numberListClick),i.addEventListener("click",this.numberListClick),this.target.appendChild(e)},Ju.prototype.createNumberListTag=function(e,t,i,n,r){r=_.createElement("li",{styles:"display:block",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size "+r}),e.appendChild(r),e="<div>"+t+'<span class="e-de-ui-list-line"></span></div><div>'+i+'<span class="e-de-ui-list-line">',t=_.createElement("div",{className:"e-de-ui-list-header-presetmenu",id:"e-de-ui-zlist0",innerHTML:e+="</span></div><div>"+n+'<span class="e-de-ui-list-line"> </span></div >'});return r.style.cssFloat="left",r.appendChild(t),r},Ju.prototype.createNumberNoneListTag=function(e,t){var i=_.createElement("li",{styles:"display:block",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size e-de-list-numbered-none"}),e=(e.appendChild(i),'<div class="e-de-ui-bullets e-de-bullet-icons">'+t.getConstant("None")+"</div>"),t=_.createElement("div",{className:"e-de-ui-list-header-presetmenu",id:"e-de-ui-zlist0",innerHTML:e});return i.style.cssFloat="left",i.appendChild(t),i},Ju.prototype.createBulletListTag=function(e,t,i,n){var r=_.createElement("li",{styles:"display:block;",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-bullet-menuitem-md e-de-list-items  e-de-list-item-size "+i}),e=(e.appendChild(r),"e-bullet-none"===i),i=_.createElement("div",{className:"e-de-ui-bullet-list-header-presetmenu e-de-bullet-icon-size",styles:e?"font-size:9px;text-align: center;top: 13px;left:-2px;line-height:normal;position: relative":""}),t=_.createElement("div",{className:e?"":t,innerHTML:e?n.getConstant("None"):""});return i.appendChild(t),r.appendChild(i),r},Ju.prototype.createBulletList=function(e,t){this.bulletListDiv=_.createElement("div",{className:"e-de-ui-bullet-list-header-presetmenu",id:e+"_Bullet"});var e=this.bulletListDiv,i=(e.style.display="none",_.createElement("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail"})),t=(e.appendChild(i),this.createBulletListTag(i,"e-de-icon-bullet-list-none e-de-bullet-icons","e-bullet-none",t)),n=this.createBulletListTag(i,"e-de-icon-bullet-list-dot e-de-bullet-icons","e-bullet-dot"),r=this.createBulletListTag(i,"e-de-icon-bullet-list-circle e-de-bullet-icons","e-bullet-circle"),o=this.createBulletListTag(i,"e-de-icon-bullet-list-square e-de-bullet-icons","e-bullet-square"),s=this.createBulletListTag(i,"e-de-icon-bullet-list-flower e-de-bullet-icons","e-bullet-flower"),a=this.createBulletListTag(i,"e-de-icon-bullet-list-arrow e-de-bullet-icons","e-bullet-arrow"),i=this.createBulletListTag(i,"e-de-icon-bullet-list-tick e-de-bullet-icons","e-bullet-tick");t.addEventListener("click",this.bulletListClick),n.addEventListener("click",this.bulletListClick),r.addEventListener("click",this.bulletListClick),o.addEventListener("click",this.bulletListClick),s.addEventListener("click",this.bulletListClick),a.addEventListener("click",this.bulletListClick),i.addEventListener("click",this.bulletListClick),this.target.appendChild(e)},Ju.prototype.showNumberBulletDialog=function(e,t){_.isNullOrUndefined(e)?this.listFormat=new ja:this.listFormat=e,_.isNullOrUndefined(this.listFormat.list)&&(this.listFormat.list=new Vu),_.isNullOrUndefined(t)?this.abstractList=new Hl:this.abstractList=t;e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initNumberingBulletDialog(e),this.documentHelper.dialog.header=e.getConstant("Numbering and Bullets"),this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadNumberingBulletDialog,this.documentHelper.dialog.close=this.closeNumberingBulletDialog,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.buttons=[{click:this.onOkButtonClick,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-numbering-bullet-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-numbering-bullet-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),this.tabObj.refresh()},Ju.prototype.setActiveElement=function(e){for(var t=e.currentTarget.parentElement,i=0;i<t.childElementCount;i++)t.childNodes[i].classList.contains("e-de-list-active")&&t.childNodes[i].classList.remove("e-de-list-active");e.currentTarget.classList.add("e-de-list-active")},Ju.prototype.unWireEventsAndBindings=function(){},Ju.prototype.destroy=function(){if(this.documentHelper=void 0,this.listFormat&&(this.listFormat.destroy(),this.listFormat=void 0),this.tabObj&&(this.tabObj.destroy(),this.tabObj=void 0),this.abstractList&&(this.abstractList.destroy(),this.abstractList=void 0),this.target&&this.target.parentElement){this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}this.bulletListDiv=void 0,this.numberListDiv=void 0};var Xu=Ju;function Ju(e){var t=this;this.isBullet=!1,this.numberListClick=function(e){t.isBullet=!1,t.setActiveElement(e),e.currentTarget.classList.contains("e-de-list-numbered-none")?(t.numberFormat=void 0,t.listLevelPattern=void 0):e.currentTarget.classList.contains("e-de-list-numbered-number-dot")?(t.numberFormat="%1.",t.listLevelPattern="Arabic"):e.currentTarget.classList.contains("e-de-list-numbered-number-brace")?(t.numberFormat="%1)",t.listLevelPattern="Arabic"):e.currentTarget.classList.contains("e-de-list-numbered-up-roman")?(t.numberFormat="%1.",t.listLevelPattern="UpRoman"):e.currentTarget.classList.contains("e-de-list-numbered-up-letter")?(t.numberFormat="%1.",t.listLevelPattern="UpLetter"):e.currentTarget.classList.contains("e-de-list-numbered-low-letter-brace")?(t.numberFormat="%1)",t.listLevelPattern="LowLetter"):e.currentTarget.classList.contains("e-de-numbered-low-letter-dot")?(t.numberFormat="%1.",t.listLevelPattern="LowLetter"):e.currentTarget.classList.contains("e-de-list-numbered-low-roman")&&(t.numberFormat="%1.",t.listLevelPattern="LowRoman")},this.bulletListClick=function(e){t.isBullet=!0,t.setActiveElement(e),e.currentTarget.classList.contains("e-bullet-none")?(t.symbol=void 0,t.fontFamily=void 0):e.currentTarget.classList.contains("e-bullet-dot")?(t.symbol=String.fromCharCode(61623),t.fontFamily="Symbol"):e.currentTarget.classList.contains("e-bullet-circle")?(t.symbol=String.fromCharCode(61551)+String.fromCharCode(32),t.fontFamily="Symbol"):e.currentTarget.classList.contains("e-bullet-square")?(t.symbol=String.fromCharCode(61607),t.fontFamily="Wingdings"):e.currentTarget.classList.contains("e-bullet-flower")?(t.symbol=String.fromCharCode(61558),t.fontFamily="Wingdings"):e.currentTarget.classList.contains("e-bullet-arrow")?(t.symbol=String.fromCharCode(61656),t.fontFamily="Wingdings"):e.currentTarget.classList.contains("e-bullet-tick")&&(t.symbol=String.fromCharCode(61692),t.fontFamily="Wingdings")},this.loadNumberingBulletDialog=function(){t.documentHelper.updateFocus()},this.closeNumberingBulletDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.isBullet=!1,t.listLevelPattern=void 0,t.numberFormat=void 0,t.symbol=void 0,t.fontFamily=void 0,t.documentHelper.dialog.hide(),t.unWireEventsAndBindings()},this.onOkButtonClick=function(){0<t.documentHelper.owner.documentHelper.lists.length?(t.listFormat.list.listId=t.documentHelper.owner.documentHelper.lists[t.documentHelper.owner.documentHelper.lists.length-1].listId+1,t.listFormat.listId=t.listFormat.list.listId):(t.listFormat.list.listId=0,t.listFormat.listId=0),0<t.documentHelper.owner.documentHelper.abstractLists.length?t.abstractList.abstractListId=t.documentHelper.owner.documentHelper.abstractLists[t.documentHelper.owner.documentHelper.abstractLists.length-1].abstractListId+1:t.abstractList.abstractListId=0,t.listFormat.list.abstractListId=t.abstractList.abstractListId,t.listFormat.nsid=t.listFormat.list.nsid=t.abstractList.nsid;var e=new El(t.abstractList);e.listLevelPattern=_.isNullOrUndefined(t.listLevelPattern)?"Bullet":t.listLevelPattern,e.numberFormat=t.isBullet?t.symbol:t.numberFormat,"Bullet"!==e.listLevelPattern&&(e.startAt=1),e.characterFormat.fontFamily=_.isNullOrUndefined(t.fontFamily)?"Verdana":t.fontFamily,e.paragraphFormat.leftIndent=36,e.paragraphFormat.firstLineIndent=-18,t.abstractList.levels.push(e),t.listFormat.listLevelNumber=0,t.listFormat.list.abstractList=t.abstractList,t.documentHelper.hideDialog()},this.documentHelper=e}Object.defineProperty(Qu.prototype,"fontStyle",{get:function(){return this.fontStyleInternal},set:function(e){switch(this.fontStyleInternal=e,this.fontStyle){case"Bold":this.bold=!0,this.italic=!1;break;case"Italic":this.bold=!1,this.italic=!0;break;case"BoldItalic":this.bold=!0,this.italic=!0;break;case"Regular":this.bold=!1,this.italic=!1}},enumerable:!0,configurable:!0}),Qu.prototype.getModuleName=function(){return"FontDialog"},Qu.prototype.createInputElement=function(e,t,i){return _.createElement("input",{attrs:{type:e},id:t,className:i})},Qu.prototype.initFontDialog=function(e,t){this.documentHelper.owner.containerId;this.target=_.createElement("div",{className:"e-de-font-dlg"});var i,n,r=this.getFontDiv(e,t),r=(this.target.appendChild(r),this.getFontSizeDiv(e,t)),r=(this.target.appendChild(r),_.createElement("div",{className:"e-de-container-row"})),o=(this.fontColorDiv=_.createElement("div",{className:"e-de-font-dlg-display"}),_.createElement("label",{className:"e-de-font-dlg-header-font-color e-de-font-color-margin",innerHTML:e.getConstant("Font color")})),o=(t&&o.classList.add("e-de-rtl"),this.fontColorDiv.appendChild(o),this.createInputElement("color",this.target.id+"_ColorDiv","e-de-font-dlg-color")),r=(this.fontColorDiv.appendChild(o),r.appendChild(this.fontColorDiv),this.target.appendChild(r),_.createElement("div")),s=_.createElement("div"),a=_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Effects")}),a=(s.appendChild(a),r.appendChild(s),this.target.appendChild(r),_.createElement("div",{className:"e-de-container-row"})),r=_.createElement("div",{className:"e-de-subcontainer-left"}),l=this.createInputElement("checkbox",this.target.id+"_strikeThrough",""),d=(r.appendChild(l),_.createElement("div",{className:"e-de-font-checkbox"})),h=this.createInputElement("checkbox",this.target.id+"_subScript",""),c=(d.appendChild(h),r.appendChild(d),d=_.createElement("div",{className:"e-de-font-checkbox"}),n=this.createInputElement("checkbox",this.target.id+"_allCaps",""),d.appendChild(n),r.appendChild(d),a.appendChild(r),_.createElement("div",{className:"e-de-subcontainer-right"})),p=this.createInputElement("checkbox",this.target.id+"_superScript",""),d=(c.appendChild(p),d=_.createElement("div",{className:"e-de-font-checkbox"}),i=this.createInputElement("checkbox",this.target.id+"_doubleStrikeThrough",""),d.appendChild(i),c.appendChild(d),a.appendChild(c),this.target.appendChild(a),this.documentHelper.owner.documentEditorSettings.colorPickerSettings),a=d.columns,u=d.createPopupOnClick,g=d.cssClass,m=d.disabled,f=d.enablePersistence,y=d.inline,v=d.mode,w=d.modeSwitcher,b=d.noColor,x=d.presetColors,d=d.showButtons;this.colorPicker=new D.ColorPicker({change:this.fontColorUpdate,value:"#000000",enableRtl:t,locale:this.documentHelper.owner.locale,enableOpacity:!1,mode:v,modeSwitcher:w,showButtons:d,columns:a,createPopupOnClick:u,cssClass:g,disabled:m,enablePersistence:f,inline:y,noColor:b,presetColors:x}),this.colorPicker.appendTo(o),this.strikethroughBox=new H.CheckBox({change:this.singleStrikeUpdate,cssClass:"e-de-font-content-label",label:e.getConstant("Strikethrough"),enableRtl:t}),this.documentHelper.colorPicker=this.colorPicker,this.strikethroughBox.appendTo(l),this.doublestrikethrough=new H.CheckBox({change:this.doubleStrikeUpdate,label:e.getConstant("Double strikethrough"),enableRtl:t}),this.doublestrikethrough.appendTo(i),this.subscript=new H.CheckBox({label:e.getConstant("Subscript"),cssClass:"e-de-font-content-label-width",change:this.subscriptUpdate,enableRtl:t}),this.subscript.appendTo(h),this.superscript=new H.CheckBox({label:e.getConstant("Superscript"),cssClass:"e-de-font-content-label",change:this.superscriptUpdate,enableRtl:t}),this.superscript.appendTo(p),this.allcaps=new H.CheckBox({label:e.getConstant("All caps"),cssClass:"e-de-font-content-label-caps",change:this.allcapsUpdate,enableRtl:t}),this.allcaps.appendTo(n),t&&(r.classList.add("e-de-rtl"),c.classList.add("e-de-rtl"),s.classList.remove("e-de-font-content-checkbox-label"))},Qu.prototype.getFontSizeDiv=function(e,t){this.documentHelper.owner.containerId;var i=_.createElement("div",{className:"e-de-container-row"}),n=_.createElement("div",{className:"e-de-subcontainer-left"}),r=e.getConstant("Size"),o=_.createElement("select",{id:this.target.id+"_fontSize"}),n=(o.innerHTML="<option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>14</option><option>16</option><option>18</option><option>20</option><option>24</option><option>26</option><option>28</option><option>36</option><option>48</option><option>72</option><option>96</option>",n.appendChild(o),i.appendChild(n),_.createElement("div",{className:"e-de-subcontainer-right"})),s=(t&&n.classList.add("e-de-rtl"),e.getConstant("Underline style")),a=_.createElement("select",{id:this.target.id+"_underLine"});return a.innerHTML='<option value="None">'+e.getConstant("None")+'</option><option value="Single">________</option>',n.appendChild(a),i.appendChild(n),this.fontSizeText=new U.ComboBox({change:this.fontSizeUpdate,allowCustom:!0,showClearButton:!1,enableRtl:t,floatLabelType:"Always",placeholder:r,htmlAttributes:{"aria-labelledby":r}}),this.fontSizeText.appendTo(o),this.underlineDrop=new U.DropDownList({change:this.underlineUpdate,enableRtl:t,floatLabelType:"Always",placeholder:s,htmlAttributes:{"aria-labelledby":s}}),this.underlineDrop.appendTo(a),i},Qu.prototype.getFontDiv=function(e,t){this.documentHelper.owner.containerId;for(var i=_.createElement("div",{className:"e-de-container-row"}),n=_.createElement("div",{className:"e-de-subcontainer-left"}),r=e.getConstant("Font"),o=_.createElement("select",{id:this.target.id+"_fontName"}),s=this.documentHelper.owner.documentEditorSettings.fontFamilies,a=0;a<s.length;a++)o.innerHTML+="<option>"+s[a]+"</option>";n.appendChild(o),i.appendChild(n),n=_.createElement("div",{className:"e-de-subcontainer-right"}),t&&n.classList.add("e-de-rtl");var l,d=e.getConstant("Font style");return(l=_.createElement("select",{id:this.target.id+"_fontStyle"})).innerHTML='<option value="Regular">'+e.getConstant("Regular")+'</option><option value="Bold">'+e.getConstant("Bold")+'</option><option value="Italic">'+e.getConstant("Italic")+'</option><option value="BoldItalic">'+e.getConstant("Bold")+e.getConstant("Italic")+"</option>",n.appendChild(l),i.appendChild(n),this.fontNameList=new U.ComboBox({change:this.fontFamilyUpdate,enableRtl:t,floatLabelType:"Always",placeholder:r}),this.fontNameList.showClearButton=!1,this.fontNameList.appendTo(o),this.fontStyleText=new U.DropDownList({change:this.fontStyleUpdate,enableRtl:t,floatLabelType:"Always",placeholder:d}),this.fontStyleText.appendTo(l),i},Qu.prototype.showFontDialog=function(e,t){e&&(this.characterFormat=e),this.isListDialog=t;e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initFontDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=e.getConstant("Font"),this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadFontDialog,this.documentHelper.dialog.close=this.closeFontDialog,this.documentHelper.dialog.buttons=[{click:this.onInsertFontFormat,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-font-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-font-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},Qu.prototype.onCharacterFormat=function(e,t){this.documentHelper.owner.editorModule.initHistory("CharacterFormat"),e.isEmpty?(e.start.offset===e.getParagraphLength(e.start.paragraph)&&(this.documentHelper.owner.editorModule.applyCharFormatValueInternal(e,e.start.paragraph.characterFormat,void 0,t),this.documentHelper.owner.editorModule.reLayout(e)),this.documentHelper.updateFocus()):(this.documentHelper.owner.editorModule.setOffsetValue(this.documentHelper.selection),this.documentHelper.owner.editorModule.updateSelectionCharacterFormatting("CharacterFormat",t,!1))},Qu.prototype.enableCheckBoxProperty=function(e){this.strikethroughBox.checked&&this.doublestrikethrough.checked&&(this.strikethroughBox.checked=!1,this.doublestrikethrough.checked=!1,e.event.currentTarget.id===this.target.id+"_doubleStrikeThrough"?this.doublestrikethrough.checked=!0:this.strikethroughBox.checked=!0),this.superscript.checked&&this.subscript.checked&&(this.subscript.checked=!1,this.superscript.checked=!1,e.event.currentTarget.id===this.target.id+"_subScript"?this.subscript.checked=!0:this.superscript.checked=!0)},Qu.prototype.unWireEventsAndBindings=function(){this.fontNameList.value="",this.fontSizeText.value="",this.fontStyleText.value="",this.strikethroughBox.checked=!1,this.doublestrikethrough.checked=!1,this.superscript.checked=!1,this.subscript.checked=!1,this.allcaps.checked=!1,this.bold=void 0,this.italic=void 0,this.underline=void 0,this.strikethrough=void 0,this.baselineAlignment=void 0,this.fontColor=void 0,this.fontSize=void 0,this.fontFamily=void 0},Qu.prototype.destroy=function(){if(this.documentHelper=void 0,this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.fontNameList&&this.fontNameList.destroy(),this.fontNameList=void 0,this.fontStyleText&&this.fontStyleText.destroy(),this.fontStyleText=void 0,this.fontSizeText&&this.fontSizeText.destroy(),this.fontSizeText=void 0,this.colorPicker&&this.colorPicker.destroy(),this.colorPicker=void 0,this.underlineDrop&&this.underlineDrop.destroy(),this.underlineDrop=void 0,this.strikethroughBox&&this.strikethroughBox.destroy(),this.strikethroughBox=void 0,this.doublestrikethrough&&this.doublestrikethrough.destroy(),this.doublestrikethrough=void 0,this.superscript&&this.superscript.destroy(),this.superscript=void 0,this.subscript&&this.subscript.destroy(),this.subscript=void 0,this.allcaps&&this.allcaps.destroy(),this.allcaps=void 0};var Yu=Qu;function Qu(e){var i=this;this.fontStyleInternal=void 0,this.fontNameList=void 0,this.fontStyleText=void 0,this.fontSizeText=void 0,this.colorPicker=void 0,this.underlineDrop=void 0,this.strikethroughBox=void 0,this.doublestrikethrough=void 0,this.superscript=void 0,this.subscript=void 0,this.allcaps=void 0,this.bold=void 0,this.italic=void 0,this.underline=void 0,this.strikethrough=void 0,this.baselineAlignment=void 0,this.fontSize=void 0,this.fontFamily=void 0,this.fontColor=void 0,this.allCaps=void 0,this.isListDialog=!1,this.characterFormat=void 0,this.loadFontDialog=function(){var e,t;i.documentHelper.updateFocus(),e=i.characterFormat||i.documentHelper.owner.selectionModule.characterFormat,i.fontNameList.value=e.fontFamily,i.fontNameList.dataBind(),e.bold||e.italic?e.bold&&!e.italic?(i.fontStyleText.value=i.fontSizeText.value,i.fontStyleText.index=1):!e.bold&&e.italic?(i.fontStyleText.value=i.fontSizeText.value,i.fontStyleText.index=2):e.bold&&e.italic&&(i.fontStyleText.value=i.fontSizeText.value,i.fontStyleText.index=3):(i.fontStyleText.value=i.fontSizeText.value,i.fontStyleText.index=0),_.isNullOrUndefined(e.fontSize)||(i.fontSizeText.value=e.fontSize),_.isNullOrUndefined(e.fontColor)?i.colorPicker.value="#000000":(t=e.fontColor,i.colorPicker.value=t="empty"!==t&&"#00000000"!==t?t:"#000000"),"None"===e.underline?i.underlineDrop.index=0:"Single"===e.underline&&(i.underlineDrop.index=1),"SingleStrike"===e.strikethrough?i.strikethroughBox.checked=!0:"DoubleStrike"===e.strikethrough?i.doublestrikethrough.checked=!0:(i.strikethroughBox.checked=!1,i.doublestrikethrough.checked=!1),"Superscript"===e.baselineAlignment?i.superscript.checked=!0:"Subscript"===e.baselineAlignment?i.subscript.checked=!0:(i.superscript.checked=!1,i.subscript.checked=!1),"none"!==i.documentHelper.selection.caret.style.display&&(i.documentHelper.selection.caret.style.display="none"),e.allCaps?i.allcaps.checked=!0:(i.allcaps.checked=!1,i.allCaps=!1)},this.closeFontDialog=function(){i.unWireEventsAndBindings(),i.documentHelper.updateFocus()},this.onCancelButtonClick=function(){i.documentHelper.dialog.hide(),i.unWireEventsAndBindings(),i.documentHelper.updateFocus()},this.onInsertFontFormat=function(){var e,t=i.characterFormat||new B(void 0);_.isNullOrUndefined(i.bold)||(t.bold=i.bold),_.isNullOrUndefined(i.italic)||(t.italic=i.italic),!_.isNullOrUndefined(i.fontSize)&&0<i.fontSize&&(t.fontSize=i.fontSize),_.isNullOrUndefined(i.fontColor)||(t.fontColor=i.fontColor),_.isNullOrUndefined(i.baselineAlignment)||(t.baselineAlignment=i.baselineAlignment),_.isNullOrUndefined(i.strikethrough)||(t.strikethrough=i.strikethrough),_.isNullOrUndefined(i.underline)||(t.underline=i.underline),_.isNullOrUndefined(i.fontFamily)||(e=_.SanitizeHtmlHelper.sanitize(i.fontFamily),t.fontFamily=e,t.fontFamilyAscii=e,t.fontFamilyFarEast=e,t.fontFamilyNonFarEast=e,t.fontFamilyBidi=e),_.isNullOrUndefined(i.allCaps)||(t.allCaps=i.allCaps),i.characterFormat?i.isListDialog?i.documentHelper.owner.listDialogModule.updateCharacterFormat(t):i.documentHelper.owner.styleDialogModule.updateCharacterFormat():i.onCharacterFormat(i.documentHelper.selection,t),i.documentHelper.hideDialog()},this.fontSizeUpdate=function(e){i.fontSize=e.value},this.fontStyleUpdate=function(e){i.fontStyle=e.value},this.fontFamilyUpdate=function(e){i.fontFamily=e.value},this.underlineUpdate=function(e){i.underline=e.value},this.fontColorUpdate=function(e){_.isNullOrUndefined(e.currentValue)||(i.fontColor=e.currentValue.hex)},this.singleStrikeUpdate=function(e){i.enableCheckBoxProperty(e),e.checked?i.strikethrough="SingleStrike":i.strikethrough="None"},this.doubleStrikeUpdate=function(e){i.enableCheckBoxProperty(e),e.checked?i.strikethrough="DoubleStrike":i.strikethrough="None"},this.superscriptUpdate=function(e){i.enableCheckBoxProperty(e),e.checked?i.baselineAlignment="Superscript":i.baselineAlignment="Normal"},this.subscriptUpdate=function(e){i.enableCheckBoxProperty(e),e.checked?i.baselineAlignment="Subscript":i.baselineAlignment="Normal"},this.allcapsUpdate=function(e){i.enableCheckBoxProperty(e),e.checked?i.allCaps=!0:i.allCaps=!1},this.documentHelper=e}Object.defineProperty(eg.prototype,"cellFormat",{get:function(){return _.isNullOrUndefined(this.cellFormatIn)?this.cellFormatIn=new Tl:this.cellFormatIn},set:function(e){this.cellFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(eg.prototype,"tableFormat",{get:function(){return _.isNullOrUndefined(this.tableFormatIn)&&(this.tableFormatIn=new Fl),this.tableFormatIn},set:function(e){this.tableFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(eg.prototype,"paraFormat",{get:function(){return _.isNullOrUndefined(this.tableFormatIn)&&(this.paraFormatIn=new Xa),this.paraFormatIn},set:function(e){this.paraFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(eg.prototype,"rowFormat",{get:function(){return _.isNullOrUndefined(this.rowFormatInternal)&&(this.rowFormatInternal=new Ya),this.rowFormatInternal},enumerable:!0,configurable:!0}),eg.prototype.getModuleName=function(){return"TablePropertiesDialog"},eg.prototype.initTablePropertyDialog=function(e,t){this.localValue=e;for(var i=this.documentHelper.owner.containerId+"_TablePropertiesDialog",i=(this.target=_.createElement("div",{id:i,className:"e-de-table-properties-dlg"}),_.createElement("div",{id:this.target.id+"_TabContainer"})),n=(this.target.appendChild(i),this.tableTab=_.createElement("div",{id:this.target.id+"_TablePropertiesContentDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.rowTab=_.createElement("div",{id:this.target.id+"_RowPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.cellTab=_.createElement("div",{id:this.target.id+"_CellPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.altTab=_.createElement("div",{id:this.target.id+"_AltPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"}),_.createElement("div",{className:"e-de-table-dialog-separator-line"})),r=_.createElement("div",{id:this.target.id+"_TablePropertiesDialogTab",className:"e-de-table-ppty-tab"}),o=_.createElement("div",{className:"e-tab-header"}),s=_.createElement("div",{id:this.target.id+"_tableHeader",innerHTML:e.getConstant("Table")}),a=_.createElement("div",{id:this.target.id+"_rowHeader",innerHTML:e.getConstant("Row")}),l=_.createElement("div",{id:this.target.id+"_cellHeader",innerHTML:e.getConstant("Cell")}),d=_.createElement("div",{id:this.target.id+"_altHeader",innerHTML:e.getConstant("Alt Text")}),o=(o.appendChild(s),o.appendChild(a),o.appendChild(l),o.appendChild(d),_.createElement("div",{id:this.target.id+"_tableContent"})),h=_.createElement("div",{id:this.target.id+"_rowContent"}),c=_.createElement("div",{id:this.target.id+"_cellContent"}),p=_.createElement("div",{id:this.target.id+"_altContent"}),s=[{header:{text:s},content:o},{header:{text:a},content:h},{header:{text:l},content:c},{header:{text:d},content:p}],u=(o.appendChild(this.tableTab),h.appendChild(this.rowTab),c.appendChild(this.cellTab),p.appendChild(this.altTab),i.appendChild(r),this.initTableProperties(this.tableTab,e,this.documentHelper.owner.enableRtl),this.initTableRowProperties(this.rowTab,e,this.documentHelper.owner.enableRtl),this.initTableCellProperties(this.cellTab,e,this.documentHelper.owner.enableRtl),this.initTableAltProperties(this.altTab,e,this.documentHelper.owner.enableRtl),this.tabObj=new k.Tab({items:s,enableRtl:t},r),this.tabObj.isStringTemplate=!0,this.target.appendChild(n),this.tableTab.getElementsByClassName(this.tableTab.id+"e-de-table-alignment")),g=0;g<u.length;g++)u[parseInt(g.toString(),10)].addEventListener("click",this.changeTableAlignment);for(var m=this.cellTab.getElementsByClassName(this.cellTab.id+"e-de-table-cell-alignment"),g=0;g<m.length;g++)m[parseInt(g.toString(),10)].addEventListener("click",this.changeCellAlignment)},eg.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),e=(e.setLocale(this.documentHelper.owner.locale),this.target||this.initTablePropertyDialog(e,this.documentHelper.owner.enableRtl),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog2.header=e.getConstant("Table Properties"),this.documentHelper.dialog2.position={X:"center",Y:"center"},this.documentHelper.dialog2.animationSettings={effect:"None",duration:400,delay:0},this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.height="auto",this.documentHelper.dialog2.content=this.target,this.documentHelper.dialog2.beforeOpen=this.onBeforeOpen,this.documentHelper.dialog2.close=this.onCloseTablePropertyDialog,this.documentHelper.dialog2.open=this.wireEvent.bind(this),this.documentHelper.dialog2.buttons=[{click:this.applyTableProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-ppty-okay",isPrimary:!0}},{click:this.closeTablePropertiesDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-ppty-cancel"}}],this.documentHelper.dialog2.dataBind(),this.documentHelper.dialog2.show(),this.documentHelper.dialog2.element);e&&this.documentHelper.updateDialogTabHeight(e,this.target)},eg.prototype.isEqualTableFormat=function(e,t){return!(t.hasValue("preferredWidth")&&e.preferredWidth!==t.preferredWidth||t.hasValue("preferredWidthType")&&e.preferredWidthType!==t.preferredWidthType||t.hasValue("tableAlignment")&&e.tableAlignment!==t.tableAlignment||t.hasValue("leftIndent")&&e.leftIndent!==t.leftIndent||t.hasValue("bidi")&&e.bidi!==t.bidi||(_.isNullOrUndefined(e.title)?""!==t.title:e.title!==t.title)||(_.isNullOrUndefined(e.description)?""!==t.description:e.description!==t.description))},eg.prototype.isEqualRowFormat=function(e,t){return!(t.hasValue("height")&&e.height!==t.height||t.hasValue("heightType")&&e.heightType!==t.heightType||t.hasValue("allowBreakAcrossPages")&&e.allowBreakAcrossPages!==t.allowBreakAcrossPages||t.hasValue("isHeader")&&e.isHeader!==t.isHeader)},eg.prototype.isEqualCellFormat=function(e,t){return!(t.hasValue("preferredWidth")&&e.preferredWidth!==t.preferredWidth||t.hasValue("preferredWidthType")&&e.preferredWidthType!==t.preferredWidthType||t.hasValue("verticalAlignment")&&e.verticalAlignment!==t.verticalAlignment)},eg.prototype.calculateGridValue=function(e){e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(e),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!0);e=this.documentHelper.owner.editorHistoryModule;e&&e.currentBaseHistoryInfo&&(0<e.currentBaseHistoryInfo.modifiedProperties.length&&e.currentBaseHistoryInfo.updateSelection(),e.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange()},eg.prototype.loadTableProperties=function(){this.setTableProperties(),this.setTableRowProperties(),this.setTableCellProperties(),this.setTableAltProperties(),this.documentHelper.owner.bordersAndShadingDialogModule?this.bordersAndShadingButton.disabled=!1:this.bordersAndShadingButton.disabled=!0,this.tableOptionButton.disabled=!1,this.cellOptionButton.disabled=!1},eg.prototype.wireEvent=function(){this.documentHelper.selection.hideCaret(),this.preferCheckBox.change=this.changeTableCheckBox.bind(this),this.tableWidthBox.change=this.onTableWidthChange.bind(this),this.tableWidthType.change=this.onTableWidthTypeChange.bind(this),this.leftIndentBox.change=this.onLeftIndentChange.bind(this),this.rowHeightCheckBox.change=this.changeTableRowCheckBox.bind(this),this.rowHeightBox.change=this.onRowHeightChange.bind(this),this.rowHeightType.change=this.onRowHeightTypeChange.bind(this),this.allowRowBreak.change=this.onAllowBreakAcrossPage.bind(this),this.repeatHeader.change=this.onRepeatHeader.bind(this),this.preferredCellWidthCheckBox.change=this.changeTableCellCheckBox.bind(this),this.cellWidthBox.change=this.onCellWidthChange.bind(this),this.cellWidthType.change=this.onCellWidthTypeChange.bind(this)},eg.prototype.initTableProperties=function(e,t,i){var n=_.createElement("div",{className:"e-de-table-dialog-size-label"}),r=_.createElement("div",{innerHTML:t.getConstant("Size"),className:"e-de-para-dlg-heading"}),o=_.createElement("div",{className:"e-de-table-ppty-options-break"}),s=_.createElement("input",{attrs:{type:"checkbox"}}),a=_.createElement("div",{className:"e-de-container-row"}),l=_.createElement("div",{className:"e-de-subcontainer-left e-de-table-dialog-row-height"}),d=(this.preferredWidth=_.createElement("input"),_.createElement("div",{className:"e-de-subcontainer-right"})),h=_.createElement("select",{innerHTML:'<option value="Points">'+t.getConstant("Points")+'</option><option value="Percent">'+t.getConstant("Percent")+"</option>"}),c=_.createElement("div",{className:"e-de-dlg-row"}),p=_.createElement("div",{className:"e-de-subcontainer-left"}),u=_.createElement("div",{innerHTML:t.getConstant("Alignment"),className:"e-de-table-dlg-alignment-heading"}),g=_.createElement("div",{className:"e-de-container-row"}),m=e.id+"e-de-table-alignment e-de-table-dialog-alignment-icon",f=_.createElement("div"),y=_.createElement("div",{className:"e-de-table-dia-align-div"}),v=(this.left=_.createElement("div",{className:"e-icons e-de-table-properties-alignment e-de-table-left-alignment "+m,id:e.id+"_left_alignment"}),y.appendChild(this.left),y.setAttribute("aria-label",t.getConstant("Left")),_.createElement("div",{className:"e-de-table-dia-align-div"})),m=(this.center=_.createElement("div",{className:"e-icons e-de-table-properties-alignment  e-de-table-center-alignment "+m,id:e.id+"_center_alignment"}),v.appendChild(this.center),v.setAttribute("aria-label",t.getConstant("Center")),this.right=_.createElement("div",{className:"e-icons e-de-table-properties-alignment  e-de-table-right-alignment "+m,id:e.id+"_right_alignment"}),_.createElement("div",{className:"e-de-table-dia-align-div"})),w=(m.appendChild(this.right),m.setAttribute("aria-label",t.getConstant("Right")),_.createElement("label",{innerHTML:t.getConstant("Left"),className:"e-de-table-dia-align-label"})),b=_.createElement("label",{innerHTML:t.getConstant("Center"),className:"e-de-table-dia-align-label"}),x=_.createElement("label",{innerHTML:t.getConstant("Right"),className:"e-de-table-dia-align-label"}),C=_.createElement("div",{className:"e-de-subcontainer-right"}),I=(this.leftIndent=_.createElement("input"),_.createElement("div",{innerHTML:t.getConstant("Table direction"),className:"e-de-para-dlg-heading"})),k=_.createElement("div",{className:"e-de-dlg-row"}),F=_.createElement("div",{className:"e-de-tbl-rtl-btn-div"}),P=_.createElement("input"),T=(F.appendChild(P),k.appendChild(F),_.createElement("div",{className:"e-de-tbl-ltr-btn-div"})),S=_.createElement("input"),T=(T.appendChild(S),k.appendChild(T),this.rtlButton=new H.RadioButton({label:t.getConstant("Right-to-left"),value:"rtl",cssClass:"e-small",change:this.changeBidirectional,enableRtl:i}),this.rtlButton.appendTo(P),P.setAttribute("aria-label",t.getConstant("Right-to-left")),this.ltrButton=new H.RadioButton({label:t.getConstant("Left-to-right"),value:"ltr",cssClass:"e-small",change:this.changeBidirectional,enableRtl:i}),this.ltrButton.appendTo(S),S.setAttribute("aria-label",t.getConstant("Left-to-right")),_.createElement("div",{className:"e-de-tbl-dlg-border-btn"}));this.bordersAndShadingButton=_.createElement("button",{innerHTML:t.getConstant("Borders and Shading")+"...",className:"e-control e-btn e-de-ok-button",attrs:{type:"button"}}),this.tableOptionButton=_.createElement("button",{className:"e-control e-btn",innerHTML:t.getConstant("Options")+"...",attrs:{type:"button"}}),this.tableOptionButton.addEventListener("click",this.showTableOptionsDialog),this.bordersAndShadingButton.addEventListener("click",this.showBordersShadingsPropertiesDialog),T.appendChild(this.bordersAndShadingButton),T.appendChild(this.tableOptionButton),C.appendChild(this.leftIndent),g.appendChild(f),p.appendChild(u),f.appendChild(y),p.appendChild(g),g.appendChild(v),g.appendChild(m),y.appendChild(w),v.appendChild(b),m.appendChild(x),c.appendChild(p),n.appendChild(r),e.appendChild(n),o.appendChild(s),n.appendChild(o),l.appendChild(this.preferredWidth),n.appendChild(a),d.appendChild(h),c.appendChild(C),a.appendChild(l),a.appendChild(d),e.appendChild(c),e.appendChild(I),e.appendChild(k),e.appendChild(T),this.tableWidthBox=new D.NumericTextBox({value:0,decimals:2,min:0,max:1584,enablePersistence:!1}),this.tableWidthBox.appendTo(this.preferredWidth),this.leftIndentBox=new D.NumericTextBox({value:0,decimals:2,min:-1584,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:t.getConstant("Indent from left")}),this.leftIndentBox.appendTo(this.leftIndent),this.preferCheckBox=new H.CheckBox({label:t.getConstant("Preferred Width"),enableRtl:i}),this.preferCheckBox.appendTo(s),s.setAttribute("aria-label",t.getConstant("Preferred Width")),this.leftIndent.setAttribute("aria-labelledby",t.getConstant("Indent from left")),this.tableWidthType=new U.DropDownList({enableRtl:i,floatLabelType:"Always",placeholder:t.getConstant("Measure in"),htmlAttributes:{"aria-labelledby":t.getConstant("Measure in")}}),this.tableWidthType.appendTo(h),i&&(F.classList.add("e-de-rtl"),C.classList.add("e-de-rtl"),T.classList.add("e-de-rtl"),y.classList.add("e-de-rtl"),v.classList.add("e-de-rtl"),m.classList.add("e-de-rtl"))},eg.prototype.onTableWidthChange=function(){this.tableFormat.preferredWidth=this.tableWidthBox.value},eg.prototype.onTableWidthTypeChange=function(){var e,t=j.convertPixelToPoint(this.documentHelper.owner.viewer.clientArea.width);"Percent"===this.tableWidthType.text&&"Percent"!==this.documentHelper.selection.tableFormat.preferredWidthType?(e=this.tableWidthBox.value/t*100,this.formatNumericTextBox(this.tableWidthBox,"Percent",e)):"Points"===this.tableWidthType.text&&"Point"!==this.documentHelper.selection.tableFormat.preferredWidthType?(e=t/100*this.tableWidthBox.value,this.formatNumericTextBox(this.tableWidthBox,"Point",e)):(e="#'%'"===this.tableWidthBox.format?"Points"===this.tableWidthType.text?t/100*this.tableWidthBox.value:this.tableWidthBox.value:"Percent"===this.tableWidthType.text?this.tableWidthBox.value/t*100:this.tableWidthBox.value,this.formatNumericTextBox(this.tableWidthBox,"Points"===this.tableWidthType.text?"Point":this.tableWidthType.text,e)),this.tableFormat.preferredWidthType="Points"===this.tableWidthType.text?"Point":this.tableWidthType.text},eg.prototype.onLeftIndentChange=function(){this.tableFormat.leftIndent=this.leftIndentBox.value},eg.prototype.setTableAltProperties=function(){var e=this.documentHelper.selection.tableFormat;_.isNullOrUndefined(e.title)?this.titleTextBox.value="":this.titleTextBox.value=e.title,_.isNullOrUndefined(e.description)?this.descriptionTextBox.value="":this.descriptionTextBox.value=e.description},eg.prototype.setTableProperties=function(){var e=this.documentHelper.selection.tableFormat,t=0<e.preferredWidth,i=e.preferredWidth;_.isNullOrUndefined(e.preferredWidth)?(this.preferCheckBox.indeterminate=!0,i=this.documentHelper.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.documentHelper.owner.viewer).tableFormat.preferredWidth):this.preferCheckBox.checked=t,this.tableWidthBox.enabled=t,this.tableWidthType.enabled=t,this.formatNumericTextBox(this.tableWidthBox,e.preferredWidthType,i),"Auto"===e.preferredWidthType||"Point"===e.preferredWidthType?this.tableWidthType.index=0:this.tableWidthType.index=1,this.activeTableAlignment(e,!1),e.bidi?(this.rtlButton.checked=!0,this.ltrButton.checked=!1):(this.ltrButton.checked=!0,this.rtlButton.checked=!1)},eg.prototype.activeTableAlignment=function(e,t){t=t?this.tableFormat.tableAlignment:void 0;_.isNullOrUndefined(t)&&(e.bidi?"Left"===e.tableAlignment?t="Right":"Right"===e.tableAlignment&&(t="Left"):t=e.tableAlignment),e.bidi?(this.leftIndentBox.enabled="Right"===t,this.leftIndentBox.placeholder=this.localValue.getConstant("Indent from right")):(this.leftIndentBox.enabled="Left"===t,this.leftIndentBox.placeholder=this.localValue.getConstant("Indent from left")),this.leftIndentBox.value=e.leftIndent,_.classList(this.left,[],["e-de-table-alignment-active"]),_.classList(this.right,[],["e-de-table-alignment-active"]),_.classList(this.center,[],["e-de-table-alignment-active"]),"Left"===t?_.classList(this.left,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]):"Center"===t?_.classList(this.center,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]):"Right"===t&&_.classList(this.right,["e-de-table-alignment-active"],["e-de-table-properties-alignment"])},eg.prototype.getTableAlignment=function(){for(var e=this.tableTab.id,t=this.tableTab.getElementsByClassName(e+"e-de-table-alignment"),i=0;i<t.length;i++)if(t[parseInt(i.toString(),10)].classList.contains("e-de-table-alignment-active"))return 0===i?this.ltrButton.checked?"Left":"Right":1===i?"Center":this.ltrButton.checked?"Right":"Left"},eg.prototype.updateClassForAlignmentProperties=function(e){for(var t=e.id,i=e.getElementsByClassName(t+"e-de-table-alignment"),n=0;n<i.length;n++){var r=i[parseInt(n.toString(),10)];r.classList.contains("e-de-table-alignment-active")&&_.classList(r,["e-de-table-properties-alignment"],["e-de-table-alignment-active"])}},eg.prototype.initTableRowProperties=function(e,t,i){var n=_.createElement("div",{className:"e-de-table-dialog-size-label"}),r=_.createElement("div",{innerHTML:t.getConstant("Size"),className:"e-de-para-dlg-heading"}),o=_.createElement("div",{className:"e-de-table-ppty-options-break"}),s=_.createElement("input",{attrs:{type:"checkbox"}}),a=_.createElement("div",{className:"e-de-container-row"}),l=_.createElement("div",{className:"e-de-subcontainer-left e-de-table-dialog-row-height"}),d=(this.rowHeight=_.createElement("input",{attrs:{type:"text"}}),_.createElement("div",{className:"e-de-subcontainer-right"})),h=_.createElement("select",{innerHTML:'<option value="AtLeast">'+t.getConstant("At least")+'</option><option value="Exactly">'+t.getConstant("Exactly")+"</option>"}),r=(n.appendChild(r),e.appendChild(n),o.appendChild(s),n.appendChild(o),a.appendChild(l),n.appendChild(a),l.appendChild(this.rowHeight),d.appendChild(h),a.appendChild(d),_.createElement("div",{innerHTML:t.getConstant("Options")+"...",className:"e-de-para-dlg-heading"})),o=_.createElement("div",{className:"e-de-table-ppty-options-break"}),n=_.createElement("div",{className:"e-de-table-ppty-options-header-row"}),l=_.createElement("input",{attrs:{type:"checkbox"}}),a=_.createElement("input",{attrs:{type:"checkbox"}});o.appendChild(l),n.appendChild(a),e.appendChild(r),e.appendChild(o),e.appendChild(n),this.rowHeightBox=new D.NumericTextBox({value:0,decimals:2,min:0,max:1584,enablePersistence:!1}),this.rowHeightBox.appendTo(this.rowHeight),this.rowHeightCheckBox=new H.CheckBox({label:t.getConstant("Specify height"),enableRtl:i}),this.rowHeightCheckBox.appendTo(s),s.setAttribute("aria-label",t.getConstant("Specify height")),this.rowHeightType=new U.DropDownList({enableRtl:i,floatLabelType:"Always",placeholder:t.getConstant("Row height is"),htmlAttributes:{"aria-labelledby":t.getConstant("Row height is")}}),this.rowHeightType.appendTo(h),this.allowRowBreak=new H.CheckBox({label:t.getConstant("Allow row to break across pages"),enableRtl:i}),this.allowRowBreak.appendTo(l),l.setAttribute("aria-label",t.getConstant("Allow row to break across pages")),this.repeatHeader=new H.CheckBox({label:t.getConstant("Repeat as header row at the top of each page"),enableRtl:i}),this.repeatHeader.appendTo(a),a.setAttribute("aria-label",t.getConstant("Repeat as header row at the top of each page"))},eg.prototype.setTableRowProperties=function(){var e=this.documentHelper.selection.rowFormat,t=0<e.height||"Exactly"===e.heightType,t=(t?this.rowHeightCheckBox.checked=!0:void 0===e.heightType?t=this.rowHeightCheckBox.indeterminate=!0:this.rowHeightCheckBox.checked=!1,this.rowHeightBox.enabled=t,this.rowHeightType.enabled=t,!this.enableRepeatHeader());_.isNullOrUndefined(this.documentHelper.selection.rowFormat.isHeader)?(this.repeatHeader.indeterminate=!0,this.repeatHeader.disabled=!0):(this.documentHelper.selection.rowFormat.isHeader?(this.repeatHeader.checked=!t,this.repeatHeader.indeterminate=t):(this.repeatHeader.checked=!1,this.repeatHeader.indeterminate=!1),this.repeatHeader.disabled=t),_.isNullOrUndefined(e.allowBreakAcrossPages)?this.allowRowBreak.indeterminate=!0:this.allowRowBreak.checked=e.allowBreakAcrossPages,this.rowHeightBox.value=e.height,"Auto"===e.heightType||"AtLeast"===e.heightType?this.rowHeightType.index=0:this.rowHeightType.index=1},eg.prototype.onRowHeightChange=function(){this.rowHeightValue=this.rowHeightBox.value},eg.prototype.onRowHeightTypeChange=function(){this.rowFormat.heightType=this.rowHeightType.text},eg.prototype.onAllowBreakAcrossPage=function(){this.rowFormat.allowBreakAcrossPages=this.allowRowBreak.checked},eg.prototype.onRepeatHeader=function(){this.rowFormat.isHeader=this.repeatHeader.checked},eg.prototype.enableRepeatHeader=function(){var e=this.documentHelper.selection,t=e.start,i=e.end,e=(e.isForward||(t=e.end,i=e.start),t.paragraph.associatedCell),t=i.paragraph.associatedCell;return 0===e.ownerRow.index&&t.ownerTable.equals(e.ownerTable)},eg.prototype.initTableAltProperties=function(e,t,i){var n=_.createElement("div",{className:"e-de-table-dialog-size-label"}),e=(e.appendChild(n),_.createElement("div",{innerHTML:t.getConstant("Title"),className:"e-de-para-dlg-heading"})),e=(n.appendChild(e),_.createElement("div",{className:"e-de-table-ppty-options-break"})),r=_.createElement("input",{}),e=(this.titleTextBox=new D.TextBox({floatLabelType:"Never"}),n.appendChild(e),e.appendChild(r),this.titleTextBox.appendTo(r),_.createElement("div",{innerHTML:t.getConstant("Description"),className:"e-de-para-dlg-heading"})),r=(n.appendChild(e),_.createElement("div",{className:"e-de-table-ppty-options-break"})),t=_.createElement("textarea",{});this.descriptionTextBox=new D.TextBox({floatLabelType:"Never"}),r.appendChild(t),this.descriptionTextBox.appendTo(t),n.appendChild(r)},eg.prototype.initTableCellProperties=function(e,t,i){var n=_.createElement("div",{className:"e-de-table-dialog-size-label"}),r=_.createElement("div",{innerHTML:t.getConstant("Size"),className:"e-de-para-dlg-heading"}),o=_.createElement("div",{className:"e-de-table-ppty-options-break"}),s=_.createElement("input",{attrs:{type:"checkbox"}}),a=_.createElement("div",{className:"e-de-container-row"}),l=_.createElement("div",{className:"e-de-subcontainer-left e-de-table-dialog-row-height"}),d=(this.preferredCellWidth=_.createElement("input",{attrs:{type:"text"}}),_.createElement("div",{className:"e-de-subcontainer-right"})),h=_.createElement("select",{innerHTML:'<option value="Points">'+t.getConstant("Points")+'</option><option value="Percent">'+t.getConstant("Percent")+"</option>"}),r=(n.appendChild(r),e.appendChild(n),o.appendChild(s),s.setAttribute("aria-label",t.getConstant("Preferred Width")),n.appendChild(o),l.appendChild(this.preferredCellWidth),n.appendChild(a),a.appendChild(l),a.appendChild(d),d.appendChild(h),_.createElement("div",{innerHTML:t.getConstant("Vertical alignment"),className:"e-de-para-dlg-heading"})),o=e.id+"e-de-table-cell-alignment e-de-tablecell-dialog-alignment-icon",n=_.createElement("div",{className:"e-de-container-row"}),l=_.createElement("div"),a=_.createElement("div",{className:"e-de-tablecell-dia-align-div"}),d=(this.cellTopAlign=_.createElement("div",{id:e.id+"_cell_top-alignment",className:"e-icons e-de-tablecell-alignment  e-de-tablecell-top-alignment "+o}),a.appendChild(this.cellTopAlign),a.setAttribute("aria-label",t.getConstant("Top")),_.createElement("div",{className:"e-de-tablecell-dia-align-div"})),c=(this.cellCenterAlign=_.createElement("div",{id:e.id+"_cell_center-alignment",className:"e-icons e-de-tablecell-alignment  e-de-tablecell-center-alignment "+o}),d.appendChild(this.cellCenterAlign),d.setAttribute("aria-label",t.getConstant("Center")),_.createElement("div",{className:"e-de-tablecell-dia-align-div"})),o=(this.cellBottomAlign=_.createElement("div",{id:e.id+"_cell_bottom-alignment",className:"e-icons e-de-tablecell-alignment e-de-tablecell-bottom-alignment  "+o}),c.appendChild(this.cellBottomAlign),c.setAttribute("aria-label",t.getConstant("Bottom")),_.createElement("label",{innerHTML:t.getConstant("Top"),className:"e-de-table-dia-align-label"})),p=_.createElement("label",{innerHTML:t.getConstant("Center"),className:"e-de-table-dia-align-label"}),u=_.createElement("label",{innerHTML:t.getConstant("Bottom"),className:"e-de-table-dia-align-label"});this.cellOptionButton=_.createElement("button",{innerHTML:t.getConstant("Options")+"...",className:"e-control e-btn",attrs:{type:"button"}}),this.cellOptionButton.style.cssFloat=i?"left":"right",n.appendChild(l),l.appendChild(a),n.appendChild(d),n.appendChild(c),a.appendChild(o),d.appendChild(p),c.appendChild(u),e.appendChild(r),e.appendChild(n),e.appendChild(this.cellOptionButton),this.cellOptionButton.addEventListener("click",this.showCellOptionsDialog),this.cellWidthBox=new D.NumericTextBox({value:0,decimals:2,min:0,max:1584,enablePersistence:!1}),this.cellWidthBox.appendTo(this.preferredCellWidth),this.preferredCellWidthCheckBox=new H.CheckBox({label:t.getConstant("Preferred Width"),enableRtl:i}),this.preferredCellWidthCheckBox.appendTo(s),s.setAttribute("aria-label",t.getConstant("Preferred Width")),this.cellWidthType=new U.DropDownList({enableRtl:i,floatLabelType:"Always",placeholder:t.getConstant("Measure in"),htmlAttributes:{"aria-labelledby":t.getConstant("Measure in")}}),this.cellWidthType.appendTo(h)},eg.prototype.setTableCellProperties=function(){var e=this.documentHelper.selection.cellFormat,t=(this.hasCellWidth=0<e.preferredWidth,e.preferredWidth);_.isNullOrUndefined(e.preferredWidth)?(this.preferredCellWidthCheckBox.indeterminate=!0,t=this.documentHelper.selection.start.paragraph.associatedCell.cellFormat.preferredWidth):this.preferredCellWidthCheckBox.checked=this.hasCellWidth,this.cellWidthBox.enabled=this.hasCellWidth,this.cellWidthType.enabled=this.hasCellWidth,"Auto"===e.preferredWidthType||"Point"===e.preferredWidthType?this.cellWidthType.index=0:this.cellWidthType.index=1,this.formatNumericTextBox(this.cellWidthBox,e.preferredWidthType,t),_.classList(this.cellTopAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),_.classList(this.cellCenterAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),_.classList(this.cellBottomAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),"Top"===e.verticalAlignment?_.classList(this.cellTopAlign,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]):"Center"===e.verticalAlignment?_.classList(this.cellCenterAlign,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]):"Bottom"===e.verticalAlignment&&_.classList(this.cellBottomAlign,["e-de-table-alignment-active"],["e-de-tablecell-alignment"])},eg.prototype.updateClassForCellAlignment=function(e){for(var t=e.getElementsByClassName(e.id+"e-de-table-cell-alignment"),i=0;i<t.length;i++){var n=t[parseInt(i.toString(),10)];n.classList.contains("e-de-table-alignment-active")&&_.classList(n,["e-de-tablecell-alignment"],["e-de-table-alignment-active"])}},eg.prototype.formatNumericTextBox=function(e,t,i){e.format="Auto"===t||"Point"===t?"n2":"#'%'",e.step=1,e.decimals=2,e.value=i,e.htmlAttributes={"aria-label":"cellWidth"}},eg.prototype.getCellAlignment=function(){for(var e=this.cellTab.id,t=this.cellTab.getElementsByClassName(e+"e-de-table-cell-alignment"),i=0;i<t.length;i++)if(t[parseInt(i.toString(),10)].classList.contains("e-de-table-alignment-active"))return 0===i?"Top":1===i?"Center":"Bottom";return this.documentHelper.selection.cellFormat.verticalAlignment},eg.prototype.onCellWidthChange=function(){this.cellFormat.preferredWidth=this.cellWidthBox.value},eg.prototype.onCellWidthTypeChange=function(){var e,t=this.documentHelper.selection.start.paragraph.associatedCell.ownerTable,i=t.getOwnerWidth(!0),t=t.getTableClientWidth(i);"Percent"===this.cellWidthType.text&&"Percent"!==this.documentHelper.selection.cellFormat.preferredWidthType?(e=this.cellWidthBox.value/t*100,this.formatNumericTextBox(this.cellWidthBox,"Percent",e)):"Points"===this.cellWidthType.text&&"Point"!==this.documentHelper.selection.cellFormat.preferredWidthType?(e=t/100*this.cellWidthBox.value,this.formatNumericTextBox(this.cellWidthBox,"Point",e)):(e="#'%'"===this.cellWidthBox.format?"Points"===this.cellWidthType.text?t/100*this.cellWidthBox.value:this.cellWidthBox.value:"Percent"===this.cellWidthType.text?this.cellWidthBox.value/t*100:this.cellWidthBox.value,this.formatNumericTextBox(this.cellWidthBox,"Points"===this.cellWidthType.text?"Point":this.cellWidthType.text,e)),this.cellFormat.preferredWidthType="Points"===this.cellWidthType.text?"Point":this.cellWidthType.text},eg.prototype.destroy=function(){if(!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}this.dialog=void 0,this.target=void 0,this.cellAlignment=void 0,this.tableAlignment=void 0,this.documentHelper=void 0,this.preferCheckBox=void 0,this.tableWidthType=void 0,this.preferredWidth=void 0,this.rowHeightType=void 0,this.rowHeightCheckBox=void 0,this.rowHeight=void 0,this.cellWidthType=void 0,this.preferredCellWidthCheckBox=void 0,this.preferredCellWidth=void 0,this.tableTab=void 0,this.rowTab=void 0,this.cellTab=void 0,this.left=void 0,this.center=void 0,this.right=void 0,this.leftIndent=void 0,this.allowRowBreak=void 0,this.repeatHeader=void 0,this.cellTopAlign=void 0,this.cellCenterAlign=void 0,this.cellBottomAlign=void 0,this.titleTextBox=void 0,this.descriptionTextBox=void 0,this.altTab=void 0,this.paraFormatIn&&(this.paraFormatIn.destroy(),this.paraFormatIn=void 0),this.tableFormatIn&&this.tableFormatIn.destroy(),this.cellFormatIn&&this.cellFormatIn.destroy(),this.tableFormatIn=void 0,this.cellFormatIn=void 0};var $u=eg;function eg(e){var l=this;this.hasTableWidth=!1,this.hasCellWidth=!1,this.bidi=!1,this.isTableBordersAndShadingUpdated=!1,this.isCellBordersAndShadingUpdated=!1,this.tabObj=void 0,this.localValue=void 0,this.isCellOptionsUpdated=!1,this.isTableOptionsUpdated=!1,this.onBeforeOpen=function(){l.documentHelper.updateFocus(),l.loadTableProperties()},this.onCloseTablePropertyDialog=function(){l.unWireEvent.bind(l),l.documentHelper.updateFocus()},this.applyTableProperties=function(){var e=l.documentHelper.selection;if(e.tableFormat.title===l.titleTextBox.value||_.isNullOrUndefined(l.titleTextBox.value)||(l.tableFormat.title=_.SanitizeHtmlHelper.sanitize(l.titleTextBox.value)),e.tableFormat.description===l.descriptionTextBox.value||_.isNullOrUndefined(l.descriptionTextBox.value)||(l.tableFormat.description=_.SanitizeHtmlHelper.sanitize(l.descriptionTextBox.value)),l.preferCheckBox.checked||l.preferCheckBox.indeterminate||!_.isNullOrUndefined(e.tableFormat.preferredWidth)&&0===e.tableFormat.preferredWidth||(l.tableFormat.preferredWidth=0,l.tableFormat.preferredWidthType="Point"),!l.tableFormat.hasValue("tableAlignment")||"Left"===l.tableFormat.tableAlignment||!_.isNullOrUndefined(e.tableFormat.leftIndent)&&0===e.tableFormat.leftIndent||(l.tableFormat.leftIndent=0),l.rowHeightCheckBox.checked||l.rowHeightCheckBox.indeterminate||!_.isNullOrUndefined(e.rowFormat.height)&&0===e.rowFormat.height||(l.rowFormat.heightType="AtLeast",l.rowFormat.height=0),l.preferredCellWidthCheckBox.checked||l.preferredCellWidthCheckBox.indeterminate){for(var t=l.documentHelper.selection.start.paragraph.associatedCell.ownerTable,i=t.getOwnerWidth(!0),n=t.getTableClientWidth(i),r=0;r<t.childWidgets.length;r++)for(var o=t.childWidgets[parseInt(r.toString(),10)],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[parseInt(s.toString(),10)];"Percent"===l.cellFormat.preferredWidthType&&"Point"===a.cellFormat.preferredWidthType?(a.cellFormat.preferredWidthType="Percent",a.cellFormat.preferredWidth=a.cellFormat.preferredWidth/n*100):"Point"===l.cellFormat.preferredWidthType&&"Percent"===a.cellFormat.preferredWidthType&&(a.cellFormat.preferredWidthType="Point",a.cellFormat.preferredWidth=a.cellFormat.cellWidth)}"Percent"!==l.cellFormat.preferredWidthType||l.tableFormat.hasValue("preferredWidth")||l.tableFormat.hasValue("preferredWidthType")||0!==l.documentHelper.selection.start.paragraph.associatedCell.ownerTable.tableFormat.preferredWidth||(i=l.documentHelper.selection.start.paragraph.associatedCell.ownerTable.getOwnerWidth(!0),i=l.documentHelper.selection.start.paragraph.associatedCell.ownerTable.getTableClientWidth(i),l.tableFormat.preferredWidthType="Percent",l.tableFormat.preferredWidth=i/j.convertPixelToPoint(l.documentHelper.owner.viewer.clientArea.width)*100)}else!_.isNullOrUndefined(e.cellFormat.preferredWidth)&&0===e.cellFormat.preferredWidth||(l.cellFormat.preferredWidthType="Point",l.cellFormat.preferredWidth=0);l.rowHeightValue&&(l.rowFormat.hasValue("heightType")||e.rowFormat.heightType===l.rowFormat.heightType||(l.rowFormat.heightType=e.rowFormat.heightType),l.rowFormat.height=l.rowHeightValue),l.isEqualTableFormat(e.tableFormat,l.tableFormat)&&l.isEqualRowFormat(e.rowFormat,l.rowFormat)&&l.isEqualCellFormat(e.cellFormat,l.cellFormat)||(l.documentHelper.owner.editorModule.initComplexHistory("TableProperties"),l.documentHelper.owner.editorModule.onTableFormat(l.tableFormat),l.documentHelper.owner.editorModule.onRowFormat(l.rowFormat),l.documentHelper.owner.editorModule.onCellFormat(l.cellFormat),l.documentHelper.owner.editorHistoryModule.updateComplexHistory()),l.closeTablePropertiesDialog(),l.documentHelper.updateFocus()},this.applyTableSubProperties=function(){var e;l.isCellOptionsUpdated&&(e=l.documentHelper.owner.cellOptionsDialogModule.cellFormat,l.documentHelper.owner.cellOptionsDialogModule.applySubCellOptions(e)),l.isTableOptionsUpdated&&(e=l.documentHelper.owner.tableOptionsDialogModule.tableFormat,l.documentHelper.owner.tableOptionsDialogModule.applySubTableOptions(e)),l.isCellOptionsUpdated=!1,l.isTableOptionsUpdated=!1},this.unWireEvent=function(){l.preferCheckBox.change=void 0,l.tableWidthBox.change=void 0,l.tableWidthType.change=void 0,l.leftIndentBox.change=void 0,l.rowHeightCheckBox.change=void 0,l.rowHeightBox.change=void 0,l.rowHeightType.change=void 0,l.repeatHeader.change=void 0,l.allowRowBreak.change=void 0,l.preferredCellWidthCheckBox.change=void 0,l.cellWidthBox.change=void 0,l.cellWidthType.change=void 0,l.cellFormat.destroy(),l.rowFormat.destroy(),l.tableFormat.destroy(),l.rowHeightValue=void 0,l.documentHelper.dialog2.open=l.documentHelper.selection.hideCaret.bind(l.documentHelper.owner.viewer)},this.closeTablePropertiesDialog=function(){l.documentHelper.dialog2.hide(),l.documentHelper.updateFocus()},this.changeBidirectional=function(e){"ltr"===e.value?(l.rtlButton.checked=!l.ltrButton.checked,l.tableFormat.bidi=!1):(l.ltrButton.checked=!l.rtlButton.checked,l.tableFormat.bidi=!0),l.tableFormat.bidi&&"Left"===l.tableFormat.tableAlignment?l.tableFormat.tableAlignment="Right":l.tableFormat.bidi||"Right"!==l.tableFormat.tableAlignment||(l.tableFormat.tableAlignment="Left"),l.activeTableAlignment(l.tableFormat,!0)},this.changeTableCheckBox=function(){var e=l.preferCheckBox.checked||l.preferCheckBox.indeterminate;l.tableWidthBox.enabled=e,l.tableWidthType.enabled=e,l.tableFormat.preferredWidthType=e?"Points"===l.tableWidthType.value?"Point":l.tableWidthType.value:l.documentHelper.selection.tableFormat.preferredWidthType},this.changeTableAlignment=function(e){l.updateClassForAlignmentProperties(l.tableTab);var e=e.target,t=(_.classList(e,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]),l.tableFormat.bidi||l.rtlButton.checked);e.classList.contains("e-de-table-left-alignment")&&!t||e.classList.contains("e-de-table-right-alignment")&&t?l.leftIndentBox.enabled=!0:l.leftIndentBox.enabled=!1,l.tableFormat.tableAlignment=l.getTableAlignment()},this.changeTableRowCheckBox=function(){l.rowHeightType.enabled=l.rowHeightCheckBox.checked,l.rowHeightBox.enabled=l.rowHeightCheckBox.checked,l.rowHeightType.enabled?l.rowFormat.heightType=l.rowHeightType.value:l.rowFormat.heightType=l.documentHelper.selection.rowFormat.heightType},this.changeTableCellCheckBox=function(){l.cellWidthType.enabled=l.preferredCellWidthCheckBox.checked,l.cellWidthBox.enabled=l.preferredCellWidthCheckBox.checked},this.changeCellAlignment=function(e){l.updateClassForCellAlignment(l.cellTab);e=e.target;_.classList(e,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]),l.cellFormat.verticalAlignment=l.getCellAlignment()},this.showTableOptionsDialog=function(){l.documentHelper.owner.tableOptionsDialogModule.show(),l.documentHelper.dialog2.element.style.pointerEvents="none"},this.showBordersShadingsPropertiesDialog=function(){l.documentHelper.owner.bordersAndShadingDialogModule.show(),l.documentHelper.dialog2.element.style.pointerEvents="none"},this.showCellOptionsDialog=function(){l.documentHelper.owner.cellOptionsDialogModule.show(),l.documentHelper.dialog2.element.style.pointerEvents="none"},this.documentHelper=e}ig.prototype.getModuleName=function(){return"BordersAndShadingDialog"},ig.prototype.initBordersAndShadingsDialog=function(e,t){this.target=_.createElement("div",{id:this.documentHelper.owner.containerId+"_table_border_shadings",className:"e-de-table-border-shading-dlg"});var R=_.createElement("div",{innerHTML:e.getConstant("Borders"),className:"e-de-table-border-heading"}),i=_.createElement("div",{className:"e-de-dlg-row"}),n=_.createElement("div",{}),r=_.createElement("div",{}),o=_.createElement("div",{className:"e-de-table-border-preview-container"}),s=_.createElement("div",{className:"e-de-dlg-row"}),a=_.createElement("div",{}),l=_.createElement("div",{className:"e-de-container-row"}),d=_.createElement("div",{className:"e-de-subcontainer-left"}),h=_.createElement("input",{}),c=_.createElement("div",{className:"e-de-container-row"}),p=_.createElement("div",{className:"e-de-subcontainer-left"}),u=_.createElement("input",{}),g=_.createElement("div",{className:"e-de-subcontainer-right"}),m=_.createElement("div",{innerHTML:e.getConstant("Color"),className:"e-de-table-border-clr-heading"}),f=_.createElement("input",{attrs:{type:"color"},className:"e-dlg-clr-pkr-top"}),y=_.createElement("div",{innerHTML:e.getConstant("Setting"),className:"e-de-table-setting-heading"}),v=_.createElement("div",{className:"e-de-dlg-row"}),w=_.createElement("div",{id:this.target.id+"_None_Div_Container"}),b=(this.noneDiv=_.createElement("div",{id:this.target.id+"_None_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"}),_.createElement("label",{innerHTML:e.getConstant("None"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_None_Div_Label"})),x=_.createElement("div",{id:this.target.id+"_Box_Div_Container"}),C=(this.boxDiv=_.createElement("div",{id:this.target.id+"_Box_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"}),_.createElement("label",{innerHTML:e.getConstant("Box"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_Box_Div_Label"})),I=_.createElement("div",{id:this.target.id+"_All_Div_Container"}),k=(this.allDiv=_.createElement("div",{id:this.target.id+"_All_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"}),_.createElement("label",{innerHTML:e.getConstant("All"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_All_Div_Label"})),F=_.createElement("div",{id:this.target.id+"_Custom_Div_Container"}),P=(this.customDiv=_.createElement("div",{id:this.target.id+"_Custom_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"}),_.createElement("label",{innerHTML:e.getConstant("Custom"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_Custom_Div_Label"})),T=(this.noneDivTransparent=_.createElement("div",{id:this.target.id+"_None_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-none-setting"}),this.boxDivTransparent=_.createElement("div",{id:this.target.id+"_Box_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-box-setting"}),this.allDivTransparent=_.createElement("div",{id:this.target.id+"_All_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-all-setting"}),this.customDivTransparent=_.createElement("div",{id:this.target.id+"_Custom_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-custom-setting"}),t&&(this.noneDivTransparent.classList.add("e-de-rtl"),this.boxDivTransparent.classList.add("e-de-rtl"),this.allDivTransparent.classList.add("e-de-rtl"),this.customDivTransparent.classList.add("e-de-rtl")),_.createElement("div",{innerHTML:e.getConstant("Preview"),className:"e-de-table-setting-heading"})),S=(this.previewDiv=_.createElement("div",{id:this.target.id+"_Preview_Div",className:"e-de-border-dlg-preview-div",styles:"position: relative"}),this.previewRightDiagonalDiv=_.createElement("div",{styles:"position: absolute;width:1px;height:111px;left: 38px;top: -17px;transform: rotate(135deg); background-color: black",id:this.target.id+"_Preview_Div_Right_Diagonal",className:"e-de-border-dlg-preview-inside-divs"}),this.previewLeftDiagonalDiv=_.createElement("div",{styles:"position: absolute;width: 1px;height: 111px;left: 38px;top: -17px;transform:rotate(45deg); background-color: black",id:this.target.id+"_Preview_Div_Left_Diagonal",className:"e-de-border-dlg-preview-inside-divs"}),this.previewVerticalDiv=_.createElement("div",{styles:"width: 1px;height: 80px;position: absolute;left: 39px;top: -1px; background-color: black",id:this.target.id+"_Preview_Div_Vertical",className:"e-de-border-dlg-preview-inside-divs"}),this.previewHorizontalDiv=_.createElement("div",{styles:"width: 80px;height: 1px;position: absolute;left: -1px;top: 41px; background-color: black",id:this.target.id+"_Preview_Div_Horizontal",className:"e-de-border-dlg-preview-inside-divs"}),_.createElement("div")),H=(this.previewDivTopTopContainer=_.createElement("div",{styles:"margin-top: 0",className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_TopTop_Container"}),this.previewDivTopTop=_.createElement("div",{id:this.target.id+"_Preview_Div_TopTop",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopCenterContainer=_.createElement("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_TopCenter_Container"}),this.previewDivTopCenter=_.createElement("div",{id:this.target.id+"_Preview_Div_TopCenter",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopBottomContainer=_.createElement("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_TopBottom_Container"}),this.previewDivTopBottom=_.createElement("div",{id:this.target.id+"_Preview_Div_TopBottom",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivLeftDiagonalContainer=_.createElement("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_LeftDiagonal_Container"}),this.previewDivLeftDiagonal=_.createElement("div",{id:this.target.id+"_Preview_Div_LeftDiagonal",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),_.createElement("div",{className:"e-de-dlg-row"})),M=(this.previewDivBottomLeftContainer=_.createElement("div",{id:this.target.id+"_Preview_Div_BottomLeft_Container",className:"e-de-table-border-icon-container"}),this.previewDivBottomLeft=_.createElement("div",{id:this.target.id+"_Preview_Div_BottomLeft",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivBottomcenterContainer=_.createElement("div",{id:this.target.id+"_Preview_Div_BottomCenter_Container",className:"e-de-table-border-icon-container"}),this.previewDivBottomcenter=_.createElement("div",{id:this.target.id+"_Preview_Div_BottomCenter",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivBottomRightContainer=_.createElement("div",{id:this.target.id+"_Preview_Div_BottomRight_Container",className:"e-de-table-border-icon-container"}),this.previewDivBottomRight=_.createElement("div",{id:this.target.id+"_Preview_Div_BottomRight",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivDiagonalRightContainer=_.createElement("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_RightDiagonal_Container"}),this.previewDivDiagonalRight=_.createElement("div",{id:this.target.id+"_Preview_Div_RightDiagonal",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopTopTransParent=_.createElement("div",{id:this.target.id+"_previewDivTopTopTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-toptop-alignment"}),this.previewDivTopCenterTransParent=_.createElement("div",{id:this.target.id+"_previewDivTopCenterTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-topcenter-alignment"}),this.previewDivTopBottomTransParent=_.createElement("div",{id:this.target.id+"_previewDivTopBottomTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-topbottom-alignment"}),this.previewDivLeftDiagonalTransParent=_.createElement("div",{id:this.target.id+"_previewDivLeftDiagonalTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-diagionalup-alignment"}),this.previewDivBottomLeftTransparent=_.createElement("div",{id:this.target.id+"_previewDivBottomLeftTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomleft-alignment"}),this.previewDivBottomcenterTransparent=_.createElement("div",{id:this.target.id+"_previewDivBottomcenterTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomcenter-alignment"}),this.previewDivBottomRightTransparent=_.createElement("div",{id:this.target.id+"_previewDivBottomRightTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomright-alignment"}),this.previewDivDiagonalRightTransparent=_.createElement("div",{id:this.target.id+"_previewDivDiagonalRightTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-diagionaldown-alignment"}),this.shadingContiner=_.createElement("div",{}),_.createElement("div",{innerHTML:e.getConstant("Shading"),className:"e-de-table-border-heading"})),N=_.createElement("div",{className:"e-de-dlg-row"}),W=_.createElement("div",{className:"e-de-table-border-clr-left-container"}),O=_.createElement("div",{innerHTML:e.getConstant("Fill"),className:"e-de-table-border-clr-heading"}),E=_.createElement("input",{attrs:{type:"color"},id:this.target.id+"_shading_color"}),L=_.createElement("div",{className:"e-de-subcontainer-right"}),B=_.createElement("input",{id:this.target.id+"_shading"}),A=[{Value:"Cell",Name:e.getConstant("Cell ")},{Value:"Table",Name:e.getConstant("Table")},{Value:"Paragraph",Name:e.getConstant("Paragraph")}],b=(L.appendChild(B),this.noneDiv.appendChild(this.noneDivTransparent),this.boxDiv.appendChild(this.boxDivTransparent),this.allDiv.appendChild(this.allDivTransparent),this.customDiv.appendChild(this.customDivTransparent),w.appendChild(this.noneDiv),w.appendChild(b),x.appendChild(this.boxDiv),x.appendChild(C),I.appendChild(this.allDiv),I.appendChild(k),F.appendChild(this.customDiv),F.appendChild(P),n.appendChild(y),n.appendChild(v),v.appendChild(w),v.appendChild(x),v.appendChild(I),v.appendChild(F),this.previewDivBottomcenter.appendChild(this.previewDivBottomcenterTransparent),this.previewDivBottomRight.appendChild(this.previewDivBottomRightTransparent),this.previewDivBottomLeft.appendChild(this.previewDivBottomLeftTransparent),this.previewDivTopTop.appendChild(this.previewDivTopTopTransParent),this.previewDivTopCenter.appendChild(this.previewDivTopCenterTransParent),this.previewDivTopBottom.appendChild(this.previewDivTopBottomTransParent),this.previewDivDiagonalRight.appendChild(this.previewDivDiagonalRightTransparent),this.previewDivLeftDiagonal.appendChild(this.previewDivLeftDiagonalTransParent),this.previewDivBottomcenterContainer.appendChild(this.previewDivBottomcenter),this.previewDivBottomLeftContainer.appendChild(this.previewDivBottomLeft),this.previewDivBottomRightContainer.appendChild(this.previewDivBottomRight),this.previewDivDiagonalRightContainer.appendChild(this.previewDivDiagonalRight),this.previewDivLeftDiagonalContainer.appendChild(this.previewDivLeftDiagonal),this.previewDivTopBottomContainer.appendChild(this.previewDivTopBottom),this.previewDivTopCenterContainer.appendChild(this.previewDivTopCenter),this.previewDivTopTopContainer.appendChild(this.previewDivTopTop),o.appendChild(T),o.appendChild(s),s.appendChild(S),s.appendChild(a),a.appendChild(this.previewDiv),a.appendChild(H),this.previewDiv.appendChild(this.previewLeftDiagonalDiv),this.previewDiv.appendChild(this.previewRightDiagonalDiv),this.previewDiv.appendChild(this.previewHorizontalDiv),this.previewDiv.appendChild(this.previewVerticalDiv),H.appendChild(this.previewDivBottomLeftContainer),H.appendChild(this.previewDivBottomcenterContainer),H.appendChild(this.previewDivBottomRightContainer),H.appendChild(this.previewDivDiagonalRightContainer),S.appendChild(this.previewDivTopTopContainer),S.appendChild(this.previewDivTopCenterContainer),S.appendChild(this.previewDivTopBottomContainer),S.appendChild(this.previewDivLeftDiagonalContainer),N.appendChild(W),W.appendChild(O),W.appendChild(E),N.appendChild(L),this.shadingContiner.appendChild(M),this.shadingContiner.appendChild(N),r.appendChild(l),l.appendChild(d),d.appendChild(h),r.appendChild(c),c.appendChild(p),p.appendChild(u),c.appendChild(g),g.appendChild(m),g.appendChild(f),f.setAttribute("aria-label",m.innerHTML),i.appendChild(n),i.appendChild(o),this.target.appendChild(R),this.target.appendChild(i),this.target.appendChild(r),this.target.appendChild(this.shadingContiner),w.addEventListener("click",this.handleSettingCheckBoxAction),x.addEventListener("click",this.handleSettingCheckBoxAction),I.addEventListener("click",this.handleSettingCheckBoxAction),F.addEventListener("click",this.handleSettingCheckBoxAction),this.previewDivBottomcenterContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivBottomLeftContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivBottomRightContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivTopTopContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivTopBottomContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivTopCenterContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivDiagonalRightContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivLeftDiagonalContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.borderWidth=new D.NumericTextBox({value:.5,min:.25,max:6,decimals:2,step:.25,floatLabelType:"Always",placeholder:e.getConstant("Width"),enablePersistence:!1}),this.borderWidth.appendTo(u),u.setAttribute("aria-labelledby",e.getConstant("width")),_.initializeCSPTemplate(function(e){return"<div>"+e.Svg+"</div>"})),C=(this.borderStyle=new U.DropDownList({popupHeight:"150px",dataSource:[{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"Single"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round" stroke-dasharray="1 1"/></svg></div>',LineStyle:"Dot"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_1347_1852)"><path d="M3.05176e-05 5.5H98" stroke-linejoin="round" stroke-dasharray="4 1"/></g><defs><clipPath id="clip0_1347_1852"><rect width="98" height="10" fill="white"/></clipPath></defs></svg></div>',LineStyle:"DashSmallGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round" stroke-dasharray="4 4"/></svg></div>',LineStyle:"DashLargeGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round" stroke-dasharray="7 3 3 3"/></svg></div>',LineStyle:"DashDot"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 4.5H98" stroke-linejoin="round" stroke-dasharray="6 2 2 2 2 2"/></svg></div>',LineStyle:"DashDotDot"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 3.5H98" stroke-linejoin="round"/><path d="M0 5.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"Double"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round"/><path d="M0 3.5H98" stroke-linejoin="round"/><path d="M0 7.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"Triple"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 4H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 4H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 7.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"ThinThickSmallGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 6H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 2.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"ThickThinSmallGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 1.5H98" stroke-linejoin="round"/><path d="M0 8.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"ThinThickThinSmallGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 3H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 8H98" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"ThickThinMediumGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 7H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 2H98" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"ThinThickMediumGap"},{Svg:'<div class="e-de-svg-border-fill-color"><svg style="width:98%;" height="23" viewBox="0 0 98 23" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M98 8H0V9H98V8ZM98 10H0V14H98V10ZM0 15H98V16H0V15Z" /></svg></div>',LineStyle:"ThinThickThinMediumGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 8.5H98" stroke-linejoin="round"/><path d="M0 3H98" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"ThinThickLargeGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 2.5H98" stroke-linejoin="round"/><path d="M0 8H98" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"ThickThinLargeGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_1347_1892)"><g clip-path="url(#clip0_1407_5)"><path d="M0 0.5H98" stroke-linejoin="round"/><path d="M0 9.5H98" stroke-linejoin="round"/><path d="M0 5H98" stroke-width="2" stroke-linejoin="round"/></g><defs><clipPath id="clip0_1407_5"><rect width="98" height="10" fill="white"/></clipPath></defs></svg></div>',LineStyle:"ThinThickThinLargeGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 3H5V4H3V3ZM2 5V4H3V5H2ZM1 6V5H2V6H1ZM1 6V7H0V6H1ZM6 5H5V4H6V5ZM7 6H6V5H7V6ZM9 6V7H7V6H9ZM10 5V6H9V5H10ZM11 4V5H10V4H11ZM13 4H11V3H13V4ZM14 5H13V4H14V5ZM15 6H14V5H15V6ZM17 6V7H15V6H17ZM18 5V6H17V5H18ZM19 4V5H18V4H19ZM21 4H19V3H21V4ZM22 5H21V4H22V5ZM23 6H22V5H23V6ZM25 6V7H23V6H25ZM26 5V6H25V5H26ZM27 4V5H26V4H27ZM29 4H27V3H29V4ZM30 5H29V4H30V5ZM31 6H30V5H31V6ZM33 6V7H31V6H33ZM34 5V6H33V5H34ZM35 4V5H34V4H35ZM37 4H35V3H37V4ZM38 5H37V4H38V5ZM39 6H38V5H39V6ZM41 6V7H39V6H41ZM42 5V6H41V5H42ZM43 4V5H42V4H43ZM45 4H43V3H45V4ZM46 5H45V4H46V5ZM47 6H46V5H47V6ZM49 6V7H47V6H49ZM50 5V6H49V5H50ZM51 4V5H50V4H51ZM53 4H51V3H53V4ZM54 5H53V4H54V5ZM55 6H54V5H55V6ZM57 6V7H55V6H57ZM58 5V6H57V5H58ZM59 4V5H58V4H59ZM61 4H59V3H61V4ZM62 5H61V4H62V5ZM63 6H62V5H63V6ZM65 6V7H63V6H65ZM66 5V6H65V5H66ZM67 4V5H66V4H67ZM69 4H67V3H69V4ZM70 5H69V4H70V5ZM71 6H70V5H71V6ZM73 6V7H71V6H73ZM74 5V6H73V5H74ZM75 4V5H74V4H75ZM77 4H75V3H77V4ZM78 5H77V4H78V5ZM79 6H78V5H79V6ZM81 6V7H79V6H81ZM82 5V6H81V5H82ZM83 4V5H82V4H83ZM85 4H83V3H85V4ZM86 5H85V4H86V5ZM87 6H86V5H87V6ZM89 6V7H87V6H89ZM90 5V6H89V5H90ZM91 4V5H90V4H91ZM93 4H91V3H93V4ZM94 5H93V4H94V5ZM95 6V5H94V6H95ZM95 6V7H97V6H95Z" fill="black"/></svg></div>',LineStyle:"SingleWavy"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 2H5V3H3V2ZM2 4V3H3V4H2ZM2 4V5H1V4H2ZM6 4H5V3H6V4ZM9 4V5H6V4H9ZM10 3V4H9V3H10ZM12 3H10V2H12V3ZM13 4H12V3H13V4ZM16 4V5H13V4H16ZM17 3V4H16V3H17ZM19 3H17V2H19V3ZM20 4H19V3H20V4ZM23 4V5H20V4H23ZM24 3V4H23V3H24ZM26 3H24V2H26V3ZM27 4H26V3H27V4ZM30 4V5H27V4H30ZM31 3V4H30V3H31ZM33 3H31V2H33V3ZM34 4H33V3H34V4ZM37 4V5H34V4H37ZM38 3V4H37V3H38ZM40 3H38V2H40V3ZM41 4H40V3H41V4ZM44 4V5H41V4H44ZM45 3V4H44V3H45ZM47 3H45V2H47V3ZM48 4H47V3H48V4ZM51 4V5H48V4H51ZM52 3V4H51V3H52ZM54 3H52V2H54V3ZM55 4H54V3H55V4ZM58 4V5H55V4H58ZM59 3V4H58V3H59ZM61 3H59V2H61V3ZM62 4H61V3H62V4ZM65 4V5H62V4H65ZM66 3V4H65V3H66ZM68 3H66V2H68V3ZM69 4H68V3H69V4ZM72 4V5H69V4H72ZM73 3V4H72V3H73ZM75 3H73V2H75V3ZM76 4H75V3H76V4ZM79 4V5H76V4H79ZM80 3V4H79V3H80ZM82 3H80V2H82V3ZM83 4H82V3H83V4ZM86 4V5H83V4H86ZM87 3V4H86V3H87ZM89 3H87V2H89V3ZM90 4H89V3H90V4ZM93 4V5H90V4H93ZM94 3V4H93V3H94ZM96 3H94V2H96V3ZM96 3H97V4H96V3ZM2 7H1V8H2V7ZM3 6H2V7H3V6ZM5 6H3V5H5V6ZM6 7H5V6H6V7ZM9 7V8H6V7H9ZM10 6V7H9V6H10ZM12 6H10V5H12V6ZM13 7H12V6H13V7ZM16 7H13V8H16V7ZM17 6H16V7H17V6ZM19 6V5H17V6H19ZM20 7V6H19V7H20ZM23 7H20V8H23V7ZM24 6H23V7H24V6ZM26 6V5H24V6H26ZM27 7V6H26V7H27ZM30 7V8H27V7H30ZM31 6V7H30V6H31ZM33 6H31V5H33V6ZM34 7H33V6H34V7ZM37 7V8H34V7H37ZM38 6V7H37V6H38ZM40 6H38V5H40V6ZM41 7H40V6H41V7ZM44 7H41V8H44V7ZM45 6H44V7H45V6ZM47 6V5H45V6H47ZM48 7V6H47V7H48ZM51 7H48V8H51V7ZM52 6H51V7H52V6ZM54 6V5H52V6H54ZM55 7V6H54V7H55ZM58 7V8H55V7H58ZM59 6V7H58V6H59ZM61 6H59V5H61V6ZM62 7H61V6H62V7ZM65 7V8H62V7H65ZM66 6V7H65V6H66ZM68 6H66V5H68V6ZM69 7H68V6H69V7ZM72 7H69V8H72V7ZM73 6H72V7H73V6ZM75 6V5H73V6H75ZM76 7V6H75V7H76ZM79 7H76V8H79V7ZM80 6H79V7H80V6ZM82 6V5H80V6H82ZM83 7V6H82V7H83ZM86 7V8H83V7H86ZM87 6V7H86V6H87ZM89 6H87V5H89V6ZM90 7H89V6H90V7ZM93 7V8H90V7H93ZM94 6V7H93V6H94ZM96 6H94V5H96V6ZM96 6V7H97V6H96Z" fill="black"/></svg></div>',LineStyle:"DoubleWavy"},{Svg:'<div class="e-de-svg-border-fill-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 3H4V4H3V5H2V6H1V7H0V3ZM3 6V5H4V6H3ZM5 5V6H4V7H9V6H10V7H11V6H12V7H17V6H18V7H19V6H20V7H25V6H26V7H27V6H28V7H33V6H34V7H35V6H36V7H41V6H42V7H43V6H44V7H49V6H50V7H51V6H52V7H57V6H58V7H59V6H60V7H65V6H66V7H67V6H68V7H73V6H74V7H75V6H76V7H81V6H82V7H83V6H84V7H89V6H90V7H91V6H92V7H97V6H98V5V3H95V4H94V3H93V4H92V3H87V4H86V3H85V4H84V3H79V4H78V3H77V4H76V3H71V4H70V3H69V4H68V3H63V4H62V3H61V4H60V3H55V4H54V3H53V4H52V3H47V4H46V3H45V4H44V3H39V4H38V3H37V4H36V3H31V4H30V3H29V4H28V3H23V4H22V3H21V4H20V3H15V4H14V3H13V4H12V3H7V4H6V3H5V4H4V5H5ZM5 5H6V4H5V5ZM12 5V4H11V5H10V6H11V5H12ZM13 5V6H12V5H13ZM13 5V4H14V5H13ZM20 5V4H19V5H18V6H19V5H20ZM21 5H22V4H21V5ZM21 5H20V6H21V5ZM28 5V4H27V5H26V6H27V5H28ZM29 5V6H28V5H29ZM29 5H30V4H29V5ZM36 5V4H35V5H34V6H35V5H36ZM37 5V4H38V5H37ZM37 5H36V6H37V5ZM44 5V4H43V5H42V6H43V5H44ZM45 5V6H44V5H45ZM45 5V4H46V5H45ZM52 5V4H51V5H50V6H51V5H52ZM53 5H54V4H53V5ZM53 5H52V6H53V5ZM60 5V4H59V5H58V6H59V5H60ZM61 5V6H60V5H61ZM61 5H62V4H61V5ZM68 5V4H67V5H66V6H67V5H68ZM69 5V4H70V5H69ZM69 5H68V6H69V5ZM76 5V4H75V5H74V6H75V5H76ZM77 5V6H76V5H77ZM77 5V4H78V5H77ZM84 5V4H83V5H82V6H83V5H84ZM85 5H86V4H85V5ZM85 5H84V6H85V5ZM92 5V4H91V5H90V6H91V5H92ZM93 5V6H92V5H93ZM93 5H94V4H93V5ZM3 6H2V7H3V6Z" /></svg></div>',LineStyle:"DashDotStroked"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 8H98" stroke-width="2" stroke-linejoin="round"/><path d="M0 5H98" stroke="#808080" stroke-width="4" stroke-linejoin="round"/><path d="M0 2H98" stroke="#C0C0C0" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"Emboss3D"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 2H98" stroke-width="2" stroke-linejoin="round"/><path d="M0 5H98" stroke="#808080" stroke-width="4" stroke-linejoin="round"/><path d="M0 8H98" stroke="#C0C0C0" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"Engrave3D"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.5H98" stroke="#A0A0A0" stroke-linejoin="round"/><path d="M0 8.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"Outset"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.5H98" stroke-linejoin="round"/><path d="M0 8.5H98" stroke="#A0A0A0" stroke-linejoin="round"/></svg></div>',LineStyle:"Inset"}],floatLabelType:"Always",fields:{text:"Svg",value:"LineStyle"},itemTemplate:b,valueTemplate:b,placeholder:e.getConstant("Style"),enableRtl:t}),this.borderStyle.appendTo(h),h.setAttribute("aria-lablledby",e.getConstant("Style")),this.ulelementShading=new U.DropDownList({dataSource:A,fields:{text:"Name",value:"Value"},change:this.applyTableCellPreviewBoxes,index:1,floatLabelType:"Always",placeholder:e.getConstant("Apply To"),enableRtl:t,htmlAttributes:{"aria-labelledby":e.getConstant("Apply To")}}),this.ulelementShading.appendTo(B),this.documentHelper.owner.documentEditorSettings.colorPickerSettings),k=C.columns,P=C.createPopupOnClick,y=(C.cssClass,C.disabled),v=C.enablePersistence,T=C.inline,s=C.mode,a=C.modeSwitcher,H=C.noColor,S=C.presetColors,W=C.showButtons;this.borderColorPicker=new D.ColorPicker({value:"#000000",change:this.applyPreviewTableBorderColor,enableRtl:t,locale:this.documentHelper.owner.locale,cssClass:"e-de-dlg-clr-picker",enableOpacity:!1,mode:s,modeSwitcher:a,showButtons:W,columns:k,createPopupOnClick:P,disabled:y,enablePersistence:v,inline:T,noColor:H,presetColors:S}),this.documentHelper.borderColorPicker=this.borderColorPicker,this.borderColorPicker.appendTo(f),this.shadingColorPicker=new D.ColorPicker({value:"#FFFFFF",change:this.applyPreviewTableBackgroundColor,enableRtl:t,locale:this.documentHelper.owner.locale,cssClass:"e-de-dlg-clr-picker",enableOpacity:!1,mode:s,modeSwitcher:a,showButtons:W,columns:k,createPopupOnClick:P,disabled:y,enablePersistence:v,inline:T,noColor:H,presetColors:S}),this.documentHelper.shadingColorPicker=this.shadingColorPicker,this.shadingColorPicker.appendTo(E),t&&O.classList.add("e-de-rtl")},ig.prototype.updateBorder=function(e,t){"Single"===t.lineStyle&&"None"===e.lineStyle&&(e.lineStyle="Single",e.lineWidth=t.lineWidth)},ig.prototype.applyFormat=function(){var e=this.documentHelper.owner.editorModule;"Paragraph"!==this.ulelementShading.value&&(e.initComplexHistory("BordersAndShading"),e.isBordersAndShadingDialog=!0,"Cell"===this.ulelementShading.value?e.onCellFormat(this.cellFormat):"Table"===this.ulelementShading.value&&e.onTableFormat(this.tableFormat,!0),_.isNullOrUndefined(this.documentHelper.owner.editorHistoryModule.currentHistoryInfo)||this.documentHelper.owner.editorHistoryModule.updateComplexHistory(),"Cell"===this.ulelementShading.value?e.isCellFormatApplied=!0:e.isCellFormatApplied=!1),"Cell"===this.ulelementShading.value?e.isCellFormatApplied=!0:e.isCellFormatApplied=!1,e.isBordersAndShadingDialog=!1},ig.prototype.getBorder=function(e){var t=new Va;return t.color=this.borderColorPicker.value,t.lineStyle=this.borderStyle.value,t.lineWidth=this.borderWidth.value,t.space="left"===e||"right"===e?4:1,t},ig.prototype.checkClassName=function(e){return e.classList.contains("e-de-table-border-inside-preview-click")},ig.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initBordersAndShadingsDialog(e,this.documentHelper.owner.enableRtl),this.loadBordersShadingsPropertiesDialog(e),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.header=e.getConstant("Borders and Shading"),this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.closeBordersShadingsDialog,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.buttons=[{click:this.applyBordersShadingsProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-border-shading-okay",isPrimary:!0}},{click:this.closeDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-border-shading-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},ig.prototype.updateClassForSettingDivElements=function(){for(var e,t=this.target.getElementsByClassName("e-de-table-border-inside-setting"),i=0;i<t.length;i++)-1!==t[parseInt(i.toString(),10)].className.indexOf("e-de-table-border-inside-setting-click")&&(e=(e=t[parseInt(i.toString(),10)].className).replace("e-de-table-border-inside-setting-click",""),t[parseInt(i.toString(),10)].className=e)},ig.prototype.setSettingPreviewDivElement=function(e){switch(e){case"none":this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("none");break;case"box":this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("box");break;case"all":"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?(this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.add("e-de-table-border-inside-preview-click")):(this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click")),this.isShowHidePreviewTableElements("all")}},ig.prototype.isShowHidePreviewTableElements=function(e){switch(e){case"none":this.previewDiv.style.border="none",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none";break;case"box":this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none";break;case"all":"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?(this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="block",this.previewVerticalDiv.style.display="block"):(this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none")}},ig.prototype.handlePreviewCheckBoxShowHide=function(e,t,i){i.classList.contains(t)?i.classList.remove(t):i.classList.add(t)},ig.prototype.showHidePreviewDivElements=function(e,t,i,n,r){i=document.getElementById(e+i),e=document.getElementById(e+n);"TopTop"===r?this.setPropertyPreviewDivElement(i,e,t,"border-top"):"TopCenter"===r?this.setPropertyPreviewDivElement(i,e,t,"display"):"TopBottom"===r?this.setPropertyPreviewDivElement(i,e,t,"border-bottom"):"LeftDiagonal"===r?this.setPropertyPreviewDivElement(i,e,t,"display"):"BottomLeft"===r?this.setPropertyPreviewDivElement(i,e,t,"border-left"):"BottomCenter"===r?this.setPropertyPreviewDivElement(i,e,t,"display"):"BottomRight"===r?this.setPropertyPreviewDivElement(i,e,t,"border-right"):"RightDiagonal"===r&&this.setPropertyPreviewDivElement(i,e,t,"display")},ig.prototype.setPropertyPreviewDivElement=function(e,t,i,n){t.classList.contains(i)&&"border"===n.split("-")[0]?e.style[""+n]="1px solid rgba(0, 0, 0, .54)":t.classList.contains(i)&&"display"===n?e.style[""+n]="block":e.style[""+n]="none"},ig.prototype.loadBordersShadingsPropertiesDialog=function(e){var t,i,n;_.isNullOrUndefined(this.documentHelper.selection.tableFormat.table)?(this.shadingContiner.style.display="none",this.ulelementShading.dataSource=[{Value:"Paragraph",Name:e.getConstant("Paragraph")}],this.ulelementShading.dataBind(),n=this.documentHelper.selection.start.paragraph.paragraphFormat,this.ulelementShading.value="Paragraph",this.cloneBorders(n.borders),n=(n=this.getSelectionBorderFormat()).hasValues()?(t=this.getLineStyle(n.lineStyle),i=n.color,n.lineWidth):(t=0,i="#000000",.5),this.shadingColorPicker.disabled=!0):(this.shadingContiner.style.display="block",this.ulelementShading.dataSource=[{Value:"Cell",Name:e.getConstant("Cell")},{Value:"Table",Name:e.getConstant("Table")},{Value:"Paragraph",Name:e.getConstant("Paragraph")}],this.ulelementShading.dataBind(),e=this.documentHelper.selection.tableFormat.table.tableFormat,_.isNullOrUndefined(e)||_.isNullOrUndefined(e.borders)||(this.cloneBorders(e.borders),e=_.isNullOrUndefined(e.borders)||_.isNullOrUndefined(e.borders.top)?(n=t=0,i="#000000"):(t=this.getLineStyle(e.borders.top.lineStyle),i=e.borders.top.color,n=e.borders.top.getLineWidth(),e.shading.backgroundColor),this.ulelementShading.value="Table",this.shadingColorPicker.value=e,this.shadingColorPicker.disabled=!1)),this.borderColorPicker.value=i,this.previewDivLeftDiagonal.style.display="none",this.previewDivDiagonalRight.style.display="none",this.borderWidth.value=n,this.borderStyle.index=t},ig.prototype.getSelectionBorderFormat=function(){var e=new Va,t=this.documentHelper.selection.paragraphFormat.borders;return"None"!==t.top.lineStyle?this.copyToBorder(e,t.top):"None"!==t.left.lineStyle?this.copyToBorder(e,t.left):"None"!==t.bottom.lineStyle?this.copyToBorder(e,t.bottom):"None"!==t.right.lineStyle?this.copyToBorder(e,t.right):e},ig.prototype.copyToBorder=function(e,t){return _.isNullOrUndefined(t.lineStyle)||(e.lineStyle=t.lineStyle),_.isNullOrUndefined(t.color)||(e.color=t.color),_.isNullOrUndefined(t.lineWidth)||(e.lineWidth=t.lineWidth),e},ig.prototype.cloneBorders=function(e){var t=!1,i=!1,n=!1,r=!1,o=!1,s=!1,a=!1,l=!1,d=!1;null!==e&&(e.top&&(e.top.hasNoneStyle||"None"!==e.top.lineStyle)&&(t=!0),e.bottom&&(e.bottom.hasNoneStyle||"None"!==e.bottom.lineStyle)&&(i=!0),e.left&&(e.left.hasNoneStyle||"None"!==e.left.lineStyle)&&(n=!0),e.right&&(e.right.hasNoneStyle||"None"!==e.right.lineStyle)&&(r=!0),e.horizontal&&(e.horizontal.hasNoneStyle||"None"!==e.horizontal.lineStyle)&&(o=!0),e.vertical&&(e.vertical.hasNoneStyle||"None"!==e.vertical.lineStyle)&&(s=!0),e.diagonalDown&&(e.diagonalDown.hasNoneStyle||"None"!==e.diagonalDown.lineStyle)&&(a=!0),e.diagonalUp&&(e.diagonalUp.hasNoneStyle||"None"!==e.diagonalUp.lineStyle)&&(d=!0),t&&i&&n&&r?o&&s&&!d&&!a?(e.top.hasNoneStyle&&e.bottom.hasNoneStyle&&e.left.hasNoneStyle&&e.right.hasNoneStyle&&e.horizontal.hasNoneStyle&&e.vertical.hasNoneStyle?(this.setSettingPreviewDivElement("none"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv):(this.setSettingPreviewDivElement("all"),this.allDiv.classList.add("e-de-table-border-inside-setting-click"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv)).classList.remove("e-de-table-border-inside-setting-click"):n&&i&&t&&r&&!o&&!s?e.top.hasNoneStyle&&e.bottom.hasNoneStyle&&e.left.hasNoneStyle&&e.right.hasNoneStyle&&e.horizontal.hasNoneStyle&&e.vertical.hasNoneStyle?(this.setSettingPreviewDivElement("none"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click")):(this.setSettingPreviewDivElement("box"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.add("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")):l=!0:l=!0,this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),t||i||n||r||o||s?l&&(this.customDiv.classList.add("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click"),"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?t?this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"):t?(this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderTop="1px solid rgba(0,0,0,.54)"):(this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderTop="0px"),"Cell"==this.ulelementShading.value||"Table"===this.ulelementShading.value?i?this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"):i?(this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderBottom="1px solid rgba(0,0,0,.54)"):(this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderBottom="0px"),"Cell"==this.ulelementShading.value||"Table"===this.ulelementShading.value?n?this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"):n?(this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderLeft="1px solid rgba(0,0,0,.54)"):(this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderLeft="0px"),"Cell"==this.ulelementShading.value||"Table"===this.ulelementShading.value?r?this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"):r?(this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderRight="1px solid rgba(0,0,0,.54)"):(this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderRight="0px"),s?this.previewDivBottomcenter.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),o?this.previewDivTopCenter.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click")):("Cell"!==this.ulelementShading.value&&"Table"!==this.ulelementShading.value&&this.setSettingPreviewDivElement("none"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")))},ig.prototype.getLineStyle=function(e){switch(e){case"Single":return 0;case"Dot":return 1;case"DashSmallGap":return 2;case"DashLargeGap":return 3;case"DashDot":return 4;case"DashDotDot":return 5;case"Double":return 6;case"Triple":return 7;case"ThinThickSmallGap":return 8;case"ThickThinSmallGap":return 9;case"ThinThickThinSmallGap":return 10;case"ThinThickMediumGap":return 11;case"ThickThinMediumGap":return 12;case"ThinThickThinMediumGap":return 13;case"ThinThickLargeGap":return 14;case"ThickThinLargeGap":return 15;case"ThinThickThinLargeGap":return 16;case"SingleWavy":return 17;case"DoubleWavy":return 18;case"DashDotStroked":return 29;case"Emboss3D":return 20;case"Engrave3D":return 21;case"Outset":return 22;case"Inset":return 23}return 0},ig.prototype.destroy=function(){if(!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.cellFormat&&(this.cellFormat.destroy(),this.cellFormat=void 0),this.tableFormat&&(this.tableFormat.destroy(),this.tableFormat=void 0),this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.dialog=void 0,this.target=void 0,_.isNullOrUndefined(this.borderStyle)||this.borderStyle.destroy(),this.borderStyle=void 0,_.isNullOrUndefined(this.borderColorPicker)||this.borderColorPicker.destroy(),this.borderColorPicker=void 0,_.isNullOrUndefined(this.shadingColorPicker)||this.shadingColorPicker.destroy(),this.shadingColorPicker=void 0,_.isNullOrUndefined(this.ulelementShading)||this.ulelementShading.destroy(),this.ulelementShading=void 0,this.noneDivTransparent=void 0,this.boxDivTransparent=void 0,this.allDivTransparent=void 0,this.customDivTransparent=void 0,this.previewDiv=void 0,this.previewRightDiagonalDiv=void 0,this.previewLeftDiagonalDiv=void 0,this.previewVerticalDiv=void 0,this.previewHorizontalDiv=void 0,this.previewDivTopTopContainer=void 0,this.previewDivTopTop=void 0,this.previewDivTopCenterContainer=void 0,this.previewDivTopCenter=void 0,this.previewDivTopBottomContainer=void 0,this.previewDivTopBottom=void 0,this.previewDivLeftDiagonalContainer=void 0,this.previewDivLeftDiagonal=void 0,this.previewDivBottomLeftContainer=void 0,this.previewDivBottomLeft=void 0,this.previewDivBottomcenterContainer=void 0,this.previewDivBottomcenter=void 0,this.previewDivBottomRightContainer=void 0,this.previewDivBottomRight=void 0,this.previewDivDiagonalRightContainer=void 0,this.previewDivDiagonalRight=void 0,this.previewDivTopTopTransParent=void 0,this.previewDivTopCenterTransParent=void 0,this.previewDivTopBottomTransParent=void 0,this.previewDivLeftDiagonalTransParent=void 0,this.previewDivBottomLeftTransparent=void 0,this.previewDivBottomcenterTransparent=void 0,this.previewDivBottomRightTransparent=void 0,this.previewDivDiagonalRightTransparent=void 0,this.shadingContiner=void 0,this.noneDiv=void 0,this.customDiv=void 0,this.allDiv=void 0,this.boxDiv=void 0,this.documentHelper=void 0};var tg=ig;function ig(e){var u=this;this.cellFormat=new Tl,this.tableFormat=new Fl,this.isShadingChanged=!1,this.applyBordersShadingsProperties=function(){var e=u.documentHelper.owner.tablePropertiesDialogModule,t=u.documentHelper.selection.start.paragraph.associatedCell,i=void 0,n=((u.checkClassName(u.previewDivTopTop)||u.checkClassName(u.previewDivTopBottom)||u.checkClassName(u.previewDivTopCenter)||u.checkClassName(u.previewDivBottomcenter)||u.checkClassName(u.previewDivBottomLeft)||u.checkClassName(u.previewDivBottomRight)||u.checkClassName(u.previewDivDiagonalRight)||u.checkClassName(u.previewDivLeftDiagonal))&&(i=new qa,u.checkClassName(u.previewDivTopTop)&&(i.top=u.getBorder("top")),u.checkClassName(u.previewDivTopBottom)&&(i.bottom=u.getBorder("bottom")),u.checkClassName(u.previewDivBottomLeft)&&(i.left=u.getBorder("left")),u.checkClassName(u.previewDivBottomRight)&&(i.right=u.getBorder("right")),u.checkClassName(u.previewDivTopCenter)&&(i.horizontal=u.getBorder("horizontal")),u.checkClassName(u.previewDivBottomcenter)&&(i.vertical=u.getBorder("vertical")),u.checkClassName(u.previewDivLeftDiagonal)&&(i.diagonalDown=u.getBorder("diagonalDown")),u.checkClassName(u.previewDivDiagonalRight))&&(i.diagonalUp=u.getBorder("diagonalUp")),new Il),r=u.documentHelper.owner.editorModule;if(n.backgroundColor=u.shadingColorPicker.value,"Cell"===u.ulelementShading.value)e&&(e.isCellBordersAndShadingUpdated=!0),u.cellFormat.borders=new qa,_.isNullOrUndefined(i)?u.noneDiv.classList.contains("e-de-table-border-inside-setting-click")&&r.applyBordersInternal(u.cellFormat.borders,new qa):r.applyBordersInternal(u.cellFormat.borders,i),_.isNullOrUndefined(t.cellFormat.shading)||(n.foregroundColor=t.cellFormat.shading.foregroundColor,n.textureStyle=t.cellFormat.shading.textureStyle),u.cellFormat.shading=new Il,r.applyShading(u.cellFormat.shading,n);else if("Table"===u.ulelementShading.value){e&&(e.isTableBordersAndShadingUpdated=!0);t=u.documentHelper.owner.selectionModule.tableFormat.table.tableFormat;if(u.tableFormat.copyFormat(t),u.tableFormat.borders=new qa,!_.isNullOrUndefined(i)||u.noneDiv.classList.contains("e-de-table-border-inside-setting-click"))for(var o=u.documentHelper.owner.selectionModule.tableFormat.table,s=0,a=o.childWidgets;s<a.length;s++){var l=a[s],d=(u.updateBorder(o.tableFormat.borders.left,l.rowFormat.borders.left),u.updateBorder(o.tableFormat.borders.top,l.rowFormat.borders.top),u.updateBorder(o.tableFormat.borders.right,l.rowFormat.borders.right),u.updateBorder(o.tableFormat.borders.bottom,l.rowFormat.borders.bottom),l.rowFormat.borders.horizontal),h=o.tableFormat.borders.horizontal,h=(("Single"===d.lineStyle&&"None"===h.lineStyle||"Cleared"===d.lineStyle&&"Cleared"===h.lineStyle)&&(h.lineStyle="Single",h.lineWidth=d.lineWidth),l.rowFormat.borders.vertical),d=o.tableFormat.borders.vertical;("Single"===h.lineStyle&&"None"===d.lineStyle||"Cleared"===h.lineStyle&&"Cleared"===d.lineStyle)&&(d.lineStyle="Single",d.lineWidth=h.lineWidth),l.rowFormat.borders.clearFormat();for(var c=0,p=l.childWidgets;c<p.length;c++)p[c].cellFormat.borders.clearFormat()}_.isNullOrUndefined(i)?u.noneDiv.classList.contains("e-de-table-border-inside-setting-click")&&r.applyBordersInternal(u.tableFormat.borders,new qa):r.applyBordersInternal(u.tableFormat.borders,i),_.isNullOrUndefined(t.shading)||(n.foregroundColor=t.shading.foregroundColor,n.textureStyle=t.shading.textureStyle),u.tableFormat.shading=new Il,u.isShadingChanged=t.shading.backgroundColor!==n.backgroundColor,r.applyShading(u.tableFormat.shading,n)}else"Paragraph"===u.ulelementShading.value&&(e=u.noneDiv.classList.contains("e-de-table-border-inside-setting-click"),_.isNullOrUndefined(u.paragraphFormat)?r.onApplyParagraphFormat("borders",e?new qa:i,!1,!1):r.applyBordersInternal(u.paragraphFormat.borders,e?new qa:i));u.applyFormat(),u.closeDialog()},this.closeDialog=function(){u.documentHelper.dialog.hide(),u.closeBordersShadingsDialog()},this.closeBordersShadingsDialog=function(){u.paragraphFormat=void 0,u.documentHelper.dialog2.element.style.pointerEvents="",u.documentHelper.updateFocus()},this.handleSettingCheckBoxAction=function(e){var e=e.target.id,t=u.target.id;e===t+"_None_Div"||e===t+"_None_Div_Container"||e===t+"_None_Div_Transparent"?(u.updateClassForSettingDivElements(),u.noneDiv.classList.add("e-de-table-border-inside-setting-click"),u.setSettingPreviewDivElement("none")):e===t+"_Box_Div"||e===t+"_Box_Div_Container"||e===t+"_Box_Div_Transparent"?(u.updateClassForSettingDivElements(),u.boxDiv.classList.add("e-de-table-border-inside-setting-click"),u.setSettingPreviewDivElement("box")):e===t+"_All_Div"||e===t+"_All_Div_Container"||e===t+"_All_Div_Transparent"?(u.updateClassForSettingDivElements(),u.allDiv.classList.add("e-de-table-border-inside-setting-click"),u.setSettingPreviewDivElement("all")):(u.ulelementShading.value,u.updateClassForSettingDivElements(),u.customDiv.classList.add("e-de-table-border-inside-setting-click"),u.setSettingPreviewDivElement("customDiv"))},this.handlePreviewCheckBoxAction=function(e){var e=e.target.id,t=u.target.id,i="e-de-table-border-inside-preview-click";u.customDiv.click(),e===t+"_Preview_Div_TopTop_Container"||e===t+"_Preview_Div_TopTop"||e===t+"_previewDivTopTopTransParent"?(u.handlePreviewCheckBoxShowHide(t,i,u.previewDivTopTop),u.showHidePreviewDivElements(t,i,"_Preview_Div","_Preview_Div_TopTop","TopTop")):e===t+"_Preview_Div_TopCenter_Container"||e===t+"_Preview_Div_TopCenter"||e===t+"_previewDivTopCenterTransParent"?(u.handlePreviewCheckBoxShowHide(t,i,u.previewDivTopCenter),u.showHidePreviewDivElements(t,i,"_Preview_Div_Horizontal","_Preview_Div_TopCenter","TopCenter")):e===t+"_Preview_Div_TopBottom_Container"||e===t+"_Preview_Div_TopBottom"||e===t+"_previewDivTopBottomTransParent"?(u.handlePreviewCheckBoxShowHide(t,i,u.previewDivTopBottom),u.showHidePreviewDivElements(t,i,"_Preview_Div","_Preview_Div_TopBottom","TopBottom")):e===t+"_Preview_Div_LeftDiagonal_Container"||e===t+"_Preview_Div_LeftDiagonal"||e===t+"_previewDivLeftDiagonalTransParent"?(u.handlePreviewCheckBoxShowHide(t,i,u.previewDivLeftDiagonal),u.showHidePreviewDivElements(t,i,"_Preview_Div_Left_Diagonal","_Preview_Div_LeftDiagonal","LeftDiagonal")):e===t+"_Preview_Div_BottomLeft_Container"||e===t+"_Preview_Div_BottomLeft"||e===t+"_previewDivBottomLeftTransparent"?(u.handlePreviewCheckBoxShowHide(t,i,u.previewDivBottomLeft),u.showHidePreviewDivElements(t,i,"_Preview_Div","_Preview_Div_BottomLeft","BottomLeft")):e===t+"_Preview_Div_BottomCenter_Container"||e===t+"_Preview_Div_BottomCenter"||e===t+"_previewDivBottomcenterTransparent"?(u.handlePreviewCheckBoxShowHide(t,i,u.previewDivBottomcenter),u.showHidePreviewDivElements(t,i,"_Preview_Div_Vertical","_Preview_Div_BottomCenter","BottomCenter")):e===t+"_Preview_Div_BottomRight_Container"||e===t+"_Preview_Div_BottomRight"||e===t+"_previewDivBottomRightTransparent"?(u.handlePreviewCheckBoxShowHide(t,i,u.previewDivBottomRight),u.showHidePreviewDivElements(t,i,"_Preview_Div","_Preview_Div_BottomRight","BottomRight")):e!==t+"_Preview_Div_RightDiagonal_Container"&&e!==t+"_Preview_Div_RightDiagonal"&&e!==t+"_previewDivDiagonalRightTransparent"||(u.handlePreviewCheckBoxShowHide(t,i,u.previewDivDiagonalRight),u.showHidePreviewDivElements(t,i,"_Preview_Div_Right_Diagonal","_Preview_Div_RightDiagonal","RightDiagonal"))},this.applyTableCellPreviewBoxes=function(){_.isNullOrUndefined(u.ulelementShading)||("Cell"===u.ulelementShading.value?(u.shadingColorPicker.disabled=!1,u.previewDivBottomcenterContainer.style.visibility="hidden",u.previewDivTopCenterContainer.style.visibility="hidden",u.previewVerticalDiv.style.display="none",u.previewHorizontalDiv.style.display="none",u.previewDivLeftDiagonal.style.display="",u.previewDivDiagonalRight.style.display="",u.previewDivBottomRightContainer.style.left="80px",_.classList(u.noneDivTransparent,["e-de-table-border-none-setting"],["e-de-para-border-none-setting"]),_.classList(u.boxDivTransparent,["e-de-table-border-box-setting"],["e-de-para-border-box-setting"]),_.classList(u.allDivTransparent,["e-de-table-border-all-setting"],["e-de-para-border-shadow-setting"]),_.classList(u.customDivTransparent,["e-de-table-border-custom-setting"],["e-de-para-border-custom-setting"])):"Table"===u.ulelementShading.value?(u.shadingColorPicker.disabled=!1,u.previewDivLeftDiagonal.style.display="none",u.previewDivDiagonalRight.style.display="none",u.previewDivBottomcenterContainer.style.visibility="visible",u.previewDivTopCenterContainer.style.visibility="visible",u.previewVerticalDiv.style.display="",u.previewHorizontalDiv.style.display="",u.previewDivBottomRightContainer.style.left="110px",_.classList(u.noneDivTransparent,["e-de-table-border-none-setting"],["e-de-para-border-none-setting"]),_.classList(u.boxDivTransparent,["e-de-table-border-box-setting"],["e-de-para-border-box-setting"]),_.classList(u.allDivTransparent,["e-de-table-border-all-setting"],["e-de-para-border-shadow-setting"]),_.classList(u.customDivTransparent,["e-de-table-border-custom-setting"],["e-de-para-border-custom-setting"])):(u.shadingColorPicker.disabled=!0,u.previewDivBottomcenterContainer.style.visibility="hidden",u.previewDivTopCenterContainer.style.visibility="hidden",u.previewVerticalDiv.style.display="none",u.previewHorizontalDiv.style.display="none",u.previewLeftDiagonalDiv.style.display="none",u.previewRightDiagonalDiv.style.display="none",_.classList(u.noneDivTransparent,["e-de-para-border-none-setting"],["e-de-table-border-none-setting"]),_.classList(u.boxDivTransparent,["e-de-para-border-box-setting"],["e-de-table-border-box-setting"]),_.classList(u.allDivTransparent,["e-de-para-border-shadow-setting"],["e-de-table-border-all-setting"]),_.classList(u.customDivTransparent,["e-de-para-border-custom-setting"],["e-de-table-border-custom-setting"])))},this.applyPreviewTableBackgroundColor=function(e){_.isNullOrUndefined(e.currentValue)||(e=e.currentValue.hex,u.previewDiv.style.backgroundColor=e)},this.applyPreviewTableBorderColor=function(e){_.isNullOrUndefined(e.currentValue)||(e=e.currentValue.hex,u.previewDiv.style.borderColor=e,u.previewRightDiagonalDiv.style.backgroundColor=e,u.previewLeftDiagonalDiv.style.backgroundColor=e,u.previewVerticalDiv.style.backgroundColor=e,u.previewHorizontalDiv.style.backgroundColor=e)},this.documentHelper=e}Object.defineProperty(rg.prototype,"tableFormat",{get:function(){return _.isNullOrUndefined(this.tableFormatIn)?this.tableFormatIn=new Fl:this.tableFormatIn},enumerable:!0,configurable:!0}),rg.prototype.getModuleName=function(){return"TableOptionsDialog"},rg.prototype.initTableOptionsDialog=function(e,t){this.target=_.createElement("div",{id:this.documentHelper.owner.containerId+"_insertCellMarginsDialog",className:"e-de-table-options-dlg"});var i=_.createElement("div"),n=_.createElement("Label",{id:this.target.id+"_innerDivLabel",className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Default cell margins")}),n=(i.appendChild(n),og.getCellMarginDialogElements(this,i,e,!1),_.createElement("div")),i=_.createElement("Label",{className:"e-de-para-dlg-heading",id:this.target.id+"_cellSpaceLabel"}),i=(i.innerHTML=e.getConstant("Default cell spacing"),n.appendChild(i),_.createElement("TABLE",{styles:"height: 30px;"})),r=_.createElement("tr"),o=_.createElement("td"),s=_.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_cellcheck"}),a=t?"padding-right:25px;":"padding-left:25px;",a=_.createElement("td",{styles:a}),o=(this.cellspacingTextBox=_.createElement("input",{attrs:{type:"text"},id:this.target.id+"_cellspacing"}),o.appendChild(s),a.appendChild(this.cellspacingTextBox),r.appendChild(o),r.appendChild(a),i.appendChild(r),n.appendChild(i),document.createElement("div"));this.target.appendChild(n),this.target.appendChild(o),this.cellSpaceTextBox=new D.NumericTextBox({value:0,min:0,max:264.5,width:174,decimals:2,enablePersistence:!1}),this.cellSpaceTextBox.appendTo(this.cellspacingTextBox),this.allowSpaceCheckBox=new H.CheckBox({label:e.getConstant("Allow spacing between cells"),change:this.changeAllowSpaceCheckBox,enableRtl:t,cssClass:"e-de-tbl-margin-sub-header"}),this.allowSpaceCheckBox.appendTo(s),s.setAttribute("aria-label",e.getConstant("Allow spacing between cells")),this.cellspacingTextBox.setAttribute("aria-label","cell spacing")},rg.prototype.loadCellMarginsDialog=function(){var e=this.documentHelper.selection.tableFormat;this.cellSpaceTextBox.value=e.cellSpacing,this.bottomMarginBox.value=e.bottomMargin,this.topMarginBox.value=e.topMargin,this.rightMarginBox.value=e.rightMargin,this.leftMarginBox.value=e.leftMargin,0<e.cellSpacing?(this.allowSpaceCheckBox.checked=!0,this.cellSpaceTextBox.enabled=!0):(this.allowSpaceCheckBox.checked=!1,this.cellSpaceTextBox.enabled=!1)},rg.prototype.applySubTableOptions=function(e,t){this.documentHelper.owner.editorHistoryModule.initComplexHistory(this.documentHelper.selection,"TableMarginsSelection"),this.applyTableOptionsHistory(e,t),_.isNullOrUndefined(this.documentHelper.owner.editorHistoryModule.currentHistoryInfo)||this.documentHelper.owner.editorHistoryModule.updateComplexHistory()},rg.prototype.applyTableOptionsHelper=function(e){this.applySubTableOptionsHelper(e,void 0)},rg.prototype.applyTableOptionsHistory=function(e,t){this.documentHelper.owner.editorModule.initHistory("TableOptions"),this.applySubTableOptionsHelper(e,t)},rg.prototype.applySubTableOptionsHelper=function(e,t){var i=(t=_.isNullOrUndefined(t)?(t=this.documentHelper.selection.start.currentWidget.paragraph.associatedCell.ownerTable).combineWidget(this.documentHelper.owner.viewer):t).tableFormat;_.isNullOrUndefined(this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo)||this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.addModifiedTableOptions(i),i.cellSpacing=e.cellSpacing,i.leftMargin=e.leftMargin,i.topMargin=e.topMargin,i.rightMargin=e.rightMargin,i.bottomMargin=e.bottomMargin,this.documentHelper.owner.tablePropertiesDialogModule.calculateGridValue(t)},rg.prototype.applyTableOptions=function(e){e.leftMargin=this.leftMarginBox.value,e.topMargin=this.topMarginBox.value,e.bottomMargin=this.bottomMarginBox.value,e.rightMargin=this.rightMarginBox.value,e.cellSpacing=this.cellSpaceTextBox.value},rg.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initTableOptionsDialog(e,this.documentHelper.owner.enableRtl),this.loadCellMarginsDialog(),this.documentHelper.dialog.header=e.getConstant("Table Options"),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=void 0,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.open=void 0,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.removeEvents,this.documentHelper.dialog.buttons=[{click:this.applyTableCellProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-okay",isPrimary:!0}},{click:this.closeCellMarginsDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},rg.prototype.destroy=function(){if(!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.tableFormatIn&&(this.tableFormatIn.destroy(),this.tableFormatIn=void 0),this.dialog=void 0,this.target=void 0,this.documentHelper=void 0,this.cellspacingTextBox=void 0,this.allowSpaceCheckBox=void 0};var ng=rg;function rg(e){var t=this;this.applyTableCellProperties=function(){var e=t.documentHelper.selection.tableFormat;_.isNullOrUndefined(t.bottomMarginBox.value||t.leftMarginBox.value||t.rightMarginBox.value||t.topMarginBox.value||t.cellSpaceTextBox.value)||e.bottomMargin===t.bottomMarginBox.value&&e.leftMargin===t.leftMarginBox.value&&e.rightMargin===t.rightMarginBox.value&&e.topMargin===t.topMarginBox.value&&e.cellSpacing===t.cellSpaceTextBox.value||(t.documentHelper.owner.tablePropertiesDialogModule.isTableOptionsUpdated=!0,t.applyTableOptions(t.tableFormat),t.documentHelper.owner.tablePropertiesDialogModule.applyTableSubProperties()),t.closeCellMarginsDialog()},this.closeCellMarginsDialog=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.changeAllowSpaceCheckBox=function(){t.allowSpaceCheckBox.checked?t.cellSpaceTextBox.enabled=!0:(t.cellSpaceTextBox.enabled=!1,t.cellSpaceTextBox.value=0)},this.removeEvents=function(){t.documentHelper.dialog2.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.documentHelper=e}Object.defineProperty(sg.prototype,"cellFormat",{get:function(){return _.isNullOrUndefined(this.cellFormatIn)?this.cellFormatIn=new Tl:this.cellFormatIn},enumerable:!0,configurable:!0}),sg.prototype.getModuleName=function(){return"CellOptionsDialog"},sg.prototype.initCellMarginsDialog=function(e,t){this.owner=this.documentHelper.owner.viewer,this.target=_.createElement("div",{className:"e-de-table-cell-margin-dlg"});var i=_.createElement("div"),n=_.createElement("Label",{className:"e-de-para-dlg-heading"}),n=(n.innerHTML=e.getConstant("Cell margins"),i.appendChild(n),_.createElement("TABLE",{styles:"padding-bottom: 8px;padding-top: 8px;",className:"e-de-cell-margin-top"})),r=_.createElement("tr"),o=_.createElement("td",{className:"e-de-tbl-btn-separator"}),s=_.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_sameAsCheckBox"}),o=(s.setAttribute("aria-label",e.getConstant("Same as the whole table")),o.appendChild(s),r.appendChild(o),n.appendChild(r),i.appendChild(n),sg.getCellMarginDialogElements(this,i,e,!0),document.createElement("div"));this.target.appendChild(o),this.sameAsTableCheckBox=new H.CheckBox({label:e.getConstant("Same as the whole table"),change:this.changeSameAsTable,enableRtl:t}),s.setAttribute("aria-label",e.getConstant("Same as the whole table")),this.sameAsTableCheckBox.appendTo(s),this.sameAsTableCheckBox.addEventListener("change",this.changeSameAsTable)},sg.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initCellMarginsDialog(e,this.documentHelper.owner.enableRtl),this.loadCellMarginsDialog(),this.documentHelper.dialog.header=e.getConstant("Cell Options"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=void 0,this.documentHelper.dialog.open=void 0,this.documentHelper.dialog.close=this.removeEvents,this.documentHelper.dialog.buttons=[{click:this.applyTableCellProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.closeCellMarginsDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},sg.prototype.loadCellMarginsDialog=function(){var e,t=this.documentHelper.selection.cellFormat;this.sameAsTable=_.isNullOrUndefined(t.leftMargin||t.topMargin||t.rightMargin||t.bottomMargin),this.sameAsTable?(e=this.documentHelper.selection.tableFormat,this.loadCellProperties(e,!1,!0)):this.loadCellProperties(t,!0,!1)},sg.prototype.loadCellProperties=function(e,t,i){this.leftMarginBox.value=e.leftMargin,this.rightMarginBox.value=e.rightMargin,this.topMarginBox.value=e.topMargin,this.bottomMarginBox.value=e.bottomMargin,this.leftMarginBox.enabled=t,this.rightMarginBox.enabled=t,this.topMarginBox.enabled=t,this.bottomMarginBox.enabled=t,this.sameAsTableCheckBox.checked=i},sg.prototype.applySubCellOptions=function(e){this.documentHelper.owner.editorHistoryModule.initComplexHistory(this.documentHelper.selection,"CellMarginsSelection"),this.documentHelper.owner.editorModule.initHistory("CellOptions"),_.isNullOrUndefined(this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo)||(this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.insertedFormat=e),this.documentHelper.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner),this.applyCellMarginValue(this.documentHelper.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.owner),this.documentHelper.selection.start,this.documentHelper.selection.end,e),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection,!1),_.isNullOrUndefined(this.documentHelper.owner.editorHistoryModule.currentHistoryInfo)||this.documentHelper.owner.editorHistoryModule.updateComplexHistory()},sg.prototype.applyCellMarginValue=function(e,t,i,n){this.applyCellMarginsInternal(e,n),i.paragraph.associatedCell.ownerRow===e||(e=e.nextWidget,_.isNullOrUndefined(e))||this.applyCellMarginValue(e,t,i,n)},sg.prototype.applyCellMarginsInternal=function(e,t){var i;_.isNullOrUndefined(this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo)||(i=e.childWidgets[0].cellFormat,t=this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.addModifiedCellOptions(i,t,e.ownerTable)),_.isNullOrUndefined(t)||this.applyCellMarginsForCells(e,t)},sg.prototype.applyCellMarginsForCells=function(e,t){e=e.childWidgets;this.iterateCells(e,t)},sg.prototype.iterateCells=function(e,t){for(var i=0;i<e.length;i++)this.applySubCellMargins(e[parseInt(i.toString(),10)].cellFormat,t);this.documentHelper.owner.tablePropertiesDialogModule.calculateGridValue(e[0].ownerTable)},sg.prototype.applySubCellMargins=function(e,t){e.leftMargin=t.leftMargin,e.topMargin=t.topMargin,e.rightMargin=t.rightMargin,e.bottomMargin=t.bottomMargin},sg.prototype.applyTableOptions=function(e){this.sameAsTableCheckBox.checked||(e.leftMargin=this.leftMarginBox.value,e.topMargin=this.topMarginBox.value,e.bottomMargin=this.bottomMarginBox.value,e.rightMargin=this.rightMarginBox.value)},sg.prototype.destroy=function(){if(!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}this.dialog=void 0,this.target=void 0,this.documentHelper=void 0,this.sameAsTableCheckBox=void 0},sg.getCellMarginDialogElements=function(e,t,i,n){var r,o,s,a,l,d,h,c;_.isNullOrUndefined(e)||(r=_.createElement("div"),o=_.createElement("div",{className:"e-de-container-row"}),l=_.createElement("div",{className:"e-de-subcontainer-left"}),s=_.createElement("input",{attrs:{type:"text"},styles:"width:100%"}),l.appendChild(s),d=_.createElement("div",{className:"e-de-subcontainer-right"}),a=_.createElement("input",{attrs:{type:"text"},styles:"width:100%"}),d.appendChild(a),o.appendChild(l),o.appendChild(d),l=_.createElement("div",{className:n?"e-de-dlg-row":"e-de-container-row"}),d=_.createElement("div",{className:"e-de-subcontainer-left"}),n=_.createElement("input",{attrs:{type:"text"},styles:"width:100%"}),d.appendChild(n),h=_.createElement("div",{className:"e-de-subcontainer-right"}),c=_.createElement("input",{attrs:{type:"text"},styles:"width:100%"}),h.appendChild(c),l.appendChild(d),l.appendChild(h),r.appendChild(o),r.appendChild(l),t.appendChild(r),e.target.appendChild(t),e.topMarginBox=new D.NumericTextBox({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:i.getConstant("Top"),floatLabelType:"Always"}),e.topMarginBox.appendTo(s),e.leftMarginBox=new D.NumericTextBox({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:i.getConstant("Left"),floatLabelType:"Always"}),e.leftMarginBox.appendTo(a),e.bottomMarginBox=new D.NumericTextBox({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:i.getConstant("Bottom"),floatLabelType:"Always"}),e.bottomMarginBox.appendTo(n),e.rightMarginBox=new D.NumericTextBox({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:i.getConstant("Right"),floatLabelType:"Always"}),e.rightMarginBox.appendTo(c),c.setAttribute("aria-labelledby",i.getConstant("Right")),a.setAttribute("aria-labelledby",i.getConstant("Left")),n.setAttribute("aria-labelledby",i.getConstant("Bottom")),s.setAttribute("aria-labelledby",i.getConstant("Top")))};var og=sg;function sg(e){var t=this;this.removeEvents=function(){t.documentHelper.dialog2.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.changeSameAsTable=function(){t.sameAsTableCheckBox.checked?(t.leftMarginBox.enabled=!1,t.rightMarginBox.enabled=!1,t.bottomMarginBox.enabled=!1,t.topMarginBox.enabled=!1):(t.leftMarginBox.enabled=!0,t.rightMarginBox.enabled=!0,t.bottomMarginBox.enabled=!0,t.topMarginBox.enabled=!0)},this.applyTableCellProperties=function(){var e=t.documentHelper.selection.cellFormat;_.isNullOrUndefined(t.bottomMarginBox.value||t.leftMarginBox.value||t.rightMarginBox.value||t.topMarginBox.value)||e.bottomMargin===t.bottomMarginBox.value&&e.leftMargin===t.leftMarginBox.value&&e.rightMargin===t.rightMarginBox.value&&e.topMargin===t.topMarginBox.value||(t.documentHelper.owner.tablePropertiesDialogModule.isCellOptionsUpdated=!0,t.applyTableOptions(t.cellFormat),t.documentHelper.owner.tablePropertiesDialogModule.applyTableSubProperties()),t.closeCellMarginsDialog()},this.closeCellMarginsDialog=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.documentHelper=e}lg.prototype.getModuleName=function(){return"StylesDialog"},lg.prototype.initStylesDialog=function(e,t,i){var n=this.documentHelper.owner.containerId+"_insert_styles",n=(this.target=_.createElement("div",{id:n,className:"e-de-styles"}),e.getConstant("Styles")),n=_.createElement("div",{innerHTML:n,className:"e-de-para-dlg-heading"}),n=(this.target.appendChild(n),_.createElement("div",{className:"e-styles-common"})),r=(this.target.appendChild(n),_.createElement("div",{className:"e-styles-list"})),i=(n.appendChild(r),i&&r.classList.add("e-de-rtl"),_.createElement("div",{className:"e-styles-listViewDiv",id:"styles_listview"})),r=(r.appendChild(i),this.listviewInstance=new F.ListView({dataSource:t,cssClass:"e-styles-listview",fields:{text:"StyleName",iconCss:"IconClass"},showIcon:!0}),this.listviewInstance.appendTo(i),this.listviewInstance.addEventListener("select",this.selectHandler),_.createElement("div",{className:"e-styles-button"})),t=(n.appendChild(r),_.createElement("div",{className:"e-styles-addbutton"})),i=(r.appendChild(t),_.createElement("button",{innerHTML:e.getConstant("New")+"...",id:"new",attrs:{type:"button"}}));t.appendChild(i);new H.Button({cssClass:"e-button-custom"}).appendTo(i),i.addEventListener("click",this.addNewStyles);n=_.createElement("div",{className:"e-styles-addbutton"}),r.appendChild(n),t=_.createElement("button",{innerHTML:e.getConstant("Modify")+"...",id:"modify",attrs:{type:"button"}});n.appendChild(t),new H.Button({cssClass:"e-button-custom"}).appendTo(t),t.addEventListener("click",this.modifyStyles)},lg.prototype.show=function(){for(var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),t=(e.setLocale(this.documentHelper.owner.locale),this.updateStyleNames("Paragraph").filter(function(e){return"Paragraph"===e.Type})),i=this.updateStyleNames("Paragraph").filter(function(e){return"Linked"===e.Type}),n=this.updateStyleNames("Character").filter(function(e){return"Character"===e.Type}),r=0,o=i;r<o.length;r++)for(var s=o[r],a=0,l=n;a<l.length;a++){var d=l[a];if(s.StyleName+" Char"===d.StyleName){n.splice(n.indexOf(d),1);break}}t=t.concat(i,n);this.localValue=e,this.initStylesDialog(e,t,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.header=e.getConstant("Styles"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.buttons=[{click:this.hideObjects.bind(this),buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},lg.prototype.updateStyleNames=function(e){for(var t=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),i=(t.setLocale(this.documentHelper.owner.locale),this.documentHelper.owner.documentHelper.styles.getStyles(e)),n=[],r=0;r<i.length;r++){var o=t.getConstant(i[parseInt(r.toString(),10)].name);""===o&&(o=i[parseInt(r.toString(),10)].name),"Paragraph"===i[parseInt(r.toString(),10)].type?n.push({StyleName:o,IconClass:"e-de-listview-icon e-de-e-paragraph-style-mark e-icons",Type:i[parseInt(r.toString(),10)].type}):"Character"===i[parseInt(r.toString(),10)].type?n.push({StyleName:o,IconClass:"e-de-listview-icon e-de-e-character-style-mark e-icons",Type:i[parseInt(r.toString(),10)].type}):n.push({StyleName:o,IconClass:"e-de-listview-icon e-de-e-linked-style-mark e-icons",Type:i[parseInt(r.toString(),10)].type})}return n},lg.prototype.defaultStyleName=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[parseInt(i.toString(),10)]);return t},lg.prototype.getStyleName=function(e){var t=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);return t.setLocale(this.documentHelper.owner.locale),t.getConstant("Heading 1")===e?e="Heading 1":t.getConstant("Heading 2")===e?e="Heading 2":t.getConstant("Heading 3")===e?e="Heading 3":t.getConstant("Heading 4")===e?e="Heading 4":t.getConstant("Heading 5")===e?e="Heading 5":t.getConstant("Heading 6")===e?e="Heading 6":t.getConstant("Normal")===e?e="Normal":t.getConstant("Header")===e?e="Header":t.getConstant("Footer")===e&&(e="Footer"),e},lg.prototype.hideObjects=function(){this.documentHelper.dialog.hide(),this.documentHelper.updateFocus()},lg.prototype.destroy=function(){this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.documentHelper=void 0,this.styleName=void 0,this.localValue=void 0,this.target=void 0};var ag=lg;function lg(e){var t=this;this.modifyStyles=function(){t.documentHelper.dialog.hide(),t.documentHelper.owner.styleDialogModule.show(t.styleName,t.localValue.getConstant("Modify Style"))},this.selectHandler=function(e){t.styleName=t.getStyleName(e.text)},this.addNewStyles=function(){t.documentHelper.dialog.hide(),t.documentHelper.owner.styleDialogModule.show()},this.documentHelper=e}Object.defineProperty(hg.prototype,"parent",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),hg.prototype.getModuleName=function(){return"SpellCheckDialog"},hg.prototype.removeErrors=function(){var e;!_.isNullOrUndefined(this.errorText)&&this.parent.spellCheckerModule.errorWordCollection.containsKey(this.errorText)&&((e=this.parent.spellCheckerModule.errorWordCollection.get(this.errorText)).splice(0,1),0===e.length)&&this.parent.spellCheckerModule.errorWordCollection.remove(this.errorText),0===this.parent.spellCheckerModule.errorWordCollection.length&&this.documentHelper.hideDialog()},hg.prototype.show=function(e,t){this.target=void 0,this.localValue=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localValue.setLocale(this.documentHelper.owner.locale),this.target||this.updateSuggestionDialog(e,t)},hg.prototype.updateSuggestionDialog=function(t,e){var i,n=this;this.elementBox=e,this.isSpellChecking?this.parent.spellCheckerModule.callSpellChecker(this.parent.spellCheckerModule.languageID,t,!1,!0).then(function(e){e=JSON.parse(e);i=e.Suggestions,_.isNullOrUndefined(n.parent)||(n.isSpellChecking=!1,n.handleRetrievedSuggestion(t,i))}):(t=this.parent.spellCheckerModule.manageSpecialCharacters(t,void 0,!0),i=this.parent.spellCheckerModule.errorSuggestions.containsKey(t)?this.parent.spellCheckerModule.errorSuggestions.get(t):[],this.handleRetrievedSuggestion(t,i))},hg.prototype.handleRetrievedSuggestion=function(e,t){e=this.parent.spellCheckerModule.manageSpecialCharacters(e,void 0,!0),this.initSpellCheckDialog(this.localValue,e,t),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog.header=this.localValue.getConstant("Spelling Editor"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.onCancelButtonClick,buttonModel:{content:this.localValue.getConstant("Cancel"),cssClass:"e-control e-flat",isPrimary:!0}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),C.hideSpinner(this.documentHelper.dialog.element)},hg.prototype.initSpellCheckDialog=function(e,t,i,n){var r=this.documentHelper.owner.containerId+"_add_SpellCheck",r=(this.target=_.createElement("div",{id:r,className:"e-de-insert-spellchecker"}),this.errorText=t,_.createElement("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Spelling")})),r=(this.target.appendChild(r),_.createElement("div",{className:"e-de-spellcheck-error-container"})),o=_.createElement("div",{className:"e-de-dlg-spellcheck-listview"}),t=(r.appendChild(o),this.spellingListView=new F.ListView({dataSource:[t],cssClass:"e-dlg-spellcheck-listitem"}),this.spellingListView.appendTo(o),_.createElement("div",{className:"e-de-spellcheck-btncontainer"})),o=(r.appendChild(t),_.createElement("button",{innerHTML:e.getConstant("Ignore")}));t.appendChild(o),o.setAttribute("aria-label",e.getConstant("Ignore"));new H.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}).appendTo(o),o.addEventListener("click",this.onIgnoreClicked);o=_.createElement("button",{innerHTML:e.getConstant("Ignore All")});o.setAttribute("aria-label",e.getConstant("Ignore All")),t.appendChild(o);new H.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}).appendTo(o),o.addEventListener("click",this.onIgnoreAllClicked);o=_.createElement("button",{innerHTML:e.getConstant("Add to Dictionary")});o.setAttribute("aria-label",e.getConstant("Add to Dictionary")),t.appendChild(o);new H.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}).appendTo(o),o.addEventListener("click",this.addToDictClicked),this.target.appendChild(r);t=_.createElement("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Suggestions")}),this.target.appendChild(t),o=_.createElement("div",{className:"e-de-spellcheck-suggestion-container"}),this.target.appendChild(o),r=_.createElement("div",{className:"e-de-dlg-spellcheck-listview"}),r.setAttribute("aria-label",e.getConstant("Suggestions")),o.appendChild(r),this.suggestionListView=new F.ListView({dataSource:i,cssClass:"e-dlg-spellcheck-listitem"}),this.suggestionListView.appendTo(r),this.suggestionListView.addEventListener("select",this.selectHandler),t=_.createElement("div",{className:"e-de-spellcheck-btncontainer"}),o.appendChild(t),r=_.createElement("button",{innerHTML:e.getConstant("Change")}),r.setAttribute("aria-label",e.getConstant("Change")),t.appendChild(r),o=new H.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}),o.appendTo(r),r.addEventListener("click",this.changeButtonClicked),r=_.createElement("button",{innerHTML:e.getConstant("Change All")}),r.setAttribute("aria-label",e.getConstant("Change All")),t.appendChild(r),e=new H.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"});e.appendTo(r),r.addEventListener("click",this.changeAllButtonClicked),!_.isNullOrUndefined(i)&&0!==i.length||(o.disabled=!0,e.disabled=!0)},hg.prototype.destroy=function(){this.target&&(this.target.remove(),this.target=void 0),this.elementBox&&(this.elementBox.destroy(),this.elementBox=void 0),this.documentHelper=void 0,this.spellingListView&&(this.spellingListView.destroy(),this.spellingListView=void 0),this.suggestionListView&&(this.suggestionListView.destroy(),this.suggestionListView=void 0),this.selectedText=void 0};var dg=hg;function hg(e){var a=this;this.selectHandler=function(e){a.selectedText=e.text},this.onCancelButtonClick=function(){a.documentHelper.clearSelectionHighlight(),a.documentHelper.hideDialog()},this.onIgnoreClicked=function(){_.isNullOrUndefined(a.elementBox)||(C.showSpinner(a.documentHelper.dialog.element),a.parent.spellCheckerModule.manageReplace("Ignore Once",a.elementBox),a.removeErrors(),a.parent.spellCheckerModule.checkForNextError(),C.hideSpinner(a.documentHelper.dialog.element))},this.onIgnoreAllClicked=function(){var e;_.isNullOrUndefined(a.elementBox)||(C.showSpinner(a.documentHelper.dialog.element),e=a.elementBox.text,a.parent.spellCheckerModule.handleIgnoreAllItems({element:a.elementBox,text:e}),a.parent.spellCheckerModule.checkForNextError(),C.hideSpinner(a.documentHelper.dialog.element))},this.addToDictClicked=function(){_.isNullOrUndefined(a.elementBox)||(C.showSpinner(a.documentHelper.dialog.element),a.parent.spellCheckerModule.handleAddToDictionary({element:a.elementBox,text:a.elementBox.text}),a.parent.spellCheckerModule.errorWordCollection.containsKey(a.errorText)&&a.parent.spellCheckerModule.errorWordCollection.remove(a.errorText),a.parent.spellCheckerModule.checkForNextError(),a.documentHelper.hideDialog())},this.changeButtonClicked=function(){_.isNullOrUndefined(a.selectedText)||(a.isSpellChecking=!0,C.showSpinner(a.documentHelper.dialog.element),a.parent.spellCheckerModule.manageReplace(a.selectedText,a.elementBox),a.removeErrors(),a.parent.spellCheckerModule.checkForNextError(),C.hideSpinner(a.documentHelper.dialog.element),a.selectedText=void 0)},this.changeAllButtonClicked=function(){if(!_.isNullOrUndefined(a.selectedText)){a.isSpellChecking=!0,a.parent.spellCheckerModule.isChangeAll=!0,C.showSpinner(a.documentHelper.dialog.element);for(var e=a.parent.spellCheckerModule.errorWordCollection.get(a.errorText),t=0;t<e.length;t++)if(e[t]instanceof Ah&&!e[t].ischangeDetected)a.parent.spellCheckerModule.manageReplace(a.selectedText,e[t]);else if(e[t]instanceof X){var i=a.parent.spellCheckerModule.getMatchedResultsFromElement(e[t]),n=i.textResults,r=e[t].ischangeDetected?e[t].start.offset:e[t].line.getOffset(e[t],0);a.parent.searchModule.textSearch.updateMatchedTextLocation(i.matches,n,i.elementInfo,0,e[t],!1,null,r);for(var o=0;o<n.length;o++){var s=a.parent.spellCheckerModule.createErrorElementWithInfo(n.innerList[o],e[t]);a.parent.spellCheckerModule.manageReplace(a.selectedText,s)}}a.parent.spellCheckerModule.errorWordCollection.containsKey(a.errorText)&&a.parent.spellCheckerModule.errorWordCollection.remove(a.errorText),a.parent.spellCheckerModule.checkForNextError(),a.documentHelper.hideDialog(),C.hideSpinner(a.documentHelper.dialog.element),a.parent.spellCheckerModule.isChangeAll=!1,a.selectedText=void 0}},this.documentHelper=e,C.createSpinner({target:this.documentHelper.dialog.element,cssClass:"e-spin-overlay"})}Object.defineProperty(pg.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),pg.prototype.getModuleName=function(){return"CheckBoxFormFieldDialog"},pg.prototype.initCheckBoxDialog=function(e,t){this.target=_.createElement("div");var i=_.createElement("div"),n=_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Check box size")}),r=_.createElement("div",{className:"e-de-container-row"}),o=_.createElement("div",{className:"e-de-ff-radio-scnd-div"}),s=_.createElement("div",{className:"e-de-ff-radio-scnd-div"}),a=_.createElement("input",{className:"e-de-rtl-btn-div",attrs:{"aria-label":e.getConstant("Auto")}}),l=_.createElement("input",{className:"e-de-rtl-btn-div",attrs:{"aria-label":e.getConstant("Exactly")}}),d=(this.autoButton=new H.RadioButton({label:e.getConstant("Auto"),cssClass:"e-small",change:this.changeBidirectional,checked:!0,enableRtl:t}),this.exactButton=new H.RadioButton({label:e.getConstant("Exactly"),value:"exact",cssClass:"e-small",change:this.changeBidirectional,enableRtl:t}),this.exactNumberDiv=_.createElement("div",{className:"e-de-ff-chck-exact"}),_.createElement("input",{attrs:{type:"text","aria-label":e.getConstant("Exactly")}})),h=(this.exactlyNumber=new D.NumericTextBox({format:"n",value:10,min:1,max:1584,enablePersistence:!1,enabled:!1,cssClass:"e-de-check-exactnumbr-width",enableRtl:t}),_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Default value")})),c=_.createElement("div",{className:"e-de-container-row"}),p=_.createElement("div",{className:"e-de-ff-radio-div"}),u=_.createElement("div",{className:"e-de-ff-radio-div"}),g=_.createElement("input",{className:"e-de-rtl-btn-div",attrs:{"aria-label":e.getConstant("Not checked")}}),m=_.createElement("input",{className:"e-de-rtl-btn-div",attrs:{"aria-label":e.getConstant("Checked")}}),f=(this.notCheckedButton=new H.RadioButton({label:e.getConstant("Not checked"),enableRtl:t,cssClass:"e-small",change:this.changeBidirect}),this.checkedButton=new H.RadioButton({label:e.getConstant("Checked"),value:"check",enableRtl:t,cssClass:"e-small",change:this.changeBidirect,checked:!0}),_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Field settings")})),y=_.createElement("div",{className:"e-de-container-row"}),v=_.createElement("div",{className:"e-de-subcontainer-left"}),w=_.createElement("div",{className:"e-de-subcontainer-right"}),b=(this.tooltipInputText=_.createElement("input",{className:"e-input e-bookmark-textbox-input",attrs:{"aira-label":e.getConstant("Tooltip")}}),this.bookmarkInputText=_.createElement("input",{className:"e-input e-bookmark-textbox-input",attrs:{"aira-label":e.getConstant("Name")}}),_.createElement("div")),x=_.createElement("input",{attrs:{type:"checkbox"}});x.setAttribute("aria-label",e.getConstant("Check box enabled")),this.checBoxEnableElement=new H.CheckBox({cssClass:"e-de-ff-dlg-check",label:e.getConstant("Check box enabled"),enableRtl:t}),t&&(o.classList.add("e-de-rtl"),s.classList.add("e-de-rtl"),this.exactNumberDiv.classList.add("e-de-rtl"),p.classList.add("e-de-rtl"),u.classList.add("e-de-rtl"),v.classList.add("e-de-rtl"),w.classList.add("e-de-rtl")),this.target.appendChild(i),i.appendChild(h),i.appendChild(c),c.appendChild(p),p.appendChild(g),this.notCheckedButton.appendTo(g),c.appendChild(u),u.appendChild(m),this.checkedButton.appendTo(m),i.appendChild(n),i.appendChild(r),r.appendChild(o),o.appendChild(a),this.autoButton.appendTo(a),r.appendChild(s),s.appendChild(l),this.exactButton.appendTo(l),s.appendChild(this.exactNumberDiv),this.exactNumberDiv.appendChild(d),this.exactlyNumber.appendTo(d),i.appendChild(f),i.appendChild(y),y.appendChild(v),y.appendChild(w),v.appendChild(this.tooltipInputText),w.appendChild(this.bookmarkInputText),i.appendChild(b),b.appendChild(x),this.checBoxEnableElement.appendTo(x),new D.TextBox({placeholder:e.getConstant("Tooltip"),floatLabelType:"Always"},this.tooltipInputText),new D.TextBox({placeholder:e.getConstant("Name"),floatLabelType:"Always"},this.bookmarkInputText)},pg.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),_.isNullOrUndefined(this.target)&&this.initCheckBoxDialog(e,this.documentHelper.owner.enableRtl),this.loadCheckBoxDialog(),this.documentHelper.dialog.header=e.getConstant("Check Box Form Field"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="400px",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.insertCheckBoxField,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},pg.prototype.loadCheckBoxDialog=function(){var e=this.owner.selectionModule.getCurrentFormField();e instanceof Z&&(this.fieldBegin=e,(e=this.fieldBegin.formFieldData).defaultValue?(this.checkedButton.checked=!0,this.notCheckedButton.checked=!1):(this.checkedButton.checked=!1,this.notCheckedButton.checked=!0),"Auto"!==e.sizeType?(this.exactButton.checked=!0,this.autoButton.checked=!1,this.exactlyNumber.enabled=!0):(this.autoButton.checked=!0,this.exactButton.checked=!1,this.exactlyNumber.enabled=!1),e.size&&(this.exactlyNumber.value=e.size),e.enabled?this.checBoxEnableElement.checked=!0:this.checBoxEnableElement.checked=!1,e.name&&""!==e.name?this.bookmarkInputText.value=e.name:this.bookmarkInputText.value="",e.helpText&&""!==e.helpText?this.tooltipInputText.value=e.helpText:this.tooltipInputText.value="")},pg.prototype.destroy=function(){var e=this.target;e&&(e.parentElement&&e.parentElement.removeChild(e),this.target=void 0),this.owner=void 0,this.autoButton&&(this.autoButton.destroy(),this.autoButton=void 0),this.exactButton&&(this.exactButton.destroy(),this.exactButton=void 0),this.notCheckedButton&&(this.notCheckedButton.destroy(),this.notCheckedButton=void 0),this.checkedButton&&(this.checkedButton.destroy(),this.checkedButton=void 0),this.bookmarkInputText=void 0,this.tooltipInputText=void 0,this.checBoxEnableElement&&(this.checBoxEnableElement.destroy(),this.checBoxEnableElement=void 0),this.exactlyNumber&&(this.exactlyNumber.destroy(),this.exactlyNumber=void 0),this.exactNumberDiv=void 0};var cg=pg;function pg(e){var t=this;this.changeBidirectional=function(e){"exact"===e.value?(t.autoButton.checked=!t.exactButton.checked,t.exactlyNumber.enabled=!0):(t.exactButton.checked=!t.autoButton.checked,t.exactlyNumber.enabled=!1)},this.changeBidirect=function(e){"check"===e.value?t.notCheckedButton.checked=!t.checkedButton.checked:t.checkedButton.checked=!t.notCheckedButton.checked},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide()},this.insertCheckBoxField=function(){t.closeCheckBoxField();var e=new Fh;e.defaultValue=t.checkedButton.checked,e.name=_.SanitizeHtmlHelper.sanitize(t.bookmarkInputText.value),e.helpText=_.SanitizeHtmlHelper.sanitize(t.tooltipInputText.value),e.checked=e.defaultValue,e.enabled=t.checBoxEnableElement.checked,t.exactButton.checked?(e.sizeType="Exactly",e.size=t.exactlyNumber.value):(e.sizeType="Auto",e.size=11),t.owner.editorModule.editFormField("CheckBox",e)},this.closeCheckBoxField=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.owner=e}Object.defineProperty(gg.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),gg.prototype.getModuleName=function(){return"TextFormFieldDialog"},gg.prototype.initTextDialog=function(i,e){var t=this,n=(this.target=_.createElement("div"),_.createElement("div")),r=_.createElement("div",{className:"e-de-container-row"}),o=_.createElement("div",{className:"e-de-subcontainer-left"}),s=(this.defaultTextDiv=_.createElement("div",{className:"e-de-subcontainer-right"}),[{Value:"Regular text",Name:i.getConstant("Regular text")},{Value:"Number",Name:i.getConstant("Number")},{Value:"Date",Name:i.getConstant("Date")}]),a=_.createElement("input"),s=(this.typeDropDown=new U.DropDownList({dataSource:s,popupHeight:"150px",value:"Regular text",change:this.changeTypeDropDown.bind(this),floatLabelType:"Always",placeholder:i.getConstant("Type"),fields:{text:"Name",value:"Value"},htmlAttributes:{"aria-labelledby":i.getConstant("Type")}}),this.defaultTextInput=_.createElement("input",{className:"e-input e-bookmark-textbox-input"}),_.createElement("div",{className:"e-de-container-row"})),l=_.createElement("div",{className:"e-de-subcontainer-left"}),d=_.createElement("input",{attrs:{"aria-labelledby":i.getConstant("Maximum length")}}),h=(this.maxLengthNumber=new D.NumericTextBox({format:"n",value:0,min:0,max:32767,width:"100%",enablePersistence:!1,placeholder:i.getConstant("Maximum length"),floatLabelType:"Always",change:function(e){e.value||(this.element.value=i.getConstant("Unlimited"))},focus:function(e){e.value||(this.element.value=i.getConstant("Unlimited"))},blur:function(e){var t;e.value||(t=this,setTimeout(function(){t.element.value=i.getConstant("Unlimited")},0))}}),_.createElement("div",{className:"e-de-subcontainer-right"})),c=_.createElement("input"),p=[{Value:"Uppercase",Name:i.getConstant("Uppercase")},{Value:"Lowercase",Name:i.getConstant("Lowercase")},{Value:"FirstCapital",Name:i.getConstant("FirstCapital")},{Value:"Titlecase",Name:i.getConstant("TitleCase")}],p=(this.textFormatDropDown=new U.ComboBox({dataSource:p,popupHeight:"150px",allowCustom:!0,showClearButton:!1,change:this.updateTextFormtas.bind(this),placeholder:i.getConstant("Text format"),floatLabelType:"Always",fields:{text:"Name",value:"Value"}}),this.textFormatDropDown.focus=function(){t.textFormatDropDown.element.select()},_.createElement("div",{className:"e-de-ff-dlg-heading",innerHTML:i.getConstant("Field settings")})),u=_.createElement("div",{className:"e-de-container-row"}),g=_.createElement("div",{className:"e-de-subcontainer-left"}),m=_.createElement("div",{className:"e-de-subcontainer-right"}),f=(this.tooltipTextInput=_.createElement("input",{className:"e-input e-bookmark-textbox-input"}),this.bookmarkTextInput=_.createElement("input",{className:"e-input e-bookmark-textbox-input"}),_.createElement("div")),y=_.createElement("input",{attrs:{type:"checkbox"}});y.setAttribute("aria-label",i.getConstant("Fillin enabled")),this.fillInEnable=new H.CheckBox({cssClass:"e-de-ff-dlg-check",label:i.getConstant("Fillin enabled"),enableRtl:e}),e&&(o.classList.add("e-de-rtl"),l.classList.add("e-de-rtl"),g.classList.add("e-de-rtl"),m.classList.add("e-de-rtl")),this.target.appendChild(n),n.appendChild(r),r.appendChild(o),o.appendChild(a),this.typeDropDown.appendTo(a),r.appendChild(this.defaultTextDiv),this.defaultTextDiv.appendChild(this.defaultTextInput),n.appendChild(s),s.appendChild(l),l.appendChild(d),this.maxLengthNumber.appendTo(d),s.appendChild(h),h.appendChild(c),this.textFormatDropDown.appendTo(c),n.appendChild(p),n.appendChild(u),u.appendChild(g),g.appendChild(this.tooltipTextInput),u.appendChild(m),m.appendChild(this.bookmarkTextInput),n.appendChild(f),f.appendChild(y),this.fillInEnable.appendTo(y),this.defaultTextLabel=new D.TextBox({placeholder:i.getConstant("Default text"),floatLabelType:"Always"},this.defaultTextInput),new D.TextBox({placeholder:i.getConstant("Tooltip"),floatLabelType:"Always"},this.tooltipTextInput),new D.TextBox({placeholder:i.getConstant("Name"),floatLabelType:"Always",htmlAttributes:{"aria-labelledby":i.getConstant("Name")}},this.bookmarkTextInput),this.defaultTextInput.setAttribute("aria-labelledby",i.getConstant("Default text")),this.tooltipTextInput.setAttribute("aria-labelledby",i.getConstant("Tooltip")),this.bookmarkTextInput.setAttribute("aria-labelledby",i.getConstant("Name"))},gg.prototype.show=function(){this.localObj=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localObj.setLocale(this.documentHelper.owner.locale),_.isNullOrUndefined(this.target)&&this.initTextDialog(this.localObj,this.documentHelper.owner.enableRtl),this.loadTextDialog(this.localObj),this.documentHelper.dialog.header=this.localObj.getConstant("Text Form Field"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="448px",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.insertTextField,buttonModel:{content:this.localObj.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},gg.prototype.changeTypeDropDown=function(e){e.isInteracted&&(this.defaultTextInput.value="",this.textFormatDropDown.value=""),"Regular text"===e.value?(this.textFormatDropDown.fields={text:"Name",value:"Value"},this.defaultTextLabel.placeholder=this.localObj.getConstant("Default text"),this.textFormatDropDown.placeholder=this.localObj.getConstant("Text format"),this.textFormatDropDown.dataSource=[{Value:"Uppercase",Name:this.localObj.getConstant("Uppercase")},{Value:"Lowercase",Name:this.localObj.getConstant("Lowercase")},{Value:"FirstCapital",Name:this.localObj.getConstant("FirstCapital")},{Value:"Titlecase",Name:this.localObj.getConstant("TitleCase")}]):"Number"===e.value?(this.textFormatDropDown.fields={text:null,value:null},this.defaultTextLabel.placeholder=this.localObj.getConstant("Default number"),this.textFormatDropDown.placeholder=this.localObj.getConstant("Number format"),this.textFormatDropDown.dataSource=["0","0.00","#,##0","#,##0.00","$#,##0.00;($#,##0.00)","0%"]):"Date"===e.value&&(this.textFormatDropDown.fields={text:null,value:null},this.defaultTextLabel.placeholder=this.localObj.getConstant("Default date"),this.textFormatDropDown.placeholder=this.localObj.getConstant("Date format"),this.textFormatDropDown.dataSource=["M/d/yyyy","dddd, MMMM d, yyyy","MMMM d, yyyy","M/d/yy","yyyy-MM-dd","d-MMM-yy","M.d.yyyy","MMM. d, yy","d MMMM yyyy","MMMM yy","MMM-yy","M/d/yyyy h:mm am/pm","M/d/yyyy h:mm:ss am/pm","h:mm am/pm","h:mm:ss am/pm","HH:mm","HH:mm:ss"]),this.defaultTextLabel.dataBind(),this.textFormatDropDown.dataBind()},gg.prototype.loadTextDialog=function(e){var t=this.owner.selectionModule.getCurrentFormField();t instanceof Z&&(0<(t=(this.fieldBegin=t).formFieldData).maxLength?this.maxLengthNumber.value=t.maxLength:(this.maxLengthNumber.value=0,this.maxLengthNumber.element.value=e?e.getConstant("Unlimited"):"Unlimited"),"Date"===t.type?this.typeDropDown.value="Date":"Number"===t.type?this.typeDropDown.value="Number":this.typeDropDown.value="Regular text",t.format?this.textFormatDropDown.value=t.format:this.textFormatDropDown.value="",this.defaultTextInput.value=_.isNullOrUndefined(t.defaultValue)?"":t.defaultValue,this.fillInEnable.checked=t.enabled,this.tooltipTextInput.value=_.isNullOrUndefined(t.helpText)?"":t.helpText,this.bookmarkTextInput.value=_.isNullOrUndefined(t.name)?"":t.name)},gg.prototype.updateFormats=function(e){var t,i=_.isNullOrUndefined(this.textFormatDropDown.value)?"":this.textFormatDropDown.value.toString();return"Regular text"===this.typeDropDown.value?j.formatText(i,e):"Number"===this.typeDropDown.value?"NaN"!==(t=j.formatNumber(i,e)).toString()?t:"":"Date"===this.typeDropDown.value?j.formatDate(i,e):""},gg.prototype.isValidDateFormat=function(){var e=this.defaultTextInput.value;if(""!==e){e=new Date(e);if(isNaN(e.getDate()))return!1}return!0},gg.prototype.destroy=function(){var e=this.target;e&&(e.parentElement&&e.parentElement.removeChild(e),this.target=void 0),this.maxLengthNumber&&(this.maxLengthNumber.destroy(),this.maxLengthNumber=void 0),this.fillInEnable&&(this.fillInEnable.destroy(),this.fillInEnable=void 0),this.typeDropDown&&(this.typeDropDown.destroy(),this.typeDropDown=void 0),this.textFormatDropDown&&(this.textFormatDropDown.destroy(),this.textFormatDropDown=void 0),this.owner=void 0,this.defaultTextInput=void 0,this.tooltipTextInput=void 0,this.bookmarkTextInput=void 0,this.defaultTextLabel=void 0,this.defaultTextDiv=void 0,this.textFormatLabel=void 0};var ug=gg;function gg(e){var n=this;this.updateTextFormtas=function(){var e=_.SanitizeHtmlHelper.sanitize(n.updateFormats(n.defaultTextInput.value));n.defaultTextInput.value=_.isNullOrUndefined(e)?"":e},this.onCancelButtonClick=function(){n.documentHelper.dialog.hide()},this.insertTextField=function(){var e,t,i=!0;(i="Date"===n.typeDropDown.value?n.isValidDateFormat():i)?(n.updateTextFormtas(),n.defaultTextInput.value.length>n.maxLengthNumber.value&&!_.isNullOrUndefined(n.maxLengthNumber.value)&&0!==n.maxLengthNumber.value?C.DialogUtility.alert({content:"The maximum length value must be equal or greater than the length of the default text.",showCloseIcon:!0,closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}).enableRtl=n.owner.enableRtl:(i=void 0,i="Date"===n.typeDropDown.value?"Date":"Number"===n.typeDropDown.value?"Number":"Text",e=_.SanitizeHtmlHelper.sanitize(n.textFormatDropDown.value),(t=new Ch).type=i,t.defaultValue=n.defaultTextInput.value,t.maxLength=n.maxLengthNumber.value,t.format=_.isNullOrUndefined(e)?"":e,t.name=_.SanitizeHtmlHelper.sanitize(n.bookmarkTextInput.value),t.helpText=_.SanitizeHtmlHelper.sanitize(n.tooltipTextInput.value),t.enabled=n.fillInEnable.checked,n.owner.editorModule.editFormField("Text",t),n.closeTextField())):C.DialogUtility.alert({content:"A valid date or time is required",showCloseIcon:!0,closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}).enableRtl=n.owner.enableRtl},this.closeTextField=function(){n.documentHelper.dialog.hide(),n.documentHelper.dialog.element.style.pointerEvents=""},this.owner=e}Object.defineProperty(fg.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),fg.prototype.getModuleName=function(){return"DropDownFormFieldDialog"},fg.prototype.initTextDialog=function(e,t){this.target=_.createElement("div");var i=_.createElement("div"),n=_.createElement("div",{className:"e-de-drp-dwn-frst-div"}),r=(this.drpDownItemsInput=_.createElement("input",{className:"e-input e-bookmark-textbox-input",id:"fielditems_text_box"}),this.drpDownItemsInput.addEventListener("keyup",this.onKeyUpOnTextBox),_.createElement("div",{className:"e-de-ff-drpdwn-dlg-scndiv"})),o=_.createElement("div",{className:"e-de-ff-dlg-drpdwn-heading",innerHTML:e.getConstant("Items in dropdown list")}),s=_.createElement("div",{className:"e-bookmark-listViewDiv e-de-ff-drpdwn-listview",attrs:{style:"height:100%"}}),a=(this.listviewInstance=new F.ListView({cssClass:"e-bookmark-listview",select:this.selectHandler}),_.createElement("div")),l=_.createElement("div",{className:"e-bookmark-addbutton"}),d=_.createElement("button",{innerHTML:e.getConstant("ADD"),attrs:{type:"button",style:"height:36px;width:100%"}}),h=(this.addButton=new H.Button({cssClass:"e-button-custom"}),this.addButton.disabled=!0,d.setAttribute("aria-label",e.getConstant("ADD")),d.addEventListener("click",this.addItemtoList.bind(this)),_.createElement("div",{className:"e-bookmark-addbutton"})),c=(h.style.display="none",_.createElement("button",{innerHTML:"EDIT",attrs:{type:"button",style:"height:36px;width:100%"}})),p=(this.editButton=new H.Button({cssClass:"e-button-custom"}),c.setAttribute("aria-label","EDIT"),_.createElement("div",{className:"e-bookmark-addbutton"})),u=_.createElement("button",{innerHTML:e.getConstant("REMOVE"),attrs:{type:"button",style:"height:36px;width:100%"}}),g=(u.setAttribute("aria-label",e.getConstant("REMOVE")),this.removeButton=new H.Button({cssClass:"e-button-custom"}),u.addEventListener("click",this.removeItemFromList.bind(this)),_.createElement("div",{attrs:{style:"display:inline-flex"}})),m=_.createElement("div",{className:"e-bookmark-addbutton"}),f=_.createElement("button",{attrs:{type:"button",style:"height:36px;width:40px"},className:"e-de-ff-drpdwn-mvup"}),y=(f.setAttribute("aria-label","moveUp"),this.moveUpButton=new H.Button({cssClass:"e-button-custom",iconCss:"e-de-arrow-up"}),f.addEventListener("click",this.moveUpItem.bind(this)),_.createElement("div",{className:"e-bookmark-addbutton"})),v=_.createElement("button",{attrs:{type:"button",style:"height:36px;width:40px"},className:"e-de-ff-drpdwn-mvdn"}),w=(v.setAttribute("aria-label","moveDown"),this.moveDownButton=new H.Button({cssClass:"e-button-custom",iconCss:"e-de-arrow-down"}),v.addEventListener("click",this.moveDownItem.bind(this)),_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Field settings")})),b=_.createElement("div",{className:"e-de-container-row"}),x=_.createElement("div",{className:"e-de-subcontainer-left"}),C=_.createElement("div",{className:"e-de-subcontainer-right"}),I=(this.tooltipInput=_.createElement("input",{className:"e-input e-bookmark-textbox-input"}),this.bookmarkInput=_.createElement("input",{className:"e-input e-bookmark-textbox-input"}),_.createElement("div")),k=_.createElement("input",{attrs:{type:"checkbox"}});this.dropDownEnable=new H.CheckBox({cssClass:"e-de-ff-dlg-check",label:e.getConstant("Dropdown enabled"),enableRtl:t}),t&&(s.classList.add("e-de-rtl"),f.classList.add("e-de-rtl"),x.classList.add("e-de-rtl"),C.classList.add("e-de-rtl")),I.setAttribute("aria-label",e.getConstant("Dropdown enabled")),this.target.appendChild(i),i.appendChild(n),n.appendChild(this.drpDownItemsInput),i.appendChild(o),i.appendChild(r),r.appendChild(s),this.listviewInstance.appendTo(s),r.appendChild(a),a.appendChild(l),l.appendChild(d),this.addButton.appendTo(d),a.appendChild(h),h.appendChild(c),this.editButton.appendTo(c),a.appendChild(p),p.appendChild(u),this.removeButton.appendTo(u),a.appendChild(g),g.appendChild(m),m.appendChild(f),this.moveUpButton.appendTo(f),g.appendChild(y),y.appendChild(v),this.moveDownButton.appendTo(v),i.appendChild(w),i.appendChild(b),b.appendChild(x),x.appendChild(this.tooltipInput),b.appendChild(C),C.appendChild(this.bookmarkInput),i.appendChild(I),I.appendChild(k),this.dropDownEnable.appendTo(k),new D.TextBox({placeholder:e.getConstant("Tooltip"),floatLabelType:"Always"},this.tooltipInput),new D.TextBox({placeholder:e.getConstant("Name"),floatLabelType:"Always"},this.bookmarkInput),new D.TextBox({placeholder:e.getConstant("Dropdown items"),floatLabelType:"Always"},this.drpDownItemsInput),this.tooltipInput.setAttribute("aria-labelledby",e.getConstant("Tooltip")),this.bookmarkInput.setAttribute("aria-labelledby",e.getConstant("Name")),this.drpDownItemsInput.setAttribute("aria-labelledby",e.getConstant("Dropdown items"))},fg.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),_.isNullOrUndefined(this.target)&&this.initTextDialog(e,this.documentHelper.owner.enableRtl),this.loadDropDownDialog(),this.documentHelper.dialog.header=e.getConstant("Drop Down Form Field"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="448px",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.insertDropDownField,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},fg.prototype.loadDropDownDialog=function(){var e=this.owner.selectionModule.getCurrentFormField();e instanceof Z&&(this.fieldBegin=e,this.dropDownInstance=e.formFieldData,0<this.dropDownInstance.dropdownItems.length&&(e=this.dropDownInstance.selectedIndex,this.currentSelectedItem=this.dropDownInstance.dropdownItems[e]),this.dropDownInstance.enabled?this.dropDownEnable.checked=!0:this.dropDownEnable.disabled=!1,""!==this.dropDownInstance.helpText?this.tooltipInput.value=this.dropDownInstance.helpText:this.tooltipInput.value="",""!==this.dropDownInstance.name?this.bookmarkInput.value=this.dropDownInstance.name:this.bookmarkInput.value="",this.dropDownItems=this.dropDownInstance.dropdownItems.slice(),this.updateList())},fg.prototype.updateList=function(){var e;this.listviewInstance.dataSource=this.dropDownItems.slice(),this.listviewInstance.dataBind(),this.currentSelectedItem&&(e=this.currentSelectedItem,this.listviewInstance.selectItem(e))},fg.prototype.getSelectedIndex=function(){for(var e=0;e<this.dropDownItems.length;e++)if(this.dropDownItems[e]===this.currentSelectedItem)return e;return 0},fg.prototype.moveUp=function(e,t){var i=[];if(0===e){for(var n=0;n<this.dropDownItems.length;n++)n<this.dropDownItems.length-1?i[n]=this.dropDownItems[n+1]:i[n]=this.dropDownItems[0];this.dropDownItems=i}else{var r=this.dropDownItems[e];this.dropDownItems[e]=this.dropDownItems[t],this.dropDownItems[t]=r}},fg.prototype.moveDown=function(e,t){var i=[];if(e===this.dropDownItems.length-1){for(var n=0;n<this.dropDownItems.length;n++)i[n]=0!==n?this.dropDownItems[n-1]:this.dropDownItems[this.dropDownItems.length-1];this.dropDownItems=i}else{var r=this.dropDownItems[e];this.dropDownItems[e]=this.dropDownItems[t],this.dropDownItems[t]=r}},fg.prototype.enableOrDisableButton=function(){_.isNullOrUndefined(this.addButton)||(this.addButton.disabled=""===this.drpDownItemsInput.value)},fg.prototype.destroy=function(){var e=this.target;e&&(e.parentElement&&e.parentElement.removeChild(e),this.target=void 0),this.owner=void 0,this.drpDownItemsInput=void 0,this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.addButton&&(this.addButton.destroy(),this.addButton=void 0),this.editButton&&(this.editButton.destroy(),this.editButton=void 0),this.removeButton&&(this.removeButton.destroy(),this.removeButton=void 0),this.moveUpButton&&(this.moveUpButton.destroy(),this.moveUpButton=void 0),this.moveDownButton&&(this.moveDownButton.destroy(),this.moveDownButton=void 0),this.tooltipInput=void 0,this.bookmarkInput=void 0,this.dropDownEnable&&(this.dropDownEnable.destroy(),this.dropDownEnable=void 0),this.dropDownInstance=void 0};var mg=fg;function fg(e){var t=this;this.addItemtoList=function(){t.dropDownItems.push(_.SanitizeHtmlHelper.sanitize(t.drpDownItemsInput.value)),t.currentSelectedItem=_.SanitizeHtmlHelper.sanitize(t.drpDownItemsInput.value),t.drpDownItemsInput.value="",t.enableOrDisableButton(),t.updateList()},this.removeItemFromList=function(){for(var e=0;e<t.dropDownItems.length;e++)t.dropDownItems[e]===t.currentSelectedItem&&t.dropDownItems.splice(e,1);t.updateList()},this.selectHandler=function(e){t.currentSelectedItem=e.text},this.moveUpItem=function(){var e=t.getSelectedIndex();t.moveUp(e,e-1),t.updateList()},this.moveDownItem=function(){var e=t.getSelectedIndex();t.moveDown(e,e+1),t.updateList()},this.onKeyUpOnTextBox=function(){t.enableOrDisableButton()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide()},this.insertDropDownField=function(){var e=new Sh;e.dropdownItems=t.dropDownItems,e.selectedIndex=0,e.name=_.SanitizeHtmlHelper.sanitize(t.bookmarkInput.value),e.helpText=_.SanitizeHtmlHelper.sanitize(t.tooltipInput.value),e.enabled=t.dropDownEnable.checked,t.owner.editorModule.editFormField("DropDown",e),t.closeDropDownField()},this.closeDropDownField=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.owner=e}var yg=function(){},vg=(wg.prototype.getModuleName=function(){return"ColumnsDialog"},wg.prototype.initColumnsDialog=function(e,t){this.columns=[],this.target=_.createElement("div",{id:this.documentHelper.owner.containerId+"_Columns",className:"e-de-table-border-shading-dlg"});var i=_.createElement("div",{innerHTML:e.getConstant("Presets"),className:"e-de-para-dlg-heading"}),n=_.createElement("div",{className:"e-de-dlg-row"}),r=_.createElement("div",{id:this.target.id+"_One_Div_Container",className:"e-de-preset-container"}),o=(this.oneDiv=_.createElement("div",{id:this.target.id+"_One_Div",className:"e-icons e-de-ctnr-columns-one e-de-columns-presets-genral"}),_.createElement("label",{innerHTML:e.getConstant("One"),className:"e-de-column-label",id:this.target.id+"_One_Div_Label"})),s=_.createElement("div",{id:this.target.id+"_Two_Div_Container",className:"e-de-preset-container"}),a=(this.twoDiv=_.createElement("div",{id:this.target.id+"_Two_Div",className:"e-icons e-de-ctnr-columns-two e-de-columns-presets-genral"}),_.createElement("label",{innerHTML:e.getConstant("Two"),className:"e-de-column-label",id:this.target.id+"_Two_Div_Label"})),l=_.createElement("div",{id:this.target.id+"_Three_Div_Container",className:"e-de-preset-container"}),d=(this.threeDiv=_.createElement("div",{id:this.target.id+"_Three_Div",className:"e-icons e-de-ctnr-columns-three  e-de-columns-presets-genral"}),_.createElement("label",{innerHTML:e.getConstant("Three"),className:"e-de-column-label",id:this.target.id+"_Three_Div_Label"})),h=_.createElement("div",{id:this.target.id+"_Left_Div_Container",className:"e-de-preset-container"}),c=(this.leftDiv=_.createElement("div",{id:this.target.id+"_Left_Div",className:"e-icons e-de-ctnr-columns-left e-de-columns-presets-genral"}),_.createElement("label",{innerHTML:e.getConstant("Left"),className:"e-de-column-label",id:this.target.id+"_Left_Div_Label"})),p=_.createElement("div",{id:this.target.id+"_Right_Div_Container",className:"e-de-preset-container"}),u=(this.rightDiv=_.createElement("div",{id:this.target.id+"_Right_Div",className:"e-icons e-de-ctnr-columns-right e-de-columns-presets-genral"}),_.createElement("label",{innerHTML:e.getConstant("Right"),className:"e-de-column-label",id:this.target.id+"_Right_Div_Label"})),g=_.createElement("div",{className:"e-de-container-row e-de-columns-padding-alignment"}),m=_.createElement("div",{className:"e-de-subcontainer-left"}),t=(r.setAttribute("aria-label",e.getConstant("One")),s.setAttribute("aria-label",e.getConstant("Two")),l.setAttribute("aria-label",e.getConstant("Three")),h.setAttribute("aria-label",e.getConstant("Left")),p.setAttribute("aria-label",e.getConstant("Right")),t&&(this.oneDiv.classList.add("e-de-rtl"),this.twoDiv.classList.add("e-de-rtl"),this.threeDiv.classList.add("e-de-rtl"),this.leftDiv.classList.add("e-de-rtl"),this.rightDiv.classList.add("e-de-rtl"),r.classList.add("e-de-rtl"),s.classList.add("e-de-rtl"),l.classList.add("e-de-rtl"),h.classList.add("e-de-rtl"),p.classList.add("e-de-rtl"),o.classList.add("e-de-rtl"),a.classList.add("e-de-rtl"),d.classList.add("e-de-rtl"),c.classList.add("e-de-rtl"),u.classList.add("e-de-rtl")),this.columnsCountBox=_.createElement("input",{attrs:{type:"text"}}),m.appendChild(this.columnsCountBox),g.appendChild(m),this.section=this.documentHelper.selection.sectionFormat,this.pageWidth=this.section.pageWidth-this.section.leftMargin-this.section.rightMargin,this.columnValueTexBox=new D.NumericTextBox({format:"#",value:1,min:1,strictMode:!0,placeholder:e.getConstant("Number of columns"),floatLabelType:"Always",change:this.createTextBox}),this.columnValueTexBox.appendTo(this.columnsCountBox),_.createElement("div",{className:"e-de-subcontainer-right"})),m=_.createElement("div",{className:"e-de-columns-padding-alignment"}),f=_.createElement("input",{attrs:{type:"checkbox"}}),m=(t.appendChild(m),m.appendChild(f),f.setAttribute("aria-labelledby",e.getConstant("Line between column")),this.columnsCountBox.setAttribute("aria-labelledby",e.getConstant("Number of columns")),this.lineCheckbox=new H.CheckBox({label:e.getConstant("Line between column")}),_.createElement("div",{className:"e-de-dlg-row"})),y=_.createElement("div",{}),v=_.createElement("div",{innerHTML:e.getConstant("Width and Spacing"),className:"e-de-para-dlg-heading"}),w=(this.columnElementDiv=_.createElement("div",{className:"e-width-space-div "}),this.widthcontainerDiv1=_.createElement("div",{className:"e-de-container-row"}),this.widthContainer=_.createElement("div",{className:"e-de-container-row"}),_.createElement("table")),b=(w.style.width="96%",w.insertRow()),x=b.insertCell(),b=(x.innerHTML=e.getConstant("Column"),x.style.width="20%",x.style.display="table-cell",x.classList.add("e-de-dlg-sub-header"),(x=b.insertCell()).innerHTML=e.getConstant("Width"),x.style.width="40%",x.style.display="table-cell",x.classList.add("e-de-dlg-sub-header"),(x=b.insertCell()).innerHTML=e.getConstant("Spacing"),x.style.width="40%",x.style.display="table-cell",x.classList.add("e-de-dlg-sub-header"),_.createElement("div",{styles:"width:100%;height:100px;overflow-y: scroll;overflow-x: hidden;"})),x=(this.columnTable=_.createElement("table",{styles:"width:100%;"}),this.columnTable.insertRow()),C=x.insertCell(),I=(C.style.width="20%",new yg),C=(this.columnCountBox1=_.createElement("input",{}),I.index=new D.NumericTextBox({format:"#",min:1,value:1,enabled:!1,cssClass:"index1",showSpinButton:!1,floatLabelType:"Always",change:this.spaceChange}),C.appendChild(this.columnCountBox1),I.index.appendTo(this.columnCountBox1),x.insertCell()),C=(C.style.width="40%",this.widthCountBox1=_.createElement("input",{attrs:{type:"text"}}),I.width=new D.NumericTextBox({min:36,decimals:2,strictMode:!0,enablePersistence:!1,cssClass:"width1",floatLabelType:"Always",change:this.widthChange}),C.appendChild(this.widthCountBox1),C.style.width="40%",I.width.appendTo(this.widthCountBox1),x.insertCell()),x=(C.style.width="40%",this.spacingCountBox1=_.createElement("input",{attrs:{type:"text"}}),I.space=new D.NumericTextBox({min:0,decimals:2,strictMode:!0,enablePersistence:!1,cssClass:"space1",floatLabelType:"Always",change:this.spaceChange}),C.appendChild(this.spacingCountBox1),I.space.appendTo(this.spacingCountBox1),this.columns.push(I),I.space.enabled=!1,this.widthCountBox1.setAttribute("aria-labelledby","Width"),this.spacingCountBox1.setAttribute("aria-labelledby","Space"),_.createElement("div",{className:"e-de-columns-padding-alignment"})),C=_.createElement("input",{attrs:{type:"checkbox"}});x.appendChild(C),x.setAttribute("aria-label",e.getConstant("Equal column width")),this.equalCheckbox=new H.CheckBox({label:e.getConstant("Equal column width"),change:this.checkBox}),this.equalCheckbox.appendTo(C),this.lineCheckbox.appendTo(f),g.appendChild(t),r.appendChild(this.oneDiv),r.appendChild(o),s.appendChild(this.twoDiv),s.appendChild(a),l.appendChild(this.threeDiv),l.appendChild(d),h.appendChild(this.leftDiv),h.appendChild(c),p.appendChild(this.rightDiv),p.appendChild(u),n.appendChild(r),n.appendChild(s),n.appendChild(l),n.appendChild(h),n.appendChild(p),y.appendChild(v),y.appendChild(w),b.appendChild(this.columnTable),y.appendChild(b),m.appendChild(y),this.target.appendChild(i),this.target.appendChild(n),this.target.appendChild(g),this.target.appendChild(m),this.target.appendChild(x),r.addEventListener("click",this.handleSettingCheckBoxAction),s.addEventListener("click",this.handleSettingCheckBoxAction),l.addEventListener("click",this.handleSettingCheckBoxAction),h.addEventListener("click",this.handleSettingCheckBoxAction),p.addEventListener("click",this.handleSettingCheckBoxAction),this.widthcontainerDiv1.style.display="flex",this.equalCheckbox.checked=!0,this.equalCheckbox.disabled=!0,this.lineCheckbox.disabled=!0},wg.prototype.createColumn=function(e,t,i){this.widthContainer=_.createElement("div",{className:"e-de-container-row"}),this.widthContainer.style.display="flex";var n=this.columnTable.insertRow(),r=n.insertCell(),o=(r.style.width="20%",new yg),s=_.createElement("input",{}),e=(o.index=new D.NumericTextBox({format:"#",min:1,value:e,enabled:!1,cssClass:"column1",showSpinButton:!1,floatLabelType:"Always"}),r.appendChild(s),o.index.appendTo(s),n.insertCell()),r=(e.style.width="40%",_.createElement("input",{attrs:{type:"text"}})),s=(o.width=new D.NumericTextBox({min:36,decimals:2,strictMode:!0,enablePersistence:!1,cssClass:"width1",floatLabelType:"Always",change:this.widthChange}),_.isNullOrUndefined(t)||(o.width.value=t),e.appendChild(r),o.width.appendTo(r),n.insertCell()),t=(s.style.width="40%",_.createElement("input",{attrs:{type:"text"}}));o.space=new D.NumericTextBox({min:0,decimals:2,strictMode:!0,enablePersistence:!1,cssClass:"space1",floatLabelType:"Always",change:this.spaceChange}),_.isNullOrUndefined(i)||(o.space.value=i),s.appendChild(t),o.space.appendTo(t),this.columns.push(o)},wg.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initColumnsDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.header=e.getConstant("Columns"),this.documentHelper.dialog.beforeOpen=this.openColumnsDialog,this.documentHelper.dialog.close=this.closeColumnsDialog,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.buttons=[{click:this.applyColumnDialog,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-border-shading-okay",isPrimary:!0}},{click:this.closeDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-border-shading-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},wg.prototype.setSettingPreviewDivElement=function(e,t){var i=this;switch(this.equalCheckbox.checked=!0,e){case"one":this.columnValueTexBox.value=1;break;case"two":this.columnValueTexBox.value=2,setTimeout(function(){var e;"left"!==t&&"right"!==t||(i.equalCheckbox.checked=!1),"left"===t?(i.numberOfColumns=2,i.leftDiv.classList.add("e-de-table-border-inside-setting-click"),i.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),e=(i.pageWidth-72)/3,i.columns[0].width.value=e,i.columns[1].width.value=e+e+36,i.columns[1].space.value=void 0):"right"===t&&(i.numberOfColumns=2,i.rightDiv.classList.add("e-de-table-border-inside-setting-click"),i.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),e=(i.pageWidth-72)/3,i.columns[0].width.value=e+e+36,i.columns[1].width.value=e,i.columns[1].space.value=void 0)},5);break;case"three":this.columnValueTexBox.value=3}},wg.prototype.destroy=function(){this.target=void 0,this.oneDiv=void 0,this.twoDiv=void 0,this.threeDiv=void 0,this.leftDiv=void 0,this.rightDiv=void 0,this.documentHelper=void 0},wg);function wg(e){var y=this;this.lineCheckbox=void 0,this.equalCheckbox=void 0,this.checkBox=function(e){for(var t=0;t<y.columns.length;t++){var i=y.columns[parseInt(t.toString(),10)];!0===y.equalCheckbox.checked?0!==t&&(i.width.enabled=!1,i.space.enabled=!1):(i.width.enabled=!0,i.space.enabled=!0)}},this.createTextBox=function(e){if(1===y.columnValueTexBox.value?(y.oneDiv.classList.add("e-de-table-border-inside-setting-click"),y.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),y.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),y.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),y.rightDiv.classList.remove("e-de-table-border-inside-setting-click")):2===y.columnValueTexBox.value?(y.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),y.twoDiv.classList.add("e-de-table-border-inside-setting-click"),y.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),y.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),y.rightDiv.classList.remove("e-de-table-border-inside-setting-click")):3===y.columnValueTexBox.value&&(y.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),y.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),y.threeDiv.classList.add("e-de-table-border-inside-setting-click"),y.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),y.rightDiv.classList.remove("e-de-table-border-inside-setting-click")),y.numberOfColumns=e.value,1<=e.value){y.equalCheckbox.disabled=!1,y.lineCheckbox.disabled=!1;for(var t=e.previousValue;t<y.numberOfColumns;)y.createColumn(t+1),t++;for(;t>y.numberOfColumns;)y.columnTable.deleteRow(y.columnTable.rows.length-1),y.columns.splice(y.columns.length-1,y.columns.length),1===y.numberOfColumns&&(y.equalCheckbox.disabled=!0,y.columns[0].space.enabled=!1),t--;y.canUpdateColumnWidthAndSpacing(e.value,void 0,void 0,void 0)}},this.widthChange=function(e){!0===e.isInteracted&&(e.event.target.parentElement.classList.replace("width1","Width"),y.checkAndApplyColumnFormatWidth(e.value))},this.spaceChange=function(e){!0===e.isInteracted&&(e.event.target.parentElement.classList.replace("space1","Space"),y.checkAndApplyColumnFormatSpace(e.value))},this.checkAndApplyColumnFormatWidth=function(e){if(1===y.numberOfColumns)e>y.pageWidth?y.columns[0].width.value=e-1:y.columns[0].width.value=e+1;else{if(!0===y.equalCheckbox.checked)for(var t=0;t<y.columns.length;t++){var i,n=y.columns[parseInt(t.toString(),10)];36<=e&&0<=y.columns[0].space.value?(i=(y.pageWidth-y.numberOfColumns*e)/(y.numberOfColumns-1),n.width.value=e,t<y.columns.length-1&&(n.space.value=i)):y.columns[0].width.value=y.columns[1].width.value}if(!1===y.equalCheckbox.checked)for(t=0;t<y.columns.length;t++){var r,n=y.columns[parseInt(t.toString(),10)];if(e===y.columns[parseInt(t.toString(),10)].width.value)if((r=t)+1!==y.columns.length)if(e>y.columns[0].width.value||e>y.columns[y.columns.length-1].width.value)for(var o=r+1;o<=y.columns.length;o++){var s=y.columns[parseInt(o.toString(),10)];if(o<y.columns.length&&36<s.width.value&&(s.width.value=s.width.value-1),0===y.columns[0].space.value)for(var a=r-1;0<=a;a--){var l=y.columns[parseInt(a.toString(),10)];36<l.width.value&&(l.width.value=l.width.value-1)}if(o>=y.columns.length&&36===y.columns[0].width.value||36===y.columns[o-1].width.value&&0!==y.columns[0].space.value)for(var d=0;d<y.columns.length-1;d++){var h=y.columns[parseInt(d.toString(),10)];0<h.space.value&&d<y.columns.length-1&&(h.space.value=h.space.value-1)}if(36===y.columns[0].width.value&&0===y.columns[0].space.value||36===y.columns[o-1].width.value&&0===y.columns[0].space.value)for(d=0;d<y.columns.length;d++){var c=y.columns[parseInt(d.toString(),10)];36!==c.width.value&&e>y.pageWidth-36*(y.numberOfColumns-1)&&(c.width.value=e-1)}}else for(o=r+1;o<y.columns.length;o++){var p=y.columns[parseInt(o.toString(),10)];36<p.width.value&&(p.width.value=p.width.value+1)}else if(e>y.columns[0].width.value||e>y.columns[y.columns.length-1].width.value)for(o=r+1;o<=y.columns.length;o++){if(0===y.columns[0].space.value)for(a=r-1;0<=a;a--){var u=y.columns[parseInt(a.toString(),10)];36<u.width.value&&(u.width.value=u.width.value-1)}if(o<=y.columns.length&&0!==y.columns[0].space.value)for(d=0;d<y.columns.length-1;d++){var g=y.columns[parseInt(d.toString(),10)];0<g.space.value&&d<y.columns.length-1&&(g.space.value=g.space.value-1)}if(36===y.columns[0].width.value&&0===y.columns[0].space.value)for(d=0;d<y.columns.length;d++){var m=y.columns[parseInt(d.toString(),10)];36!==m.width.value&&e>y.pageWidth-36*(y.numberOfColumns-1)&&(m.width.value=e-1)}}else for(o=r+1;o<y.columns.length;o++){var f=y.columns[parseInt(o.toString(),10)];36<f.width.value&&(f.width.value=f.width.value+1)}}}},this.checkAndApplyColumnFormatSpace=function(e){if(!0===y.equalCheckbox.checked)for(var t=0;t<y.columns.length;t++){var i,n=y.columns[parseInt(t.toString(),10)];0<=e&&36<=y.columns[0].width.value?(i=(y.pageWidth-e*(y.numberOfColumns-1))/y.numberOfColumns,n.width.value=i,t<y.columns.length-1&&(n.space.value=e)):y.columns[0].space.value=y.columns[1].space.value}if(!1===y.equalCheckbox.checked)for(t=0;t<y.columns.length;t++){var n=y.columns[parseInt(t.toString(),10)],r=void 0;if(e===y.columns[parseInt(t.toString(),10)].space.value)if((r=t)+1!==y.columns.length)if(y.columns[y.columns.length-1].space.value=0,e>y.columns[0].space.value||e>y.columns[y.columns.length-2].space.value)for(var o=r+1;o<=y.columns.length;o++){var s=y.columns[parseInt(o.toString(),10)];if(o<y.columns.length&&36<s.width.value&&(s.width.value=s.width.value-1),36===y.columns[r+1].width.value&&36<y.columns[parseInt(r.toString(),10)].width.value)for(var a=r;0<=a;a--){var l=y.columns[parseInt(a.toString(),10)];36<l.width.value&&(l.width.value=l.width.value-1)}if(36===y.columns[parseInt(r.toString(),10)].width.value&&(0!==y.columns[0].space.value||0!==y.columns[r+1].space.value))for(var d=0;d<y.columns.length-1;d++){var h=y.columns[parseInt(d.toString(),10)];0<h.space.value&&d<y.columns.length-1&&(h.space.value=h.space.value-1,y.columns[parseInt(r.toString(),10)].space.value=e)}if(36===y.columns[0].width.value&&(0===y.columns[0].space.value||0===y.columns[r+1].space.value))for(a=0;a<y.columns.length;a++){var c=y.columns[parseInt(a.toString(),10)];0!==c.space.value&&e>y.pageWidth-36*y.numberOfColumns&&(c.space.value=e-1)}}else for(o=r+1;o<y.columns.length;o++){var p=y.columns[parseInt(o.toString(),10)];36<p.width.value&&(p.width.value=p.width.value+.5)}else y.columns[parseInt(r.toString(),10)].space.value=0}},this.canUpdateColumnWidthAndSpacing=function(e,t,i,n){var r=(y.pageWidth-36*(e-1))/e,o=(y.pageWidth-36*e)/(e-1);if(2===e&&(y.equalCheckbox.checked=!0),!0===y.equalCheckbox.checked){if(1<e){y.columns[e-1].index.value=e;for(var s=0;s<e;s++){var a=y.columns[parseInt(s.toString(),10)];a.width.value=e<=6?r:36,a.width.value=r,s<e-1&&(a.space.value=e<=6?36:o),a.width.enabled=!1,a.space.enabled=!1}}else y.columns[0].width.value=y.pageWidth;y.columns[0].width.enabled=!0,y.columns[0].space.enabled=1<e}if(!1===y.equalCheckbox.checked)if(2<e){y.columns[e-1].index.value=e;for(s=0;s<e;s++){var l=y.columns[parseInt(s.toString(),10)];l.width.value=r,s<e-1&&(l.width.value<=36?l.space.value=o:l.space.value=36),l.width.enabled=!0,l.space.enabled=!0}}else y.columns[0].width.value=y.pageWidth},this.closeDialog=function(){y.documentHelper.dialog.hide(),y.unWireEventsAndBindings(),y.closeColumnsDialog()},this.closeColumnsDialog=function(){y.documentHelper.dialog2.element.style.pointerEvents="",y.unWireEventsAndBindings(),y.documentHelper.updateFocus()},this.unWireEventsAndBindings=function(){y.equalCheckbox.checked=!0,y.lineCheckbox.checked=!1,y.equalCheckbox.disabled=!0;for(var e=0;e<y.columns.length;e++)y.columns.splice(1,y.columns.length-1),y.columns[0].space.enabled=!1;for(;1<y.columnTable.rows.length;)y.columnTable.deleteRow(y.columnTable.rows.length-1)},this.openColumnsDialog=function(){var e=y.documentHelper.selection.sectionFormat,t=e.pageWidth-e.leftMargin-e.rightMargin;switch(y.columnValueTexBox.max=t/36,y.columns[0].width.value=t,y.documentHelper.updateFocus(),y.equalCheckbox.checked=e.equalWidth,y.lineCheckbox.checked=e.lineBetweenColumns,y.columnValueTexBox.value=0===e.columns.length?1:e.columns.length,y.columnValueTexBox.value){case 1:y.oneDiv.classList.add("e-de-table-border-inside-setting-click"),y.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),y.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),y.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),y.rightDiv.classList.remove("e-de-table-border-inside-setting-click");break;case 2:y.twoDiv.classList.add("e-de-table-border-inside-setting-click"),y.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),y.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),y.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),y.rightDiv.classList.remove("e-de-table-border-inside-setting-click");break;case 3:y.threeDiv.classList.add("e-de-table-border-inside-setting-click"),y.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),y.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),y.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),y.rightDiv.classList.remove("e-de-table-border-inside-setting-click")}1!==y.columnValueTexBox.value&&(y.columns[0].space.value=e.columns[0].space,y.columns[0].width.value=e.columns[0].width),1===y.columnValueTexBox.value&&(y.columns[0].space.value=0);for(var i=1;i<y.columnValueTexBox.value;i++)y.createColumn(i+1,e.columns[i].width,e.columns[i].space)},this.handleSettingCheckBoxAction=function(e){var e=e.target.id,t=y.target.id;e===t+"_One_Div"||e===t+"_One_Div_Container"?(y.oneDiv.classList.add("e-de-table-border-inside-setting-click"),y.setSettingPreviewDivElement("one")):e===t+"_Two_Div"||e===t+"_Two_Div_Container"?(y.twoDiv.classList.add("e-de-table-border-inside-setting-click"),y.setSettingPreviewDivElement("two")):e===t+"_Three_Div"||e===t+"_Three_Div_Container"?(y.threeDiv.classList.add("e-de-table-border-inside-setting-click"),y.setSettingPreviewDivElement("three")):e===t+"_Left_Div"||e===t+"_Left_Div_Container"?(y.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),y.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),y.rightDiv.classList.remove("e-de-table-border-inside-setting-click"),y.setSettingPreviewDivElement("two","left")):e!==t+"_Right_Div"&&e!==t+"_Right_Div_Container"||(y.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),y.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),y.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),y.setSettingPreviewDivElement("two","right"))},this.applyColumnDialog=function(){y.documentHelper.selection.isEmpty||(y.documentHelper.owner.editorHistory&&y.documentHelper.owner.editor.initComplexHistory("InsertSectionBreak"),t=y.documentHelper.selection.getParagraphInfo(y.documentHelper.selection.start),e=y.documentHelper.selection.getParagraphInfo(y.documentHelper.selection.end),t=y.documentHelper.selection.getHierarchicalIndex(t.paragraph,t.offset.toString()),e=y.documentHelper.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),y.documentHelper.selection.select(e,e),y.documentHelper.owner.editorModule.insertSectionBreak(V.SectionBreakType.Continuous),y.documentHelper.selection.select(t,t),y.documentHelper.owner.editorModule.insertSectionBreak(V.SectionBreakType.Continuous));for(var e=new Ma,t=y.documentHelper.selection.sectionFormat,i=(e.bottomMargin=t.bottomMargin,e.topMargin=t.topMargin,e.leftMargin=t.leftMargin,e.rightMargin=t.rightMargin,e.pageWidth=t.pageWidth,e.pageHeight=t.pageHeight,e.differentOddAndEvenPages=t.differentOddAndEvenPages,e.differentFirstPage=t.differentFirstPage,e.headerDistance=t.headerDistance,e.footerDistance=t.footerDistance,e.numberOfColumns=y.numberOfColumns,e.equalWidth=y.equalCheckbox.checked,e.lineBetweenColumns=y.lineCheckbox.checked,[]),n=0;n<y.columns.length;n++){var r=new Da;r.width=j.convertPointToPixel(y.columns[parseInt(n.toString(),10)].width.value),r.space=j.convertPointToPixel(y.columns[parseInt(n.toString(),10)].space.value),i.push(r)}e.columns=i,e.breakCode=t.breakCode,y.documentHelper.owner.editorModule.onApplySectionFormat(void 0,e),y.documentHelper.owner.editorHistory&&y.documentHelper.owner.editorHistory.updateComplexHistory(),y.documentHelper.hideDialog()},this.documentHelper=e}xg.prototype.getModuleName=function(){return"TabDialog"},xg.prototype.initTabsDialog=function(e,t){var i=this.documentHelper.owner.containerId,i=(this.target=_.createElement("div",{id:i+"_tab",className:"e-de-tab"}),_.createElement("div",{className:"e-de-container-row"})),n=(this.target.appendChild(i),_.createElement("div",{innerHTML:e.getConstant("Tab stop position")+":",className:"e-de-para-dlg-heading"})),r=_.createElement("div",{className:"e-de-subcontainer-left"}),n=(r.appendChild(n),_.createElement("div",{className:"e-tab-list"})),o=(r.appendChild(n),t&&n.classList.add("e-de-rtl"),_.createElement("div",{className:"e-bookmark-textboxdiv"})),o=(n.appendChild(o),this.textBoxInput=_.createElement("input",{className:"e-input e-tab-textbox-input",attrs:{autofocus:"true"}}),this.textBoxInput.setAttribute("type","text"),this.textBoxInput.setAttribute("aria-label",e.getConstant("Tab stop position")),o.appendChild(this.textBoxInput),o.addEventListener("keyup",this.textBoxInputChange),this.textBoxInput.value=!_.isNullOrUndefined(this.tabStopList)&&0<this.tabStopList.length?this.tabStopList[0].displayText:"",_.createElement("div",{className:"e-tab-listViewDiv",attrs:{tabindex:"-1"}})),n=(o.setAttribute("aria-label",e.getConstant("TabMarkList")),n.appendChild(o),this.listviewInstance=new F.ListView({dataSource:this.tabStopList,fields:{text:"displayText"},cssClass:"e-bookmark-listview"}),this.listviewInstance.appendTo(o),this.listviewInstance.addEventListener("select",this.selectHandler),i.appendChild(r),_.createElement("div",{innerHTML:e.getConstant("Default tab stops")+":",className:"e-de-para-dlg-heading"})),o=_.createElement("div",{className:"e-de-subcontainer-right"}),r=(i.appendChild(o),_.createElement("div",{className:"e-de-dlg-container"})),i=_.createElement("input",{attrs:{type:"text"}}),n=(r.appendChild(n),r.appendChild(i),o.appendChild(r),this.defaultTabStopIn=new D.NumericTextBox({format:"# pt",value:this.documentHelper.defaultTabWidth,min:0,max:1584,step:1,enablePersistence:!1,placeholder:e.getConstant("Default tab stops")}),this.defaultTabStopIn.appendTo(i),_.createElement("div",{innerHTML:e.getConstant("Tab stops to be cleared")+":",className:"e-de-dlg-container"})),r=(o.appendChild(n),this.displayDiv=_.createElement("div",{className:"e-defaultTablabelDiv"}),this.documentHelper.owner.enableRtl?this.displayDiv.style.marginRight="20px":this.displayDiv.style.marginLeft="20px",o.appendChild(this.displayDiv),_.createElement("div",{className:"e-de-dlg-container"})),i=(this.target.appendChild(r),_.createElement("div",{innerHTML:e.getConstant("Alignment")+":",className:"e-de-para-dlg-heading"})),n=(r.appendChild(i),_.createElement("div",{styles:"display: flex;"})),o=(r.appendChild(n),_.createElement("div",{styles:"display: flex; flex-direction: column; width: 33.33%"})),i=_.createElement("div"),r=_.createElement("input",{attrs:{type:"radiobutton"}}),s=_.createElement("div"),a=_.createElement("input",{attrs:{type:"radiobutton"}}),i=(i.appendChild(r),s.appendChild(a),o.appendChild(i),o.appendChild(s),n.appendChild(o),this.left=new H.RadioButton({label:e.getConstant("Left"),name:"alignment",value:"left",cssClass:"e-small",checked:!0,enableRtl:t,change:this.onTabAlignmentButtonClick}),this.decimal=new H.RadioButton({label:e.getConstant("Decimal"),name:"alignment",value:"decimal",cssClass:"e-small",enableRtl:t,change:this.onTabAlignmentButtonClick}),this.left.appendTo(r),this.decimal.appendTo(a),r.setAttribute("aria-label",e.getConstant("Left")),a.setAttribute("aria-label",e.getConstant("Decimal")),_.createElement("div",{styles:"display: flex; flex-direction: column; width: 33.33%"})),s=_.createElement("div"),o=_.createElement("input",{attrs:{type:"radiobutton"}}),r=_.createElement("div"),a=_.createElement("input",{attrs:{type:"radiobutton"}}),s=(r.appendChild(a),s.appendChild(o),i.appendChild(s),i.appendChild(r),this.bar=new H.RadioButton({label:e.getConstant("Bar"),name:"alignment",value:"bar",cssClass:"e-small",enableRtl:t,change:this.onBarClick}),this.center=new H.RadioButton({label:e.getConstant("Center"),name:"alignment",value:"center",cssClass:"e-small",enableRtl:t,change:this.onTabAlignmentButtonClick}),this.bar.appendTo(a),this.center.appendTo(o),a.setAttribute("aria-label",e.getConstant("Bar")),o.setAttribute("aria-label",e.getConstant("Center")),n.appendChild(i),_.createElement("div",{styles:"display: flex; flex-direction: column;width: 33.33%"})),r=_.createElement("div"),a=_.createElement("input",{attrs:{type:"radiobutton"}}),o=(r.appendChild(a),s.appendChild(r),this.right=new H.RadioButton({label:e.getConstant("Right"),name:"alignment",value:"right",cssClass:"e-small",enableRtl:t,change:this.onTabAlignmentButtonClick}),this.right.appendTo(a),a.setAttribute("aria-label",e.getConstant("Right")),n.appendChild(s),_.createElement("div",{className:"e-de-dlg-container"})),i=_.createElement("div",{innerHTML:e.getConstant("Leader")+":",className:"e-de-para-dlg-heading"}),r=(o.appendChild(i),this.target.appendChild(o),_.createElement("div",{styles:"display: flex;"})),a=(o.appendChild(r),_.createElement("div",{styles:"display: flex; flex-direction: column; width: 33.33%"})),n=_.createElement("div"),s=_.createElement("input",{attrs:{type:"radiobutton"}}),i=_.createElement("div"),o=_.createElement("input",{attrs:{type:"radiobutton"}}),n=(n.appendChild(s),i.appendChild(o),a.appendChild(n),a.appendChild(i),this.none=new H.RadioButton({label:"1 "+e.getConstant("None"),name:"tabLeader",value:"none",cssClass:"e-small",checked:!0,enableRtl:t}),this.underscore=new H.RadioButton({label:"4 _____",name:"tabLeader",value:"underscore",cssClass:"e-small",enableRtl:t}),this.none.appendTo(s),this.underscore.appendTo(o),r.appendChild(a),_.createElement("div",{styles:"display: flex; flex-direction: column; width: 33.33%"})),i=_.createElement("div"),s=_.createElement("input",{attrs:{type:"radiobutton"}}),o=_.createElement("div"),a=_.createElement("input",{attrs:{type:"radiobutton"}}),s=(i.appendChild(s),o.appendChild(a),this.dotted=new H.RadioButton({label:"2 .......",name:"tabLeader",value:"dotted",cssClass:"e-small",enableRtl:t}),this.single=new H.RadioButton({label:"5 -------",name:"tabLeader",value:"single",cssClass:"e-small",enableRtl:t}),this.dotted.appendTo(s),this.single.appendTo(a),n.appendChild(i),n.appendChild(o),r.appendChild(n),_.createElement("div",{styles:"display: flex; flex-direction: column; width: 33.33%"})),a=_.createElement("div"),i=_.createElement("input",{attrs:{type:"radiobutton"}}),o=(a.appendChild(i),s.appendChild(a),this.Hyphen=new H.RadioButton({label:"3 -------",name:"tabLeader",value:"hyphen",cssClass:"e-small",enableRtl:t}),this.Hyphen.appendTo(i),r.appendChild(s),_.createElement("div",{className:"e-de-tab-button",styles:"display: flex;"})),n=(this.target.appendChild(o),_.createElement("table")),a=(o.appendChild(n),n.style.width="100%",n.insertRow()),t=a.insertCell(),i=_.createElement("div",{className:"e-de-tab-setBtn"}),r=(o.appendChild(i),_.createElement("button",{innerHTML:e.getConstant("Set"),attrs:{type:"button"}})),s=(r.setAttribute("aria-label",e.getConstant("Set")),i.appendChild(r),this.setButton=new H.Button({cssClass:"e-button-custom"}),this.setButton.appendTo(r),t.appendChild(i),r.addEventListener("click",this.setButtonClick),t.style.width="33.33%",t.style.display="table-cell",t=a.insertCell(),_.createElement("div",{className:"e-de-tab-clearBtn"})),n=(o.appendChild(s),_.createElement("button",{innerHTML:e.getConstant("Clear"),attrs:{type:"button"}})),i=(n.setAttribute("aria-label",e.getConstant("Clear")),s.appendChild(n),this.clearButton=new H.Button({cssClass:"e-button-custom"}),this.clearButton.appendTo(n),n.addEventListener("click",this.clearButtonClick),t.appendChild(s),t.style.width="33.33%",t.style.display="table-cell",t=a.insertCell(),_.createElement("div",{className:"e-de-tab-clearAllBtn"})),r=(o.appendChild(i),_.createElement("button",{innerHTML:e.getConstant("Clear All"),attrs:{type:"button"}}));r.setAttribute("aria-label",e.getConstant("Clear All")),i.appendChild(r),this.clearAllButton=new H.Button({cssClass:"e-button-custom"}),this.clearAllButton.appendTo(r),r.addEventListener("click",this.clearAllButtonClick),t.appendChild(i),t.style.width="33.33%",t.style.display="table-cell",this.selectedTabStop=!_.isNullOrUndefined(this.tabStopList)&&0<this.tabStopList.length?this.tabStopList[0]:void 0,this.updateButtons()},xg.prototype.getTabAlignmentValue=function(){return this.left.checked?"Left":this.center.checked?"Center":this.right.checked?"Right":this.decimal.checked?"Decimal":this.bar.checked?"Bar":"Left"},xg.prototype.getTabLeaderValue=function(){return this.none.checked?"None":this.dotted.checked?"Dot":this.Hyphen.checked?"Hyphen":this.underscore.checked?"Underscore":this.single.checked?"Single":"None"},xg.prototype.updateButtons=function(){_.isNullOrUndefined(this.selectedTabStop)?(this.updateTabAlignmentButton("Left"),this.updateTabLeaderButton("None")):(this.updateTabAlignmentButton(this.selectedTabStop.value.tabJustification),this.updateTabLeaderButton(this.selectedTabStop.value.tabLeader))},xg.prototype.updateTabLeaderButton=function(e){if(this.clearTabLeaderButton(),"Bar"!==this.getTabAlignmentValue())switch(e){case"None":this.none.checked=!0;break;case"Single":this.single.checked=!0;break;case"Dot":this.dotted.checked=!0;break;case"Hyphen":this.Hyphen.checked=!0;break;case"Underscore":this.underscore.checked=!0;break;default:this.none.checked=!0}},xg.prototype.updateTabAlignmentButton=function(e){switch(this.clearTabAlignmentButton(),e){case"Left":this.left.checked=!0;break;case"Center":this.center.checked=!0;break;case"Right":this.right.checked=!0;break;case"Decimal":this.decimal.checked=!0;break;case"Bar":return this.bar.checked=!0,this.clearTabLeaderButton(),void this.disableOrEnableTabLeaderButton(!0)}this.disableOrEnableTabLeaderButton(!1)},xg.prototype.clearTabLeaderButton=function(){this.none.checked=!1,this.single.checked=!1,this.dotted.checked=!1,this.Hyphen.checked=!1,this.underscore.checked=!1},xg.prototype.disableOrEnableTabLeaderButton=function(e){this.none.disabled=e,this.single.disabled=e,this.dotted.disabled=e,this.Hyphen.disabled=e,this.underscore.disabled=e},xg.prototype.clearTabAlignmentButton=function(){this.left.checked=!1,this.center.checked=!1,this.right.checked=!1,this.decimal.checked=!1,this.bar.checked=!1},xg.prototype.focusTextBox=function(e){this.textBoxInput.value=e;var t=this.textBoxInput;t.setSelectionRange(0,e.length),t.focus()},xg.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),t=(e.setLocale(this.documentHelper.owner.locale),this.localeValue=e,this.documentHelper.owner.editorModule.getTabsInSelection());this.tabStopList=[];for(var i=0;i<t.length;i++){var n={displayText:parseFloat(t[i].position.toFixed(2))+" pt",value:t[i].clone()};this.tabStopList.push(n)}this.initTabsDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=e.getConstant("Tabs"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.applyParagraphFormat,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-para-okay",isPrimary:!0}},{click:this.closeTabDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-para-cancel"}}],this.documentHelper.dialog.show()},xg.prototype.destroy=function(){this.target=void 0,this.textBoxInput=void 0,this.defaultTabStopIn=void 0,this.left=void 0,this.right=void 0,this.center=void 0,this.decimal=void 0,this.bar=void 0,this.none=void 0,this.dotted=void 0,this.single=void 0,this.Hyphen=void 0,this.setButton=void 0,this.clearButton=void 0,this.clearAllButton=void 0,this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.selectedTabStop=void 0,this.isBarClicked=void 0,this.removedItems=void 0,this.tabStopList=void 0,this.localeValue=void 0};var bg=xg;function xg(e){var s=this;this.isBarClicked=!1,this.removedItems=[],this.tabStopList=[],this.isAddUnits=!0,this.applyParagraphFormat=function(){if(s.defaultTabStopIn.value!==s.documentHelper.defaultTabWidth&&(s.documentHelper.defaultTabWidth=s.defaultTabStopIn.value),0<s.removedItems.length){for(var e=[],t=0;t<s.removedItems.length;t++)e.push(s.removedItems[parseInt(t.toString(),10)].value);s.documentHelper.owner.editorModule.removeTabStops(s.documentHelper.selection.getParagraphsInSelection(),e)}for(var i,n=_.isNullOrUndefined(s.selectedTabStop)?new Ka:s.selectedTabStop.value,r=(n.deletePosition=0,n.tabJustification=s.getTabAlignmentValue(),n.tabLeader=s.getTabLeaderValue(),[]),t=0;t<s.tabStopList.length;t++)r.push(s.tabStopList[parseInt(t.toString(),10)].value);_.isNullOrUndefined(s.selectedTabStop)&&"NaN"!==(i=j.getNumberFromString(s.textBoxInput.value)).toString()&&(n.position=i,r.push(n)),s.documentHelper.owner.editorModule.onApplyParagraphFormat("tabStop",r,!1,!1),s.closeTabDialog()},this.textBoxInputChange=function(e){for(var t=j.getNumberFromString(s.textBoxInput.value),i=0;i<s.tabStopList.length;i++){if(j.getNumberFromString(s.tabStopList[parseInt(i.toString(),10)].displayText)===t){s.selectedTabStop=s.tabStopList[parseInt(i.toString(),10)];break}s.selectedTabStop=void 0}s.isAddUnits=!1;var n=s.listviewInstance.dataSource.indexOf(s.selectedTabStop),n=0<=n?s.listviewInstance.dataSource[parseInt(n.toString(),10)]:void 0;s.listviewInstance.selectItem(n),s.isAddUnits=!0},this.setButtonClick=function(e){if(_.isNullOrUndefined(s.selectedTabStop)){o=parseFloat(j.getNumberFromString(s.textBoxInput.value).toFixed(2));if("NaN"!==o.toString()){for(var t=new Ka,i=(t.position=o,t.tabJustification=s.getTabAlignmentValue(),t.tabLeader=s.getTabLeaderValue(),[]),n=t.deletePosition=0;n<s.tabStopList.length;n++)i.push(s.tabStopList[parseInt(n.toString(),10)].value);var r=s.documentHelper.owner.editorModule.addTabStopToCollection(i,t,!0),t={displayText:parseFloat(o.toFixed(2))+" pt",value:t};s.tabStopList.splice(r,0,t),s.selectedTabStop=t,s.listviewInstance.dataSource=s.tabStopList,s.listviewInstance.refresh(),s.listviewInstance.selectItem(s.selectedTabStop)}}else{var o;(o=s.selectedTabStop.value).tabJustification=s.getTabAlignmentValue(),o.tabLeader=s.getTabLeaderValue()}},this.clearAllButtonClick=function(e){for(var t=0;t<s.tabStopList.length;t++)s.removedItems.push(s.tabStopList[parseInt(t.toString(),10)]);s.displayDiv.innerText=s.localeValue.getConstant("All"),s.tabStopList=[],s.listviewInstance.dataSource=[],s.listviewInstance.refresh(),s.selectedTabStop=void 0,s.textBoxInput.value="",s.updateButtons()},this.clearButtonClick=function(e){s.removedItems.push(s.selectedTabStop),s.displayDiv.innerText!==s.localeValue.getConstant("All")&&(""!==s.displayDiv.innerText&&(s.displayDiv.innerText+=", "),s.displayDiv.innerText+=s.selectedTabStop.displayText);var t=s.tabStopList.indexOf(s.selectedTabStop);t===s.tabStopList.length-1?(s.tabStopList.splice(t,1),s.selectedTabStop=s.tabStopList[t-1]):0===s.tabStopList.length?s.selectedTabStop=void 0:(s.tabStopList.splice(t,1),s.selectedTabStop=s.tabStopList[parseInt(t.toString(),10)]),s.listviewInstance.refresh(),_.isNullOrUndefined(s.selectedTabStop)?s.textBoxInput.value="":s.textBoxInput.value=!_.isNullOrUndefined(s.selectedTabStop)&&0<s.tabStopList.length?s.selectedTabStop.displayText:"",s.updateButtons()},this.closeTabDialog=function(){s.documentHelper.hideDialog()},this.selectHandler=function(e){s.isAddUnits&&s.focusTextBox(e.text),s.selectedTabStop=e.data,_.isNullOrUndefined(s.selectedTabStop)||"Bar"!==s.selectedTabStop.value.tabJustification||(s.isBarClicked=!0),s.updateButtons()},this.onBarClick=function(e){s.clearTabLeaderButton(),s.disableOrEnableTabLeaderButton(!0),s.isBarClicked=!0},this.onTabAlignmentButtonClick=function(e){s.disableOrEnableTabLeaderButton(!1),s.isBarClicked&&(s.updateTabLeaderButton("None"),s.isBarClicked=!1)},this.documentHelper=e}Object.defineProperty(h.prototype,"paragraph",{get:function(){return this.currentWidget.paragraph},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"isAtParagraphStart",{get:function(){return this.offset===this.owner.selectionModule.getStartOffset(this.paragraph)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"isAtParagraphEnd",{get:function(){return this.owner.selectionModule.isParagraphLastLine(this.currentWidget)&&this.offset===this.owner.selectionModule.getLineLength(this.currentWidget)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"isCurrentParaBidi",{get:function(){return!_.isNullOrUndefined(this.currentWidget.paragraph)&&this.currentWidget.paragraph.paragraphFormat.bidi},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"selection",{get:function(){return this.owner.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"hierarchicalPosition",{get:function(){return this.getHierarchicalIndexInternal()},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),h.prototype.clone=function(){var e=new h(this.owner);return e.currentWidget=this.currentWidget,e.offset=this.offset,e.location=this.location,e},h.prototype.containsRtlText=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t].isRightToLeft)return!0;return!1},h.prototype.setPositionForSelection=function(e,t,i,n){var r=!1;_.isNullOrUndefined(t)?this.currentWidget=e:(this.currentWidget=t.line,t.nextNode instanceof Z&&i>t.length&&(r=this.selection.isLastRenderedInline(t,t.length))),this.location=n,this.offset=r?this.selection.getParagraphLength(this.currentWidget.paragraph)+1:this.currentWidget.getOffset(t,i)},h.prototype.setPositionFromLine=function(e,t,i){this.currentWidget=e,this.offset=t,i instanceof nl&&this.location.copy(i)},h.prototype.setPosition=function(e,t){this.currentWidget=e,this.offset=t?this.selection.getStartOffset(e.paragraph):e.paragraph.lastChild.getEndOffset()+1,this.updatePhysicalPosition(!0)},h.prototype.setPositionInternal=function(e){this.currentWidget=e.currentWidget,this.offset=e.offset,this.location=e.location},h.prototype.setPositionForCurrentIndex=function(e){var e={index:e},t=this.getParagraphWidget(e);this.offset=parseFloat(e.index),this.setPositionParagraph(t,this.offset)},h.prototype.getPage=function(e){var t=e.index.indexOf(";"),i="0";return 0<=t&&(i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";","")),t=parseInt(i,10),this.documentHelper.pages[t]},h.prototype.getParagraphWidget=function(e){var t;if(!_.isNullOrUndefined(e.index))return t=this.getPage(e),this.getLineWidget(void 0,e,t)},h.prototype.getLineWidget=function(e,t,i){if(!_.isNullOrUndefined(t.index)){var n,r=t.index.indexOf(";"),o="0";if(0<=r&&(o=t.index.substring(0,r),t.index=t.index.substring(r).replace(";","")),"H"===o||"F"===o?e="H"===o?i.headerWidget:i.footerWidget:"FN"===o||"EN"===o?(s=t.index.indexOf(";"),n=t.index.substring(0,s),t.index=t.index.substring(s).replace(";",""),e=("FN"===o?i.footnoteWidget:i.endnoteWidget).bodyWidgets[n]):_.isNullOrUndefined(i)||(e=parseInt(o,10)<i.bodyWidgets.length?i.bodyWidgets[parseInt(o,10)]:i.bodyWidgets[0]),r=parseInt(o,10),e instanceof _d&&(r=t.index.indexOf(";"),o="0",o=t.index.substring(0,r),t.index=t.index.substring(r).replace(";",""),r=parseInt(o,10)),e instanceof dh&&r>=e.childWidgets.length&&(t.index="0;0",r=e.childWidgets.length-1),0<=r&&r<e.childWidgets.length){var s=e.childWidgets[r];if(s instanceof uh)return 0<t.index.indexOf(";")&&(t.index="0"),s;if(s instanceof Vd)return 0<t.index.indexOf(";")?this.getLineWidget(s,t):s instanceof K?this.getLineWidget(this.documentHelper.getFirstParagraphInFirstCell(s),t):s instanceof dh&&-1===t.index.indexOf(";")?this.documentHelper.getFirstParagraphInFirstCell(s.ownerTable).childWidgets[0]:void 0}else if(e.nextRenderedWidget instanceof Vd)return t.index="0",e.nextRenderedWidget instanceof K?this.documentHelper.getFirstParagraphInFirstCell(e.nextRenderedWidget).firstChild:this.getLineWidget(e.nextRenderedWidget,t)}},h.prototype.updatePhysicalPosition=function(e){this.currentWidget&&this.owner.isLayoutEnabled&&this.isUpdateLocation&&(this.location=this.selection.getPhysicalPositionInternal(this.currentWidget,this.offset,e))},h.prototype.isAtSamePosition=function(e){return this.currentWidget===e.currentWidget&&this.offset===e.offset},h.prototype.isInSameParagraphIndex=function(e){if(_.isNullOrUndefined(e))throw new Error("textPosition is undefined.");return this.paragraph.index===e.paragraph.index},h.prototype.isInSameParagraph=function(e){if(_.isNullOrUndefined(e))throw new Error("textPosition is undefined.");return this.paragraph===e.paragraph},h.prototype.isInSameListParagraph=function(e){if(_.isNullOrUndefined(e))throw new Error("textPosition is undefined.");return this.paragraph.paragraphFormat.listFormat.listId===e.paragraph.paragraphFormat.listFormat.listId},h.prototype.isExistBefore=function(e){if(_.isNullOrUndefined(e))throw new Error("textPosition is undefined.");var t,i;return this.currentWidget===e.currentWidget?this.offset<e.offset:(t=this.currentWidget.paragraph)===(i=e.currentWidget.paragraph)?t.childWidgets.indexOf(this.currentWidget)<i.childWidgets.indexOf(e.currentWidget):t.containerWidget===i.containerWidget?t.isInsideTable?t.associatedCell.childWidgets.indexOf(t)<i.associatedCell.childWidgets.indexOf(i):t.containerWidget.childWidgets.indexOf(t)<i.containerWidget.childWidgets.indexOf(i):this.owner.selectionModule.isExistBefore(t,i)},h.prototype.isExistAfter=function(e){if(_.isNullOrUndefined(e))throw new Error("textPosition is undefined.");var t;return this.currentWidget===e.currentWidget?this.offset>e.offset:this.currentWidget.paragraph===e.currentWidget.paragraph?this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget)>e.currentWidget.paragraph.childWidgets.indexOf(e.currentWidget):(t=this.currentWidget.paragraph,e=e.currentWidget.paragraph,!_.isNullOrUndefined(t)&&!_.isNullOrUndefined(e)&&(t.containerWidget instanceof z&&e.containerWidget instanceof z&&t.containerWidget===e.containerWidget?t.isInsideTable&&e.isInsideTable?t.associatedCell.childWidgets.indexOf(t)>e.associatedCell.childWidgets.indexOf(e):t.containerWidget.childWidgets.indexOf(t)>e.containerWidget.childWidgets.indexOf(e):this.owner.selectionModule.isExistAfter(t,e)))},h.prototype.getHierarchicalIndexInternal=function(){return this.getHierarchicalIndex(this.currentWidget,this.offset.toString())},h.prototype.getHierarchicalIndex=function(e,t){return e?e.getHierarchicalIndex(t):t},h.prototype.setPositionParagraph=function(e,t){this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},h.prototype.setPositionForLineWidget=function(e,t){var i,n,r=this.selection.getLineLength(e),o=e.paragraph.childWidgets.indexOf(e);e.isLastLine()&&(_.isNullOrUndefined(e.paragraph.bodyWidget.footNoteReference)?r+=1:r+=e.paragraph.bodyWidget.footNoteReference.text.length),r<t?(n=void 0,o>=e.paragraph.childWidgets.length-1?(i=this.selection.getNextRenderedBlock(e.paragraph))&&i.index===e.paragraph.index&&(n=i.firstChild):n=e.paragraph.childWidgets[o+1],this.setPositionForLineWidget(n,t-r)):t<0?(i=e.paragraph.childWidgets[o-1],n=this.selection.getLineLength(i)+t,this.setPositionForLineWidget(i,n)):(this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0))},h.prototype.moveNextPosition=function(e){_.isNullOrUndefined(e)&&(e=!0);var t=this.selection.getNextStartInline(this.currentWidget,this.offset);if(t instanceof Z&&0===t.fieldType&&!_.isNullOrUndefined(t.fieldEnd)){if(e)return this.moveNextPositionInternal(t),void this.moveNextPosition();var e=t.fieldEnd.line,i=t.fieldEnd,i=e.getOffset(i,1),e=this.getHierarchicalIndex(e,i.toString());if(h.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(),e))return void this.selection.end.moveToInline(t.fieldEnd,1);this.moveToInline(t.fieldEnd,1)}var i=this.selection.getNextValidOffset(this.currentWidget,this.offset),e=this.paragraph.childWidgets.indexOf(this.currentWidget),n=0;i>this.offset?(this.offset=i,t=(i=this.currentWidget.getInline(this.offset,n)).element,n=i.index,!_.isNullOrUndefined(t)&&n===t.length&&(t.nextNode instanceof Z||t.nextNode instanceof J)&&((i=this.selection.getNextValidElement(t.nextNode))instanceof Z&&1===i.fieldType||i instanceof J&&1===i.bookmarkType)&&(this.currentWidget=(t=i).line,this.offset=this.currentWidget.getOffset(t,this.documentHelper.isFormFillProtectedMode?0:1))):e+1<this.paragraph.childWidgets.length?((i=this.paragraph.childWidgets[e+1])&&(this.currentWidget=i,this.offset=this.selection.getStartLineOffset(this.currentWidget)),t=(e=this.currentWidget.getInline(this.offset,n)).element,n=e.index,t instanceof Z&&0===t.fieldType&&this.offset++):this.updateOffsetToNextParagraph(n,!1),this.updatePhysicalPosition(!0)},h.prototype.moveToPreviousParagraphInTable=function(e){var t=this.currentWidget.paragraph,e=t.isInsideTable?e.getPreviousSelectionCell(t.associatedCell):e.getPreviousParagraphBlock(t);_.isNullOrUndefined(e)||(this.currentWidget=e.childWidgets[e.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},h.prototype.updateOffsetToNextParagraph=function(e,t){var i=!1,n=void 0,r=this.paragraph.childWidgets.indexOf(this.currentWidget),r=(t?r+1<this.paragraph.childWidgets.length?(r=this.paragraph.childWidgets[r+1])&&(this.currentWidget=r,this.offset=1):(n=this.selection.getNextSelectionBlock(this.paragraph),_.isNullOrUndefined(n)||n.containerWidget instanceof N&&(i=!this.selection.start.paragraph.isInsideTable||!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,n.associatedCell).ownerTable.contains(n.associatedCell))):n=this.selection.getNextParagraphBlock(this.paragraph),!_.isNullOrUndefined(n)&&0<n.childWidgets.length&&(i?(this.currentWidget=n.childWidgets[n.childWidgets.length-1],this.offset=this.selection.getLineLength(this.currentWidget)+1):(this.currentWidget=n.firstChild,this.offset=t?1:this.selection.getStartLineOffset(this.currentWidget))),this.currentWidget.getInline(this.offset,e)),i=r.element;e=r.index,i instanceof Z&&0===i.fieldType&&this.offset++},h.prototype.updateOffsetToPrevPosition=function(e,t){var i=this.paragraph.childWidgets.indexOf(this.currentWidget),n=this.selection.getPreviousValidOffset(this.currentWidget.paragraph,this.offset);this.offset>n?this.offset=n:0<i?(n=this.paragraph.childWidgets[i-1])&&(this.currentWidget=n,i=this.currentWidget.getEndOffset(),this.offset=0<i?i-1:i):(n=void 0,i=!1,t?(n=this.selection.getPreviousSelectionBlock(this.paragraph),_.isNullOrUndefined(n)||n.containerWidget instanceof N&&(i=!this.selection.start.paragraph.isInsideTable||!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,n.associatedCell).ownerTable.contains(n.associatedCell))):n=this.selection.getPreviousParagraphBlock(this.paragraph),_.isNullOrUndefined(n)||(i?(this.currentWidget=n.firstChild,this.offset=this.selection.getStartLineOffset(this.currentWidget)):(this.currentWidget=n.childWidgets[n.childWidgets.length-1],this.offset=this.currentWidget.isEndsWithPageBreak||this.currentWidget.isEndsWithColumnBreak?this.currentWidget.getEndOffset()-1:this.currentWidget.getEndOffset()))),i=(t=this.currentWidget.getInline(this.offset,0)).element,t.index,i instanceof Z&&0===i.fieldType&&this.offset++,i instanceof Z&&(n=this.selection.getPreviousValidElement(i),_.isNullOrUndefined(n)||(this.currentWidget=(i=n).line,this.offset=this.currentWidget.getOffset(i,i.length),i instanceof Z&&0===i.fieldType&&this.offset--)),this.updatePhysicalPosition(!0)},h.prototype.moveToNextParagraphStartInternal=function(){var e=this.currentWidget.paragraph;_.isNullOrUndefined(this.selection.getNextParagraphBlock(e))||(this.currentWidget=this.selection.getNextParagraphBlock(e).firstChild,this.offset=this.selection.getStartOffset(e),this.updatePhysicalPosition(!0))},h.prototype.movePreviousPosition=function(){var e=this.currentWidget.getInline(this.offset,0),t=e.element,e=e.index;this.paragraph.childWidgets.indexOf(this.currentWidget);(t instanceof Z&&1===t.fieldType&&!_.isNullOrUndefined(t.fieldBegin)||t instanceof J&&1===t.bookmarkType)&&this.movePreviousPositionInternal(t),this.updateOffsetToPrevPosition(e,!1)},h.prototype.moveNextPositionInternal=function(e){var t;!_.isNullOrUndefined(e.fieldSeparator)&&(t=e.fieldSeparator,this.currentWidget=t.line,this.currentWidget!==e.fieldEnd.line||this.selection.hasValidInline(this.paragraph,t,e.fieldEnd))||(t=e.fieldEnd),this.currentWidget=t.line,this.offset=this.currentWidget.getOffset(t,1)},h.prototype.moveBackward=function(){var e=this.currentWidget.getInline(this.offset,0),t=e.element,e=e.index;if(!this.owner.selectionModule.isEmpty&&!_.isNullOrUndefined(t)){var i=this.selection.getNextRenderedElementBox(t,e);if(i instanceof Z&&0===i.fieldType){var n=this.owner.selectionModule.start.getHierarchicalIndexInternal(),r=i.fieldEnd.line.getOffset(i.fieldEnd,1),o=this.getHierarchicalIndex(i.fieldEnd.line,r.toString());if(!h.isForwardSelection(o,n))return void this.owner.selectionModule.start.setPositionParagraph(i.fieldEnd.line,r)}}if(t instanceof Z&&1===t.fieldType&&!_.isNullOrUndefined(t.fieldBegin)){n=this.owner.selectionModule.start.getHierarchicalIndexInternal(),r=t.line.getOffset(t,1),o=this.getHierarchicalIndex(t.line,r.toString());if(!h.isForwardSelection(n,o))return i=t.fieldBegin.line.getOffset(t.fieldBegin,0),this.currentWidget=t.fieldBegin.line,this.offset=i,void this.updatePhysicalPosition(!0);this.movePreviousPositionInternal(t)}this.updateOffsetToPrevPosition(e,!0)},h.prototype.moveForward=function(){var e=0,t=this.currentWidget.getInline(this.offset,e),i=t.element;if(e=t.index,!_.isNullOrUndefined(i)){if(!this.owner.selectionModule.isEmpty&&e===i.length&&i instanceof Z&&1===i.fieldType){var t=this.owner.selectionModule.start.getHierarchicalIndexInternal(),n=i.fieldBegin.line.getOffset(i.fieldBegin,0),r=this.getHierarchicalIndex(i.fieldBegin.line,n.toString());if(!h.isForwardSelection(t,r))return void this.owner.selectionModule.start.setPositionParagraph(i.fieldBegin.line,n)}i=this.selection.getNextRenderedElementBox(i,e)}if(i instanceof Z&&!_.isNullOrUndefined(i.fieldEnd)){t=this.owner.selectionModule.start.paragraph.getInline(this.owner.selectionModule.start.offset,0),r=t.element,n=t.index;if(this.selection.getNextRenderedElementBox(r,n)!==i)return i=i.fieldEnd,this.currentWidget=i.line,this.offset=this.currentWidget.getOffset(i,1),void this.updatePhysicalPosition(!0);this.moveNextPositionInternal(i)}else i instanceof Z&&(0===i.fieldType||1===i.fieldType)&&(this.currentWidget=i.line,this.offset=this.currentWidget.getOffset(i,1));e=0;var o,t=this.selection.getNextValidOffset(this.currentWidget,this.offset),r=this.selection.getLineLength(this.currentWidget),n=this.selection.isParagraphLastLine(this.currentWidget);this.offset<t?(this.offset=t,i=(o=this.currentWidget.getInline(this.offset,e)).element,e=o.index,!_.isNullOrUndefined(i)&&e===i.length&&i.nextNode instanceof Z&&(o=this.selection.getNextValidElement(i.nextNode))instanceof Z&&1===o.fieldType&&(this.offset=this.currentWidget.getOffset(i=o,1))):this.offset===t&&i instanceof Z&&1===i.fieldType&&i.previousNode instanceof Ic?this.offset=t:this.offset===t&&this.offset<r+1&&n?this.offset=r+1:this.updateOffsetToNextParagraph(e,!0),this.updatePhysicalPosition(!0)},h.prototype.moveToInline=function(e,t){this.currentWidget=e.line,this.offset=this.currentWidget.getOffset(e,t),this.updatePhysicalPosition(!0)},h.isForwardSelection=function(e,t){if(e===t)return!0;e=e.replace(/S;/g,""),t=t.replace(/S;/g,""),e=e.replace(/C;/g,""),t=t.replace(/C;/g,""),e=e.replace(/H;/g,""),t=t.replace(/H;/g,""),e=e.replace(/F;/g,""),t=t.replace(/F;/g,""),e=e.replace(/FN;/g,""),t=t.replace(/FN;/g,""),e=e.replace(/EN;/g,""),t=t.replace(/EN;/g,"");var i=e.split(";"),n=t.split(";"),r=i.length;r>n.length&&(r=n.length-1);for(var o=0;o<r;o++){var s=parseFloat(i[o]),a=parseFloat(n[o]);if(s!==a)return s<a}return!1},h.prototype.movePreviousPositionInternal=function(e){var e=e instanceof Z&&_.isNullOrUndefined(e.fieldSeparator)?this.selection.getPreviousValidElement(e.fieldBegin):this.selection.getPreviousValidElement(e),t=(this.currentWidget=e.line,e instanceof Z||e instanceof J&&1===e.bookmarkType?0:e.length);this.offset=this.currentWidget.getOffset(e,t)},h.prototype.moveToWordStartInternal=function(e){var t=this.currentWidget.getEndOffset(),i=this.currentWidget.paragraph,n=this.selection;if(2!==e||this.offset!==t&&this.offset!==t+1){if(this.offset===t+1)this.offset=t;else if(this.offset===n.getStartOffset(i)&&this.currentWidget===i.childWidgets[0]){t=n.getPreviousParagraphBlock(i);if(_.isNullOrUndefined(t))return;this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()}else{this.offset===n.getStartLineOffset(this.currentWidget)&&0<=(t=i.childWidgets.indexOf(this.currentWidget))-1&&(this.currentWidget=i.childWidgets[t-1],this.offset=this.currentWidget.getEndOffset());i=this.currentWidget.getInline(this.offset,0),t=i.element,i=i.index;this.getPreviousWordOffset(t,n,i,e,t instanceof Z&&1===t.fieldType,!1,!1,this)}1===e&&this.calculateOffset(),this.updatePhysicalPosition(!0)}},h.prototype.getNextWordOffset=function(e,t,i,n,r,o,s){e instanceof X?this.getNextWordOffsetSpan(e,t,i,n,r,o,s):e instanceof Ic?this.getNextWordOffsetImage(e,t,i,n,r,o,s):e instanceof Z&&0===e.fieldType?this.getNextWordOffsetFieldBegin(e,t,i,n,r,o,s):e instanceof Z&&2===e.fieldType||e instanceof J&&0===e.bookmarkType?this.getNextWordOffsetFieldSeparator(e,t,i,n,r,o,s):e instanceof Z&&1===e.fieldType||e instanceof J&&1===e.bookmarkType?this.getNextWordOffsetFieldEnd(e,t,i,n,r,o,s):e instanceof up&&this.getNextWordOffsetComment(e,t,i,n,r,o,s)},h.prototype.getNextWordOffsetFieldBegin=function(e,t,i,n,r,o,s){var a=e.line.getOffset(e,0);e.length;_.isNullOrUndefined(e.fieldSeparator)?this.getNextWordOffsetFieldEnd(e.fieldEnd,0,i,n,r,o,s):0===i?this.getNextWordOffsetFieldSeparator(e.fieldSeparator,0,i,n,r,o,s):_.isNullOrUndefined(e.fieldEnd)||((n=e.fieldSeparator).line.paragraph!==e.fieldEnd.line.paragraph||this.selection.hasValidInline(n.line.paragraph,n,e.fieldEnd)||(n=e.fieldEnd),this.getNextWordOffset(n,0,i,!(o.paragraph===e.line.paragraph&&o.offset===a),r,o,s),r&&!_.isNullOrUndefined(e.fieldSeparator)&&o.paragraph===e.line.paragraph&&o.offset===e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length)?o.setPositionParagraph(e.line,a):r||o.setPositionParagraph(e.fieldEnd.line,e.fieldEnd.line.getOffset(e.fieldEnd,e.fieldEnd.length)))},h.prototype.getNextWordOffsetImage=function(e,t,i,n,r,o,s){n?(o.setPositionParagraph(e.line,e.line.getOffset(e,t)),r=!1):0===t?(t=e.line.getOffset(e,0),r=!0,o.offset===t?_.isNullOrUndefined(e.nextNode)?o.setPositionParagraph(e.line,t+e.length):this.getNextWordOffset(e.nextNode,0,i,n,r,o,s):o.setPositionParagraph(e.line,t)):_.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)},h.prototype.getNextWordOffsetSpan=function(e,t,i,n,r,o,s){if("\t"===e.text||"\v"===e.text)n?(o.setPositionParagraph(e.line,e.line.getOffset(e,t)),r=!1):0===t?(r=!0,d=e.line.getOffset(e,0),o.offset===d?o.setPositionParagraph(e.line,d+e.length):o.setPositionParagraph(e.line,d)):_.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,s);else{var a=0;if(0===t&&r&&-1===j.wordSplitCharacters.indexOf(e.text[0]))o.setPositionParagraph(e.line,e.line.getOffset(e,t));else if(t<e.length){var l=0<t&&e.text.length-1>=t?e.text.slice(t,e.length):e.text;if(-1!==(a=-1===(a=j.indexOfAny(l,j.wordSplitCharacters))&&e.nextNode instanceof up&&_.isNullOrUndefined(e.nextNode.nextNode)?e.length:a))if(n)r=!1;else{var d=e.line.getOffset(e,a+t),h=[" ","　"];if(!s&&-1!==h.indexOf(l[a])||r||e.line.paragraph!==o.paragraph||d===o.offset){var c=!1;for(-1!==h.indexOf(l[a])&&-1===h.indexOf(l[a+1])&&(c=!0,a++);a<l.length&&!c&&-1!==j.wordSplitCharacters.indexOf(l[a]);)if(-1!==h.indexOf(l[++a])&&-1===h.indexOf(l[a+1])&&-1!==j.wordSplitCharacters.indexOf(l[a+1])){a++;break}r=!0;var p=void 0;_.isNullOrUndefined(e.nextNode)||(p=e.nextNode.text),a<l.length||!_.isNullOrUndefined(p)&&e.line==e.nextNode.line&&-1!==h.indexOf(l[l.length-1])&&-1===h.indexOf(p[0])||_.isNullOrUndefined(e.nextNode)?o.setPositionParagraph(e.line,e.line.getOffset(e,a+t)):this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)}else r=!0,o.setPositionParagraph(e.line,d)}else _.isNullOrUndefined(e.nextNode)?o.setPositionParagraph(e.line,e.line.getEndOffset()):this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)}else _.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)}},h.prototype.getNextWordOffsetFieldSeparator=function(e,t,i,n,r,o,s){_.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)},h.prototype.getNextWordOffsetComment=function(e,t,i,n,r,o,s){_.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)},h.prototype.getNextWordOffsetFieldEnd=function(e,t,i,n,r,o,s){var a=e.line.getOffset(e,0),l=a+e.length;o.offset===a&&(o.setPositionParagraph(e.line,l),_.isNullOrUndefined(e.nextNode))||!_.isNullOrUndefined(e.nextNode)&&(this.getNextWordOffset(e.nextNode,0,i,!1,r,o,s),o.offset!==l)||o.setPositionParagraph(e.line,a)},h.prototype.getPreviousWordOffset=function(e,t,i,n,r,o,s,a){e instanceof X?this.getPreviousWordOffsetSpan(e,t,i,n,r,o,s,a):e instanceof Ic?this.getPreviousWordOffsetImage(e,t,i,n,r,o,s,a):e instanceof Z&&0===e.fieldType?this.getPreviousWordOffsetFieldBegin(e,t,i,n,r,o,s,a):e instanceof Z&&2===e.fieldType?this.getPreviousWordOffsetFieldSeparator(e,t,i,n,r,o,s,a):e instanceof Z&&1===e.fieldType?this.getPreviousWordOffsetFieldEnd(e,t,i,n,r,o,s,a):e instanceof J?this.getPreviousWordOffsetBookMark(e,t,i,n,r,o,s,a):e instanceof Y&&e.previousNode?this.getPreviousWordOffsetSpan(e.previousNode,t,i,n,r,o,s,a):e instanceof up&&this.getPreviousWordOffsetComment(e,t,i,n,r,o,s,a)},h.prototype.getPreviousWordOffsetBookMark=function(e,t,i,n,r,o,s,a){var l;e.previousNode?e.previousNode instanceof X&&(l=e.previousNode,j.lastIndexOfAny(l.text,j.wordSplitCharacters)!==l.text.length-1?this.getPreviousWordOffset(l,t,i,n,r,o,s,a):a.setPositionParagraph(e.line,e.line.getOffset(e,0))):a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},h.prototype.getPreviousWordOffsetFieldEnd=function(e,t,i,n,r,o,s,a){var l,d=e.line.getOffset(e,0),h=d+e.length;_.isNullOrUndefined(e.fieldSeparator)?this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,0,n,r,o,s,a):0!==n||_.isNullOrUndefined(e.previousNode)?_.isNullOrUndefined(e.fieldBegin)||0===n||(l=e.previousNode,(_.isNullOrUndefined(l)||l.line.paragraph===e.fieldBegin.line.paragraph&&!t.hasValidInline(l.line.paragraph,l,e.fieldBegin))&&(l=e.fieldBegin),this.getPreviousWordOffset(l,t,l.length,n,!(a.paragraph===e.line.paragraph&&a.offset===h),o,s,a),s&&a.paragraph===e.line.paragraph&&a.offset===d?a.setPositionParagraph(e.line,h):s||a.setPositionParagraph(e.fieldBegin.line,e.fieldBegin.line.getOffset(e.fieldBegin,0))):(l=e.previousNode,this.getPreviousWordOffset(l,t,l.length,n,l instanceof Z&&1===l.fieldType,o,s,a))},h.prototype.getPreviousWordOffsetFieldSeparator=function(e,t,i,n,r,o,s,a){this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,e.fieldBegin.length,n,r,o,s,a)},h.prototype.getPreviousWordOffsetComment=function(e,t,i,n,r,o,s,a){var l;e.previousNode?0===e.commentType?(l=e.previousNode,e.previousNode instanceof X&&j.lastIndexOfAny(l.text,j.wordSplitCharacters)!==l.text.length-1?this.getPreviousWordOffset(l,t,i,n,r,o,s,a):this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,s,a)):a.setPositionParagraph(e.line,e.line.getOffset(e,1)):a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},h.prototype.getPreviousWordOffsetFieldBegin=function(e,t,i,n,r,o,s,a){var l=e.line.getOffset(e,0),d=l+e.length;a.offset===d&&a.setPositionParagraph(e.line,l),_.isNullOrUndefined(e.previousNode)?e.fieldSeparator?a.setPositionParagraph(e.line,e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length)):a.setPositionParagraph(e.line,t.getStartLineOffset(e.line)):(this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,!1,o,s,a),a.offset!==l||0===n||_.isNullOrUndefined(e.fieldSeparator)||a.setPositionParagraph(e.line,e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length)))},h.prototype.getPreviousWordOffsetImage=function(e,t,i,n,r,o,s,a){r?(a.setPositionParagraph(e.line,e.line.getOffset(e,i)),s=!1):i===e.length?(i=e.line.getOffset(e,e.length))===a.offset?a.setPositionParagraph(e.line,i-e.length):a.setPositionParagraph(e.line,i):_.isNullOrUndefined(e.previousNode)||this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,s,a)},h.prototype.getPreviousWordOffsetSpan=function(e,t,i,n,r,o,s,a){if("\t"===e.text||"\v"===e.text)r?s=!1:i===e.length?(s=!0,(d=e.line.getOffset(e,e.length))===a.offset?a.setPositionParagraph(e.line,d-e.length):a.setPositionParagraph(e.line,d)):_.isNullOrUndefined(e.previousNode)||this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,s,a);else{var l=0;if(!o){for(;0<i&&" "===e.text[i-1];)i--;a.setPositionParagraph(e.line,e.line.getOffset(e,i))}if(0<i)if(o=!0,0===i&&s&&-1===j.wordSplitCharacters.indexOf(e.text[0]))a.setPositionParagraph(e.line,e.line.getOffset(e,i)),s=!0;else{var d,h,c=e.text.length>i?e.text.slice(0,i):e.text;if(-1!==(l=j.lastIndexOfAny(c,j.wordSplitCharacters)))if(r)s=!1;else{for(;0<l&&s&&" "!==c[l]&&-1!==j.wordSplitCharacters.indexOf(c[l-1]);)l--;" "!==c[l]&&"　"!==c[l]&&s||l++,s=!0,0<l?(h=e.line.getOffset(e,l),e.line.paragraph===a.paragraph&&h===a.offset?this.getPreviousWordOffsetSpan(e,t,i,n,r,o,s,a):a.setPositionParagraph(e.line,h)):e.previousNode instanceof X?(d=e.previousNode.text,-1!==j.wordSplitCharacters.indexOf(e.text[0])&&-1===j.wordSplitCharacters.indexOf(d[d.length-1])?(h=e.line.getOffset(e,l),a.setPositionParagraph(e.line,h)):this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,s,a)):a.setPositionParagraph(e.line,e.line.getOffset(e,0))}else this.setPreviousWordOffset(e,t,i,n,r,o,s,a)}else this.setPreviousWordOffset(e,t,i,n,r,o,s,a)}},h.prototype.setPreviousWordOffset=function(e,t,i,n,r,o,s,a){e.previousNode instanceof mh&&e.line===e.previousNode.line?this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,s,a):a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},h.prototype.validateForwardFieldSelection=function(e,t){var i=new h(this.owner),n=(i.setPositionForCurrentIndex(e),i.isUpdateLocation=!1);for(this.selection.start.paragraph===this.selection.end.paragraph&&this.selection.start.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.selection.end.offset===this.selection.end.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.setPositionParagraph(this.selection.end.currentWidget,this.selection.end.offset+1);e!==t&&h.isForwardSelection(e,t);){if(!n)if(i.moveNextPosition(!1),e===i.getHierarchicalIndexInternal())break;var r=i.currentWidget.getInline(i.offset,0),o=r.element,r=r.index;if(!_.isNullOrUndefined(o)){var s=this.selection.start.getHierarchicalIndexInternal();if(r===o.length&&o instanceof Z&&1===o.fieldType){if(o.line.getOffset(o,0)===this.offset)return;var a=o.fieldBegin.line,l=a.getOffset(o.fieldBegin,0),d=this.getHierarchicalIndex(a,l.toString());h.isForwardSelection(s,d)||this.selection.start.setPositionParagraph(a,l)}s=this.selection.getNextRenderedElementBox(o,r);!_.isNullOrUndefined(s)&&s instanceof mh&&(o=s)}if(n=o instanceof Z&&0===o.fieldType&&!_.isNullOrUndefined(o.fieldEnd)){if(o.line.getOffset(o,0)===this.offset)return;d=o.fieldEnd,a=(d.line.paragraph,d.line.getOffset(d,1)),l=this.getHierarchicalIndex(d.line,a.toString());if(!h.isForwardSelection(l,t))return void this.moveToInline(o.fieldEnd,1);i.moveToInline(o.fieldEnd,1)}e=i.getHierarchicalIndexInternal()}},h.prototype.validateBackwardFieldSelection=function(e,t){for(var i=new h(this.owner),n=(i.setPositionForCurrentIndex(e),i.isUpdateLocation=!1),r=((n=this.selection.start.paragraph!==this.selection.end.paragraph&&this.selection.end.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.documentHelper.isSelectionChangedOnMouseMoved&&this.selection.isParagraphFirstLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getStartOffset(this.selection.start.paragraph)||(_.isNullOrUndefined(this.selection.start.paragraph.previousRenderedWidget)&&this.selection.start.paragraph===this.selection.end.paragraph&&this.selection.end.offset===this.selection.getStartOffset(this.selection.end.paragraph)||this.selection.start.paragraph!==this.selection.end.paragraph)&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.start.currentWidget.isLastLine()?!0:n)&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.start.currentWidget)&&this.selection.start.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+1),this.selection.start.getHierarchicalIndexInternal());e!==t&&h.isForwardSelection(t,e);){var o=i.currentWidget.getInline(i.offset,0),s=o.element,o=o.index;if(_.isNullOrUndefined(s)||(o=this.selection.getNextRenderedElementBox(s,o))instanceof Z&&0===o.fieldType&&(o=(a=o.fieldEnd.line).getOffset(o.fieldEnd,1),l=this.getHierarchicalIndex(a,o.toString()),h.isForwardSelection(l,r)||(this.selection.start.setPositionParagraph(a,o),r=l)),s instanceof Z&&1===s.fieldType&&!_.isNullOrUndefined(s.fieldBegin)){var a=s.fieldBegin.line,o=s.fieldBegin,l=a.getOffset(o,0),o=this.getHierarchicalIndex(a,l.toString());if(!h.isForwardSelection(t,o))return void this.moveToInline(s.fieldBegin,0);i.moveToInline(s.fieldBegin,0)}else i.movePreviousPosition();e=i.getHierarchicalIndexInternal()}},h.prototype.paragraphStartInternal=function(e,t){var i=e.getStartLineOffset(this.currentWidget);this.offset===i&&t?this.moveToNextParagraphInTableCheck()?this.moveToPreviousParagraphInTable(e):_.isNullOrUndefined(e.getPreviousParagraphBlock(this.currentWidget.paragraph))||(t=e.getPreviousParagraphBlock(this.currentWidget.paragraph),this.currentWidget=t.childWidgets[0],this.offset=e.getStartLineOffset(this.currentWidget)):(this.currentWidget=this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0],this.offset=i),this.calculateOffset()},h.prototype.calculateOffset=function(){var e=this.owner.selectionModule.start.getHierarchicalIndexInternal(),t=this.getHierarchicalIndexInternal();e!==t&&this.validateBackwardFieldSelection(e,t),this.updatePhysicalPosition(!0)},h.prototype.moveToParagraphStartInternal=function(e,t){for(var i=this.currentWidget.paragraph;i.previousSplitWidget;)i=i.previousSplitWidget;var n=e.getStartOffset(i),n=(this.offset===n&&t?this.moveToNextParagraphInTableCheck()?this.moveToPreviousParagraphInTable(e):_.isNullOrUndefined(e.getPreviousParagraphBlock(this.paragraph))||(this.currentWidget=e.getPreviousParagraphBlock(this.paragraph).firstChild,this.offset=e.getStartOffset(this.paragraph)):(this.currentWidget=i.firstChild,this.offset=e.getStartLineOffset(this.currentWidget)),this.owner.selectionModule.start.getHierarchicalIndexInternal()),t=this.getHierarchicalIndexInternal();n!==t&&this.validateBackwardFieldSelection(n,t),this.updatePhysicalPosition(!1)},h.prototype.moveToParagraphEndInternal=function(e,t){for(var i=this.currentWidget.paragraph;i.nextSplitWidget;)i=i.nextSplitWidget;this.currentWidget=i.childWidgets[i.childWidgets.length-1];var n=this.currentWidget.getEndOffset()+1;this.offset===n&&t?this.moveToNextParagraphInTableCheck()?this.moveToNextParagraphInTable():_.isNullOrUndefined(e.getNextParagraphBlock(this.currentWidget.paragraph))||(t=e.getNextParagraphBlock(this.currentWidget.paragraph),this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1):this.offset=n,this.calculateOffset()},h.prototype.moveUp=function(e,t){var i=this.currentWidget.paragraph,n=(this.moveToLineStartInternal(e,!0),this.movePreviousPosition(),void 0),r=this.currentWidget.paragraph;if(i.isInsideTable&&i!==r&&i.associatedCell!==r.associatedCell&&!_.isNullOrUndefined(r.associatedCell)&&i.associatedCell.ownerRow===r.associatedCell.ownerRow){var o=r.associatedCell.ownerRow;if(o.previousRenderedWidget instanceof dh){var s=e.getFirstCellInRegion(o.previousRenderedWidget,r.associatedCell,t,!0),a=e.getLastParagraph(s);this.setPosition(a.childWidgets[a.childWidgets.length-1],!1)}else{for(var l=o.ownerTable.previousRenderedWidget;(l=l instanceof K?e.getLastBlockInLastCell(l):l)instanceof K;);l instanceof G&&this.setPosition(l.childWidgets[l.childWidgets.length-1],!1)}}else!i.isInsideTable&&this.currentWidget.paragraph.isInsideTable?(s=e.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selectionModule.upDownSelectionLength,!0),a=e.getLastParagraph(s),this.setPosition(a.childWidgets[a.childWidgets.length-1],!1)):i.isInsideTable&&!_.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow.previousRenderedWidget!==i.associatedCell.ownerRow.previousSplitWidget&&i.associatedCell.ownerRow.previousRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow&&(s=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selectionModule.upDownSelectionLength,!0),a=e.getLastParagraph(s),this.setPosition(a.childWidgets[a.childWidgets.length-1],!1));n=e.getLineWidgetParagraph(this.offset,this.currentWidget),r=e.getTop(n);(this.currentWidget.isEndsWithPageBreak||this.currentWidget.isEndsWithColumnBreak)&&this.offset===this.currentWidget.getEndOffset()-1&&(t=this.location.x),e.updateTextPositionWidget(n,new nl(t,r),this,!1)},h.prototype.moveDown=function(e,t){var i=this.currentWidget.paragraph,n=this.currentWidget,r=(this.moveToLineEndInternal(e,!0),this.selection.getParagraphLength(this.currentWidget.paragraph)),r=(this.offset>r&&(this.offset=r),this.moveNextPosition(),void 0);if(i.isInsideTable&&i!==this.currentWidget.paragraph&&i.associatedCell!==this.currentWidget.paragraph.associatedCell&&!_.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow===this.currentWidget.paragraph.associatedCell.ownerRow){var o=this.currentWidget.paragraph.associatedCell.ownerRow;if((o=i.isInsideTable&&this.currentWidget.paragraph.isInsideTable&&1<i.associatedCell.cellFormat.rowSpan&&i.associatedCell.cellFormat.rowSpan+i.associatedCell.ownerRow.rowIndex===i.associatedCell.ownerTable.childWidgets.length?this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length-1]:o).nextRenderedWidget instanceof dh){var s=this.selection.getLastCellInRegion(o.nextRenderedWidget,this.currentWidget.paragraph.associatedCell,t,!1);this.setPosition(this.selection.getFirstParagraph(s).childWidgets[0],!0)}else{for(var a=this.selection.getNextRenderedBlock(o.ownerTable);(a=a instanceof K?this.selection.getFirstBlockInFirstCell(a):a)instanceof K;);a instanceof G&&this.setPosition(a.childWidgets[0],!0)}}else!i.isInsideTable&&this.currentWidget.paragraph.isInsideTable?(s=this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selectionModule.upDownSelectionLength,!1),this.setPosition(this.selection.getFirstParagraph(s).childWidgets[0],!0)):i.isInsideTable&&!_.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow.nextRenderedWidget!==i.associatedCell.ownerRow.nextSplitWidget&&i.associatedCell.ownerRow.nextRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow&&(s=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selectionModule.upDownSelectionLength,!0),this.setPosition(e.getFirstParagraph(s).childWidgets[0],!1));r=e.getLineWidgetParagraph(this.offset,this.currentWidget),o=this.selection.getTop(r);r!==n&&this.selection.updateTextPositionWidget(r,new nl(t,o),this,!1)},h.prototype.moveToLineStartInternal=function(e,t){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var i,n,t=e.getLineWidgetInternal(this.currentWidget,this.offset,t),t=e.getFirstElementInternal(t),r=(this.documentHelper.moveCaretPosition=1,e.getStartOffset(this.currentWidget.paragraph));_.isNullOrUndefined(t)&&this.offset>r?(n=(i=this.currentWidget.getInline(this.offset,0)).element,i.index,n instanceof X&&"\v"!==n.text&&(this.offset=r)):_.isNullOrUndefined(t)||(this.currentWidget=t.line,this.offset=this.currentWidget.getOffset(t,0),n=(i=this.currentWidget.getInline(this.offset,0)).element,i.index,n instanceof Z&&(r=e.getPreviousValidElement(n),_.isNullOrUndefined(r)||(this.currentWidget=(n=r).line,this.offset=this.currentWidget.getOffset(n,n.length),n instanceof Z&&this.offset--))),this.updatePhysicalPosition(!0)},h.prototype.moveToNextParagraphInTableCheck=function(){return!(!this.selection.start.paragraph.isInsideTable&&!this.paragraph.isInsideTable||this.selection.start.paragraph.associatedCell===this.paragraph.associatedCell&&!this.selection.isCellSelected(this.selection.start.paragraph.associatedCell,this.selection.start,this))},h.prototype.moveToWordEndInternal=function(e,t){var i=0,n=this.currentWidget.getEndOffset();if(this.selection.isParagraphFirstLine(this.currentWidget)&&(this.currentWidget.children[0]instanceof Y&&(i=1),this.currentWidget.children[1]instanceof Y)&&(i=2),this.offset+i!==n&&this.offset!==n+1||!_.isNullOrUndefined(this.currentWidget.nextLine)){var i=this.currentWidget.getInline(this.offset,0),r=i.element,i=i.index;this.getNextWordOffset(r,i,e,!1,!1,this,t)}else if(this.offset===n&&0!==e)this.setPositionParagraph(this.currentWidget,n+1);else{r=this.selection.getNextParagraphBlock(this.currentWidget.paragraph);if(_.isNullOrUndefined(r))return;this.currentWidget=r.childWidgets[0],this.offset=this.selection.getStartLineOffset(this.currentWidget),1===e&&(this.moveToNextParagraphInTableCheck()?this.moveToNextParagraphInTable():this.moveToWordEndInternal(e,t))}0!==e&&(i=this.owner.selectionModule.start.getHierarchicalIndexInternal())!==(n=this.getHierarchicalIndexInternal())&&this.validateForwardFieldSelection(i,n),this.updatePhysicalPosition(!0)},h.prototype.moveToNextParagraphInTable=function(){var e=this.currentWidget.paragraph,e=e.isInsideTable?this.selection.getNextSelectionCell(e.associatedCell):this.selection.getNextParagraphBlock(e);_.isNullOrUndefined(e)||(this.currentWidget=e.childWidgets[e.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},h.prototype.moveToPreviousParagraph=function(e){var t=e.getStartOffset(this.currentWidget.paragraph);this.offset!==t||_.isNullOrUndefined(e.getPreviousParagraphBlock(this.currentWidget.paragraph))||(t=e.getPreviousParagraphBlock(this.currentWidget.paragraph),this.currentWidget=t.childWidgets[0]),this.offset=e.getStartOffset(this.currentWidget.paragraph),this.updatePhysicalPosition(!0)},h.prototype.moveToPreviousLine=function(e,t){var i=this.getHierarchicalIndexInternal(),n=e.getLineWidgetParagraph(this.offset,this.currentWidget),r=(this.moveToLineStartInternal(e,!0),this.currentWidget.paragraph.isInsideTable?this.moveUpInTable(e):this.moveBackward(),e.getLineWidgetParagraph(this.offset,this.currentWidget)),o=e.getLeft(r),t=(t<=e.getWidth(r,!0)+o&&n!==r&&(o=e.getTop(r),n=new nl(t,o),e.updateTextPositionWidget(r,n,this,!0)),this.getHierarchicalIndexInternal());this.validateBackwardFieldSelection(i,t)},h.prototype.moveToLineEndInternal=function(e,t){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var i=e.getLineWidgetParagraph(this.offset,this.currentWidget),n=e.getFirstElementInternal(i),r=this.currentWidget.paragraph.paragraphFormat.bidi;if(this.documentHelper.moveCaretPosition=2,_.isNullOrUndefined(n)&&this.offset===e.getStartLineOffset(this.currentWidget))this.offset=e.getParagraphLength(this.paragraph)+1,this.updatePhysicalPosition(!0);else if(!_.isNullOrUndefined(n)){var n=void 0,o=(r&&this.containsRtlText(i)?(r=i.getEndOffset(),n=i.getInline(r,0).element):(n=i.children[i.children.length-1])instanceof Y&&2<i.children.length&&(n=i.children[i.children.length-3]),0);if(o+=n instanceof X?n.length:1,this.currentWidget=n.line,o===n.length&&_.isNullOrUndefined(n.nextNode)&&e.isParagraphLastLine(this.currentWidget)){r=e.getLineLength(this.currentWidget);this.offset=t?r+1:r}else{for(var s=n;!_.isNullOrUndefined(s)&&s.length===o&&s.nextNode instanceof Z;){var a=e.getNextValidElement(s.nextNode);s!==a&&(s=a,o=0),s instanceof Z&&0===s.fieldType&&!_.isNullOrUndefined(s.fieldEnd)&&(a=s,!_.isNullOrUndefined(a.fieldSeparator)&&(s=a.fieldSeparator,this.currentWidget=s.line,this.currentWidget!==a.fieldEnd.line||e.hasValidInline(this.currentWidget.paragraph,s,a.fieldEnd))||(s=a.fieldEnd),this.currentWidget=s.line),s instanceof Z&&(o=1)}o===s.length&&_.isNullOrUndefined(s.nextNode)&&o++,!t&&s instanceof mh&&"\v"===s.text&&o--,this.offset=this.currentWidget.getOffset(s,o)}this.updatePhysicalPosition(t)}},h.prototype.moveToNextLine=function(e){var t=this.selection,i=new h(this.owner),n=(i.setPositionInternal(this),this.getHierarchicalIndexInternal()),r=(t.getLineWidgetParagraph(this.offset,this.currentWidget),this.moveToLineEndInternal(t,!0),!i.isAtSamePosition(this)),o=(i.setPositionInternal(this),this.currentWidget.paragraph.isInsideTable?this.moveDownInTable(t):(this.moveNextPosition(),0!==this.offset&&this.moveForward()),t.getLineWidgetParagraph(this.offset,this.currentWidget)),s=t.getLeft(o),a=t.getFirstElementInternal(o),a=_.isNullOrUndefined(a)?t.getWidth(o,!0):t.getLeftInternal(o,a,1)-s,a=(s<e&&a/2<e-s?(a=t.getTop(o),a=new nl(e,a),t.updateTextPositionWidget(o,a,this,!0),t.getWidth(o,!0)<e-s&&this.moveToLineEndInternal(t,!0)):r&&this.currentWidget.paragraph.isInsideTable&&this.currentWidget===this.owner.selectionModule.start.currentWidget?this.setPositionInternal(i):r||this.moveToLineEndInternal(t,!0),this.getHierarchicalIndexInternal());this.validateForwardFieldSelection(n,a)},h.prototype.moveUpInTable=function(e){var t=!1,i=this.owner.selectionModule.end,n=!this.owner.selectionModule.isEmpty;if(t=i.paragraph.isInsideTable){var r=this.currentWidget.paragraph.associatedCell,o=i.paragraph.associatedCell,s=e.getContainerCellOf(o,r);if(t=s.ownerTable.contains(r)){e.getSelectedCell(o,s),r=e.getSelectedCell(r,s);var a,l,o=e.containsCell(s,this.currentWidget.paragraph.associatedCell),i=(i=e.isCellSelected(s,this,i))||this.currentWidget.paragraph===e.getFirstParagraph(s)&&this.isAtParagraphStart;if((o&&i||!o)&&!_.isNullOrUndefined(r.ownerRow.previousRenderedWidget))return a=r.ownerRow.previousRenderedWidget,a=e.getFirstCellInRegion(a,s,this.owner.selectionModule.upDownSelectionLength,!0),l=e.getLastParagraph(a),void this.setPosition(l.childWidgets[0],!0);(o&&i&&_.isNullOrUndefined(r.ownerRow.previousRenderedWidget)||!o)&&(n?(r=r.ownerRow.childWidgets[0],l=e.getFirstParagraph(r),this.setPosition(l.childWidgets[0],!0)):(r=r.ownerRow.childWidgets[r.ownerRow.childWidgets.length-1],l=e.getLastParagraph(r),this.setPosition(l.childWidgets[0],!1)))}}t||(a=e.getContainerCell(this.currentWidget.paragraph.associatedCell),n?(a=a.ownerRow.childWidgets[0],l=e.getFirstParagraph(a),this.setPosition(l.childWidgets[0],!0)):(a=a.ownerRow.childWidgets[a.ownerRow.childWidgets.length-1],l=e.getLastParagraph(a),this.setPosition(l.childWidgets[0],!1))),this.moveBackward()},h.prototype.moveDownInTable=function(e){var t=!1,i=this.owner.selectionModule.isEmpty||this.owner.selectionModule.isForward;if(t=this.owner.selectionModule.start.paragraph.isInsideTable){var n=this.owner.selectionModule.start.paragraph.associatedCell,r=this.currentWidget.paragraph.associatedCell,o=e.getContainerCellOf(n,r);if(t=o.ownerTable.contains(r)){e.getSelectedCell(n,o),r=e.getSelectedCell(r,o);var s,a,n=e.containsCell(o,this.currentWidget.paragraph.associatedCell),l=e.isCellSelected(o,this.owner.selectionModule.start,this);if((n&&l||!n)&&!_.isNullOrUndefined(r.ownerRow.nextRenderedWidget))return s=r.ownerRow.nextRenderedWidget,s=e.getLastCellInRegion(s,o,this.owner.selectionModule.upDownSelectionLength,!1),a=e.getLastParagraph(s),void this.setPosition(a.childWidgets[a.childWidgets.length-1],!1);(n&&l&&_.isNullOrUndefined(r.ownerRow.nextRenderedWidget)||!n)&&(i?(r=r.ownerRow.childWidgets[r.ownerRow.childWidgets.length-1],a=e.getLastParagraph(r),this.setPosition(a.childWidgets[a.childWidgets.length-1],!1)):(r=r.ownerRow.childWidgets[0],a=e.getFirstParagraph(r),this.setPosition(a.childWidgets[a.childWidgets.length-1],!0)))}}t||(s=e.getContainerCell(this.currentWidget.paragraph.associatedCell),i?(s=s.ownerRow.childWidgets[s.ownerRow.childWidgets.length-1],a=e.getLastParagraph(s),this.setPosition(a.childWidgets[a.childWidgets.length-1],!1)):s.ownerRow.nextRenderedWidget&&(s=s.ownerRow.nextRenderedWidget.childWidgets[0],a=e.getFirstParagraph(s),this.setPosition(a.childWidgets[a.childWidgets.length-1],!0))),this.moveForward()},h.prototype.destroy=function(){this.offset=void 0,this.isUpdateLocation=void 0,_.isNullOrUndefined(this.location)||this.location.destroy(),this.location=void 0,this.currentWidget=void 0,this.owner=void 0,this.documentHelper=void 0};var y=h;function h(e){this.location=new nl(0,0),this.isUpdateLocation=!0,this.owner=e,this.documentHelper=this.owner.documentHelper}Object.defineProperty(Ig.prototype,"left",{get:function(){return this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Ig.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),Ig.prototype.destroy=function(){this.widthIn=void 0,this.leftIn=void 0,this.floatingItems=[],this.floatingItems=void 0};var Cg=Ig;function Ig(e,t){this.leftIn=0,this.widthIn=0,this.color="",this.leftIn=e,this.widthIn=t}Object.defineProperty(Fg.prototype,"screenTip",{get:function(){return this.screenTipText},enumerable:!0,configurable:!0}),Object.defineProperty(Fg.prototype,"navigationLink",{get:function(){return this.linkInternal},enumerable:!0,configurable:!0}),Object.defineProperty(Fg.prototype,"localReference",{get:function(){return this.localRef},enumerable:!0,configurable:!0}),Object.defineProperty(Fg.prototype,"linkType",{get:function(){return this.typeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(Fg.prototype,"isCrossRef",{get:function(){return this.isCrossRefField},enumerable:!0,configurable:!0}),Fg.prototype.parseFieldValues=function(e,t){var i=e.split("\\o "),n=(2===i.length&&(this.screenTipText=this.parseFieldValue(i[1],'"'===i[1]?'"':void 0,t),this.screenTipText=this.screenTipText.substring(0,this.screenTipText.length-1),e=i[0],i=void 0),i=e.split(" "),!1),r=!0;if(t)for(var o=0;o<i.length;o++){var s=i[o];s.length<1||("\\t"===s||"\\l"===s?n=!0:"\\n"===s?this.opensNewWindow=!0:(s=this.parseFieldValue(s,'"'===s[0]?'"':void 0,t),n?(this.localRef=s,r=n=!1):this.linkInternal=r?this.parseFieldValue(e,'"'===e[0]?'"':void 0,t):s))}else this.localRef=i[0];this.setLinkType()},Fg.prototype.parseFieldValue=function(e,t,i){e=i?e.substring(1):e.substring(0);i=t?e.indexOf(t):-1;return i<0&&(i=e.length),e.substring(0,i).trim()},Fg.prototype.setLinkType=function(){_.isNullOrUndefined(this.linkInternal)||this.linkInternal.length<1?this.typeInternal="Bookmark":("www."===this.linkInternal.substring(0,4)?this.linkInternal="http://"+this.navigationLink:"@"===this.linkInternal[0]&&(this.linkInternal="mailto:"+this.navigationLink),"http://"===this.linkInternal.substring(0,7)||"https://"===this.linkInternal.substring(0,8)?this.typeInternal="WebPage":"mailto:"===this.linkInternal.substring(0,7)?this.typeInternal="Email":this.typeInternal="File")},Fg.prototype.destroy=function(){this.linkInternal=void 0,this.localRef=void 0,this.typeInternal=void 0,this.opensNewWindow=void 0,this.screenTipText=void 0};var kg=Fg;function Fg(e,t){this.linkInternal="",this.localRef="",this.opensNewWindow=!1,this.isCrossRefField=!1,this.screenTipText="";t=t.getFieldCode(e),e=t.toLowerCase();"hyperlink"===e.substring(0,9)?this.parseFieldValues(t.substring(9).trim(),!0):0===e.indexOf("ref ")&&e.match("\\h")?(this.parseFieldValues(t.substring(4).trim(),!1),this.isCrossRefField=!0):0===e.indexOf("pageref")&&this.parseFieldValues(t.substring(7).trim(),!1)}Tg.prototype.destroy=function(){this.width=void 0,this.height=void 0,this.alternatetext=void 0};var Pg=Tg;function Tg(e){this.width=0,this.height=0,this.width=e.width,this.height=e.height,this.alternatetext=e.alternateText}Object.defineProperty(Hg.prototype,"ownerListLevel",{get:function(){return this.ownerListLevelIn},set:function(e){this.ownerListLevelIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Hg.prototype,"modifiedListLevel",{get:function(){return this.modifiedListLevelIn},set:function(e){this.modifiedListLevelIn=e},enumerable:!0,configurable:!0}),Hg.prototype.destroy=function(){this.ownerListLevel=void 0,this.modifiedListLevel=void 0};var Sg=Hg;function Hg(e,t){this.ownerListLevelIn=void 0,this.modifiedListLevelIn=void 0,this.ownerListLevel=e,this.modifiedListLevel=t}Object.defineProperty(Wg.prototype,"ownerFormat",{get:function(){return this.ownerFormatIn},set:function(e){this.ownerFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Wg.prototype,"modifiedFormat",{get:function(){return this.modifiedFormatIn},set:function(e){this.modifiedFormatIn=e},enumerable:!0,configurable:!0}),Wg.prototype.destroy=function(){this.modifiedFormat&&this.modifiedFormat.destroy(),this.modifiedFormat=void 0,this.ownerFormat=void 0};var Ng=Wg;function Wg(e,t){this.ownerFormatIn=void 0,this.modifiedFormatIn=void 0,this.ownerFormat=e,this.modifiedFormat=t}Eg.prototype.revertChanges=function(e,t,i){var n=this.rowFormat.heightType,r=i.childWidgets[this.rowFormat.ownerBase.index];t.editorModule.tableResize.updateRowHeight(r,e?this.displacement:-this.displacement),t.documentHelper.layout.reLayoutTable(i),this.rowFormat.heightType!==this.rowHeightType&&(this.rowFormat.heightType=this.rowHeightType),this.rowHeightType=n};var Og=Eg;function Eg(e,t,i,n){this.startingPoint=t,this.rowFormat=i,this.rowHeightType=i.heightType,this.tableHierarchicalIndex=n.selectionModule.getHierarchicalIndex(e,"0")}Bg.prototype.copyProperties=function(e){e.tableHolder&&(this.tableHolder=e.tableHolder.clone()),e.tableFormat&&(this.tableFormat.leftIndent=e.tableFormat.leftIndent,this.tableFormat.preferredWidth=e.tableFormat.preferredWidth,this.tableFormat.preferredWidthType=e.tableFormat.preferredWidthType,this.tableFormat.allowAutoFit=e.tableFormat.allowAutoFit);for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[parseInt(t.toString(),10)],n=new Ag;n.gridBefore=i.rowFormat.gridBefore,n.gridBeforeWidth=i.rowFormat.gridBeforeWidth,n.gridBeforeWidthType=i.rowFormat.gridBeforeWidthType,n.gridAfter=i.rowFormat.gridAfter,n.gridAfterWidth=i.rowFormat.gridAfterWidth,n.gridAfterWidthType=i.rowFormat.gridAfterWidthType;for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[parseInt(r.toString(),10)],s=new Dg;s.columnIndex=o.columnIndex,s.columnSpan=o.cellFormat.columnSpan,s.preferredWidth=o.cellFormat.preferredWidth,s.preferredWidthType=o.cellFormat.preferredWidthType,n.cells.push(s)}this.rows.push(n)}this.tableHierarchicalIndex=this.owner.selectionModule.getHierarchicalIndex(e,"0")},Bg.prototype.destroy=function(){this.tableHierarchicalIndex=void 0,this.tableHolder&&(this.tableHolder.destroy(),this.tableHolder=void 0),this.tableFormat&&(this.tableFormat=null),this.rows&&(this.rows=[],this.rows=void 0)};var Lg=Bg;function Bg(e,t){this.tableHolder=new bp,this.tableFormat=new Mg,this.rows=[],this.owner=t,this.copyProperties(e)}function Rg(e){this.startingPoint=e}var Mg=function(){},Ag=function(){this.cells=[]},Dg=function(){},Ug=(Object.defineProperty(r.prototype,"owner",{get:function(){return this.ownerIn},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"editorHistory",{get:function(){return this.owner.editorHistoryModule},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"action",{get:function(){return this.actionIn},set:function(e){this.actionIn=e,this.owner.enableCollaborativeEditing&&!this.editorHistory.isUndoing&&0===this.cellOperation.length&&("DeleteColumn"===e||"DeleteCells"===e||"ClearCells"===e||"MergeCells"===e?(this.owner.selectionModule.isTableSelected(!0)||this.owner.selectionModule.isRowSelect())&&"ClearCells"!==e&&"MergeCells"!==e||(this.insertedText=L.Cell,this.deleteColumnOperation(this.action)):"Accept Change"===e||"Reject Change"===e?this.createAcceptRejectOperation(this.action):"SectionBreak"===e?(this.insertedText=L.Section_Break,this.type="NewPage"):"SectionBreakContinuous"===e&&(this.insertedText=L.Section_Break,this.type="Continuous"))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"modifiedProperties",{get:function(){return this.modifiedPropertiesIn},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"removedNodes",{get:function(){return this.removedNodesIn},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"selectionStart",{get:function(){return this.selectionStartIn},set:function(e){this.selectionStartIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"selectionEnd",{get:function(){return this.selectionEndIn},set:function(e){this.selectionEndIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"insertPosition",{get:function(){return this.insertPositionIn},set:function(e){this.insertPositionIn=e,!this.owner.enableCollaborativeEditing||this.owner.editorModule.isRemoteAction||""===e||_.isNullOrUndefined(e)||-1!==e.indexOf("C")||(this.insertIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(e))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"endPosition",{get:function(){return this.endPositionIn},set:function(e){this.endPositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"viewer",{get:function(){return this.ownerIn.viewer},enumerable:!0,configurable:!0}),r.prototype.updateSelection=function(){this.updateCollaborativeSelection(this.owner.selectionModule.start.clone(),this.owner.selectionModule.end.clone());var e=this.owner.selectionModule.getParagraphInfo(this.owner.selectionModule.start);this.selectionStart=this.owner.selectionModule.getHierarchicalIndex(e.paragraph,e.offset.toString()),e=this.owner.selectionModule.getParagraphInfo(this.owner.selectionModule.end),this.selectionEnd=this.owner.selectionModule.getHierarchicalIndex(e.paragraph,e.offset.toString())},r.prototype.updateCollaborativeSelection=function(e,t){var i;this.owner.enableCollaborativeEditing&&!this.owner.editorModule.isRemoteAction&&("RemoveEditRange"===this.action?(i=this.owner.selectionModule.getEditRangeStartElement(),e=(i=this.owner.selectionModule.getPosition(i)).startPosition,t=i.endPosition):this.updateTableSelection(e,t),this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(e),this.owner.selectionModule.isEndOffset=!0,this.endIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(t),this.owner.selectionModule.isEndOffset=!1,(i=this.owner.selectionModule.isForward)?this.startIndex-=this.owner.selectionModule.getTableRelativeValue(e,t):this.endIndex-=this.owner.selectionModule.getTableRelativeValue(t,e),!(i?e.paragraph.equals(t.paragraph)&&e.isAtParagraphStart:e.paragraph.equals(t.paragraph)&&t.isAtParagraphStart)&&e.paragraph.equals(t.paragraph)||(i?this.endIndex+=this.paraInclude(t):this.startIndex+=this.paraInclude(e)),this.owner.enableTrackChanges||this.splitOperationForDelete(e,t))},r.prototype.paraInclude=function(e){var t=this.owner.selectionModule.getParagraphInfo(e);return!(e.paragraph.getTotalLength()<t.offset)||e.paragraph.isInsideTable&&e.paragraph.equals(e.paragraph.associatedCell.lastChild)?0:1},r.prototype.updateTableSelection=function(e,t){var i,n=e,r=t;this.owner.selectionModule.isForward||(n=t,r=e),n.paragraph.isInsideTable?(t=this.owner.selectionModule.getFirstParagraph(n.paragraph.associatedCell),r.paragraph.isInsideTable?n.paragraph.associatedCell.equals(r.paragraph.associatedCell)||(i=this.owner.selectionModule.getLastParagraph(r.paragraph.associatedCell),n.setPosition(t.firstChild,!0),r.setPositionParagraph(i.lastChild,i.lastChild.getEndOffset()+1)):n.setPosition(t.firstChild,!0)):r.paragraph.isInsideTable&&(i=this.owner.selectionModule.getLastParagraph(r.paragraph.associatedCell),r.setPositionParagraph(i.lastChild,i.lastChild.getEndOffset()+1))},r.prototype.splitOperationForDelete=function(e,t){var i,n,r,o,s=e,a=t;this.owner.selectionModule.isForward||(s=t,a=e),s.paragraph.isInsideTable||!a.paragraph.isInsideTable||"BackSpace"!==this.action&&"Delete"!==this.action||this.owner.selectionModule.getLastBlockInLastCell(a.paragraph.associatedCell.ownerTable).associatedCell.equals(a.paragraph.associatedCell)||(t=this.startIndex,i=s.currentWidget,n=s.offset,s.setPosition(s.paragraph.firstChild,!0),this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(s),r=this.startIndex,o=this.owner.documentHelper.layout.getParentTable(a.paragraph.associatedCell.ownerTable),a=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},o).position,this.startIndex=a+1,this.cellOperation.push(this.getDeleteOperation(this.action)),this.startIndex=a+3,0!==n&&(this.pasteContent=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,s.currentWidget,s.offset,i,n,!1,!0),this.cellOperation.push(this.getPasteOpertion(this.pasteContent,t-r))),this.endIndex=a,this.startIndex=r,this.cellOperation.push(this.getDeleteOperation(this.action))),"PasteColumn"!==this.action&&"PasteOverwrite"!==this.action&&"PasteRow"!==this.action||(o=e.paragraph.associatedCell.ownerTable,this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},o).position,this.endIndex=this.startIndex+this.owner.selectionModule.getBlockLength(void 0,o,0,{done:!1},!0,void 0,void 0))},r.prototype.setBookmarkInfo=function(e){this.removedNodes.push({bookmark:e,startIndex:e.indexInOwner,endIndex:e.reference.indexInOwner})},r.prototype.setContentControlInfo=function(e){this.removedNodes.push({contentcontrol:e,startIndex:e.indexInOwner,endIndex:e.reference.indexInOwner})},r.prototype.setFormFieldInfo=function(e,t){this.removedNodes.push({formField:e,value:t})},r.prototype.setEditRangeInfo=function(e){this.removedNodes.push({editStart:e,startIndex:e.indexInOwner,endIndex:e.editRangeEnd.indexInOwner})},r.prototype.revertFormTextFormat=function(){var e=this.removedNodes[0],t=e.value,e=e.formField;this.editorHistory.isUndoing?(this.owner.editorModule.applyTextFormatInternal(e,t),this.editorHistory.recordChanges(this)):(t=j.formatText(e.formFieldData.format,t),this.owner.editorModule.applyTextFormatInternal(e,t),this.editorHistory.undoStack.push(this))},r.prototype.revertFormField=function(){var e=this.removedNodes[0],t=e.formField;t.formFieldData instanceof Fh?this.owner.editorModule.toggleCheckBoxFormField(t,!0,e.value):this.owner.editorModule.updateFormField(t,e.value)},r.prototype.revertContentControl=function(){var e,t=this.removedNodes[0],i=t.contentcontrol;this.editorHistory.isUndoing?(e=this.owner.editorModule.getMarkerData(i),this.documentHelper.contentControlCollection.push(i),this.markerData.push(e),i.line.children.splice(t.startIndex,0,i),this.markerData.push(e),i.reference.line.children.splice(t.endIndex,0,i.reference),this.owner.editorModule.updatePropertiesToBlock(i,!0),this.editorHistory.recordChanges(this),this.viewer.updateScrollBars(),this.owner.editorModule.fireContentChange()):(this.owner.editorModule.removeContentControlInternal(),this.editorHistory.undoStack.push(this))},r.prototype.revertBookmark=function(){var e,t,i=this.removedNodes[0],n=i.bookmark;this.editorHistory.isUndoing?(e=this.owner.editorModule.getMarkerData(n),this.documentHelper.bookmarks.add(n.name,n),this.markerData.push(e),n.line.children.splice(i.startIndex,0,n),(t=n.previousNode)instanceof Z&&!_.isNullOrUndefined(t.formFieldData)&&(t.formFieldData.name=n.name),this.markerData.push(e),n.reference.line.children.splice(i.endIndex,0,n.reference),this.editorHistory.recordChanges(this),!0===this.owner.documentEditorSettings.showBookmarks&&this.viewer.updateScrollBars(),this.owner.editorModule.fireContentChange()):(this.owner.editorModule.deleteBookmarkInternal(n),this.editorHistory.undoStack.push(this))},r.prototype.revertComment=function(){var e,t,i=this.insertPosition,n=this.removedNodes[0],r=!1;"ResolveComment"===this.action?(this.editorHistory.currentBaseHistoryInfo=this).owner.editorModule.resolveOrReopenComment(n,!n.isResolved):"EditComment"===this.action?(t=this.modifiedProperties[0],(e=(this.editorHistory.currentBaseHistoryInfo=this).owner.commentReviewPane.commentPane.comments.get(n)).commentText.innerText=t.text,t.text=n.text,n.text=e.commentText.innerText,this.owner.editorHistoryModule.updateHistory(),this.owner.fireContentChange()):("InsertCommentWidget"===this.action?r=this.editorHistory.isRedoing:"DeleteCommentWidget"===this.action&&(r=this.editorHistory.isUndoing),r?n&&(this.insertedElement=n.clone(),n.isReply?this.owner.editorModule.addReplyComment(n,this.insertPosition):this.owner.editorModule.addCommentWidget(n,!1,!0,!0)):(t=this.owner.editorModule.getCommentElementBox(i),this.owner.editorModule.deleteCommentWidget(t)))},r.prototype.revertEditRangeRegion=function(){var e,t=this.removedNodes[0],i=t.editStart;this.editorHistory.isUndoing?(e=""===i.user?i.group:i.user,this.owner.editorModule.updateRangeCollection(i,e),this.markerData.push(this.owner.editorModule.getMarkerData(i)),this.markerData.push(this.owner.editorModule.getMarkerData(i.editRangeEnd)),i.line.children.splice(t.startIndex,0,i),i.editRangeEnd.line.children.splice(t.endIndex,0,i.editRangeEnd),this.editorHistory.recordChanges(this)):(this.owner.editorModule.removeUserRestrictionsInternal(i),this.editorHistory.undoStack.push(this)),this.owner.editorModule.fireContentChange()},r.prototype.revert=function(){if("FormTextFormat"===this.action)this.revertFormTextFormat();else if("UpdateFormField"===this.action)this.revertFormField();else if("DeleteBookmark"===this.action)this.revertBookmark();else if("RemoveContentControl"===this.action)this.revertContentControl();else if("RemoveEditRange"===this.action)this.revertEditRangeRegion();else if("InsertCommentWidget"===this.action||"DeleteCommentWidget"===this.action||"ResolveComment"===this.action||"EditComment"===this.action)this.revertComment();else{"ListFormat"===this.action&&""!==this.owner.editorModule.listNumberFormat&&(t=(e=this.documentHelper.lists[0].abstractList.levels[this.owner.editorModule.listLevelNumber]).listLevelPattern,i=e.numberFormat,e.listLevelPattern=this.owner.editorModule.listLevelPattern,e.numberFormat=this.owner.editorModule.listNumberFormat,this.owner.editorModule.listLevelPattern=t,this.owner.editorModule.listNumberFormat=i),this.owner.isShiftingEnabled=!0;var e=void 0,t=void 0,i=this.selectionStart,n=this.selectionEnd,r=(this.collabStart=this.selectionStart,this.collabEnd=this.selectionEnd,y.isForwardSelection(i,n));if(0<this.modifiedProperties.length||"Selection"===this.action||"ClearCharacterFormat"===this.action||"ClearParagraphFormat"===this.action)e=_.isNullOrUndefined(i)?void 0:this.owner.selectionModule.getTextPosBasedOnLogicalIndex(i),t=_.isNullOrUndefined(n)?void 0:this.owner.selectionModule.getTextPosBasedOnLogicalIndex(n),this.owner.enableCollaborativeEditing&&this.updateCollaborativeSelection(e,t),this.revertModifiedProperties(e,t);else{this.owner.enableCollaborativeEditing&&(_.isNullOrUndefined(this.insertPosition)||(this.insertIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(this.insertPosition)),_.isNullOrUndefined(this.endPosition)||(o=this.owner.selection.getTextPosBasedOnLogicalIndex(this.insertPosition),s=this.owner.selection.getTextPosBasedOnLogicalIndex(this.endPosition),this.updateCollaborativeSelection(o,s)));var o=this.owner.selectionModule,s=this.removedNodes;if(0<this.removedNodes.length){if("InsertTable"===this.action&&this.editorHistory.isRedoing)for(var a=0;a<this.removedNodes.length;a++)this.insertedNodes.push(this.removedNodes[parseInt(a.toString(),10)]);this.isRemovedNodes=!0}else this.isRemovedNodes=!1;this.removedNodesIn=[],_.isNullOrUndefined(this.endPosition)&&(this.endPosition=this.insertPosition);var l=y.isForwardSelection(this.insertPosition,this.endPosition),d=o.getTextPosBasedOnLogicalIndex(l?this.insertPosition:this.endPosition),l=o.getTextPosBasedOnLogicalIndex(l?this.endPosition:this.insertPosition);if("RemoveRowTrack"===this.action&&this.editorHistory.isUndoing&&(this.owner.selectionModule.select(this.selectionEnd,this.selectionEnd),h=this.owner.selectionModule.start.paragraph===this.owner.editor.getLastParaForBodywidgetCollection(this.owner.selectionModule.start.paragraph),this.owner.selectionModule.start.paragraph.isInsideTable||h&&this.owner.selectionModule.end.paragraph.isEmpty()&&0<s.length&&s[0]instanceof K)&&(this.endRevisionLogicalIndex=this.selectionEnd),this.editorHistory.isUndoing&&(this.lastElementRevision&&_.isNullOrUndefined(this.isAcceptOrReject)&&0<s.length&&s[0]instanceof G&&s[0].isEmpty()||"Delete"===this.action&&this.editorHistory.currentHistoryInfo&&"RemoveHyperlink"===this.editorHistory.currentHistoryInfo.action&&this.lastElementRevision instanceof Z?this.endRevisionLogicalIndex=this.selectionEnd:this.lastElementRevision&&_.isNullOrUndefined(this.endRevisionLogicalIndex)?this.updateEndRevisionInfo():"RemoveRowTrack"===this.action&&(this.endRevisionLogicalIndex=this.selectionEnd)),"ClearRevisions"===this.action&&(u=o.getHyperlinkField(),this.isHyperlinkField&&!_.isNullOrUndefined(u)?(p=u.fieldSeparator.line.getOffset(u.fieldSeparator,1),l.setPositionParagraph(u.fieldSeparator.line,p),this.undoRevisionForElements(d,l,s[s.length-1]),g=u.fieldEnd,d.setPositionParagraph(g.line,g.line.getOffset(g,0)),l.setPositionParagraph(g.line,g.line.getOffset(g,1))):this.owner.selectionModule.select(this.selectionEnd,this.selectionEnd),this.undoRevisionForElements(d,l,s[s.length-1]),this.removedNodes.push(s[s.length-1]),s=[]),"Uppercase"===this.action)return o.selectPosition(d,l),(c=(this.editorHistory.currentBaseHistoryInfo=this).owner.editorModule).changeSelectedTextCase(o,d,l,this.action.toString(),s),void c.reLayout(o);if("Lowercase"===this.action)return o.selectPosition(d,l),(c=(this.editorHistory.currentBaseHistoryInfo=this).owner.editorModule).changeSelectedTextCase(o,d,l,this.action.toString(),s),void c.reLayout(o);if("CapitalizeEachWord"===this.action)return o.selectPosition(d,l),(c=(this.editorHistory.currentBaseHistoryInfo=this).owner.editorModule).changeSelectedTextCase(o,d,l,this.action.toString(),s),void c.reLayout(o);if("SentenceCase"===this.action)return o.selectPosition(d,l),(c=(this.editorHistory.currentBaseHistoryInfo=this).owner.editorModule).changeSelectedTextCase(o,d,l,this.action.toString(),s),void c.reLayout(o);if("ToggleCase"===this.action)return o.selectPosition(d,l),(c=(this.editorHistory.currentBaseHistoryInfo=this).owner.editorModule).changeSelectedTextCase(o,d,l,this.action.toString(),s),void c.reLayout(o);d.isAtSamePosition(l)?o.selectContent(d,!0):o.selectPosition(d,l),"InsertHyperlink"===this.action&&this.editorHistory.isRedoing&&(u=this.owner.selectionModule.getHyperlinkField(),_.isNullOrUndefined(u)||(p=u.line.getOffset(u,0),d.setPositionParagraph(u.line,p),this.owner.selectionModule.start.setPositionInternal(d),p=u.fieldEnd.line.getOffset(u.fieldEnd,1),l.setPositionParagraph(u.fieldEnd.line,p))),(this.editorHistory.currentBaseHistoryInfo=this).selectionStart=this.insertPosition,this.insertPosition=void 0,this.selectionEnd=this.endPosition,this.endPosition=void 0;var h=!1,c=!1,p=("DeleteCells"!==this.action&&"RemoveRowTrack"!==this.action||(c=!0),this.endRevisionLogicalIndex&&0<s.length&&(p=o.getTextPosBasedOnLogicalIndex(this.endRevisionLogicalIndex),(this.editorHistory.isUndoing&&!this.editorHistory.currentBaseHistoryInfo.isRevisionEndInAnotherCell||this.editorHistory.isRedoing&&d.isAtSamePosition(l))&&o.selectPosition(d,p),this.collabEnd=this.endRevisionLogicalIndex,this.owner.enableCollaborativeEditing&&(this.endIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(p),this.endIndex+=this.paraInclude(p)),this.editorHistory.isUndoing||this.editorHistory.isRedoing&&!this.owner.selectionModule.isEmpty&&0<s.length)&&(this.owner.editorModule.deleteSelectedContents(o,!0,c),h=!0),d.isAtSamePosition(l)||h?"SectionBreakContinuous"===this.action&&d&&this.editorHistory.isUndoing?0===d.offset&&!_.isNullOrUndefined(d.paragraph.previousRenderedWidget)&&d.paragraph.previousRenderedWidget instanceof G&&d.paragraph.previousRenderedWidget.isEndsWithPageBreak&&d.paragraph.containerWidget instanceof z&&d.currentWidget===d.currentWidget.paragraph.firstChild&&"NoBreak"===d.paragraph.containerWidget.sectionFormat.breakCode&&(p=d.paragraph.previousRenderedWidget.containerWidget,this.owner.editorModule.combineSectionInternal(this.owner.selectionModule,p,d.paragraph.containerWidget),this.owner.editorModule.layoutWholeDocument()):(h=!1,d.isAtSamePosition(l)||(h="BackSpace"===this.action||"Delete"===this.action||"ClearCells"===this.action||"DeleteCells"===this.action)):(h="BackSpace"===this.action||"Delete"===this.action||"ClearCells"===this.action||"DeleteCells"===this.action,p=0<s.length&&"ParaMarkTrack"===this.action||"ClearRevisions"===this.action||"AcceptTOC"===this.action,h||"MergeCells"===this.action||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"DeleteTable"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||(o.end.setPositionInternal(l),this.owner.selectionModule.isEmpty)||p||(this.editorHistory.isRedoing&&"Accept Change"!==this.action&&"ParaMarkTrack"!==this.action&&"ParaMarkReject"!==this.action&&"RemoveRowTrack"!==this.action?this.owner.editorModule.removeSelectedContents(o):(u=o.getHyperlinkField(),this.isHyperlinkField&&!_.isNullOrUndefined(u)&&this.editorHistory.isRedoing&&"Accept Change"===this.action?(g=u.fieldEnd,o.start.setPositionParagraph(u.line,u.line.getOffset(u,0)),o.end.setPositionParagraph(u.fieldSeparator.line,u.fieldSeparator.line.getOffset(u.fieldSeparator,1)),this.owner.editorModule.deleteSelectedContents(o,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.reverse(),o.start.setPositionParagraph(g.line,g.line.getOffset(g,0)),o.end.setPositionParagraph(g.line,g.line.getOffset(g,1)),this.owner.editorModule.deleteSelectedContents(o,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.reverse()):this.owner.editorModule.deleteSelectedContents(o,!0)),!_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.blockToShift&&this.documentHelper.layout.shiftLayoutedItems(!1))),this.editorHistory.isRedoing&&!h);h=!this.lastElementRevision&&h,this.revertModifiedNodes(s,p,r?i:n,i===n,r?n:i),h&&this.removeContent(d,l,c)}var u=!1,g=!1,o=(_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"Reject All"!==this.editorHistory.currentHistoryInfo.action&&"Accept All"!==this.editorHistory.currentHistoryInfo.action&&"Paste"!==this.editorHistory.currentHistoryInfo.action||(g=!0),("TrackingPageBreak"!==this.action&&((this.editorHistory.isUndoing||this.endRevisionLogicalIndex||"RemoveRowTrack"===this.action||g)&&_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||g)||("InsertRowAbove"===this.action||"Borders"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Accept Change"===this.action||"PasteColumn"===this.action||"PasteRow"===this.action||"PasteOverwrite"===this.action||"PasteNested"===this.action)&&(this.editorHistory.isRedoing||"Paste"===this.editorHistory.currentHistoryInfo.action))&&(t="RemoveRowTrack"===this.action&&this.editorHistory.isRedoing?(e=_.isNullOrUndefined(this.selectionStart)?void 0:this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.selectionStart),_.isNullOrUndefined(this.selectionEnd)?void 0:this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.selectionEnd)):(e=_.isNullOrUndefined(i)?void 0:this.owner.selectionModule.getTextPosBasedOnLogicalIndex(i),_.isNullOrUndefined(n)?void 0:this.owner.selectionModule.getTextPosBasedOnLogicalIndex(n)),"ModifyStyle"!==this.action&&this.owner.selectionModule.selectRange(e,t),this.documentHelper.updateFocus(),u=!0),this.owner.trackChangesPane.isTrackingPageBreak=!1,this.insertIndex);this.insertPosition=i,this.endPosition=n,"InsertHyperlink"===this.action&&(this.insertIndex=o),_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"Accept All"!==this.editorHistory.currentHistoryInfo.action&&"Reject All"!==this.editorHistory.currentHistoryInfo.action&&"RemoveComment"!==this.editorHistory.currentHistoryInfo.action||this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),this.owner.editorModule.reLayout(this.owner.selectionModule,this.owner.selectionModule.isEmpty),this.editorHistory.isUndoing&&"SectionBreak"===this.action&&(this.owner.editorModule.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.owner.editorModule.layoutWholeDocument(),this.owner.editorModule.isSkipOperationsBuild=!1),u&&this.documentHelper.scrollToPosition(this.owner.selectionModule.start,this.owner.selectionModule.end),this.highlightListText()}},r.prototype.highlightListText=function(){var e;_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||("ListCharacterFormat"===this.action||"ListSelect"===this.editorHistory.currentHistoryInfo.action&&"ListFormat"===this.action)&&(e=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.selectionStart).currentWidget,this.documentHelper.selection.highlightListText(e))},r.prototype.removeContent=function(e,t,i){(!_.isNullOrUndefined(e.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof z&&!_.isNullOrUndefined(t.paragraph.containerWidget)&&t.paragraph.containerWidget instanceof z||!_.isNullOrUndefined(e.paragraph.containerWidget)&&!_.isNullOrUndefined(t.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof N&&t.paragraph.containerWidget instanceof N&&!_.isNullOrUndefined(e.paragraph.bodyWidget)||!_.isNullOrUndefined(e.paragraph.containerWidget)&&!_.isNullOrUndefined(t.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof fc&&t.paragraph.containerWidget instanceof fc)&&(this.owner.selectionModule.selectRange(e,t),this.documentHelper.updateFocus(),e=!1,"BackSpace"!==this.action&&"Uppercase"!==this.action&&"RemoveRowTrack"!==this.action||(e=!0),this.owner.editorModule.deleteSelectedContents(this.owner.selectionModule,e,i))},r.prototype.updateEndRevisionInfo=function(){this.lastElementRevision=this.checkAdjacentNodeForMarkedRevision(this.lastElementRevision);var e=this.retrieveEndPosition(this.lastElementRevision),e=this.owner.selectionModule.getParagraphInfo(e),t=e.paragraph==this.owner.editor.getLastParaForBodywidgetCollection(e.paragraph);e.paragraph.isInsideTable&&e.paragraph==this.owner.selection.getLastParagraph(e.paragraph.associatedCell)&&(t=!0),e.paragraph.getLength()!=e.offset||t||e.offset++,this.endRevisionLogicalIndex=this.owner.selectionModule.getHierarchicalIndex(e.paragraph,e.offset.toString()),this.lastElementRevision.isMarkedForRevision=!1},r.prototype.retrieveEndPosition=function(e){var t=new y(this.owner),i=e.line.getOffset(e,0)+e.length;return t.setPositionFromLine(e.line,i),t},r.prototype.checkAdjacentNodeForMarkedRevision=function(e){for(var t,i=e.nextNode;!_.isNullOrUndefined(i)&&i.isMarkedForRevision;)i=(t=i).nextNode;return _.isNullOrUndefined(t)?e:t},r.prototype.revertModifiedProperties=function(e,t){"CellFormat"!==this.action&&"CellOptions"!==this.action&&"TableOptions"!==this.action||(this.owner.isShiftingEnabled=!1),_.isNullOrUndefined(e)||_.isNullOrUndefined(t)||this.owner.selectionModule.selectRange(e,t),this.documentHelper.updateFocus(),"RowResizing"===this.action||"CellResizing"===this.action?this.revertResizing():"CellOptions"===this.action||"TableOptions"===this.action?this.revertTableDialogProperties(this.action):"Selection"!==this.action&&this.revertProperties()},r.prototype.redoAction=function(){var e=this.owner.editorModule;switch(this.action=this.action,this.action){case"BackSpace":e.singleBackspace(this.owner.selectionModule,!0);break;case"Delete":e.singleDelete(this.owner.selectionModule,!0);break;case"DeleteTable":e.deleteTable();break;case"DeleteColumn":e.deleteColumn();break;case"DeleteRow":e.deleteRow();break;case"MergeCells":e.mergeSelectedCellsInTable();break;case"InsertRowAbove":e.insertRow(!0);break;case"InsertRowBelow":e.insertRow(!1);break;case"InsertColumnLeft":case"InsertColumnRight":e.insertColumn(!0);break;case"SectionBreak":e.insertSection(this.owner.selectionModule,!0);break;case"SectionBreakContinuous":e.insertSection(this.owner.selectionModule,!0,void 0,!0);break;case"TableAutoFitToContents":e.autoFitTable("FitToContents");break;case"TableAutoFitToWindow":e.autoFitTable("FitToWindow");break;case"TableFixedColumnWidth":e.autoFitTable("FixedColumnWidth");break;case"RemoveRowTrack":this.owner.selectionModule.handleAcceptReject(!0)}},r.prototype.revertModifiedNodes=function(e,t,i,n,r){var o,s,a,l;(!t||"BackSpace"!==this.action&&"Delete"!==this.action&&"DeleteTable"!==this.action&&"DeleteColumn"!==this.action&&"DeleteRow"!==this.action&&"InsertRowAbove"!==this.action&&"InsertRowBelow"!==this.action&&"InsertColumnLeft"!==this.action&&"InsertColumnRight"!==this.action&&"MergeCells"!==this.action&&"SectionBreak"!==this.action&&"SectionBreakContinuous"!==this.action&&"TableAutoFitToContents"!==this.action&&"TableAutoFitToWindow"!==this.action&&"TableFixedColumnWidth"!==this.action&&"PasteColumn"!==this.action&&"PasteOverwrite"!==this.action&&"PasteNested"!==this.action||(this.redoAction(),"SectionBreak"!==this.action&&"SectionBreakContinuous"!==this.action))&&0<e.length&&(this.editorHistory.isUndoing&&("RemoveRowTrack"===this.action||"DeleteCells"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||"MergeCells"===this.action)||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"ClearCells"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"TableAutoFitToContents"===this.action||"TableAutoFitToWindow"===this.action||"TableFixedColumnWidth"===this.action||"RemoveRowTrack"===this.action||"PasteColumn"===this.action||"PasteRow"===this.action||"PasteOverwrite"===this.action||"PasteNested"===this.action?(t=this.selectionStart,o=this.owner.editorModule.getBlock({index:t}).node,a=e[e.length-1],(o instanceof K||o.previousRenderedWidget instanceof K||o.isInsideTable)&&a instanceof K?(o instanceof G&&!o.isInsideTable?o=o.previousRenderedWidget:o instanceof G&&o.isInsideTable&&(o=o.associatedCell.ownerTable),o=o.combineWidget(this.viewer),this.owner.enableCollaborativeEditing&&(this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},o).position,this.endIndex=this.startIndex+this.owner.selectionModule.getBlockLength(void 0,o,0,{done:!1},!0,void 0,void 0),l=this.getDeleteOperation("Delete"),this.owner.enableTrackChanges&&(_.isNullOrUndefined(l.markerData)&&(l.markerData={}),l.markerData.isSkipTracking=!0),this.cellOperation.push(l)),this.owner.editorModule.insertTableInternal(o,a,!1),"PasteColumn"===this.action||"PasteRow"===this.action||"PasteOverwrite"===this.action||"PasteNested"===this.action?this.removedNodes.push(o):(e.splice(e.indexOf(a),1),0<e.length&&(!_.isNullOrUndefined(e[e.length-1])&&!_.isNullOrUndefined(a.nextRenderedWidget)&&a.nextRenderedWidget instanceof G&&(this.owner.selectionModule.start.setPositionParagraph(a.nextRenderedWidget.firstChild,0),this.owner.selectionModule.end.setPositionParagraph(a.nextRenderedWidget.firstChild,0)),this.insertRemovedNodes(e,e[e.length-1])))):a instanceof K&&"RemoveRowTrack"!==this.action?this.owner.editorModule.insertBlock(a):this.insertRemovedNodes(e,e[e.length-1])):(o=this.owner.editorModule.getBlock({index:i}).node,0<e.length&&("BackSpace"===this.action&&n||!(o instanceof K)&&!(o instanceof Xd))&&((a=e[0])instanceof z&&!_.isNullOrUndefined(e[1])&&(a=e[1]),(a="TrackingPageBreak"===this.action||("SectionBreak"===this.action||"SectionBreakContinuous"===this.action)&&a instanceof z||!_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action?e[1]:a)instanceof B&&((t=new G).characterFormat=a,this.owner.editorModule.insertNewParagraphWidget(t,!0),e.splice(e.indexOf(a),1),o=t),n=!1,_.isNullOrUndefined(this.isAcceptOrReject)||(n=!0,!_.isNullOrUndefined(this.owner.selectionModule.start.paragraph.nextRenderedWidget)&&this.owner.selectionModule.start.paragraph.nextRenderedWidget instanceof K&&(n=!1)),a instanceof G&&0<this.owner.selectionModule.start.offset&&!n&&(this.owner.editorModule.insertNewParagraphWidget(a,!0),0<a.characterFormat.removedIds.length&&this.owner.editorModule.constructRevisionFromID(a.characterFormat,void 0),e.splice(e.indexOf(a),1),_.isNullOrUndefined(o))&&(s=this.documentHelper.selection.getNextParagraphBlock(a.getSplitWidgets().pop()),this.owner.selectionModule.getNextRenderedBlock(a),t=this.owner.selectionModule.start.paragraph,!(s&&t&&t.bodyWidget instanceof z)||t.isInsideTable||this.owner.selectionModule.isinEndnote||this.owner.selectionModule.isinFootnote||t.bodyWidget.equals(s.bodyWidget)||(s=void 0),_.isNullOrUndefined(s))&&this.owner.selectionModule.selectParagraphInternal(a,!0),a instanceof K)&&0<this.owner.selectionModule.start.offset&&(n=e[e.length-1])instanceof G&&(this.owner.editorModule.insertNewParagraphWidget(n,!0),e.splice(e.indexOf(n),1),_.isNullOrUndefined(o))&&(s=this.documentHelper.selection.getNextParagraphBlock(n.getSplitWidgets().pop()),_.isNullOrUndefined(s))&&this.owner.selectionModule.selectParagraphInternal(n,!0),0<e.length&&(t=e[e.length-1],o instanceof K&&(o=o.combineWidget(this.viewer),t instanceof K)&&(this.owner.enableCollaborativeEditing&&(s=(a=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},o).position)+this.owner.selectionModule.getBlockLength(void 0,o,0,{done:!1},!0,void 0,void 0),(l=this.getDeleteOperation("Delete")).offset=a,l.length=s-a,this.cellOperation.push(l)),this.owner.editorModule.insertTableInternal(o,t,!0),e.splice(e.indexOf(t),1),this.insertPosition=i,o=(n=t.getSplitWidgets().pop()).nextRenderedWidget instanceof K?n.nextRenderedWidget:this.owner.editorModule.getBlock({index:i}).node),t instanceof G&&0<this.owner.selectionModule.start.offset&&this.owner.selectionModule.start.offset===this.owner.selectionModule.getLineLength(this.owner.selectionModule.start.paragraph.lastChild)?((s=this.owner.editorModule).insertNewParagraphWidget(t,!1),0<t.characterFormat.removedIds.length&&this.owner.editorModule.constructRevisionFromID(t.characterFormat,void 0),e.splice(e.indexOf(t),1),"Paste"!==this.action&&this.owner.selectionModule.start.paragraph!==t.containerWidget.lastChild&&s.removeBlock(this.owner.selectionModule.start.paragraph),a=this.documentHelper.selection.getNextParagraphBlock(t.getSplitWidgets().pop()),_.isNullOrUndefined(a)||t===t.containerWidget.lastChild?_.isNullOrUndefined(t)||this.owner.selectionModule.selectParagraphInternal(t,!1):this.owner.selectionModule.selectParagraphInternal(a,!0)):e[0]instanceof K&&1!==e.length&&(l=e[1])instanceof G&&l.isEmpty()&&e.splice(e.indexOf(l),1)),0<e.length&&(o instanceof K&&(o=o.combineWidget(this.viewer)),this.insertRemovedNodes(e,o,r))))},r.prototype.insertRemovedNodes=function(e,t,i){for(var n=!1,r=e.length-1;-1<r;r--){var o=e[r];if(this.isHyperlinkField&&!_.isNullOrUndefined(i)&&o instanceof Z&&1===o.fieldType&&(this.owner.selectionModule.start.setPositionInternal(this.owner.selectionModule.getTextPosBasedOnLogicalIndex(i)),this.owner.selectionModule.end.setPositionInternal(this.owner.selectionModule.start)),o instanceof mh)this.owner.editorModule.insertInlineInSelection(this.owner.selectionModule,o);else if(o instanceof G&&void 0===o.childWidgets)this.owner.selection.moveToNextParagraph();else if(o instanceof Qd)o instanceof dh?t instanceof K&&(t.childWidgets.splice(0,0,o),this.owner.editorModule.updateNextBlocksIndex(o,!0),0!==r&&e[r-1]instanceof dh||this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)):t instanceof K&&"RemoveRowTrack"!==this.action?this.owner.editorModule.insertBlockTable(this.owner.selectionModule,o,t):o instanceof G&&!o.isInsideTable&&"RemoveRowTrack"===this.action?this.owner.editorModule.insertNewParagraphWidget(o,!1):o instanceof K&&"RemoveRowTrack"===this.action?(this.owner.editorModule.insertTableInternal(o,o,!1,!0),!_.isNullOrUndefined(e[r-1])&&!_.isNullOrUndefined(o.nextRenderedWidget)&&o.nextRenderedWidget instanceof G&&(this.owner.selectionModule.start.setPositionParagraph(o.nextRenderedWidget.firstChild,0),this.owner.selectionModule.end.setPositionParagraph(o.nextRenderedWidget.firstChild,0))):this.owner.editorModule.insertBlock(o);else if(o instanceof B){var s=this.selectionStart,a=this.owner.editorModule.getBlock({index:s}).node;a instanceof G&&(0<o.removedIds.length?(a.characterFormat.removedIds=o.removedIds.slice(),this.owner.editorModule.constructRevisionFromID(a.characterFormat,!0)):0<a.characterFormat.revisions.length&&(a.characterFormat=o.cloneFormat()))}else if(o instanceof z)_.isNullOrUndefined(o.removedHeaderFooters)||0===o.removedHeaderFooters.length||(this.owner.documentHelper.headersFooters.splice(o.sectionIndex,0,o.removedHeaderFooters[0]),o.removedHeaderFooters=void 0),this.owner.editorModule.insertSection(this.owner.selectionModule,!(n=!0),!0,void 0,void 0,o.sectionFormat);else if("string"==typeof o&&"AcceptTOC"===this.action){var s=this.selectionStart,l=this.owner.editorModule.getBlock({index:s}).node,d=this.owner.editorModule.getBlock({index:this.selectionEnd}).node,h=this.owner.documentHelper.revisionsInternal.get(o);if(this.editorHistory.isUndoing){for(;l instanceof G&&l!==d;)this.owner.editorModule.insertRevisionForBlock(l,h.revisionType,!0,h),l=this.documentHelper.selection.getNextParagraphBlock(l.getSplitWidgets().pop());this.owner.editorModule.insertRevisionForBlock(d,h.revisionType,!0,h)}else for(;0<h.range.length;){var c=h.range[0],p=c.revisions.indexOf(h);0<=p&&(c.revisions.splice(p,1),p=h.range.indexOf(c),h.range.splice(p,1),this.owner.trackChangesPane.updateCurrentTrackChanges(h)),0===h.range.length&&this.owner.revisions.remove(h)}this.owner.editorModule.addRemovedNodes(h.revisionID)}}n&&this.owner.editorModule.layoutWholeDocument(!0)},r.prototype.undoRevisionForElements=function(e,t,i){var n=e.paragraph,r=t.paragraph,o=this.documentHelper.revisionsInternal.get(i),s=this.owner.selectionModule.getParagraphInfo(e).offset,a=this.owner.selectionModule.getParagraphInfo(t).offset,e=e.paragraph===t.paragraph,l=!1;if(this.editorHistory.isUndoing){for(;n!==r;){var l=!1,d=0,d=_.isNullOrUndefined(n.previousSplitWidget)?n.getLength():(s=n.previousSplitWidget.getLength()+1,n.previousSplitWidget.getLength()+n.getLength());this.owner.editorModule.applyRevisionForCurrentPara(n,s,d,i,!0),n=this.documentHelper.selection.getNextParagraphBlock(n),!_.isNullOrUndefined(n)&&!_.isNullOrUndefined(n.previousRenderedWidget)&&n.previousRenderedWidget instanceof G&&n.previousRenderedWidget.nextSplitWidget&&n===r&&(l=!0),n!==r&&(s=0)}n===r&&(e||(s=0),l&&(s=n.previousRenderedWidget.getLength()),this.owner.editorModule.applyRevisionForCurrentPara(n,s,a,i,!1))}else for(;0<o.range.length;){var h=o.range[0],c=h.revisions.indexOf(o);if(0<=c&&(h.revisions.splice(c,1),c=o.range.indexOf(h),o.range.splice(c,1),this.owner.trackChangesPane.updateCurrentTrackChanges(o)),0===o.range.length&&this.owner.revisions.remove(o),0<n.characterFormat.revisions.length&&this.editorHistory.isRedoing)for(var p=0;p<n.characterFormat.revisions.length;p++)0===n.characterFormat.revisions[p].range.length&&(n.characterFormat.revisions.splice(p,1),p--)}this.removedNodes.push(i)},r.prototype.revertResizing=function(){var e,t,i;"RowResizing"===(this.editorHistory.currentBaseHistoryInfo=this).action?this.modifiedProperties[0]instanceof Og&&(t=this.modifiedProperties[0].tableHierarchicalIndex,(i=this.owner.editorModule.getBlock({index:t}).node)instanceof K)&&this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing,this.owner,i):this.modifiedProperties[0]instanceof Lg&&(0===this.owner.selectionModule.selectedWidgets.length&&this.owner.selectionModule.highlightSelection(!0),t=(e=this.modifiedProperties[0]).tableHierarchicalIndex,(i=this.owner.editorModule.getBlock({index:t}).node)instanceof K)&&(t=this.owner.editorModule.tableResize,this.owner.editorModule.setOffsetValue(this.owner.selectionModule),i=i.combineWidget(this.owner.viewer),t.currentResizingTable=i,this.modifiedProperties.splice(0,1),this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(i=new Lg(i,this.owner),this.modifiedProperties.splice(0,0,i),this.owner.isLayoutEnabled=!1,t.applyProperties(t.currentResizingTable,e),t.currentResizingTable.isGridUpdated=!0,this.owner.isLayoutEnabled=!0,t.updateGridValue(t.currentResizingTable,!1),e.destroy())},r.prototype.revertTableDialogProperties=function(e){var t,i;this.owner.isShiftingEnabled=!1,(this.editorHistory.currentBaseHistoryInfo=this).currentPropertyIndex=0,"CellOptions"===e?(t=this.owner.selectionModule,i=this.modifiedProperties[0],this.owner.editorModule.updateCellMargins(t,i)):"TableOptions"===e&&this.owner.tableOptionsDialogModule.applyTableOptionsHelper(this.modifiedProperties[0]),this.currentPropertyIndex=0,this.owner.isShiftingEnabled=!0},r.prototype.addModifiedPropertiesForSection=function(e,t,i){var n;return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(n=this.modifiedProperties,n=this.currentPropertyIndex<n.length?n[this.currentPropertyIndex]:n[n.length-1],_.isNullOrUndefined(t)?(i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()):(i=n.getPropertyValue(t),n.copyFormat(e)),this.currentPropertyIndex++):_.isNullOrUndefined(t)?this.modifiedProperties.push(e.cloneFormat()):((n=new Ma).copyFormat(e),this.modifiedProperties.push(n)),i},r.prototype.addModifiedProperties=function(e,t,i){var n,r,o;return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],r=!1,e.ownerBase instanceof mh&&(o=this.modifiedNodeLength[this.currentPropertyIndex],e.ownerBase.length<o)&&(r=!0,this.modifiedNodeLength[this.currentPropertyIndex]=e.ownerBase.length,this.modifiedNodeLength.splice(this.currentPropertyIndex+1,0,o-e.ownerBase.length),(o=new B(void 0)).copyFormat(n),this.modifiedProperties.splice(this.currentPropertyIndex+1,0,o)),"ClearCharacterFormat"===this.action?this.editorHistory.isUndoing?(i=n,r||(this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--)):this.modifiedProperties.push(e.cloneFormat()):(i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()),this.currentPropertyIndex++):(_.isNullOrUndefined(t)?this.modifiedProperties.push(e.cloneFormat()):((o=new B(void 0)).copyFormat(e),this.modifiedProperties.push(o)),e.ownerBase instanceof mh?this.modifiedNodeLength.push(e.ownerBase.length):this.modifiedNodeLength.push(0)),i},r.prototype.buildCharacterFormatOperation=function(e,t){var i=this.owner.selectionModule.getElementPosition(e,!0).startPosition,n=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(i),e=(i.offset+=e.length,this.owner.selectionModule.getAbsolutePositionFromRelativePosition(i)),i=this.owner.sfdtExportModule.writeCharacterFormat(t,0,!0),t={action:"Format",offset:n,length:e-n,format:JSON.stringify(i),type:"CharacterFormat"};this.modifiedFormatOperation.push(t)},r.prototype.addModifiedPropertiesForParagraphFormat=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if("ClearParagraphFormat"===this.action)return this.editorHistory.isUndoing?(i=n,this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--):this.modifiedProperties.push(e.cloneFormat()),this.currentPropertyIndex++,i;if(_.isNullOrUndefined(t))return i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;if("listFormat"===t)return(i=new Xa(void 0)).copyFormat(n),n.listFormat=new ja(n),n.listFormat.copyFormat(e.listFormat),this.currentPropertyIndex++,i;if("tabStop"===t){i=[];for(var r=0;r<n.tabs.length;r++)i.push(n.tabs[r]);return(o=new Xa(void 0)).copyFormat(e),this.modifiedProperties[this.currentPropertyIndex]=o,this.currentPropertyIndex++,i}if("styleName"===t)return _.isNullOrUndefined(n.baseStyle)?void(_.isNullOrUndefined(e.baseStyle)||(n.baseStyle=new ul,n.baseStyle.copyStyle(e.baseStyle))):((i=new ul).copyStyle(n.baseStyle),this.currentPropertyIndex++,_.isNullOrUndefined(e.baseStyle)||(n.baseStyle=new ul,n.baseStyle.copyStyle(e.baseStyle)),i);i="borders"===t?n.borders.cloneFormat():0<=this.action.indexOf("Border")?n.borders.getBorder(t.replace("Border","")):n.getPropertyValue(t),n.copyFormat(e),this.currentPropertyIndex++}else{var o;_.isNullOrUndefined(t)?this.modifiedProperties.push(e.cloneFormat()):((o=new Xa(void 0)).copyFormat(e),this.modifiedProperties.push(o))}return i},r.prototype.getParagraohFormatOperation=function(e,t){var i;(1<this.modifiedProperties.length||0<this.modifiedFormatOperation.length)&&!_.isNullOrUndefined(e)&&(i=this.owner.selectionModule.setPositionForBlock(e,!0),this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(i),this.endIndex=this.startIndex+this.owner.selectionModule.getBlockLength(void 0,e,0,{done:!1},!0,void 0,void 0)-1,this.insertedFormat=t,(i=this.modifiedFormatOperation).push.apply(i,this.getActionInfo(!0)))},r.prototype.addModifiedPropertiesForContinueNumbering=function(e,t){var i;return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++):((i=new Xa).copyFormat(e),this.modifiedProperties.push(i)),t},r.prototype.addModifiedPropertiesForRestartNumbering=function(e,t){return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.listId:this.modifiedProperties[this.modifiedProperties.length-1]=e.listId,this.currentPropertyIndex++):this.modifiedProperties.push(e.listId),t},r.prototype.addModifiedPropertiesForList=function(e){var t,i;return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=i=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],i=new Sg(e,this.owner.editorModule.cloneListLevel(e)),this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=i:this.modifiedProperties[this.modifiedProperties.length-1]=i,this.currentPropertyIndex++):(this.modifiedProperties.push(new Sg(e,this.owner.editorModule.cloneListLevel(e))),t=e),t},r.prototype.revertProperties=function(){(this.editorHistory.currentBaseHistoryInfo=this).currentPropertyIndex=0;var e=this.getProperty();if(this.viewer.owner.editorModule.setOffsetValue(this.documentHelper.selection),"ClearCharacterFormat"===this.action||this.modifiedProperties[0]instanceof B){if("ListCharacterFormat"===this.action)return void this.owner.editorModule.updateListCharacterFormat(this.documentHelper.selection,e,void 0);this.owner.editorModule.updateSelectionCharacterFormatting(e,void 0,!1)}else if("ClearParagraphFormat"===this.action||this.modifiedProperties[0]instanceof Xa){if("ContinueNumbering"===this.action)return void this.owner.editorModule.revertContinueNumbering(this.owner.selectionModule,this.modifiedProperties[0]);if("StyleName"===this.action&&this.modifiedProperties[0]instanceof Xa)return void this.owner.editorModule.updateSelectionParagraphFormatting(e,this.modifiedProperties[0].baseStyle,!1);this.owner.editorModule.setPreviousBlockToLayout(),this.owner.editorModule.updateSelectionParagraphFormatting(e,void 0,!1)}else if("LinkToPrevious"===this.action&&this.modifiedProperties[0]instanceof Ma){var t=parseInt(this.selectionStart.split(";")[0]);this.owner.editorModule.updateHeaderFooters(e,void 0,t,this.modifiedProperties[0].removedHeaderFooters[0])}else if(this.modifiedProperties[0]instanceof Ma)this.owner.editorModule.updateSectionFormat(e,void 0);else{if("RestartNumbering"===this.action)return void this.owner.editorModule.restartListAtInternal(this.owner.selectionModule,this.modifiedProperties[0]);if(this.modifiedProperties[0]instanceof Pg){var t=this.modifiedProperties[0];this.insertedData={width:j.convertPixelToPoint(t.width),height:j.convertPixelToPoint(t.height),alternativeText:t.alternatetext},this.owner.selectionModule.updateImageSize(t)}else if(this.modifiedProperties[0]instanceof Sg){for(var i=new T,n=0;n<this.modifiedProperties.length;n++){var r=this.modifiedProperties[n];i.add(n,r)}this.editorHistory.updateListChanges(i),i.destroy(),i=void 0}else this.modifiedProperties[0]instanceof Fl?this.owner.editorModule.updateTableFormat(this.owner.selectionModule,e,void 0):this.modifiedProperties[0]instanceof Tl?(this.owner.isShiftingEnabled=!0,this.owner.editorModule.updateCellFormat(this.owner.selectionModule,e,void 0)):this.modifiedProperties[0]instanceof Ya?this.owner.editorModule.updateRowFormat(this.owner.selectionModule,e,void 0):"ModifyStyle"===this.action&&(t=this.modifiedProperties.pop(),this.owner.editor.updateStyleObject(t))}this.currentPropertyIndex=0,"ClearCharacterFormat"!==this.action&&"ClearParagraphFormat"!==this.action||this.owner.editorModule.getOffsetValue(this.documentHelper.selection)},r.prototype.addModifiedCellOptions=function(e,t,i){i=_.isNullOrUndefined(e.bottomMargin)&&_.isNullOrUndefined(e.topMargin)&&_.isNullOrUndefined(e.rightMargin)&&_.isNullOrUndefined(e.leftMargin)?this.copyCellOptions(i.tableFormat):this.copyCellOptions(e);return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=this.copyCellOptions(e):this.modifiedProperties[this.modifiedProperties.length-1]=this.copyCellOptions(e),this.currentPropertyIndex++):this.modifiedProperties.push(i),t},r.prototype.copyCellOptions=function(e){var t=new Tl;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t},r.prototype.addModifiedTableOptions=function(e){e=this.copyTableOptions(e);this.editorHistory.isUndoing||this.editorHistory.isRedoing?(this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties.splice(this.currentPropertyIndex,1,e):this.modifiedProperties.splice(this.modifiedProperties.length-1,1,e),this.currentPropertyIndex++):this.modifiedProperties.push(e)},r.prototype.copyTableOptions=function(e){var t=new Fl;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.cellSpacing=e.cellSpacing,t},r.prototype.getProperty=function(){switch(this.action){case"Bold":return"bold";case"Italic":return"italic";case"FontColor":return"fontColor";case"FontFamily":return"fontFamily";case"FontSize":return"fontSize";case"HighlightColor":return"highlightColor";case"BaselineAlignment":return"baselineAlignment";case"Strikethrough":return"strikethrough";case"Underline":return"underline";case"AfterSpacing":return"afterSpacing";case"BeforeSpacing":return"beforeSpacing";case"LeftIndent":return"leftIndent";case"RightIndent":return"rightIndent";case"FirstLineIndent":return"firstLineIndent";case"LineSpacingType":return"lineSpacingType";case"LineSpacing":return"lineSpacing";case"TextAlignment":return"textAlignment";case"ListFormat":return"listFormat";case"PageHeight":return"pageHeight";case"PageWidth":return"pageWidth";case"DifferentOddAndEvenPages":return"differentOddAndEvenPages";case"TableAlignment":return"tableAlignment";case"TableLeftIndent":return"leftIndent";case"DefaultCellSpacing":return"cellSpacing";case"LeftMargin":case"CellLeftMargin":case"DefaultCellLeftMargin":return"leftMargin";case"RightMargin":case"CellRightMargin":case"DefaultCellRightMargin":return"rightMargin";case"TopMargin":case"CellTopMargin":case"DefaultCellTopMargin":return"topMargin";case"BottomMargin":case"CellBottomMargin":case"DefaultCellBottomMargin":return"bottomMargin";case"CellContentVerticalAlignment":return"verticalAlignment";case"RowHeight":return"height";case"RowHeightType":return"heightType";case"RowHeader":return"isHeader";case"AllowBreakAcrossPages":return"allowBreakAcrossPages";case"TablePreferredWidth":case"CellPreferredWidth":return"preferredWidth";case"TablePreferredWidthType":case"CellPreferredWidthType":return"preferredWidthType";case"Shading":return"shading";case"StyleName":return"styleName";case"ParagraphBidi":case"TableBidi":return"bidi";case"ContextualSpacing":return"contextualSpacing";case"LinkToPrevious":return"linkToPrevious";case"LeftBorder":case"TopBorder":case"RightBorder":case"BottomBorder":case"HorizontalBorder":case"VerticalBorder":case"Borders":return this.action[0].toLowerCase()+this.action.slice(1);case"TabStop":return"tabStop"}},r.prototype.getCharacterPropertyValue=function(e,t){var i;return"bold"===e?i=t.bold:"italic"===e?i=t.italic:"fontColor"===e?i=t.fontColor:"fontFamily"===e?i=t.fontFamily:"fontSize"===e?i=t.fontSize:"highlightColor"===e?i=t.highlightColor:"baselineAlignment"===e?i=t.baselineAlignment:"strikethrough"===e?i=t.strikethrough:"underline"===e&&(i=t.underline),i},r.prototype.addModifiedTableProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(_.isNullOrUndefined(t))return i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i="shading"===t?n.shading:n.getPropertyValue(t),n.copyFormat(e),this.currentPropertyIndex++}else{t=new Fl;t.copyFormat(e),this.modifiedProperties.push(t)}return i},r.prototype.addModifiedRowProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n,r,o=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(this.owner.enableCollaborativeEditing&&1<this.modifiedProperties.length&&e.ownerBase&&(r=(s=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},e.ownerBase).position)+1,n={},_.isNullOrUndefined(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(n,o,0),r={action:"Format",offset:s,length:r-s,format:JSON.stringify(n),type:"RowFormat"},this.modifiedFormatOperation.push(r)),_.isNullOrUndefined(t))return i=o,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i=o.getPropertyValue(t),o.copyFormat(e),this.currentPropertyIndex++}else{var s=new Ya;s.copyFormat(e),this.modifiedProperties.push(s)}return i},r.prototype.addModifiedCellProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(_.isNullOrUndefined(t))return i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i="shading"===t?n.shading:n.getPropertyValue(t),n.copyFormat(e),this.currentPropertyIndex++}else{t=new Tl;t.copyFormat(e),this.modifiedProperties.push(t)}return i},r.prototype.destroy=function(){if(this.selectionStart=void 0,this.selectionEnd=void 0,this.insertPosition=void 0,this.endPosition=void 0,_.isNullOrUndefined(this.modifiedNodeLength)||(this.modifiedNodeLength=[],this.modifiedNodeLength=void 0),!_.isNullOrUndefined(this.modifiedProperties)){for(var e=0;e<this.modifiedProperties.length;e++){var t=this.modifiedProperties[e];(t instanceof B||t instanceof Xa||t instanceof Ma||t instanceof Sg)&&t.destroy(),this.modifiedProperties.splice(this.modifiedProperties.indexOf(t),1),e--}this.modifiedPropertiesIn=void 0}if(!_.isNullOrUndefined(this.removedNodes)){for(e=0;e<this.removedNodes.length;e++)(i=this.removedNodes[e])instanceof G?i.destroyInternal(this.viewer):i instanceof mh&&!(i instanceof up)&&i.destroy(),this.removedNodes.splice(this.removedNodes.indexOf(i),1),e--;this.removedNodesIn=void 0}if(!_.isNullOrUndefined(this.insertedNodes)){for(var i,e=0;e<this.insertedNodes.length;e++)(i=this.insertedNodes[e])instanceof G?i.destroyInternal(this.viewer):i instanceof mh&&!(i instanceof up)&&i.destroy(),this.insertedNodes.splice(this.insertedNodes.indexOf(i),1),e--;this.insertedNodes=void 0}this.ownerIn=void 0},r.prototype.recordInsertRevisionDeletetion=function(e,t,i){this.startIndex>this.endIndex&&(o=this.startIndex,this.startIndex=this.endIndex,this.endIndex=o);var n=this.startIndex,r=this.endIndex;if(e instanceof X||e instanceof Ic||e instanceof Z||e instanceof J){if(0<e.revisions.length){var o=this.owner.selectionModule.getElementPosition(e,!0).startPosition,s=(t=_.isNullOrUndefined(t)?0:t,i=_.isNullOrUndefined(i)?e.length:i,o.setPositionParagraph(e.line,t+o.offset),this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(o),this.endIndex=this.startIndex+i,this.owner.editorModule.retrieveRevisionInOder(e)),a=""===this.owner.currentUser?"Guest user":this.owner.currentUser;if("Insertion"===s.revisionType&&s.author!==a)this.revisionOperation.push(this.getFormatOperation());else if("Insertion"===s.revisionType){var l=this.getDeleteOperation("Delete",void 0,void 0);this.revisionOperation.push(l),r-=l.length}else if("Deletion"===s.revisionType&&s.author!==a){l=this.getFormatOperation(e);if(0<e.removedIds.length)for(var d=0;d<e.removedIds.length;d++)_.isNullOrUndefined(l.markerData.removedIds)||(l.markerData.removedIds=[]),l.markerData.removedIds.push(e.removedIds[d]);this.revisionOperation.push(l)}}}else if(e instanceof G){for(var h=!0,d=0;d<e.childWidgets.length;d++){var c=e.childWidgets[d];0===c.children.length&&(h=!1);for(var p=0;p<c.children.length;p++){var u=c.children[p];(u.revisions.length<=0||"Insertion"!==u.revisions[0].revisionType)&&(h=!1)}}if(h){t=new y(this.owner),o=(t.setPositionParagraph(e.childWidgets[0],0),this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(t),this.owner.selectionModule.getBlockLength(void 0,e,0,{done:!1},!0,void 0,void 0));(a=""===this.owner.currentUser?"Guest user":this.owner.currentUser)===(s=this.owner.editorModule.retrieveRevisionInOder(e.childWidgets[0].children[0])).author&&(this.endIndex=this.startIndex+o,this.revisionOperation.push(this.getDeleteOperation(this.action,void 0,this.getRemovedText(e))),r-=o)}else for(d=0;d<e.childWidgets.length;d++)for(p=0;p<e.childWidgets[d].children.length;p++)this.recordInsertRevisionDeletetion(e.childWidgets[d].children[p]),n=this.startIndex,r=this.endIndex}this.startIndex=n,this.endIndex=r},r.prototype.getDeleteOperationsForTrackChanges=function(){var e=[],t=this.startIndex,i=this.endIndex;this.insertIndex;this.startIndex=t,this.endIndex=i;for(var n=0;n<this.revisionOperation.length;n++)"Format"==this.revisionOperation[n].action&&_.isNullOrUndefined(this.revisionOperation[n].markerData)&&(this.revisionOperation[n].markerData=this.markerData.pop()),e.push(this.revisionOperation[n]);for(n=this.removedNodes.length-1;0<=n;n--){var r,o=this.removedNodes[n];if(o instanceof X||o instanceof Ic||o instanceof Z||o instanceof J){if(0===o.removedIds.length){var s=this.getFormatOperation();if(!_.isNullOrUndefined(s.markerData))for(var a=0;a<this.markerData.length;a++)"Deletion"===this.markerData[a].revisionType&&(_.isNullOrUndefined(s.markerData.splittedRevisions)&&(s.markerData.splittedRevisions=[]),this.checkValidRevision(this.markerData[a].revisionId)&&s.markerData.splittedRevisions.push(this.markerData[a]),this.markerData.splice(a,1),a--);e.push(s);break}}else if(o instanceof G)if(0<o.characterFormat.revisions.length)e.push(this.getDeleteOperation(this.action));else{if(0<o.characterFormat.removedIds.length){(s=this.getDeleteOperation(this.action)).markerData.isAcceptOrReject=this.isAcceptOrReject,e.push(s),this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.insertPosition).isAtParagraphStart||(r=this.endIndex,this.endIndex=this.startIndex,e.push(this.getDeleteOperation("Delete")),this.endIndex=r);break}if(0===o.characterFormat.revisions.length){for(s=this.getFormatOperation(),a=0;a<this.markerData.length;a++)"Deletion"===this.markerData[a].revisionType&&(_.isNullOrUndefined(s.markerData.splittedRevisions)&&(s.markerData.splittedRevisions=[]),this.checkValidRevision(this.markerData[a].revisionId)&&s.markerData.splittedRevisions.push(this.markerData[a]),this.markerData.splice(a,1),a--);this.markerData=[],e.push(s);break}}}return e},r.prototype.checkValidRevision=function(e){for(var t=0;t<this.owner.revisions.changes.length;t++)if(this.owner.revisions.changes[t].revisionID===e)return!0;return!1},r.prototype.getDeleteOperationForTrackChanges=function(e){var t;if(e instanceof X||e instanceof Ic||e instanceof Z||e instanceof J)if(0===e.removedIds.length)t=this.getFormatOperation(e);else if(0<e.removedIds.length){var i=e.removedIds[0],i=this.owner.editorModule.getRevision(i),n=""===this.owner.currentUser?"Guest user":this.owner.currentUser;if("Insertion"===i.revisionType&&i.author!==n)t=this.getFormatOperation(e);else if("Insertion"===i.revisionType)t=this.getDeleteOperation(this.action,void 0,this.getRemovedText(e));else if("Deletion"===i.revisionType&&i.author!==n&&(t=this.getFormatOperation(e),0<e.removedIds.length))for(var r=0;r<e.removedIds.length;r++)_.isNullOrUndefined(t.markerData.removedIds)||(t.markerData.removedIds=[]),t.markerData.removedIds.push(e.removedIds[r])}return"Enter"===this.action||e instanceof G||!_.isNullOrUndefined(t)&&"Delete"===t.action||(this.startIndex+=e.length),t},r.prototype.getActionInfo=function(e){var t,i=this.action,n=[];switch((i=_.isNullOrUndefined(this.isAcceptOrReject)||"Reject"!==this.isAcceptOrReject?i:"Reject Change").toString()){case"Insert":case"InsertTextParaReplace":case"Enter":case"InsertInline":case"SectionBreak":case"SectionBreakContinuous":if(0<this.removedNodes.length&&_.isNullOrUndefined(this.dropDownIndex)&&(this.owner.enableTrackChanges&&!this.editorHistory.isUndoing?(n=this.getDeleteOperationsForTrackChanges(),"InsertInline"!==i&&(this.insertIndex=this.endIndex)):(l=this.getDeleteOperation(i),"Enter"===i&&this.owner.enableTrackChanges&&this.editorHistory.isUndoing&&(l.markerData={isSkipTracking:!0}),n.push(l))),"Enter"===i||0<this.insertedText.length)if(this.editorHistory.isUndoing||this.editorHistory.isRedoing&&"Enter"!==i&&"SectionBreak"!==i&&"SectionBreakContinuous"!==i)this.isRemovedNodes&&(t=this.getDeleteContent(i),n=n.concat(t));else{var r=this.getInsertOperation(i);if(this.owner.enableTrackChanges&&"Enter"!==this.action){this.insertedElement instanceof Bh&&(r.markerData=this.markerData[0],this.markerData.splice(0,1),r.text=L.Marker_Start,r.markerData.type=this.insertedElement.footnoteType,r.markerData.revisionForFootnoteEndnoteContent=this.markerData.pop()),n.push(r);for(var o=0;o<this.splittedRevisions.length;o++)_.isNullOrUndefined(r.markerData)&&(r.markerData={}),_.isNullOrUndefined(r.markerData.splittedRevisions)&&(r.markerData.splittedRevisions=[]),r.markerData.splittedRevisions.push(this.splittedRevisions[o])}else n.push(r)}var s=n[n.length-1];"Insert"!==i||_.isNullOrUndefined(s.text)||(s.length=s.text.length),_.isNullOrUndefined(this.dropDownIndex)||(s.markerData={type:"Field",dropDownIndex:this.dropDownIndex},s.offset=this.getElementAbsolutePosition(this.fieldBegin),s.type="DropDown");break;case"InsertTable":case"InsertTableBelow":if(0<this.removedNodes.length&&n.push(this.getDeleteOperation(i)),this.editorHistory.isUndoing&&this.isRemovedNodes)n.push(this.getUndoRedoOperation(i));else for(var a=this.buildTableRowCellOperation(i),o=0;o<a.length;o++)n.push(a[o]);break;case"InsertRowAbove":case"InsertRowBelow":case"InsertColumnLeft":case"InsertColumnRight":if(this.editorHistory.isUndoing){for(o=0;o<this.cellOperation.length;o++)n.push(this.cellOperation[o]);var r=this.getUndoRedoOperation(i,!0);this.owner.enableTrackChanges&&_.isNullOrUndefined(r.markerData)&&(r.markerData={isSkipTracking:!0}),n.push(r)}else{var s=this.buildTableRowCellOperation(i);n=("InsertRowAbove"===i||"InsertRowBelow"===i?s:s.reverse()).slice()}break;case"BackSpace":case"Delete":case"Cut":case"DeleteBookmark":case"RemoveEditRange":if(this.editorHistory.isUndoing)"DeleteBookmark"==i||"RemoveEditRange"==i?(--this.startIndex,this.insertIndex=this.startIndex,this.insertedText=L.Marker_Start,n.push(this.getInsertOperation(i)),this.insertedText=L.Marker_End,n.push(this.getInsertOperation(i,!0)),"RemoveEditRange"===i&&--(r=n[n.length-1]).offset,this.startIndex+=1):this.endRevisionLogicalIndex&&this.editorHistory.isUndoing&&(0<this.removedNodes.length&&((l=this.getDeleteOperation(i)).markerData={isSkipTracking:!0},n.push(l)),!this.isRemovedNodes)||(t=this.getDeleteContent(i),n=n.concat(t));else if(0<this.cellOperation.length)n=this.cellOperation,this.cellOperation=[];else if(0<this.removedNodes.length)if(this.owner.enableTrackChanges)this.editorHistory.isRedoing?(0<this.removedNodes.length&&((l=this.getDeleteOperation(i)).markerData={isSkipTracking:!0},n.push(l)),this.isRemovedNodes&&(t=this.getDeleteContent(i),n=n.concat(t))):n=this.getDeleteOperationsForTrackChanges();else{var l=this.getDeleteOperation(i);n.push(l);for(o=0;o<this.removedNodes.length;o++){var d=this.removedNodes[parseInt(o.toString(),10)];if(d instanceof z)for(var h=d.removedHeaderFooters,c=0;c<h.length;c++){var p=h[parseInt(c.toString(),10)];if(0<Object.keys(p).length){n.push(this.getDeleteOperation("DeleteHeaderFooter",void 0));break}}}"DeleteBookmark"!==i&&"RemoveEditRange"!==i||(n.push(this.getDeleteOperation(i,!0)),"RemoveEditRange"===i&&--(r=n[n.length-1]).offset)}this.markerData=[];break;case"ResolveComment":case"EditComment":for(o=0;o<this.removedNodes.length;o++){var r=this.getUpdateOperation();n.push(this.getCommentOperation(r,i,this.removedNodes[o]))}break;case"ClearRevisions":case"TrackingPageBreak":if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)0<this.removedNodes.length&&((l=this.getDeleteOperation(i)).markerData={isSkipTracking:!0},n.push(l)),this.isRemovedNodes&&(u=void 0,(u="string"==typeof this.removedNodes[0]?this.owner.editorModule.getRevision(this.removedNodes[0]):u)&&u.range[0]instanceof B?n.push(this.getInsertOperation("Enter")):(t=this.getDeleteContent(i),n=n.concat(t)));else if(0<this.removedNodes.length){var u=this.owner.editorModule.getRevision(this.removedNodes[0]);if("TrackingPageBreak"===i&&"string"!=typeof this.removedNodes[0]){(r=this.getDeleteOperation(i)).markerData.isAcceptOrReject="Reject",n.push(r);break}n.push(this.getRevisionOperation(u))}break;case"Reject Change":this.isRemovedNodes?(t=this.getDeleteContent(i),n=n.concat(t)):((r=this.getDeleteOperation(i)).markerData.isAcceptOrReject="Reject",n.push(r));break;case"Accept Change":this.isRemovedNodes?(t=this.getDeleteContent(i),n=n.concat(t)):((l=this.getDeleteOperation(i)).markerData.isAcceptOrReject="Accept",n.push(l));break;case"Paste":case"PasteColumn":case"PasteOverwrite":case"PasteRow":this.editorHistory.isUndoing||this.editorHistory.isRedoing?(0<this.removedNodes.length&&n.push(this.getDeleteOperation("Delete")),this.isRemovedNodes&&("Paste"===this.action?(t=this.getDeleteContent(i),n=n.concat(t)):n.push(this.getUndoRedoOperation(i,!0)))):(0<this.removedNodes.length&&n.push(this.getDeleteOperation("Delete")),s=this.getPasteContentLength(),"Paste"!==i&&this.owner.selectionModule.start.paragraph.isInsideTable&&(s=this.owner.selectionModule.getBlockLength(void 0,this.owner.selectionModule.start.paragraph.associatedCell.ownerTable,0,{done:!1},!0,void 0,void 0)),u={action:"Insert",offset:this.startIndex,length:s,pasteContent:JSON.stringify(this.pasteContent),type:_.isNullOrUndefined(this.type)?"Paste":this.type,markerData:this.markerData.pop()},n.push(u));break;case"InsertHyperlink":_.isNullOrUndefined(this.fieldBegin)?(n.push(this.getDeleteOperation("BackSpace")),this.isRemovedNodes&&(t=this.getDeleteContent(i),n=n.concat(t))):n=this.isEditHyperlink?this.getEditHyperlinkOperation():this.getFieldOperation(),this.fieldBegin=void 0;break;case"UpdateFormField":this.insertedText="";l=this.getInsertOperation("UpdateFormField");l.text=L.Marker_Start,l.markerData={type:"Field",checkBoxValue:this.fieldBegin.formFieldData.checked},l.offset=this.getElementAbsolutePosition(this.fieldBegin),n.push(l);break;case"DeleteRow":case"DeleteCells":case"DeleteColumn":case"DeleteTable":case"ClearCells":case"MergeCells":if(this.editorHistory.isUndoing)"DeleteTable"==i?n.push(this.getUndoRedoOperation(i)):(n=this.cellOperation.slice(),this.insertIndex=this.startIndex,n.push(this.getUndoRedoOperation(i,!0)),this.cellOperation=[]);else if(0<this.removedNodes.length){if(0<this.cellOperation.length){for(o=0;o<this.cellOperation.length;o++)n.push(this.cellOperation[o]);"MergeCells"===i?(n.push(this.getPasteMergeOperation()),n.push(this.getFormatOperation()),this.type=void 0):n.reverse()}else this.owner.enableTrackChanges?n.push(this.getFormatOperation(void 0,i)):n.push(this.getDeleteOperation(i));this.cellOperation=[]}break;case"RemoveRowTrack":this.editorHistory.isUndoing?this.isRemovedNodes&&this.editorHistory.isUndoing&&(n=this.cellOperation.slice(),t=this.getDeleteContent(i),_.isNullOrUndefined(t[0].markerData)&&(t[0].markerData={isSkipTracking:!0}),n.push.apply(n,t)):0<this.removedNodes.length&&(0<this.cellOperation.length?n.push.apply(n,this.cellOperation):(n=this.revisionOperation.slice(),this.getTrackchangesOperation(n)));break;case"RowResizing":case"CellResizing":n=this.getResizingOperation(i);break;case"ImageResizing":n.push(this.getFormatOperation());break;case"Bold":case"Italic":case"Underline":case"FontSize":case"Strikethrough":case"BaselineAlignment":case"HighlightColor":case"FontColor":case"FontFamily":case"Uppercase":case"Lowercase":case"CapitalizeEachWord":case"SentenceCase":case"ToggleCase":case"CharacterFormat":this.editorHistory.isUndoing||this.editorHistory.isRedoing?"Uppercase"===i?(n.push(this.getDeleteOperation(i)),this.removedNodes&&(t=this.getDeleteContent(i),n=n.concat(t))):(n=this.modifiedFormatOperation,this.modifiedFormatOperation=[]):n=this.buildFormatOperation(i,!0).slice();break;case"AfterSpacing":case"BeforeSpacing":case"RightIndent":case"LeftIndent":case"FirstLineIndent":case"LineSpacing":case"LineSpacingType":case"TextAlignment":case"Borders":case"TopBorder":case"BottomBorder":case"LeftBorder":case"RightBorder":case"HorizontalBorder":case"VerticalBorder":case"ListFormat":case"ParagraphFormat":case"StyleName":case"ClearParagraphFormat":case"SpaceBeforeAuto":case"SpaceAfterAuto":case"ParagraphBidi":case"ContextualSpacing":case"ContinueNumbering":case"List":if(0<this.modifiedFormatOperation.length&&!e)n=this.modifiedFormatOperation,this.modifiedFormatOperation=[];else{if("ContinueNumbering"===(i=e&&this.editorHistory.isUndoing&&("ListFormat"===i||"ClearParagraphFormat"===i)?"ParagraphFormat":i)&&(this.type=i.toString()),"Borders"===i&&this.removedNodes[this.removedNodes.length-1]instanceof K){this.insertedText=L.Cell,this.type="CellFormat",this.createCellFormat(i),n=this.getSelectedCellOperation(i,void 0,!0,!1,!0);break}n=this.buildFormatOperation(i,!1).slice()}break;case"TableAlignment":case"DefaultCellSpacing":case"TableLeftIndent":case"DefaultCellLeftMargin":case"DefaultCellRightMargin":case"DefaultCellTopMargin":case"DefaultCellBottomMargin":case"TablePreferredWidth":case"TablePreferredWidthType":case"TableBidi":this.createTableFormat(i),this.type="TableFormat",n.push(this.getFormatOperation()),this.format=void 0;break;case"RestartNumbering":this.type=i.toString();s=this.getFormatOperation(void 0,i);this.createListFormat(i,s),n.push(s);break;case"Shading":this.createCellFormat(i),this.type="CellFormat",n=this.getSelectedCellOperation(i,void 0,void 0,!0,!0);break;case"TableAutoFitToContents":case"TableAutoFitToWindow":case"TableFixedColumnWidth":this.editorHistory.isUndoing?n=this.getDeleteContent("Insert"):(this.createTableFormat(i),this.type="TableFormat",this.insertedText=i.toString(),n.push(this.getFormatOperation()),this.format=void 0);break;case"SectionFormat":case"HeaderDistance":case"FooterDistance":case"DifferentFirstPage":case"DifferentOddAndEvenPages":case"PageWidth":case"PageHeight":case"LeftMargin":case"TopMargin":case"RightMargin":case"BottomMargin":case"RestartPageNumbering":case"PageStartingNumber":case"EndnoteNumberFormat":case"FootNoteNumberFormat":case"RestartIndexForEndnotes":case"RestartIndexForFootnotes":case"InitialFootNoteNumber":case"InitialEndNoteNumber":case"LineBetweenColumns":case"EqualWidth":case"BreakCode":case"LinkToPrevious":this.createSectionFormat(i),this.type="SectionFormat",n.push(this.getFormatOperation(void 0)),"LinkToPrevious"===i&&((r=n[n.length-1]).offset=this.insertIndex);break;case"RowHeight":case"RowHeightType":case"AllowBreakAcrossPages":case"RowHeader":this.editorHistory.isUndoing||this.editorHistory.isRedoing&&1<this.modifiedProperties.length?(n=this.modifiedFormatOperation,this.modifiedFormatOperation=[]):(this.createRowFormat(i),this.type="RowFormat",n.push(this.getFormatOperation(void 0)),this.format=void 0);break;case"CellContentVerticalAlignment":case"CellLeftMargin":case"CellRightMargin":case"CellBottomMargin":case"CellTopMargin":case"CellPreferredWidth":case"CellPreferredWidthType":this.createCellFormat(i),this.type="CellFormat",n=this.getSelectedCellOperation(i,!1,!1,!1,!0).slice(),this.format=void 0}return this.cellOperation=[],this.revisionOperation=[],this.isRemovedNodes=!1,n},r.prototype.getTrackchangesOperation=function(e){for(var t,i,n,r=this.markerData,o=r.length-1;0<=o;o--)_.isNullOrUndefined(r[o].revisionId)||((t=this.getRevision(r[o].revisionId))&&0<t.range.length?t.range[0]instanceof Ya?e.push(this.buildRowOperationForTrackChanges(t.range[0].ownerBase,"RemoveRowTrack")):(i=new y(this.owner),n=new y(this.owner),this.owner.selection.selectRevision(t,i,n),this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(i),this.endIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(n),e.push(this.getFormatOperation(void 0))):this.owner.editorModule.removeMarkerInfoRevision(r[o].revisionId,r))},r.prototype.getRevision=function(e){for(var t=0;t<this.owner.revisions.changes.length;t++)if(this.owner.revisions.changes[t].revisionID===e)return this.owner.revisions.changes[t]},r.prototype.getElementAbsolutePosition=function(e){if(e)return e=this.owner.selectionModule.getElementPosition(e),this.owner.selectionModule.getAbsolutePositionFromRelativePosition(e.startPosition)},r.prototype.getFieldOperation=function(){var e=[],t=this.fieldBegin,i=!1,n=this.insertIndex;if(!_.isNullOrUndefined(t))do{var r,o=void 0,s=void 0,a=void 0,l=void 0,d=void 0}while(t.skipformFieldLength||(t instanceof Z?(0===t.fieldType&&""!==this.getRemovedText()&&(e.push(this.getDeleteOperation("Delete")),(r=e[e.length-1]).offset=n,!_.isNullOrUndefined(r.markerData))&&this.owner.enableTrackChanges&&(r.markerData.isSkipTracking=!0),o=0===t.fieldType?L.Marker_Start:1===t.fieldType?L.Marker_End:2===t.fieldType?L.Field_Separator:"",0===t.fieldType&&t.formFieldData?(d=this.formFieldType,0<t.revisions.length&&(s=this.owner.editorModule.getRevisionMarkerData(s,t.revisions[0])),(s=_.isNullOrUndefined(s)?{}:s).type="Field",s.formFieldData=JSON.stringify(t.formFieldData)):(0<t.revisions.length&&(s=this.owner.editorModule.getRevisionMarkerData(s,t.revisions[0])),(s=_.isNullOrUndefined(s)?{}:s).type="Field"),a=t.length):this.fieldBegin.formFieldData&&t instanceof J?(o=0===t.bookmarkType?L.Marker_Start:L.Marker_End,s={bookmarkName:t.name,type:"Bookmark"},a=t.length):t instanceof X&&(o=t.text,a=t.length,0<t.revisions.length)&&(s=this.owner.editorModule.getRevisionMarkerData(s,t.revisions[0])),t instanceof J||(r=this.owner.sfdtExportModule.writeCharacterFormat(t.characterFormat,0),l=JSON.stringify(r)),e.push({action:"Insert",offset:n,type:d,text:o,length:a,markerData:s,format:l}),n+=t.length,l=d=s=void 0,t instanceof Z&&1===t.fieldType&&(i=!0,this.fieldBegin.formFieldData)&&t.nextNode instanceof J&&(o=0===(d=t.nextNode).bookmarkType?L.Marker_Start:L.Marker_End,0<d.revisions.length&&(s=this.owner.editorModule.getRevisionMarkerData(s,d.revisions[0])),(s=_.isNullOrUndefined(s)?{}:s).bookmarkName=d.name,s.type="Bookmark",a=d.length,e.push({action:"Insert",offset:n,text:o,length:a,markerData:s}))),t=t.nextNode,!i&&!_.isNullOrUndefined(t));return e},r.prototype.getDeleteContent=function(e){var t=[],i=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.collabStart),n=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.collabEnd),r=n.clone();return r.offset=n.offset-1,i.isAtParagraphStart&&r.isAtParagraphEnd&&!i.currentWidget.paragraph.isInsideTable?(t.push(this.getInsertOperation("Enter",!1,!0)),t.push(this.getUndoRedoOperation(e))):i.paragraph==n.paragraph?i.isAtSamePosition(n)?(this.owner.selectionModule.isEmpty&&"BackSpace"===e&&--this.insertIndex,t.push(this.getUndoRedoOperation(e,!1,!0))):t.push(this.getUndoRedoOperation(e)):i.currentWidget.paragraph.isInsideTable?(t=this.cellOperation.slice()).push(this.getUndoRedoOperation(e,!0)):(t.push(this.getUndoRedoOperation(e)),this.startIndex=this.endIndex+1,i.isAtParagraphStart||r.isAtParagraphEnd||(n=this.getDeleteOperation("Delete"),this.owner.enableTrackChanges&&(n.markerData={isSkipTracking:!0}),t.push(n))),t},r.prototype.getEditHyperlinkOperation=function(){var e,t,i,n=[],r=this.fieldBegin;return r&&(e=this.getElementAbsolutePosition(r),n.push(this.getDeleteOperation("Delete")),(t=n[n.length-1]).offset=e,i=this.getRemovedFieldCode(),t.length=i.length,t.text=i,n.push(this.getInsertOperation("InsertHyperlink")),(t=n[n.length-1]).offset=e,i=this.owner.selectionModule.getFieldCode(r,!0),t.text=i,t.length=i.length),n},r.prototype.getPasteContentLength=function(){for(var e=0,t=0;t<this.insertedNodes.length;t++){var i=this.insertedNodes[t];i instanceof X?e+=i.length:e+=this.owner.selectionModule.getBlockLength(void 0,i,0,{done:!1},!0,void 0,void 0)}return this.insertedNodes=[],e},r.prototype.getUpdateOperation=function(){return{action:"Update"}},r.prototype.getResizingOperation=function(e){var t=[],i=this.owner.editorModule.tableResize,n=i.currentResizingTable;if(!_.isNullOrUndefined(n.childWidgets)){var n=n.combineWidget(this.owner.viewer),r=i.resizerPosition,o={paragraph:null,offset:0};if("RowResizing"==e){var s=n.childWidgets[r],a=(_.isNullOrUndefined(s)&&(s=this.modifiedProperties[0].rowFormat.ownerBase),this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(o,{position:0,done:!1},s).position,this.endIndex=this.startIndex+this.getRowLength(s),{});_.isNullOrUndefined(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(a,s.rowFormat,0),this.format=JSON.stringify(a),this.insertedText=L.Row,t.push(this.getFormatOperation())}else{var l=r,d=r-1,e=(this.insertedText=L.Cell,!1);if(this.owner.selectionModule.isEmpty){e=!0;for(s=n.firstChild;s;){for(p=s.firstChild;p;)p.index!=l&&p.index!=d||(c={},_.isNullOrUndefined(this.owner.sfdtExportModule)||(c=this.owner.sfdtExportModule.writeCellFormat(p.cellFormat,0)),this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(o,{position:0,done:!1},p).position,this.endIndex=this.startIndex+this.owner.selectionModule.calculateCellLength(p)+1,this.type="CellFormat",this.format=JSON.stringify(c),t.push(this.getFormatOperation())),p=p.nextWidget;a={};_.isNullOrUndefined(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(a,s.rowFormat,0),this.format=JSON.stringify(a),this.type="RowFormat",this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(o,{position:0,done:!1},s).position,this.endIndex=this.startIndex+this.getRowLength(s),t.push(this.getFormatOperation()),s=s.getSplitWidgets().pop().nextRenderedWidget}}else{r=i.getTableCellWidget(i.startingPoint);if(r&&(this.owner.selectionModule.selectedWidgets.containsKey(r)||r.previousWidget&&this.owner.selectionModule.selectedWidgets.containsKey(r.previousWidget)))for(var e=!0,i=this.owner.selectionModule.getSelectedCells(),r=i[0],i=i[i.length-1],r=n.childWidgets.indexOf(r.ownerRow),h=n.childWidgets.indexOf(i.ownerRow),s=n.childWidgets[r];s&&s.index<=h;){for(var c,p=s.firstChild;p;)p.index!=l&&p.index!=d||(c={},_.isNullOrUndefined(this.owner.sfdtExportModule)||(c=this.owner.sfdtExportModule.writeCellFormat(p.cellFormat,0)),this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(o,{position:0,done:!1},p).position,this.endIndex=this.startIndex+this.owner.selectionModule.calculateCellLength(p)+1,this.type="CellFormat",this.format=JSON.stringify(c),t.push(this.getFormatOperation())),p=p.nextWidget;var a={};_.isNullOrUndefined(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(a,s.rowFormat,0),this.format=JSON.stringify(a),this.type="RowFormat",this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(o,{position:0,done:!1},s).position,this.endIndex=this.startIndex+this.getRowLength(s),t.push(this.getFormatOperation()),s=s.getSplitWidgets().pop().nextRenderedWidget}}e&&(i={},i=this.owner.sfdtExportModule?this.owner.sfdtExportModule.writeTableFormat(n.tableFormat,0):{},this.format=JSON.stringify(i),this.type="TableFormat",this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(o,{position:0,done:!1},n).position,this.endIndex=this.startIndex+this.owner.selectionModule.getBlockLength(void 0,n,0,{done:!1},!0,void 0,void 0)-1,t.push(this.getFormatOperation()))}this.owner.documentHelper.layout.reLayoutTable(n)}return this.format=void 0,t},r.prototype.getRowLength=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=this.owner.selectionModule.calculateCellLength(e.childWidgets[i])+1;return t},r.prototype.getDeleteOperation=function(e,t,i){this.startIndex>this.endIndex&&(r=this.startIndex,this.startIndex=this.endIndex,this.endIndex=r),"Delete"===e&&this.endIndex<this.startIndex&&(r=this.startIndex,this.startIndex=this.endIndex,this.endIndex=r),this.endIndex===this.startIndex&&"DeleteBookmark"!==e&&"RemoveEditRange"!==e&&"InsertHyperlink"!==this.action&&("BackSpace"===e||"Insert"===e||"Enter"===e?this.startIndex--:this.endIndex++),"DeleteHeaderFooter"===e&&(this.startIndex=this.headerFooterStart,this.endIndex=this.headerFooterEnd);var n,r=_.isNullOrUndefined(i)?this.endIndex-this.startIndex:i.length,i=("DeleteBookmark"===e||"RemoveEditRange"===e?(n=this.insertedText,r=1):"DeleteHeaderFooter"!==e&&("DeleteTable"===e||"DeleteRow"===e||"DeleteColumn"===e||"MergeCells"===e||"RemoveRowTrack"===e?(n=this.insertedText,"DeleteTable"!==e&&"DeleteRow"!==e&&(r=this.tableRelatedLength)):n=_.isNullOrUndefined(i)?this.getRemovedText():i),"Cut"===e&&" "===n[n.length-1]&&r<n.length&&(r=n.length),{action:"Delete",offset:t?this.endIndex:this.startIndex,text:n,length:"Paste"===e||0===r?n.length:r,skipOperation:"DeleteHeaderFooter"===e||void 0,markerData:this.markerData[0]});return this.removedNodes[0]instanceof Bh&&(this.editorHistory.isUndoing&&3<=i.length?i.length+=1:(t={position:0,done:!1},e={paragraph:r=(n=this.removedNodes[0]).bodyWidget.lastChild,offset:this.owner.selectionModule.getParagraphLength(r)+1},this.owner.selectionModule.getPositionInfoForBodyContent(e,t,n.bodyWidget.firstChild),i.length+=t.position)),i},r.prototype.getInsertOperation=function(e,t,i){var n,r="Enter"===e?"\n":this.insertedText,e=("InsertTable"===e||"InsertTableBelow"===e||"InsertRowAbove"===e||"InsertRowBelow"===e||"InsertColumnLeft"===e||"InsertColumnRight"===e||"MergeCells"===e||"RemoveRowTrack"===e?(n=this.tableRelatedLength,"InsertTable"!==this.action&&"InsertTableBelow"!==this.action||(this.insertIndex=this.startIndex)):_.isNullOrUndefined(r)||(n=r.length),{action:"Insert",offset:t?this.endIndex:this.insertIndex,text:r,type:this.type,length:n,skipOperation:!1,imageData:this.insertedData,format:this.format});return _.isNullOrUndefined(this.markerData)||i||(e.markerData=this.markerData.pop()),this.insertedElement instanceof Bh&&(e.length+=this.getFootNoteLength()),e},r.prototype.getFootNoteLength=function(){var e=this.insertedElement.bodyWidget.lastChild,t={position:0,done:!1},e={paragraph:e,offset:this.owner.selectionModule.getParagraphLength(e)+1};return this.owner.selectionModule.getPositionInfoForBodyContent(e,t,this.insertedElement.bodyWidget.firstChild),t.position},r.prototype.getUndoRedoOperation=function(e,t,i){var n,r,o,s,a,l=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.collabStart),d=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.collabEnd),h=0;return h=t?(o="BackSpace"===e||"Delete"===e||"Insert"===e?(r=l.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},r).position,d.currentWidget.paragraph.isInsideTable?(n=(o=this.documentHelper.getLastParagraphBlock(d.currentWidget.paragraph.associatedCell.ownerTable)).lastChild,o.lastChild.getEndOffset()):(n=d.currentWidget,d.offset)):(r=this.owner.selectionModule.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),n=(o=this.documentHelper.getLastParagraphBlock(r)).lastChild,o.lastChild.getEndOffset()),s=this.documentHelper.getFirstParagraphBlock(r).firstChild,this.owner.selectionModule.getBlockLength(void(a=0),r,0,{done:!1},!0,void 0,void 0)):(s=l.currentWidget,n=d.currentWidget,o=!i||"BackSpace"==e?d.offset:d.offset+1,a=i&&"BackSpace"===e?l.offset-1:l.offset,t=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(this.collabStart),this.owner.selectionModule.getAbsolutePositionFromRelativePosition(this.collabEnd)-t),this.pasteContent=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,s,a,n,o,!1,!0),this.getPasteOpertion(this.pasteContent,h)},r.prototype.getPasteOpertion=function(e,t){t={action:"Insert",offset:this.startIndex,length:0<t?t:1,pasteContent:JSON.stringify(e),type:"Paste"};return this.owner.enableTrackChanges&&(t.markerData={isSkipTracking:!0}),!_.isNullOrUndefined(this.insertedElement)&&this.insertedElement instanceof Bh&&(t.length+=this.getFootNoteLength()),t},r.prototype.buildTableRowCellOperation=function(e){var t,i=[];if(0<this.insertedNodes.length){this.insertedNodes[0]instanceof dh&&(a=this.insertedNodes[0],this.insertIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(m={paragraph:null,offset:0},{position:0,done:!1},this.insertedNodes[0]).position,t=this.insertedNodes.length,a.ownerTable.childWidgets.length===a.indexInOwner+t)&&--this.insertIndex,1<this.insertedNodes.length&&"InsertTable"===e&&(t=this.getInsertOperation("Enter",!1,!0),_.isNullOrUndefined(t.markerData)&&(t.markerData={}),t.markerData.isSkipTracking=!0,i.push(t));for(var n=0;n<this.insertedNodes.length;n++)if(this.insertedNodes[n]instanceof K){var r=this.insertedNodes[n].combineWidget(this.owner.viewer),o=(this.tableRelatedLength="InsertTableBelow"===e?0:1,this.insertedText=L.Table,this.owner.sfdtExportModule?this.owner.sfdtExportModule.writeTableFormat(r.tableFormat,0):{});this.format=JSON.stringify(o),i.push(this.getInsertOperation(e,!1,!0));for(var s=0;s<r.childWidgets.length;s++){var a=r.childWidgets[s];i.push(this.buildRowOperation(a,e));for(var l=0;l<a.childWidgets.length;l++)for(var d=a.childWidgets[l],h=this.buildCellOperation(d,e,!0),c=0;c<h.length;c++)i.push(h[c])}}else if(this.insertedNodes[n]instanceof dh){a=this.insertedNodes[n];i.push(this.buildRowOperation(a,e));for(s=0;s<a.childWidgets.length;s++)for(d=a.childWidgets[s],h=this.buildCellOperation(d,e,!0),c=0;c<h.length;c++)i.push(h[c])}else if(this.insertedNodes[n]instanceof N)for(var p=(d=this.insertedNodes[n]).ownerTable.combineWidget(this.owner.viewer),u=0,s=0;s<p.childWidgets.length;s++)for(n=this.insertedNodes.length,a=p.childWidgets[s],l=0;l<a.childWidgets.length;l++){var g=a.childWidgets[l],m={paragraph:null,offset:0};if(-1!==this.insertedNodes.indexOf(g)){for(var f=this.owner.selectionModule.getPositionInfoForHeaderFooter(m,{position:0,done:!1},g).position,h=(this.insertIndex=f-u,g.ownerTable.childWidgets.length===g.ownerRow.indexInOwner+1&&-1!==this.insertedNodes.indexOf(a.childWidgets[a.childWidgets.length-1])&&--this.insertIndex,this.buildCellOperation(g,e,!0)),c=0;c<h.length;c++)i.push(h[c]);u+=2}else for(f=this.owner.selectionModule.getPositionInfoForHeaderFooter(m,{position:0,done:!1},g).position,h=(this.insertIndex=f-u,this.buildCellOperation(g,e,!1)),c=0;c<h.length;c++)i.push(h[c])}this.insertedNodes=[]}return i},r.prototype.assignRevisionData=function(e,t,i,n){return{revisionType:e,author:t,date:i,revisionId:n}},r.prototype.createAcceptRejectOperation=function(e){var t=this.owner.selectionModule.start;if(t.paragraph.isInsideTable){var i,n=t.paragraph.associatedCell.ownerRow,r=0,t=(this.insertedText=L.Row,0<n.rowFormat.revisions.length&&(t=n.rowFormat.revisions[0],i=void 0,"Accept Change"===e?i="Accept":"Reject Change"===e&&(i="Reject"),this.markerData.push(this.owner.editorModule.getMarkerData(void 0,void 0,t,i))),this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},n).position);if(0<n.rowFormat.revisions.length){if("Insertion"===n.rowFormat.revisions[0].revisionType){if("Accept Change"===e)this.startIndex=t,this.tableRelatedLength=1,this.cellOperation.push(this.getFormatOperation(void 0,"RemoveRowTrack"));else if("Reject Change"===e){this.startIndex=t;for(var o=0;o<n.childWidgets.length;o++)r+=this.owner.selectionModule.calculateCellLength(n.childWidgets[o])+1;this.tableRelatedLength=r,this.cellOperation.push(this.getDeleteOperation("RemoveRowTrack"))}}else if("Deletion"===n.rowFormat.revisions[0].revisionType)if("Accept Change"===e){this.startIndex=t;for(o=0;o<n.childWidgets.length;o++)r+=this.owner.selectionModule.calculateCellLength(n.childWidgets[o])+1;this.tableRelatedLength=r,this.cellOperation.push(this.getDeleteOperation("RemoveRowTrack"))}else if("Reject Change"===e){this.startIndex=t;for(o=0;o<n.childWidgets.length;o++)r+=this.owner.selectionModule.calculateCellLength(n.childWidgets[o])+1;this.tableRelatedLength=r,this.cellOperation.push(this.getFormatOperation(void 0,"RemoveRowTrack"))}this.markerData=[]}}},r.prototype.buildRowOperation=function(e,t){this.insertedText=L.Row;var i={},e=(_.isNullOrUndefined(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(i,e.rowFormat,0),this.format=JSON.stringify(i),"InsertTable"===t&&0<e.rowFormat.revisions.length&&(i=e.rowFormat.revisions[e.rowFormat.revisions.length-1],e=this.markerData[this.markerData.length-1],!_.isNullOrUndefined(e)&&e.revisionId===i.revisionID||this.markerData.push(this.owner.editorModule.getMarkerData(void 0,void 0,i))),this.tableRelatedLength=1,this.getInsertOperation(t));return this.format=void 0,e},r.prototype.buildRowOperationForTrackChanges=function(e,t){var i=0,n=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},e).position;this.startIndex=n;for(var r=0;r<e.childWidgets.length;r++)i+=this.owner.selectionModule.calculateCellLength(e.childWidgets[r])+1;this.tableRelatedLength=i,this.insertedText=L.Row;n=this.getFormatOperation(void 0,t);return this.insertedText="",n},r.prototype.buildCellOperation=function(e,t,i){var n=[],r=(this.tableRelatedLength=i?1:0,this.insertedText=L.Cell,this.type="CellFormat",_.isNullOrUndefined(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.writeCellFormat(e.cellFormat,0));return this.format=JSON.stringify(r),n.push(this.getInsertOperation(t,!1,!0)),i&&(this.tableRelatedLength=i?1:0,this.type="ParagraphFormat",r=this.owner.sfdtExportModule.writeParagraphFormat(e.childWidgets[0].paragraphFormat,0,!0),this.format=JSON.stringify(r),n.push(this.getInsertOperation(t,!1,!0)),this.tableRelatedLength=0,this.type="CharacterFormat",i=this.owner.sfdtExportModule.writeCharacterFormat(e.childWidgets[0].characterFormat,0,!0),this.format=JSON.stringify(i),n.push(this.getInsertOperation(t,!1,!0)),this.format=void 0,this.type=void 0),n},r.prototype.deleteColumnOperation=function(e){var t=this.owner.editorModule.getOwnerCell(this.owner.selectionModule.isForward),i=this.owner.editorModule.getOwnerCell(!this.owner.selectionModule.isForward),n=t.ownerTable.combineWidget(this.owner.viewer),r=[],o=0,s=0;if("DeleteColumn"===e)r=n.getColumnCellsForSelection(t,i);else for(var a=(h=this.owner.selectionModule.getCellLeft(t.ownerRow,t))+t.cellFormat.cellWidth,l=this.owner.selectionModule.getCellLeft(i.ownerRow,i),d=l+i.cellFormat.cellWidth,l=this.owner.editorModule.updateSelectedCellsInTable(h,a,l,d),h=l.start,a=l.end,s=n.childWidgets.indexOf(i.ownerRow),c=o=n.childWidgets.indexOf(t.ownerRow);c<=s;c++)for(var p=n.childWidgets[c],u=0;u<p.childWidgets.length;u++){var g=p.childWidgets[u],m=this.owner.selectionModule.getCellLeft(p,g);j.round(h,2)<=j.round(m,2)&&j.round(m,2)<j.round(a,2)&&r.push(g)}for(var f,y=this.owner.selectionModule.isRowSelect()&&o!=s,c=0;c<r.length;c++)"ClearCells"===e?this.deleteCell(e,r[c],!1):"MergeCells"===e?0!==c&&(f=y&&!r[0].ownerRow.equals(r[c].ownerRow)&&0==r[c].index,this.deleteCell(e,r[c],f)):this.deleteCell("DeleteColumn",r[c],!1);"MergeCells"===e&&(this.cellOperation.reverse(),this.deleteCell("ClearCells",r[0],!1))},r.prototype.getPasteMergeOperation=function(){var e=this.owner.selectionModule.start.paragraph.associatedCell,t=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},e).position,i=this.owner.selectionModule.calculateCellLength(e)-1,n=this.owner.selectionModule.getFirstParagraph(e),r=this.owner.selectionModule.getLastParagraph(e),n=n.firstChild,r=r.lastChild,n=(this.pasteContent=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,n,0,r,r.getEndOffset(),!1,!0),this.startIndex=t+1,{action:"Insert",offset:this.startIndex,length:i,pasteContent:JSON.stringify(this.pasteContent),type:"Paste"});return this.insertedText=L.Cell,this.type="CellFormat",this.startIndex=t,this.endIndex=t,this.format=JSON.stringify(this.owner.sfdtExportModule.writeCellFormat(e.cellFormat,0)),n},r.prototype.deleteCell=function(e,t,i){this.tableRelatedLength=this.owner.selectionModule.calculateCellLength(t)+1;this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},t).position,this.startIndex-=i?1:0,this.tableRelatedLength+=i?1:0,this.owner.enableTrackChanges||("ClearCells"===e?(i=t.childWidgets[0],1===t.childWidgets.length&&i instanceof G&&i.isEmpty()||(this.endIndex=this.startIndex+this.tableRelatedLength-1,this.startIndex+=1,this.cellOperation.push(this.getDeleteOperation("ClearCells")))):this.cellOperation.push(this.getDeleteOperation("DeleteColumn")))},r.prototype.getFormatOperation=function(e,t,i){this.startIndex>this.endIndex&&(n=this.startIndex,this.startIndex=this.endIndex,this.endIndex=n);var n=0,i=(this.endIndex!==this.startIndex||i||"DeleteBookmark"===this.action||"RemoveEditRange"===this.action||"InsertHyperlink"===this.action||("BackSpace"===this.action?this.startIndex--:this.endIndex++),n="RemoveRowTrack"===t?this.tableRelatedLength:"RowResizing"===t||"CellResizing"===t||"ImageResizing"===t?this.insertedText.length:_.isNullOrUndefined(e)?this.endIndex-this.startIndex:e.length,{action:"Format",offset:this.startIndex,length:n,markerData:this.markerData[this.markerData.length-1],imageData:this.insertedData,text:this.insertedText,format:this.format});return this.markerData.pop(),_.isNullOrUndefined(t)?i.type=this.type:i.type=t.toString(),i},r.prototype.getRemovedText=function(e){var t="";if(_.isNullOrUndefined(e))for(var i,n=this.removedNodes.length-1;0<=n;n--)(i=this.removedNodes[n])instanceof G?t+=this.getParagraphText(i):i instanceof mh?i instanceof X?t+=i.text:i instanceof Y||(t+=mh.objectCharacter):i instanceof K?t+=this.getTableText(i):i instanceof dh&&(t+=this.getRowText(i));else(i=e)instanceof G?t+=this.getParagraphText(i):i instanceof mh?i instanceof X?t+=i.text:i instanceof Y||(t+=mh.objectCharacter):i instanceof K?t+=this.getTableText(i):i instanceof dh&&(t+=this.getRowText(i));return t},r.prototype.getRevisionOperation=function(e){return"Insertion"===e.revisionType?(this.markerData.push(this.owner.editorModule.getMarkerData(void 0,void 0,e,"Accept")),this.getFormatOperation()):"Deletion"===e.revisionType?(this.markerData.push(this.owner.editorModule.getMarkerData(void 0,void 0,e,"Reject")),this.getFormatOperation()):{}},r.prototype.getRemovedFieldCode=function(){for(var e="",t=!1,i=this.removedNodes.length-1;0<=i;i--){var n=this.removedNodes[i];if(n instanceof mh){if(n instanceof Z&&0===n.fieldType&&(t=!0),n&&n instanceof X&&t&&(e+=n.text),n instanceof Z&&(2===n.fieldType||1===n.fieldType))return e}else if(n instanceof G)for(var r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.children.length;s++){var a=o.children[s];if(a instanceof Z&&0===a.fieldType&&(t=!0),a instanceof X&&t&&(e+=a.text),a instanceof Z&&(2===a.fieldType||1===a.fieldType))return e}}},r.prototype.getParagraphText=function(e){var t="";if(_.isNullOrUndefined(e)||_.isNullOrUndefined(e.childWidgets))return t;for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.children.length;r++)n.children[r]instanceof Y||(n.children[r]instanceof X?t+=n.children[r].text:t+=mh.objectCharacter);return t+"\n"},r.prototype.getTableText=function(e){for(var t=L.Table,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];t+=this.getRowText(n)}return t},r.prototype.getRowText=function(e){for(var t=L.Row,i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++){t+=L.Cell;var o=n.childWidgets[r];o instanceof G?t+=this.getParagraphText(o):t+=this.getTableText(o)}return t},r.prototype.getCommentOperation=function(e,t,i){var n,r;return"InsertInline"===t||"RemoveInline"===t?(n=(r="RemoveInline"===t?this.removedNodes[0]:this.insertedElement).comment,e.text=0===r.commentType?L.Marker_Start:L.Marker_End,e.markerData={type:"Comment",commentId:r.commentId,ownerCommentId:n.isReply?n.ownerComment.commentId:void 0}):"InsertCommentWidget"===t||"DeleteCommentWidget"===t?(_.isNullOrUndefined(i)&&(i=this.removedNodes[0]),e.length=1,e.action="Format",e.offset=this.startIndex<this.endIndex?this.endIndex:this.startIndex,--e.offset,e.text=L.Marker_Start+L.Marker_End,e.markerData={type:"Comment",commentId:i.commentId,author:i.author,date:i.date,commentIndex:(i.isReply?i.ownerComment.replyComments:this.owner.documentHelper.comments).indexOf(i),initial:i.initial,done:i.isResolved,text:i.text,isReply:i.isReply},_.isNullOrUndefined(i.ownerComment)||(r=this.owner.selection.getElementPosition(i.ownerComment.commentEnd,!0).startPosition,e.offset=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(r)),"DeleteCommentWidget"===t?(e.offset=this.startIndex<this.endIndex?this.endIndex:this.startIndex,--e.offset,e.markerData.commentAction="remove"):"InsertCommentWidget"===t&&(e.markerData.commentAction="add")):"ResolveComment"===t?(e.action="Format",e.length=1,e.text=L.Marker_Start+L.Marker_End,e.offset=this.startIndex<this.endIndex?this.endIndex:this.startIndex,--e.offset,e.markerData={type:"Comment",commentId:i.commentId,done:i.isResolved}):"EditComment"===t&&(e.action="Format",e.length=1,e.text=L.Marker_Start+L.Marker_End,e.offset=this.startIndex<this.endIndex?this.endIndex:this.startIndex,--e.offset,e.markerData={type:"Comment",text:i.text}),e},r.prototype.getDeleteCommentOperation=function(e,t){for(var i=0;i<e.length;i++){var n,r=e[i];r instanceof qg&&"DeleteComment"===r.action?this.getDeleteCommentOperation(r.modifiedActions,t):(n=r.getDeleteOperation(r.action),r.getCommentOperation(n,r.action),"DeleteCommentWidget"!==r.action||_.isNullOrUndefined(e[i+1])||(r=e[i+1],n.offset=r.startIndex<r.endIndex?r.startIndex:r.endIndex),t.push(n))}},r.prototype.buildFormatOperation=function(e,t){return("ApplyStyle"===e||"StyleName"===e)&&this.insertedFormat instanceof ul?(this.insertedFormat=this.insertedFormat.name,this.type="ParagraphFormat",this.createParagraphFormat(e)):("ApplyStyle"!==e&&"StyleName"!==e||(this.insertedFormat instanceof B&&this.insertedFormat.baseCharStyle?this.insertedFormat=this.insertedFormat.baseCharStyle.name:this.insertedFormat=this.insertedFormat.name),t?(this.type="CharacterFormat",this.createCharacterFormat(e)):(this.type="ContinueNumbering"==e?"ContinueNumbering":"ParagraphFormat",this.createParagraphFormat(e))),e=this.getSelectedCellOperation(e,t),this.format=void 0,e},r.prototype.getSelectedCellOperation=function(e,t,i,n,r){var o=[],s=this.owner.selectionModule.start,a=this.owner.selectionModule.end;if(s.paragraph.isInsideTable&&a.paragraph.isInsideTable&&s.paragraph.associatedCell.ownerTable.equals(a.paragraph.associatedCell.ownerTable)&&this.owner.selectionModule.isCellSelected(s.paragraph.associatedCell,s,a))for(var l=this.owner.selectionModule.getSelectedCells(),d=0;d<l.length;d++){var h=l[d],c={paragraph:null,offset:0},p=(this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(c,{position:0,done:!1},h).position,this.owner.selectionModule.calculateCellLength(h)+1);this.endIndex=this.startIndex+p,0===p&&t||(h=void(!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||t?this.writeBorderFormat(i,n,h):_.isNullOrUndefined(this.owner.sfdtExportModule)||(p=this.owner.sfdtExportModule.writeCellFormat(h.cellFormat,0),this.format=JSON.stringify(p))),"ListFormat"===e?((h=this.getFormatOperation(void 0,void 0,!0)).type="ListFormat",this.createListFormat(e,h)):h=this.getFormatOperation(void 0,void 0,!0),o.push(h))}else{a=void 0;if("ListFormat"===e)a=this.getFormatOperation(void 0,e),this.createListFormat(e,a);else{if(s.paragraph.isInsideTable&&r&&(this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(c={paragraph:null,offset:0},{position:0,done:!1},s.paragraph.associatedCell).position,r=this.owner.selectionModule.calculateCellLength(s.paragraph.associatedCell)+1,this.endIndex=this.startIndex+r,this.writeBorderFormat(i,n,s.paragraph.associatedCell)),"ClearFormat"===e&&this.editorHistory.isUndoing)return this.buildclearFormatOperations(o),o;a=this.getFormatOperation(void 0,void 0,!0)}o.push(a)}return o},r.prototype.buildclearFormatOperations=function(e){var t=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.collabStart),i=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.collabEnd),n=t.paragraph,r=!1;do{var o,r=n.equals(i.paragraph)}while(n instanceof G?this.buildclearFormatOperation(n,e):(this.tableClearFormatOperation(n,i.paragraph,e,o={done:!1}),o.done&&(r=!0)),n=n.nextRenderedWidget,!r)},r.prototype.tableClearFormatOperation=function(e,t,i,n){for(var r=e.firstChild;r;){for(var o=r.firstChild;o;){var s=o.firstChild;if(s instanceof G)this.buildclearFormatOperation(s,i);else if(this.tableClearFormatOperation(s,t,i,n),n.done)return;if(t.equals(s))return void(n.done=!0);o=o.nextWidget}r=r.getSplitWidgets().pop().nextRenderedWidget}},r.prototype.buildclearFormatOperation=function(e,t){for(var i=!0,n=0;n<e.childWidgets.length;n++)for(var r,o,s=e.childWidgets[n],a=0;a<s.children.length;a++)s.children[a]instanceof X&&(r=this.owner.selectionModule.getElementPosition(s.children[a],!0).startPosition,this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(r),(r=this.getFormatOperation(s.children[a])).length+=1,i&&(o={action:"Format",offset:r.offset,length:r.length,type:"ParagraphFormat",format:JSON.stringify(this.owner.sfdtExportModule.writeParagraphFormat(e.paragraphFormat,0,!0))},t.push(o),i=!1),r.type="CharacterFormat",r.format=JSON.stringify(this.owner.sfdtExportModule.writeCharacterFormat(s.children[a].characterFormat,0,!0)),t.push(r))},r.prototype.writeBorderFormat=function(e,t,i){var n={};e&&(n.borders=j.writeBorders(i.cellFormat.borders,0),this.format=JSON.stringify(n)),t&&(n.shading=this.owner.sfdtExportModule?this.owner.sfdtExportModule.writeShading(i.cellFormat.shading,0):{},this.format=JSON.stringify(n))},r.prototype.createListFormat=function(e,t){var i,n,r,o;"ListFormat"===e?(i=this.insertedFormat.listId,t.text=e.toString().charAt(0).toLowerCase()+e.toString().slice(1)):(i=this.insertedFormat.listId,n=this.insertedFormat.nsid),-1<i&&(r=this.owner.documentHelper.getListById(i),(o={}).optimizeSfdt=this.owner.documentEditorSettings.optimizeSfdt,_.isNullOrUndefined(this.owner.sfdtExportModule)||(this.owner.sfdtExportModule.keywordIndex=this.owner.documentEditorSettings.optimizeSfdt?1:0,o[Ue[this.owner.sfdtExportModule.keywordIndex]]=[],o[Ue[this.owner.sfdtExportModule.keywordIndex]].push(this.owner.sfdtExportModule.writeList(r)),o[Ve[this.owner.sfdtExportModule.keywordIndex]]=[],_.isNullOrUndefined(r)||o[Ve[this.owner.sfdtExportModule.keywordIndex]].push(this.owner.sfdtExportModule.writeAbstractList(r.abstractList)),"RestartNumbering"==e&&(o[Ut[this.owner.sfdtExportModule.keywordIndex]]=i,o[Es]=n)),t.listData=JSON.stringify(o))},r.prototype.createCharacterFormat=function(e){var t,i={};"Uppercase"===e?i.Uppercase=!0:"Lowercase"===e?i.Lowercase=!0:"SentenceCase"===e?i.SentenceCase=!0:"ToggleCase"===e?i.ToggleCase=!0:"CapitalizeEachWord"===e?i.CapitalizeEachWord=!0:"ApplyStyle"===e||"StyleName"===e?_.isNullOrUndefined(this.insertedFormat)?i.styleName=null:i.styleName=this.insertedFormat:"CharacterFormat"===e?(t=this.insertedFormat,i.bold=(t.hasValue("bold")?t:i).bold,i.italic=(t.hasValue("italic")?t:i).italic,i.fontSize=(t.hasValue("fontSize")?t:i).fontSize,i.underline=(t.hasValue("underline")?t:i).underline,i.strikethrough=(t.hasValue("strikethrough")?t:i).strikethrough,i.baselineAlignment=(t.hasValue("baselineAlignment")?t:i).baselineAlignment,i.highlightColor=(t.hasValue("highlightColor")?t:i).highlightColor,i.fontColor=(t.hasValue("fontColor")?t:i).fontColor,i.fontFamily=(t.hasValue("fontFamily")?t:i).fontFamily,i.allCaps=(t.hasValue("allCaps")?t:i).allCaps,i.LowerCase=(t.hasValue("Lowercase")?t:i).Lowercase,i.Uppercase=t.hasValue("Uppercase")?t.Lowercase:i.Uppercase,i.CapitalizeEachWord=(t.hasValue("CapitalizeEachWord")?t:i).CapitalizeEachWord,i.SentenceCase=(t.hasValue("SentenceCase")?t:i).SentenceCase,i.ToggleCase=(t.hasValue("ToggleCase")?t:i).ToggleCase):"increment"===this.insertedFormat||"decrement"===this.insertedFormat?(this.type=this.insertedFormat,i.fontSize=0):"ClearFormat"!==e&&(t=e.toString().charAt(0).toLowerCase()+e.toString().slice(1),this.insertedFormat instanceof B&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(this.insertedFormat=this.insertedFormat[t]),i[t]=this.insertedFormat),this.format=JSON.stringify(i)},r.prototype.createParagraphFormat=function(e){var t,i,n={};"ParagraphFormat"===e||"ContinueNumbering"===e?(i=this.insertedFormat,n.afterSpacing=(i.hasValue("afterSpacing")?i:n).afterSpacing,n.beforeSpacing=(i.hasValue("beforeSpacing")?i:n).beforeSpacing,n.spaceAfterAuto=(i.hasValue("spaceAfterAuto")?i:n).spaceAfterAuto,n.spaceBeforeAuto=(i.hasValue("spaceBeforeAuto")?i:n).spaceBeforeAuto,n.rightIndent=(i.hasValue("rightIndent")?i:n).rightIndent,n.leftIndent=(i.hasValue("leftIndent")?i:n).leftIndent,n.firstLineIndent=(i.hasValue("firstLineIndent")?i:n).firstLineIndent,n.lineSpacing=(i.hasValue("lineSpacing")?i:n).lineSpacing,n.lineSpacingType=(i.hasValue("lineSpacingType")?i:n).lineSpacingType,n.textAlignment=(i.hasValue("textAlignment")?i:n).textAlignment,n.outlineLevel=(i.hasValue("outlineLevel")?i:n).outlineLevel,n.bidi=(i.hasValue("bidi")?i:n).bidi,n.bidi&&("Right"===n.textAlignment?n.textAlignment="Left":"Left"===n.textAlignment&&(n.textAlignment="Right")),n.borders=(i.hasValue("borders")?i:n).borders,-1!==i.listFormat.listId&&((t={}).listId=i.listFormat.listId,t.listLevelNumber=i.listFormat.listLevelNumber,t.nsid=i.listFormat.nsid,n.listFormat=t),n.styleName=i.hasValue("styleName")?n.styleName.name:void 0,n.contextualSpacing=(i.hasValue("contextualSpacing")?i:n).contextualSpacing,n.keepWithNext=(i.hasValue("keepWithNext")?i:n).keepWithNext,n.keepLinesTogether=(i.hasValue("keepLinesTogether")?i:n).keepLinesTogether,n.widowControl=(i.hasValue("contextualSpacing")?i:n).widowControl):"ListFormat"===e?(this.insertedFormat instanceof Xa&&(this.insertedFormat=this.insertedFormat.listFormat),(t={}).listId=this.insertedFormat.listId,t.nsid=this.insertedFormat.nsid,t.listLevelNumber=this.insertedFormat.listLevelNumber,n.listFormat=t):"ApplyStyle"===e||"StyleName"===e?n.styleName=this.insertedFormat:"ParagraphBidi"===e?n.bidi=this.insertedFormat:"Borders"===e?n.borders=j.writeBorders(this.insertedFormat,0):this.insertedFormat instanceof Xa?(i=this.owner.sfdtExportModule.writeParagraphFormat(this.insertedFormat,0),n[e.toString().charAt(0).toLowerCase()+e.toString().slice(1)]=i):"List"===e?n=this.insertedFormat:n[e.toString().charAt(0).toLowerCase()+e.toString().slice(1)]=this.insertedFormat,this.format=JSON.stringify(n)},r.prototype.createTableFormat=function(e){this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},this.owner.selectionModule.start.paragraph.associatedCell.ownerTable).position,this.endIndex=this.startIndex,this.endIndex+=this.owner.selectionModule.getBlockLength(void 0,this.owner.selectionModule.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),0,{done:!1},!0,void 0,void 0)-1;var t,i={};"TableFormat"===e?(t=this.insertedFormat,_.isNullOrUndefined(t)||(i.bidi=t.hasValue("bidi")?t.bidi:void 0,i.preferredWidth=t.hasValue("preferredWidth")?t.preferredWidth:void 0,i.preferredWidthType=t.hasValue("preferredWidthType")?t.preferredWidthType:void 0,i.tableAlignment=t.hasValue("tableAlignment")?t.tableAlignment:void 0,i.leftIndent=t.hasValue("leftIndent")?t.leftIndent:void 0)):"TableOptions"===e?(t=this.owner.selectionModule.start.paragraph.associatedCell.ownerTable.tableFormat,_.isNullOrUndefined(t)||(i.cellSpacing=t.hasValue("cellSpacing")?t.cellSpacing:void 0,i.leftMargin=t.hasValue("leftMargin")?t.leftMargin:void 0,i.topMargin=t.hasValue("topMargin")?t.topMargin:void 0,i.rightMargin=t.hasValue("rightMargin")?t.rightMargin:void 0,i.bottomMargin=t.hasValue("bottomMargin")?t.bottomMargin:void 0)):"BordersAndShading"===e?(t=this.insertedFormat,i=_.isNullOrUndefined(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.writeTableFormat(t,0)):i[this.getTableFormatString(e)]=this.insertedFormat,this.format=JSON.stringify(i)},r.prototype.createRowFormat=function(e){var t,i={};this.editorHistory.isUndoing||this.editorHistory.isRedoing?_.isNullOrUndefined(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(i,this.owner.selectionModule.start.paragraph.associatedCell.ownerRow.rowFormat,0):"RowFormat"===e?(t=this.insertedFormat,_.isNullOrUndefined(t)||(i.height=t.hasValue("height")?t.height:void 0,i.heightType=t.hasValue("heightType")?t.heightType:void 0,i.isHeader=t.hasValue("isHeader")?t.isHeader:void 0,i.allowBreakAcrossPages=t.hasValue("allowBreakAcrossPages")?t.allowBreakAcrossPages:void 0)):i[this.getRowString(e)]=this.insertedFormat,this.format=JSON.stringify(i)},r.prototype.createCellFormat=function(e){var t,i={};"CellFormat"===e?(t=this.insertedFormat,i.preferredWidth=t.hasValue("preferredWidth")?t.preferredWidth:void 0,i.preferredWidthType=t.hasValue("preferredWidthType")?t.preferredWidthType:void 0,i.verticalAlignment=t.hasValue("verticalAlignment")?t.verticalAlignment:void 0):"CellOptions"===e?(t=this.insertedFormat,i.leftMargin=t.leftMargin,i.rightMargin=t.rightMargin,i.bottomMargin=t.bottomMargin,i.topMargin=t.topMargin):"Shading"===e?i[this.getCellString(e)]=_.isNullOrUndefined(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.writeShading(this.insertedFormat,0):"Borders"===e?i.borders=j.writeBorders(this.insertedFormat,0):"BordersAndShading"===e?(i.shading=_.isNullOrUndefined(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.writeShading(this.insertedFormat,0),i.borders=j.writeBorders(this.insertedFormat.borders,0)):i[this.getCellString(e)]=this.insertedFormat,this.format=JSON.stringify(i)},r.prototype.getTableFormatString=function(e){switch(e){case"TableAlignment":return"tableAlignment";case"TableLeftIndent":return"leftIndent";case"DefaultCellLeftMargin":return"leftMargin";case"DefaultCellRightMargin":return"rightMargin";case"DefaultCellBottomMargin":return"bottomMargin";case"DefaultCellTopMargin":return"topMargin";case"TablePreferredWidth":return"preferredWidth";case"TablePreferredWidthType":return"preferredWidthType";case"Shading":return"shading";case"TableBidi":return"bidi";default:return"cellSpacing"}},r.prototype.createSectionFormat=function(e){var t,i,n={};if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)_.isNullOrUndefined(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.writeSectionFormat(this.owner.selectionModule.start.paragraph.bodyWidget.sectionFormat,n,0);else{if("LinkToPrevious"===e)return i=(t=this.owner.selectionModule.start.paragraph.bodyWidget).sectionIndex,t=t.headerFooterType,void(this.format=JSON.stringify({linkToPrevious:this.insertedFormat,sectionIndex:i,headerFooterType:t}));"SectionFormat"===e?(i=this.insertedFormat,this.owner.sfdtExportModule.writeSectionFormat(i,n,0)):n[e[0].toLowerCase()+e.slice(1)]=this.insertedFormat}this.format=JSON.stringify(n)},r.prototype.getRowString=function(e){switch(e){case"RowHeight":return"height";case"RowHeightType":return"heightType";case"RowHeader":return"isHeader";default:return"allowBreakAcrossPages"}},r.prototype.getCellString=function(e){switch(e){case"CellContentVerticalAlignment":return"verticalAlignment";case"CellLeftMargin":return"leftMargin";case"CellRightMargin":return"rightMargin";case"CellBottomMargin":return"bottomMargin";case"CellTopMargin":return"topMargin";case"CellPreferredWidth":return"preferredWidth";case"Shading":return"shading";default:return"preferredWidthType"}},r);function r(e){this.cellOperation=[],this.splittedRevisions=[],this.isRemovedNodes=!1,this.modifiedFormatOperation=[],this.revisionOperation=[],this.markerData=[],this.ownerIn=e,this.documentHelper=e.documentHelper,this.modifiedPropertiesIn=[],this.modifiedNodeLength=[],this.removedNodesIn=[],this.insertedNodes=[]}Vg=function(e,t){return(Vg=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}))(e,t)};(function(e,t){function i(){this.constructor=e}Vg(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)})(_g,zg=Ug),Object.defineProperty(_g.prototype,"hasAction",{get:function(){return!_.isNullOrUndefined(this.modifiedActions)},enumerable:!0,configurable:!0}),_g.prototype.addModifiedAction=function(e){this.editorHistory.isUndoing||this.editorHistory.isRedoing||(_.isNullOrUndefined(this.modifiedActions)&&(this.modifiedActions=[]),this.modifiedActions.push(e))},_g.prototype.getActionInfo=function(e){var t=this.action,i=[];switch(t){case"InsertBookmark":case"RestrictEditing":if(this.editorHistory.isUndoing)for(var n=0;n<this.modifiedActions.length;n++)"RestrictEditing"===t&&this.modifiedActions[parseInt(n.toString(),10)].markerData.push(this.owner.editorModule.getMarkerData(this.modifiedActions[parseInt(n.toString(),10)].removedNodes[0])),i.push(this.modifiedActions[parseInt(n.toString(),10)].getDeleteOperation("DeleteBookmark",0===n||void 0)),this.modifiedActions[parseInt(n.toString(),10)].markerData.shift();else for(n=0;n<this.modifiedActions.length;n++)"DeleteBookmark"===(c=this.modifiedActions[parseInt(n.toString(),10)]).action?(i.push(c.getDeleteOperation("DeleteBookmark")),i.push(c.getDeleteOperation("DeleteBookmark",!0))):i.push(c.getInsertOperation(t));break;case"BackSpace":case"Delete":case"RemoveEditRange":if(this.editorHistory.isUndoing){for(n=0;n<this.modifiedActions.length;n++)"InsertInline"===(c=this.modifiedActions[parseInt(n.toString(),10)]).action?(o=c.getDeleteOperation("DeleteBookmark",!0),i.push(o)):(l=c.getActionInfo(),i=i.concat(l),"RemoveEditRange"===c.action&&i.push(c.getDeleteOperation(t,!0)));i.reverse()}else for(n=0;n<this.modifiedActions.length;n++)"InsertInline"===(c=this.modifiedActions[parseInt(n.toString(),10)]).action?(o=c.getInsertOperation("InsertBookmark"),i.push(o)):(i.push(c.getDeleteOperation(t)),"RemoveEditRange"===c.action&&i.push(c.getDeleteOperation(t,!0)));break;case"PageBreak":case"ColumnBreak":if(this.owner.enableTrackChanges)for(n=0;n<this.modifiedActions.length;n++){0<(c=this.modifiedActions[parseInt(n.toString(),10)]).removedNodes.length&&(i=i.concat(c.getDeleteOperationsForTrackChanges()));var r=c.markerData[c.markerData.length-1],o=c.getInsertOperation("Enter"),s=this.getInsertOperation(t);o.markerData=r,s.markerData=this.owner.editorModule.getMarkerData(void 0,void 0,this.owner.editorModule.getRevision(r.revisionId)),i.push(o),i.push(s),i.push(o),o.markerData.skipOperation=!0}else if(this.editorHistory.isUndoing)for(n=0;n<this.modifiedActions.length;n++)(c=this.modifiedActions[parseInt(n.toString(),10)]).endIndex=c.startIndex,i.push(c.getDeleteOperation("Delete")),i.push(c.getDeleteOperation("Delete")),i.push(c.getDeleteOperation("Delete")),c.isRemovedNodes&&(l=c.getDeleteContent("BackSpace"),i=i.concat(l));else{for(n=0;n<this.modifiedActions.length;n++)0<(c=this.modifiedActions[parseInt(n.toString(),10)]).removedNodes.length&&i.push(c.getDeleteOperation(t));(o=this.getInsertOperation("Enter")).markerData={skipOperation:!0},i.push(o),i.push(o),i.push(this.getInsertOperation(t)),i.push(o)}break;case"InsertHyperlink":case"AutoFormatHyperlink":case"RemoveHyperlink":if(this.editorHistory.isUndoing&&"RemoveHyperlink"===t){for(var a=0,n=0;n<this.modifiedActions.length;n++)"FontColor"!==(c=this.modifiedActions[parseInt(n.toString(),10)]).action&&"Underline"!==c.action||(a=c.endIndex-c.startIndex);_.isNullOrUndefined(this.modifiedActions[parseInt((this.modifiedActions.length-1).toString(),10)].fieldBegin)||(this.modifiedActions[parseInt((this.modifiedActions.length-1).toString(),10)].endIndex=this.modifiedActions[parseInt((this.modifiedActions.length-1).toString(),10)].startIndex+a,(o=this.modifiedActions[parseInt((this.modifiedActions.length-1).toString(),10)].getDeleteOperation("Delete")).markerData=void 0,i.push(o),l=this.modifiedActions[parseInt((this.modifiedActions.length-1).toString(),10)].getFieldOperation(),i=i.concat(l))}else{for(n=0;n<this.modifiedActions.length;n++)"InsertHyperlink"===(c=this.modifiedActions[parseInt(n.toString(),10)]).action?i.push.apply(i,c.getActionInfo()):"InsertInline"===c.action?c.insertedText===L.Marker_Start||c.insertedText===L.Marker_End?this.editorHistory.isUndoing?i.push(c.getDeleteOperation(c.action)):i.push(c.getInsertOperation("InsertHyperlink")):this.editorHistory.isUndoing?i.push(c.getDeleteOperation(c.action)):i.push(c.getInsertOperation("Insert")):"Delete"===c.action?i.push(c.getDeleteOperation(c.action)):"Underline"!==c.action&&"FontColor"!==c.action||(i=i.concat(c.getActionInfo()));this.editorHistory.isUndoing&&i.reverse()}break;case"InsertComment":if(this.editorHistory.isUndoing)this.getDeleteCommentOperation(this.modifiedActions,i);else for(n=0;n<this.modifiedActions.length;n++){o=(c=this.modifiedActions[parseInt(n.toString(),10)]).getInsertOperation(c.action);c.insertedElement instanceof up&&"InsertInline"===c.action?i.push(c.getCommentOperation(o,c.action)):"InsertCommentWidget"===c.action&&(o=this.getUpdateOperation(),i.push(c.getCommentOperation(o,c.action)))}break;case"RemoveComment":if(this.editorHistory.isUndoing)for(n=this.modifiedActions.length-1;0<=n;n--){var o=void 0,l=[];"InsertInline"===(c=this.modifiedActions[parseInt(n.toString(),10)]).action&&c.insertedElement instanceof up?(o=c.getDeleteOperation(c.action),l.push(c.getCommentOperation(o,"InsertInline"))):"RemoveInline"===c.action?(o=c.getDeleteOperation(c.action),l.push(c.getCommentOperation(o,"InsertInline")),o=c.getInsertOperation(c.action),l.push(c.getCommentOperation(o,"InsertInline"))):"DeleteComment"===c.action?l=c.getActionInfo():(this.owner.sfdtExportModule.iscontentInsert=!1,l=c.getActionInfo(),this.owner.sfdtExportModule.iscontentInsert=!0),i=i.concat(l)}else for(n=0;n<this.modifiedActions.length;n++){o=void 0,l=[];"RemoveInline"===(c=this.modifiedActions[parseInt(n.toString(),10)]).action&&c.removedNodes[0]instanceof up?(o=c.getDeleteOperation(c.action),l.push(c.getCommentOperation(o,c.action))):"InsertInline"===c.action&&c.insertedElement instanceof up?(o=c.getInsertOperation(c.action),l.push(c.getCommentOperation(o,c.action))):l=c.getActionInfo(),i=i.concat(l)}break;case"DeleteComment":if(this.editorHistory.isUndoing)for(var d=this.modifiedActions.length-1;0<=d;d--){var h=this.modifiedActions[parseInt(d.toString(),10)],o=h.getInsertOperation(h.action);h.insertedElement instanceof up&&"RemoveInline"===h.action?i.push(h.getCommentOperation(o,"InsertInline")):"DeleteCommentWidget"===h.action?(o=this.getUpdateOperation(),i.push(h.getCommentOperation(o,"InsertCommentWidget"))):"DeleteComment"===h.action&&h.getActionInfo()}else this.getDeleteCommentOperation(this.modifiedActions,i);break;case"FormField":i=(c=this.modifiedActions.pop()).getFieldOperation();break;case"IMEInput":if(!e||this.editorHistory.isUndoing||this.editorHistory.isRedoing){var c=this.modifiedActions[this.modifiedActions.length-1];if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)for(n=0;n<this.modifiedActions.length;n++)0<(c=this.modifiedActions[parseInt(n.toString(),10)]).removedNodes.length&&i.push(c.getDeleteOperation(t)),c.isRemovedNodes&&(l=c.getDeleteContent("BackSpace"),i=i.concat(l)),c.isRemovedNodes=!1;else 0<c.removedNodes.length&&i.push(c.getDeleteOperation(t)),i.push(c.getInsertOperation(this.action));c.isRemovedNodes=!1}else{0<this.modifiedActions[0].removedNodes.length&&((p=this.modifiedActions[0].getDeleteOperation("Delete")).length=p.text.length,i.push(p));var p=this.modifiedActions[this.modifiedActions.length-1].getInsertOperation("Insert");p.length=p.text.length,i.push(p),i.reverse();for(n=0;n<i.length;n++)"Insert"===(o=i[parseInt(n.toString(),10)]).action?o.action="Delete":"Delete"===o.action&&(o.action="Insert")}break;case"Accept All":case"ReplaceAll":case"Reject All":if(this.editorHistory.isUndoing)for(n=this.modifiedActions.length-1;0<=n;n--){c=this.modifiedActions[parseInt(n.toString(),10)];!_.isNullOrUndefined(c.cellOperation)&&0<c.cellOperation.length?(i.push(c.cellOperation[0]),c.cellOperation=[]):(u=c.getActionInfo(),i.push.apply(i,u))}else for(n=0;n<this.modifiedActions.length;n++){var u,c=this.modifiedActions[parseInt(n.toString(),10)];!_.isNullOrUndefined(c.cellOperation)&&0<c.cellOperation.length?(i.push(c.cellOperation[0]),c.cellOperation=[]):(u=c.getActionInfo(),i.push.apply(i,u))}break;case"Paste":for(n=0;n<this.modifiedActions.length;n++){(c=this.modifiedActions[parseInt(n.toString(),10)]).type="PasteToc"===this.type?this.type:"Paste";var g=c.getActionInfo();i.push.apply(i,g)}break;case"TOC":if(this.modifiedActions)if(this.editorHistory.isUndoing)for(n=this.modifiedActions.length-1;0<=n;n--){(c=this.modifiedActions[parseInt(n.toString(),10)]).type="Paste"===c.action?"PasteToc":void 0;var m=c.getActionInfo();i.push.apply(i,m)}else for(n=0;n<this.modifiedActions.length;n++){m=((c=this.modifiedActions[parseInt(n.toString(),10)]).type="Paste"===c.action?"PasteToc":void 0,c.getActionInfo());i.push.apply(i,m)}break;case"DragAndDropContent":for(n=0;n<this.modifiedActions.length;n++){(c=this.modifiedActions[parseInt(n.toString(),10)]).type="Paste"===c.action?"Paste":void 0;var f=c.getActionInfo();i.push.apply(i,f)}break;case"ClearFormat":if(this.editorHistory.isUndoing)for(n=0;n<this.modifiedActions.length;n++)i.push.apply(i,this.modifiedActions[parseInt(n.toString(),10)].modifiedFormatOperation),this.modifiedActions[parseInt(n.toString(),10)].modifiedFormatOperation=[];else i=this.modifiedActions[this.modifiedActions.length-1].buildFormatOperation("ClearFormat",!0).slice();break;case"ApplyStyle":var y=[];if(this.modifiedActions[0]instanceof _g&&(i=(y=this.modifiedActions[0].modifiedActions[0].buildFormatOperation("ClearFormat",!0)).slice()),!(this.modifiedActions[this.modifiedActions.length-1]instanceof _g)){y=this.modifiedActions[this.modifiedActions.length-1].buildFormatOperation(t,!0);for(n=0;n<y.length;n++)i.push(y[parseInt(n.toString(),10)])}break;case"TableMarginsSelection":this.modifiedActions[this.modifiedActions.length-1].createTableFormat(this.modifiedActions[this.modifiedActions.length-1].action),this.modifiedActions[this.modifiedActions.length-1].type="TableFormat",i.push(this.modifiedActions[this.modifiedActions.length-1].getFormatOperation());break;case"BordersAndShading":"TableFormat"===this.modifiedActions[0].action?(this.modifiedActions[0].type="TableFormat",this.modifiedActions[0].createTableFormat("BordersAndShading"),i.push(this.modifiedActions[0].getFormatOperation())):(this.modifiedActions[0].createCellFormat("BordersAndShading"),this.modifiedActions[0].type="CellFormat",i=this.modifiedActions[0].getSelectedCellOperation("BordersAndShading",void 0,!0,!0,!0));break;case"AutoList":for(n=0;n<this.modifiedActions.length;n++){var v=(c=this.modifiedActions[parseInt(n.toString(),10)]).getActionInfo();i.push.apply(i,v)}break;case"TableProperties":for(n=0;n<this.modifiedActions.length;n++){var w=this.modifiedActions[parseInt(n.toString(),10)];if("TableFormat"===w.action)w.createTableFormat(w.action),w.type="TableFormat",i.push(w.getFormatOperation());else if("RowFormat"===w.action)this.editorHistory.isUndoing||this.editorHistory.isRedoing&&1<w.modifiedProperties.length?(i=w.modifiedFormatOperation,w.modifiedFormatOperation=[]):(w.createRowFormat(w.action),w.type="RowFormat",i.push(w.getFormatOperation()));else if("CellFormat"===w.action){w.createCellFormat(w.action),w.type="CellFormat";for(var b=w.getSelectedCellOperation(w.action,!1,!1,!1,!0),x=0;x<b.length;x++)i.push(b[parseInt(x.toString(),10)])}}break;case"CellMarginsSelection":this.modifiedActions[this.modifiedActions.length-1].createCellFormat("CellOptions"),this.modifiedActions[this.modifiedActions.length-1].type="CellFormat",i=this.modifiedActions[this.modifiedActions.length-1].getSelectedCellOperation("CellOptions",!1,!1,!1,!0).slice()}return i},_g.prototype.revert=function(){if("BordersAndShading"===(this.editorHistory.currentHistoryInfo=this).action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),!_.isNullOrUndefined(this.modifiedActions))if(this.editorHistory.isUndoing)for(var e=this.modifiedActions.length;0<e;)this.modifiedActions[e-1].revert(),e-=1;else for(e=0;e<this.modifiedActions.length;)this.modifiedActions[parseInt(e.toString(),10)].revert(),e+=1;var t,i;"RestrictEditing"===this.action&&(t=""!==this.editRangeStart.user?this.editRangeStart.user:this.editRangeStart.group,this.editorHistory.isUndoing?-1!==(i=this.owner.documentHelper.editRanges.get(t).indexOf(this.editRangeStart))&&this.owner.documentHelper.editRanges.get(t).splice(i,1):this.owner.editorModule.updateRangeCollection(this.editRangeStart,t),this.owner.selectionModule.updateEditRangeCollection()),this.isChildHistoryInfo?this.editorHistory.updateComplexHistoryInternal():this.editorHistory.updateComplexHistory()},_g.prototype.destroy=function(){if(!_.isNullOrUndefined(this.modifiedActions)){for(;0<this.modifiedActions.length;){var e=this.modifiedActions[this.modifiedActions.length-1];e.destroy(),this.modifiedActions.splice(this.modifiedActions.indexOf(e),1)}this.modifiedActions=void 0}zg.prototype.destroy.call(this)};var Vg,zg,qg=_g;function _g(e,t){var i=zg.call(this,e)||this;return i.isChildHistoryInfo=!1,i.editRangeStart=void 0,i.documentHelper=e.documentHelper,i.isChildHistoryInfo=t,i}Object.defineProperty(Gg.prototype,"currentHistoryInfo",{get:function(){return this.historyInfoStack&&0<this.historyInfoStack.length?this.historyInfoStack[this.historyInfoStack.length-1]:void 0},set:function(e){e instanceof qg?this.historyInfoStack.push(e):this.historyInfoStack.pop()},enumerable:!0,configurable:!0}),Object.defineProperty(Gg.prototype,"undoStack",{get:function(){return this.undoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(Gg.prototype,"redoStack",{get:function(){return this.redoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(Gg.prototype,"undoLimit",{get:function(){return _.isNullOrUndefined(this.undoLimitIn)?0:this.undoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.undoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Gg.prototype,"redoLimit",{get:function(){return _.isNullOrUndefined(this.redoLimitIn)?0:this.redoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.redoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Gg.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Gg.prototype.getModuleName=function(){return"EditorHistory"},Gg.prototype.canUndo=function(){return!_.isNullOrUndefined(this.undoStack)&&0<this.undoStack.length},Gg.prototype.canRedo=function(){return!_.isNullOrUndefined(this.redoStack)&&0<this.redoStack.length},Gg.prototype.initializeHistory=function(e){_.isNullOrUndefined(this.currentBaseHistoryInfo)||this.currentBaseHistoryInfo.destroy(),this.currentBaseHistoryInfo=new Ug(this.owner),"ModifyStyle"!==(this.currentBaseHistoryInfo.action=e)&&this.currentBaseHistoryInfo.updateSelection()},Gg.prototype.initComplexHistory=function(e,t){switch(this.currentHistoryInfo=new qg(e.owner,!_.isNullOrUndefined(this.currentHistoryInfo)),this.currentHistoryInfo.action=t){case"PageBreak":this.currentHistoryInfo.insertedText=L.PageBreak,this.currentHistoryInfo.insertPosition=e.startOffset;break;case"ColumnBreak":this.currentHistoryInfo.insertedText=L.ColumnBreak,this.currentHistoryInfo.insertPosition=e.startOffset}this.currentHistoryInfo.updateSelection()},Gg.prototype.initResizingHistory=function(e,t){var i;1===t.resizeNode?(this.initializeHistory("RowResizing"),_.isNullOrUndefined(this.currentBaseHistoryInfo)||(t.currentResizingTable=t.currentResizingTable.combineWidget(this.viewer),this.currentBaseHistoryInfo.modifiedProperties.push(new Og(t.currentResizingTable,e,t.currentResizingTable.childWidgets[t.resizerPosition].rowFormat,this.owner)),this.documentHelper.layout.reLayoutTable(t.currentResizingTable))):(this.initializeHistory("CellResizing"),this.currentBaseHistoryInfo&&(t.currentResizingTable=t.currentResizingTable.combineWidget(this.viewer),(i=new Lg(t.currentResizingTable,this.owner)).startingPoint=e,this.currentBaseHistoryInfo.modifiedProperties.push(i),this.documentHelper.layout.reLayoutTable(t.currentResizingTable)))},Gg.prototype.beginUndoAction=function(){this.isUndoGroupingEnded&&(this.owner.editorModule.initComplexHistory("Grouping"),this.isUndoGroupingEnded=!1,this.clearRedoStack())},Gg.prototype.endUndoAction=function(){this.isUndoGroupingEnded||(this.updateComplexHistory(),this.isUndoGroupingEnded=!0)},Gg.prototype.updateResizingHistory=function(e,t){var i;1===t.resizeNode?_.isNullOrUndefined(this.currentBaseHistoryInfo)||((i=this.currentBaseHistoryInfo.modifiedProperties[0]).startingPoint.y===e.y?this.currentBaseHistoryInfo.modifiedProperties.length=0:(i.displacement=j.convertPixelToPoint(e.y-i.startingPoint.y),this.recordChanges(this.currentBaseHistoryInfo),this.owner.fireContentChange(),this.currentBaseHistoryInfo=void 0)):_.isNullOrUndefined(this.currentBaseHistoryInfo)||((i=this.currentBaseHistoryInfo.modifiedProperties[0]).startingPoint.x===e.x?this.currentBaseHistoryInfo.modifiedProperties.length=0:(i.displacement=j.convertPixelToPoint(e.x-i.startingPoint.x),i.endIndex=t.getCellReSizerPosition(e),this.owner.editorHistoryModule.recordChanges(this.currentBaseHistoryInfo),this.owner.fireContentChange(),this.currentBaseHistoryInfo=void 0))},Gg.prototype.recordChanges=function(e){var t;this.owner.enableHistoryMode&&(this.isUndoing?(_.isNullOrUndefined(this.redoStack)&&(this.redoStackIn=[]),this.redoStack.length===this.redoLimit&&0<this.redoLimit&&(t=20<this.undoLimit?10:1,this.redoStackIn.splice(0,t)),this.redoStack.length<this.redoLimit&&this.redoStack.push(e)):(this.isRedoing||this.clearRedoStack(),_.isNullOrUndefined(this.undoStack)&&(this.undoStackIn=[]),this.undoStack.length===this.undoLimit&&0<this.undoLimit&&(t=20<this.undoLimit?10:1,this.undoStackIn.splice(0,t)),this.undoStack.length<this.undoLimit&&this.undoStackIn.push(e)),this.lastOperation=e)},Gg.prototype.updateHistory=function(){this.documentHelper.owner.enableHistoryMode&&!_.isNullOrUndefined(this.currentBaseHistoryInfo)&&(!_.isNullOrUndefined(this.currentBaseHistoryInfo)&&_.isNullOrUndefined(this.currentBaseHistoryInfo.endPosition)&&(this.currentBaseHistoryInfo.endPosition=this.currentBaseHistoryInfo.insertPosition),_.isNullOrUndefined(this.currentHistoryInfo)?this.recordChanges(this.currentBaseHistoryInfo):this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)},Gg.prototype.isHandledComplexHistory=function(){var e=!1;return this.isUndoing||this.isRedoing||(0<this.owner.editorModule.removedBookmarkElements.length&&this.owner.editorModule.insertRemoveBookMarkElements(e)&&(e=!0),0<this.owner.editorModule.removedEditRangeEndElements.length&&this.owner.editorModule.insertRemovedEditRangeEndElements(e)&&(e=!0),0<this.owner.editorModule.removedEditRangeStartElements.length&&this.owner.editorModule.insertRemovedEditRangeStartElements(e)&&(e=!0)),this.documentHelper.owner.enableHistoryMode&&!_.isNullOrUndefined(this.currentHistoryInfo)?"Grouping"!==this.currentHistoryInfo.action&&(this.updateHistory(),e=!0):this.owner.editorModule.isHandledComplex&&(e=!0),e},Gg.prototype.updateComplexHistory=function(){var e,t,i=this.documentHelper.selection;!_.isNullOrUndefined(this.currentHistoryInfo)&&this.currentHistoryInfo.hasAction&&("AutoFormatHyperlink"!==this.currentHistoryInfo.action&&"SkipCommentInline"!==this.currentHistoryInfo.action&&"DeleteCommentInline"!==this.currentHistoryInfo.action&&"RemoveComment"!==this.currentHistoryInfo.action||(i.owner.editorHistoryModule.isUndoing?(this.owner.editorModule.setPositionForCurrentIndex(i.start,this.currentHistoryInfo.selectionStart),this.owner.editorModule.setPositionForCurrentIndex(i.end,this.currentHistoryInfo.selectionEnd)):(this.owner.editorModule.setPositionForCurrentIndex(i.start,this.currentHistoryInfo.endPosition),this.owner.editorModule.setPositionForCurrentIndex(i.end,this.currentHistoryInfo.endPosition))),"InsertHyperlink"===this.currentHistoryInfo.action&&(e=new y(i.owner),_.isNullOrUndefined(this.currentHistoryInfo.insertPosition)||(this.owner.editorModule.setPositionForCurrentIndex(e,this.currentHistoryInfo.insertPosition),t=new y(i.owner),this.owner.editorModule.setPositionForCurrentIndex(t,this.currentHistoryInfo.endPosition),this.documentHelper.layout.reLayoutParagraph(e.paragraph,0,0),t.paragraph!==e.paragraph&&this.documentHelper.layout.reLayoutParagraph(t.paragraph,0,0))),"ReplaceAll"===this.currentHistoryInfo.action?(this.documentHelper.contentControlCollection=[],this.owner.editorModule.layoutWholeDocument()):i.owner.isShiftingEnabled&&(_.isNullOrUndefined(i.editRegionHighlighters)||i.editRegionHighlighters.clear(),this.documentHelper.layout.shiftLayoutedItems(!1),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget(),this.documentHelper.removeEmptyPages())),this.owner.showRevisions&&this.owner.trackChangesPane.updateTrackChanges(),i.owner.isShiftingEnabled=!1,i.owner.isLayoutEnabled=!0,_.isNullOrUndefined(this.currentHistoryInfo)||"ApplyStyle"!==this.currentHistoryInfo.action?(i.start.updatePhysicalPosition(!0),i.isEmpty?i.end.setPositionInternal(i.start):i.end.updatePhysicalPosition(!0)):this.owner.editorModule.getOffsetValue(i),i.upDownSelectionLength=i.end.location.x,this.documentHelper.isScrollHandler=!0,this.viewer.updateScrollBars(),i.fireSelectionChanged(!0),this.documentHelper.isScrollHandler=!1,this.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.updateComplexHistoryInternal(),this.owner.editorModule.isInsertingTOC||this.owner.editorModule.fireContentChange()},Gg.prototype.updateComplexHistoryInternal=function(){_.isNullOrUndefined(this.currentHistoryInfo)||(_.isNullOrUndefined(this.currentHistoryInfo.endPosition)&&(this.currentHistoryInfo.endPosition=this.currentHistoryInfo.insertPosition),1<this.historyInfoStack.length?this.historyInfoStack[this.historyInfoStack.length-2].addModifiedAction(this.currentHistoryInfo):this.recordChanges(this.currentHistoryInfo),this.currentHistoryInfo=void 0)},Gg.prototype.updateListChangesInHistory=function(e,t){this.currentBaseHistoryInfo=new Ug(this.documentHelper.owner),this.currentBaseHistoryInfo.action="List",this.currentBaseHistoryInfo.updateSelection();for(var i=new T,n=0;n<e.levels.length;n++){var r=this.documentHelper.getAbstractListById(t.abstractListId).levels[parseInt(n.toString(),10)],o=(this.currentBaseHistoryInfo.addModifiedPropertiesForList(r),new Sg(r,e.levels[parseInt(n.toString(),10)]));_.isNullOrUndefined(r)||this.documentHelper.owner.editorModule.copyListLevel(r,e.levels[parseInt(n.toString(),10)]),i.add(n,o)}return i},Gg.prototype.applyListChanges=function(e,t){_.isNullOrUndefined(this.modifiedParaFormats)&&(this.modifiedParaFormats=new T);for(var i=[],n=0;n<this.documentHelper.listParagraphs.length;n++){var r,o=this.documentHelper.listParagraphs[parseInt(n.toString(),10)].paragraphFormat,s=this.documentHelper.getListById(o.listFormat.listId),s=this.documentHelper.layout.getListLevel(s,o.listFormat.listLevelNumber);t.containsKey(o.listFormat.listLevelNumber)&&t.get(o.listFormat.listLevelNumber).ownerListLevel===s&&((r=new Xa(null)).leftIndent=o.leftIndent,r.firstLineIndent=o.firstLineIndent,r=new Ng(o,r),i.push(r),this.owner.editorModule.copyFromListLevelParagraphFormat(o,s.paragraphFormat))}this.modifiedParaFormats.add(this.currentBaseHistoryInfo,i)},Gg.prototype.updateListChanges=function(e){this.documentHelper.owner.isLayoutEnabled=!1,this.owner.editorModule.updateListParagraphs();for(var t=0;t<e.keys.length;t++){var i=e.keys[parseInt(t.toString(),10)],i=e.get(i);_.isNullOrUndefined(this.currentBaseHistoryInfo)||(i=this.currentBaseHistoryInfo.addModifiedPropertiesForList(i.ownerListLevel)),this.owner.editorModule.copyListLevel(i.ownerListLevel,i.modifiedListLevel)}this.documentHelper.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.owner.editorModule.layoutWholeDocument();var n=this.documentHelper.selection;n.start.updatePhysicalPosition(!0),n.isEmpty?n.end.setPositionInternal(n.start):n.end.updatePhysicalPosition(!0),n.upDownSelectionLength=n.end.location.x,n.fireSelectionChanged(!1),this.updateHistory()},Gg.prototype.undo=function(){var e;(!this.owner.isReadOnlyMode||this.owner.documentHelper.isCommentOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canUndo()&&this.owner.enableHistoryMode&&(e=this.undoStack.pop(),this.isUndoing=!0,e.revert(),this.isUndoing=!1,this.owner.selection.contentControleditRegionHighlighters.clear(),this.owner.selection.onHighlightContentControl(),this.owner.selectionModule.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1)},Gg.prototype.redo=function(){var e;(!this.owner.isReadOnlyMode||this.owner.documentHelper.isCommentOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canRedo()&&this.owner.enableHistoryMode&&("BordersAndShading"===(e=this.redoStack.pop()).action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),this.isRedoing=!0,e.revert(),this.isRedoing=!1,this.owner.selection.contentControleditRegionHighlighters.clear(),this.owner.selection.onHighlightContentControl(),this.owner.selectionModule.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1)},Gg.prototype.destroy=function(){this.clearHistory(),this.undoStackIn=void 0,this.redoStackIn=void 0},Gg.prototype.clearHistory=function(){this.clearUndoStack(),this.clearRedoStack()},Gg.prototype.clearUndoStack=function(){if(this.canUndo())for(;0<this.undoStack.length;)this.undoStack.pop().destroy(),0},Gg.prototype.clearRedoStack=function(){if(this.canRedo())for(;0<this.redoStack.length;)this.redoStack.pop().destroy(),0};var jg=Gg;function Gg(e){this.undoStackIn=[],this.redoStackIn=[],this.historyInfoStack=[],this.isUndoGroupingEnded=!0,this.isUndoing=!1,this.isRedoing=!1,this.owner=e,this.documentHelper=e.documentHelper,this.modifiedParaFormats=new T,this.undoLimitIn=500,this.redoLimitIn=500}Object.defineProperty(Zg.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Zg.prototype.getModuleName=function(){return"TableResizer"},Zg.prototype.updateResizingHistory=function(e){this.owner.editorHistoryModule&&this.owner.editorHistoryModule.updateResizingHistory(e,this),this.documentHelper.isRowOrCellResizing=!1,this.resizerPosition=-1},Zg.prototype.handleResize=function(e){this.owner.documentHelper.isRowOrCellResizing=!0,this.startingPoint.x=e.x,this.startingPoint.y=e.y,this.owner.editorHistoryModule.initResizingHistory(e,this)},Zg.prototype.isInRowResizerArea=function(e){e=this.getRowReSizerPosition(void 0,e);return-1!==e&&(this.resizeNode=1,this.resizerPosition=e,!0)},Zg.prototype.isInCellResizerArea=function(e){e=this.getCellReSizerPosition(e);return-1!==e&&(this.resizeNode=0,this.resizerPosition=e,!0)},Zg.prototype.getCellReSizerPosition=function(e){var t=-1,i=this.getTableWidget(e),n=this.getTableCellWidget(e),r=_.isNullOrUndefined(i)?0:i.tableFormat.cellSpacing;if(i&&0<r){if(this.currentResizingTable=i,this.documentHelper.isInsideRect(i.x-j.convertPointToPixel(i.leftBorderWidth)-.25,i.y,j.convertPointToPixel(i.leftBorderWidth)+.5,i.height,e))return 0;for(var o=i.x,s=0;s<i.tableHolder.columns.length;s++){var a=j.convertPointToPixel(i.tableHolder.columns[parseInt(s.toString(),10)].preferredWidth);if(this.documentHelper.isInsideRect(o-1,i.y,i.leftBorderWidth+2,i.height,e))return 0<s?s:0;if(0<s&&this.documentHelper.isInsideRect(o+a-1,i.y,2,i.height,e))return s+1;o+=a}}else if(!_.isNullOrUndefined(n)){if(this.currentResizingTable=n.ownerTable,this.documentHelper.isInsideRect(n.x-n.margin.left-1,n.y-n.margin.top,2,n.height+n.margin.top+n.margin.bottom,e))return n.columnIndex;if(_.isNullOrUndefined(n.nextRenderedWidget)&&this.documentHelper.isInsideRect(n.x+n.margin.right+n.width-1,n.y-n.margin.top,2,n.height+n.margin.top+n.margin.bottom,e))return n.columnIndex+n.cellFormat.columnSpan;if(0<n.childWidgets.length)return this.getCellReSizerPositionInternal(n,e)}return t},Zg.prototype.getCellReSizerPositionInternal=function(e,t){var i=-1,n=this.getTableWidgetFromWidget(t,e),e=void 0;if(!_.isNullOrUndefined(n)&&0<n.tableFormat.cellSpacing){if(this.currentResizingTable=n,this.documentHelper.isInsideRect(n.x-n.leftBorderWidth-.25,n.y,n.leftBorderWidth+.5,n.height,t))return 0;for(var r=n.x,o=0;o<n.tableHolder.columns.length;o++){var s=j.convertPointToPixel(n.tableHolder.columns[parseInt(o.toString(),10)].preferredWidth);if(this.documentHelper.isInsideRect(r-1,n.y,n.leftBorderWidth+2,n.height,t))return 0<o?o:0;if(0<o&&this.documentHelper.isInsideRect(r+s-1,n.y,2,n.height,t))return o+1;r+=s}}else if(_.isNullOrUndefined(n)||(e=n.getTableCellWidget(t)),!_.isNullOrUndefined(e)){if(this.currentResizingTable=e.ownerTable,this.documentHelper.isInsideRect(e.x-e.margin.left-1,e.y-e.margin.top,2,e.height,t))return e.columnIndex;if(_.isNullOrUndefined(e.nextRenderedWidget)&&this.documentHelper.isInsideRect(e.x+e.margin.right+e.width-1,e.y-e.margin.top,2,e.height,t))return e.columnIndex+e.cellFormat.columnSpan;if(0<e.childWidgets.length)return this.getCellReSizerPositionInternal(e,t)}return i},Zg.prototype.getRowReSizerPosition=function(e,t){var i=void 0,n=void 0,r=(_.isNullOrUndefined(e)?(i=this.getTableWidget(t),n=this.getTableCellWidget(t)):i=this.getTableWidgetFromWidget(t,e),_.isNullOrUndefined(i)?0:i.tableFormat.cellSpacing);if(i&&0<r){if(this.currentResizingTable=i,this.owner.documentHelper.isInsideRect(i.x,i.y+i.height-r,this.getActualWidth(i.lastChild),_.isNullOrUndefined(i.nextSplitWidget)?i.bottomBorderWidth+r:0,t))return i.lastChild.rowIndex;for(var o=0;o<i.childWidgets.length;o++){var s=i.childWidgets[parseInt(o.toString(),10)];if(-1<i.childWidgets.indexOf(s)&&this.owner.documentHelper.isInsideRect(s.x,s.y+s.height+r/2,this.getActualWidth(s),r/2,t))return s.rowIndex}}else if(n=i?n&&this.getTableCellWidget(t):n){e=0,e=(s=n.containerWidget).rowIndex===s.ownerTable.childWidgets.length-1?s.bottomBorderWidth+2:s.nextRenderedWidget.topBorderWidth+2;if(this.owner.documentHelper.isInsideRect(s.x,s.y+s.height-e,s.width,2*e,t))return this.currentResizingTable=s.ownerTable,s.rowIndex;if(0<n.childWidgets.length)return this.getRowReSizerPosition(n,t)}return-1},Zg.prototype.handleResizing=function(e,t,i){this.owner.isShiftingEnabled=!0,t?0===this.resizeNode&&this.resizeTableCellColumn(i):0===this.resizeNode?(i=e.x-this.startingPoint.x,this.resizeTableCellColumn(i)):(i=e.y-this.startingPoint.y,this.resizeTableRow(i))},Zg.prototype.resizeTableRow=function(e){var t,i,n=this.currentResizingTable;_.isNullOrUndefined(n)||0===e||-1===this.resizerPosition||(i=this.owner.selectionModule,t=void(n.isInsideTable&&(this.owner.isLayoutEnabled=!1)),-1<this.resizerPosition&&((t=n.childWidgets[this.resizerPosition])&&this.updateRowHeight(t,e),i.selectPosition(i.start,i.end)),n.isInsideTable&&(i=this.owner.documentHelper.layout.getParentTable(n),this.owner.isLayoutEnabled=!0,n=i),this.startingPoint.y+=j.convertPointToPixel(e),this.owner.documentHelper.layout.reLayoutTable(n),this.owner.editorModule.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.owner.editorModule.reLayout(this.owner.selectionModule),this.owner.editorModule.isSkipOperationsBuild=!1,t&&this.getRowReSizerPosition(void 0,this.startingPoint),!this.currentResizingTable)||void 0!==this.currentResizingTable.childWidgets&&void 0!==this.currentResizingTable.childWidgets[this.resizerPosition]||(this.resizerPosition=-1)},Zg.prototype.getTableWidget=function(e){var t=void 0,i=this.owner.documentHelper.currentPage;if(!_.isNullOrUndefined(i))for(var n=0;n<i.bodyWidgets.length;n++){var r=i.bodyWidgets[parseInt(n.toString(),10)];if(t=this.getTableWidgetFromWidget(e,r),!_.isNullOrUndefined(t))break;if("Pages"===this.documentHelper.owner.layoutType){r=i.headerWidget,t=this.getTableWidgetFromWidget(e,r);if(!_.isNullOrUndefined(t))break;r=i.footerWidget;if(t=this.getTableWidgetFromWidget(e,r),!_.isNullOrUndefined(t))break}}return t},Zg.prototype.getTableWidgetFromWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++)if(t.childWidgets[parseInt(i.toString(),10)]instanceof K){var n=t.childWidgets[parseInt(i.toString(),10)],r=0;if(n.wrapTextAround&&(r=n.getTableCellWidth()),!n.wrapTextAround&&n.y<=e.y&&n.y+n.height>=e.y)return n;if(n.wrapTextAround&&n.x<=e.x&&n.x+r>=e.x&&n.y<=e.y&&n.y+n.height>=e.y)return n}},Zg.prototype.getTableCellWidget=function(e){var t=void 0,i=this.owner.documentHelper.currentPage;if(!_.isNullOrUndefined(i))for(var n=0;n<i.bodyWidgets.length;n++){if(t=i.bodyWidgets[parseInt(n.toString(),10)].getTableCellWidget(e),!_.isNullOrUndefined(t))break;if("Pages"===this.documentHelper.owner.layoutType&&this.viewer.owner.enableHeaderAndFooter){t=i.headerWidget.getTableCellWidget(e);if(!_.isNullOrUndefined(t))break;if(t=i.footerWidget.getTableCellWidget(e),!_.isNullOrUndefined(t))break}}return t},Zg.prototype.updateRowHeight=function(e,t){var i,e=e.rowFormat;"Auto"===e.heightType?(e.heightType="AtLeast",i=e.ownerBase,2.7<=(i=this.owner.documentHelper.layout.getRowHeight(i,[i]))+t&&e.height!==i+t&&(e.height=i+t)):2.7<=e.height+t&&e.height!==e.height+t&&(e.height=e.height+t)},Zg.prototype.resizeTableCellColumn=function(e){var t=this.currentResizingTable;if(!(_.isNullOrUndefined(t)||0===e||_.isNullOrUndefined(t.childWidgets)||this.resizerPosition<0)){var i=!0,n=this.owner.selectionModule,r=(this.owner.editorModule.setOffsetValue(n),t=t.combineWidget(this.viewer),this.owner.isLayoutEnabled=!1,this.setPreferredWidth(t),t.getOwnerWidth(!0)),o=t.leftIndent,s=t.tableFormat.tableAlignment;if(i=n.isEmpty?i:this.resizeColumnWithSelection(n,t,e)){if(0===this.resizerPosition){var i=this.resizerPosition,a=t.tableHolder.columns[parseInt(i.toString(),10)],i=a.preferredWidth;if(0<e){var l=e;do{if((d=j.round(a.preferredWidth-e,1))>=a.minimumWidth){a.preferredWidth=d,o=-1440<=(o=t.leftIndent+e)?o<=1440?o:1440:-1440;break}}while(l=e,(e+=d-a.minimumWidth)!==l)}else{var d,l=e;do{if((d=j.round(a.preferredWidth-e,1))<=2112){a.preferredWidth=d,o=-1440<=(o=t.leftIndent+e)?o<=1440?o:1440:-1440;break}}while(l=e,(e-=d-2112)!==l)}var h=e;"Left"!==s&&t.tableHolder.getTotalWidth(0)>r&&"Auto"===t.tableFormat.preferredWidthType&&(t.tableHolder.isFitColumns(r,t.tableHolder.tableWidth,"Auto"===t.tableFormat.preferredWidthType)?t.tableHolder.fitColumns(r,t.tableHolder.tableWidth,"Auto"===t.tableFormat.preferredWidthType,t.tableFormat.allowAutoFit):a.preferredWidth=i,h=0),"Center"===s&&(t.tableHolder.getTotalWidth(0)<r||"Auto"!==t.tableFormat.preferredWidthType)&&(h/=2),t.tableFormat.leftIndent="Left"===s?o:0,t.tableHolder.tableWidth=t.tableHolder.getTotalWidth(0),this.updateCellPreferredWidths(t),"Auto"!==t.tableFormat.preferredWidthType&&t.updateWidth(e),this.updateGridValue(t,!0,h)}else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length)this.resizeColumnAtLastColumnIndex(t,e,r);else{if(-1===this.resizerPosition)return void(this.owner.isLayoutEnabled=!0);this.resizeCellAtMiddle(t,e)}this.owner.isLayoutEnabled=!0,n.selectPosition(n.start,n.end)}else this.updateGridValue(t,!0)}},Zg.prototype.resizeColumnWithSelection=function(e,t,i){var n=this.getTableCellWidget(this.startingPoint);if(n&&(e.selectedWidgets.containsKey(n)||n.previousWidget&&e.selectedWidgets.containsKey(n.previousWidget))){var r=e.getSelectedCells();if(0===this.resizerPosition)this.resizeColumnAtStart(t,i,r);else{if(null!==t&&this.resizerPosition===t.tableHolder.columns.length){for(var o=this.getColumnCells(t,this.resizerPosition,!0),s=0;s<o.length;s++){var a=o[parseInt(s.toString(),10)];-1!==r.indexOf(a)&&this.increaseOrDecreaseWidth(a,i,!0)}this.updateRowsGridAfterWidth(t),t.updateWidth(i)}else{if(-1===this.resizerPosition)return!1;var n=this.resizerPosition,o=this.getColumnCells(t,n,!0),l=this.getColumnCells(t,n,!1),n=this.isColumnSelected(t,n);if(0<o.length&&!n)for(s=0;s<o.length;s++)-1===r.indexOf(o[parseInt(s.toString(),10)])&&(o.splice(s,1),s--);if(0<l.length&&!n)for(s=0;s<l.length;s++)-1===r.indexOf(l[parseInt(s.toString(),10)])&&(l.splice(s,1),s--);if(0===o.length&&0<l.length)for(s=0;s<l.length;s++)(a=l[parseInt(s.toString(),10)]).previousWidget&&o.push(a.previousWidget);else if(0===l.length&&0<o.length)for(s=0;s<o.length;s++)(a=o[parseInt(s.toString(),10)]).nextWidget&&l.push(a.nextWidget);this.changeWidthOfCells(t,o,l,i),t.tableFormat.allowAutoFit&&t.updateWidth(i)}t.tableFormat.allowAutoFit=!1,this.updateGridValue(t,!0,i)}e.selectPosition(e.start,e.end)}return!1},Zg.prototype.resizeColumnAtStart=function(e,t,i){var n=e.leftIndent,r=i[0].ownerRow,o=r.rowFormat;if(0<o.beforeWidth){var s=o.beforeWidth+t;if(0<s)this.updateGridBefore(r,t);else if(s<(l=this.getLeastGridBefore(e,r))&&0!==s){n=e.leftIndent+s,e.tableFormat.leftIndent=-1440<=n?n<=1440?n:1440:-1440;for(var a=0;a<e.childWidgets.length;a++)r!==(d=e.childWidgets[parseInt(a.toString(),10)])&&this.updateGridBefore(d,-s)}}else if(t<0)n=e.leftIndent+t,e.tableFormat.leftIndent=-1440<=n?n<=1440?n:1440:-1440,this.updateWidthForCells(e,i,t);else{var l=this.getLeastGridBefore(e,r),o=e.tableFormat.leftIndent;if(0===o)for(a=0;a<e.childWidgets.length;a++){var d=e.childWidgets[parseInt(a.toString(),10)];-1!==i.indexOf(d.childWidgets[0])&&(this.updateGridBefore(d,t),this.increaseOrDecreaseWidth(d.childWidgets[0],t,!1))}else if(0<l-t)n=e.leftIndent+t,e.tableFormat.leftIndent=-1440<=n?n<=1440?n:1440:-1440,this.updateWidthForCells(e,i,t);else{n=e.leftIndent+l,e.tableFormat.leftIndent=-1440<=n?n<=1440?n:1440:-1440;for(a=0;a<e.childWidgets.length;a++){d=e.childWidgets[parseInt(a.toString(),10)];-1!==i.indexOf(d.childWidgets[0])?(this.increaseOrDecreaseWidth(d.childWidgets[0],t,!1),this.updateGridBefore(d,t-l)):this.updateGridBefore(d,-l)}}}e.tableFormat.allowAutoFit=!1,this.updateGridValue(e,!0,t)},Zg.prototype.updateWidthForCells=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[parseInt(n.toString(),10)];-1!==t.indexOf(r.childWidgets[0])?this.increaseOrDecreaseWidth(r.childWidgets[0],i,!1):this.updateGridBefore(r,-i)}},Zg.prototype.resizeColumnAtLastColumnIndex=function(e,t,i){for(var n=e.tableFormat.tableAlignment,r=e.tableFormat.preferredWidth,o=this.resizerPosition,s=e.tableHolder.columns[o-1],a=0;t!==a;){var l=j.round(s.preferredWidth+t,1);l>=s.minimumWidth?(s.preferredWidth=l,a=t):(a=t,t-=l-s.minimumWidth)}this.updateCellPreferredWidths(e),(r||e.tableHolder.getTotalWidth(0)>i)&&(e.tableFormat.allowAutoFit=!1,e.updateWidth(t),e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(0));o=t;"Right"===n?o=0:"Center"===n&&(o/=2),this.updateGridValue(e,!0,o)},Zg.prototype.resizeCellAtMiddle=function(e,t){var i=this.resizerPosition,n=e.tableHolder.columns[i-1],r=e.tableHolder.columns[parseInt(i.toString(),10)];if(0<t)for(var o=!0;o;)(s=j.round(r.preferredWidth-t,1))>=r.minimumWidth?(r.preferredWidth=s,n.preferredWidth=n.preferredWidth+t,o=!1):t+=s-r.minimumWidth;else for(var s,o=!0;o;)(s=j.round(n.preferredWidth+t,1))>=n.minimumWidth?(n.preferredWidth=s,r.preferredWidth=r.preferredWidth-t,o=!1):t-=s-n.minimumWidth;this.updateCellPreferredWidths(e),e.tableFormat.allowAutoFit&&e.updateWidth(t),e.tableFormat.allowAutoFit=!1,e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(0),this.updateGridValue(e,!1,t)},Zg.prototype.updateGridValue=function(e,t,i){t&&(e.calculateGrid(),e.isGridUpdated=!1),e.buildTableColumns(),e.isGridUpdated=!0,this.viewer.owner.isLayoutEnabled=!0,e.isInsideTable?(t=this.documentHelper.layout.getParentTable(e),this.documentHelper.layout.reLayoutTable(t)):this.documentHelper.layout.reLayoutTable(e),this.owner.editorModule.getOffsetValue(this.documentHelper.selection),this.owner.editorModule.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.owner.editorModule.reLayout(this.owner.selectionModule),this.owner.editorModule.isSkipOperationsBuild=!1,i&&(this.startingPoint.x+=j.convertPointToPixel(i),this.resizerPosition=this.getCellReSizerPosition(this.startingPoint))},Zg.prototype.getColumnCells=function(e,t,i){for(var n=[],r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[parseInt(r.toString(),10)],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[parseInt(s.toString(),10)];i?a.columnIndex+a.cellFormat.columnSpan===t&&n.push(a):a.columnIndex===t&&n.push(a)}return n},Zg.prototype.updateGridBefore=function(e,t){e.rowFormat.beforeWidth+t!==e.rowFormat.beforeWidth&&(e.rowFormat.beforeWidth=e.rowFormat.beforeWidth+t,e.rowFormat.gridBeforeWidth=e.rowFormat.beforeWidth)},Zg.prototype.getLeastGridBefore=function(e,t){for(var i=0,n=0,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[parseInt(r.toString(),10)];o!==t&&(0===n&&(i=o.rowFormat.beforeWidth,n++),o.rowFormat.beforeWidth<=i)&&(i=o.rowFormat.beforeWidth)}return i},Zg.prototype.increaseOrDecreaseWidth=function(e,t,i){var n=e.cellFormat.preferredWidth,r=("Auto"===e.cellFormat.preferredWidthType&&(n=e.cellFormat.cellWidth,e.cellFormat.preferredWidthType="Point"),e.ownerColumn.minWidth);"Percent"===e.cellFormat.preferredWidthType&&(r=e.convertPointToPercent(r)),e.cellFormat.preferredWidth=i?r<n+t?n+t:r:r<n-t?n-t:r},Zg.prototype.changeWidthOfCells=function(e,t,i,n){if(0<t.length){for(var r=!1,o=0;o<t.length;o++){var s=t[parseInt(o.toString(),10)];this.increaseOrDecreaseWidth(s,n,!0),s.cellIndex===s.ownerRow.childWidgets.length-1&&(r=!0)}r&&this.updateRowsGridAfterWidth(e)}if(0<i.length){for(var a,l=0,o=0;o<i.length;o++)0===(s=i[parseInt(o.toString(),10)]).cellIndex&&(0<=(a=s.ownerRow.rowFormat.beforeWidth+n)?this.updateGridBefore(s.ownerRow,n):(l!==a&&(l=a),s.ownerRow.rowFormat.gridBeforeWidth=0,s.ownerRow.rowFormat.gridBeforeWidthType="Auto")),this.increaseOrDecreaseWidth(s,n,!1);if(0!==l){var d=e.leftIndent+l;e.tableFormat.leftIndent=-1440<=d?d<=1440?d:1440:-1440;for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[parseInt(h.toString(),10)];-1===i.indexOf(c.childWidgets[0])&&this.updateGridBefore(c,0<l?l:-l)}}}},Zg.prototype.updateRowsGridAfterWidth=function(e){for(var t=this.getMaxRowWidth(e,!0),i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[parseInt(i.toString(),10)],r=this.getRowWidth(n,!0);r<=t&&n.rowFormat.afterWidth!==t-r&&(n.rowFormat.gridAfterWidth=r=t-r,n.rowFormat.afterWidth=r)}},Zg.prototype.getRowWidth=function(e,t){var i=0;t&&(i+=e.rowFormat.beforeWidth);for(var n=0;n<e.childWidgets.length;n++)i+=e.childWidgets[parseInt(n.toString(),10)].cellFormat.cellWidth;return i},Zg.prototype.getMaxRowWidth=function(e,t){for(var i=0,n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[parseInt(n.toString(),10)],o=0;t&&(o+=r.rowFormat.beforeWidth);for(var s=0;s<r.childWidgets.length;s++)o+=r.childWidgets[parseInt(s.toString(),10)].cellFormat.cellWidth;i<o&&(i=o)}return i},Zg.prototype.isColumnSelected=function(e,t){for(var i=this.owner.selectionModule.getSelectedCells(),n=this.getColumnCells(e,t,!0),r=this.getColumnCells(e,t,!1),o=!1,s=0;s<n.length;s++)var a=n[parseInt(s.toString(),10)],o=-1!==i.indexOf(a);if(!o)for(s=0;s<r.length;s++){a=r[parseInt(s.toString(),10)];o=-1!==i.indexOf(a)}return o},Zg.prototype.applyProperties=function(e,t){if(!_.isNullOrUndefined(t)){t.tableHolder&&(e.tableHolder=t.tableHolder.clone()),null!==t.tableFormat&&(e.tableFormat.leftIndent=t.tableFormat.leftIndent,e.tableFormat.preferredWidth=t.tableFormat.preferredWidth,e.tableFormat.preferredWidthType=t.tableFormat.preferredWidthType,e.tableFormat.allowAutoFit=t.tableFormat.allowAutoFit);for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[parseInt(i.toString(),10)],r=t.rows[parseInt(i.toString(),10)];n.rowFormat.gridBefore=r.gridBefore,n.rowFormat.gridBeforeWidth=r.gridBeforeWidth,n.rowFormat.gridBeforeWidthType=r.gridBeforeWidthType,n.rowFormat.gridAfter=r.gridAfter,n.rowFormat.gridAfterWidth=r.gridAfterWidth,n.rowFormat.gridAfterWidthType=r.gridAfterWidthType;for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[parseInt(o.toString(),10)],a=r.cells[parseInt(o.toString(),10)];s.columnIndex=a.columnIndex,s.cellFormat.columnSpan=a.columnSpan,s.cellFormat.preferredWidth=a.preferredWidth,s.cellFormat.preferredWidthType=a.preferredWidthType}}var l=e.getOwnerWidth(!0),l=e.getTableClientWidth(l);e.setWidthToCells(l,"Auto"===e.tableFormat.preferredWidthType)}},Zg.prototype.getActualWidth=function(e){var t=0;if(0<e.childWidgets.length)for(var i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[parseInt(i.toString(),10)].cellFormat.cellWidth;return t},Zg.prototype.setPreferredWidth=function(e){for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[parseInt(t.toString(),10)],n=i.rowFormat;0<n.gridBefore&&(n.gridBeforeWidth=n.beforeWidth,n.gridBeforeWidthType="Point");for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[parseInt(r.toString(),10)];o.cellFormat.preferredWidth=o.cellFormat.cellWidth,o.cellFormat.preferredWidthType="Point"}0<n.gridAfter&&(n.gridAfterWidth=n.afterWidth,n.gridAfterWidthType="Point")}},Zg.prototype.updateCellPreferredWidths=function(e){for(var t=e.tableHolder.tableWidth,i=0;i<e.childWidgets.length;i++){var n,r=e.childWidgets[parseInt(i.toString(),10)];0<r.rowFormat.gridBefore&&(n=e.tableHolder.getCellWidth(0,r.rowFormat.gridBefore,t),this.updateGridBeforeWidth(n,r));for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[parseInt(o.toString(),10)];s.updateWidth(e.tableHolder.getCellWidth(s.columnIndex,s.cellFormat.columnSpan,t))}0<r.rowFormat.gridAfter&&this.updateGridAfterWidth(e.tableHolder.getCellWidth(r.childWidgets.length,r.rowFormat.gridAfter,t),r)}},Zg.prototype.updateGridBeforeWidth=function(e,t){var i=t.rowFormat;e!==i.beforeWidth&&(i.beforeWidth=e,"Auto"===i.gridBeforeWidthType&&(i.gridBeforeWidthType="Point"),"Point"===i.gridBeforeWidthType?i.gridBeforeWidth=i.beforeWidth:(e=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),t=t.ownerTable.convertPointToPercent(i.beforeWidth,e),i.gridBeforeWidth=t))},Zg.prototype.updateGridAfterWidth=function(e,t){var i=t.rowFormat;e!==i.afterWidth&&(i.afterWidth=e),"Auto"===i.gridAfterWidthType&&(i.gridAfterWidthType="Point"),"Point"===i.gridAfterWidthType?i.gridAfterWidth=i.afterWidth:(e=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),t=t.ownerTable.convertPointToPercent(i.afterWidth,e),i.gridAfterWidth=t)},Zg.prototype.destroy=function(){this.documentHelper=void 0,this.owner=void 0};var Kg=Zg;function Zg(e){this.resizeNode=0,this.resizerPosition=-1,this.currentResizingTable=void 0,this.owner=e,this.documentHelper=this.owner.documentHelper,this.startingPoint=new nl(0,0)}var Xg=function(o,s,a,l){return new(a=a||Promise)(function(e,t){function i(e){try{r(l.next(e))}catch(e){t(e)}}function n(e){try{r(l.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},Jg=function(n,r){var o,s,a,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,s=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))l.label=t[1];else if(6===t[0]&&l.label<a[1])l.label=a[1],a=t;else{if(!(a&&l.label<a[2])){a[2]&&l.ops.pop(),l.trys.pop();continue}l.label=a[2],l.ops.push(t)}}t=r.call(n,l)}catch(e){t=[6,e],s=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},Yg=(Object.defineProperty(o.prototype,"restrictFormatting",{get:function(){return this.documentHelper.isDocumentProtected&&(this.documentHelper.restrictFormatting||!this.documentHelper.restrictFormatting&&!this.selection.isSelectionInEditRegion())&&"RevisionsOnly"!==this.documentHelper.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"restrictEditing",{get:function(){return this.documentHelper.isDocumentProtected&&(("ReadOnly"===this.documentHelper.protectionType||this.documentHelper.isCommentOnlyMode)&&!this.selection.isSelectionInEditRegion()||"FormFieldsOnly"===this.documentHelper.protectionType)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"canEditContentControl",{get:function(){var e=this.getContentControl();if(_.isNullOrUndefined(e)){if(this.selection.checkContentControlLocked())return!1}else if(e.contentControlProperties.lockContents||"DropDownList"===e.contentControlProperties.type)return!1;return!this.owner.isReadOnly},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"viewer",{get:function(){if(!_.isNullOrUndefined(this.owner))return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"editorHistory",{get:function(){return this.documentHelper.owner.editorHistoryModule},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"selection",{get:function(){if(this.documentHelper)return this.documentHelper.selection},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"owner",{get:function(){if(this.documentHelper)return this.documentHelper.owner},enumerable:!0,configurable:!0}),o.prototype.getModuleName=function(){return"Editor"},o.prototype.setFieldInfo=function(e){var t=this.selection.getHyperlinkField(!0);_.isNullOrUndefined(t)||(this.selection.selectField(),this.insertField(e.code,e.result))},o.prototype.insertField=function(e,t){this.isInsertField=!0;var i,n,r,o,s=e;"NUMPAGES"===(s=j.trimStart(s)).substring(0,8)?this.insertPageCount(t):"PAGE"===s.substring(0,4)?this.insertPageNumber(t):(_.isNullOrUndefined(t)&&"MERGEFIELD"===s.substring(0,10)&&(i=(s=s.substring(10).trim()).indexOf("\\*"),t="«"+s.substring(0,i).trim()+"»"),s=new G,i=new B,i=this.copyInsertFormat(i,!1),n=new uh(s),(r=new Z(0)).characterFormat.mergeFormat(i),n.children.push(r),(o=new X).characterFormat.mergeFormat(i),o.text=e,n.children.push(o),(e=new Z(2)).characterFormat.mergeFormat(i),(e.fieldBegin=r).fieldSeparator=e,n.children.push(e),(o=new X).text=t,o.characterFormat.mergeFormat(i),n.children.push(o),(t=new Z(1)).characterFormat.mergeFormat(i),t.fieldSeparator=e,(t.fieldBegin=r).fieldEnd=t,e.fieldEnd=t,n.children.push(t),r.line=n,s.childWidgets.push(n),this.documentHelper.fields.push(r),(o=new z).sectionFormat=new Ma(o),o.childWidgets.push(s),this.pasteContentsInternal([o],!1)),this.isInsertField=!1},o.prototype.isLinkedStyle=function(e){e=this.documentHelper.styles.findByName(e);return!_.isNullOrUndefined(e.link)},o.prototype.applyStyle=function(e,t){t=!_.isNullOrUndefined(t)&&t;var i,n,r=void 0,o=void 0,s=this.documentHelper.styles.findByName(e);t&&(this.initComplexHistory("ApplyStyle"),this.setOffsetValue(this.selection),r=this.startOffset,o=this.endOffset,t=this.selection.isEmpty,this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,!_.isNullOrUndefined(s)&&s instanceof fl&&"Character"===s.type?this.clearFormattingInternal(!1):this.clearFormattingInternal(!0),this.isSkipOperationsBuild=!1,t)&&!this.selection.isEmpty&&this.selection.end.setPositionInternal(this.selection.start),void 0!==s?s instanceof fl&&"Character"===s.type?this.selection.isEmpty&&(t=this.selection.start.offset,i=this.selection.start.clone(),n=this.selection.end.clone(),this.selection.selectCurrentWord(),t===this.selection.start.offset||t===this.selection.end.offset-1)?(this.selection.start=i,this.selection.end=n,this.selection.characterFormat.copyFormat(s.characterFormat)):this.onApplyCharacterFormat("styleName",s,!1,!0):this.onApplyParagraphFormat("styleName",s,!1,!0):(this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(e)),this.documentHelper.styles),this.applyStyle(e)),this.editorHistory&&this.editorHistory.currentHistoryInfo&&"ApplyStyle"===this.editorHistory.currentHistoryInfo.action&&(this.startOffset=r,this.endOffset=o,this.editorHistory.updateComplexHistory()),this.startParagraph=void 0,this.endParagraph=void 0},o.prototype.cut=function(){var e,t;this.owner.isReadOnlyMode||this.selection.isEmpty||!this.canEditContentControl||(e=this.selection.start,t=this.selection.end,e=0===e.offset?this.selection.getElementInfo(e.currentWidget,e.offset-1):this.selection.getElementInfo(e.currentWidget,this.selection.isForward?e.offset:e.offset+1),t=0===t.offset?this.selection.getElementInfo(t.currentWidget,t.offset-1):this.selection.getElementInfo(t.currentWidget,this.selection.isForward?t.offset+1:t.offset),!_.isNullOrUndefined(e)&&!_.isNullOrUndefined(t)&&e.element&&t.element&&-1!==e.index&&-1!==t.index&&e.element instanceof J&&t.element instanceof J&&e.element.name===t.element.name&&!(!_.isNullOrUndefined(e.element.nextElement)&&!_.isNullOrUndefined(t.element.previousElement)&&e.element.nextElement instanceof Z&&t.element.previousElement instanceof Z)&&(this.selection.isForward?(this.selection.start.setPositionParagraph(e.element.line,e.element.line.getOffset(e.element,0)),this.selection.end.setPositionParagraph(t.element.line,t.element.line.getOffset(t.element,1))):(this.selection.start.setPositionParagraph(e.element.line,e.element.line.getOffset(e.element,1)),this.selection.end.setPositionParagraph(t.element.line,t.element.line.getOffset(t.element,0)))),this.selection.copySelectedContent(!0),this.documentHelper.owner.parser.isCutPerformed=!0)},o.prototype.insertEditingRegion=function(e){this.insertEditRangeElement(e&&""!==e?e:"Everyone")},o.prototype.enforceProtection=function(e,t,i){var n,r;"boolean"==typeof t?(n=i?"ReadOnly":this.documentHelper.protectionType,r=t):n=t,_.isNullOrUndefined(r)||(this.documentHelper.restrictFormatting=r),this.documentHelper.protectionType=n,this.selection.isHighlightEditRegion=!0,this.addProtection(e,this.documentHelper.protectionType,!1)},o.prototype.enforceProtectionAsync=function(n,r,o){return Xg(this,void 0,void 0,function(){var t,i;return Jg(this,function(e){switch(e.label){case 0:return"boolean"==typeof r?(t=o?"ReadOnly":this.documentHelper.protectionType,i=r):(i=!0,t=r),this.documentHelper.restrictFormatting=i,this.documentHelper.protectionType=t,this.selection.isHighlightEditRegion=!0,[4,this.addProtection(n,this.documentHelper.protectionType,!0)];case 1:return e.sent(),[2]}})})},o.prototype.getCommentHierarchicalIndex=function(e){for(var t="";e.ownerComment;)_.isNullOrUndefined(e.ownerComment)?t=e.replyComments.indexOf(e)+";"+t:(t=e.ownerComment.replyComments.indexOf(e)+";"+t,e=e.ownerComment);return t="C;"+this.documentHelper.comments.indexOf(e)+";"+t},o.prototype.alertBox=function(){var e=new _.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),C.DialogUtility.alert({title:e.getConstant("Information"),content:e.getConstant("Multiple Comment")})},o.prototype.insertReplyComment=function(e,t,i){var n,r=this.getCommentInfo(t),i={author:i.author||"Guest user",initial:this.constructCommentInitial(i.author||"Guest user"),text:_.isNullOrUndefined(r.innerText)?_.SanitizeHtmlHelper.sanitize(t):_.SanitizeHtmlHelper.sanitize(r.innerText),commentId:Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),done:!1,date:i.dateTime?j.getUtcDate(i.dateTime):j.getUtcDate()};if(0<this.documentHelper.comments.length)for(var o=0;o<this.documentHelper.comments.length;o++)if(this.documentHelper.comments[o].commentId===e){n=this.documentHelper.comments[o];break}this.replyComment(n,_.isNullOrUndefined(r.innerText)?t:r.innerText,r.itemData,i);r={author:i.author,isResolved:i.done,dateTime:this.parseDateTime(i.date)};return new I(i.commentId,r,t)},o.prototype.getCommentInfo=function(e){for(var t,i=[],n=[],r=/<a href="mailto:([^"]+)">([^<]+)<\/a>/g,o=0;null!==(t=r.exec(e));)t.index>o&&n.push({text:e.substring(o,t.index)}),n.push({mailto:t[1],text:t[2]}),o=r.lastIndex;o<e.length&&n.push({text:e.substring(o)});var s="";if(0<n.length)for(var a=0;a<n.length;a++)n[a].mailto?(i.push({text:n[a].text.replace("@",""),value:n[a].mailto}),s+='<span contenteditable="false" class="e-mention-chip">'+n[a].text.replace("@","")+"</span>"):n[a].text&&(s+=n[a].text.replace(/(\r\n|\n\r|\n|\r)/g,"<br>"));else""!==e&&(s=e.replace(/(\r\n|\n\r|\n|\r)/g,"<br>"));return{itemData:i,innerText:s}},o.prototype.insertComment=function(e,t){if(!(_.isNullOrUndefined(this.selection.start)||this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||this.viewer.owner.enableHeaderAndFooter||!this.viewer.owner.enableComment||this.selection.isPlainContentControl())){if(this.viewer.owner.commentReviewPane.commentPane.isEditMode)return this.alertBox();_.isNullOrUndefined(e)&&(e="");var i={},n=this.getCommentInfo(e),r=(i=_.isNullOrUndefined(t)?{author:this.owner.currentUser||"Guest user",initial:this.constructCommentInitial(this.owner.currentUser||"Guest user"),text:_.SanitizeHtmlHelper.sanitize(e),commentId:Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),done:!1,date:j.getUtcDate()}:{author:r=_.isNullOrUndefined(t.author)?this.owner.currentUser:t.author,initial:this.constructCommentInitial(r),text:_.SanitizeHtmlHelper.sanitize(""===n.innerText?e:n.innerText),commentId:Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),done:t.isResolved||!1,date:t.dateTime?j.getUtcDate(t.dateTime):j.getUtcDate()},this.insertCommentInternal(_.isNullOrUndefined(n.innerText)?"":n.innerText,i,n.itemData),{author:i.author,isResolved:i.done,dateTime:this.parseDateTime(i.date)});return new I(i.commentId,r,e)}},o.prototype.parseDateTime=function(e){e=new Date(e);return new Date(e.getTime()+6e4*e.getTimezoneOffset())},o.prototype.insertCommentInternal=function(e,t,i){this.documentHelper.layout.allowLayout=!1,this.selection.isEmpty&&(this.selection.start.isAtSamePosition(this.selection.end)&&this.selection.start.isAtParagraphEnd&&(n=this.selection.start.offset,this.selection.start.offset=n-1!=-1?n-1:n),this.selection.selectCurrentWord()),this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getLineLength(this.selection.end.currentWidget)+1&&--this.selection.end.offset;var n=this.selection.getParagraphInfo(this.selection.start),n=(this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),this.selection.getParagraphInfo(this.selection.end)),n=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),r=(this.initComplexHistory("InsertComment"),this.selection.start),o=this.selection.end,s=new y(this.owner),a=(this.selection.isForward||(r=this.selection.end,o=this.selection.start),s.setPositionInternal(o),new up(0)),l=new up(1),d=r.currentWidget===o.currentWidget,n=(o.setPositionInternal(r),s.currentWidget.indexInOwner,s.currentWidget.paragraph,this.initInsertInline(a),!_.isNullOrUndefined(s.paragraph)&&-1!==s.currentWidget.indexInOwner||(n=this.selection.getTextPosBasedOnLogicalIndex(n),s.setPositionInternal(n)),d&&s.setPositionParagraph(s.currentWidget,s.offset+a.length),r.setPositionInternal(s),o.setPositionInternal(s),this.initInsertInline(l),new fp(t.date));i&&0<i.length&&(n.mentions=i),this.owner.editorHistoryModule&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistoryModule.currentBaseHistoryInfo.insertedText=L.Marker_Start+L.Marker_End,this.owner.editorHistoryModule.currentBaseHistoryInfo.removedNodes.push(n)),this.updateCommentElement(n,a,l,t),this.addCommentWidget(n,!0,!0,!0),this.owner.isSpellCheck&&a.previousElement&&a.previousElement instanceof X&&(a.previousElement.ischangeDetected=!0),this.owner.isSpellCheck&&l.previousElement&&l.previousElement instanceof X&&a.line!==l.line&&(l.previousElement.ischangeDetected=!0),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(n),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection,!1),this.documentHelper.layout.allowLayout=!0,this.isUserInsert||(d=this.owner.commentReviewPane.commentPane.comments.get(n),i&&0<i.length&&(d.itemData=i),d.postComment())},o.prototype.updateCommentElement=function(e,t,i,n){return e.author=n.author,e.initial=n.initial,e.text=n.text,e.commentId=n.commentId,_.isNullOrUndefined(n.done)||(e.isResolved=n.done),_.isNullOrUndefined(n.isReply)||(e.isReply=n.isReply),_.isNullOrUndefined(t)||_.isNullOrUndefined(i)||(t.comment=e,t.commentId=e.commentId,i.comment=e,i.commentId=e.commentId,e.commentStart=t,e.commentEnd=i),e},o.prototype.deleteAllComments=function(){if(0!==this.documentHelper.comments.length){var e;for(this.initComplexHistory("DeleteAllComments"),this.owner.isLayoutEnabled=!1,this.editorHistory&&this.editorHistory.currentHistoryInfo&&(e=this.editorHistory.currentHistoryInfo);0<this.documentHelper.comments.length;){var t=this.documentHelper.comments[0];this.initComplexHistory("DeleteComment"),this.deleteCommentInternal(t),this.editorHistory&&this.editorHistory.currentHistoryInfo&&e.addModifiedAction(this.editorHistory.currentHistoryInfo)}this.selection.selectContent(this.owner.documentStart,!0),this.editorHistory&&(this.editorHistory.currentHistoryInfo=e,this.editorHistory.updateComplexHistory())}},o.prototype.deleteComment=function(e){var t;if(!(this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||_.isNullOrUndefined(this.owner)||_.isNullOrUndefined(this.owner.viewer)||_.isNullOrUndefined(this.owner.documentHelper.currentSelectedComment)&&_.isNullOrUndefined(e)||this.owner.enableHeaderAndFooter)&&this.viewer.owner.enableComment)if(_.isNullOrUndefined(e))this.deleteCommentInternal(this.owner.documentHelper.currentSelectedComment);else{var i;if(0<this.documentHelper.comments.length)for(var n=0;n<this.documentHelper.comments.length;n++){if((i=this.documentHelper.comments[n]).commentId===e){t=this.documentHelper.comments[n];break}if(i.replyComments&&0<i.replyComments.length)for(var r=0;r<i.replyComments.length;r++)if(i.replyComments[r].commentId===e){t=i.replyComments[r];break}}if(_.isNullOrUndefined(t))throw new Error("Enter a valid comment id.");this.deleteCommentInternal(t)}},o.prototype.deleteCommentInternal=function(e){if(this.initComplexHistory("DeleteComment"),e){if(0<e.replyComments.length)for(var t=e.replyComments.length-1;0<=t;t--)this.deleteCommentInternal(e.replyComments[t]);this.deleteCommentWidgetInternal(e);var i=e.commentStart,n=e.commentEnd;-1!==n.indexInOwner&&this.removeInline(n),-1!==i.indexInOwner&&this.removeInline(i),i.removeCommentMark()}this.editorHistory&&this.editorHistory.updateComplexHistory()},o.prototype.deleteCommentWidgetInternal=function(e){this.owner.editorHistoryModule&&(this.initHistory("DeleteCommentWidget"),this.owner.editorHistoryModule.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(e),this.owner.editorHistoryModule.currentBaseHistoryInfo.removedNodes.push(e)),this.deleteCommentWidget(e),this.editorHistory&&this.editorHistory.updateHistory()},o.prototype.deleteCommentWidget=function(e){var t=this.documentHelper.comments.indexOf(e);-1!==t?this.documentHelper.comments.splice(t,1):e.isReply&&e.ownerComment&&(t=e.ownerComment.replyComments.indexOf(e),e.ownerComment.replyComments.splice(t,1)),this.owner.commentReviewPane&&(this.owner.commentReviewPane.deleteComment(e),this.documentHelper.currentSelectedComment===e)&&(this.documentHelper.currentSelectedComment=void 0)},o.prototype.resolveComment=function(e){var t;this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||(t={author:e.author,cancel:!1,type:"Resolve"},this.owner.trigger(me,t),t.cancel&&"Resolve"===t.type)||(this.initHistory("ResolveComment"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e),this.resolveOrReopenComment(e,!0))},o.prototype.reopenComment=function(e){var t;this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||(t={author:e.author,cancel:!1,type:"Reopen"},this.owner.trigger(me,t),t.cancel&&"Reopen"===t.type)||(this.initHistory("ResolveComment"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e),this.resolveOrReopenComment(e,!1))},o.prototype.resolveOrReopenComment=function(e,t){e.isResolved=t;for(var i=0;i<e.replyComments.length;i++)e.replyComments[i].isResolved=t;this.owner.commentReviewPane&&(t?this.owner.commentReviewPane.resolveComment(e):this.owner.commentReviewPane.reopenComment(e)),this.reLayout(this.selection,!1,!1)},o.prototype.replyComment=function(e,t,i,n){var r,o,s,a,l;this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||(e=e)&&(r=void 0,n?((r=new fp(n.date)).author=n.author,r.text=t,r.mentions=i||[],r.commentId=n.commentId):((r=new fp(j.getUtcDate())).author=this.owner.currentUser||"Guest user",r.text=t||"",r.mentions=i||[],r.commentId=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)),r.isReply=!0,n={author:r.author,cancel:!1,type:"Post",text:r.text,mentions:r.mentions},this.owner.trigger(me,n),n.cancel&&"Post"===n.type||(this.initComplexHistory("InsertComment"),t=e.commentStart,i=e.commentEnd,n=e.replyComments.length,s=t.line.getOffset(t,n+1),(o=new y(this.documentHelper.owner)).setPositionParagraph(t.line,s),t=i.line.getOffset(i,n+1),(s=new y(this.documentHelper.owner)).setPositionParagraph(i.line,t),this.selection.start.setPositionInternal(o),this.selection.end.setPositionInternal(s),o=this.selection.start,s=this.selection.end,(n=new y(this.owner)).setPositionInternal(s),i=new up(0),t=new up(1),a=o.currentWidget===s.currentWidget,s.setPositionInternal(o),l=n.currentWidget.indexInOwner,this.initInsertInline(i),-1===n.currentWidget.indexInOwner&&(n.currentWidget=n.currentWidget.paragraph.childWidgets[l]),a&&n.setPositionParagraph(n.currentWidget,n.offset+i.length),o.setPositionInternal(n),s.setPositionInternal(n),this.initInsertInline(t),e.replyComments.push(r),r.ownerComment=e,this.owner.editorHistoryModule&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistoryModule.currentBaseHistoryInfo.removedNodes.push(r),this.owner.editorHistoryModule.currentBaseHistoryInfo.insertedText=L.Marker_Start+L.Marker_End),i.comment=r,i.commentId=r.commentId,t.comment=r,t.commentId=r.commentId,r.commentStart=i,r.commentEnd=t,this.owner.commentReviewPane&&this.owner.commentReviewPane.addReply(r,!1,!0),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(r),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.reLayout(this.selection),this.isSkipOperationsBuild=!1))},o.prototype.removeInline=function(e){this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,0)),this.selection.end.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+e.length),this.initHistory("RemoveInline"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.start,!0),this.removeSelectedContents(this.documentHelper.selection),this.editorHistory&&this.editorHistory.updateHistory(),this.fireContentChange()},o.prototype.addCommentWidget=function(e,t,i,n){if(-1===this.documentHelper.comments.indexOf(e)){var r=!1;if(0<this.documentHelper.comments.length)for(var o=this.selection.getElementPosition(e.commentStart).startPosition,s=0;s<this.documentHelper.comments.length;s++){var a=this.selection.getElementPosition(this.documentHelper.comments[s].commentStart).startPosition;if(o.isExistBefore(a)){r=!0,this.documentHelper.comments.splice(s,0,e);break}}r||this.documentHelper.comments.push(e),this.owner.commentReviewPane&&(this.owner.showComments=i,this.owner.commentReviewPane.selectedTab=0,this.owner.commentReviewPane.addComment(e,t,n),this.owner.commentReviewPane.reviewTab.selectedItem=0,n)&&this.owner.selectionModule.selectComment(e)}},o.prototype.addReplyComment=function(e,t){var t=t.split(";"),i=this.documentHelper.comments[parseInt(t[1],10)];""!==t[2]&&(i.replyComments.splice(parseInt(t[2],10),0,e),e.ownerComment=i),this.owner.commentReviewPane&&(this.owner.showComments=!0,this.owner.commentReviewPane.addReply(e,!1,!0),this.owner.selectionModule.selectComment(e))},o.prototype.addProtection=function(s,a,l){return Xg(this,void 0,void 0,function(){var o=this;return Jg(this,function(e){return[2,new Promise(function(t,i){var e,n,r;l=!!_.isNullOrUndefined(l)||l,""===s?(o.protectDocument(a),t()):(o.currentProtectionType=a,e=new A,n={passwordBase64:o.base64.encodeString(s),saltBase64:"",spinCount:1e5},r=o.owner.serviceUrl+o.owner.serverActionSettings.restrictEditing,e.url=r,e.contentType="application/json;charset=UTF-8",e.onSuccess=function(e){o.enforceProtectionInternal(e),t()},e.onFailure=function(e){o.protectionFailureHandler(e),i()},e.onError=function(e){o.protectionFailureHandler(e),i()},e.customHeaders=o.owner.headers,r={serverActionType:"RestrictEditing",headers:o.owner.headers,timeout:0,cancel:!1,withCredentials:!1},o.owner.trigger(Te,r),r.cancel?o.documentHelper.dialog.visible&&o.documentHelper.dialog.hide():e.send(n,r,l))})]})})},o.prototype.protectionFailureHandler=function(e){var t;this.owner&&((t=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.documentHelper.owner.locale),"onError"===e.name?C.DialogUtility.alert(t.getConstant("Error in establishing connection with web server")):(this.owner.fireServiceFailure(e),console.error(e.statusText)))},o.prototype.enforceProtectionInternal=function(e){e=JSON.parse(e.data);this.enforceProtectionAssign(e[0],e[1],this.currentProtectionType),this.owner.showHideRulers()},o.prototype.enforceProtectionAssign=function(e,t,i){this.documentHelper&&(this.documentHelper.saltValue=e,this.documentHelper.hashValue=t,this.protectDocument(i))},o.prototype.toggleTrackChangesProtection=function(e){this.viewer.owner.enableTrackChanges=e,this.owner.trigger(xe,{isTrackChangesEnabled:e})},o.prototype.protectDocument=function(e){this.documentHelper.owner.getSettingData("protection",null,this.documentHelper.hashValue,this.documentHelper.saltValue,e),this.protect(e);var t=this.documentHelper.restrictEditingPane.restrictPane;t&&"block"===t.style.display&&(this.documentHelper.restrictEditingPane.showStopProtectionPane(!0),this.documentHelper.restrictEditingPane.loadPaneValue(),this.documentHelper.dialog.hide()),this.owner.notify(Se,{}),"RevisionsOnly"===e&&this.toggleTrackChangesProtection(!0),this.owner.trackChangesPane.enableDisableButton(!1)},o.prototype.stopProtection=function(e){var t,i;this.documentHelper.isDocumentProtected&&(_.isNullOrUndefined(this.documentHelper.saltValue)||""!==this.documentHelper.saltValue||_.isNullOrUndefined(this.documentHelper.hashValue)||""!==this.documentHelper.hashValue||_.isNullOrUndefined(e)||""!==e?(t=new A,e={passwordBase64:this.base64.encodeString(e),saltBase64:this.documentHelper.saltValue,spinCount:1e5},t.url=this.owner.serviceUrl+this.owner.serverActionSettings.restrictEditing,t.contentType="application/json;charset=UTF-8",t.customHeaders=this.owner.headers,t.onSuccess=this.onUnProtectionSuccess.bind(this),t.onFailure=this.protectionFailureHandler.bind(this),t.onError=this.protectionFailureHandler.bind(this),i={serverActionType:"RestrictEditing",headers:this.owner.headers,timeout:0,cancel:!1,withCredentials:!1},this.owner.trigger(Te,i),i.cancel?this.documentHelper.dialog.visible&&this.documentHelper.dialog.hide():t.send(e,i,!1),this.owner.enableTrackChanges||this.toggleTrackChangesProtection(!1)):this.unProtectDocument())},o.prototype.stopProtectionAsync=function(s){return Xg(this,void 0,void 0,function(){var o=this;return Jg(this,function(e){return[2,new Promise(function(t,i){var e,n,r;o.documentHelper.isDocumentProtected&&(_.isNullOrUndefined(o.documentHelper.saltValue)||""!==o.documentHelper.saltValue||_.isNullOrUndefined(o.documentHelper.hashValue)||""!==o.documentHelper.hashValue||_.isNullOrUndefined(s)||""!==s?(e=new A,n={passwordBase64:o.base64.encodeString(s),saltBase64:o.documentHelper.saltValue,spinCount:1e5},e.url=o.owner.serviceUrl+o.owner.serverActionSettings.restrictEditing,e.contentType="application/json;charset=UTF-8",e.customHeaders=o.owner.headers,e.onSuccess=function(e){o.onUnProtectionSuccess(e),t()},e.onFailure=function(e){o.protectionFailureHandler(e),i()},e.onError=function(e){o.protectionFailureHandler(e),i()},r={serverActionType:"RestrictEditing",headers:o.owner.headers,timeout:0,cancel:!1,withCredentials:!1},o.owner.trigger(Te,r),r.cancel?o.documentHelper.dialog.visible&&o.documentHelper.dialog.hide():e.send(n,r),o.owner.enableTrackChanges||o.toggleTrackChangesProtection(!1)):(o.unProtectDocument(),t()))})]})})},o.prototype.onUnProtectionSuccess=function(e){e=JSON.parse(e.data);this.validateHashValue(e[1]),this.owner.showHideRulers()},o.prototype.validateHashValue=function(e){this.currentHashValue=e;var t=new _.L10n("documenteditor",this.owner.defaultLocale),i=(t.setLocale(this.documentHelper.owner.locale),this.base64.decodeString(e)),e=this.documentHelper.hashValue,n=this.base64.decodeString(e),r=!0;if(i.length===n.length){for(var o=0;o<i.length;o++)if(i[o]!==n[o]){r=!1;break}}else r=!1;r?this.unProtectDocument():C.DialogUtility.alert(t.getConstant("The password is incorrect"))},o.prototype.unProtectDocument=function(){this.documentHelper.owner.getSettingData("protection",!1,this.currentHashValue),this.currentHashValue=null;var e=this.documentHelper.protectionType,t=(this.documentHelper.isDocumentProtected=!1,this.documentHelper.restrictFormatting=!1,this.documentHelper.protectionType="NoProtection",this.documentHelper.saltValue="",this.documentHelper.hashValue="",this.documentHelper.selection.highlightEditRegion(),this.documentHelper.restrictEditingPane.restrictPane);t&&"block"===t.style.display&&this.documentHelper.restrictEditingPane.showStopProtectionPane(!1),"RevisionsOnly"!==e||this.owner.enableTrackChanges||this.toggleTrackChangesProtection(!1),this.owner.trackChangesPane.enableDisableButton(!0),_.isNullOrUndefined(this.editorHistory)||this.owner.editorHistoryModule.clearHistory(),this.owner.notify(Se,{}),this.documentHelper.dialog.hide(),this.owner.showHideRulers()},o.prototype.fireContentChange=function(){this.owner.documentHelper.render.commentMarkDictionary.clear(),this.selection.isHighlightEditRegion&&(this.owner.enableLockAndEdit?this.owner.collaborativeEditingModule.updateLockRegion():this.selection.onHighlight()),this.selection.highlightFormFields(),this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousSectionFormat=void 0,this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0)),_.isNullOrUndefined(this.owner.optionsPaneModule)||!this.owner.optionsPaneModule.isOptionsPaneShow||this.owner.optionsPaneModule.isUpdateHeading||"BodyText"===this.selection.paragraphFormat.outlineLevel||this.owner.optionsPaneModule.updateHeadingTab(),!this.documentHelper.owner.isLayoutEnabled||this.documentHelper.owner.editorModule.isUserInsert||this.documentHelper.owner.isShiftingEnabled||this.isSkipOperationsBuild||this.isRemoteAction||this.documentHelper.owner.fireContentChange(),this.owner.isSpellCheck&&!_.isNullOrUndefined(this.selection.editPosition)&&(this.triggerPageSpellCheck=!1)},o.prototype.updateSelectionTextPosition=function(e){this.getOffsetValue(this.selection),this.selection.start.updatePhysicalPosition(!0),this.selection.isEmpty?this.selection.end.setPositionInternal(this.selection.start):this.selection.end.updatePhysicalPosition(!0),this.selection.upDownSelectionLength=this.selection.end.location.x,this.selection.fireSelectionChanged(e)},o.prototype.predictText=function(){this.documentHelper.suffix="",this.selection.start.paragraph.isEmpty()||0===this.selection.start.offset&&this.selection.start.currentWidget.isFirstLine()||0===this.selection.end.offset&&this.selection.end.currentWidget.isFirstLine()?this.documentHelper.prefix="":this.getPrefixAndSuffix(),this.documentHelper.prefix="@"+String.fromCharCode(160)+this.documentHelper.prefix,this.documentHelper.editableDiv.innerText=this.documentHelper.prefix,this.documentHelper.selection.setEditableDivCaretPosition(this.documentHelper.prefix.length)},o.prototype.getPrefixAndSuffix=function(){var e=this.owner.documentHelper;if(""!==this.selection.text)e.prefix="";else{var t=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),i=t.element;if(r=t.index,void 0!==i){var n=(t=this.selection.getElementBoxInternal(i,r)).element,r=t.index,o=0;if(!_.isNullOrUndefined(n)){var s=!1;for(n instanceof X&&0<r&&n.line.isFirstLine()&&(e.prefix=""),i instanceof X||(i=this.selection.getPreviousTextElement(i));(o=e.prefix.lastIndexOf(" "))<0&&i instanceof X;)if(i.previousNode instanceof X&&-1===e.prefix.indexOf(" ")){if(s?e.prefix=i.text+e.prefix:(e.prefix=i.text.substring(0,r),s=!0),(i=i.previousNode)instanceof Y)break;i instanceof X||(i=this.selection.getPreviousTextElement(i))}else if(!(i.previousNode instanceof X)){s?e.prefix=i.text+e.prefix:(e.prefix=i.text.substring(0,r),s=!0);break}1<e.prefix.length&&" "===e.prefix[e.prefix.length-1]&&"."===e.prefix[e.prefix.length-2]?(o=-1,e.prefix=""):o=e.prefix.lastIndexOf(" "),e.prefix=o<0?e.prefix:e.prefix.substring(o),0===e.prefix.indexOf(" ")&&1<=e.prefix.length&&(e.prefix=e.prefix.substring(1));var a=this.selection.end.currentWidget.getInline(this.selection.end.offset,0),l=a.element,d=a.index,n=(t=this.selection.getElementBoxInternal(l,d)).element;if(d=t.index,n){var h=!1;for(n instanceof X&&d<n.length&&(e.suffix="");(o=e.suffix.indexOf(" "))<0&&l instanceof X;)if(l.nextNode instanceof X&&-1===e.suffix.indexOf(" "))h?e.suffix=e.suffix+l.text:(e.suffix=n.text.substring(d),h=!0),l=l.nextNode;else if(!(l.nextNode instanceof X)){h?e.suffix=e.suffix+l.text:(e.suffix=n.text.substring(d),h=!0);break}o=e.suffix.indexOf(" "),e.suffix=o<0?e.suffix:e.suffix.substring(0,o)}}}}},o.prototype.onKeyDownInternal=function(e,t,i,n){var r,o=e.which||e.keyCode;if(this.owner.focusIn(),!t||i||n)if(!i||t||n)if(i&&t&&!n)switch(o){case 13:this.owner.isReadOnlyMode||(e.preventDefault(),this.insertColumnBreak());break;case 68:this.owner.isReadOnlyMode||this.owner.selectionModule.toggleUnderline("Double");break;case 77:this.owner.isReadOnlyMode||this.owner.selectionModule.decreaseIndent(),e.preventDefault();break;case 188:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 190:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode||this.toggleBaselineAlignment("Superscript");break;case 69:e.preventDefault(),this.owner.isReadOnlyMode||(r={isTrackChangesEnabled:!this.owner.enableTrackChanges},this.owner.trigger(xe,r))}else if(!i&&t&&n)switch(o){case 72:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.toggleHighlightColor();break;case 70:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertFootnote();break;case 68:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertEndnote()}else switch(o){case 8:e.preventDefault(),this.handleBackKey();break;case 9:this.owner.acceptTab?(e.preventDefault(),this.selection.handleTabKey(!0,!1)):this.documentHelper.editableDiv.blur();break;case 13:e.preventDefault(),this.owner.isSpellCheck&&(this.documentHelper.triggerSpellCheck=!0),this.handleEnterKey(),this.owner.isSpellCheck&&(this.documentHelper.triggerSpellCheck=!1);break;case 27:e.preventDefault(),this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0));break;case 46:this.handleDelete(),e.preventDefault();break;case 32:this.selection.handleSpaceBarKey();break;case 120:var s=this.selection.getDocumentEnd();s.offset=this.selection.getDocumentEnd().offset+1,this.selection.start.isAtSamePosition(this.selection.getDocumentStart())&&this.selection.end.isAtSamePosition(s)?this.owner.updateFields():this.selection.updateRefField()}else switch(o){case 9:this.owner.acceptTab?(e.preventDefault(),this.selection.handleTabKey(!1,!0)):this.documentHelper.editableDiv.blur();break;case 13:this.handleShiftEnter(),e.preventDefault();break;case 114:e.preventDefault(),this.changeCase(this.toggleChangeCase())}else switch(this.documentHelper.isControlPressed=!0,o){case 8:e.preventDefault(),this.handleCtrlBackKey();break;case 46:e.preventDefault(),this.handleCtrlDelete();break;case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!1,!1);break;case 13:e.preventDefault(),this.insertPageBreak();break;case 48:e.preventDefault();var a=0,l=this.documentHelper.selection.start.paragraph.paragraphFormat.beforeSpacing;12<l?a=12:0<l&&l<=12?a=0:0===l&&(a=12),this.onApplyParagraphFormat("beforeSpacing",a,!0,!1);break;case 49:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",1,!1,!1);break;case 50:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",2,!1,!1);break;case 53:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",1.5,!1,!1);break;case 66:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleBold();break;case 68:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.fontDialogModule&&this.owner.fontDialogModule.showFontDialog();break;case 69:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Center"),e.preventDefault();break;case 72:e.preventDefault(),!this.owner.isReadOnly&&this.owner.optionsPaneModule&&(this.owner.optionsPaneModule.isReplace=!0,this.owner.documentEditorSettings.showNavigationPane=!0);break;case 73:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleItalic();break;case 74:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Justify"),e.preventDefault();break;case 75:e.preventDefault(),this.owner.hyperlinkDialogModule&&!this.owner.isReadOnlyMode&&this.owner.hyperlinkDialogModule.show();break;case 76:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Left"),e.preventDefault();break;case 77:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.owner.selectionModule.increaseIndent(),e.preventDefault();break;case 78:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.openBlank();break;case 82:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Right"),e.preventDefault();break;case 85:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.owner.selectionModule.toggleUnderline("Single");break;case 88:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.editorModule.cut();break;case 89:this.owner.enableEditorHistory&&(this.editorHistory.redo(),e.preventDefault());break;case 90:this.owner.enableEditorHistory&&(this.editorHistory.undo(),e.preventDefault());break;case 219:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 221:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleBaselineAlignment("Subscript")}},o.prototype.handleShiftEnter=function(){this.owner.isReadOnlyMode||this.handleTextInput("\v"),this.selection.checkForCursorVisibility()},o.prototype.handleBackKey=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||"FormFieldsOnly"===this.documentHelper.protectionType&&this.canEditContentControl&&!_.isNullOrUndefined(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked()||this.selection.isInlineFormFillMode())&&this.owner.editorModule.onBackSpace(),this.selection.checkForCursorVisibility()},o.prototype.handleDelete=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&this.owner.editorModule.delete(),this.selection.checkForCursorVisibility()},o.prototype.handleEnterKey=function(){var e=this.documentHelper.owner.editor.getContentControl();(!this.owner.isReadOnlyMode&&!this.documentHelper.selection.checkContentControlLocked()||this.selection.isInlineFormFillMode()||("FormFieldsOnly"===this.documentHelper.protectionType||"NoProtection"==this.documentHelper.protectionType)&&e.contentControlProperties.multiline&&!_.isNullOrUndefined(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked()||!_.isNullOrUndefined(e)&&"RichText"===e.contentControlProperties.type&&("Block"===e.contentControlWidgetType||"Cell"===e.contentControlWidgetType))&&(_.Browser.isDevice&&(this.documentHelper.isCompositionStart=!1),this.owner.editorModule.onEnter(),this.documentHelper.selection.checkContentControlLocked())&&(this.selection.contentControleditRegionHighlighters.clear(),this.selection.isHighlightContentControlEditRegion=!0,this.selection.onHighlightContentControl()),this.selection.checkForCursorVisibility()},o.prototype.handleCtrlBackKey=function(){var e=this.selection.start,t=this.selection.end;this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||(this.selection.isForward||(e=t),this.selection.isEmpty?(this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace()):(_.isNullOrUndefined(e.paragraph.previousRenderedWidget)||e.paragraph.previousRenderedWidget instanceof K)&&0===e.offset||(this.selection.handleLeftKey(),this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace()))},o.prototype.handleCtrlDelete=function(){var e;(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&(this.selection.isEmpty?this.selection.handleControlShiftRightKey():(this.selection.handleLeftKey(),this.selection.handleControlShiftRightKey(),e=this.selection.text,j.endsWith(e)&&this.selection.handleShiftLeftKey()),this.owner.editorModule.delete())},o.prototype.handleTextInput=function(e){var t=this;(!this.owner.isReadOnlyMode&&this.canEditContentControl||"FormFieldsOnly"===this.documentHelper.protectionType&&this.canEditContentControl&&!_.isNullOrUndefined(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked()||this.selection.isInlineFormFillMode())&&(this.animationTimer&&clearTimeout(this.animationTimer),_.classList(this.selection.caret,[],["e-de-cursor-animation"]),this.owner.editorModule.insertText(e),this.animationTimer=Number(setTimeout(function(){t.animationTimer&&clearTimeout(t.animationTimer),t.selection&&t.selection.caret&&_.classList(t.selection.caret,["e-de-cursor-animation"],[])},600))),this.selection.checkForCursorVisibility()},o.prototype.copyInsertFormat=function(e,t,i){var i=i?new B(i):new B,n=this.selection.characterFormat;return t&&i.copyFormat(e),_.isNullOrUndefined(n.bidi)||e.bidi===n.bidi||(i.bidi=n.bidi),_.isNullOrUndefined(n.bold)||e.bold===n.bold||(i.bold=n.bold),_.isNullOrUndefined(n.italic)||e.italic===n.italic||(i.italic=n.italic),0<n.fontSize&&e.fontSize!==n.fontSize&&(i.fontSize=n.fontSize),_.isNullOrUndefined(n.fontFamily)||e.fontFamily===n.fontFamily||(i.fontFamily=n.fontFamily),_.isNullOrUndefined(n.highlightColor)||e.highlightColor===n.highlightColor||(i.highlightColor=n.highlightColor),_.isNullOrUndefined(n.baselineAlignment)||e.baselineAlignment===n.baselineAlignment||(i.baselineAlignment=n.baselineAlignment),_.isNullOrUndefined(n.fontColor)||e.fontColor===n.fontColor||(i.fontColor=n.fontColor),_.isNullOrUndefined(n.underline)||e.underline===n.underline||(i.underline=n.underline),_.isNullOrUndefined(n.strikethrough)||e.strikethrough===n.strikethrough||(i.strikethrough=n.strikethrough),i},o.prototype.getResultContentControlText=function(e){for(var t=e.nextNode,i="";!(t instanceof E||(t instanceof X&&(i+=t.text),_.isNullOrUndefined(t)));)if(_.isNullOrUndefined(t.nextNode)){if(!t.paragraph.nextRenderedWidget)break;t=t.paragraph.nextRenderedWidget.firstChild.children[0]}else t=t.nextNode;return i},o.prototype.insertContentControlPlaceholder=function(){var e,t,i=this.owner.editor.getContentControl();!_.isNullOrUndefined(i)&&i.nextElement instanceof E&&i.nextElement===i.reference&&(this.selection.isHighlightContentControlEditRegion=!0,e=new X,(t=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.owner.locale),e.text=t.getConstant("Default Content Control Text"),"ComboBox"!==i.contentControlProperties.type&&"DropDownList"!==i.contentControlProperties.type||(e.text=t.getConstant("Choose an item")),"Date"===i.contentControlProperties.type&&(e.text=t.getConstant("Default Date Picker")),e.characterFormat=this.owner.editor.copyInsertFormat(this.selection.start.paragraph.characterFormat,!0),this.owner.editor.insertElementsInternal(this.owner.selectionModule.end,[e]),i.contentControlProperties.hasPlaceHolderText=!0,this.selection.isHighlightContentControlEditRegion=!0,this.selection.contentControleditRegionHighlighters.clear(),this.selection.onHighlightContentControl())},o.prototype.insertContentControl=function(e,t,i){if(!this.selection.isPlainContentControl()){var n,r;switch("string"!=typeof e?(n=e.type,t=e.value,i=e.items,r=e):n=e,_.isNullOrUndefined(r)&&(r={title:void 0,tag:void 0,value:String(t),canDelete:!1,canEdit:!1,type:n,xmlString:void 0,xmlPath:void 0}),_.isNullOrUndefined(r)||_.isNullOrUndefined(r.xmlString)||_.isNullOrUndefined(r.xmlString)||(t=(r=this.mapXmlStringPath(r)).value,this.owner.isXmlMapCC=!0),n){case"RichText":if(_.isNullOrUndefined(t))this.applyRichText();else try{var o=t;((o="object"!=typeof o?JSON.parse(t):o)&&"object"==typeof o||"sections"in o)&&this.applyRichText(t,r.title,r.tag,r.canDelete,r.canEdit)}catch(e){this.applyRichText(JSON.stringify({sections:[{blocks:[{inlines:[{text:t}]}]}]}),r.title,r.tag,r.canDelete,r.canEdit)}break;case"Text":_.isNullOrUndefined(t)?this.applyPlainText():this.applyPlainText(t,r.title,r.tag,r.canDelete,r.canEdit);break;case"Picture":this.applyPictureContentControl(n,t);break;case"ComboBox":this.applyComboBox("ComboBox",i,t);break;case"DropDownList":this.applyComboBox("DropDownList",i,t);break;case"Date":this.applyDatePickerContentControl(n,t);break;case"CheckBox":this.applyCheckBoxContentControl(n,String.fromCharCode(9744),t)}e=this.getContentControl();if(!_.isNullOrUndefined(e))return{title:e.contentControlProperties.title,tag:e.contentControlProperties.tag,value:String(t),canDelete:e.contentControlProperties.lockContentControl,canEdit:e.contentControlProperties.lockContents,type:e.contentControlProperties.type,xmlString:r.xmlString,xmlPath:r.xmlPath}}},o.prototype.openContentDialog=function(e){var t=new _.L10n("documenteditor",this.owner.defaultLocale);t.setLocale(this.owner.locale),C.DialogUtility.alert({title:t.getConstant("Information"),content:e?t.getConstant("Rich text Controls"):t.getConstant("Plain text Controls"),showCloseIcon:!0,closeOnEscape:!0,animationSettings:{effect:"Zoom"},position:{X:"center",Y:"center"}})},o.prototype.updatePropertiesToBlock=function(e,t){var i=e.contentControlProperties;if("Block"===i.contentControlWidgetType)for(var i=e.line.paragraph,n=e.reference.line.paragraph,r=i.isInsideTable?this.documentHelper.layout.getParentTable(i):i,o=n.isInsideTable?this.documentHelper.layout.getParentTable(n):n;r;)r.contentControlProperties=t?e.contentControlProperties:void 0,r=r!==o?r.nextRenderedWidget:void 0},o.prototype.applyRichText=function(e,t,i,n,r){var o=(this.selection.isForward?this.selection.start:this.selection.end).clone(),s=(this.selection.isForward?this.selection.end:this.selection.start).clone(),a=(this.selection.isParagraphMarkSelected()&&--s.offset,o.paragraph!==s.paragraph&&(o.isAtParagraphStart?o.isAtParagraphStart&&!s.isAtParagraphEnd&&(a=void 0,a=s.paragraph.previousRenderedWidget instanceof K?this.selection.getLastBlockInLastCell(s.paragraph.previousRenderedWidget):s.paragraph.previousRenderedWidget,s.setPositionParagraph(a.lastChild,a.lastChild.getEndOffset())):s.setPositionParagraph(o.paragraph.lastChild,o.paragraph.lastChild.getEndOffset())),!0),l=(o.isAtParagraphStart&&s.isAtParagraphEnd&&(a=!1),this.editorHistory&&this.initComplexHistory("InsertContentControl"),this.selection.isHighlightContentControlEditRegion=!0,new E(a?"Inline":"Block")),d=new E(a?"Inline":"Block"),a=new Jh(a?"Inline":"Block");a.color="#00000000",this.selection.isEmpty?a.hasPlaceHolderText=!0:a.hasPlaceHolderText=!1,a.isTemporary=!1,a.lockContentControl=!_.isNullOrUndefined(n)&&!n,a.lockContents=!_.isNullOrUndefined(r)&&!r,a.tag=_.isNullOrUndefined(i)?void 0:i,a.title=_.isNullOrUndefined(t)?void 0:t,a.multiline=!1,a.type="RichText",this.owner.isXmlMapCC&&this.addXmlProperties(a,this.owner.xPathString),l.contentControlProperties=a,d.contentControlProperties=l.contentControlProperties,l.type=0,d.type=1,a.hasPlaceHolderText?(n=new X,(r=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.owner.locale),n.text=r.getConstant("Default Content Control Text"),n.characterFormat=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!0),this.insertElementsInternal(o,[l]),this.insertElementsInternal(o,[n]),o.offset,n.length,this.insertElementsInternal(o,[d])):(o.currentWidget===s.currentWidget&&s.offset++,i=this.selection.getParagraphInfo(s),t=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()),this.insertElementsInternal(o,[l]),s=this.owner.selection.getTextPosBasedOnLogicalIndex(t),this.insertElementsInternal(s,[d])),_.isNullOrUndefined(e)||(this.documentHelper.selection.selectContentInternal(l),this.paste(e)),this.updatePropertiesToBlock(l,!0),a.hasPlaceHolderText?this.selection.selectPlaceHolderText(l):this.selection.selectContentInternal(l),this.selection.start.currentWidget.getInline(this.selection.start.offset-1,0).element.contentControlProperties=a,this.selection.contentControleditRegionHighlighters.clear(),this.selection.onHighlightContentControl(),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.viewer.updateScrollBars()},o.prototype.isInvalidElementPresent=function(e,t){for(var i=this.selection.getElementInfo(e.currentWidget,e.offset+1),n=this.selection.getElementInfo(t.currentWidget,t.offset),r=e.currentWidget.indexInOwner;r<t.currentWidget.indexInOwner+1;r++)for(var o=e.currentWidget.paragraph.childWidgets[r],s=i.element.indexInOwner;s<o.children.length;s++){var a=o.children[s];if(!(a instanceof X))return!0;if(n.element==a)return!1}return!1},o.prototype.applyPlainText=function(e,t,i,n,r){var o,s,a,l,d=this.getContentControl();!_.isNullOrUndefined(d)&&"RichText"!==d.contentControlProperties.type||(d=(this.selection.isForward?this.selection.start:this.selection.end).clone(),o=(this.selection.isForward?this.selection.end:this.selection.start).clone(),this.selection.isParagraphMarkSelected()&&--o.offset,d.paragraph!==o.paragraph&&o.setPositionParagraph(d.paragraph.lastChild,d.paragraph.lastChild.getEndOffset()),l=!0,d.isAtParagraphStart&&o.isAtParagraphEnd&&(l=!1),!this.selection.isEmpty&&this.isInvalidElementPresent(d,o)?this.openContentDialog(!1):(this.selection.isHighlightContentControlEditRegion=!0,s=new E(l?"Inline":"Block"),a=new E(l?"Inline":"Block"),(l=new Jh(l?"Inline":"Block")).color="#00000000",this.selection.isEmpty?l.hasPlaceHolderText=!0:l.hasPlaceHolderText=!1,l.isTemporary=!1,l.lockContentControl=!_.isNullOrUndefined(n)&&!n,l.lockContents=!_.isNullOrUndefined(r)&&!r,l.tag=_.isNullOrUndefined(i)?void 0:i,l.title=_.isNullOrUndefined(t)?void 0:t,l.multiline=!1,l.type="Text",this.owner.isXmlMapCC&&this.addXmlProperties(l,this.owner.xPathString),s.contentControlProperties=l,a.contentControlProperties=s.contentControlProperties,s.type=0,a.type=1,this.editorHistory&&this.initComplexHistory("InsertContentControl"),l.hasPlaceHolderText?(n=new X,_.isNullOrUndefined(e)?((r=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.owner.locale),n.text=r.getConstant("Default Content Control Text")):n.text=e,n.characterFormat=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!0),this.insertElementsInternal(d,[s]),this.insertElementsInternal(d,[n]),d.offset,n.length,this.insertElementsInternal(d,[a])):(d.currentWidget===o.currentWidget&&o.offset++,i=this.selection.getParagraphInfo(o),t=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()),this.insertElementsInternal(d,[s]),o=this.owner.selection.getTextPosBasedOnLogicalIndex(t),this.insertElementsInternal(o,[a])),this.selection.start.currentWidget.getInline(this.selection.start.offset-1,0).element.contentControlProperties=l,this.updatePropertiesToBlock(s,!0),l.hasPlaceHolderText?this.selection.selectPlaceHolderText(s):this.selection.selectContentInternal(s),this.selection.contentControleditRegionHighlighters.clear(),this.selection.onHighlightContentControl(),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.viewer.updateScrollBars()))},o.prototype.applyComboBox=function(e,t,i){var n=this.getContentControl();if(_.isNullOrUndefined(n)||"RichText"===n.contentControlProperties.type){this.selection.isHighlightContentControlEditRegion=!0;var n=new E("Inline"),r=new E("Inline"),o=new Jh("Inline"),s=(o.color="#00000000",o.type=e,this.selection.isEmpty?o.hasPlaceHolderText=!0:o.hasPlaceHolderText=!1,o.isTemporary=!1,o.lockContentControl=!1,o.lockContents=!1,o.multiline=!1,[]);if(_.isNullOrUndefined(t)){var a=new Qh,l=new _.L10n("documenteditor",this.owner.defaultLocale);a.displayText=l.getConstant("Choose an item"),a.value=l.getConstant("Choose an item"),s.push(a)}else for(var d=0;d<t.length;d++)(a=new Qh).displayText=t[d],a.value=t[d],s.push(a);o.contentControlListItems=s,o.contentControlWidgetType="Inline",this.owner.isXmlMapCC&&this.addXmlProperties(o,this.owner.xPathString),n.contentControlProperties=o,r.contentControlProperties=n.contentControlProperties,n.type=0,r.type=1,this.editorHistory&&this.initComplexHistory("InsertContentControl");var e=(this.selection.isForward?this.selection.start:this.selection.end).clone(),h=(this.selection.isForward?this.selection.end:this.selection.start).clone();h.paragraph!==e.paragraph&&(h=new y(this.owner)).setPositionParagraph(e.paragraph.lastChild,e.paragraph.lastChild.getEndOffset()),o.hasPlaceHolderText?(a=new X,l=new _.L10n("documenteditor",this.owner.defaultLocale),a.text=l.getConstant("Choose an item"),a.characterFormat=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!0),this.insertElementsInternal(e,[n]),this.insertElementsInternal(e,[a]),e.offset,a.length,this.insertElementsInternal(e,[r])):(this.insertElementsInternal(e,[n]),h.offset++,this.insertElementsInternal(h,[r])),this.selection.start.currentWidget.getInline(this.selection.start.offset-1,0).element.contentControlProperties=o,_.isNullOrUndefined(t)||this.dropDownChange(n,i),this.selection.onHighlightContentControl(),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.viewer.updateScrollBars()}},o.prototype.applyDatePickerContentControl=function(e,t,i,n,r,o){this.dateValue=t;var s,a,l=this.getContentControl();!_.isNullOrUndefined(l)&&"RichText"!==l.contentControlProperties.type||(this.selection.isHighlightContentControlEditRegion=!0,l=new E("Inline"),s=new E("Inline"),(a=new Jh("Inline")).color="#00000000",this.selection.isEmpty?a.hasPlaceHolderText=!0:a.hasPlaceHolderText=!1,a.isTemporary=!1,a.lockContentControl=!_.isNullOrUndefined(r)&&r,a.lockContents=!_.isNullOrUndefined(o)&&r,a.tag=_.isNullOrUndefined(n)?void 0:n,a.title=_.isNullOrUndefined(i)?void 0:i,a.multiline=!1,a.type=e,a.contentControlWidgetType="Inline",this.owner.isXmlMapCC&&this.addXmlProperties(a,this.owner.xPathString),l.contentControlProperties=a,s.contentControlProperties=l.contentControlProperties,l.type=0,s.type=1,this.editorHistory&&this.initComplexHistory("InsertContentControl"),o=(this.selection.isForward?this.selection.start:this.selection.end).clone(),(r=(this.selection.isForward?this.selection.end:this.selection.start).clone()).paragraph!==o.paragraph&&(r=new y(this.owner)).setPositionParagraph(o.paragraph.lastChild,o.paragraph.lastChild.getEndOffset()),a.hasPlaceHolderText?(n=new X,t?n.text=t:((i=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.owner.locale),n.text=i.getConstant("Default Date Picker")),n.characterFormat=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!0),this.insertElementsInternal(o,[l]),this.insertElementsInternal(o,[n]),o.offset,n.length,this.insertElementsInternal(o,[s])):(this.insertElementsInternal(o,[l]),r.offset++,this.insertElementsInternal(r,[s])),this.selection.start.currentWidget.getInline(this.selection.start.offset-1,0).element.contentControlProperties=a,this.selection.onHighlightContentControl(),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.viewer.updateScrollBars())},o.prototype.applyCheckBoxContentControl=function(e,t,i){var n,r,o=this.getContentControl();!_.isNullOrUndefined(o)&&"RichText"!==o.contentControlProperties.type||(this.selection.isHighlightContentControlEditRegion=!0,o=new E("Inline"),n=new E("Inline"),(r=new Jh("Inline")).color="#00000000",r.hasPlaceHolderText=!1,r.isTemporary=!1,r.lockContentControl=!1,r.lockContents=!1,r.multiline=!1,r.type=e,_.isNullOrUndefined(i)?r.isChecked=!1:r.isChecked=i,r.uncheckedState=new ec,r.uncheckedState.font=this.selection.characterFormat.fontFamily,r.uncheckedState.value=String.fromCharCode(9744),r.checkedState=new ec,r.checkedState.font=this.selection.characterFormat.fontFamily,r.checkedState.value=String.fromCharCode(9746),r.contentControlWidgetType="Inline",this.owner.isXmlMapCC&&this.addXmlProperties(r,this.owner.xPathString),o.contentControlProperties=r,n.contentControlProperties=o.contentControlProperties,o.type=0,n.type=1,this.editorHistory&&this.initComplexHistory("InsertContentControl"),e=(this.selection.isForward?this.selection.start:this.selection.end).clone(),(i=(this.selection.isForward?this.selection.end:this.selection.start).clone()).paragraph!==e.paragraph&&(i=new y(this.owner)).setPositionParagraph(e.paragraph.lastChild,e.paragraph.lastChild.getEndOffset()),this.selection&&(this.insertElementsInternal(e,[o]),i.offset++,this.insertElementsInternal(i,[n])),r=this.documentHelper.selection.start.currentWidget.getOffset(o,1),(e=new y(this.documentHelper.owner)).setPositionParagraph(o.line,r),i=this.documentHelper.selection.start.currentWidget.getOffset(n,0),(o=new y(this.documentHelper.owner)).setPositionParagraph(n.line,i),this.documentHelper.selection.selectRange(e,o),this.documentHelper.owner.editor.insertTextInternal(t,!0),this.selection.onHighlightContentControl(),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.viewer.updateScrollBars())},o.prototype.applyPictureContentControl=function(e,t){var i,n,r=this.getContentControl();!_.isNullOrUndefined(r)&&"RichText"!==r.contentControlProperties.type||(r=new E("Inline"),i=new E("Inline"),(n=new Jh("Inline")).color="#00000000",n.hasPlaceHolderText=!1,n.isTemporary=!1,n.lockContentControl=!1,n.lockContents=!1,n.multiline=!1,n.type=e,n.contentControlWidgetType="Inline",this.owner.isXmlMapCC&&this.addXmlProperties(n,this.owner.xPathString),r.contentControlProperties=n,i.contentControlProperties=r.contentControlProperties,r.type=0,i.type=1,this.editorHistory&&this.initComplexHistory("InsertContentControl"),e=this.selection.start.clone(),n=this.selection.end.clone(),this.selection.isForward||(r.type=1,i.type=0),this.selection.start.paragraph==this.selection.end.paragraph&&(this.insertElementsInternal(e,[r]),_.isNullOrUndefined(t)||this.insertImageAsync(t),this.insertElementsInternal(n,[i])),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.viewer.updateScrollBars())},o.prototype.getPrefixMapping=function(e){e=(new DOMParser).parseFromString(e,"application/xml");this.documentHelper.owner.prefixMappings=e.documentElement.namespaceURI},o.prototype.addXmlProperties=function(e,t){e.xmlMapping=new ic,e.xmlMapping.isMapped=!0,_.isNullOrUndefined(this.documentHelper.owner.prefixMappings)?e.xmlMapping.prefixMapping=" ":e.xmlMapping.prefixMapping=this.documentHelper.owner.prefixMappings,e.xmlMapping.xPath=t,_.isNullOrUndefined(this.guid)&&(this.guid=this.createGuid()),e.xmlMapping.storeItemId="{"+this.guid+"}",this.documentHelper.customXmlData.add(e.xmlMapping.storeItemId,this.xmlStringValue)},o.prototype.createGuid=function(){var i=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(i+16*Math.random())%16|0;return i=Math.floor(i/16),("x"===e?t:3&t|8).toString(16)})},o.prototype.mapXmlStringPath=function(e){this.getPrefixMapping(e.xmlString);var t=this.parseXml(e.xmlString),i=this.objectToArray(t),t=(this.setXmlData(t,i),this.xmlData,e.xmlPath.split("/").pop()),i=e.xmlPath.split("/"),i=i[i.length-2],i=this.getXmlValue(i,t);return this.owner.isXmlMapCC=!0,e.xmlPath=this.transformString(e.xmlPath),this.owner.xPathString="/"+e.xmlPath,e.value=i,e},o.prototype.setContentControlInfo=function(e){var t,i=this.documentHelper.selection.getContentControlInfo();if(!_.isNullOrUndefined(i))return i.xmlString=e.xmlString,i.xmlPath=e.xmlPath,e=this.getContentControl(),t=this.documentHelper.owner.getImageContentControl(),_.isNullOrUndefined(e)&&_.isNullOrUndefined(t)||_.isNullOrUndefined(i)||_.isNullOrUndefined(i.xmlString)||_.isNullOrUndefined(i.xmlString)||(i=this.mapXmlStringPath(i),this.documentHelper.owner.selection.selectContentInternal(e),this.insertText(i.value),t=this.getContentControl(),this.addXmlProperties(t.contentControlProperties,this.owner.xPathString),this.owner.isXmlMapCC=!1),i},o.prototype.transformString=function(e){return e.split("/").map(function(e){return e+"[1]"}).join("/")},o.prototype.getXmlValue=function(e,t){for(var i,n,r,o=0;o<this.xmlData.length;o++)if(this.xmlData[o].displayText==e&&(i=this.xmlData[o].id),i=Number(i),!isNaN(i)&&this.xmlData[o].displayText==t&&this.xmlData[i-1].displayText==e){n=this.xmlData[o].id,Number(n),r=(r=this.xmlData[o].displayValue).toString();break}return r},o.prototype.objectToArray=function(i){return Object.keys(i).map(function(e,t){return{index:String(t+1),data:i[e]}})},o.prototype.parseXml=function(e){this.xmlStringValue=e;try{var t=(new DOMParser).parseFromString(e,"text/xml"),i=this.xmlToJson(t.documentElement);return this.xmlTitle=t.documentElement.nodeName,i}catch(e){return console.error("Error parsing XML string:",e),null}},o.prototype.xmlToJson=function(e){var t={};if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];1===n.nodeType?n.nextSibling&&n.nextSibling.nodeName===n.nodeName?(t[n.nodeName]||(t[n.nodeName]=[]),t[n.nodeName].push(this.xmlToJson(n))):t[n.nodeName]=this.xmlToJson(n):3===n.nodeType&&(n=n.textContent.trim())&&(t=n)}return t},o.prototype.setXmlData=function(e,t){var i,n=2,r=(this.xmlData=[],this.xmlData.push({id:1,displayText:this.xmlTitle,hasChild:!0,expanded:!0}),0);for(i in e){for(var o=!0;r<t.length;r++){var s=t[r].data,o=s instanceof Object&&0<Object.keys(s).length;r+=1;break}this.xmlData.push({id:n++,displayText:i,displayValue:e[i],pid:"1",hasChild:o,expanded:o});for(var a=e[i],l=0;l<t.length;l++){var d=t[l].data,h=(n-1).toString();if(d instanceof Object&&d==a)for(var c in d)this.xmlData.push({id:n++,displayText:c,displayValue:a[c],pid:h})}}this.dictionaryObject[this.dictionaryObjectIndexIncrement++]={ID:"(no namespace)_"+this.dictionaryObjcetIDIncreament,Data:this.xmlData},this.dictionaryObjcetIDIncreament++},o.prototype.dropDownChange=function(e,t){_.isNullOrUndefined(e)||(this.documentHelper.selection.selectContentInternal(e),this.insertTextInternal(t,!0),e.contentControlProperties.isTemporary&&this.removeContentControl())},o.prototype.updateXmlMappedContentControl=function(){var e;this.isXmlMapped&&(e=this.getContentControl())&&e.contentControlProperties&&this.updateCustomXml(e.contentControlProperties.xmlMapping.storeItemId,e.contentControlProperties.xmlMapping.xPath,this.getResultContentControlText(e))},o.prototype.updateCustomXml=function(e,t,i){if(this.documentHelper.customXmlData.containsKey(e)){var n=this.documentHelper.customXmlData.get(e),n=(new DOMParser).parseFromString(n,"text/xml"),t=t.substring(t.lastIndexOf("/")+1),r=(t=(t=(t=t.split("[")[0]).substring(t.lastIndexOf(":")+1)).substring(t.lastIndexOf("@")+1),n.getElementsByTagName(t));if(0<r.length)r[0].childNodes[0].nodeValue=i;else{if(!(0<n.documentElement.attributes.length&&null!==n.documentElement.attributes.getNamedItem(t)))return;n.documentElement.attributes.getNamedItem(t).value=i}r=(new XMLSerializer).serializeToString(n);this.documentHelper.customXmlData.set(e,r)}},o.prototype.insertText=function(e){_.isNullOrUndefined(e)||""===e||this.owner.isReadOnly||"ReadOnly"===this.documentHelper.protectionType&&!this.selection.isSelectionInEditRegion()||"CommentsOnly"===this.documentHelper.protectionType&&this.owner.isReadOnly||(this.isInsertingText=!0,this.insertTextInternal(e,!1),this.isInsertingText=!1)},o.prototype.insertTextInternal=function(e,t,i,n,r){if(0<=e.indexOf("\r")||0<=e.indexOf("\n"))"\r"===e||"\n"===e||"\r\n"===e?this.onEnter():(this.isInsertText=!0,this.pasteContents(e),this.isInsertText=!1);else{if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()){if(!(l=this.selection.currentFormField).formFieldData.enabled)return;var o=this.getFieldResultText(l),s=new RegExp(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi"),s=(0<o.length&&""===o.replace(s,"")&&(o="",this.selection.selectFieldInternal(l)),l.formFieldData.maxLength);if(0!==s&&o.length>=s)return}t&&(this.documentHelper.layout.isReplaceAll=!_.isNullOrUndefined(n)&&!n);var a,l,d,h,c,p,o=this.documentHelper.owner.editor.getContentControl(),s=(!_.isNullOrUndefined(o)&&o.contentControlProperties.hasPlaceHolderText&&(this.documentHelper.selection.selectContentInternal(o),o.contentControlProperties.hasPlaceHolderText=!1),this.documentHelper.selection),n=!0,u=!1,g=(i=this.owner.enableTrackChanges&&_.isNullOrUndefined(i)?"Insertion":i,this.checkAndRemoveComments()),m=(this.isListTextSelected(),this.documentHelper.isBookmarkInserted&&0<s.bookmarks.length&&this.extendSelectionToBookmarkStart(),!_.isNullOrUndefined(i)&&"Insertion"!==i||(this.initHistory("Insert"),_.isNullOrUndefined(this.editorHistory))||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.insertedText=e,"FormFieldsOnly"===this.documentHelper.protectionType&&(m=this.documentHelper.selection.getCurrentFormField())&&m instanceof Z&&m.formFieldData&&m.formFieldData instanceof Sh&&(this.editorHistory.currentBaseHistoryInfo.fieldBegin=m,this.editorHistory.currentBaseHistoryInfo.dropDownIndex=m.formFieldData.selectedIndex)),this.selection.getParagraphInfo(s.start)),f=m.paragraph.paragraphFormat,y=(s.editPosition=s.getHierarchicalIndex(m.paragraph,m.offset.toString()),s.start.paragraph.paragraphFormat.bidi),v=(!s.isEmpty&&!s.isImageSelected||this.documentHelper.isListTextSelected&&"List"===s.contextType?(s.isSkipLayouting=!0,s.skipFormatRetrieval=!0,c=a=void 0,v=h=0,this.owner.enableTrackChanges&&(a=(this.selection.start.isExistBefore(this.selection.end)?(c=this.selection.getParagraphInfo(s.end),this.selection.end):(c=this.selection.getParagraphInfo(s.start),this.selection.start)).clone(),v=c.paragraph.getLength(),h=c.offset-1===v?c.offset-1:c.offset,this.skipReplace=!0),(n=this.removeSelectedContents(s))&&(this.updateInsertPosition(),u=!0),this.skipReplace=!1,!_.isNullOrUndefined(a)&&this.owner.searchModule&&this.owner.searchModule.isRepalceTracking?(this.owner.searchModule.isRepalceTracking=!1,this.selection.start.setPositionInternal(this.selection.start),this.selection.end.setPositionInternal(a)):0<h&&h<=v&&(v!==(a=c.paragraph.getLength())&&(h-=v-a),this.setPositionParagraph(c.paragraph,h,!0)),s.skipFormatRetrieval=!1,s.isSkipLayouting=!1):!s.isEmpty||this.documentHelper.isListTextSelected||t||(this.documentHelper.isTextInput=!0),(m=this.selection.getParagraphInfo(s.start)).paragraph.paragraphFormat.copyFormat(f),this.documentHelper.textHelper.containsSpecialCharAlone(e));if(n&&(s.owner.isShiftingEnabled=!0,u||this.updateInsertPosition(),(a=s.start).paragraph.isEmpty()?(c=new X,p=this.copyInsertFormat(a.paragraph.characterFormat,!0),c.characterFormat.copyFormat(p),c.text=e,d=this.documentHelper.textHelper.getRtlLanguage(e).isRtl||this.selection.characterFormat.bidi,c.characterFormat.bidi=d,p.bidi=d,c.isRightToLeft=d,c.line=a.paragraph.childWidgets[0],c.margin=new Dd(0,0,0,0),c.line.children.push(c),this.setCharFormatForCollaborativeEditing(c.characterFormat),this.owner.enableTrackChanges&&(0<c.paragraph.characterFormat.revisions.length&&0<(h=this.getMatchedRevisionsToCombine(c.paragraph.characterFormat.revisions,i)).length&&this.mapMatchedRevisions(h,c.paragraph.characterFormat,c,!0),this.checkToCombineRevisionWithPrevPara(c,i)||0!==c.revisions.length||this.insertRevision(c,i)),("Center"===a.paragraph.paragraphFormat.textAlignment||"Right"===a.paragraph.paragraphFormat.textAlignment||"Justify"===a.paragraph.paragraphFormat.textAlignment&&a.paragraph.paragraphFormat.bidi)&&-1===a.paragraph.paragraphFormat.listFormat.listId&&(a.paragraph.x=a.paragraph.clientX,a.paragraph.clientX=void 0,a.paragraph.hasOwnProperty("absoluteXPosition"))&&delete a.paragraph.absoluteXPosition,c instanceof X&&90<c.text.length&&j.splitWordByMaxLength(c,c.line),this.documentHelper.layout.reLayoutParagraph(a.paragraph,0,0)):(l=(u=a.currentWidget.getInline(a.offset,f=0,y,!t,this.documentHelper.owner.isSpellCheck)).element,f=u.index,l.ischangeDetected=!0,!l.paragraph.isInsideTable&&l instanceof J&&1===l.bookmarkType&&!_.isNullOrUndefined(l.properties)&&l.properties.hasOwnProperty("isAfterParagraphMark")&&delete l.properties.isAfterParagraphMark,l instanceof X&&" "!==e&&this.documentHelper.owner.isSpellCheck&&(this.owner.spellCheckerModule.removeErrorsFromCollection({element:l,text:l.text}),t||(l.ignoreOnceItems=[])),l.canTrigger&&l.text.length<=1&&(l.canTrigger=!1),p=this.copyInsertFormat(l.characterFormat,!0),d=this.documentHelper.textHelper.getRtlLanguage(e).isRtl||this.selection.characterFormat.bidi,this.documentHelper.textHelper.getRtlLanguage(e).id,h=0,y=c=!1,l instanceof X&&(h=this.documentHelper.textHelper.getRtlLanguage(l.text).id,c=this.documentHelper.textHelper.getRtlLanguage(l.text).isRtl,y=this.documentHelper.textHelper.containsSpecialCharAlone(e)),!(d=!d&&l.characterFormat.bidi&&(0!==h||y&&c)||" "===e&&this.selection.characterFormat.bidi?!0:d)&&this.documentHelper.owner.isSpellCheck||(p.bidi=d),this.setCharFormatForCollaborativeEditing(p),(!this.documentHelper.owner.isSpellCheck||" "!==e&&" "!==l.text)&&p.isSameFormat(l.characterFormat)&&this.canInsertRevision(l,i)||""===e.trim()&&!d&&l.characterFormat.bidi||c&&p.isSameFormat(l.characterFormat)&&v?(this.insertTextInline(l,s,e,f),this.setCharFormatForCollaborativeEditing(l.characterFormat)):((u=new X).text=e,u.line=l.line,u.isRightToLeft=c,u.characterFormat.copyFormat(p),!_.isNullOrUndefined(l)&&l.contentControlProperties&&(u.contentControlProperties=l.contentControlProperties),this.setCharFormatForCollaborativeEditing(u.characterFormat),l instanceof Bh&&(u.characterFormat.baselineAlignment="Normal"),h=!1,y=l.indexInOwner,v=u.revisions.length,f!==l.length||r?0!==f||r?(l instanceof X&&((c=new X).line=l.line,c.characterFormat.copyFormat(l.characterFormat),!_.isNullOrUndefined(l)&&l.contentControlProperties&&(c.contentControlProperties=l.contentControlProperties),c.text=l.text.substring(f),this.owner.enableTrackChanges||this.selection.isInField||this.updateRevisionForSpittedTextElement(l,c),l.text=l.text.slice(0,f),l.isWidthUpdated=!1,this.owner.enableTrackChanges?(h=this.checkToMapRevisionWithInlineText(l,f,u,d,i))||u.revisions.length>v?this.copyElementRevision(l,c,!0):u.revisions.length===v&&(this.updateRevisionForSpittedTextElement(l,c),this.insertRevision(u,i)):this.selection.isInField&&(this.copyElementRevision(l,c,!1),this.updateElementInFieldRevision(l,u,l.revisions,!0)),this.owner.isSpellCheck&&this.owner.spellCheckerModule.updateSplittedElementError(l,c),""!==c.text)&&l.line.children.splice(y+1,0,c),h||l.line.children.splice(y+1,0,u)):(this.owner.enableTrackChanges&&!(h=this.checkToMapRevisionWithInlineText(l,f,u,d,i))&&0===u.revisions.length&&this.checkToMapRevisionWithPreviousNode(l.previousNode,u,d,i),h||(l.line.children.splice(y,0,u),this.checkToCombineRevisionsinBlocks(u,v===u.revisions.length,!0,i))):(p=-1,p=y+1,(h=!this.owner.enableTrackChanges||l instanceof J||(h=this.checkToMapRevisionWithInlineText(l,f,u,d,i))||u.revisions.length!==v?h:(null==l.nextNode||1!=l.nextNode.revisions.length)&&1==l.paragraph.characterFormat.revisions.length&&"Deletion"==l.paragraph.characterFormat.revisions[0].revisionType?this.checkToMapRevisionWithNextNode(l.nextNode,u,d,i,l.paragraph):this.checkToMapRevisionWithNextNode(l.nextNode,u,d,i))||(l.line.children.splice(p,0,u),this.checkToCombineRevisionsinBlocks(u,v===u.revisions.length,!0,i))),u instanceof X&&90<u.text.length&&j.splitWordByMaxLength(u,u.line),(_.isNullOrUndefined(i)||"Deletion"!==i||a.paragraph.isLayouted)&&this.documentHelper.layout.reLayoutParagraph(a.paragraph,l.line.indexInOwner,0),l instanceof X&&-1!==l.line.children.indexOf(l)&&""===l.text&&l.line.children.splice(l.line.children.indexOf(l),1))),!_.isNullOrUndefined(o)&&o.contentControlProperties.isTemporary&&this.removeContentControl(),_.isNullOrUndefined(o)||(this.selection.contentControleditRegionHighlighters.clear(),this.selection.onHighlightContentControl()),this.documentHelper.layout.allowLayout=!0,this.setPositionParagraph(m.paragraph,m.offset+e.length,!0),this.updateEndPosition(),_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"ListSelect"!==this.editorHistory.currentHistoryInfo.action||!this.documentHelper.isListTextSelected||(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()),!_.isNullOrUndefined(i)&&"Insertion"!==i||this.isFieldOperation||this.reLayout(s),this.documentHelper.isTextInput=!1),this.updateXmlMappedContentControl(),!t&&n&&(" "===e||"\t"===e||"\v"===e)){r=!1;if(!(r="\v"===e||this.isRemoteAction?r:this.checkAndConvertList(s,"\t"===e))){if(!_.isNullOrUndefined(s.getHyperlinkField()))return;this.checkAndConvertToHyperlink(s,!1)}}this.updateHistoryForComments(g)}},o.prototype.extendSelectionToBookmarkStart=function(){if(0<this.documentHelper.bookmarks.length)for(var e=this.selection.start,t=(this.selection.end,this.selection.isForward||(e=this.selection.end,this.selection.start),void 0),i=this.selection.bookmarks,n=0;n<i.length;n++){var r,o,t=this.documentHelper.bookmarks.get(i[n]);this.selection.isElementInSelection(t.reference,!1)&&!this.selection.isElementInSelection(t,!0)&&(o=t.line.paragraph,r=this.selection.getParagraphInfo(e),o.equals(r.paragraph))&&(o=t.line.getOffset(t,t.bookmarkType),t.line===e.currentWidget)&&r.offset===o+1&&e.offset--}},o.prototype.updateElementInFieldRevision=function(e,t,i,n){for(var r=0;r<i.length;r++){var o=i[r],s=o.range.indexOf(e);o.range.splice(n?s+1:s,0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(o)}},o.prototype.retrieveFieldResultantText=function(e){var t="";if(1===e.fieldType){var i=e.previousElement;for(_.isNullOrUndefined(i)&&0===e.indexInOwner&&!_.isNullOrUndefined(e.line)&&!_.isNullOrUndefined(e.line.previousLine)&&e.line.previousLine.children[e.line.previousLine.children.length-1]instanceof X&&(i=e.line.previousLine.children[e.line.previousLine.children.length-1]);!_.isNullOrUndefined(i)&&i instanceof X;)t=i.text+t,i=_.isNullOrUndefined(i.previousNode)?void 0:i.previousNode.previousValidNodeForTracking}return t},o.prototype.checkToCombineRevisionsinBlocks=function(e,t,i,n){t&&this.owner.enableTrackChanges&&(e instanceof J||e instanceof up||e instanceof Wc||e instanceof Sc||(i?this.combineRevisionWithNextPara(e,n):this.combineRevisionWithPrevPara(e,n))||this.insertRevision(e,n))},o.prototype.checkToMapRevisionWithNextNode=function(e,t,i,n,r){return _.isNullOrUndefined(r)||1!=r.characterFormat.revisions.length?!_.isNullOrUndefined(e)&&(e=e.nextValidNodeForTracking,!_.isNullOrUndefined(e))&&this.checkToMapRevisionWithInlineText(e,0,t,i,n):(e=r.characterFormat,!_.isNullOrUndefined(e)&&this.checkToMapRevisionWithInlineText(void 0,0,t,i,n,e))},o.prototype.checkToMapRevisionWithPreviousNode=function(e,t,i,n){return!_.isNullOrUndefined(e)&&(e=e.previousValidNodeForTracking,!_.isNullOrUndefined(e))&&this.checkToMapRevisionWithInlineText(e,e.length,t,i,n)},o.prototype.checkToMapRevisionWithInlineText=function(e,t,i,n,r,o){if(_.isNullOrUndefined(o)){if(!_.isNullOrUndefined(e))if("Deletion"===r&&this.updateLastElementRevision(i),e.length===t&&null!=e.previousValidNodeForTracking){if(t=(e=e.previousValidNodeForTracking).length,0<e.revisions.length)return this.applyMatchedRevisionInorder(e,i,t,!1,n,r)}else if(0===t&&(e=e.nextValidNodeForTracking,!_.isNullOrUndefined(e))&&0<e.revisions.length)return this.applyMatchedRevisionInorder(e,i,t,!0,n,r)}else if("Deletion"===r&&this.updateLastElementRevision(i),!_.isNullOrUndefined(o)&&0<o.revisions.length)return this.applyMatchedRevisionInorder(void 0,i,t,!0,n,r,o);return!1},o.prototype.combineElementRevisions=function(e,t){if(0!==e.revisions.length&&0!==t.revisions.length)for(var i=0;i<e.revisions.length;i++)for(var n=e.revisions[i],r=0;r<t.revisions.length;r++){var o=t.revisions[i];-1===n.range.indexOf(t)&&o.revisionType===n.revisionType&&o.author===n.author&&(t.revisions.splice(r,1),n.range.push(t),t.revisions.splice(r,0,n),this.owner.trackChangesPane.updateCurrentTrackChanges(n))}},o.prototype.applyMatchedRevisionInorder=function(e,t,i,n,r,o,s){var a;return!_.isNullOrUndefined(s)&&_.isNullOrUndefined(e)?0<(a=this.getMatchedRevisionsToCombine(s.revisions,o)).length&&this.mapMatchedRevisions(a,s,t,n):0<(a=this.getMatchedRevisionsToCombine(e.revisions,o)).length&&this.mapMatchedRevisions(a,e,t,n),!1},o.prototype.copyElementRevision=function(e,t,i){if(!this.isTrackingFormField)for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n],o=r.range.indexOf(e);t.revisions.splice(0,0,r),r.range.splice(o+(i?2:1),0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(r)}},o.prototype.mapMatchedRevisions=function(e,t,i,n){for(var r=0;r<e.length;r++){var o,s=e[r];this.isRevisionAlreadyIn(i,s)||(i.revisions.splice(0,0,s),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&0===this.editorHistory.currentBaseHistoryInfo.markerData.length&&this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(void 0,void 0,s)),i instanceof Bh&&this.insertRevisionForFootnoteWidget(i,s),o=s.range.indexOf(t),s.range.splice(n?o:o+1,0,i),this.owner.trackChangesPane.updateCurrentTrackChanges(s))}},o.prototype.isRevisionAlreadyIn=function(e,t){if(0<e.revisions.length)for(var i=0;i<e.revisions.length;i++)if(e.revisions[i].revisionID===t.revisionID)return!0;return!1},o.prototype.getMatchedRevisionsToCombine=function(e,t){for(var i=[],n=0;n<e.length;n++)this.isRevisionMatched(e[n],t)&&i.push(e[n]);return i},o.prototype.decideInlineForTrackChanges=function(e,t){var i,n=!1;return this.owner.enableTrackChanges&&!this.canInsertRevision(e,t)&&(i=e.nextValidNodeForTracking,!_.isNullOrUndefined(i))&&this.canInsertRevision(i,t)&&(e=i,n=!0),{element:e,isMatched:n}},o.prototype.insertIMEText=function(e,t){var i,n;this.documentHelper.lastComposedText===e&&t||(n=this.selection.getParagraphInfo(this.selection.start),n=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),this.insertText(e),this.documentHelper.lastComposedText=e,i=this.selection.start,this.setPositionForCurrentIndex(i,n),(n=new y(this.owner)).setPositionForLineWidget(i.currentWidget,i.offset+e.length),this.owner.enableTrackChanges?(t||this.selection.start.setPositionInternal(this.selection.end),this.selection.end.updatePhysicalPosition(!0)):this.selection.selectPosition(t?i:n,n))},o.prototype.insertSectionBreak=function(e,t){_.isNullOrUndefined(e)&&(e=V.SectionBreakType.NewPage);var i=this.documentHelper.selection;_.isNullOrUndefined(i)||this.owner.isReadOnlyMode||i.start.paragraph.isInHeaderFooter||(e===V.SectionBreakType.Continuous?this.initHistory("SectionBreakContinuous"):this.initHistory("SectionBreak"),i.isEmpty||i.selectContent(i.isForward?i.start:i.end,!0),this.documentHelper.owner.isShiftingEnabled=!0,this.updateInsertPosition(),e===V.SectionBreakType.Continuous?(this.documentHelper.layout.isSectionBreakCont=!0,this.insertSection(i,!0,void 0,!0,void 0,t)):this.insertSection(i,!0,void 0,void 0,!0,t),this.updateEndPosition(),this.reLayout(i,!0),this.layoutWholeDocument(!0),this.documentHelper.layout.isSectionBreakCont=!1)},o.prototype.combineRevisionWithBlocks=function(e,t){if(this.owner.enableTrackChanges&&!_.isNullOrUndefined(e)){for(;e instanceof J||e instanceof up||e instanceof Y;)e=e.nextElement;if(!_.isNullOrUndefined(e)){var i=(e instanceof G?e:e.paragraph).previousRenderedWidget;if(!(i instanceof K)){var n=e instanceof G?e.characterFormat:e;if(!_.isNullOrUndefined(i)&&0<i.characterFormat.revisions.length){var r=i.lastChild;if(_.isNullOrUndefined(r)||0===r.children.length)return;for(var o=r.children[r.children.length-1];o instanceof J||o instanceof up||o instanceof Y;)o=o.previousElement;0<(o=i.isEmpty()?i.characterFormat:o).revisions.length&&this.compareElementRevision(i.characterFormat,n)&&(i=n.revisions[n.revisions.length-1],this.compareElementRevision(o,n))&&i!==(a=o.revisions[o.revisions.length-1])&&(this.clearAndUpdateRevisons(i.range,a,a.range.indexOf(o)+1),this.owner.revisions.remove(i))}if(e instanceof G)s=e.characterFormat;else{for(r=e.paragraph.lastChild;0==r.children.length&&!_.isNullOrUndefined(r.previousLine);)r=r.previousLine;e=null==(s=r.children[r.children.length-1])?e:s}i=(e instanceof G?e:e.paragraph).nextRenderedWidget;if(!(i instanceof K)){if(!_.isNullOrUndefined(i)){for(var s,a,l=i.firstChild.children[0];l instanceof J||l instanceof up||l instanceof Y;)l=l.nextElement;if(i.isEmpty()&&(l=i.characterFormat),_.isNullOrUndefined(l))return;0<l.revisions.length&&(s=l.revisions[l.revisions.length-1],this.compareElementRevision(n,l))&&this.compareElementRevision(n,l)&&s!==(a=n.revisions[n.revisions.length-1])&&(this.clearAndUpdateRevisons(a.range,s,0,!0),this.owner.revisions.remove(a))}e instanceof mh&&0===e.revisions.length&&this.insertRevision(e,t)}}}}},o.prototype.checkToCombineRevisionWithNextPara=function(e,t){var i=e.paragraph.nextRenderedWidget;if(!(i instanceof K||_.isNullOrUndefined(i)||i.isEmpty())){for(var n=i.firstChild.children[0];n instanceof J||n instanceof up;)n=n.previousElement;if(_.isNullOrUndefined(n))return!1;if(0<n.revisions.length){i=this.getMatchedRevisionsToCombine(n.revisions,t);if(0<i.length)return this.mapMatchedRevisions(i,n,e,!0),!0}}return!1},o.prototype.checkToCombineRevisionWithPrevPara=function(e,t){var i=e.paragraph.previousRenderedWidget;if(!(i instanceof K)&&!_.isNullOrUndefined(i)&&0<i.characterFormat.revisions.length){if(!this.isRevisionMatched(i.characterFormat,t))return!1;t=this.getMatchedRevisionsToCombine(i.characterFormat.revisions,t);if(0<t.length)return this.mapMatchedRevisions(t,i.characterFormat,e,!1),!0}return!1},o.prototype.combineRevisionWithNextPara=function(e,t){var i=e.line.isLastLine(),n=e.nextNode;return!(!i||!_.isNullOrUndefined(n))&&this.checkToCombineRevisionWithNextPara(e,t)},o.prototype.combineRevisionWithPrevPara=function(e,t){var i=e.line.isFirstLine(),n=e.previousNode;return!(!i||!_.isNullOrUndefined(n))&&this.checkToCombineRevisionWithPrevPara(e,t)},o.prototype.removeRevision=function(e){var t=this.selection.start.currentWidget.getInline(this.selection.start.offset+1,0),i=t.element;if(0<t.element.revisions.length)for(var n=0;n<i.revisions.length;n++)if(i.revisions[n].revisionType===e.revisionType)for(var r=i.revisions[n],o=r.range.indexOf(i),s=o;o<r.range.length;o++)r.range[s].revisions.splice(n,1),r.range.splice(s,1),this.owner.trackChangesPane.updateCurrentTrackChanges(r)},o.prototype.clearElementRevision=function(e){if(!_.isNullOrUndefined(e))for(var t,i=0;i<e.range.length;i++)e.range[i]instanceof mh&&((t=e.range[i]).revisions.splice(t.revisions.length-1,1),e.range.splice(i,1),this.owner.trackChangesPane.updateCurrentTrackChanges(e))},o.prototype.insertRevision=function(e,t,i,n,r,o,s){if(!this.isRemoteAction||!_.isNullOrUndefined(this.revisionData)||this.documentHelper.owner.parser.isPaste){_.isNullOrUndefined(s)||(a=s),!_.isNullOrUndefined(this.revisionData)&&0<this.revisionData.length&&(i=(s=this.revisionData.pop()).author,n=s.date,a=s.revisionId),i=_.isNullOrUndefined(i)?this.owner.currentUser||"Guest user":i;var a,s=_.isNullOrUndefined(n)?j.getUtcDate():n;if(e instanceof mh&&!_.isNullOrUndefined(e.line)&&e.line.paragraph.associatedCell||e instanceof B&&e.ownerBase instanceof G&&e.ownerBase.associatedCell){n=void 0;if(e instanceof mh?n=e.line.paragraph.associatedCell:e instanceof B&&(n=e.ownerBase.associatedCell),0<n.ownerRow.rowFormat.revisions.length){var n=n.ownerRow.rowFormat,l=this.getMatchedRevisionsToCombine(n.revisions,t);if(0<l.length){!_.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&0===this.editorHistory.currentBaseHistoryInfo.markerData.length&&this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(void 0,void 0,l[0]));for(var d=0;d<l.length;d++)e.revisions.splice(0,0,l[d]),l[d].range.push(e);return}}}n=new $a(this.owner,i,s);return n.revisionType=t,this.owner.enableCollaborativeEditing&&this.isRemoteAction&&!_.isNullOrUndefined(a)&&""!=a?n.revisionID=a:n.revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),this.owner.enableCollaborativeEditing&&!_.isNullOrUndefined(this.getRevision(n.revisionID))&&(n=this.getRevision(n.revisionID)),!_.isNullOrUndefined(r)&&0<r.length&&this.clearAndUpdateRevisons(r,n,r.indexOf(e)),_.isNullOrUndefined(e)||(e.revisions.push(n),_.isNullOrUndefined(r)?n.range.push(e):n.range.splice(0,0,e)),this.isRemoteAction&&this.documentHelper.owner.parser.isPaste?this.remotePasteRevision.push(n):0<n.range.length&&this.updateRevisionCollection(n),_.isNullOrUndefined(e)||(e instanceof Bh&&this.insertRevisionForFootnoteWidget(e,n),this.owner.enableCollaborativeEditing&&!_.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&!o&&this.editorHistory.currentBaseHistoryInfo.markerData.splice(0,0,this.getMarkerData(e,void 0,n))),n}},o.prototype.insertRevisionForFootnoteWidget=function(e,t){var i=e.bodyWidget.childWidgets;this.skipFootNoteDeleteTracking=!0,this.footnoteRevision=t;for(var n=0;n<i.length;n++)this.insertRevisionForBlock(i[n],t.revisionType,!1,t);this.footnoteRevision=void 0,this.skipFootNoteDeleteTracking=!1},o.prototype.clearAndUpdateRevisons=function(e,t,i,n){t.range.filter(function(e){return e instanceof B})&&(i+=1);for(var r,o,s=0,a=0;a<e.length;a++)(e[a]instanceof mh||e[a]instanceof B)&&(o=!1,(r=e[a])instanceof X&&""===r.text?r.revisions.splice(r.revisions.length-1,1):(r.revisions[r.revisions.length-1].range===e&&(r.revisions[r.revisions.length-1].range.splice(r.revisions.length-1,1),o=!0),r.revisions.splice(r.revisions.length-1,1),r.revisions.push(t),t.range.splice(n?s:i+s,0,r),this.owner.trackChangesPane.updateCurrentTrackChanges(t),o&&a--,s++))},o.prototype.splitRevisionByElement=function(e,t){var i;if(0<e.revisions.length)return e=(i=t.range).indexOf(e),t.range=i.splice(0,e+1),this.owner.trackChangesPane.updateCurrentTrackChanges(t),i},o.prototype.updateRevisionForSpittedTextElement=function(e,t){!_.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.splittedRevisions=[]);for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=this.splitRevisionByElement(e,n),n=(t&&""===t.text&&(t=void 0),this.insertRevision(t,n.revisionType,n.author,n.date,r,!0));this.isRemoteAction||this.editorHistory.currentBaseHistoryInfo.splittedRevisions.push(this.getMarkerData(void 0,void 0,this.getRevision(n.revisionID)))}},o.prototype.getRevision=function(e){for(var t=0;t<this.owner.documentHelper.revisionsInternal.length;t++){var i=this.owner.documentHelper.revisionsInternal.keys[t];if(i===e)return this.owner.documentHelper.revisionsInternal.get(i)}},o.prototype.isRevisionMatched=function(e,t){var i=this.owner.currentUser||"Guest user";if(e instanceof $a){if((_.isNullOrUndefined(t)||t===e.revisionType)&&e.author===i)return!0}else if(0<e.revisions.length)for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n];if((_.isNullOrUndefined(t)||t===r.revisionType)&&r.author===i)return!0}return!1},o.prototype.compareElementRevision=function(e,t){if(0!==e.revisions.length&&0!==t.revisions.length)for(var i=0;i<e.revisions.length;i++)for(var n=e.revisions[i],r=0;r<t.revisions.length;r++)if(n.author===t.revisions[r].author&&n.revisionType===t.revisions[r].revisionType)return!0;return!1},o.prototype.canInsertRevision=function(e,t){t=_.isNullOrUndefined(t)?"Insertion":t;return"Deletion"!==t&&(this.owner.enableTrackChanges?this.isRevisionMatched(e,t):!(0<e.revisions.length))},o.prototype.insertRevisionAtEnd=function(e,t,i){return!(t instanceof J||t instanceof up||t instanceof Wc||t instanceof Sc||(e=e.previousValidNodeForTracking,_.isNullOrUndefined(e)))&&this.insertRevisionAtPosition(e,t,!0,i)},o.prototype.insertRevisionAtPosition=function(e,t,i,n){var r=t.revisions.length,o=this.checkToMapRevisionWithInlineText(e,i?e.length:0,t,!1,n);return i?o||t.revisions.length!==r||(o=this.checkToMapRevisionWithNextNode(e.nextNode,t,!1,n)):o||t.revisions.length!==r||(o=this.checkToMapRevisionWithPreviousNode(e.previousNode,t,!1,n)),o},o.prototype.insertRevisionAtBegining=function(e,t,i){return!(t instanceof J||t instanceof up||t instanceof Wc||t instanceof Sc||(e=e.nextValidNodeForTracking,_.isNullOrUndefined(e)))&&this.insertRevisionAtPosition(e,t,!1,i)},o.prototype.splitRevisionForSpittedElement=function(e,t){for(var i=e.revisions.length-1;0<=i;i--){var n=e.revisions[i],r=this.splitRevisionByElement(e,n);this.insertRevision(t,n.revisionType,n.author,n.date,r)}},o.prototype.combineElementRevisionToPrevNxt=function(e){0<e.revisions.length&&e.nextNode instanceof mh&&0<e.nextNode.revisions.length&&this.combineElementRevision(e.revisions,e.nextNode.revisions)},o.prototype.combineElementRevision=function(e,t,i){for(var n=0;n<e.length;n++)for(var r=0;r<t.length;r++){var o=e[n],s=t[r];if(o===s)break;if(o.author===s.author&&o.revisionType===s.revisionType){for(var a=s.range.length,l=0;l<a;l++){var d=s.range[0],h=(d.revisions.splice(d.revisions.indexOf(s),1),s.range.splice(0,1),this.owner.trackChangesPane.updateCurrentTrackChanges(s),-1),c=(i&&(d instanceof X&&0===d.indexInOwner&&0===d.line.indexInOwner&&!_.isNullOrUndefined(d.paragraph.previousWidget)&&d.paragraph.previousWidget instanceof G?h=o.range.indexOf(d.paragraph.previousWidget.characterFormat):d instanceof X&&0!==d.indexInOwner&&!_.isNullOrUndefined(d.previousElement)?h=o.range.indexOf(d.previousElement):d instanceof B&&!d.ownerBase.isEmpty()&&(c=d.ownerBase.lastChild.children[d.ownerBase.lastChild.children.length-1],h=o.range.indexOf(c))),-1!==h?o.range.splice(h+1,0,d):i?o.range.splice(l,0,d):o.range.push(d),void 0);_.isNullOrUndefined(o)||(c=this.owner.trackChangesPane.changes.get(o)),_.isNullOrUndefined(c)&&0<o.range.length&&this.updateRevisionCollection(o),this.owner.trackChangesPane.updateCurrentTrackChanges(o),d.revisions.push(o)}0===s.range.length&&(this.owner.revisions.remove(s),this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&this.removeMarkerInfoRevision(s.revisionID,this.editorHistory.currentBaseHistoryInfo.markerData)}}},o.prototype.removeMarkerInfoRevision=function(e,t){for(var i=0;i<t.length;i++)_.isNullOrUndefined(t[i].revisionId)||t[i].revisionId!==e||t.splice(t.indexOf(t[i]),1)},o.prototype.combineRevisions=function(e,t,i){var n,r;this.owner.enableTrackChanges&&0<(e=this.selection.getLineInfo(e,t.offset).line.getInline(t.offset,0).element).revisions.length&&this.isRevisionMatched(e,"Insertion")&&(t=e.nextElement,!_.isNullOrUndefined(t))&&0<t.revisions.length&&(n=e.revisions[e.revisions.length-1],r=t.revisions[t.revisions.length-1].range,n!==t.revisions[t.revisions.length-1])&&this.clearAndUpdateRevisons(r,n,n.range.indexOf(e)+1)},o.prototype.insertRevisionForBlock=function(e,t,i,n,r,o,s){var a=!1;if(0!==e.childWidgets.length&&this.owner.enableTrackChanges)if("Deletion"!==t||this.editorHistory.isUndoing){var l=!1;_.isNullOrUndefined(n)&&(g=this.owner.currentUser||"Guest user",(n=new $a(this.owner,g,j.getUtcDate())).revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),n.revisionType=t);for(F=0;F<e.childWidgets.length;F++){var d,h,c=e.childWidgets[F].children;0===c.length&&(d=void 0,0<(h=e.containerWidget.childWidgets.indexOf(e))&&(d=e.containerWidget.childWidgets[h-1]),!_.isNullOrUndefined(d))&&d instanceof G&&0<d.characterFormat.revisions.length&&this.isRevisionMatched(d.characterFormat,t)&&0<(h=this.getMatchedRevisionsToCombine(d.characterFormat.revisions,t)).length&&(this.mapMatchedRevisions(h,d.characterFormat,e.characterFormat,!1),l=!0,n=void 0);for(var p,u=0;u<c.length;u++)0===u&&!i&&(p=c[F].revisions.length,this.checkToCombineRevisionsinBlocks(c[F],!0,!1,"Insertion"),c[F].revisions.length>p)?n=c[F].revisions[c[F].revisions.length-1]:(c[u].revisions.push(n),n.range.push(c[u]))}i||l||(e.characterFormat.revisions.push(n),n.range.push(e.characterFormat)),_.isNullOrUndefined(n)||(this.owner.trackChangesPane.updateCurrentTrackChanges(n),this.updateRevisionCollection(n))}else{var g=this.selection.editPosition,m=this.selection.start.clone(),f=this.selection.end.clone(),y=(this.documentHelper.layout.clearListElementBox(e),e==this.getLastParaForBodywidgetCollection(e)),v=this.selection.getNextParagraphBlock(e),w=this.selection.getParagraphInfo(this.selection.start),b=this.selection.getParagraphInfo(this.selection.end),x=this.selection.getHierarchicalIndex(w.paragraph,w.offset.toString()),C=this.selection.getHierarchicalIndex(b.paragraph,b.offset.toString()),I=!1,k=!1;(k=(y=e.isInsideTable&&e==this.selection.getLastParagraph(e.associatedCell)?!0:y)||_.isNullOrUndefined(v)&&e.isEmpty()||o?k:!0)&&(_.isNullOrUndefined(v)||v.isInsideTable||e.bodyWidget.sectionIndex===v.bodyWidget.sectionIndex||this.addRemovedNodes(e.bodyWidget),_.isNullOrUndefined(this.owner.editorHistoryModule)||_.isNullOrUndefined(this.owner.editorHistoryModule.currentBaseHistoryInfo)||this.owner.editorHistoryModule.currentBaseHistoryInfo.recordInsertRevisionDeletetion(e),s||(this.addRemovedNodes(e.clone()),I=this.handleDeleteParaMark(e,void 0)));for(var F=e.childWidgets.length-1;-1<F;F--){var P=e.childWidgets[F];this.removeContent(P,0,this.documentHelper.selection.getLineLength(P),void 0,!!s||!o&&!y)}k&&(I=s?this.handleDeleteParaMark(e,void 0):I)&&e.isEmpty()&&(a=!0,this.removeBlock(e)),_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(e.isEmpty()&&this.selection.end.paragraph===e&&y?this.editorHistory.currentBaseHistoryInfo.endRevisionLogicalIndex=this.selection.endOffset:I&&(this.editorHistory.currentBaseHistoryInfo.endRevisionLogicalIndex=void 0));for(var T=e.lastChild;0==T.children.length&&!_.isNullOrUndefined(T.previousLine);)T=T.previousLine;0<T.children.length&&(v=T.children[T.children.length-1],this.combineElementRevision(e.characterFormat.revisions,v.revisions,!s)),this.selection.editPosition=g,this.selection.start.setPositionInternal(m),this.selection.end.setPositionInternal(f),this.removeEmptyLine(e),r||_.isNullOrUndefined(e.containerWidget)||(this.documentHelper.layout.reLayoutParagraph(e,0,0),-1===this.selection.start.currentWidget.indexInOwner&&-1!==w.paragraph.indexInOwner&&(k=this.selection.getTextPosBasedOnLogicalIndex(x),this.selection.start.setPositionInternal(k)),-1===this.selection.end.currentWidget.indexInOwner&&-1!==b.paragraph.indexInOwner&&(I=this.selection.getTextPosBasedOnLogicalIndex(C),this.selection.end.setPositionInternal(I)))}return a},o.prototype.getLastParaForBodywidgetCollection=function(e){var t=e.containerWidget;return t.containerWidget instanceof q?t.childWidgets[t.childWidgets.length-1]:e.isInsideTable&&e.associatedCell?e.associatedCell.lastChild:(e=(t=this.documentHelper.pages[this.documentHelper.pages.length-1]).bodyWidgets[t.bodyWidgets.length-1]).childWidgets[e.childWidgets.length-1]},o.prototype.updatePasteRevision=function(){for(var e=0;e<this.remotePasteRevision.length;e++)this.updateRevisionCollection(this.remotePasteRevision[e]);this.remotePasteRevision=[]},o.prototype.updateRevisionCollection=function(e){var t=!1,i=void 0;if(this.owner.revisions.changes.indexOf(e)<0){if(this.documentHelper.revisionsInternal.containsKey(e.revisionID)||this.documentHelper.revisionsInternal.add(e.revisionID,e),0<this.owner.revisions.changes.length)for(var n=this.owner.selectionModule.start,r=0;r<this.owner.revisions.changes.length;r++){var o=this.owner.revisions.changes[r].range[0];if(o instanceof mh&&!_.isNullOrUndefined(o.line)&&o.line.paragraph.bodyWidget){var s=this.owner.revisions.changes[r].range[0];o instanceof Op&&0<o.paragraph.containerWidget.footNoteReference.revisions.length&&(s=o.paragraph.containerWidget.footNoteReference),i=this.selection.getElementPosition(s).startPosition}else if(o instanceof Ya){var a=o.ownerBase,l=a.childWidgets[0];if(0===l.childWidgets.length)for(var d=1;d<a.childWidgets.length;d++)if(0<a.childWidgets[d].childWidgets.length){l=a.childWidgets[d];break}var h,s=void 0;this.selection.getFirstParagraph(l).bodyWidget&&(h=this.documentHelper.selection,_.isNullOrUndefined(h.editPosition)||(s=h.editPosition),this.updateEditPosition(l,h),i=this.selection.getTextPosBasedOnLogicalIndex(h.editPosition),_.isNullOrUndefined(s)||this.selection.start.paragraph.isInsideTable||(h.editPosition=s))}else o instanceof B&&(h=o.ownerBase).lastChild&&h.lastChild.paragraph.bodyWidget&&(c=h.getLength(),(p=new y(this.owner)).setPositionParagraph(h.lastChild,c),i=p);if(this.footnoteRevision===this.owner.revisions.changes[r]){var c=this.owner.revisions.changes.indexOf(this.footnoteRevision),t=!0;this.owner.revisions.changes.splice(c+1,0,e);var p=(g=new cd(this.owner,this.owner.trackChangesPane)).createSingleChangesDiv(e),u=this.owner.trackChangesPane.changes.get(this.footnoteRevision).outerSingleDiv.nextSibling;u?this.owner.trackChangesPane.changesInfoDiv.insertBefore(p,u):this.owner.trackChangesPane.changesInfoDiv.appendChild(p),this.owner.trackChangesPane.revisions.splice(c+1,0,e),this.owner.trackChangesPane.changes.add(e,g),this.owner.trackChangesPane.renderedChanges.add(e,g);break}if(!_.isNullOrUndefined(i)&&!_.isNullOrUndefined(n)){u=this.selection.start.paragraph.isInsideTable&&this.selection.end.paragraph.isInsideTable&&this.selection.start.paragraph.associatedCell!==this.selection.end.paragraph.associatedCell;if(!(!n.isExistBefore(i)||e.range[0]instanceof Ya||u)){t=!0,this.owner.revisions.changes.splice(r,0,e);var g=new cd(this.owner,this.owner.trackChangesPane);this.owner.trackChangesPane.changesInfoDiv.insertBefore(g.createSingleChangesDiv(e),this.owner.trackChangesPane.changesInfoDiv.children[r+1]),this.owner.trackChangesPane.revisions.splice(r,0,e),this.owner.trackChangesPane.changes.add(e,g),this.owner.trackChangesPane.renderedChanges.add(e,g);break}if(e.range[0]instanceof Ya&&o instanceof Ya&&e.range[0].ownerBase.containerWidget===o.ownerBase.containerWidget&&e.range[0].ownerBase.index===o.ownerBase.index){t=!0,this.owner.revisions.changes.splice(r-e.range[0].ownerBase.indexInOwner,0,e);break}if(!_.isNullOrUndefined(i)&&!_.isNullOrUndefined(n)&&(n.isExistBefore(i)||n.isAtSamePosition(i)||n.paragraph.isInsideTable&&i.paragraph.isInsideTable&&n.paragraph.associatedCell===i.paragraph.associatedCell)){if(o instanceof Ya&&e.range[0]instanceof Ya&&o.ownerBase.containerWidget===e.range[0].ownerBase.containerWidget){if(o.ownerBase.index-1===e.range[0].ownerBase.index){this.owner.revisions.changes.splice(r,0,e),t=!0;break}this.owner.revisions.changes.splice(r+e.range[0].ownerBase.indexInOwner,0,e),t=!0;break}if(e.range[0]instanceof Ya){this.owner.revisions.changes.splice(r,0,e),t=!0;break}}}}t||(this.owner.revisions.changes.push(e),e.range[0]instanceof Ya)||(g=new cd(this.owner,this.owner.trackChangesPane),this.owner.trackChangesPane.changesInfoDiv.appendChild(g.createSingleChangesDiv(e)),this.owner.trackChangesPane.revisions.push(e),this.owner.trackChangesPane.changes.add(e,g),this.owner.trackChangesPane.renderedChanges.add(e,g)),this.documentHelper.updateAuthorIdentity()}},o.prototype.insertSection=function(e,t,i,n,r,o){var s,a,l,d,h=this.selection.start.paragraph;if(!n||i||h.isInsideTable||0!==e.start.offset||e.start.currentWidget!==h.firstChild||_.isNullOrUndefined(h.previousRenderedWidget)||!(h.previousRenderedWidget instanceof G)||!h.previousRenderedWidget.isEndsWithPageBreak)return h=_.isNullOrUndefined(o)?this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat():o,e.start.paragraph.isInsideTable?(o=(o=this.documentHelper.layout.getParentTable(e.start.paragraph)).combineWidget(this.owner.viewer),d=!1,0===e.start.paragraph.associatedCell.rowIndex&&(d=!0),s=new G,l=o.previousRenderedWidget,a=d?o:(a=this.splitTable(o,e.start.paragraph.associatedCell.ownerRow),this.documentHelper.layout.layoutBodyWidgetCollection(a.index,a.containerWidget,a,!1),a.getSplitWidgets().pop()),o=0,!_.isNullOrUndefined(l)&&l.bodyWidget.equals(a.bodyWidget)||!d?(o=a.indexInOwner+1,s.index=a.index+1):s.index=o=0,a.containerWidget.childWidgets.splice(o,0,s),s.containerWidget=a.containerWidget,this.updateNextBlocksIndex(s,!0),this.documentHelper.layout.layoutBodyWidgetCollection(s.index,s.containerWidget,s,!1),a=s):(l=this.selection.getParagraphInfo(e.start),d=this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString()),i||this.splitParagraphInternal(e,e.start.paragraph,e.start.currentWidget,e.start.offset),this.setPositionForCurrentIndex(e.start,d),a=e.start.paragraph.getSplitWidgets().pop(),i&&void 0!==a.previousRenderedWidget&&(a=a.previousRenderedWidget)),(o=this.splitBodyWidget(a.bodyWidget,h,a,n,r).firstChild)instanceof K&&o.updateRowIndex(0),this.documentHelper.layout.layoutBodyWidgetCollection(o.index,o.containerWidget,o,!1),o instanceof K&&(o=this.documentHelper.getFirstParagraphInFirstCell(o)),t&&e.selectParagraphInternal(o,!0),o;this.selection.start.paragraph.bodyWidget.sectionFormat.breakCode="NoBreak",this.selection.start.paragraph.index=0,this.updateNextBlocksIndex(this.selection.start.paragraph,!0),this.updateSectionIndex(this.selection.start.paragraph.bodyWidget.sectionFormat,this.selection.start.paragraph.bodyWidget,!0),this.selection.moveToNextParagraph(),this.editorHistory.currentBaseHistoryInfo.insertPosition=void 0,this.updateInsertPosition()},o.prototype.splitBodyWidget=function(e,t,i,n,r){var o=!0,s=this.documentHelper.layout.moveBlocksToNextPage(i,!0,void 0,n);if((this.editorHistory.isUndoing||this.editorHistory.isRedoing&&!_.isNullOrUndefined(t.ownerBase))&&(i.bodyWidget.sectionFormat=t),void 0===s.page)s.page=e.page,e.page.bodyWidgets.splice(e.page.bodyWidgets.indexOf(e)+1,0,s);else if(1<e.page.bodyWidgets.length&&void 0!==s.page&&!this.editorHistory.isUndoing){for(i=s;!_.isNullOrUndefined(e.nextRenderedWidget)&&s!==e.nextRenderedWidget;){var a=e.nextRenderedWidget.page.bodyWidgets.indexOf(e.nextRenderedWidget);s.page.bodyWidgets.push(e.nextRenderedWidget),e.nextRenderedWidget.page.bodyWidgets.splice(a,1)}for(;!_.isNullOrUndefined(s.nextRenderedWidget);)s.nextRenderedWidget.page=s.page,s=s.nextRenderedWidget;(s=i).sectionFormat=new Ma(s),1<t.numberOfColumns&&(this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,s.sectionFormat),o=!1),s.sectionFormat.breakCode="NewPage"}return n&&(1<t.numberOfColumns&&o?(s.sectionFormat=t,this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,s.sectionFormat)):(s.sectionFormat=new Ma(s),(1<t.numberOfColumns||!_.isNullOrUndefined(e.page)&&!_.isNullOrUndefined(e.page.nextPage)&&this.documentHelper.getPageWidth(e.page)!==this.documentHelper.getPageWidth(e.page.nextPage))&&this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,s.sectionFormat)),s.sectionFormat.breakCode="NoBreak"),r&&(1<t.numberOfColumns&&o?s.sectionFormat=t:s.sectionFormat=new Ma(s),this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,s.sectionFormat),s.sectionFormat.breakCode="NewPage"),this.updateSectionIndex(s.sectionFormat,s,!0),1<s.sectionFormat.numberOfColumns&&this.updateColumnIndex(s,!1),this.editorHistory&&!this.editorHistory.isUndoing&&this.insertRemoveHeaderFooter(s.sectionIndex,!0),this.updateBlockIndex(0,s.firstChild),this.owner.viewer.updateClientArea(s,s.page),s},o.prototype.insertRemoveHeaderFooter=function(e,t){this.documentHelper.headersFooters[e]?this.documentHelper.headersFooters.splice(e,0,{}):this.documentHelper.headersFooters[e]={}},o.prototype.updateBlockIndex=function(e,t){var i=t.bodyWidget.sectionIndex;do{for(var n=t.getSplitWidgets(),r=0;r<n.length;r++)n[r].index=e}while(e++,t=n.pop().nextRenderedWidget,!_.isNullOrUndefined(t)&&t.bodyWidget.sectionIndex===i)},o.prototype.updateSectionIndex=function(e,t,i){for(var n=t.sectionIndex,r=t;r.index===n&&e&&(r.sectionFormat=e),i?r.index++:r.index--,r=r.nextRenderedWidget;);},o.prototype.updateColumnIndex=function(e,t){for(var i=e;(t||0!==i.columnIndex)&&(t?i.columnIndex++:i.columnIndex--,_.isNullOrUndefined(i.nextRenderedWidget)||i.sectionIndex===i.nextRenderedWidget.sectionIndex)&&(i=i.nextRenderedWidget););},o.prototype.checkAndConvertList=function(e,t){var i=e.paragraphFormat.getList();if(!_.isNullOrUndefined(i)||e.start.paragraph.containerWidget instanceof q)return!1;var i=!1,n=!1,r=e.start.currentWidget.getInline(e.start.offset-1,0),o=r.element,r=r.index;if(!(o instanceof X))return!1;for(var s=(h=o).text.substring(0,r),a=0,l=0;!_.isNullOrUndefined(h.previousNode);){if(!(h.previousNode instanceof X)||"\t"!==h.previousNode.text&&0!==h.previousNode.text.trim().length)return!1;"\t"===h.previousNode.text?a+=36:l=2.5*h.previousNode.text.length,h=h.previousNode}h=o;var d=0;for(d=0<=(c=s.lastIndexOf("\t"))?c+1:s.lastIndexOf(" ")+1;h.previousNode instanceof X&&0===d;){var h,c,p=(h=h.previousNode).text,d=0<=(c=p.lastIndexOf("\t"))?c+1:p.lastIndexOf(" ")+1;s=(s=h.text+s).substring(d)}var u,g=(s=j.trimStart(s)).substring(1,2),m=void 0,f=this.getListLevelPattern(s.substring(0,1));return"None"!==f&&this.checkNumberFormat(g,"Bullet"===f,s)?(m=this.checkNextLevelAutoList(s),i=!0):this.checkLeadingZero(s)?i=n=!0:(m=this.checkNextLevelAutoList(s),_.isNullOrUndefined(m)||(i=!0)),(i=!i||"Bullet"!==f||"- "!==o.text||_.isNullOrUndefined(o.paragraph.previousWidget)||o.paragraph.previousWidget.firstChild.children[0]instanceof Y?i:!1)&&(this.initComplexHistory("AutoList"),u=o.paragraph,e.start.setPositionParagraph(u.childWidgets[0],u.childWidgets[0].getOffset(o,r+1)),e.end.setPositionParagraph(u.childWidgets[0],0),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!1),o=t?"Tab":"Space",g=n?"%1"+s.substring(s.length-1,s.length):"%1"+g,u=s.substring(s.length-3,s.length-1),f=n?this.getListLevelPattern(u):f,"Bullet"===((t=new El(void 0)).listLevelPattern=f)?"*"===s?(t.numberFormat=String.fromCharCode(61623),t.characterFormat.fontFamily="Symbol"):"-"===s&&(t.numberFormat="-"):t.numberFormat=g,t.followCharacter=o,f=e.paragraphFormat.leftIndent,t.paragraphFormat.leftIndent=0!==a||0!==l?f+18+a+l:2<r?f+2.5*(r-2)+18:0<f?f+18:36,t.paragraphFormat.firstLineIndent=-18,!n&&"0"===s.substring(0,1)||"00"===u?t.startAt=0:t.startAt=1,_.isNullOrUndefined(m)?this.autoConvertList(e,t):e.paragraphFormat.setList(m),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)?this.editorHistory.updateComplexHistory():this.reLayout(e)),i},o.prototype.checkNextLevelAutoList=function(e){for(var t=this.documentHelper.selection,i=void 0,n=!1,r=t.start.paragraph,o=t.getPreviousParagraphBlock(r);!_.isNullOrUndefined(o)&&o instanceof G;){if(o.paragraphFormat.listFormat&&-1!==o.paragraphFormat.listFormat.listId){var s=o.paragraphFormat.listFormat.listLevelNumber;if(n=this.isConvertList(e,o)){this.listLevelNumber=s,this.isAutoList=!0;break}if("*"===e||"-"===e){n=this.isAutoList=!0;break}}o=t.getPreviousParagraphBlock(o,!0)}return i=n?this.documentHelper.getListById(o.paragraphFormat.listFormat.listId):i},o.prototype.isConvertList=function(e,t){var i=!1,t=this.documentHelper.layout.getListNumber(t.paragraphFormat.listFormat,!0),n=t.substring(0,t.length-1),r=e.substring(0,e.length-1);return t.substring(t.length-1)!==e.substring(e.length-1)?i=!1:r.match(/^[0-9]+$/)&&n.match(/^[0-9]+$/)?(t=parseInt(r,10),parseInt(n,10)!==t&&parseInt(n,10)+1!==t&&parseInt(n,10)+2!==t||(i=!0)):r.match(/^[a-zA-Z]+$/)&&n.match(/^[a-zA-Z]+$/)&&(n.charCodeAt(0)===e.charCodeAt(0)||n.charCodeAt(0)+1===e.charCodeAt(0)||n.charCodeAt(0)+2===e.charCodeAt(0)?i=!0:r.match(/^[MDCLXVImdclxvi]+$/)&&n.match(/^[MDCLXVImdclxvi]+$/)&&((t=this.getNumber(n.toUpperCase()))!==(e=this.getNumber(r.toUpperCase()))&&t+1!==e&&t+2!==e||(i=!0))),i},o.prototype.getNumber=function(e){for(var t={M:1e3,D:500,C:100,L:50,X:10,V:5,I:1},i=e.split(""),n=0,r=0;r<i.length;r++){var o=t[i[r]];o<t[i[r+1]]?n-=o:n+=o}return n},o.prototype.getListLevelPattern=function(e){switch(e){case"0":case"1":return"Arabic";case"I":return"UpRoman";case"i":return"LowRoman";case"A":return"UpLetter";case"a":return"LowLetter";case"*":case"-":return"Bullet";case"00":case"01":return"LeadingZero";default:return"None"}},o.prototype.autoConvertList=function(e,t){e.start;e.isForward||e.end;var i=new Vu,n=(0<this.documentHelper.lists.length?i.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:i.listId=0,new Hl),r=this.documentHelper;0<r.abstractLists.length?n.abstractListId=r.abstractLists[r.abstractLists.length-1].abstractListId+1:n.abstractListId=0,i.abstractListId=n.abstractListId,i.abstractList=n,i.nsid=n.nsid=j.generateUniqueId(r.lists),r.abstractLists.push(n),n.levels.push(t),t.ownerBase=n,e.paragraphFormat.setList(i),e.paragraphFormat.listLevelNumber=0},o.prototype.checkNumberFormat=function(e,t,i){return t?""===e:(t=i.indexOf(e),("."===e||")"===e||">"===e||"-"===e)&&""===i.substring(t,i.length-1))},o.prototype.checkLeadingZero=function(e){for(var t,i=!1,n=0;n<=e.length-1;n++){if("0"!==e.charAt(n)){t=n;break}i=!0}var r=void 0,r="1"===e.charAt(t)?e.charAt(t+1):e.charAt(t);return i&&this.checkNumberFormat(r,!1,e)},o.prototype.getPageFromBlockWidget=function(e){var t=void 0;return e.containerWidget instanceof z||e.containerWidget instanceof Xd?t=e.containerWidget.page:e.containerWidget instanceof N&&(t=e.containerWidget.bodyWidget.page),t},o.prototype.insertTextInline=function(e,t,i,n,r){var o,s,a;e instanceof X?(e.text=j.insert(e.text,n,i),e.isWidthUpdated=!1,this.owner.enableTrackChanges&&(o=e.revisions[0],_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(void 0,void 0,o)),this.owner.trackChangesPane.updateCurrentTrackChanges(o)),s=(o=e.line.paragraph).childWidgets.indexOf(e.line),a=e.line.children.indexOf(e),e instanceof X&&90<e.text.length&&j.splitWordByMaxLength(e,e.line),!_.isNullOrUndefined(r)&&r||this.documentHelper.layout.reLayoutParagraph(o,s,a,e.line.paragraph.bidi)):e instanceof Ic?this.insertImageText(e,t,i,n):e instanceof Z?0===e.fieldType?this.insertFieldBeginText(e,t,i,n):2===e.fieldType?this.insertFieldSeparatorText(e,t,i,n):this.insertFieldEndText(e,t,i,n):(e instanceof J||e instanceof Wc||e instanceof Sc)&&this.insertBookMarkText(e,i)},o.prototype.insertFieldBeginText=function(e,t,i,n){var r=new X,i=(r.text=i,e.line.paragraph.childWidgets.indexOf(e.line)),o=e.line.children.indexOf(e);this.owner.enableCollaborativeEditing&&this.isRemoteAction&&o++,r.characterFormat.copyFormat(e.characterFormat),e.line.children.splice(o,0,r),r.line=e.line,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,i,o)},o.prototype.insertBookMarkText=function(e,t){var i=new X,t=(i.text=t,e.line.paragraph.childWidgets.indexOf(e.line)),n=e.line.children.indexOf(e);i.characterFormat.copyFormat(e.characterFormat),e instanceof Sc||e instanceof J?e.line.children.splice(n,0,i):e.line.children.splice(n+1,0,i),i.line=e.line,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,t,n)},o.prototype.insertFieldSeparatorText=function(e,t,i,n){var r=t.getPreviousTextInline(e),t=t.getNextTextInline(e),o=new X,i=(o.text=i,e.line.children.indexOf(e)),t=(n===e.length&&i++,_.isNullOrUndefined(r)&&_.isNullOrUndefined(t)?o.characterFormat.copyFormat(e.line.paragraph.characterFormat):_.isNullOrUndefined(r)?o.characterFormat.copyFormat(t.characterFormat):this.owner.enableCollaborativeEditing&&this.isRemoteAction?(n=this.getCharacterFormat(this.selection),o.characterFormat.copyFormat(n)):o.characterFormat.copyFormat(r.characterFormat),e.line.children.splice(i,0,o),o.line=e.line,e.line.paragraph.childWidgets.indexOf(e.line));this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,t,i)},o.prototype.insertFieldEndText=function(e,t,i,n){var r=new X,o=(r.text=i,e.line.children.indexOf(e)),t=(r.characterFormat.copyFormat(e.characterFormat),t.isInlineFormFillMode()&&0==n?e.line.children.splice(o,0,r):e.line.children.splice(o+1,0,r),r.line=e.line,e.line.paragraph.childWidgets.indexOf(e.line));this.owner.enableTrackChanges&&(i=this.documentHelper.textHelper.getRtlLanguage(i).isRtl,this.checkToMapRevisionWithInlineText(e,n,r,i,"Insertion")||0!==r.revisions.length||this.checkToMapRevisionWithNextNode(e.nextNode,r,i,"Insertion")),this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,t,o)},o.prototype.insertImageText=function(e,t,i,n){var r=t.getPreviousTextInline(e),t=t.getNextTextInline(e),o=e.line,s=new X,a=o.paragraph,l=a.childWidgets.indexOf(o),i=(s.text=i,o.children.indexOf(e));n===e.length&&i++,_.isNullOrUndefined(r)&&_.isNullOrUndefined(t)?s.characterFormat.copyFormat(a.characterFormat):_.isNullOrUndefined(r)?s.characterFormat.copyFormat(t.characterFormat):s.characterFormat.copyFormat(r.characterFormat),o.children.splice(i,0,s),s.line=o,this.documentHelper.layout.reLayoutParagraph(a,l,i)},o.prototype.isListTextSelected=function(){this.documentHelper.isListTextSelected&&(this.initComplexHistory("ListSelect"),this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat)&&-1!==this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat.listId&&this.onApplyList(void 0)},o.prototype.checkAndConvertToHyperlink=function(e,t,i){if(t)l=(s=i.lastChild.children[i.lastChild.children.length-1]).text;else{var i=e.start.currentWidget.getInline(e.start.offset-1,0),n=i.element,i=i.index;if(!(n instanceof X))return;l=(s=n).text.substring(0,i)}var r=0,o=l.lastIndexOf("\t");for(r=0<=o?o+1:l.lastIndexOf(" ")+1;s.previousElement instanceof X&&0===r;)var s,a=(s=s.previousNode).text,r=0<=(o=a.lastIndexOf("\t"))?o+1:a.lastIndexOf(" ")+1,l=s.text+l;var d,n=(l=l.substring(r)).toLowerCase(),i=!1;"file:///"===n.substring(0,8)||"http://"===n.substring(0,7)&&7<n.length||"https://"===n.substring(0,8)&&8<n.length||"www."===n.substring(0,4)&&4<n.length||"\\"===n.substring(0,3)&&3<n.length||"mailto:"===n.substring(0,7)&&7<n.length?(i=!0,"www."===n.substring(0,4)&&4<n.length&&(l="http://"+l)):(n=l.indexOf("@"),d=l.indexOf("."),0<n&&n<d&&d<l.length-1&&(i=!0,l="mailto:"+l)),i&&((n=new y(this.documentHelper.owner)).setPositionParagraph(s.line,s.line.getOffset(s,r)),d=new y(this.documentHelper.owner),t?d.setPositionParagraph(s.line,s.line.getEndOffset()):0===e.end.currentWidget.children.length&&0===e.end.offset?(i=e.end.currentWidget.previousLine,d.setPositionParagraph(i,i.getEndOffset())):d.setPositionParagraph(e.end.currentWidget,e.end.offset-1),this.autoFormatHyperlink(e,l,n,d))},o.prototype.autoFormatHyperlink=function(e,t,i,n){var r,o,s,a;this.owner.enableCollaborativeEditing&&this.isRemoteAction||(this.initComplexHistory("AutoFormatHyperlink"),r=this.selection.getParagraphInfo(i),o=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=o),e.start.setPositionInternal(i),e.end.setPositionInternal(n),a=this.getCharacterFormat(e),(s=new B).copyFormat(a),a=this.createHyperlinkElement(t,i,n,s),e.start.setPositionParagraph(a.line,a.line.getOffset(a,1)),e.start.moveNextPosition(),e.end.setPositionInternal(e.start),r=this.selection.getParagraphInfo(e.end),t=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=t,this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.editorHistory.updateComplexHistory(),this.isSkipOperationsBuild=!1,this.reLayout(e)):this.updateComplexWithoutHistory(0,o,t))},o.prototype.appylingHyperlinkFormat=function(e){this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","Single",!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),this.initHistory("FontColor"),this.isForHyperlinkFormat=!0,this.updateCharacterFormatWithUpdate(e,"fontColor","#0563c1",!1),this.isForHyperlinkFormat=!1,this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1)},o.prototype.createHyperlinkElement=function(e,t,i,n){var r=this.selection,o=(this.documentHelper.layout.allowLayout=!1,this.documentHelper.layout.isReplaceAll=!0,this.appylingHyperlinkFormat(r),new Z(1)),t=(o.characterFormat.copyFormat(n),o.line=r.end.currentWidget,r.start.setPositionInternal(r.end),this.initInsertInline(o),r.start.setPositionInternal(t),r.end.setPositionInternal(r.start),this.insertHyperlinkfield(r,n,e)),n=r.start.paragraph.childWidgets.indexOf(t.line),e=t.line.children.indexOf(t);return o.linkFieldCharacter(this.documentHelper),this.documentHelper.layout.isReplaceAll=!1,this.documentHelper.layout.allowLayout=!0,this.documentHelper.layout.reLayoutParagraph(r.start.paragraph,n,e),o},o.prototype.insertHyperlinkfield=function(e,t,i,n){var r=new Z(0),o=(r.characterFormat.copyFormat(t),r.line=e.start.currentWidget,this.initInsertInline(r),new X),n=(o.characterFormat.copyFormat(t),o.text=n?' HYPERLINK \\l "'+i+'" ':' HYPERLINK "'+i+'" ',o.line=e.start.currentWidget,this.initInsertInline(o),new Z(2));return n.characterFormat.copyFormat(t),n.line=e.start.currentWidget,this.initInsertInline(n),r},o.prototype.unlinkRangeFromRevision=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=n.range.indexOf(e);0<=r&&(n.range.splice(r,1),this.owner.trackChangesPane.updateCurrentTrackChanges(n)),0===n.range.length&&t&&(this.owner.revisions.remove(n),this.isRemoveRevision)&&this.documentHelper.revisionsInternal.containsKey(n.revisionID)&&(this.documentHelper.revisionsInternal.remove(n.revisionID),this.owner.trackChangesPane.updateTrackChanges())}this.constructRevisionnsForLink(e,!0)},o.prototype.constructRevisionnsForLink=function(e,t){if(e instanceof Z&&2===e.fieldType&&!_.isNullOrUndefined(this.editorHistory)&&!_.isNullOrUndefined(this.editorHistory.historyInfoStack)&&0<this.editorHistory.historyInfoStack.length&&"InsertHyperlink"===this.editorHistory.historyInfoStack[0].action){var i=e.nextElement,n=!1;for(_.isNullOrUndefined(e.fieldEnd)||-1===e.fieldEnd.indexInOwner||(n=!0);!(_.isNullOrUndefined(i)||i instanceof Z&&1===i.fieldType);)t?(this.unlinkRangeFromRevision(i),this.addRemovedRevisionInfo(i,void 0)):n&&0<i.removedIds.length&&this.constructRevisionFromID(i,!0,i.previousElement),i=_.isNullOrUndefined(i.nextElement)?!_.isNullOrUndefined(i.paragraph)&&!_.isNullOrUndefined(i.paragraph.nextRenderedWidget)&&i.paragraph.nextRenderedWidget instanceof G&&!i.paragraph.nextRenderedWidget.isEmpty()?(t?(this.unlinkRangeFromRevision(i.paragraph.characterFormat),this.addRemovedRevisionInfo(i.paragraph.characterFormat,void 0)):n&&0<i.paragraph.characterFormat.removedIds.length&&this.constructRevisionFromID(i.paragraph.characterFormat,!0),i.paragraph.nextRenderedWidget.firstChild.children[0]):void 0:i.nextElement}},o.prototype.unlinkWholeRangeInRevision=function(e,t){for(var i=t,n=(e.revisions.splice(e.revisions.indexOf(e),1),i.range.length),r=0;r<n;r++)i.range.splice(0,1),this.owner.trackChangesPane.updateCurrentTrackChanges(i);0===i.range.length&&(this.owner.revisions.remove(i),this.isRemoveRevision)&&this.documentHelper.revisionsInternal.containsKey(i.revisionID)&&(this.documentHelper.revisionsInternal.remove(i.revisionID),this.owner.trackChangesPane.updateTrackChanges())},o.prototype.unLinkFieldCharacter=function(e){var t;e instanceof Z&&0===e.fieldType&&e.fieldEnd&&(this.documentHelper&&(this.documentHelper.fieldToLayout=e,this.documentHelper.fieldEndParagraph=e.line.paragraph),e.fieldEnd&&(e.fieldEnd.fieldBegin=void 0),e.fieldEnd=void 0),e instanceof Z&&2===e.fieldType?_.isNullOrUndefined(e.fieldEnd)||(this.documentHelper&&(this.documentHelper.fieldToLayout=e.fieldBegin,this.documentHelper.fieldEndParagraph=e.line.paragraph),e.fieldBegin.fieldSeparator=void 0,e.fieldEnd.fieldSeparator=void 0):e instanceof Z&&1===e.fieldType&&e.fieldBegin&&(_.isNullOrUndefined(this.documentHelper)||(this.documentHelper.fieldToLayout=e.fieldBegin,this.documentHelper.fieldEndParagraph=e.line.paragraph),-1!==(t=this.documentHelper.fields.indexOf(e.fieldBegin))&&this.documentHelper.fields.splice(t,1),-1!==(t=this.documentHelper.formFields.indexOf(e.fieldBegin))&&this.documentHelper.formFields.splice(t,1),e.fieldBegin.fieldEnd=void 0,e.fieldBegin=void 0)},o.prototype.getCharacterFormat=function(e){return(e.start.paragraph.isEmpty()?e.start.paragraph:e.start.currentWidget.getInline(e.start.offset+1,0).element).characterFormat},o.prototype.insertHyperlink=function(e,t,i){(j.startsWith(e,"http://")||j.startsWith(e,"https://"))&&(e=e.replace(/\s/g,"")),_.isNullOrUndefined(t)&&(t=e),_.isNullOrUndefined(i)||(e=e+'" \\o "'+i),this.insertHyperlinkInternal(e,t,this.owner.selectionModule.text!==t,!1)},o.prototype.insertHyperlinkInternal=function(e,t,i,n){var r,o,s,a,l,d=this.documentHelper.selection;d.start.paragraph.associatedCell!==d.end.paragraph.associatedCell||this.selection.isPlainContentControl()||(a=d.start,r=d.end,d.isForward||(a=d.end,r=d.start),r.offset==r.paragraph.getLength()+1&&r.movePreviousPosition(),i?this.insertHyperlinkInternalInternal(d,e,t,n):(this.documentHelper.layout.allowLayout=!1,(i=new y(this.documentHelper.owner)).setPositionInternal(a),t=this.getCharacterFormat(d),(l=new B(void 0)).copyFormat(t),this.initComplexHistory("InsertHyperlink"),t=this.selection.getParagraphInfo(a),o=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString()),this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString())),this.appylingHyperlinkFormat(d),a.setPositionInternal(r),(s=new Z(1)).characterFormat.copyFormat(l),s.line=d.end.currentWidget,a.setPositionInternal(r),this.initInsertInline(s),a.setPositionInternal(i),r.setPositionInternal(a),i=this.insertHyperlinkfield(d,l,e,n),s.linkFieldCharacter(this.documentHelper),a=d.start.paragraph.childWidgets.indexOf(i.line),l=i.line.children.indexOf(i),this.documentHelper.layout.allowLayout=!0,this.documentHelper.layout.reLayoutParagraph(d.start.paragraph,a,l),e=s.line,d.selects(e,e.getOffset(s,s.length),!0),t=this.selection.getParagraphInfo(r),n=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString()),this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString()),this.editorHistory.updateComplexHistory()):this.updateComplexWithoutHistory(1,o,n)))},o.prototype.insertHyperlinkInternalInternal=function(e,t,i,n){var r,o,s,a;_.isNullOrUndefined(e.start)||this.editHyperlink(e,t,i)||(r=this.checkAndRemoveComments(),o=this.getCharacterFormat(e),this.initHistory("InsertHyperlink"),s=!0,e.isEmpty||(a=this.owner.enableTrackChanges,this.owner.enableTrackChanges=!1,s=this.removeSelectedContents(e),this.owner.enableTrackChanges=a),s&&((a=new B).copyFormat(o),this.insertHyperlinkByFormat(e,t,i,a,n)),this.updateHistoryForComments(r))},o.prototype.insertHyperlinkByFormat=function(e,t,i,n,r){this.updateInsertPosition(),e.owner.isShiftingEnabled=!0;var o=[],s=new Z(0),a=(!_.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.fieldBegin=s),o.push(s),new X),r=(a.text=r?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ',o.push(a),new Z(2)),t=(o.push(r),_.isNullOrUndefined(i)||""===i||((a=new X).characterFormat.copyFormat(n),a.characterFormat.underline="Single",a.characterFormat.fontColor="#0563c1",a.text=i,o.push(a)),new Z(1));o.push(t),s.fieldSeparator=t.fieldSeparator=r,s.fieldEnd=r.fieldEnd=t,r.fieldBegin=t.fieldBegin=s,this.insertElement(o),t.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(s)&&this.documentHelper.fields.push(s),e.selects(t.line,t.line.getOffset(t,t.length),!0),this.updateEndPosition(),this.reLayout(e,!0)},o.prototype.initInsertInline=function(e,t,i){var n=this.selection;this.initHistory("InsertInline"),this.insertInlineInSelection(n,e),this.editorHistory&&this.editorHistory.updateHistory()},o.prototype.insertElementInCurrentLine=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),this.updateInsertPosition(),this.insertElement([t]),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},o.prototype.editHyperlink=function(e,t,i,n){var r=e.getHyperlinkField();if(_.isNullOrUndefined(r))return!1;this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=_.isNullOrUndefined(this.editorHistory)||this.editorHistory&&_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo);var o="",s=!1,a=this.getCharacterFormat(e),l=new B,a=(l.copyFormat(a),void 0),d=(_.isNullOrUndefined(r.fieldSeparator)||(a=r.fieldSeparator,o=(d=e.getHyperlinkDisplayText(r.fieldSeparator.line.paragraph,r.fieldSeparator,r.fieldEnd,s,l)).displayText,s=d.isNestedField,l=d.format),r.line.getOffset(r,0));return e.start.setPositionParagraph(r.line,d),d=r.fieldEnd.line.getOffset(r.fieldEnd,1),e.end.setPositionParagraph(r.fieldEnd.line,d),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(e,!0),!s&&o!==i||_.isNullOrUndefined(a)?(this.insertHyperlinkByFormat(e,t,i,l,n),this.skipFieldDeleteTracking=!1):(this.updateInsertPosition(),s=new Z(0),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.fieldBegin=s,this.editorHistory.currentBaseHistoryInfo.isEditHyperlink=!0),s.characterFormat.copyFormat(r.characterFormat),s.line=e.start.currentWidget,this.insertInlineInternal(s),(o=new X).characterFormat.copyFormat(r.characterFormat),o.text=n?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ',o.line=e.start.currentWidget,this.insertInlineInternal(o),i=this.editorHistory&&this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo.removedNodes:this.nodes,this.insertClonedFieldResult(e,i,a),e.end.currentWidget.getInline(e.end.offset,0).element.linkFieldCharacter(this.documentHelper),this.skipFieldDeleteTracking=!1,l=s.line.paragraph,r=s.line.paragraph.childWidgets.indexOf(s.line),n=s.line.children.indexOf(s),this.documentHelper.layout.reLayoutParagraph(l,r,n),d=s.fieldEnd.line.getOffset(s.fieldEnd,1),e.selects(s.fieldEnd.line,d,!0),this.updateEndPosition(),this.reLayout(e,!0)),this.editHyperlinkInternal=!1,this.nodes=[],!0},o.prototype.insertClonedFieldResult=function(e,t,i){for(var n=!1,r=t.length-1;-1<r;r--){var o,s,a=t[r];if(!n){if(i!==a){a instanceof G&&a===i.line.paragraph&&(n=!0,o=void 0,r===t.length-1?(o=e.start.paragraph,s=i.line.paragraph,this.getClonedFieldResultWithSel(s,e,i)):(o=this.getClonedFieldResult(i.line.paragraph,i),this.insertParagraph(o,!0)),e.selectParagraphInternal(e.getNextParagraphBlock(o),!0));continue}n=!0}a instanceof mh?this.insertInlineInternal(a.clone()):a instanceof Qd&&this.insertBlock(a.clone())}},o.prototype.getClonedFieldResultWithSel=function(e,t,i){for(var n=e.childWidgets.indexOf(i.line),r=e.childWidgets[n].children.indexOf(i),o=n;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=r=o!==n?0:r;a<s.children.length;a++)this.insertInlineInternal(s.children[a].clone())},o.prototype.getClonedFieldResult=function(e,t){for(var i=new G,n=(i.characterFormat.copyFormat(e.characterFormat),i.paragraphFormat.copyFormat(e.paragraphFormat),e.childWidgets.indexOf(t.line)),r=e.childWidgets[n].children.indexOf(t),o=n;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=r=o!==n?0:r;a<s.children.length;a++)i.childWidgets[0].children.push(s.children[a]);return i},o.prototype.removeContentControl=function(){var e,t,i,n,r=this.documentHelper.owner.editor.getContentControl();r instanceof E&&(e=r.reference,t=this.selection.start.clone(),i=this.selection.end.clone(),n=this.selection.getElementInfo(i.currentWidget,i.offset),this.selection.start.setPositionParagraph(r.line,r.line.getOffset(r,r.length)),this.selection.end.setPositionParagraph(e.line,e.line.getOffset(e,e.length)-1),this.initHistory("RemoveContentControl"),this.selection.selectPosition(t,i),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.markerData.push({contentControl:r}),this.editorHistory.currentBaseHistoryInfo.setContentControlInfo(r)),this.removeContentControlInternal(),this.editorHistory&&this.editorHistory.updateHistory(),n.element!==r)&&n.element!==e&&this.selection.end.setPositionParagraph(n.element.line,n.element.line.getOffset(n.element,n.index)),this.fireContentChange(),this.viewer.updateScrollBars()},o.prototype.removeContentControlInternal=function(){for(var e,t=this.documentHelper.owner.editor.getContentControl(),i=this.owner.selectionModule.start.currentWidget.children[0],n=i instanceof E?("Picture"==i.contentControlProperties.type&&this.owner.renderPictureContentControlElement(this.owner,!1,!1),i):t,r=0;r<this.documentHelper.contentControlCollection.length;r++)this.documentHelper.contentControlCollection[r]===n&&(e=this.documentHelper.contentControlCollection.indexOf(n),this.updatePropertiesToBlock(n),this.documentHelper.contentControlCollection.splice(e,1),n.line.children.splice(n.indexInOwner,1),_.isNullOrUndefined(n.reference)||(n.reference.line.children.splice(n.reference.indexInOwner,1),this.updatePropertiesToBlock(n)));i=document.getElementById("contenticon"),t=document.getElementById("container_editorPICTURE_CONTENT_CONTROL");i&&(i.style.display="none"),t&&(t.style.display="none"),this.viewer.updateScrollBars()},o.prototype.removeHyperlink=function(){var e,t,i,n,r,o;this.owner.isReadOnlyMode||(o=(e=this.selection).getHyperlinkField(),_.isNullOrUndefined(o))||(t=o.fieldEnd,i=o.fieldSeparator,(n=new y(e.owner)).setPositionParagraph(o.line,o.line.getOffset(o,0)),o=this.selection.getParagraphInfo(n),n=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),(r=new y(e.owner)).setPositionParagraph(i.line,i.line.getOffset(i,i.length)),o=this.selection.getParagraphInfo(r),r=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),this.initComplexHistory("RemoveHyperlink"),e.start.setPositionParagraph(t.line,t.line.getOffset(t,0)),o=this.selection.getParagraphInfo(e.start),o=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),e.end.setPositionParagraph(t.line,t.line.getOffset(t,1)),this.delete(),e.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(r)),this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","None",!1),this.editorHistory&&this.editorHistory.updateHistory(),e.end.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(o)),this.initHistory("FontColor"),this.updateCharacterFormatWithUpdate(e,"fontColor",void 0,!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),e.end.setPositionInternal(e.start),e.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(n)),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!0),this.combineElementRevision(i.revisions,t.revisions),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory())},o.prototype.updateHyperlinkFormat=function(e){var t,i=e.getHyperlinkField();_.isNullOrUndefined(i)||(t=i.fieldEnd,i=i.fieldSeparator,e.start.setPositionParagraph(i.line,i.line.getOffset(i,i.length)),e.end.setPositionParagraph(t.line,t.line.getOffset(t,0)),this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","Single",!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),this.initHistory("FontColor"),this.isForHyperlinkFormat=!0,this.updateCharacterFormatWithUpdate(e,"fontColor","#0563c1",!1),this.isForHyperlinkFormat=!1,this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1))},o.prototype.pasteInternal=function(e,t){if(this.currentPasteOptions=this.owner.defaultPasteOption,this.isHtmlPaste=!1,this.documentHelper.owner.enableLocalPaste)this.paste();else{this.selection.isViewPasteOptions=!0,this.selection.pasteElement&&(this.selection.pasteElement.style.display="none");var i="",n="",r="",o=(t=_.isNullOrUndefined(t)?window:t).clipboardData||e.clipboardData;if("msie"!==_.Browser.info.name&&(n=o.getData("Text/Rtf"),i=o.getData("Text/Html"),r=o.getData("application/json")),this.copiedTextContent=t=j.sanitizeString(o.getData("Text")),this.previousCharFormat=new B,this.previousCharFormat.copyFormat(this.selection.start.paragraph.characterFormat),this.previousParaFormat=new Xa,this.previousParaFormat.copyFormat(this.selection.start.paragraph.paragraphFormat),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()&&(n=i=""),""!==r)this.pasteFormattedContent({data:JSON.parse(r)});else if(""!==n)this.pasteAjax(n,".rtf");else if(""!==i){this.isHtmlPaste=!0;e=(new DOMParser).parseFromString(i,"text/html"),r=(new XMLSerializer).serializeToString(e);r=(r=(r=r.replace(/<!--StartFragment-->/gi,"")).replace(/<!--EndFragment-->/gi,"")).replace('xmlns="http://www.w3.org/1999/xhtml"',""),this.pasteAjax(r,".html")}else if(null!==t&&""!==t)this.selection.currentPasteAction="TextOnly",this.pasteContents(t),this.applyPasteOptions(this.currentPasteOptions,!0),this.copiedContent=void 0,this.documentHelper.editableDiv.innerHTML="";else if("msie"!==_.Browser.info.name&&void 0!==o.items&&0!==o.items.length)for(var s=0;s<o.items.length;s++){var a=o.items[s];("image/png"===a.type||"image/svg+xml"===a.type&&"string"!==a.kind)&&this.pasteImage(a.getAsFile())}else"msie"===_.Browser.info.name&&void 0!==o.files&&0!==o.files.length&&"image/png"===o.files[0].type&&this.pasteImage(o.files[0])}},o.prototype.pasteImage=function(e){var t=this,i=new FileReader;i.onload=function(){t.onPasteImage(i.result)},i.readAsDataURL(e)},o.prototype.onPasteImage=function(e){var t=document.createElement("img"),i=this;t.addEventListener("load",function(){i.insertImageInternal(e,!0,this.width,this.height,this.alt)}),t.src=e},o.prototype.pasteAjax=function(e,t){e={content:e,type:t},this.pasteRequestHandler=new A,this.owner.documentHelper.viewerContainer.focus(),C.showSpinner(this.owner.element),this.pasteRequestHandler.url=this.owner.serviceUrl+this.owner.serverActionSettings.systemClipboard,this.pasteRequestHandler.responseType="json",this.pasteRequestHandler.contentType="application/json;charset=UTF-8",this.pasteRequestHandler.customHeaders=this.owner.headers,this.pasteRequestHandler.onSuccess=this.pasteFormattedContent.bind(this),this.pasteRequestHandler.onFailure=this.onPasteFailure.bind(this),this.pasteRequestHandler.onError=this.onPasteFailure.bind(this),t={serverActionType:"SystemClipboard",headers:this.owner.headers,timeout:0,cancel:!1,withCredentials:!1,clipboardData:e};this.owner.trigger(Te,t),t.cancel?C.hideSpinner(this.owner.element):this.pasteRequestHandler.send(e,t)},o.prototype.pasteFormattedContent=function(e){var t=this;this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.pasteContents(_.isNullOrUndefined(e.data)?this.copiedTextContent:j.getSfdtDocument(e.data)),"KeepSourceFormatting"!==this.currentPasteOptions&&this.applyPasteOptions(this.currentPasteOptions),C.hideSpinner(this.owner.element),setTimeout(function(){_.isNullOrUndefined(t.viewer)||(t.documentHelper.isScrollHandler=!0,t.isPasteContentCheck=!0,t.viewer.updateScrollBars(),t.documentHelper.isScrollHandler=!1,t.isPasteContentCheck=!1)},0)},o.prototype.onPasteFailure=function(e){this.owner.fireServiceFailure(e),console.error(e.status,e.statusText),C.hideSpinner(this.owner.element),this.documentHelper.updateFocus()},o.prototype.paste=function(e,t){var i=this;_.isNullOrUndefined(e)&&(e=this.owner.enableLocalPaste?this.copiedData:void 0),_.isNullOrUndefined(t)||(this.currentPasteOptions=t),e&&(e=j.getSfdtDocument(e),this.pasteContents(e,null,t),this.applyPasteOptions(this.currentPasteOptions),this.currentPasteOptions=void 0,this.chartType)&&(setTimeout(function(){_.isNullOrUndefined(i.viewer)||i.viewer.updateScrollBars()},30),this.chartType=!1)},o.prototype.getUniqueListOrAbstractListId=function(e){return e&&this.documentHelper.lists.length?(e=this.documentHelper.lists.slice().sort(function(e,t){return e.listId-t.listId}))[e.length-1].listId+1:this.documentHelper.abstractLists.length?(e=this.documentHelper.abstractLists.slice().sort(function(e,t){return e.abstractListId-t.abstractListId}))[e.length-1].abstractListId+1:0},o.prototype.getBlocksToUpdate=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];if(n[De[this.keywordIndex]]&&n[De[this.keywordIndex]][ei[this.keywordIndex]]&&0<Object.keys(n[De[this.keywordIndex]][ei[this.keywordIndex]]).length)t.push(n);else if(n[ts[this.keywordIndex]])for(var r=0;r<n[ts[this.keywordIndex]].length;r++)for(var o=n[ts[this.keywordIndex]][r],s=0;s<o[es[this.keywordIndex]].length;s++)var a=o[es[this.keywordIndex]][s],t=t.concat(this.getBlocksToUpdate(a[S[this.keywordIndex]]))}return t},o.prototype.updateListIdForBlocks=function(e,t,i,n,r){for(var o=!1,s=0;s<e.length;s++){var a=e[s];if(a[De[this.keywordIndex]]&&a[De[this.keywordIndex]][ei[this.keywordIndex]]&&0<Object.keys(a[De[this.keywordIndex]][ei[this.keywordIndex]]).length){var l=a[De[this.keywordIndex]][ei[this.keywordIndex]],d=this.isNsIdMatchWithExistingAbstractList(t[Es]);l[Ut[this.keywordIndex]]===n&&(_.isNullOrUndefined(d)?(o=!0,l[Ut[this.keywordIndex]]=r):(l.isUpdated||(l[Ut[this.keywordIndex]]=d.listId,l.isUpdated=!0),o=!1))}else if(a[ts[this.keywordIndex]])for(var h=0;h<a[ts[this.keywordIndex]].length;h++)for(var c=a[ts[this.keywordIndex]][h],p=0;p<c[es[this.keywordIndex]].length;p++)var u=c[es[this.keywordIndex]][p],u=this.updateListIdForBlocks(u[S[this.keywordIndex]],t,i,n,r),o=o||u}return o},o.prototype.isNsIdMatchWithExistingAbstractList=function(e){for(var t=0;t<this.documentHelper.lists.length;t++){var i=this.documentHelper.lists[t];if(i.abstractList.nsid===e)return i}},o.prototype.updatePasteContent=function(a,l){for(var e,d,h=this,c=this.getUniqueListOrAbstractListId(!0),p=(0<a[Ue[this.keywordIndex]].filter(function(e){return e[Ut[h.keywordIndex]]===c}).length&&(e=a[Ue[this.keywordIndex]].slice().sort(function(e,t){return e[Ut[h.keywordIndex]]-t[Ut[h.keywordIndex]]}),c=e[e.length-1][Ut[this.keywordIndex]]+1),this.getUniqueListOrAbstractListId(!1)),u=(0<a[Ve[this.keywordIndex]].filter(function(e){return e[Os[h.keywordIndex]]===p}).length&&(e=a[Ve[this.keywordIndex]].slice().sort(function(e,t){return e[Os[h.keywordIndex]]-t[Os[h.keywordIndex]]}),p=e[e.length-1][Os[this.keywordIndex]]+1),this),t=0;t<a[Ue[this.keywordIndex]].length;t++)!function(e){var t=a[Ue[u.keywordIndex]][e],i=a[Ve[u.keywordIndex]].filter(function(e){return e[Os[h.keywordIndex]]===t[Os[h.keywordIndex]]})[0],n=u.documentHelper.lists.filter(function(e){return e.listId===t[Ut[h.keywordIndex]]});if(!_.isNullOrUndefined(i))if(u.updateListIdForBlocks(a[Re[u.keywordIndex]][l][S[u.keywordIndex]],i,n[0],t[Ut[u.keywordIndex]],c)){for(var r=i[Os[u.keywordIndex]],o=0;o<a[Ue[u.keywordIndex]].length;o++){var s=a[Ue[u.keywordIndex]][o];s[Os[u.keywordIndex]]===r&&(s[Os[u.keywordIndex]]=p)}i[Os[u.keywordIndex]]=p,t[Ut[u.keywordIndex]]=c,c++,p++}else a[Ue[u.keywordIndex]].splice(e,1),a[Ve[u.keywordIndex]].splice(a[Ve[u.keywordIndex]].indexOf(i),1),e--;d=e}(t),t=d;for(var i=this.getBlocksToUpdate(a[Re[this.keywordIndex]][l][S[this.keywordIndex]]),n=0;n<i.length;n++)delete i[n][De[this.keywordIndex]][ei[this.keywordIndex]].isUpdated},o.prototype.getBlocks=function(e,t,i,n,r,o){var s=[];if("string"==typeof e){var a=this.selection.start.paragraph,l=(this.selection.isForward||(a=this.selection.end.paragraph),[]),l=e.replace(/\r?\n/g,"\r").split("\r"),d=[];(w=new z).sectionFormat=new Ma(w),w.childWidgets=d;for(var h=0;h<l.length;h++)if(h!==l.length-1||0!==l[h].length||this.isInsertText){var c=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),p=this.selection.getPreviousValidElement(c.element),u=(p!==c.element&&(p=this.selection.getNextValidElement(c.element)),void 0),c=(a.isEmpty()?u=a.characterFormat:_.isNullOrUndefined(p)||this.isInsertText?this.copyInsertFormat(a.characterFormat,!1):u=p.characterFormat,void 0),p=(this.isInsertText&&!this.selection.isEmpty?(c=new Xa).copyFormat(this.selection.end.paragraph.paragraphFormat):c=this.documentHelper.selection.copySelectionParagraphFormat(),_.isNullOrUndefined(this.previousParaFormat)||(c=this.previousParaFormat),new G),g=(p.paragraphFormat.copyFormat(c),new uh(p));if(0<l[h].length)for(var m=l[h].split(/(\s+)/),f=0;f<m.length;f++){var y=new X;y.characterFormat.copyFormat(u),y.text=m[f],g.children.push(y),y.line=g}p.childWidgets.push(g),p.containerWidget=w,d.push(p)}s.push(w)}else{var v=this.documentHelper.owner.parser,w=(v.keywordIndex=this.keywordIndex,v.isPaste=t,v.isContextBasedPaste=!_.isNullOrUndefined(o)&&o,v.isHtmlPaste=this.isHtmlPaste,o||(v.addCustomStyles(e),e[_e[this.keywordIndex]]&&0<e[_e[this.keywordIndex]].length&&(v.commentsCollection=new T,v.commentStarts=new T,v.commentEnds=new T,v.parseComments(e,n||this.documentHelper.comments))),void 0);this.selection.currentPasteAction="DefaultPaste";for(h=0;h<e[Re[this.keywordIndex]].length;h++){if(!o&&(this.isPasteListUpdated||_.isNullOrUndefined(e[Ue[this.keywordIndex]])||(0<this.documentHelper.lists.length&&this.updatePasteContent(e,h),this.isPasteListUpdated=!0,_.isNullOrUndefined(e[Ve[this.keywordIndex]])||v.parseAbstractList(e,this.documentHelper.abstractLists),_.isNullOrUndefined(e[Ue[this.keywordIndex]]))||v.parseList(e,this.documentHelper.lists),!_.isNullOrUndefined(e[je[this.keywordIndex]])))if(t){var b=this.viewer.owner.revisionsInternal.changes,x=(_.isNullOrUndefined(v.revisionCollection)||(v.revisionCollection=void 0),this.isRemoteAction?v.revisionCollection=this.documentHelper.revisionsInternal:v.revisionCollection=new T,v.revisionCollection);if((!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange||!v.isCutPerformed)&&1<=e[je[this.keywordIndex]].length)for(var C=0;C<e[je[this.keywordIndex]].length;C++){var I,k=!0;if(x.containsKey(e[je[this.keywordIndex]][C][yo[this.keywordIndex]])){if(0<b.length)for(var F=0;F<b.length;F++)b[F].revisionID===e[je[this.keywordIndex]][C][yo[this.keywordIndex]]&&(k=!1);k&&!this.isRemoteAction&&(I=x.get(e[je[this.keywordIndex]][C][yo[this.keywordIndex]]),b.push(I))}else v.parseRevisions(e,b)}this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1}else v.revisionCollection=this.documentHelper.revisionsInternal,v.parseRevisions(e,r);if((w=new z).sectionFormat=new Ma(w),!t||o?i.unshift(w):s.push(w),t&&!o&&!_.isNullOrUndefined(e[qe[this.keywordIndex]]))for(f=0;f<e[qe[this.keywordIndex]].length;f++){var P=e[qe[this.keywordIndex]][f][dt[this.keywordIndex]],P=this.documentHelper.styles.findByName(P);_.isNullOrUndefined(P)&&v.parseStyle(e,e[qe[this.keywordIndex]][f],this.documentHelper.styles)}v.parseBody(e[Re[this.keywordIndex]][h][S[this.keywordIndex]],w.childWidgets,void 0,void 0,void 0,e[qe[this.keywordIndex]]),((e[nt[this.keywordIndex]]||this.owner.enableLocalPaste)&&this.selection.start.paragraph.isEmpty()&&1==this.documentHelper.pages.length&&1==this.documentHelper.pages[0].bodyWidgets[0].childWidgets.length||e[Re[this.keywordIndex]][h][ks[this.keywordIndex]]&&1<e[Re[this.keywordIndex]][h][ks[this.keywordIndex]][Si[this.keywordIndex]]||e[Re[this.keywordIndex]][h][ks[this.keywordIndex]]&&"NoBreak"===e[Re[this.keywordIndex]][h][ks[this.keywordIndex]][Wi[this.keywordIndex]])&&v.parseSectionFormat(this.keywordIndex,e[Re[this.keywordIndex]][h][ks[this.keywordIndex]],w.sectionFormat),v.isPaste=!1,v.isHtmlPaste=!1,v.isContextBasedPaste=!1}e[nt[this.keywordIndex]]&&!o&&(this.isLastParaMarkCopied=!0,n=new G,w.childWidgets.push(n))}return"MergeWithExistingFormatting"!==this.currentPasteOptions||o||this.applyMergeFormat(s),s},o.prototype.applyMergeFormat=function(e){for(var t=this.selection.start.paragraph,i=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),i=this.selection.getPreviousValidElement(i.element),n=i?i.characterFormat:this.copyInsertFormat(t.characterFormat,!0,t),r=this.documentHelper.selection.paragraphFormat,o=0;o<e.length;o++)for(var s=e[o].childWidgets,a=0;a<s.length;a++){var l=s[a];if(l instanceof G)this.applyParaFormatInternal(l.paragraphFormat,r),this.applyFormatInternal(l,n);else for(var d=0;d<l.childWidgets.length;d++)for(var h=l.childWidgets[d],c=0;c<h.childWidgets.length;c++)for(var p=h.childWidgets[c],u=0;u<p.childWidgets.length;u++)this.applyFormatInternal(p.childWidgets[u],n)}},o.prototype.applyParaFormatInternal=function(e,t){_.isNullOrUndefined(t.leftIndent)||(e.leftIndent=t.leftIndent),_.isNullOrUndefined(t.rightIndent)||(e.rightIndent=t.rightIndent),_.isNullOrUndefined(t.firstLineIndent)||(e.firstLineIndent=t.firstLineIndent),_.isNullOrUndefined(t.textAlignment)?e.textAlignment="Left":e.textAlignment=t.textAlignment,_.isNullOrUndefined(t.outlineLevel)?e.outlineLevel="BodyText":e.outlineLevel=t.outlineLevel,-1===t.beforeSpacing?e.beforeSpacing=0:e.beforeSpacing=t.beforeSpacing,-1===t.afterSpacing?e.afterSpacing=0:e.afterSpacing=t.afterSpacing,0===t.lineSpacing?e.lineSpacing=1:e.lineSpacing=t.lineSpacing,_.isNullOrUndefined(t.lineSpacingType)||(e.lineSpacingType=t.lineSpacingType),_.isNullOrUndefined(t.bidi)||(e.bidi=t.bidi),_.isNullOrUndefined(t.spaceAfterAuto)||(e.spaceAfterAuto=t.spaceAfterAuto),_.isNullOrUndefined(t.spaceBeforeAuto)||(e.spaceBeforeAuto=t.spaceBeforeAuto),_.isNullOrUndefined(t.keepWithNext)||(e.keepWithNext=t.keepWithNext),_.isNullOrUndefined(t.keepLinesTogether)||(e.keepLinesTogether=t.keepLinesTogether),_.isNullOrUndefined(t.widowControl)||(e.widowControl=t.widowControl),_.isNullOrUndefined(t.contextualSpacing)||(e.contextualSpacing=t.contextualSpacing),e.tabs&&(e.tabs=[])},o.prototype.applyFormatInternal=function(e,t){if(e instanceof G)for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.children.length;r++){var o=n.children[r].characterFormat.cloneFormat();o.bold&&(n.children[r].characterFormat.bold=o.bold),o.italic&&(n.children[r].characterFormat.italic=o.italic),"None"!==o.underline&&(n.children[r].characterFormat.underline=o.underline),"MergeWithExistingFormatting"!==this.currentPasteOptions||_.isNullOrUndefined(t)||(t.bold&&(n.children[r].characterFormat.bold=t.bold),t.italic&&(n.children[r].characterFormat.italic=t.italic),"None"!==t.underline&&(n.children[r].characterFormat.underline=t.underline),n.children[r].characterFormat.fontColor!==t.fontColor&&(n.children[r].characterFormat.fontColor=t.fontColor),n.children[r].characterFormat.fontSize!==t.fontSize&&(n.children[r].characterFormat.fontSize=t.fontSize,n.children[r].characterFormat.fontSizeBidi=t.fontSizeBidi),n.children[r].characterFormat.fontFamily!==t.fontFamily&&(n.children[r].characterFormat.fontFamily=t.fontFamily,n.children[r].characterFormat.fontFamilyBidi=t.fontFamilyBidi),n.children[r].characterFormat.fontFamilyAscii!==t.fontFamilyAscii&&(n.children[r].characterFormat.fontFamilyAscii=t.fontFamilyAscii),n.children[r].characterFormat.fontFamilyFarEast!==t.fontFamilyFarEast&&(n.children[r].characterFormat.fontFamilyFarEast=t.fontFamilyFarEast),n.children[r].characterFormat.fontFamilyAscii!==t.fontFamilyAscii&&(n.children[r].characterFormat.fontFamilyAscii=t.fontFamilyAscii))}else for(i=0;i<e.childWidgets.length;i++)for(var s=e.childWidgets[i],r=0;r<s.childWidgets.length;r++)for(var a=s.childWidgets[r],l=0;l<a.childWidgets.length;l++)this.applyFormatInternal(a.childWidgets[l],t)},o.prototype.applyPasteOptions=function(e,t){if(!_.isNullOrUndefined(this.copiedContent)&&""!==this.copiedTextContent&&!t){this.currentPasteOptions=e;var i=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.paragraphFormat,t=this.copiedContent,n=this.copiedTextContent;switch(this.editorHistory&&this.editorHistory.canUndo()&&(this.editorHistory.undo(),this.editorHistory.redoStack.pop()),this.copiedContent=t,this.copiedTextContent=n,this.selection.isViewPasteOptions=!0,e){case"KeepSourceFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent);break;case"MergeWithExistingFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent,i);break;case"KeepTextOnly":this.pasteContents(this.copiedTextContent)}}},o.prototype.applyTablePasteOptions=function(e){if(!_.isNullOrUndefined(this.copiedContent)&&""!==this.copiedTextContent){this.isPaste=!0;var t=""!==this.copiedContent?this.copiedContent:this.copiedTextContent,i=(this.editorHistory&&this.editorHistory.canUndo()&&(this.editorHistory.undo(),this.editorHistory.redoStack.pop()),this.getBlocks(t,!0)),n=this.selection.start.paragraph.paragraphFormat;switch(e){case"NestTable":this.pasteAsNestedTable(i,n);break;case"InsertAsRows":this.pasteAsNewRow(i[0].childWidgets[0]);break;case"InsertAsColumns":this.pasteAsNewColumn(i[0].childWidgets[0]);break;case"OverwriteCells":this.pasteOverwriteCell(i[0].childWidgets[0])}this.isPaste=!1}},o.prototype.pasteContents=function(e,t,i){if(!_.isNullOrUndefined(e.optimizeSfdt)&&e.optimizeSfdt?this.keywordIndex=1:this.keywordIndex=0,"string"!=typeof e&&(this.copiedContent=e),!_.isNullOrUndefined(this.documentHelper)){var n,r,o;if("FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()&&(o=this.selection.getCurrentFormField(),n=this.getFieldResultText(),o=o.formFieldData.maxLength,r=this.documentHelper.selection.text.length,0<o)&&(0===r?(o=o-n.length,e=e.substring(0,o)):0<r&&(e=e.substring(0,r))),!_.isNullOrUndefined(e[Pa[this.keywordIndex]])){var s=e[Pa[this.keywordIndex]];if(0<this.documentHelper.images.length){this.pasteImageIndex=new T;var a,l={};for(a in s){var d=Math.max.apply(Math,this.documentHelper.images.keys)+1+parseInt(a);l[d]=s[a],this.pasteImageIndex.add(a,d.toString())}s=l}this.documentHelper.owner.parser.parseImages(s)}this.pasteContentsInternal(this.getBlocks(e,!0),!0,t,i),this.isRemoteAction&&(this.updatePasteRevision(),this.owner.trackChangesPane.updateTrackChanges()),e[_e[this.keywordIndex]]&&0<e[_e[this.keywordIndex]].length&&this.documentHelper.layout.layoutComments(this.documentHelper.comments),_.isNullOrUndefined(this.pasteImageIndex)||this.pasteImageIndex.destroy(),this.pasteImageIndex=void 0,this.isInsertField=!1,this.isPasteListUpdated=!1,this.isLastParaMarkCopied=!1}},o.prototype.pasteContentsInternal=function(e,t,i,n){this.isPaste=t;t=this.documentHelper.selection;if(t.start.paragraph.isInsideTable&&t.end.paragraph.isInsideTable&&!this.documentHelper.isDragging){var r=!1;if(r=1===e.length&&(o=e[0].childWidgets).length<3&&(1===o.length&&o[0]instanceof K||2===o.length&&o[0]instanceof K&&o[1].isEmpty())?!0:r){var o=t.start.paragraph.associatedCell,r=t.end.paragraph.associatedCell,s=e[0].childWidgets[0];if(_.isNullOrUndefined(n)||"MergeWithExistingFormatting"===n||"KeepSourceFormatting"===n||"KeepTextOnly"===n)o.ownerTable.equals(r.ownerTable)&&(0===t.start.paragraph.associatedCell.rowIndex&&0===t.end.paragraph.associatedCell.rowIndex&&o.equals(r)&&!this.selection.isCellSelected(o,t.start,t.end)?(this.selection.currentPasteAction="InsertAsColumns",this.pasteAsNewColumn(s)):(this.selection.currentPasteAction="OverwriteCells",this.pasteOverwriteCell(s)));else switch(n){case"InsertAsColumns":this.selection.currentPasteAction="InsertAsColumns",this.pasteAsNewColumn(s);break;case"OverwriteCells":this.selection.currentPasteAction="OverwriteCells",this.pasteOverwriteCell(s);break;case"NestTable":this.selection.currentPasteAction="NestTable",this.pasteAsNestedTable(e);break;case"InsertAsRows":this.selection.currentPasteAction="InsertAsRows",this.pasteAsNewRow(s)}return void(this.isPaste=!1)}}r=this.checkAndRemoveComments(),this.defaultPaste(e,i),this.updateHistoryForComments(r)},o.prototype.defaultPaste=function(e,t){var i,n=this.documentHelper.selection,r=!0,o=!1;this.initComplexHistory("Paste"),this.documentHelper.isListTextSelected&&(i=n.start.paragraph).paragraphFormat.listFormat&&-1!==i.paragraphFormat.listFormat.listId&&this.onApplyList(void 0),this.initHistory("Paste"),(r=(n.isEmpty||this.owner.documentHelper.isDragging&&this.owner.selection.isImageSelected)&&!this.documentHelper.isListTextSelected?r:this.removeSelectedContentInternal(n,n.start,n.end))?(o=this.pasteContent(e,t),this.owner.enableTrackChanges&&this.isInsertingTOC&&_.isNullOrUndefined(this.owner.documentHelper.blockToShift)&&(this.owner.documentHelper.blockToShift=this.selection.start.paragraph)):this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0),this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentBaseHistoryInfo&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action&&(i=this.selection.getTextPosBasedOnLogicalIndex(this.editorHistory.currentBaseHistoryInfo.insertPosition),r=this.selection.getTextPosBasedOnLogicalIndex(this.editorHistory.currentBaseHistoryInfo.endPosition),this.isRemoteAction||(e=_.isNullOrUndefined(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,i.currentWidget,i.offset,r.currentWidget,r.offset,!1,!0),this.editorHistory.currentBaseHistoryInfo.pasteContent=e)),this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()):this.reLayout(n,n.isEmpty),o&&(this.selection.pasteElement&&(this.selection.pasteElement.style.display="none"),this.layoutWholeDocument(!0)),this.isPaste=!1},o.prototype.pasteAsNewColumn=function(e){if(!this.owner.isReadOnlyMode&&this.canEditContentControl&&this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("PasteColumn");var t=this.getOwnerCell(this.selection.isForward),i=t.ownerRow.ownerTable.combineWidget(this.owner.viewer),n=(this.editorHistory&&this.cloneTableToHistoryInfo(i),this.selection.owner.isLayoutEnabled=!1,e.clone()),e=n.childWidgets[0],r=n.childWidgets.length,e=e.childWidgets.length,o=t.columnIndex,s=void 0,a=void 0,l=e,d=[];r>i.childWidgets.length?(this.addRows(r-i.childWidgets.length,i),this.tableUpdate(i)):i.childWidgets.length>r&&(this.addRows(i.childWidgets.length-r,n,i),this.tableUpdate(i));for(var h=0;h<l;h++)for(var c=0;c<i.childWidgets.length;c++){var p=i.childWidgets[c],u=n.childWidgets[c].childWidgets[h],g=p.childWidgets[t.columnIndex],m=((a=this.createColumn(this.selection.getLastParagraph(t))).index=c,a.rowIndex=p.index,(a.containerWidget=p).previousWidget),f=this.rowspannedCollection(p,d);if(null!=g)a.cellFormat.copyFormat(g.cellFormat),a.cellFormat.rowSpan=1;else if(0<f.length)for(var y=0;y<f.length;y++)m.rowIndex+(f[y].cellFormat.rowSpan-1)>=p.rowIndex&&(a.cellFormat.copyFormat(f[y].cellFormat),a.cellFormat.rowSpan=1);u.containerWidget=a.containerWidget,a.childWidgets=u.childWidgets,_.isNullOrUndefined(s)&&(s=this.selection.getFirstParagraph(a)),0===o?p.childWidgets.splice(h,0,a):this.insertSpannedCells(p,d,a,o)}this.tableReLayout(i,s,a,!0)}},o.prototype.pasteAsNestedTable=function(e,t){var i=e[0].childWidgets[0];if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("PasteNested");var n=this.getOwnerCell(this.selection.isForward),r=n.ownerRow.ownerTable.combineWidget(this.owner.viewer),o=(this.editorHistory&&this.cloneTableToHistoryInfo(r),void 0),s=i.clone(),a=this.selection.end.paragraph.containerWidget,l=void 0;if(n!=a){for(var d=n.ownerRow;d!=a.ownerRow.nextRow;){for(var h=n.columnIndex;h<=a.columnIndex;h++){var l=d.childWidgets[h],c=s.clone(),p=new G;l.childWidgets=[],l.childWidgets[0]=c,(l.childWidgets[1]=p).containerWidget=l,c.containerWidget=l,c.index=0,p.index=1,d.childWidgets[h]=l,_.isNullOrUndefined(o)&&(o=this.selection.getFirstParagraph(l))}d=d.nextRow}this.tableReLayout(r,o,l)}else this.defaultPaste(e,t)}},o.prototype.pasteOverwriteCell=function(e){if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("PasteOverwrite");var t=this.getOwnerCell(this.selection.isForward),i=t.ownerRow.ownerTable.combineWidget(this.owner.viewer),n=(this.editorHistory&&this.cloneTableToHistoryInfo(i),e.clone()),r=n.childWidgets.length,o=this.getOwnerCell(!this.selection.isForward),e=(t.columnIndex,t.rowIndex),s=void 0,a=this.selection.start.paragraph.associatedCell.ownerRow,l=void 0,d=((m=n.childWidgets[0]).childWidgets.length,t.ownerRow);if(t!=o){for(var h=0,c=void 0,p=void 0,u=void 0,g=void 0;d!=o.ownerRow.nextRow;){for(var m,f=(m=n.childWidgets[h]||n.childWidgets[h=0]).childWidgets.length,y=0,v=t.columnIndex;v<=o.columnIndex;v++){1<c&&p===v&&(v++,c--,p=null),1<u&&f-(u-1)<=y&&(v+=(u=1)-1,y=0),g=(l=(m=n.childWidgets[h]).childWidgets[y]||m.childWidgets[y=0]).clone();for(var w=d.childWidgets[v],b=0;b<g.childWidgets.length;b++)(k=g.childWidgets[b]).containerWidget=w,g.childWidgets[b]=k;w.childWidgets=g.childWidgets,1<l.cellFormat.rowSpan&&(c=l.cellFormat.rowSpan,p=v),1<l.cellFormat.columnSpan&&(u=l.cellFormat.columnSpan),d.childWidgets[v]=w,_.isNullOrUndefined(s)&&(s=this.selection.getFirstParagraph(g)),y++}d=d.nextRow,h++}this.tableReLayout(i,s,g)}else{c=void 0,p=void 0,w=void 0;r>i.childWidgets.length-e&&(e=r-i.childWidgets.length+e,this.addRows(e,i));for(var x=0;x<r;x++){for(var v=t.columnIndex,C=(m=n.childWidgets[x]).childWidgets.length,I=0;I<C;I++){g=(l=m.childWidgets[I]).clone();1<c&&p===v&&(v++,c--,p=null),(w=a.childWidgets[v])||((w=g).containerWidget=a,w.index=v);for(var k,F=0;F<g.childWidgets.length;F++)(k=g.childWidgets[F]).containerWidget=w,g.childWidgets[F]=k;w.childWidgets=g.childWidgets,1<l.cellFormat.rowSpan&&(c=l.cellFormat.rowSpan,p=v),a.childWidgets.splice(v++,1,w),_.isNullOrUndefined(s)&&(s=this.selection.getFirstParagraph(w))}a=a.nextRow}this.tableReLayout(i,s,w,!0)}}},o.prototype.pasteAsNewRow=function(e){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){this.checkIsNotRedoing()&&this.initHistory("PasteRow"),this.documentHelper.owner.isShiftingEnabled=!0;for(var t=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],i=this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0],n=t.ownerTable.combineWidget(this.owner.viewer),t=i.ownerRow,r=(this.editorHistory&&this.cloneTableToHistoryInfo(n),this.getRowCountToInsert(),this.getColumnCountToInsert(),[]),i=t.rowIndex,o=(i++,e.childWidgets.length),s=0;s<o;s++){var a=e.childWidgets[s].clone();this.owner.enableTrackChanges&&this.insertRevision(a.rowFormat,"Insertion"),r.push(a)}n.insertTableRowsInternal(r,i,!1);t=void 0;if(n.childWidgets[i]instanceof dh)i=n.childWidgets[i].firstChild,t=this.selection.getFirstParagraph(i);else{for(var l=void 0;!(l instanceof K);)l=n.nextRenderedWidget;t=this.documentHelper.getFirstParagraphInFirstCell(l)}this.copyContent(n),this.documentHelper.layout.reLayoutTable(n),this.selection.selectParagraphInternal(t,!0),this.reLayout(this.selection,!0)}},o.prototype.tableUpdate=function(e){e.isGridUpdated=!1,e.calculateGrid(),e.buildTableColumns(),e.isGridUpdated=!0},o.prototype.rowspannedCollection=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];1<n.cellFormat.rowSpan&&t.push(n)}return t},o.prototype.insertSpannedCells=function(e,t,i,n){for(var r=!1,o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];if(1<s.cellFormat.rowSpan&&t.push(s),(s.columnIndex+s.cellFormat.columnSpan===n||n>s.columnIndex&&s.columnIndex+s.cellFormat.columnSpan>n&&n<s.columnIndex+s.cellFormat.columnSpan)&&(e.childWidgets.splice(s.cellIndex+1,0,i),r=!0),r)break}if(!r&&0<t.length)for(var a=0;a<t.length;a++){var l=t[a];if(l.ownerRow!==e&&e.rowIndex<=l.ownerRow.rowIndex+l.cellFormat.rowSpan-1&&(l.columnIndex+l.cellFormat.columnSpan===n?(l.cellIndex>e.childWidgets.length?e.childWidgets.push(i):e.childWidgets.splice(l.cellIndex+1,0,i),r=!0):n>l.columnIndex&&l.columnIndex+l.cellFormat.columnSpan>n&&n<l.columnIndex+l.cellFormat.columnSpan&&(e.childWidgets.splice(l.columnIndex,0,i),r=!0)),r)break}},o.prototype.addRows=function(e,t,i){var n,r,o;!this.owner.isReadOnlyMode&&this.canEditContentControl&&(n=this.selection.isForward?this.selection.start:this.selection.end,this.selection.isForward?this.selection.end:this.selection.start,r=t.childWidgets.length,o=(r=t.childWidgets[r-1]).childWidgets.length,n.paragraph.isInsideTable)&&(n=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],o=(r=r.childWidgets[o-1]).ownerRow,this.rowInsertion(e,"Below",n,r,o,t,!1))},o.prototype.pasteContent=function(e,t){this.documentHelper.owner.isShiftingEnabled=!0;var i="",e=(this.updateInsertPosition(),i=this.editorHistory&&this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo.insertPosition:(n=this.selection.start,this.selection.isForward||(n=this.selection.end),n=this.selection.getParagraphInfo(n),this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())),this.documentHelper.owner.isLayoutEnabled=!0,this.documentHelper.owner.isPastingContent=!0,this.pasteCopiedData(e,t)),t="",n=(this.updateEndPosition(),t=this.editorHistory&&this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo.endPosition:(n=this.selection.getParagraphInfo(this.selection.start),this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())),this.selection.start.paragraph.isEmpty()&&this.selection.start.paragraph.paragraphFormat.bidi&&this.documentHelper.layout.reLayoutParagraph(this.selection.start.paragraph,0,0),new y(this.documentHelper.owner)),i=(this.setPositionForCurrentIndex(n,i),new y(this.documentHelper.owner));return this.setPositionForCurrentIndex(i,t),this.pasteTextPosition={startPosition:n,endPosition:i},this.documentHelper.owner.isPastingContent=!1,this.documentHelper.selection.fireSelectionChanged(!0),e},o.prototype.pasteCopiedData=function(e,t){var i,n=!1,r=!1;this.documentHelper.layout.isBidiReLayout&&(this.documentHelper.layout.isBidiReLayout=!1),this.isPaste&&this.isSectionEmpty(this.selection)&&!this.selection.start.paragraph.isInHeaderFooter&&(this.previousSectionFormat=new Ma,this.previousSectionFormat.copyFormat(this.selection.start.paragraph.bodyWidget.sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.copyFormat(e[0].sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.footerDistance=this.previousSectionFormat.footerDistance,this.selection.start.paragraph.bodyWidget.sectionFormat.headerDistance=this.previousSectionFormat.headerDistance,this.owner.viewer instanceof Sd&&(i=this.selection.start.paragraph.bodyWidget.page,this.owner.viewer.updatePageBoundingRectangle(this.selection.start.paragraph.bodyWidget,i,i.boundingRectangle.y),this.owner.viewer.updateClientArea(this.selection.start.paragraph.bodyWidget,i)),n=!0);for(var o=0;o<e.length;o++){0!==o&&this.insertSectionBreak(e[o].sectionFormat.breakCode,e[o].sectionFormat);for(var s=e[o].childWidgets,a=0;a<s.length;a++){var l,d=s[a];if(d instanceof G&&0===d.childWidgets.length&&(d.childWidgets[0]=new uh(d)),d instanceof G&&!_.isNullOrUndefined(t)&&(d.paragraphFormat.copyFormat(t),l=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!1),d.characterFormat.mergeFormat(l)),a!==s.length-1&&this.isPaste&&_.isNullOrUndefined(t)&&this.previousParaFormat&&d instanceof G&&!_.isNullOrUndefined(d.paragraphFormat.listFormat)&&_.isNullOrUndefined(d.paragraphFormat.listFormat.list)&&-1===d.paragraphFormat.listFormat.listId&&(this.previousParaFormat.listFormat&&this.previousParaFormat.listFormat.list&&-1!==this.previousParaFormat.listFormat.listId?(d.paragraphFormat.listFormat.copyFormat(this.previousParaFormat.listFormat),d.paragraphFormat.leftIndent=this.previousParaFormat.leftIndent):this.previousParaFormat.baseStyle&&this.previousParaFormat.baseStyle instanceof ul&&this.previousParaFormat.baseStyle.paragraphFormat.listFormat&&this.previousParaFormat.baseStyle.paragraphFormat.listFormat.list&&-1!==this.previousParaFormat.baseStyle.paragraphFormat.listFormat.listId&&(l=this.previousParaFormat.baseStyle.paragraphFormat,d.paragraphFormat.listFormat.copyFormat(l.listFormat),d.paragraphFormat.leftIndent=l.leftIndent)),a===s.length-1&&d instanceof G&&!_.isNullOrUndefined(d.paragraphFormat.listFormat)&&_.isNullOrUndefined(d.paragraphFormat.listFormat.list)&&-1===d.paragraphFormat.listFormat.listId){var h=d;0<h.childWidgets.length&&0<h.childWidgets[0].children.length&&("Center"!==(c=this.selection.start).paragraph.paragraphFormat.textAlignment&&"Right"!==c.paragraph.paragraphFormat.textAlignment||-1!==c.paragraph.paragraphFormat.listFormat.listId||(c.paragraph.x=this.owner.viewer.clientActiveArea.x),!_.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(h.clone()),r=this.insertElement(h.childWidgets[0].children,h.paragraphFormat))}else if(d instanceof Qd){var c=d,h=this.selection.start.paragraph;if(c instanceof K){var p,d=c;if(this.generateTableRevision(d),h.isInsideTable&&(p=h.getContainerWidth(),d.fitCellsToClientArea(p)),h.isEmpty()&&h.previousWidget instanceof K&&!this.isPaste)return this.insertTableRows(d,h.previousWidget),n}this.insertBlockInternal(c)}}}return r&&(n=!0,"Footnote"===this.pasteFootNoteType?this.arrangeFootnoteCollection():"Endnote"===this.pasteFootNoteType&&this.arrangeEndnoteCollection()),n},o.prototype.arrangeEndnoteCollection=function(){for(var e=0;e<this.documentHelper.endnoteCollection.length;e++)for(var t=0;t<this.documentHelper.endnoteCollection.length-1-e;t++){var i=this.selection.getElementPosition(this.documentHelper.endnoteCollection[t]).startPosition,n=this.selection.getElementPosition(this.documentHelper.endnoteCollection[t+1]).startPosition;i.isExistBefore(n)||(i=this.documentHelper.endnoteCollection[t],this.documentHelper.endnoteCollection[t]=this.documentHelper.endnoteCollection[t+1],this.documentHelper.endnoteCollection[t+1]=i)}},o.prototype.arrangeFootnoteCollection=function(){for(var e=0;e<this.documentHelper.footnoteCollection.length;e++)for(var t=0;t<this.documentHelper.footnoteCollection.length-1-e;t++){var i=this.selection.getElementPosition(this.documentHelper.footnoteCollection[t]).startPosition,n=this.selection.getElementPosition(this.documentHelper.footnoteCollection[t+1]).startPosition;i.isExistBefore(n)||(i=this.documentHelper.footnoteCollection[t],this.documentHelper.footnoteCollection[t]=this.documentHelper.footnoteCollection[t+1],this.documentHelper.footnoteCollection[t+1]=i)}},o.prototype.generateTableRevision=function(e){if(this.owner.enableTrackChanges&&!_.isNullOrUndefined(e))for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];this.insertRevision(i.rowFormat,"Insertion");for(var n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];_.isNullOrUndefined(s)||this.insertRevisionForBlock(s,"Insertion")}}},o.prototype.isSectionEmpty=function(e){var t=e.start.paragraph;if(t){if(t.isInsideTable||t.isInHeaderFooter||t!==e.end.paragraph)return!1;var i=t.bodyWidget;if(i){var n=i.page;if(n&&(_.isNullOrUndefined(n.previousPage)||n.previousPage.sectionIndex!==n.sectionIndex)&&_.isNullOrUndefined(n.nextPage)&&t.isEmpty()&&1===i.childWidgets.length){var r=!0,n=e.start.paragraph.bodyWidget.sectionIndex,o=this.documentHelper.headersFooters[n];if(o){for(var s in o){var s=o[s];if(!(r=_.isNullOrUndefined(s)||(s=s.childWidgets[0])instanceof K||s instanceof G&&!s.isEmpty()?!1:r))break}return r}}}}return!1},o.prototype.insertTableInternal=function(e,t,i,n){var r,o=e.index,s=this.selection.start.paragraph;if(!e.isInsideTable&&t.isInsideTable&&(o=t.index,n=!0,r=s.containerWidget),i)for(var a=0,l=0;a<e.childWidgets.length;a++,l++){var d=e.childWidgets[a];t.childWidgets.splice(l,0,d),d.containerWidget=t,e.childWidgets.splice(a,1),a--}!s.isInsideTable&&_.isNullOrUndefined(r)?(e.containerWidget=s.containerWidget,r=s.containerWidget):_.isNullOrUndefined(r)&&(r=e.containerWidget),e.isInsideTable&&(r=r.combineWidget(this.owner.viewer)),this.constructRevisionsForTable(e,!1),n||this.removeBlock(e,!0),this.removeRevisionFromTable(t),r instanceof N?r=r.combineWidget(this.owner.viewer):(i=this.documentHelper.layout.checkAndGetBlock(r,o),-1!==r.childWidgets.indexOf(i)&&(o=r.childWidgets.indexOf(i))),r.childWidgets.splice(o,0,t),n||(e.containerWidget=void 0,t.index=e.index),t.containerWidget=r,this.documentHelper.layout.clearTableWidget(t,!0,!0,!0),t.buildTableColumns(),this.constructRevisionsForTable(t,!0),t.isGridUpdated=!0,this.updateNextBlocksIndex(t,!0),this.documentHelper.layout.linkFieldInTable(t),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,r,t,!1)},o.prototype.removeRevisionFromTable=function(e){for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];if(0<i.rowFormat.revisions.length)for(var n,r=0;r<i.rowFormat.revisions.length;r++)0===i.rowFormat.revisions[r].range.length&&(n=i.rowFormat.revisions.indexOf(i.rowFormat.revisions[r]),i.rowFormat.revisions.splice(n,1),r--);for(r=0;r<i.childWidgets.length;r++)for(var o=i.childWidgets[r],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];a instanceof K&&this.removeRevisionFromTable(a)}}},o.prototype.canConstructRevision=function(e){return 0<e.revisions.length&&0===e.revisions[0].range.length||0<e.removedIds.length},o.prototype.constructRevisionsForTable=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];if(t){this.canConstructRevision(n.rowFormat)&&this.constructRevisionFromID(n.rowFormat,!0);for(var r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.childWidgets.length;s++)o.childWidgets[s]instanceof G?this.constructRevisionsForBlock(o.childWidgets[s],t):o.childWidgets[s]instanceof K&&this.constructRevisionsForTable(o.childWidgets[s],!0)}else this.removeDeletedCellRevision(n,!0)}},o.prototype.deleteRevision=function(e){if(0<e.rowFormat.revisions.length)for(var t=0;t<e.rowFormat.revisions.length;t++){for(var i=e.rowFormat.revisions[t],n=0;n<i.range.length;n++)i.range.splice(n,1),n--,this.owner.trackChangesPane.updateCurrentTrackChanges(i);0===i.range.length&&this.owner.revisions.remove(i)}},o.prototype.constructRevisionForFootnote=function(e,t){for(var i=0;i<e.bodyWidget.childWidgets.length;i++)e.bodyWidget.childWidgets[i]instanceof G&&this.constructRevisionsForBlock(e.bodyWidget.childWidgets[i],t)},o.prototype.constructRevisionsForBlock=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var n,r=e.childWidgets[i],o=0;o<r.children.length;o++)t&&(r.children[o]instanceof mh&&this.canConstructRevision(r.children[o])&&this.constructRevisionFromID(r.children[o],!0),r.children[o]instanceof Bh)&&(n=r.children[o],this.constructRevisionForFootnote(n,t));this.canConstructRevision(e.characterFormat)&&this.constructRevisionFromID(e.characterFormat,!0)},o.prototype.applyRevisionForCurrentPara=function(e,t,i,n,r){for(var o=e.getInline(t+1,0),s=o.element,a=(o.element instanceof X&&""===o.element.text&&!_.isNullOrUndefined(o.element.previousElement)&&(s=o.element.previousElement),!1),l=(t===e.getLength()&&(a=!0),t===i&&e.nextSplitWidget&&(i+=s.length),e.getInline(i,0).element),d=(_.isNullOrUndefined(e.nextSplitWidget)||(r=!1),0),h=e;h;)_.isNullOrUndefined(h)||(d+=h.getLength()),h=h.previousSplitWidget;if(_.isNullOrUndefined(e.previousSplitWidget)||0===d||t===d||(a=!1),d<i&&(r=!0),_.isNullOrUndefined(s)||_.isNullOrUndefined(l))_.isNullOrUndefined(s)||a?_.isNullOrUndefined(l)||(l.removedIds.push(n),this.constructRevisionFromID(l,!0)):(s.removedIds.push(n),this.constructRevisionFromID(s,!0));else if(a||s!==l){for(;!_.isNullOrUndefined(s)&&s!==l;)a||(s.removedIds.push(n),this.constructRevisionFromID(s,!0)),_.isNullOrUndefined(s.nextNode)||(s=s.nextNode instanceof J?s.nextNode:s.nextNode.nextValidNodeForTracking),a=!1;_.isNullOrUndefined(s)||a||(s.removedIds.push(n),this.constructRevisionFromID(s,!0))}else s.removedIds.push(n),this.constructRevisionFromID(s,!0);r&&(e.characterFormat.removedIds.push(n),this.constructRevisionFromID(e.characterFormat,!0))},o.prototype.insertBlockTable=function(e,t,i){var n=e.start.offset,n=(e.start.paragraph.childWidgets.indexOf(e.start.currentWidget),t instanceof G&&0<n&&(this.moveInlines(e.start.paragraph,t,0,0,e.start.paragraph.firstChild,n,e.start.currentWidget),e.selectParagraphInternal(e.start.paragraph,!0),this.checkInsertPosition(e))&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(t,n.toString()),!0),0<n&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.start,!0),i.indexInOwner);i.containerWidget.childWidgets.splice(n,0,t),t.containerWidget=i.containerWidget,t.index=i.index,this.updateNextBlocksIndex(t,!0),t instanceof G&&this.constructRevisionsForBlock(t,!0),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.checkInsertPosition(e)&&(n=void 0,t instanceof G&&(n=t),t instanceof K&&(n=this.documentHelper.getFirstParagraphInFirstCell(t)),this.updateHistoryPosition(this.selection.getHierarchicalIndex(n,"0"),!0))},o.prototype.handleCut=function(e){var t=e.start,i=e.end,n=(e.isForward||(t=e.end,i=e.start),t.paragraph===i.paragraph&&t.offset+1===i.offset&&t.paragraph.getInline(i.offset,0).element,this.checkAndRemoveComments()),r=this.selection.getParagraphInfo(t),r=(e.editPosition=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),this.initHistory("Cut"),e.owner.isShiftingEnabled=!0,this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.editPosition,!0),this.deleteSelectedContent(i.paragraph,e,t,i,3),new y(e.owner));this.setPositionForCurrentIndex(r,e.editPosition),e.selectContent(r,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e),this.updateHistoryForComments(n)},o.prototype.insertInlineInternal=function(e,t){var i,n=this.selection,r=e.length,o=this.selection.getParagraphInfo(n.start),s=(t=_.isNullOrUndefined(t)?"Insertion":t,n.start.paragraph.isEmpty()?("Center"!==(s=n.start.paragraph).paragraphFormat.textAlignment&&"Right"!==s.paragraphFormat.textAlignment||-1!==s.paragraphFormat.listFormat.listId||(s.x=this.owner.viewer.clientActiveArea.x),i=!_.isNullOrUndefined(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing),s.childWidgets[0].children.push(e),e.line=s.childWidgets[0],this.owner.enableTrackChanges&&e.isValidNodeForTracking&&!i&&this.insertRevision(e,t),(0<e.removedIds.length||i)&&this.constructRevisionFromID(e,!0),e.linkFieldCharacter(this.documentHelper),e instanceof Bh&&(this.constructRevisionForFootnote(e,!0),i&&(e.isLayout=!1),"Footnote"===e.footnoteType&&this.updateFootnoteCollection(e),"Endnote"===e.footnoteType)&&this.updateEndnoteCollection(e),this.documentHelper.layout.reLayoutParagraph(s,0,0,void 0,void 0)):(n=(s=n.start.currentWidget.getInline(n.start.offset,i=0)).element,i=s.index,this.insertElementInternal(n,e,i,t,!0)),e.revisions[0]);_.isNullOrUndefined(s)||this.owner.trackChangesPane.updateCurrentTrackChanges(s),this.setPositionParagraph(o.paragraph,o.offset+r,!0)},o.prototype.insertElement=function(e,t){var i=!1,n=this.selection,r=0,o=void 0,s=-1,a=void 0,l=0,d=void 0,h=this.selection.getParagraphInfo(n.start),c=this.owner.enableTrackChanges,p=void 0,u=void 0,g=0;n.start.paragraph.isEmpty()?(a=(o=n.start.paragraph).childWidgets[0],s=0):(p=(n=n.start.currentWidget.getInline(n.start.offset,g)).element,g=n.index,s=(o=p.line.paragraph).childWidgets.indexOf(p.line),l=p.indexInOwner,a=p.line,g===p.length?(l++,d=!1):0===g?(_.isNullOrUndefined(p.previousNode)&&(l=0),d=!0):(l++,(u=new X).characterFormat.copyFormat(p.characterFormat),u.text=p.text.substring(g),p.text=p.text.slice(0,g),p.isWidthUpdated=!1,0<p.revisions.length&&!this.owner.enableTrackChanges&&this.splitRevisionForSpittedElement(p,u),a.children.splice(l,0,u),u.line=p.line));for(var m=0;m<e.length;m++){r+=e[m].length,e[m]instanceof X&&0<=e[m].text.indexOf(" ")&&(this.documentHelper.triggerSpellCheck=!0);var f=e[m].revisions.length,y=(e[m].ischangeDetected=!0,a.children.splice(l,0,e[m]),e[m].line=a,e[m].linkFieldCharacter(this.documentHelper),this.updateRevisionForElement(p,e[m],g,0===m,u,d));c&&!y&&e[m].revisions.length===f&&this.checkToCombineRevisionsinBlocks(e[m],f===e[m].revisions.length,0<m&&m===e.length-1,"Insertion"),p=e[m],l++,e[m]instanceof Bh&&(this.pasteFootNoteType=e[m].footnoteType,i=!0)}if(!this.isPaste&&t&&(_.isNullOrUndefined(o.paragraphFormat.listFormat.list)||!_.isNullOrUndefined(o.paragraphFormat.listFormat)&&-1===o.paragraphFormat.listFormat.listId)&&o.paragraphFormat.copyFormat(t),this.isPaste){if(this.isRemoteAction)for(var v=t.ownerBase.characterFormat.revisions,w=!1,m=0;m<v.length;m++){o.characterFormat.revisions.push(v[m]);for(var b=v[m].range,x=0;x<b.length;x++)if(b[x]instanceof B&&b[x]==t.ownerBase.characterFormat){b.splice(x,1),b.push(o.characterFormat),w=!0;break}if(w)break}this.viewer.updateClientAreaForBlock(o,!0),o.x=this.viewer.clientActiveArea.x}return this.documentHelper.layout.reLayoutParagraph(o,s,0,this.isInsertField?void 0:o.paragraphFormat.bidi),this.setPositionParagraph(h.paragraph,h.offset+r,!0),i},o.prototype.updateRevisionForElement=function(e,t,i,n,r,o){if(this.owner.enableTrackChanges&&(!_.isNullOrUndefined(e)||!_.isNullOrUndefined(r))){var s=!!_.isNullOrUndefined(o),a=t.revisions.length;if(!n)return this.insertRevisionAtEnd(e,t,"Insertion");if(!s)return o?this.insertRevisionAtBegining(e,t,"Insertion"):this.insertRevisionAtEnd(e,t,"Insertion");this.checkToMapRevisionWithInlineText(e,i,t,!1,"Insertion")||t.revisions.length>a?this.copyElementRevision(e,r,!0):0===t.revisions.length&&(this.splitRevisionForSpittedElement(e,r),this.insertRevision(t,"Insertion"))}return!1},o.prototype.insertElementInternal=function(e,t,i,n,r){var o=e.line,s=o.paragraph,a=o.indexInOwner,l=e.indexInOwner,d=s.paragraphFormat.bidi&&e.isRightToLeft,h=!1,c=(n=_.isNullOrUndefined(n)?"Insertion":n,this.skipTracking()),p=this.owner.enableTrackChanges,u=!1,g=t.revisions.length;(h=this.owner.editorHistoryModule&&(this.owner.editorHistoryModule.isUndoing||this.owner.editorHistoryModule.isRedoing)&&t instanceof X?e.characterFormat.isEqualFormat(t.characterFormat)&&this.documentHelper.textHelper.isRTLText(t.text):h)?(e.text=e.text.substring(0,i)+t.text+e.text.substring(i),e.isWidthUpdated=!1):i===e.length?(l=this.incrementCommentIndex(d,e,l),0<t.removedIds.length||c?this.constructRevisionFromID(t,!0,e):!p||c||this.skipFieldDeleteTracking||(u=this.insertRevisionAtEnd(e,t,n)),t instanceof Bh&&(0<t.revisions.length&&(this.footnoteRevision=t.revisions[0]),this.constructRevisionForFootnote(t,!0),this.footnoteRevision=void 0),o.children.splice(l,0,t),t instanceof Z&&2===t.fieldType&&this.constructRevisionnsForLink(t,!1)):0===i?(0<t.removedIds.length?this.constructRevisionFromID(t,!1,void 0,l):!p||c||this.skipFieldDeleteTracking||(u=this.insertRevisionAtBegining(e,t,n)),_.isNullOrUndefined(e.previousNode)?(e.line.children.splice(0,0,t),l=0):e.line.children.splice(l,0,t)):this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.isHyperlinkField&&t instanceof Z&&1===t.fieldType&&0<t.removedIds.length?(this.constructRevisionFromID(t,!1),o.children.splice(l,0,t)):(l=this.incrementCommentIndex(d,e,l),(h=new X).characterFormat.copyFormat(e.characterFormat),h.text=e.text.substring(i),0<e.revisions.length&&!p&&!c&&0===t.removedIds.length&&this.splitRevisionForSpittedElement(e,h),e.text=e.text.substr(0,i),e.isWidthUpdated=!1,o.children.splice(l,0,h),h.line=e.line,u=!0,this.isTrackingFormField=e.previousElement instanceof Z,0<t.removedIds.length&&!this.isTrackingFormField?(this.constructRevisionFromID(t,!1),this.copyElementRevision(e,h,!0)):this.owner.enableTrackChanges&&(t instanceof J||t instanceof up||t instanceof Wc||t instanceof Sc?t instanceof up?(this.splitRevisionForSpittedElement(e,h),this.copyElementRevision(e,t,!1)):this.copyElementRevision(e,h,!1):this.checkToMapRevisionWithInlineText(e,i,t,d,n)||t.revisions.length>g?this.copyElementRevision(e,h,!0):t.revisions.length===g&&(this.splitRevisionForSpittedElement(e,h),this.insertRevision(t,n))),o.children.splice(l,0,t),--l),t.line=e.line,t instanceof J&&(d=this.documentHelper.bookmarks,t.reference&&(t.reference.reference=t),d.containsKey(t.name)||d.add(t.name,t)),!_.isNullOrUndefined(t.line.paragraph.containerWidget)&&!_.isNullOrUndefined(t.line.paragraph.containerWidget.containerWidget)&&t.line.paragraph.containerWidget.containerWidget instanceof q&&(t.line.paragraph.containerWidget.containerWidget.height+=t.height),t.linkFieldCharacter(this.documentHelper),t instanceof E&&0===t.type&&(this.documentHelper.contentControlCollection.push(t),this.owner.editorHistoryModule)&&(this.owner.editorHistoryModule.isUndoing||this.owner.editorHistoryModule.isRedoing)&&this.updatePropertiesToBlock(t,!0),(t instanceof Ic&&"Inline"!==t.textWrappingStyle||t instanceof uc)&&(-1===s.floatingElements.indexOf(t)&&s.floatingElements.push(t),-1===s.bodyWidget.floatingElements.indexOf(t))&&"Inline"!==t.textWrappingStyle&&s.bodyWidget.floatingElements.push(t),!p||u||c||this.skipFieldDeleteTracking||this.checkToCombineRevisionsinBlocks(t,g===t.revisions.length,i===e.length,n),t instanceof Bh&&(c&&(t.isLayout=!1),"Footnote"===t.footnoteType&&(this.updateFootnoteCollection(t),this.updateFootNoteIndex()),"Endnote"===t.footnoteType)&&(this.updateEndnoteCollection(t),this.updateEndNoteIndex()),t instanceof up||this.combineElementRevisionToPrevNxt(t),r&&this.documentHelper.layout.reLayoutParagraph(s,a,l,void 0,void 0)},o.prototype.incrementCommentIndex=function(e,t,i){return this.owner.editorHistoryModule&&this.owner.editorHistoryModule&&this.owner.editorHistoryModule.currentHistoryInfo&&(!this.owner.editorHistoryModule||!this.owner.editorHistoryModule.currentHistoryInfo||"SkipCommentInline"===this.owner.editorHistoryModule.currentHistoryInfo.action&&("SkipCommentInline"!==this.owner.editorHistoryModule.currentHistoryInfo.action||this.owner.editorHistoryModule.currentHistoryInfo.modifiedActions[0]!==this.editorHistory.currentBaseHistoryInfo&&(this.owner.editorHistoryModule.currentHistoryInfo.modifiedActions[0]===this.editorHistory.currentBaseHistoryInfo||t instanceof up)))||i++,i},o.prototype.constructRevisionFromID=function(e,t,i,n){if(0<e.removedIds.length){for(var r=0;r<e.removedIds.length;r++){var o=void 0;if(this.documentHelper.revisionsInternal.containsKey(e.removedIds[r])){o=this.documentHelper.revisionsInternal.get(e.removedIds[r]),e.revisions.push(o),_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(e,void 0,o));var s=e instanceof Z&&0===e.fieldType,s=(t=!!t||!s&&this.skipTracking(),!1);if(this.editorHistory.isUndoing&&this.owner.editorHistoryModule.currentBaseHistoryInfo&&this.owner.editorHistoryModule.currentBaseHistoryInfo.isHyperlinkField&&"Accept Change"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action&&e instanceof Z&&1===e.fieldType&&(s=!0),t&&(this.editorHistory.isRedoing&&this.owner.editorHistoryModule.currentBaseHistoryInfo&&"BackSpace"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action&&this.selection.isTOC()&&(t=!1),this.editorHistory.isRedoing)&&this.owner.editorHistoryModule.currentHistoryInfo&&"RemoveHyperlink"===this.owner.editorHistoryModule.currentHistoryInfo.action&&e instanceof Z&&0===e.fieldType&&(t=!1),!_.isNullOrUndefined(n)&&0<o.range.length&&o.range[o.range.length-1]instanceof X&&o.range[o.range.length-1].paragraph.indexInOwner===this.selection.start.paragraph.indexInOwner)o.range.splice(n,0,e);else if(_.isNullOrUndefined(i)){var a=void 0;if(!_.isNullOrUndefined(this.owner.editorHistory)&&(this.owner.editorHistory.isUndoing||this.owner.editorHistory.isRedoing)&&!(e instanceof Ya)){for(var l=this.owner.selectionModule.start.paragraph.index,d=this.owner.selectionModule.start.paragraph.isInsideTable,h=(e instanceof B&&e.ownerBase?l=e.ownerBase.index:e instanceof X&&e.paragraph&&d&&(l=e.paragraph.index),0),c=0;c<o.range.length;c++)if(o.range[c]instanceof X?h=o.range[c].paragraph.index:o.range[c]instanceof B&&(h=o.range[c].ownerBase.index),l<h){a=c;break}t&&l===h&&_.isNullOrUndefined(a)&&0<o.range.length&&o.range[o.range.length-1]instanceof B&&(a=o.range.length-1)}_.isNullOrUndefined(a)&&(a=t?o.range.length:0),o.range.splice(a,0,e)}else{d=o.range.indexOf(i);0<=(d=-1===d&&s&&0<o.range.length?o.range.indexOf(o.range[o.range.length-1]):d)?o.range.splice(d+(t?1:0),0,e):o.range.splice(0,0,e)}this.owner.trackChangesPane.updateCurrentTrackChanges(o),this.updateRevisionCollection(o)}}e.removedIds=[]}else for(r=0;r<e.revisions.length;r++){var p=e.revisions[r];this.documentHelper.revisionsInternal.containsKey(p.revisionID)&&((p=this.documentHelper.revisionsInternal.get(p.revisionID)).range.splice(t?p.range.length:0,0,e),this.updateRevisionCollection(p))}},o.prototype.insertBlock=function(e){var t=!0,i=!1,n=this.selection;n.isEmpty||(t=this.removeSelectedContents(n),i=!0),t||n.selectContent(n.start,!1),this.insertBlockInternal(e,i),this.checkInsertPosition(n)&&(t=void 0,t=e instanceof G?e:this.documentHelper.getFirstParagraphInFirstCell(e),this.updateHistoryPosition(this.selection.getHierarchicalIndex(t,"0"),!0)),this.fireContentChange()},o.prototype.insertBlockInternal=function(e,t){var i=this.selection,n=this.selection.start.paragraph,r=this.selection.start.isAtParagraphStart;if(!i.start.isAtParagraphStart){if(e instanceof G)return o=i.start.clone(),this.isInsertingTOC||!this.owner.enableTrackChanges||this.skipTracking()||this.insertRevisionForBlock(e,"Insertion"),_.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(e.clone()),this.insertNewParagraphWidget(e,!1),void(this.isInsertingTOC||this.combineRevisions(e,o,this.selection.end));this.updateInsertPosition(),n=n.combineWidget(this.owner.viewer),_.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(n),this.splitParagraph(n,n.firstChild,0,i.start.currentWidget,i.start.offset,!1),i.selectParagraphInternal(this.selection.start.paragraph,!0)}var o=i.start.paragraph.containerWidget,n=i.start.paragraph.index;_.isNullOrUndefined(o)||!_.isNullOrUndefined(this.editorHistory)&&(_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(e.clone()),this.editorHistory.isRedoing)&&t&&o.firstChild instanceof G&&o.firstChild.isEmpty()&&o.firstChild===o.lastChild&&e instanceof G&&e.isEmpty()||(t=o.childWidgets.indexOf(i.start.paragraph),i.start.paragraph.isEmpty()&&i.start.paragraph.index===e.index&&1===o.childWidgets.length&&i.start.paragraph.containerWidget.containerWidget instanceof q&&this.owner.editorHistory.isUndoing&&o.childWidgets.splice(0,1),o.childWidgets.splice(t,0,e),e.containerWidget=o,e.index=n,e.height=0,e instanceof K&&(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0),this.updateNextBlocksIndex(e,!0),!this.isInsertingTOC&&this.owner.enableTrackChanges&&!this.skipTracking()&&e instanceof G?this.insertRevisionForBlock(e,"Insertion"):e instanceof G?this.constructRevisionsForBlock(e,!0):e instanceof K&&this.constructRevisionsForTable(e,!0),this.documentHelper.owner.editorModule.isRemoteAction&&!r&&e instanceof K&&(this.updateNextBlocksIndex(e.nextWidget,!1),o.childWidgets.splice(e.indexInOwner+1,1)),e instanceof G&&this.documentHelper.layout.linkFieldInParagraph(e),this.isPaste&&!_.isNullOrUndefined(e.previousWidget)&&e.previousWidget instanceof G&&e instanceof G&&e.paragraphFormat.contextualSpacing&&this.documentHelper.layout.reLayoutParagraph(e.previousWidget,0,0),this.documentHelper.layout.layoutBodyWidgetCollection(n,o,e,!1))},o.prototype.insertImage=function(e,t,i,n){this.insertImageInternal(e,!1,t,i,n)},o.prototype.insertImageAsync=function(t,i,n,r){return Xg(this,void 0,void 0,function(){return Jg(this,function(e){switch(e.label){case 0:return[4,this.insertImageInternal(t,!1,i,n,r)];case 1:return e.sent(),[2]}})})},o.prototype.insertImageInternal=function(o,s,a,l,d){return Xg(this,void 0,void 0,function(){var r=this;return Jg(this,function(e){return[2,new Promise(function(e,t){var i,n=r.selection.getCurrentFormField(),n="FormFieldsOnly"===r.documentHelper.protectionType&&!_.isNullOrUndefined(n)&&n.formFieldData instanceof Ch;!r.owner.isReadOnlyMode&&r.canEditContentControl||n?(_.isNullOrUndefined(a)&&_.isNullOrUndefined(l)?(n=document.createElement("img"),i=r,n.addEventListener("load",function(){i.insertPicture(o,this.width,this.height,this.alt,!0),e()}),n.src=o):(r.insertPicture(o,a,l,d,s),e()),setTimeout(function(){_.isNullOrUndefined(r.documentHelper)||r.viewer.updateScrollBars()},30)):e()})]})})},o.prototype.insertTable=function(e,t){var i,n,r=this.selection.start;this.owner.isReadOnlyMode||!this.canEditContentControl||this.selection.isPlainContentControl()||(e=e||1,t=t||1,(i=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.documentHelper.owner.locale),t<1||t>this.documentHelper.owner.documentEditorSettings.maximumColumns?(n=i.getConstant("Number of columns must be between")+" 1 "+i.getConstant("and")+" "+this.documentHelper.owner.documentEditorSettings.maximumColumns.toString(),C.DialogUtility.alert(n).enableRtl=this.documentHelper.owner.enableRtl):e<1||e>this.documentHelper.owner.documentEditorSettings.maximumRows?(n=i.getConstant("Number of rows must be between")+" 1 "+i.getConstant("and")+" "+this.documentHelper.owner.documentEditorSettings.maximumColumns.toString(),i.getConstant("Number of rows must be between 1 and 32767.").replace("32767",this.documentHelper.owner.documentEditorSettings.maximumRows.toString()),C.DialogUtility.alert(n).enableRtl=this.documentHelper.owner.enableRtl):(i=this.createTable(e,t),n=r.paragraph.getContainerWidth()-i.tableFormat.leftIndent,i.splitWidthToTableCells(n),e=r.paragraph.previousWidget,r.currentWidget.isFirstLine()&&0===r.offset&&e instanceof K?(this.insertTableRows(i,e),i.destroy()):(t=this.checkAndRemoveComments(),this.initHistory("InsertTable"),this.documentHelper.owner.isShiftingEnabled=!0,this.insertBlock(i),!_.isNullOrUndefined(i.containerWidget)&&!_.isNullOrUndefined(i.containerWidget.containerWidget)&&i.containerWidget.containerWidget instanceof q&&(i.containerWidget.containerWidget.height+=i.height,this.isTableInsert=!0),n=this.documentHelper.getFirstParagraphInFirstCell(i).childWidgets[0],r.setPosition(n,!0),this.selection.end.setPositionInternal(r),n=(e=this.documentHelper.getLastParagraphInLastCell(i.getSplitWidgets().pop())).getLength()+1,this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(e,n.toString())),this.reLayout(this.selection),this.isTableInsert=!1,this.updateHistoryForComments(t))))},o.prototype.insertRow=function(e,t){var i,n,r,o,e=e?"Above":"Below";!this.owner.isReadOnlyMode&&this.canEditContentControl&&(i=this.selection.isForward?this.selection.start:this.selection.end,this.selection.isForward?this.selection.end:this.selection.start,i.paragraph.isInsideTable&&(this.checkIsNotRedoing()&&this.initHistory("Above"==e?"InsertRowAbove":"InsertRowBelow"),this.documentHelper.owner.isShiftingEnabled=!0,i=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],n=this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0],r=i.ownerTable.combineWidget(this.owner.viewer),o=("Below"==e?n:i).ownerRow,this.editorHistory&&this.cloneTableToHistoryInfo(r),this.rowInsertion(t,e,i,n,o,r,!0)),this.reLayout(this.selection,!0))},o.prototype.rowInsertion=function(e,t,i,n,r,o,s){var a=e||this.getRowCountToInsert(),l=[],d=r.rowIndex;"Below"===t&&(d++,e=_.isNullOrUndefined(n.previousWidget)||n.columnIndex===n.previousWidget.columnIndex+1,n.cellIndex!==n.columnIndex&&e&&r.rowIndex+i.cellFormat.rowSpan-1===n.ownerRow.rowIndex||1<n.cellFormat.rowSpan&&!_.isNullOrUndefined(r.nextWidget)&&r.nextWidget instanceof dh&&(n.cellFormat.rowSpan+=a,r=r.nextWidget),r.bottomBorderWidth=0);for(var h=0;h<a;h++){var c=this.updateRowspan(r,"Below"===t?n:i,t),p=this.createRowAndColumn(c.count,h,d,o);p.rowFormat=r.rowFormat.cloneFormat(),p.rowFormat.ownerBase=p,this.owner.enableTrackChanges&&this.insertRevision(p.rowFormat,"Insertion"),this.updateCellFormatForInsertedRow(p,c.cellFormats),!_.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(p),l.push(p)}o.insertTableRowsInternal(l,d,s);var u,e=void 0;if(o.childWidgets[d]instanceof dh)u=o.childWidgets[d].firstChild,e=this.selection.getFirstParagraph(u);else{for(var g=void 0;!(g instanceof K);)g=o.nextRenderedWidget;e=this.documentHelper.getFirstParagraphInFirstCell(g)}s&&this.documentHelper.layout.reLayoutTable(o),this.selection.selectParagraphInternal(e,!0)},o.prototype.autoFitTable=function(e){!this.documentHelper.owner.isReadOnlyMode&&this.canEditContentControl&&this.insertAutoFitTable(e)},o.prototype.insertAutoFitTable=function(e,t){_.isNullOrUndefined(t)&&(n=this.selection.start,i=this.selection.end,this.selection.isForward||(n=this.selection.end,i=this.selection.start),t=(t=this.selection.getTable(n,i)).getSplitWidgets()[0]);var i,n=this.documentHelper.layout.getParentTable(t);_.isNullOrUndefined(n)||(this.setOffsetValue(this.selection),n=n.combineWidget(this.owner.viewer),this.initHistory("FitToContents"===e?"TableAutoFitToContents":"FitToWindow"===e?"TableAutoFitToWindow":"TableFixedColumnWidth"),this.documentHelper.owner.editorHistoryModule&&this.cloneTableToHistoryInfo(n),n.updateProperties(!0,t,e),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.layout.reLayoutTable(t),this.reLayout(this.selection,!0))},o.prototype.rowInsertionForCE=function(e,t,i,n,r,o,s,a){for(var l=[],d=0;d<i;d++){var h=this.createRowAndColumn(t,d,e,n);this.documentHelper.owner.parser.parseRowFormat(r,h.rowFormat,0);for(var c=0;c<t;c++){var p=h.childWidgets[c];this.documentHelper.owner.parser.parseCellFormat(o[c],p.cellFormat,0),this.documentHelper.owner.parser.parseParagraphFormat(0,s[c],p.childWidgets[0].paragraphFormat),this.documentHelper.owner.parser.parseCharacterFormat(0,a[c],p.childWidgets[0].characterFormat)}this.owner.enableTrackChanges&&this.insertRevision(h.rowFormat,"Insertion"),l.push(h)}n.insertTableRowsInternal(l,e,!0);var u,g=void 0;if(n.childWidgets[e]instanceof dh)u=n.childWidgets[e].firstChild,g=this.selection.getFirstParagraph(u);else{for(var m=void 0;!(m instanceof K);)m=n.nextRenderedWidget;g=this.documentHelper.getFirstParagraphInFirstCell(m)}this.documentHelper.layout.reLayoutTable(n),this.selection.selectParagraphInternal(g,!0),this.reLayout(this.selection,!0)},o.prototype.updateCellFormatForInsertedRow=function(e,t){for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i].cellFormat.copyFormat(t[i]),e.childWidgets[i].cellFormat.rowSpan=1},o.prototype.updateRowspan=function(e,t,i){for(var n=e.getPreviousRowSpannedCells(!0),r=0,o=[],s=0;s<e.childWidgets.length;s++){for(var a,l,d=e.childWidgets[s],h=!1,c=_.isNullOrUndefined(d.previousWidget)||d.columnIndex!==d.previousWidget.columnIndex+1,p=0;p<n.length;p++)c&&(l=(a=n[p]).ownerRow.rowIndex+a.cellFormat.rowSpan-1,d.columnIndex<a.columnIndex&&d.cellIndex!==d.columnIndex&&!h&&(h=!0,r++,o.push(d.cellFormat)),1===t.cellFormat.rowSpan?l>d.ownerRow.rowIndex?"Above"===i&&a.ownerRow===t.ownerRow||(a.cellFormat.rowSpan+=1,n.splice(p,1),p--):d.cellIndex!==d.columnIndex&&c&&l===d.ownerRow.rowIndex&&("Above"===i?a.cellFormat.rowSpan+=1:(r++,o.push(a.cellFormat)),n.splice(p,1),p--):a!==t&&("Above"!==i||a.ownerRow!==t.ownerRow&&a.columnIndex!==t.columnIndex)&&a.columnIndex!==t.columnIndex&&a.ownerRow.rowIndex!==d.ownerRow.rowIndex&&(l>t.ownerRow.rowIndex||"Above"===i&&l===t.ownerRow.rowIndex)&&(a.cellFormat.rowSpan+=1,n.splice(p,1),p--));(h=-1===n.indexOf(d)&&1<d.cellFormat.rowSpan?!0:h)||(r++,o.push(d.cellFormat))}return o.sort(function(e,t){return e.ownerBase.columnIndex-t.ownerBase.columnIndex}),{count:r,cellFormats:o}},o.prototype.getInsertedTable=function(e,t){e.childWidgets&&0<e.childWidgets.length&&(e.childWidgets.splice(0,t),this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(e))},o.prototype.insertTableRows=function(e,t){this.initHistory("InsertTableBelow"),e.containerWidget=t.containerWidget;var i=(t=t.combineWidget(this.owner.viewer)).childWidgets[t.childWidgets.length-1],n=t.childWidgets.length,e=(t.insertTableRowsInternal(e.childWidgets,n,!0),t.clone()),e=(this.getInsertedTable(e,n),this.selection.getFirstParagraph(i.nextWidget.childWidgets[0]));t.isDefaultFormatUpdated=!1,this.documentHelper.layout.reLayoutTable(t),this.checkInsertPosition(this.selection)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(e,"0"),!0),this.selection.start.setPosition(e.firstChild,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.end,!1),this.selection.end.setPosition(e.firstChild,!0),this.reLayout(this.selection)},o.prototype.insertColumn=function(e,t){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){e=e?"Left":"Right";if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Left"==e?"InsertColumnLeft":"InsertColumnRight"),this.selection.owner.isShiftingEnabled=!0;for(var i=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward),r=i.ownerRow.ownerTable.combineWidget(this.owner.viewer),o=(this.editorHistory&&this.cloneTableToHistoryInfo(r),this.selection.owner.isLayoutEnabled=!1,i.columnIndex),s=("Right"==e&&(o=n.columnIndex+n.cellFormat.columnSpan),void 0),a=void 0,l=t||this.getColumnCountToInsert(),d=[],h=0;h<l;h++)for(var c=0;c<r.childWidgets.length;c++){var p=r.childWidgets[c];(a=this.createColumn(this.selection.getLastParagraph(i))).index=c,a.rowIndex=p.rowIndex,a.containerWidget=p,a.cellFormat.copyFormat(i.cellFormat),a.cellFormat.rowSpan=1,_.isNullOrUndefined(s)&&(s=this.selection.getFirstParagraph(a)),0===o?p.childWidgets.splice(o,0,a):this.insertSpannedCells(p,d,a,o),this.copyCellFormats(p,o),this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(a)}this.tableReLayout(r,s,a)}}},o.prototype.cellInsertionForCE=function(e,t,i,n,r){var o=void 0,o=this.createColumn(void 0),s=new uh(o.childWidgets[0]);o.childWidgets[0].childWidgets.push(s),o.index=t.index,o.rowIndex=t.rowIndex,o.containerWidget=t,this.documentHelper.owner.parser.parseCellFormat(i,o.cellFormat,0),this.documentHelper.owner.parser.parseParagraphFormat(0,n,o.childWidgets[0].paragraphFormat),this.documentHelper.owner.parser.parseCharacterFormat(0,r,o.childWidgets[0].characterFormat),o.cellFormat.rowSpan=1,t.childWidgets.splice(e,0,o)},o.prototype.copyCellFormats=function(e,t){var i=e.childWidgets[t];if(!_.isNullOrUndefined(i)){for(var i=i.childWidgets[0],e=(t==e.childWidgets.length-1?--t:++t,e.childWidgets[t]),n=e.childWidgets[0];n instanceof K;)n=n.childWidgets[0].childWidgets[0].childWidgets[0];var r,t=e.childWidgets[0],e=void 0;0<t.childWidgets.length&&0<(r=t.childWidgets[0]).children.length&&(e=r.children[0]),i.paragraphFormat.copyFormat(t.paragraphFormat),_.isNullOrUndefined(e)?i.characterFormat.copyFormat(t.characterFormat):i.characterFormat.copyFormat(e.characterFormat)}},o.prototype.copyContent=function(e){var t,i;this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.owner.enableCollaborativeEditing&&(i=this.documentHelper.getLastParagraphBlock(e),0===(e=this.documentHelper.getFirstParagraphBlock(e)).childWidgets.length&&(e.childWidgets[0]=new uh(e)),0===i.childWidgets.length&&(i.childWidgets[0]=new uh(i)),e=e.firstChild,t=i.lastChild,i=i.lastChild.getEndOffset(),e=_.isNullOrUndefined(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,e,0,t,i,!1,!0),this.editorHistory.currentBaseHistoryInfo.pasteContent=e)},o.prototype.tableReLayout=function(e,t,i,n){e.updateRowIndex(0);var r=this.documentHelper.layout.getParentTable(e);(r||e).fitChildToClientArea(),this.selection.owner.isLayoutEnabled=!0,e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.skipScrollToPosition=!0,n&&this.copyContent(e),this.documentHelper.layout.reLayoutTable(e),this.selection.start.setPosition(t.firstChild,!0),this.selection.end.setPosition(this.selection.getLastParagraph(i).firstChild,!1),(this.checkIsNotRedoing()||_.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection)},o.prototype.createTable=function(e,t){this.selection.start.paragraph;for(var i=new K,n=(i.tableFormat.preferredWidthType="Auto",i.tableFormat.leftIndent=this.selection.start.paragraph.leftIndent,i.tableFormat.initializeTableBorders(),0);n<e;){var r=this.createRowAndColumn(t,n);r.rowFormat.heightType="Auto",this.owner.enableTrackChanges&&this.insertRevision(r.rowFormat,"Insertion"),(r.containerWidget=i).childWidgets.push(r),n++}return i},o.prototype.createRowAndColumn=function(e,t,i,n){var r=n,o=this.selection.start.paragraph,s=new dh;s.rowFormat=new Ya(s),s.index=t;for(var a=0;a<e;a++){if(!_.isNullOrUndefined(i)&&!_.isNullOrUndefined(r))if(i&&0<i&&r.childWidgets[i-1]&&r.childWidgets[i-1].childWidgets[a]){for(var l=r.childWidgets[i-1].childWidgets[a].childWidgets[0];l instanceof K;)l=l.childWidgets[0].childWidgets[0].childWidgets[0];o=l}else if(0==i){for(l=r.childWidgets[i].childWidgets[a].childWidgets[0];l instanceof K;)l=l.childWidgets[0].childWidgets[0].childWidgets[0];o=l}var d=this.createColumn(o,!0);d.index=a,d.rowIndex=t,(d.containerWidget=s).childWidgets.push(d)}return s},o.prototype.createColumn=function(e,t){var i=new N,n=new G;return t&&(n.paragraphFormat.copyFormat(e.paragraphFormat),n.paragraphFormat.leftIndent=0,t=void(n.paragraphFormat.firstLineIndent=0),_.isNullOrUndefined(e.childWidgets[0])||(t=e.childWidgets[0].children[0]),_.isNullOrUndefined(t)?n.characterFormat.copyFormat(e.characterFormat):n.characterFormat.copyFormat(t.characterFormat)),(n.containerWidget=i).childWidgets.push(n),i.cellFormat=new Tl(i),i},o.prototype.getColumnCountToInsert=function(){var e=1,t=this.selection.start,i=this.selection.end;if(this.selection.isForward||(t=this.selection.end,i=this.selection.start),t&&i&&this.selection.getTable(t,i)){if(t.paragraph.associatedCell===i.paragraph.associatedCell)return 1;if(t.paragraph.associatedCell.ownerRow===i.paragraph.associatedCell.ownerRow)return e+i.paragraph.associatedCell.cellIndex-t.paragraph.associatedCell.cellIndex;for(var e=0,n=t.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(t.paragraph.associatedCell,i.paragraph.associatedCell),r=0;r<n.length;r++)t.paragraph.associatedCell.ownerRow===n[r].ownerRow&&e++}return 0===e?1:e},o.prototype.getRowCountToInsert=function(){var e=1,t=this.selection.start,i=this.selection.end;return this.selection.isForward||(t=this.selection.end,i=this.selection.start),_.isNullOrUndefined(t)||_.isNullOrUndefined(i)||_.isNullOrUndefined(this.selection.getTable(t,i))?0===e?1:e:t.paragraph.associatedCell===i.paragraph.associatedCell||t.paragraph.associatedCell.ownerRow===i.paragraph.associatedCell.ownerRow?1:e+this.getOwnerRow(!this.selection.isForward).rowIndex-this.getOwnerRow(this.selection.isForward).rowIndex},o.prototype.getOwnerCell=function(e){for(var t=void 0,i=(e?this.selection.start:this.selection.end).paragraph.associatedCell,n=(e?this.selection.end:this.selection.start).paragraph.associatedCell,r=(t=i).ownerTable;!_.isNullOrUndefined(r)&&r.containerWidget instanceof N&&r!==n.ownerTable;)r=(t=r.containerWidget).ownerTable;return t},o.prototype.getOwnerRow=function(e){for(var t=(e?this.selection.start:this.selection.end).paragraph.associatedCell.ownerRow,i=(e?this.selection.end:this.selection.start).paragraph.associatedCell.ownerRow,n=t,r=n.ownerTable;!_.isNullOrUndefined(r)&&r.containerWidget instanceof N&&r!==i.ownerTable;)r=(n=r.containerWidget.ownerRow).ownerTable;return n},o.prototype.getOwnerTable=function(e){for(var t=void 0,i=this.selection.start.paragraph.associatedCell.ownerTable,n=this.selection.end.paragraph.associatedCell.ownerTable,t=e?i:n;t.containerWidget instanceof N&&t!==(e?n:i);)t=t.containerWidget.ownerTable;return t},o.prototype.mergeSelectedCellsInTable=function(){var e;this.canMergeCells()&&(this.owner.enableTrackChanges?((e=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.owner.locale),this.alertDialog=C.DialogUtility.alert({title:e.getConstant("UnTrack"),content:e.getConstant("Merge Track"),showCloseIcon:!0,okButton:{text:"Ok",click:this.confirmCellMerge.bind(this)},closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}),this.alertDialog.enableRtl=this.owner.enableRtl):this.confirmCellMerge())},o.prototype.confirmCellMerge=function(){this.checkIsNotRedoing()&&this.initHistory("MergeCells"),this.selection.owner.isShiftingEnabled=!0;var e,t=this.selection.start,i=this.selection.end,n=(this.selection.isForward||(t=this.selection.end,i=this.selection.start),this.getOwnerCell(this.selection.isForward)),r=this.getOwnerCell(!this.selection.isForward),o=this.selection.getContainerCellOf(n,r);o.ownerTable.contains(r)&&!this.selection.containsCell(o,r)&&(e=n.ownerTable.combineWidget(this.owner.viewer),n=this.selection.getSelectedCell(n,o),r=this.selection.getSelectedCell(r,o),o=this.mergeSelectedCells(e,n,r),e=this.selection.getFirstParagraph(o),t.setPosition(e.firstChild,!0),n=this.selection.getLastParagraph(o),i.setPosition(n.lastChild,!1),this.selection.fireSelectionChanged(!1)),(this.checkIsNotRedoing()||_.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection,!1),_.isNullOrUndefined(this.alertDialog)||(this.alertDialog.close(),this.alertDialog=void 0)},o.prototype.mergeSelectedCells=function(e,t,i){this.cloneTableToHistoryInfo(e);this.selection.owner.isLayoutEnabled=!1;for(var n,r=(a=this.selection.getCellLeft(t.ownerRow,t))+t.cellFormat.cellWidth,o=this.selection.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth,o=this.updateSelectedCellsInTable(a,r,o,s),a=o.start,r=o.end,l=e.childWidgets.indexOf(i.ownerRow),d=e.childWidgets.indexOf(t.ownerRow),h=void 0,c=d;c<=l;c++){for(var p,u=e.childWidgets[c],g=0;g<u.childWidgets.length;g++){var m=u.childWidgets[g],f=this.selection.getCellLeft(u,m);if(j.round(a,2)<=j.round(f,2)&&j.round(f,2)<j.round(r,2)){f=m.lastChild;if(f instanceof G&&f.isEmpty()&&m.childWidgets.pop(),_.isNullOrUndefined(h))h=m,n=f;else{c===d&&(h.cellFormat.preferredWidth+=m.cellFormat.preferredWidth,h.cellFormat.columnSpan+=m.cellFormat.columnSpan,this.mergeBorders(h,m));for(var y,v=0;v<m.childWidgets.length;v++)((y=m.childWidgets[v].clone()).containerWidget=h).childWidgets.push(y);u.childWidgets.splice(g,1),m.destroy(),g--;for(var w=this.documentHelper.contentControlCollection.length-1;-1<w;w--){var b=this.documentHelper.contentControlCollection[w];_.isNullOrUndefined(b.contentControlProperties)&&this.documentHelper.contentControlCollection.splice(w)}}}}(0===h.childWidgets.length||1===h.childWidgets.length&&h.childWidgets[0]instanceof K)&&n&&(y=n.clone(),h.childWidgets.push(y),y.containerWidget=h),0===u.childWidgets.length&&(p=e.childWidgets.indexOf(u),u.updateRowBySpannedCells(),e.childWidgets.splice(p,1),u.destroy(),l--,c--)}return!_.isNullOrUndefined(h)&&d<l&&(h.cellFormat.rowSpan=l-d+1),this.updateBlockIndexAfterMerge(h),e.updateRowIndex(0),e.calculateGrid(),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e),this.selection.owner.isLayoutEnabled=!0,h},o.prototype.mergeBorders=function(e,t){var i=void 0,n=null;_.isNullOrUndefined(e.cellFormat.borders)||(i=e.cellFormat.borders),_.isNullOrUndefined(t.cellFormat.borders)||(n=t.cellFormat.borders),_.isNullOrUndefined(i)&&_.isNullOrUndefined(n)||(_.isNullOrUndefined(i)?(i=new qa(e.cellFormat)).copyFormat(n):_.isNullOrUndefined(n)||e.ownerRow.rowIndex===t.ownerRow.rowIndex&&(i.top=e.getBorderBasedOnPriority(i.top,n.bottom),i.bottom=e.getBorderBasedOnPriority(i.bottom,n.bottom)))},o.prototype.updateBlockIndexAfterMerge=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t].index=t},o.prototype.canMergeCells=function(){if(this.selection.isEmpty||!this.selection.start.paragraph.isInsideTable||!this.selection.end.paragraph.isInsideTable)return!1;this.selection.start,this.selection.end;this.selection.isForward||(this.selection.end,this.selection.start);var e=this.getOwnerCell(this.selection.isForward),t=this.getOwnerCell(!this.selection.isForward),i=this.selection.getContainerCellOf(e,t);if(!i.ownerTable.contains(t)||this.selection.containsCell(i,t))return!1;var e=this.selection.getSelectedCell(e,i),t=this.selection.getSelectedCell(t,i),n=1;if(e.ownerRow!==t.ownerRow)return this.canMergeSelectedCellsInTable(e.ownerTable,e,t);for(var r=e.ownerRow.childWidgets.indexOf(e),o=r;o<=e.ownerRow.childWidgets.indexOf(t);o++){var s=e.ownerRow.childWidgets[o],a=s.previousWidget;if(o!==r){if(s.cellFormat.rowSpan!==n)return!1;if(!_.isNullOrUndefined(a)&&s.columnIndex!==a.cellFormat.columnSpan+a.columnIndex)return!1}n=s.cellFormat.rowSpan}return!0},o.prototype.canMergeSelectedCellsInTable=function(e,t,i){for(var n=e.childWidgets.indexOf(i.ownerRow),r=e.childWidgets.indexOf(t.ownerRow),o=(s=this.selection.getCellLeft(t.ownerRow,t))+t.cellFormat.cellWidth,t=this.selection.getCellLeft(i.ownerRow,i),i=t+i.cellFormat.cellWidth,t=this.updateSelectedCellsInTable(s,o,t,i),s=t.start,o=t.end,a=0,l=0,d=!1,h=!1,c=[],p=r;p<=n;p++){for(var u=e.childWidgets[p],g=0,m=0,f=!1,y=0;y<u.childWidgets.length;y++){var v=u.childWidgets[y],w=this.selection.getCellLeft(u,v);if(this.checkCellWithInSelection(s,o,w)){h=d=!1,1<v.cellFormat.rowSpan&&c.push(v),f||(m=g=w,f=!0);var b=v.previousWidget,w=(0!==m&&j.round(m,0)!==j.round(w,0)&&(m=w),m+=j.convertPointToPixel(v.cellFormat.cellWidth),this.checkPrevOrNextCellIsWithinSel(s,o,v,!0)),x=this.checkPrevOrNextCellIsWithinSel(s,o,v,!1),C=0===c.length||1===c.length&&c[0]===v,x=this.checkCurrentCell(c,v,w,x);if(p===n&&!_.isNullOrUndefined(b)&&v.cellFormat.rowSpan>b.cellFormat.rowSpan&&!x)return!1;if(p!==r)for(var I=0;I<c.length;I++){var k=c[I].ownerRow.rowIndex+c[I].cellFormat.rowSpan-1;if(k>=u.rowIndex){if(c[I].columnIndex>v.columnIndex?h=!0:d=!0,p===n&&c[I]!==v&&k>v.ownerRow.rowIndex+v.cellFormat.rowSpan-1)return!1;k!==u.rowIndex||this.checkPrevOrNextCellIsWithinSel(s,o,v,!1)||c.splice(c.indexOf(c[I]),1)}}if(w&&!_.isNullOrUndefined(b)&&C&&v.columnIndex!==b.columnIndex+1&&this.checkCellWidth(v))return!1}}if(p===r)a=g,l=m;else{if(0<m&&0<g&&(!d&&Math.round(a)!==Math.round(g)||!h&&Math.round(l)!==Math.round(m)))return!1;if(p===n)return!0}}return!1},o.prototype.checkCellWidth=function(e){var t=e.previousWidget,i=this.documentHelper.selection.getCellLeft(e.ownerRow,e),e=this.documentHelper.selection.getCellLeft(e.ownerRow,t)+j.convertPointToPixel(t.cellFormat.cellWidth);return j.round(e,2)!==j.round(i,2)},o.prototype.checkCellWithInSelection=function(e,t,i){return j.round(e,2)<=j.round(i,2)&&j.round(i,2)<j.round(t,2)},o.prototype.checkPrevOrNextCellIsWithinSel=function(e,t,i,n){n=n?i.previousWidget:i.nextWidget;return!_.isNullOrUndefined(n)&&(i=this.documentHelper.selection.getCellLeft(n.ownerRow,n),this.checkCellWithInSelection(e,t,i))},o.prototype.checkCurrentCell=function(e,t,i,n){var r=t.ownerRow;if(0<e.length)for(var o=0;o<e.length;o++){var s=e[o].ownerRow,a=s.rowIndex+e[o].cellFormat.rowSpan-1;if(e[o]===t&&(1===e.length||this.checkRowSpannedCells(e,t))&&!n&&!i)return!0;if(e[o]!==t&&s.rowIndex<r.rowIndex&&a==r.rowIndex+t.cellFormat.rowSpan-1)return!0}return!1},o.prototype.checkRowSpannedCells=function(e,t){for(var i=0;i<e.length;i++)if(e[i]!==t&&e[i].columnIndex===t.columnIndex)return!0;return!1},o.prototype.insertNewParagraphWidget=function(e,t){if(this.updateInsertPosition(),this.insertParagraph(e,t),!t){for(var i=void 0,n=e;n=i=this.selection.getNextParagraphBlock(n),i&&i.equals(e););_.isNullOrUndefined(i)?this.selection.selectParagraphInternal(e,!0):this.selection.selectParagraphInternal(i,!0)}this.fireContentChange()},o.prototype.insertParagraph=function(e,t){var i=this.selection.start.currentWidget,n=this.selection.start.offset;this.editorHistory&&this.editorHistory.isUndoing&&this.editorHistory.currentBaseHistoryInfo&&"InsertTextParaReplace"===this.editorHistory.currentBaseHistoryInfo.action&&(n=0);var r=(r=this.selection.start.paragraph).combineWidget(this.owner.viewer);if(t){var o=this.selection.getLineLength(r.lastChild),s=e.firstChild?e.firstChild.children.length:0;this.moveInlines(r,e,s,n,i,o,r.lastChild)}else if(0<n){s=r.getLength();if(this.moveInlines(r,e,0,0,r.firstChild,n,i),s===n&&0<r.characterFormat.revisions.length)for(;0<r.characterFormat.revisions.length;)e.characterFormat.revisions.push(r.characterFormat.revisions.shift())}o=r.getSplitWidgets(),i=(r=t?o[o.length-1]:o[0]).containerWidget.childWidgets.indexOf(r),t&&i++,s=r.containerWidget;e.index=r.index,(e.containerWidget=s).childWidgets.splice(i,0,e),this.constructRevisionsForBlock(e,!0),this.updateNextBlocksIndex(t?r:e,!0),e.height=0,e instanceof G&&this.documentHelper.layout.linkFieldInParagraph(e),this.documentHelper.layout.layoutBodyWidgetCollection(e.index,s,e,!1)},o.prototype.moveInlines=function(e,t,i,n,r,o,s,a){0===t.childWidgets.length&&(l=new uh(t),t.childWidgets.push(l));var l,d=!1;this.documentHelper.layout.clearListElementBox(e),this.documentHelper.layout.clearListElementBox(t);for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[h];if(r===c&&s===c){i=this.moveContent(c,n,o,i,t);break}if(s===c){i=this.moveContent(c,0,o,i,t);break}r===c?(d=!0,i=this.moveContent(c,n,this.documentHelper.selection.getLineLength(c),i,t)):d&&(i=this.moveContent(c,0,this.documentHelper.selection.getLineLength(c),i,t))}this.removeEmptyLine(e),e.isInsideTable||a||(this.viewer.updateClientArea(e.bodyWidget,e.bodyWidget.page),this.documentHelper.layout.reLayoutParagraph(e,0,0))},o.prototype.moveContent=function(e,t,i,n,r){for(var o=0,s=0;s<e.children.length;s++){var a=e.children[s];if(t>=o+a.length||a instanceof Y)a instanceof Y||(o+=a.length);else{var l,d=0,h=i-o;if(h>a.length&&(h=a.length),0<(d=o<t?t-o:d)&&(o+=d),0===d&&h===a.length?(a instanceof hc&&-1!==(l=e.paragraph.floatingElements.indexOf(a))&&e.paragraph.floatingElements.splice(l,1),r.firstChild.children.splice(n,0,a),a.line=r.firstChild,n++,e.children.splice(s,1),s--):a instanceof X&&((l=new X).characterFormat.copyFormat(a.characterFormat),l.text=a.text.substr(d,h-d),a.ischangeDetected=!0,l.ischangeDetected=!0,r.firstChild.children.splice(n,0,l),l.line=r.firstChild,n++,this.updateRevisionForMovedContent(a,l),a.text=a.text.slice(0,d)+a.text.slice(h),a.isWidthUpdated=!1,a.ischangeDetected=!0),i<=o+h-d)break;o+=h-d}}return n},o.prototype.updateRevisionForMovedContent=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=n.range.indexOf(e);t.revisions.splice(0,0,n),n.range.splice(r,0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(n)}},o.prototype.updateComplexWithoutHistory=function(e,t,i){var n,r=this.documentHelper.selection;0===e&&(n=new y(r.owner),this.setPositionForCurrentIndex(n,t),this.documentHelper.layout.reLayoutParagraph(n.paragraph,0,0),this.setPositionForCurrentIndex(r.start,i),this.setPositionForCurrentIndex(r.end,i)),1===e&&(n=new y(r.owner),this.setPositionForCurrentIndex(n,t),e=new y(r.owner),this.setPositionForCurrentIndex(e,i),this.documentHelper.layout.reLayoutParagraph(n.paragraph,0,0),e.paragraph!==n.paragraph)&&this.documentHelper.layout.reLayoutParagraph(e.paragraph,0,0),r.owner.isShiftingEnabled&&(this.documentHelper.layout.shiftLayoutedItems(!1),this.documentHelper.owner.enableHeaderAndFooter)&&this.updateHeaderFooterWidget(),r.owner.isShiftingEnabled=!1,r.start.updatePhysicalPosition(!0),r.isEmpty?r.end.setPositionInternal(r.start):r.end.updatePhysicalPosition(!0),r.upDownSelectionLength=r.end.location.x,r.fireSelectionChanged(!0),this.documentHelper.updateFocus(),this.owner.viewer.updateScrollBars(),this.fireContentChange(),this.isHandledComplex=!0},o.prototype.reLayout=function(e,t,i){var n,r,o;_.isNullOrUndefined(this.previousBlockToLayout)||(n=this.previousBlockToLayout,this.documentHelper.layout.layoutBodyWidgetCollection(n.index,n.bodyWidget,n,!1,!1),this.previousBlockToLayout=void 0),!this.documentHelper.isComposingIME&&this.editorHistory&&this.editorHistory.isHandledComplexHistory()&&(this.editorHistory.currentHistoryInfo&&"ClearFormat"!==this.editorHistory.currentHistoryInfo.action&&"ApplyStyle"!==this.editorHistory.currentHistoryInfo.action&&("DragAndDropContent"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.layout.shiftLayoutedItems(!0),this.startParagraph=void 0,this.endParagraph=void 0),this.isHandledComplex=!1,!this.editorHistory.currentHistoryInfo||"ColumnBreak"!==this.editorHistory.currentHistoryInfo.action&&"PageBreak"!==this.editorHistory.currentHistoryInfo.action)||(_.isNullOrUndefined(e.editRegionHighlighters)||e.editRegionHighlighters.clear(),_.isNullOrUndefined(this.documentHelper.blockToShift)&&(this.documentHelper.removeEmptyPages(),this.documentHelper.layout.updateFieldElements(),this.documentHelper.layout.checkAndShiftEndnote(!0),this.selection.contentControleditRegionHighlighters.clear(),this.selection.onHighlightContentControl(),this.documentHelper.owner.enableHeaderAndFooter||this.owner.viewer.updateScrollBars(),e.owner.isShiftingEnabled&&!this.documentHelper.isRowOrCellResizing||(e.fireSelectionChanged(!0),this.startParagraph=void 0,this.endParagraph=void 0)),_.isNullOrUndefined(t)&&(t=e.isEmpty),this.owner.showRevisions&&this.owner.trackChangesPane.isUpdateTrackChanges(this.owner.revisions.length)&&this.owner.trackChangesPane.updateTrackChanges(),e.owner.isShiftingEnabled?(e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0,n=(t=(n=e.start.paragraph.bodyWidget).getSplitWidgets())[t.length-1],t=!!(this.editorHistory&&this.editorHistory.currentHistoryInfo&&"ColumnBreak"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.layout.isMultiColumnDoc),"Word2010"!==this.documentHelper.compatibilityMode||!(n.isWord2010NextColumn||!_.isNullOrUndefined(n.nextRenderedWidget)&&(n.nextRenderedWidget.isWord2010NextColumn||1<n.nextRenderedWidget.sectionFormat.numberOfColumns&&"NoBreak"===n.nextRenderedWidget.sectionFormat.breakCode))||n instanceof Xd||!_.isNullOrUndefined(n.containerWidget)&&n.containerWidget instanceof q?!(!_.isNullOrUndefined(n.nextRenderedWidget)&&"NoBreak"===n.nextRenderedWidget.sectionFormat.breakCode&&this.documentHelper.layout.isMultiColumnDoc||"NoBreak"===n.sectionFormat.breakCode&&n.sectionIndex===n.page.bodyWidgets[0].sectionIndex&&1<n.sectionFormat.numberOfColumns||t)||n instanceof Xd||!_.isNullOrUndefined(n.containerWidget)&&n.containerWidget instanceof q?this.documentHelper.layout.shiftLayoutedItems(!0):(t=this.documentHelper.selection.start,n=this.documentHelper.selection.end,r=this.selection.getParagraphInfo(t),o=this.selection.getParagraphInfo(n),r=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),o=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),this.documentHelper.layout.shiftLayoutedItems(!0),this.setPositionForCurrentIndex(t,r),this.setPositionForCurrentIndex(n,o),this.documentHelper.selection.selectPosition(t,n),this.documentHelper.owner.enableHeaderAndFooter||this.owner.viewer.updateScrollBars()):this.layoutWholeDocument(!0,!0),this.documentHelper.owner.enableHeaderAndFooter&&(this.updateHeaderFooterWidget(),this.owner.viewer.updateScrollBars()),this.documentHelper.isRowOrCellResizing||(_.isNullOrUndefined(e.start.paragraph)||!_.isNullOrUndefined(e.start.paragraph.bodyWidget.containerWidget)&&e.start.paragraph.bodyWidget.containerWidget instanceof q&&("Footnote"===e.start.paragraph.bodyWidget.containerWidget.footNoteType?(this.documentHelper.layout.isRelayoutFootnote=!0,this.shiftFootnotePageContent(e.start.paragraph.bodyWidget.containerWidget)):(this.documentHelper.layout.isRelayoutFootnote=!1,this.shiftFootnotePageContent())),this.getOffsetValue(e),e.upDownSelectionLength=e.end.location.x,e.fireSelectionChanged(!0),this.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.startParagraph=void 0,this.endParagraph=void 0)):this.documentHelper.owner.enableHeaderAndFooter&&(this.updateHeaderFooterWidget(),this.owner.viewer.updateScrollBars()),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&("RowResizing"!==this.editorHistory.currentBaseHistoryInfo.action&&"CellResizing"!==this.editorHistory.currentBaseHistoryInfo.action||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(0<this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length&&this.editorHistory.currentBaseHistoryInfo.updateSelection(),this.editorHistory.undoStack&&0<this.editorHistory.undoStack.length&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1]instanceof qg&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions[this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions.length-1]===this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo=void 0:this.editorHistory.updateHistory()),i?!_.isNullOrUndefined(e)&&0<this.documentHelper.formFields.length&&e.highlightFormFields():(this.fireContentChange(),this.owner.enableLockAndEdit&&this.owner.viewer.updateScrollBars(),this.owner.documentHelper.layout.isRelayout=!1,this.isFootnoteElementRemoved=!1,this.isEndnoteElementRemoved=!1))},o.prototype.updateHeaderFooterWidget=function(e){_.isNullOrUndefined(e)&&(e=this.selection.start.paragraph.bodyWidget),this.updateHeaderFooterWidgetToPage(e),this.shiftPageContent(e.headerFooterType,e.sectionFormat)},o.prototype.updateHeaderFooterWidgetToPage=function(e){e.page;for(var t="EvenHeader"===e.headerFooterType||"EvenFooter"===e.headerFooterType,i="FirstPageHeader"===e.headerFooterType||"FirstPageFooter"===e.headerFooterType,n=0;n<this.documentHelper.pages.length;n++){var r=this.documentHelper.pages[n];r.bodyWidgets[0].sectionFormat.differentFirstPage&&i&&(r.headerWidgetIn.headerFooterType==e.headerFooterType||r.footerWidgetIn.headerFooterType==e.headerFooterType)?this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header")):r.bodyWidgets[0].sectionFormat.differentFirstPage&&(i||!i&&0==r.index||r.sectionIndex!=r.previousPage.sectionIndex)||(!r.bodyWidgets[0].sectionFormat.differentOddAndEvenPages||t&&(n+1)%2==0?this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header")):t||(n+1)%2==0||(0<n||!r.bodyWidgets[0].sectionFormat.differentFirstPage)&&this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header")))}},o.prototype.updateHeaderFooterWidgetToPageInternal=function(e,t,i){var n;(i?t!=e.headerWidgetIn&&t.page.headerWidget==e.headerWidget:t!=e.footerWidgetIn&&t.page.footerWidget==e.footerWidget)&&(n=t.clone(),this.documentHelper.layout.clearBlockWidget(n.childWidgets,!0,!0,!0),n.page=e,n.parentHeaderFooter=t,this.owner.viewer.updateHFClientArea(n.sectionFormat,i),t=void(n=this.documentHelper.layout.layoutHeaderFooterItems(this.owner.viewer,n)),i?(t=e.headerWidgetIn,e.headerWidget=n):(t=e.footerWidgetIn,e.footerWidget=n),this.removeFieldInWidget(t),this.removeFieldInWidget(t,void 0,!0),t.destroy())},o.prototype.removeFieldInWidget=function(e,t,i){_.isNullOrUndefined(t)&&(t=!1);for(var n=0;n<e.childWidgets.length;n++)this.removeFieldInBlock(e.childWidgets[n],t,i)},o.prototype.removeFieldInBlock=function(e,t,i){var n;if(e instanceof K)e.wrapTextAround&&!_.isNullOrUndefined(e.bodyWidget)&&-1!==(n=e.bodyWidget.floatingElements.indexOf(e))&&e.bodyWidget.floatingElements.splice(n,1),this.removeFieldTable(e,t,i);else if(e instanceof dh)for(var r=0;r<e.childWidgets.length;r++)this.removeFieldInWidget(e.childWidgets[r],t,i);else this.removeField(e,t,i)},o.prototype.removeFieldTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.removeFieldInWidget(r.childWidgets[o],t,i)},o.prototype.shiftFootnotePageContent=function(e){var t=this.documentHelper.pages[0].bodyWidgets[0];_.isNullOrUndefined(e)||(e=this.documentHelper.pages.indexOf(e.page),t=this.documentHelper.pages[e].bodyWidgets[0]),_.isNullOrUndefined(t.page.footnoteWidget)||this.checkAndShiftFromBottom(t.page,t.page.footnoteWidget),_.isNullOrUndefined(t.page.endnoteWidget),this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1))},o.prototype.shiftPageContent=function(e,t){-1!==e.indexOf("First")?n=0:t.differentOddAndEvenPages?(i=-1!==e.indexOf("Even"),n=t.differentFirstPage?i?1:2:i?1:0):1===(n=t.differentFirstPage?1:0)&&1===this.documentHelper.pages.length&&(n=0);var i,n,r,o,s,a,l=this.documentHelper.pages[n].bodyWidgets[0];do{for(-1!==e.indexOf("Header")?(a=!(a=l.page.headerWidget).isEmpty||a.isEmpty&&this.owner.enableHeaderAndFooter,s=l.firstChild,r=j.convertPointToPixel(t.topMargin),o=j.convertPointToPixel(t.headerDistance),a&&(r=Math.max(o+l.page.headerWidget.height,r)),s.y!==r&&"NoBreak"!==l.sectionFormat.breakCode&&(this.owner.viewer.updateClientArea(l,l.page),!(a=(s=s.combineWidget(this.owner.viewer)).previousRenderedWidget)||!s.containerWidget.equals(a.containerWidget)||a.containerWidget.lastChild instanceof G&&(a.containerWidget.lastChild.isEndsWithPageBreak||a.containerWidget.lastChild.isEndsWithColumnBreak)||(this.owner.viewer.cutFromTop(a.y+a.height),this.documentHelper.layout.updateContainerWidget(s,a.containerWidget,a.indexInOwner+1,!1)),this.documentHelper.blockToShift=s)):this.checkAndShiftFromBottom(l.page,l.page.footerWidget),this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1));l;){var d=l;do{var h=l.getSplitWidgets(),l=h[h.length-1].nextRenderedWidget}while(l&&d.page===l.page);if(l){if(0===n)break;if(l.page.index+1===0&&1===n||l.page.index+1!==0&&2===n)break;var c=l.page.nextPage;if(!_.isNullOrUndefined(c)&&c.bodyWidgets[0].equals(l)){l=c.bodyWidgets[0];break}}}}while(l)},o.prototype.checkAndShiftFromBottom=function(e,t){var i,n=e.bodyWidgets[0];if(1<n.childWidgets.length){for(var r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];if(o.y+o.height>t.y){i=o;break}if(!(t instanceof q)&&n.childWidgets.length-1===r&&o.y+o.height<t.y){i=o;break}}_.isNullOrUndefined(i)||(this.owner.viewer.updateClientArea(n,e,!0),this.owner.viewer.cutFromTop(i.y),this.documentHelper.blockToShift=i)}},o.prototype.allowFormattingInFormFields=function(e){if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()&&!_.isNullOrUndefined(this.owner.documentEditorSettings.formFieldSettings.formattingExceptions))for(var t=0;t<this.owner.documentEditorSettings.formFieldSettings.formattingExceptions.length;t++)if(e.toLowerCase()===this.owner.documentEditorSettings.formFieldSettings.formattingExceptions[t].toLowerCase())return!0;return!1},o.prototype.getContentControl=function(){for(var e=0;e<this.documentHelper.contentControlCollection.length;e++)if(!this.documentHelper.contentControlCollection[e].paragraph.isInHeaderFooter||"Continuous"!==this.documentHelper.owner.layoutType){var t=this.documentHelper.contentControlCollection[e],i=t.line;if(!_.isNullOrUndefined(i.children)&&!_.isNullOrUndefined(i.children.length)){i=this.selection.getPosition(t);if(i.startPosition&&i.endPosition){var n=i.startPosition,i=i.endPosition,r=this.selection.start,o=this.selection.end;if(this.selection.isForward||(r=this.selection.end,o=this.selection.start),(r.isExistAfter(n)||r.isAtSamePosition(n))&&(o.isExistBefore(i)||o.isAtSamePosition(i)))return t}}}},o.prototype.checkPlainTextContentControl=function(){var e,t,i,n=this.selection.start,r=this.selection.end,o=(this.selection.isForward||(r=this.selection.start,n=this.selection.end),n.currentWidget.getInline(n.offset,0)),s=r.currentWidget.getInline(r.offset,0),o=(o.index,s.index,o.element),s=s.element;o&&o.contentControlProperties&&"Text"===o.contentControlProperties.type||s&&s.contentControlProperties&&"Text"===s.contentControlProperties.type?(o=this.getContentControl(),!_.isNullOrUndefined(o)&&o.contentControlProperties?(t=o.line.getOffset(o,1),(e=new y(this.owner)).setPositionParagraph(o.line,t)):e=n,s.contentControlProperties&&!_.isNullOrUndefined(o)&&o.reference?(t=(s=o.reference).line.getOffset(s,s.length),(i=new y(this.owner)).setPositionParagraph(s.line,t)):i=r,this.selection.selectRange(e,i)):n.paragraph.contentControlProperties&&"Text"===n.paragraph.contentControlProperties.type&&this.selection.selectParagraph()},o.prototype.onApplyCharacterFormat=function(e,t,i,n){var r=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(e);if(!(this.restrictFormatting&&!r||!_.isNullOrUndefined(this.selection)&&this.selection.checkContentControlLocked(!0))){this.documentHelper.layout.isBidiReLayout=!0;var o=this.documentHelper.selection;if((!o.owner.isReadOnlyMode||r)&&o.owner.isDocumentLoaded){i=!_.isNullOrUndefined(i)&&i,n=!_.isNullOrUndefined(n)&&n;var r=e[0].toUpperCase()+e.slice(1),s=o.start.paragraph;s.childWidgets[s.childWidgets.length-1];if(this.checkPlainTextContentControl(),o.isEmpty&&"List"!==o.contextType&&!n)o.skipFormatRetrieval=!0,o.end.isAtParagraphEnd?(this.initHistory(r),this.documentHelper.owner.isShiftingEnabled=!0,this.applyCharFormatValue(s.characterFormat,e,t,i),this.reLayout(this.documentHelper.selection),this.documentHelper.updateFocus()):o.fireSelectionChanged(!0),o.skipFormatRetrieval=!1;else{if("highlightColor"===e&&o.start.isInSameParagraph(o.end)){n=o.start,s=o.end;if(this.selection.isForward||(s=o.start,n=o.end),s.offset===o.getLineLength(s.currentWidget)+1&&s.offset-1===n.offset)return}this.setOffsetValue(o),this.initHistory(r),"List"===o.contextType?this.applyCharacterFormatForListText(o,e,t,i):this.updateSelectionCharacterFormatting(e,t,i),0<this.documentHelper.contentControlCollection.length&&(this.selection.contentControleditRegionHighlighters.clear(),this.selection.isHighlightContentControlEditRegion=!0,this.selection.onHighlightContentControl()),this.documentHelper.layout.isBidiReLayout=!1}}}},o.prototype.applyCharacterFormatForListText=function(e,t,i,n){var r=e.getListLevel(e.start.paragraph);if(!_.isNullOrUndefined(r)){var o=r.characterFormat;switch(t){case"bold":this.applyListCharacterFormatByValue(e,o,"bold",!o.bold);break;case"italic":this.applyListCharacterFormatByValue(e,o,"italic",!o.italic);break;case"fontColor":this.applyListCharacterFormatByValue(e,o,"fontColor",i);break;case"fontFamily":this.applyListCharacterFormatByValue(e,o,"fontFamily",i);break;case"fontSize":this.applyListCharacterFormatByValue(e,o,"fontSize",i);break;case"highlightColor":this.applyListCharacterFormatByValue(e,o,"highlightColor",i);break;case"baselineAlignment":o.baselineAlignment===i&&(i="Normal"),this.applyListCharacterFormatByValue(e,o,"baselineAlignment",i);break;case"strikethrough":o.strikethrough===i&&(i="None"),this.applyListCharacterFormatByValue(e,o,"strikethrough",i);break;case"underline":o.underline===i&&(i="None"),this.applyListCharacterFormatByValue(e,o,"underline",i);break;case"characterFormat":this.applyListCharacterFormatByValue(e,o,void 0,i)}}},o.prototype.applyListCharacterFormatByValue=function(e,t,i,n){this.initHistory("ListCharacterFormat"),this.applyCharFormatValue(t,i,n,!1),this.editorHistory.updateHistory(),this.reLayout(e),this.fireContentChange()},o.prototype.updateListCharacterFormat=function(e,t,i){this.updateListTextSelRange(e,t,i,!1)},o.prototype.updateListTextSelRange=function(e,t,i,n){this.documentHelper.owner.isShiftingEnabled=!0;var r=e.start,o=e.end,s=(e.isForward||(r=e.end,o=e.start),this.initHistoryPosition(e,r),e.getListLevel(e.start.paragraph));this.applyCharFormatValue(s.characterFormat,t,i,n),this.startSelectionReLayouting(r.paragraph,e,r,o)},o.prototype.updateInsertPosition=function(){var e=this.documentHelper.selection,t=e.start;e.isForward||(t=e.end),!this.editorHistory||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||_.isNullOrUndefined(t)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&this.updateHistoryPosition(t,!0)},o.prototype.setOffsetValue=function(e){var t=this.selection.getParagraphInfo(e.start);this.startParagraph=t.paragraph,this.startOffset=t.offset,t=this.selection.getParagraphInfo(e.end),this.endParagraph=t.paragraph,this.endOffset=t.offset},o.prototype.toggleHighlightColor=function(e){var t=this.documentHelper.selection;!_.isNullOrUndefined(e)&&"NoColor"!==e||(e="Yellow"),t.characterFormat.highlightColor===e&&(e="NoColor"),this.selection.characterFormat.highlightColor=e},o.prototype.toggleSubscript=function(){var e;this.owner.isReadOnlyMode||this.restrictFormatting||(e="Subscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Subscript",this.selection.characterFormat.baselineAlignment=e)},o.prototype.toggleSuperscript=function(){var e;this.owner.isReadOnlyMode||this.restrictFormatting||(e="Superscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Superscript",this.selection.characterFormat.baselineAlignment=e)},o.prototype.increaseIndent=function(){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("leftIndent",this.documentHelper.defaultTabWidth,!0,!1)},o.prototype.decreaseIndent=function(){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("leftIndent",-this.documentHelper.defaultTabWidth,!0,!1)},o.prototype.clearList=function(){this.selection.owner.editorModule.onApplyList(void 0)},o.prototype.applyBullet=function(e,t){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.applyBulletOrNumbering(e,"Bullet",t)},o.prototype.applyNumbering=function(e,t){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.applyBulletOrNumbering(e,t,"Verdana")},o.prototype.toggleBaselineAlignment=function(e){this.updateProperty(2,e)},o.prototype.clearFormattingInternal=function(e){var t=this.documentHelper.selection;this.setPreviousBlockToLayout(),this.initComplexHistory("ClearFormat"),(t.isEmpty||!_.isNullOrUndefined(e)&&e)&&(t.start.moveToParagraphStartInternal(t,!1),t.end.moveToParagraphEndInternal(t,!1)),this.setOffsetValue(t),this.editorHistory&&this.editorHistory.initializeHistory("ClearCharacterFormat"),this.updateSelectionCharacterFormatting("ClearCharacterFormat",void 0,!1),this.getOffsetValue(t),this.editorHistory&&this.editorHistory.updateHistory(),this.setOffsetValue(t),(_.isNullOrUndefined(e)||e)&&(this.editorHistory&&this.editorHistory.initializeHistory("ClearParagraphFormat"),this.updateParagraphFormatInternal("ClearParagraphFormat",void 0,!1)),this.editorHistory&&this.editorHistory.updateHistory(),this.getOffsetValue(t),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.startParagraph=void 0,this.endParagraph=void 0},o.prototype.clearFormatting=function(){this.clearFormattingInternal()},o.prototype.updateProperty=function(e,t){var i,n,r,o=this.selection;(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())&&o.owner.isDocumentLoaded&&(r=o.start,o.end,o.isForward||(r=o.end,o.start),i=(n=r.currentWidget.getInline(r.offset,o=0)).element,o=n.index,n=r.paragraph,_.isNullOrUndefined(i)||i.length!==o||this.selection.isEmpty||(i=i.nextNode),1===e?(r="None",_.isNullOrUndefined(i)?_.isNullOrUndefined(n)||(r=n.characterFormat.underline):r=i.characterFormat.underline,this.selection.characterFormat.underline=t===r?"None":t):(o="Normal",_.isNullOrUndefined(i)?_.isNullOrUndefined(n)||(o=n.characterFormat.baselineAlignment):o=i.characterFormat.baselineAlignment,this.selection.characterFormat.baselineAlignment=t=o===t?"Normal":t))},o.prototype.getCompleteStyles=function(){for(var e='{"styles":[',t=0,i=this.documentHelper.preDefinedStyles.keys;t<i.length;t++){var n=i[t];e+=this.documentHelper.preDefinedStyles.get(n)+","}return e.slice(0,-1)+"]}"},o.prototype.intializeDefaultStyles=function(){for(var t=this.owner.getStyleNames("Paragraph"),e=0,i=["Normal","Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6","Heading 7","Heading 8","Heading 9","Header","Footer"].filter(function(e){return-1===t.indexOf(e)});e<i.length;e++){var n=i[e];this.createStyle(this.documentHelper.preDefinedStyles.get(n))}},o.prototype.createStyle=function(e,t){return this.createStyleIn(e,t).name},o.prototype.createStyleIn=function(e,t){var e=JSON.parse(e),i=this.documentHelper.styles.findByName(e.name),n=e.type;return _.isNullOrUndefined(i)||_.isNullOrUndefined(t)||!t?(void 0!==i&&(e.name=this.getUniqueStyleName(e.name)),this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),e,this.documentHelper.styles,!0)):n===i.type?this.setStyle(i,e):(e.name=this.getUniqueStyleName(e.name),this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),e,this.documentHelper.styles,!0)),this.owner.notify(Ne,{}),this.documentHelper.styles.findByName(e.name)},o.prototype.setStyle=function(e,t){if(_.isNullOrUndefined(t.basedOn)||(n=this.documentHelper.styles.findByName(t.basedOn),_.isNullOrUndefined(n)?(i=this.getStyle(t.basedOn,JSON.parse(this.getCompleteStyles())),r=void 0,r=_.isNullOrUndefined(i)||i.type!==t.type?"Paragraph"===t.type?JSON.parse('{"type":"Paragraph","name":"Normal","next":"Normal"}'):JSON.parse('{"type": "Character","name": "Default Paragraph Font"}'):i,e.basedOn=this.documentHelper.styles.findByName(r.name)):n.type===t.type&&(e.basedOn=n)),_.isNullOrUndefined(t.next)||"Paragraph"===t.type&&(t.next===t.name||(i=this.documentHelper.styles.findByName(t.next),_.isNullOrUndefined(i))||i.type!==e.type?e.next=e:e.next=i),!_.isNullOrUndefined(t.link)){var i,n,r=this.documentHelper.styles.findByName(t.link);if(_.isNullOrUndefined(r)||"Character"!==r.type?((n={}).characterFormat=t.characterFormat,void 0!==this.documentHelper.styles.findByName(t.name+" Char").name?n.name=this.getUniqueStyleName(t.name)+" Char":n.name=t.name+" Char",n.type="Character",n.basedOn="Default Paragraph Font",i=n,this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),i,this.documentHelper.styles),e.link=this.documentHelper.styles.findByName(i.name)):(this.documentHelper.owner.parser.parseCharacterFormat(0,t.characterFormat,r.characterFormat),e.link=r),"Character"==t.type)for(var o=0;o<this.documentHelper.styles.length;o++){var s=this.documentHelper.styles.getItem(o),a=s.link,a=void 0===a?"":a.name;"Paragraph"!==s.type||a!==t.link||_.isNullOrUndefined(s.characterFormat)||this.documentHelper.owner.parser.parseCharacterFormat(0,t.characterFormat,s.characterFormat)}}_.isNullOrUndefined(t.paragraphFormat)||this.documentHelper.owner.parser.parseParagraphFormat(0,t.paragraphFormat,e.paragraphFormat),_.isNullOrUndefined(t.characterFormat)||this.documentHelper.owner.parser.parseCharacterFormat(0,t.characterFormat,e.characterFormat)},o.prototype.getStyle=function(e,t){for(var i=0;i<t.styles.length;i++)if(t.styles[i].name===e)return t.styles[i]},o.prototype.getUniqueStyleName=function(e){for(var t=this.getUniqueName(e),i=this.documentHelper.styles.findByName(t);!_.isNullOrUndefined(i);)t=this.getUniqueStyleName(i.name),i=this.documentHelper.styles.findByName(t);return t},o.prototype.getUniqueName=function(e){var t=e.match(/\d+$/);return!_.isNullOrUndefined(t)&&0<t.length?e.replace(t[0],(parseInt(t[0],10)+1).toString()):e+"_1"},o.prototype.updateSelectionCharacterFormatting=function(e,t,i){switch(_.isNullOrUndefined(e)&&(e="CharacterFormat"),!_.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.insertedFormat=t),e){case"bold":this.updateCharacterFormat("bold",t);break;case"italic":this.updateCharacterFormat("italic",t);break;case"fontColor":this.updateCharacterFormat("fontColor",t);break;case"fontFamily":this.updateCharacterFormat("fontFamily",t);break;case"fontSize":this.documentHelper.layout.isBidiReLayout=!1,this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"fontSize",t,i);break;case"highlightColor":this.updateCharacterFormat("highlightColor",t);break;case"baselineAlignment":this.updateCharacterFormat("baselineAlignment",t);break;case"strikethrough":this.updateCharacterFormat("strikethrough",t);break;case"underline":this.updateCharacterFormat("underline",t);break;case"styleName":this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"styleName",t,!0,!0);break;case"CharacterFormat":case"ClearCharacterFormat":this.updateCharacterFormat(void 0,t);break;case"allCaps":this.updateCharacterFormat("allCaps",t)}this.reLayout(this.documentHelper.selection)},o.prototype.updateCharacterFormat=function(e,t){this.updateCharacterFormatWithUpdate(this.documentHelper.selection,e,t,!1)},o.prototype.updateCharacterFormatWithUpdate=function(e,t,i,n,r){r=!_.isNullOrUndefined(r)&&r,this.documentHelper.owner.isShiftingEnabled=!0;var o,s,a=e.start,l=e.end;e.isEmpty||e.isForward||(a=e.end,l=e.start),e.isEmpty&&r&&(r=a.offset,o=a.clone(),s=l.clone(),this.selection.selectCurrentWord(),r!==this.selection.start.offset&&r!==this.selection.end.offset-1||(this.selection.start=o,this.selection.end=s)),this.applyCharFormatSelectedContent(a.paragraph,e,a,l,t,i,n)},o.prototype.applyCharFormatSelectedContent=function(e,t,i,n,r,o,s){!i.paragraph.isInsideTable||n.paragraph.isInsideTable&&i.paragraph.associatedCell===n.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,n)?this.applyCharFormat(e,t,i,n,r,o,s):(e=void 0,i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),e=i.paragraph.associatedCell,this.applyCharFormatCell(e,t,i,n,r,o,s),t=e.ownerTable,this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1))},o.prototype.applyCharFormatForSelectedPara=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.children.length;a++){var l=s.children[a];l.isWidthUpdated=!1,this.applyCharFormatValue(l.characterFormat,i,n,r)}this.applyCharFormatValue(e.characterFormat,i,n,r)},o.prototype.splittedLastParagraph=function(e){e=e.getSplitWidgets();return e[e.length-1]},o.prototype.getNextParagraphForCharacterFormatting=function(e,t,i,n,r,o){var s=e.getSplitWidgets();e=s[s.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e),_.isNullOrUndefined(e)||(e instanceof G?this.applyCharFormat(e,this.documentHelper.selection,t,i,n,r,o):this.applyCharFormatForTable(0,e,this.documentHelper.selection,t,i,n,r,o))},o.prototype.applyCharFormat=function(e,t,i,n,r,o,s){e=e.combineWidget(this.owner.viewer);var a=0,l=t.getParagraphLength(e),d=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):0,h=n.offset,c=-1!==e.childWidgets.indexOf(n.currentWidget)?e.childWidgets.indexOf(n.currentWidget):e.childWidgets.length-1;_.isNullOrUndefined(t)||e===i.paragraph&&(a=i.offset),e.equals(n.paragraph)?(I=e.childWidgets[e.childWidgets.length-1],t.isParagraphLastLine(I)&&n.currentWidget===I&&(h===t.getLineLength(I)+1||t.isEmpty&&t.end.isAtParagraphEnd)&&this.applyCharFormatValue(e.characterFormat,r,o,s)):(I=e.childWidgets[e.childWidgets.length-1],"highlightColor"===r&&t.isParagraphLastLine(I)&&i.currentWidget===I&&i.offset===t.getLineLength(I)||this.applyCharFormatValue(e.characterFormat,r,o,s),h=l);for(var p=d;p<=c;p++)for(var u=e.childWidgets[p],g=(p!==d&&(a=t.getStartLineOffset(u)),h=u===n.currentWidget?n.offset:t.getLineLength(u),0),m=void 0,f=-1,y=!0,v=0;v<u.children.length;y?v++:v--){var w=u.children[v];if(w.isWidthUpdated=!1,!(w instanceof Y))if(m===w&&(v=f,f=-1,y=!(m=void 0)),a>=g+w.length)g+=w.length;else{var b=0,x=h-g,C=w.length,b=(C<x&&(x=C),this.applyCharFormatInline(w,t,b=g<a?a-g:b,x,r,o,s));if("fontColor"===r&&0!==e.characterFormat.revisions.length||e.equals(n.paragraph)||!this.isForHyperlinkFormat||!this.owner.enableTrackChanges||u.children[v].indexInOwner!==u.children.length-1||u!==u.paragraph.lastChild||!_.isNullOrUndefined(w)&&0<w.revisions.length&&(x=w.revisions[w.revisions.length-1],e.characterFormat.revisions.push(x),x.range.push(e.characterFormat),this.owner.trackChangesPane.updateCurrentTrackChanges(x)),v+=b,h<=g+C)break;g+=C}}var I=n.paragraph;this.documentHelper.layout.reLayoutParagraph(e,d,0),e.equals(I)||this.getNextParagraphForCharacterFormatting(e,i,n,r,o,s)},o.prototype.toggleBold=function(){var e;(this.owner.isReadOnlyMode||this.restrictFormatting)&&!this.selection.isInlineFormFillMode()||(e=this.getCurrentSelectionValue("bold"),this.selection.characterFormat.bold=e)},o.prototype.toggleItalic=function(){var e;(this.owner.isReadOnlyMode||this.restrictFormatting)&&!this.selection.isInlineFormFillMode()||(e=this.getCurrentSelectionValue("italic"),this.selection.characterFormat.italic=e)},o.prototype.changeCase=function(e){var t,i,n;this.selection.isEmpty||(this.owner.isReadOnlyMode||this.restrictFormatting)&&!this.selection.isInlineFormFillMode()||(this.initHistory(e),this.documentHelper.owner.isShiftingEnabled=!0,i=(t=this.selection).start,n=t.end,t.isForward||(i=t.end,n=t.start),this.changeSelectedTextCase(t,i,n,e),this.reLayout(t))},o.prototype.changeSelectedTextCase=function(e,t,i,n,r){var o=this.selection.getParagraphInfo(t),o=(e.editPosition=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(t,!0),this.editorHistory.isUndoing),r=(o&&!_.isNullOrUndefined(r)&&0<r.length&&(this.removedTextNodes=r),i.selection.endOffset);this.changeTextCase(t.paragraph,e,t,i,n,o),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(i.selection.endOffset!==r&&(i=e.getTextPosBasedOnLogicalIndex(r)),this.checkEndPosition(e)&&this.updateHistoryPosition(i,!1),e.selectPosition(t,i))},o.prototype.changeTextCase=function(e,t,i,n,r,o){!i.paragraph.isInsideTable||n.paragraph.isInsideTable&&i.paragraph.associatedCell===n.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,n)?this.changeCaseParagraph(e,t,i,n,r,o):(e=void 0,i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),e=i.paragraph.associatedCell,this.changeCaseParaFormatInCell(e,i,n,r,o),t=e.ownerTable,this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1))},o.prototype.changeCaseParagraph=function(e,t,i,n,r,o){e=e.combineWidget(this.owner.viewer);var s=0,a=t.getParagraphLength(e),l=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):0,d=n.offset,h=-1!==e.childWidgets.indexOf(n.currentWidget)?e.childWidgets.indexOf(n.currentWidget):e.childWidgets.length-1;_.isNullOrUndefined(t)||e===i.paragraph&&(s=i.offset),e.equals(n.paragraph)||(d=a);for(var c=l;c<=h;c++){this.checkLastLetterSpaceDot="",this.checkLastLetterSpace="";for(var p=e.childWidgets[c],u=(c!==l&&(s=t.getStartLineOffset(p)),d=p===n.currentWidget?n.offset:t.getLineLength(p),0),g=void 0,m=-1,f=!0,y=0;y<p.children.length;f?y++:y--){var v=p.children[y],w=!1;if((0===y||0<y&&p.children[y-1]instanceof X)&&(w=!0,0<y)&&(b=p.children[y-1],this.checkLastLetterSpace=b.text.substr(-1),this.checkLastLetterSpaceDot=b.text.substr(-2)),!(v instanceof Y))if(g===v&&(y=m,m=-1,f=!(g=void 0)),s>=u+v.length)u+=v.length;else{var b=0,x=d-u,C=v.length;if(C<x&&(x=C),y+=this.changeCaseInline(v,t,b=u<s?s-u:b,x,r,o,w),d<=u+C)break;u+=C}}}a=n.paragraph;this.documentHelper.layout.reLayoutParagraph(e,l,0),e.equals(a)||this.changeCaseNextBlock(e,i,n,r,o)},o.prototype.changeCaseInline=function(e,t,i,n,r,o,s){if(e instanceof X){if(0!==i||n!==e.length)return this.changeCaseInlineInternal(e,t,i,n,r,o,s);this.changeCaseInlineInternal(e,t,i,n,r,o,s)}return 0},o.prototype.addRemovedTextNodes=function(e,t){e instanceof X&&(_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(e=this.editorHistory.currentBaseHistoryInfo.removedNodes[0],_.isNullOrUndefined(e)&&((e=new X).text="",this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e)),e.text+=t,e.isWidthUpdated=!1))},o.prototype.changeCaseInlineInternal=function(e,t,i,n,r,o,s){var a,l=0,d=!1,h=e.line.children.indexOf(e),c=e.paragraph,p=c.childWidgets.indexOf(e.line),u=(e.isWidthUpdated=!1,0<i&&(u=e.text.substr(i,n-i),this.addRemovedTextNodes(e,u),(a=new X).characterFormat.copyFormat(e.characterFormat),a.line=e.line,"CapitalizeEachWord"===r&&(d=" "===e.text.substr(i-1,1)),"SentenceCase"===r&&(d=". "===e.text.substr(i-2,2)),a.characterFormat.allCaps="Uppercase"===r&&!o,a.text=this.getChangeCaseText(u,r,o,d),a.isRightToLeft=e.isRightToLeft,e.line.children.splice(++h,0,a),l++),n<e.length&&((a=new X).characterFormat.copyFormat(e.characterFormat),a.text=e.text.substring(n),a.line=e.line,a.isRightToLeft=e.isRightToLeft,e.line.children.splice(++h,0,a),l++),e);return 0===i?(h=u.text.substr(0,n),this.addRemovedTextNodes(e,h),"SentenceCase"===r?(". "===this.checkLastLetterSpaceDot?d=!0:0===p&&""===this.checkLastLetterSpaceDot&&(d=!s||c.childWidgets[0].children[0]===u),this.checkLastLetterSpaceDot=u.text.substr(-2)):"CapitalizeEachWord"==r&&(d=!s||0===t.getIndexInInline(e)||" "===this.checkLastLetterSpace,this.checkLastLetterSpace=u.text.charAt(u.length-1)),u.characterFormat.allCaps="Uppercase"===r&&!o,u.text=this.getChangeCaseText(h,r,o,d)):(a=u.text.substr(0,i),u.text=a),l},o.prototype.changeCaseNextBlock=function(e,t,i,n,r){e=this.getNextBlockForChangeCase(e,t,i,n,r),_.isNullOrUndefined(e)||(e instanceof G?this.changeCaseParagraph(e,this.documentHelper.selection,t,i,n,r):this.changeCaseForTable(0,e,this.documentHelper.selection,t,i,n,r))},o.prototype.getNextBlockForChangeCase=function(e,t,i,n,r){var o=e.getSplitWidgets();return e=o[o.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e)},o.prototype.getChangeCaseText=function(e,t,i,n){var r;if(i)!_.isNullOrUndefined(this.removedTextNodes)&&0<this.removedTextNodes.length&&(r=(i=this.removedTextNodes[0]).text.substr(0,e.length),i.text=i.text.substr(r.length,i.length-r.length),e=r,""===i.text)&&this.removedTextNodes.splice(0,1);else switch(t){case"SentenceCase":e=this.sentencecase(e,n);break;case"Uppercase":e=e.toUpperCase();break;case"Lowercase":e=e.toLowerCase();break;case"CapitalizeEachWord":e=this.capitalizeFirst(e,n);break;case"ToggleCase":e=this.togglecase(e)}return e},o.prototype.capitalizeFirst=function(e,i){for(var t=e.split(/[^\w]+/g).map(function(e,t){return 0!==t||i?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e.toLowerCase()}),n=e.split(/\w+/).filter(Boolean),r=[],o=0;o<Math.max(t.length,n.length);o++)t[o]&&r.push(t[o]),n[o]&&r.push(n[o]);return r.join("")},o.prototype.sentencecase=function(e,i){return e.split(". ").map(function(e,t){return 0!==t||i?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e.toLowerCase()}).join(". ")},o.prototype.togglecase=function(e){return e.split("").map(function(e){return e===e.toLowerCase()?e.toUpperCase():e.toLowerCase()}).join("")},o.prototype.changeCaseForTable=function(e,t,i,n,r,o,s){t=t.combineWidget(this.owner.viewer);for(var a=e;a<t.childWidgets.length;a++){for(var l=t.childWidgets[a],d=0;d<l.childWidgets.length;d++)this.changeCaseForSelectedCell(l.childWidgets[d],i,o,s);if(r.paragraph.isInsideTable&&i.containsRow(l,r.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.changeCaseNextBlock(t,n,r,o,s)},o.prototype.changeCaseForSelectedCell=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];o instanceof G?this.changeCaseForSelectedPara(o,t,i,n):this.changeCaseForSelTable(o,t,i,n)}},o.prototype.changeCaseForSelectedPara=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s="",a=0;a<o.children.length;a++){var l=o.children[a],d=(l.characterFormat.allCaps="Uppercase"===i&&!n,!1);!_.isNullOrUndefined(l)&&l instanceof X&&(this.addRemovedTextNodes(l,l.text),"CapitalizeEachWord"===i?(d=0===a||" "===s,s=l.text.substr(l.length-1,1)):"SentenceCase"===i&&(d=". "===l.text.substr(l.length-2,2)||0===a),l.text=this.getChangeCaseText(l.text,i,n,d),l.isWidthUpdated=!1)}},o.prototype.changeCaseForSelTable=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++)this.changeCaseForSelectedCell(o.childWidgets[s],t,i,n)},o.prototype.changeCaseParaFormatInCell=function(e,t,i,n,r){var o,s,a,l=this.documentHelper.selection;i.paragraph.isInsideTable?(o=l.getContainerCellOf(e,i.paragraph.associatedCell)).ownerTable.contains(i.paragraph.associatedCell)?(a=l.getSelectedCell(e,o),s=l.getSelectedCell(i.paragraph.associatedCell,o),l.containsCell(o,i.paragraph.associatedCell)?l.isCellSelected(o,t,i)?this.changeCaseParaForCellInternal(o,l,n,r):a===o?this.changeCaseParagraph(t.paragraph,l,t,i,n,r):this.changeCaseParaForRow(a.ownerRow,l,t,i,n,r):this.changeCaseParaForTableCell(o.ownerTable,o,s,n,r)):this.changeCaseParaForRow(o.ownerRow,l,t,i,n,r):(a=l.getContainerCell(e),this.changeCaseParaForRow(a.ownerRow,l,t,i,n,r))},o.prototype.changeCaseParaForTableCell=function(e,t,i,n,r){for(var o=this.documentHelper.selection,s=(d=o.getCellLeft(t.ownerRow,t))+t.cellFormat.cellWidth,a=o.getCellLeft(i.ownerRow,i),l=a+i.cellFormat.cellWidth,a=this.updateSelectedCellsInTable(d,s,a,l),d=a.start,s=a.end,h=e.childWidgets.indexOf(i.ownerRow),c=e.childWidgets.indexOf(t.ownerRow);c<=h;c++)for(var p=e.childWidgets[c],u=0;u<p.childWidgets.length;u++){var g=o.getCellLeft(p,p.childWidgets[u]);Math.round(d)<=Math.round(g)&&Math.round(g)<Math.round(s)&&this.changeCaseParaForCellInternal(p.childWidgets[u],o,n,r)}},o.prototype.changeCaseParaForCellInternal=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];o instanceof G?this.changeCaseForSelectedPara(o,t,i,n):this.changeCaseParaFormatTableInternal(o,t,i,n)}},o.prototype.changeCaseParaFormatTableInternal=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++)this.changeCaseParaForCellInternal(o.childWidgets[s],t,i,n)},o.prototype.changeCaseParaForRow=function(e,t,i,n,r,o){for(var s=e.rowIndex;s<e.ownerTable.childWidgets.length;s++){for(var a=e.ownerTable.childWidgets[s],l=0;l<a.childWidgets.length;l++)this.changeCaseParaForCellInternal(a.childWidgets[l],t,r,o);if(n.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(a,n.paragraph.associatedCell))return}this.changeCaseNextBlock(e.ownerTable,i,n,r,o)},o.prototype.toggleAllCaps=function(){var e;this.documentHelper.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||(e=this.getCurrentSelectionValue("allCaps"),this.selection.characterFormat.allCaps=e)},o.prototype.toggleChangeCase=function(){var e=["Uppercase","Lowercase","CapitalizeEachWord"];return this.casingIndex++,this.casingIndex>=e.length&&(this.casingIndex=0),e[this.casingIndex]},o.prototype.getCurrentSelectionValue=function(e){var t,i=!1;return"bold"!==e&&"italic"!==e||(t=this.getSelectedCharacterFormat(),"bold"===e&&(i=!t.bold),"italic"===e&&(i=!t.italic)),i},o.prototype.getSelectedCharacterFormat=function(){var e,t=this.selection.start,i=(t=this.selection.isForward?t:this.selection.end).currentWidget,t=i.getInline(t.offset,0),n=t.element,t=t.index,r=i.paragraph.characterFormat;return _.isNullOrUndefined(n)||(this.selection.isEmpty&&"List"===this.selection.contextType?(e=this.selection.getListLevel(this.selection.start.paragraph)).characterFormat.uniqueCharacterFormat&&(r=e.characterFormat):r=(this.selection.isEmpty||t!==n.length?n:_.isNullOrUndefined(n.nextNode)?i.paragraph:n.nextNode).characterFormat),r},o.prototype.toggleUnderline=function(e){(this.owner.isReadOnlyMode||this.restrictFormatting)&&!this.selection.isInlineFormFillMode()||this.updateProperty(1,e)},o.prototype.toggleStrikethrough=function(e){var t;this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||(t=void 0,t=_.isNullOrUndefined(e)?"SingleStrike"===this.selection.characterFormat.strikethrough?"None":"SingleStrike":e,this.selection.characterFormat.strikethrough=t)},o.prototype.updateFontSize=function(e,t){if("number"==typeof t&&!(t<0&&1===e.fontSize))return e.fontSize+t;var i=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];if("string"==typeof t&&"increment"===t){if(e.fontSize<8)return e.fontSize+1;if(72<=e.fontSize&&e.fontSize<80)return 80;if(80<=e.fontSize)return e.fontSize+10;for(var n=0;n<i.length;n++)if(e.fontSize<i[n])return i[n]}else if("string"==typeof t&&"decrement"===t&&1<e.fontSize){if(e.fontSize<=8)return e.fontSize-1;if(72<e.fontSize&&e.fontSize<=80)return 72;if(80<e.fontSize)return e.fontSize-10;for(n=0;n<i.length;n++)if(e.fontSize<=i[n])return i[n-1]}return e.fontSize},o.prototype.applyCharFormatInline=function(e,t,i,n,r,o,s){return 0===i&&n===e.length?(this.applyCharFormatValue(e.characterFormat,r,o,s),0):e instanceof X?this.formatInline(e,t,i,n,r,o,s):0},o.prototype.formatInline=function(e,t,i,n,r,o,s){var a,l=0,d=e,h=e.line.children.indexOf(d),c=(e.paragraph,0);return 0<i&&(c+=1,(a=new X).characterFormat.copyFormat(e.characterFormat),_.isNullOrUndefined(e.contentControlProperties)||(a.contentControlProperties=e.contentControlProperties),a.line=e.line,a.text=e.text.substr(i,n-i),a.isRightToLeft=e.isRightToLeft,this.applyCharFormatValue(a.characterFormat,r,o,s),d.line.children.splice(++h,0,a),l++,this.updateRevisionForFormattedContent(e,a,c)),n<d.length&&(c+=1,(a=new X).characterFormat.copyFormat(e.characterFormat),_.isNullOrUndefined(e.contentControlProperties)||(a.contentControlProperties=e.contentControlProperties),a.text=d.text.substring(n),a.line=e.line,a.isRightToLeft=e.isRightToLeft,d.line.children.splice(++h,0,a),l++,this.updateRevisionForFormattedContent(e,a,c)),0===i?(e.text=e.text.substr(0,n),this.applyCharFormatValue(e.characterFormat,r,o,s)):e.text=e.text.substr(0,i),l},o.prototype.updateRevisionForFormattedContent=function(e,t,i){for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n],o=r.range.indexOf(e)+i;t.revisions.splice(0,0,r),r.range.splice(o,0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(r)}},o.prototype.applyCharFormatCell=function(e,t,i,n,r,o,s){var a,l,d;n.paragraph.isInsideTable?(a=t.getContainerCellOf(e,n.paragraph.associatedCell)).ownerTable.contains(n.paragraph.associatedCell)?(d=t.getSelectedCell(e,a),l=t.getSelectedCell(n.paragraph.associatedCell,a),t.containsCell(a,n.paragraph.associatedCell)?t.isCellSelected(a,i,n)?(o=this.getCharacterFormatValueOfCell(e,t,o,r),this.applyCharFormatForSelectedCell(a,t,r,o,s)):d===a?this.applyCharFormat(i.paragraph,t,i,n,r,o,s):this.applyCharFormatRow(d.ownerRow,t,i,n,r,o,s):this.applyCharFormatForTableCell(a.ownerTable,t,a,l,r,o,s)):this.applyCharFormatRow(a.ownerRow,t,i,n,r,o,s):(d=t.getContainerCell(e),this.applyCharFormatRow(d.ownerRow,t,i,n,r,o,s))},o.prototype.applyCharFormatForSelectedCell=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];s instanceof G?this.applyCharFormatForSelectedPara(s,t,i,n,r):this.applyCharFormatForSelTable(s,t,i,n,r)}},o.prototype.applyCharFormatRow=function(e,t,i,n,r,o,s){o=this.getCharacterFormatValueOfCell(e.childWidgets[0],t,o,r),this.applyCharFormatForTable(e.rowIndex,e.ownerTable,t,i,n,r,o,s)},o.prototype.applyCharFormatForTable=function(e,t,i,n,r,o,s,a){t=t.combineWidget(this.owner.viewer);for(var l=e;l<t.childWidgets.length;l++){for(var d=t.childWidgets[l],h=0;h<d.childWidgets.length;h++)this.applyCharFormatForSelectedCell(d.childWidgets[h],i,o,s,a);if(r.paragraph.isInsideTable&&i.containsRow(d,r.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.getNextParagraphForCharacterFormatting(t,n,r,o,s,a)},o.prototype.applyCharFormatForSelTable=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)this.applyCharFormatForSelectedCell(s.childWidgets[a],t,i,n,r)},o.prototype.applyCharFormatForTableCell=function(e,t,i,n,r,o,s){for(var a=(h=t.getCellLeft(i.ownerRow,i))+i.cellFormat.cellWidth,l=t.getCellLeft(n.ownerRow,n),d=l+n.cellFormat.cellWidth,l=this.updateSelectedCellsInTable(h,a,l,d),h=l.start,a=l.end,c=e.childWidgets.indexOf(n.ownerRow),p=!1,u=e.childWidgets.indexOf(i.ownerRow);u<=c;u++)for(var g=e.childWidgets[u],m=0;m<g.childWidgets.length;m++){var f=t.getCellLeft(g,g.childWidgets[m]);j.round(h,2)<=j.round(f,2)&&j.round(f,2)<j.round(a,2)&&(p||(o=this.getCharacterFormatValueOfCell(g.childWidgets[m],t,o,r),p=!0),this.applyCharFormatForSelectedCell(g.childWidgets[m],t,r,o,s))}},o.prototype.updateSelectedCellsInTable=function(e,t,i,n){var r=this.documentHelper.selection;return{start:e=(e=i<e?i:e)>r.upDownSelectionLength?r.upDownSelectionLength:e,end:t=(t=t<n?n:t)<r.upDownSelectionLength?r.upDownSelectionLength:t}},o.prototype.getCharacterFormatValueOfCell=function(e,t,i,n){return"boolean"!=typeof i&&(void 0!==i||"bold"!==n&&"italic"!==n)||(e=(t=t.getFirstParagraph(e)).characterFormat,i=!(e=0<t.childWidgets.length&&0<t.childWidgets[0].children.length?t.childWidgets[0].children[0].characterFormat:e).getPropertyValue(n)),i},o.prototype.applyCharFormatValueInternal=function(e,t,i,n){this.applyCharFormatValue(t,i,n,!1)},o.prototype.copyInlineCharacterFormat=function(e,t){t.uniqueCharacterFormat=e.uniqueCharacterFormat,t.baseCharStyle=e.baseCharStyle},o.prototype.applyCharFormatValue=function(e,t,i,n){if(n&&"fontSize"===t&&(i=this.updateFontSize(e,i)),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(e,t,i),this.editorHistory.currentBaseHistoryInfo.insertedFormat=i),i instanceof B)this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?(this.copyInlineCharacterFormat(i,e),this.owner.enableCollaborativeEditing&&e.ownerBase instanceof mh&&this.editorHistory.currentBaseHistoryInfo.buildCharacterFormatOperation(e.ownerBase,e)):e.copyFormat(i);else{if(this.isForHyperlinkFormat&&this.owner.enableTrackChanges&&e.ownerBase instanceof mh){var r,o,n=e.ownerBase,s=n.previousNode;for(_.isNullOrUndefined(s)&&(o=n.paragraph.previousWidget,_.isNullOrUndefined(o)||o.isEmpty()||(s=(o=o.lastChild).children[o.children.length-1]));!(_.isNullOrUndefined(s)||s instanceof X);)s=s.previousNode;!_.isNullOrUndefined(s)&&0<s.revisions.length?(r=s.revisions[s.revisions.length-1],"fontColor"===t&&0!==n.revisions.length||this.isRevisionAlreadyIn(n,r)||(n.revisions.push(r),r.range.push(n),this.owner.trackChangesPane.updateCurrentTrackChanges(r))):(r=n.revisions[n.revisions.length-1],("fontColor"!==t||0===n.revisions.length)&&!_.isNullOrUndefined(r)&&0<r.range.length&&(n.revisions.splice(n.revisions.length-1,1),o=r.range.indexOf(n),r.range.splice(o,1),this.owner.trackChangesPane.updateCurrentTrackChanges(r)),"fontColor"===t&&0!==n.revisions.length||this.insertRevision(n,"Insertion"))}_.isNullOrUndefined(i)&&_.isNullOrUndefined(t)?(e.clearFormat(),_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.insertedFormat=e[t])):("bold"===t?e.bold=i:"italic"===t?e.italic=i:"fontColor"===t?e.fontColor=i:"fontFamily"===t?(e.fontFamily=i,e.fontFamilyAscii=i,e.fontFamilyFarEast=i,e.fontFamilyNonFarEast=i,e.fontFamilyBidi=i):"fontSize"===t?e.fontSize=i:"highlightColor"===t?e.highlightColor=i:"baselineAlignment"===t?e.baselineAlignment=i:"strikethrough"===t?e.strikethrough=i:"underline"===t?e.underline=i:"styleName"===t?e.baseCharStyle=i:"allCaps"===t&&(e.allCaps=i),"fontColor"===t&&this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.insertedFormat=e.fontColor))}},o.prototype.updateStyleObject=function(e){var t=new xl,i=this.owner.parser.keywordIndex,n=(this.owner.parser.keywordIndex=1,this.owner.editor.isRemoteAction);this.owner.editor.isRemoteAction=!0,this.owner.parser.parseStyles(e,t);for(var r=0;r<t.length;r++){var o,s,a=t.getItem(r),l=this.owner.documentHelper.styles.findByName(a.name);_.isNullOrUndefined(e[Ve[1]])||(this.owner.parser.parseAbstractList(e,this.owner.documentHelper.abstractLists),_.isNullOrUndefined(e[Ue[1]]))||this.owner.parser.parseList(e,this.owner.documentHelper.lists),_.isNullOrUndefined(l)?(this.owner.editorHistory.isRedoing&&(o=a instanceof ul?a.paragraphFormat.listFormat.listId:-1,(s=this.documentHelper.owner.getStyleObject(a,o)).isNew=!0,this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.modifiedProperties.push(s)),this.owner.documentHelper.styles.push(a)):(this.owner.editorHistoryModule&&(this.owner.editorHistoryModule.isUndoing||this.owner.editorHistoryModule.isRedoing)&&0===r&&this.owner.editorHistoryModule.currentBaseHistoryInfo&&"ModifyStyle"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action&&(o=l instanceof ul?l.paragraphFormat.listFormat.listId:-1,s=this.owner.getStyleObject(l,o),_.isNullOrUndefined(e.isNew)||(s.isNew=e.isNew),this.owner.editorHistoryModule.currentBaseHistoryInfo.modifiedProperties.push(s)),e.isNew&&this.owner.editorHistoryModule.isUndoing?this.owner.documentHelper.styles.remove(l):this.owner.updateStyle(l,a))}this.owner.editor.isRemoteAction=n,0<t.length&&(this.owner.isShiftingEnabled=!0,this.owner.editorModule.layoutWholeDocument(),this.owner.isShiftingEnabled=!1),this.owner.parser.keywordIndex=i},o.prototype.onImageFormat=function(e,t,i,n){var r=new Pg(e);this.editorHistory&&(this.editorHistory.initializeHistory("ImageResizing"),this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(r),this.editorHistory.currentBaseHistoryInfo.insertedText=L.Image,this.editorHistory.currentBaseHistoryInfo.insertedData={width:j.convertPixelToPoint(t),height:j.convertPixelToPoint(i),alternativeText:n}),this.setOffsetValue(this.selection),e.width=t,e.height=i,e.alternateText=n,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,e.line.indexInOwner,0),this.reLayout(this.selection,!1),this.documentHelper.owner.imageResizerModule&&!this.isRemoteAction&&this.documentHelper.owner.imageResizerModule.positionImageResizer(e)},o.prototype.toggleTextAlignment=function(e){this.documentHelper.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.documentHelper.owner.isDocumentLoaded||(_.isNullOrUndefined(this.documentHelper.selection.paragraphFormat.textAlignment)||this.documentHelper.selection.paragraphFormat.textAlignment!==e?this.onApplyParagraphFormat("textAlignment",e,!1,!0):"Left"===e?this.onApplyParagraphFormat("textAlignment","Justify",!1,!0):this.onApplyParagraphFormat("textAlignment","Left",!1,!0))},o.prototype.setPreviousBlockToLayout=function(){var e=this.documentHelper.selection.start,e=(e=this.documentHelper.selection.isForward?e:this.documentHelper.selection.end).paragraph;e.paragraphFormat.keepWithNext&&(e=e.bodyWidget,!_.isNullOrUndefined(e))&&e instanceof z&&e.page&&(e=e.page.previousPage)&&(this.previousBlockToLayout=e.bodyWidgets[0].lastChild)},o.prototype.applyParagraphBorders=function(e,t,i){var n=new Va;switch(e){case"color":n.color=i;break;case"lineWidth":n.lineWidth=i;break;case"lineStyle":n.lineStyle=i;break;case"shadow":n.shadow=i;break;case"space":n.space=i}this.onApplyParagraphFormat(t,n,!1,!1)},o.prototype.applyRulerMarkerValues=function(e,t,i){var n,i=j.convertPixelToPoint(i-t)/this.owner.zoomFactor;"firstLineIndent"===e?(n=this.owner.selectionModule.start.paragraph.paragraphFormat.firstLineIndent,this.onApplyParagraphFormat(e,n+i,!1,!1)):"hangingIndent"===e?(n=this.owner.selectionModule.start.paragraph.paragraphFormat.firstLineIndent,this.onApplyParagraphFormat("firstLineIndent",n-i,!1,!1),t=this.owner.selectionModule.start.paragraph.paragraphFormat.leftIndent+n,this.onApplyParagraphFormat("leftIndent",t-(n-=i),!1,!1,!0)):"leftIndent"===e?(n=this.owner.selectionModule.start.paragraph.paragraphFormat.leftIndent,this.onApplyParagraphFormat(e,n+i,!1,!1)):"rightIndent"===e&&(n=this.owner.selectionModule.start.paragraph.paragraphFormat.rightIndent,this.onApplyParagraphFormat(e,n+i,!1,!1))},o.prototype.onApplyParagraphFormat=function(e,t,i,n,r){var o=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(e);if(!this.restrictFormatting||o){this.setPreviousBlockToLayout();var s="bidi"===e?"ParagraphBidi":e[0].toUpperCase()+e.slice(1),a=(this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.selection),l=a.start.paragraph,d=!1;if(a.isForward||(l=a.end.paragraph),"leftIndent"==e&&(d=this.isFirstParaForList(a,l)),t<=0&&"leftIndent"==e&&!r){var r=j.convertPointToPixel(t);if(l.x+r<this.viewer.clientArea.x&&!l.paragraphFormat.bidi)return void(this.documentHelper.owner.isShiftingEnabled=!1)}this.initHistory(s),this.owner.isReadOnlyMode&&!o||!this.owner.isDocumentLoaded||("leftIndent"===e&&!_.isNullOrUndefined(a.paragraphFormat.listId)&&-1!==a.paragraphFormat.listId&&i?d?this.updateListLevelIndent(t,l):this.updateListLevel(0<t):(!(t instanceof fl&&"styleName"==e&&a.isEmpty)&&a.isEmpty?(this.setOffsetValue(a),a.paragraphFormat.bidi&&("listFormat"===e||-1!==a.paragraphFormat.listId)||(this.documentHelper.layout.isBidiReLayout=!0),i&&"leftIndent"===e&&(t=this.getIndentIncrementValue(a.start.paragraph,t)),r=a.start.paragraph,this.documentHelper.layout,r=r.combineWidget(this.owner.viewer),this.applyParaFormatProperty(r,e,t,i),this.isMeasureParaWidth=!0,this.layoutItemBlock(r,!1),this.isMeasureParaWidth=!1):("ParagraphBidi"!==s&&this.setOffsetValue(a),this.updateSelectionParagraphFormatting(e,t,i)),this.reLayout(a)))}},o.prototype.updateListLevelIndent=function(e,t){var i,t=this.documentHelper.getListById(t.paragraphFormat.listFormat.listId),n=this.documentHelper.getAbstractListById(t.abstractListId),t=void 0;if(_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(t=this.editorHistory.currentBaseHistoryInfo.action),this.initHistory("List"),0!=(e=e<0&&n.levels[0].paragraphFormat.leftIndent+e<=0?18-n.levels[0].paragraphFormat.leftIndent:e)){for(var r=0;r<n.levels.length;r++)this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForList(n.levels[r]),n.levels[r].paragraphFormat.leftIndent+=e;_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||_.isNullOrUndefined(t)||(this.editorHistory.currentBaseHistoryInfo.insertedFormat=((i={})[t.toString().charAt(0).toLowerCase()+t.toString().slice(1)]=e,i.isFirstParaForList=!0,i)),this.documentHelper.owner.isShiftingEnabled=!0,this.layoutWholeDocument(),this.documentHelper.owner.isShiftingEnabled=!1}},o.prototype.isFirstParaForList=function(e,t){var i=!1;return _.isNullOrUndefined(e.paragraphFormat.listId)||-1===e.paragraphFormat.listId||0!==t.paragraphFormat.listFormat.listLevelNumber||(t=this.updateWholeListItems(t,!0,e.paragraphFormat.listId),_.isNullOrUndefined(t)&&(i=!0)),i},o.prototype.updateListLevel=function(e){var t=this.documentHelper,i=(this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat,this.documentHelper.selection.start.paragraph.paragraphFormat),n=t.getListById(i.listFormat.listId),e=(t.layout.getListLevel(n,i.listFormat.listLevelNumber),e?i.listFormat.listLevelNumber+1:i.listFormat.listLevelNumber-1),i=t.layout.getListLevel(n,e);_.isNullOrUndefined(i)||(this.onApplyListInternal(n,e),t.selection.start.updatePhysicalPosition(!0),t.selection.end.updatePhysicalPosition(!0),t.selection.updateCaretPosition())},o.prototype.onApplyListInternal=function(e,t){var i=new ja;!_.isNullOrUndefined(e)&&0<=t&&t<9&&(i.listId=e.listId,i.listLevelNumber=t),this.onApplyParagraphFormat("listFormat",i,!1,!1)},o.prototype.updateSelectionParagraphFormatting=function(e,t,i){var n=this.documentHelper.selection;"leftIndent"===e&&i&&(t=!_.isNullOrUndefined(n.start)&&n.start.isExistBefore(n.end)?this.getIndentIncrementValue(n.start.paragraph,t):this.getIndentIncrementValue(n.end.paragraph,t)),this.updateParagraphFormatInternal(e,t,i)},o.prototype.getIndentIncrementValue=function(e,t){var i,e=e.paragraphFormat.leftIndent;return e<0?t<0||0<=e+t?-e:(i=-this.getIndentIncrementValueInternal(-e,-t))%t==0?i:i+t:this.getIndentIncrementValueInternal(e,t)},o.prototype.getIndentIncrementValueInternal=function(e,t){var i,n=Math.abs(t);return 0===e||0===n?0<t?n:0:(i=100*Math.round(e)%(100*Math.round(n))/100,i=(Math.round(e)-i)/Math.round(n)*n,0<t&&(i+=n),i-e==0?t:i-e)},o.prototype.updateParagraphFormatInternal=function(e,t,i){switch(e=_.isNullOrUndefined(e)?"ParagraphFormat":e){case"afterSpacing":this.updateParagraphFormat("afterSpacing",t,!1);break;case"beforeSpacing":this.updateParagraphFormat("beforeSpacing",t,!1);break;case"spaceAfterAuto":this.updateParagraphFormat("spaceAfterAuto",t,!1);break;case"spaceBeforeAuto":this.updateParagraphFormat("spaceBeforeAuto",t,!1);break;case"rightIndent":this.updateParagraphFormat("rightIndent",t,!1);break;case"leftIndent":this.updateParagraphFormat("leftIndent",t,i);break;case"firstLineIndent":this.updateParagraphFormat("firstLineIndent",t,!1);break;case"lineSpacing":this.updateParagraphFormat("lineSpacing",t,!1);break;case"lineSpacingType":this.updateParagraphFormat("lineSpacingType",t,!1);break;case"textAlignment":this.updateParagraphFormat("textAlignment",t,!1);break;case"borders":case"topBorder":case"bottomBorder":case"leftBorder":case"rightBorder":case"horizontalBorder":case"verticalBorder":this.updateParagraphFormat(e,t,!1);break;case"listFormat":this.updateParagraphFormat("listFormat",t,!1);break;case"ParagraphFormat":this.updateParagraphFormat(void 0,t,!1);break;case"styleName":this.updateParagraphFormat("styleName",t,!1);break;case"ClearParagraphFormat":this.updateParagraphFormat(void 0,t,!1);break;case"bidi":var n=-1!==this.selection.paragraphFormat.listId;n||(this.documentHelper.layout.isBidiReLayout=!0),this.updateParagraphFormat("bidi",t,!1),n||(this.documentHelper.layout.isBidiReLayout=!1);break;case"contextualSpacing":this.updateParagraphFormat("contextualSpacing",t,!1);break;case"tabStop":this.updateParagraphFormat("tabStop",t,!1)}},o.prototype.updateParagraphFormat=function(e,t,i){var n=this.documentHelper.selection,r=n.start,o=n.end;n.isForward||(r=n.end,o=n.start),this.applyParaFormatSelectedContent(r,o,e,t,i)},o.prototype.applyParaFormatSelectedContent=function(e,t,i,n,r){var o,s=this.documentHelper.selection;!e.paragraph.isInsideTable||t.paragraph.isInsideTable&&e.paragraph.associatedCell===t.paragraph.associatedCell&&!s.isCellSelected(e.paragraph.associatedCell,e,t)?!_.isNullOrUndefined(n)&&!this.selection.isEmpty&&"styleName"===i&&this.applyCharacterStyle(e.paragraph,e,t,i,n,r)||this.applyParaFormat(e.paragraph,e,t,i,n,r):(o=void 0,e.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(s)&&this.updateHistoryPosition(e,!0),o=e.paragraph.associatedCell,this.applyParaFormatInCell(o,e,t,i,n,r),s=o.ownerTable,this.documentHelper.layout.layoutBodyWidgetCollection(s.index,s.containerWidget,s,!1))},o.prototype.applyParaFormatProperty=function(e,t,i,n){var r=e.paragraphFormat;n&&"leftIndent"===t&&(i=r.leftIndent+i),"listFormat"===t&&i instanceof ja&&((n=i).hasValue("listLevelNumber")||(this.isAutoList?(n.listLevelNumber=this.listLevelNumber,this.listLevelNumber=0,this.isAutoList=!1):n.listLevelNumber=r.listFormat.listLevelNumber)),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(r,t,i),this.editorHistory.currentBaseHistoryInfo.insertedFormat=i),i instanceof Xa&&(_.isNullOrUndefined(t)?this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||this.isRemoteAction?this.copyParagraphFormat(i,r):r.copyFormat(i):"listFormat"===t&&(r.listFormat=i.listFormat,r.listFormat.ownerBase=r),this.editorHistory)&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.owner.enableCollaborativeEditing&&this.editorHistory.isUndoing&&this.editorHistory.currentBaseHistoryInfo.getParagraohFormatOperation(e,r),_.isNullOrUndefined(i)?(r.clearFormat(),this.documentHelper.layout.reLayoutParagraph(r.ownerBase,0,0)):"afterSpacing"===t?r.afterSpacing=i:"beforeSpacing"===t?r.beforeSpacing=i:"leftIndent"===t?r.leftIndent=i:"lineSpacingType"===t?r.lineSpacingType=i:"lineSpacing"===t?r.lineSpacing=i:"rightIndent"===t?r.rightIndent=i:"firstLineIndent"===t?r.firstLineIndent=i:"textAlignment"===t?(n=i,!r.bidi||this.editorHistory.isUndoing||this.editorHistory.isRedoing||("Left"===n?n="Right":"Right"===n&&(n="Left")),r.textAlignment=n):"outlineLevel"===t?r.outlineLevel=i:"topBorder"===t?this.applyBorder(r.borders.top,i):"bottomBorder"===t?this.applyBorder(r.borders.bottom,i):"leftBorder"===t?this.applyBorder(r.borders.left,i):"rightBorder"===t?this.applyBorder(r.borders.right,i):"horizontalBorder"===t?this.applyBorder(r.borders.horizontal,i):"verticalBorder"===t?this.applyBorder(r.borders.vertical,i):"borders"===t?r.borders.copyFormat(i):"styleName"===t?("string"==typeof i&&(i=this.documentHelper.styles.findByName(i)),r.applyStyle(i)):"listFormat"===t?(i instanceof Xa&&(i=i.listFormat),r.listFormat.copyFormat(i),this.documentHelper.layout.clearListElementBox(r.ownerBase),0<=r.listFormat.listId&&r.clearIndent(),this.layoutItemBlock(r.ownerBase,!1)):"bidi"===t?r.bidi=i:"keepWithNext"===t?r.keepWithNext=i:"keepLinesTogether"===t?r.keepLinesTogether=i:"widowControl"===t?r.widowControl=i:"contextualSpacing"===t?r.contextualSpacing=i:"spaceAfterAuto"===t?r.spaceAfterAuto=i:"spaceBeforeAuto"===t?r.spaceBeforeAuto=i:"tabStop"===t&&(n=this.editorHistory.isUndoing||this.editorHistory.isRedoing,this.updateTabStopCollection(e,i,n))},o.prototype.copyParagraphFormat=function(e,t){t.uniqueParagraphFormat=e.uniqueParagraphFormat,t.listFormat=e.listFormat,(t.listFormat.ownerBase=t).baseStyle=e.baseStyle},o.prototype.copyFromListLevelParagraphFormat=function(e,t){_.isNullOrUndefined(t.leftIndent)||(e.leftIndent=t.leftIndent),_.isNullOrUndefined(t.firstLineIndent)||(e.firstLineIndent=t.firstLineIndent)},o.prototype.applyContinueNumbering=function(){var e=this.selection;this.editorHistory&&this.editorHistory.initializeHistory("ContinueNumbering"),this.applyContinueNumberingInternal(e)},o.prototype.applyContinueNumberingInternal=function(e,t){var i=e.start.paragraph,n=this.getContinueNumberingInfo(i);_.isNullOrUndefined(t)&&(t=this.getParagraphFormat(i,n.listLevelNumber,n.listPattern)),t=_.isNullOrUndefined(t)?i.paragraphFormat:t,this.changeListId(n.currentList,i,t,n.listLevelNumber,n.listPattern),this.reLayout(e,!1),this.owner.enableAutoFocus&&this.documentHelper.updateFocus()},o.prototype.getContinueNumberingInfo=function(e){var t=void 0,i=0,n="None",e=(_.isNullOrUndefined(e.paragraphFormat)||_.isNullOrUndefined(e.paragraphFormat.listFormat)||(t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber),this.documentHelper);return{currentList:t,listLevelNumber:i,listPattern:n=0===i||_.isNullOrUndefined(t)||_.isNullOrUndefined(e.getAbstractListById(t.abstractListId))||_.isNullOrUndefined(e.getAbstractListById(t.abstractListId).levels[i])||(e=this.documentHelper.layout.getListLevel(t,i),_.isNullOrUndefined(e))?n:e.listLevelPattern}},o.prototype.revertContinueNumbering=function(e,t){var i=e.start.paragraph,n=this.getContinueNumberingInfo(i);this.changeListId(n.currentList,i,t,n.listLevelNumber,n.listPattern),this.reLayout(e,!1),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.updateHistory()},o.prototype.changeListId=function(e,t,i,n,r){var o;if(!_.isNullOrUndefined(t))return t instanceof G&&e.listId===t.paragraphFormat.listFormat.listId&&(this.editorHistory&&(o=this.editorHistory.currentBaseHistoryInfo,_.isNullOrUndefined(o)||(i=o.addModifiedPropertiesForContinueNumbering(t.paragraphFormat,i),o.insertedFormat=i)),n===t.paragraphFormat.listFormat.listLevelNumber?t.paragraphFormat.copyFormat(i):t.paragraphFormat.listFormat.listId=i.listFormat.listId,this.documentHelper.layout.reLayoutParagraph(t,0,0)),this.changeListId(e,t.nextRenderedWidget,i,n,r)},o.prototype.getParagraphFormat=function(e,t,i){if(!_.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof G)return!_.isNullOrUndefined(e.previousRenderedWidget.paragraphFormat.listFormat)&&-1!==e.previousRenderedWidget.paragraphFormat.listFormat.listId&&t===e.previousRenderedWidget.paragraphFormat.listFormat.listLevelNumber?e.previousRenderedWidget.paragraphFormat:this.getParagraphFormat(e.previousRenderedWidget,t,i)},o.prototype.checkNumberArabic=function(e,t){return"Number"===e&&"Arabic"===t||"Number"===t&&"Arabic"===e},o.prototype.applyRestartNumbering=function(e){this.editorHistory&&this.editorHistory.initializeHistory("RestartNumbering"),this.restartListAt(e)},o.prototype.restartListAt=function(e){var t=e.paragraphFormat.getList(),i=t.clone(),t=(i.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1,this.documentHelper.lists.push(i),t.abstractList.clone());t.abstractListId=this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1,i.abstractListId=t.abstractListId,i.nsid=t.nsid,i.abstractList=t,this.documentHelper.abstractLists.push(t),this.restartListAtInternal(e,i.listId,i.nsid)},o.prototype.restartListAtInternal=function(e,t,i){var n=this.getContinueNumberingInfo(e.start.paragraph);this.changeRestartNumbering(n.currentList,e.start.paragraph,t,i),this.reLayout(e,!1),this.documentHelper.updateFocus()},o.prototype.changeRestartNumbering=function(e,t,i,n){var r;if(!_.isNullOrUndefined(t))return t instanceof G&&e.listId===t.paragraphFormat.listFormat.listId&&(this.editorHistory&&(r=this.editorHistory.currentBaseHistoryInfo,_.isNullOrUndefined(r)||(i=r.addModifiedPropertiesForRestartNumbering(t.paragraphFormat.listFormat,i),r.insertedFormat={listId:i,nsid:n})),t.paragraphFormat.listFormat.listId=i,this.documentHelper.layout.reLayoutParagraph(t,0,0)),this.changeRestartNumbering(e,t.nextRenderedWidget,i,n)},o.prototype.applyParaFormat=function(e,t,i,n,r,o){this.setOffsetValue(this.selection),e=e.combineWidget(this.owner.viewer),this.applyParaFormatProperty(e,n,r,o),this.isMeasureParaWidth=!0,this.layoutItemBlock(e,!1),this.isMeasureParaWidth=!1,this.getOffsetValue(this.selection),e.equals(i.paragraph)||this.getNextParagraphForFormatting(e,t,i,n,r,o)},o.prototype.applyCharacterStyle=function(e,t,i,n,r,o){var s=e.getSplitWidgets(),a=i.owner.selectionModule,l=i.currentWidget,t=0===t.offset&&(a.isParagraphLastLine(l)&&i.currentWidget===l&&i.offset===a.getLineLength(l)+1||i.isAtParagraphEnd);if(!t&&(i.paragraph===e||-1!==s.indexOf(i.paragraph))&&("Paragraph"===r.type&&r.link instanceof fl||"Character"===r.type))return a="Character"===r.type?r:r.link,this.updateSelectionCharacterFormatting(n,a,o),!0;return!1},o.prototype.applyParaFormatInCell=function(e,t,i,n,r,o){var s,a,l,d=this.documentHelper.selection;i.paragraph.isInsideTable?(s=d.getContainerCellOf(e,i.paragraph.associatedCell)).ownerTable.contains(i.paragraph.associatedCell)?(l=d.getSelectedCell(e,s),a=d.getSelectedCell(i.paragraph.associatedCell,s),d.containsCell(s,i.paragraph.associatedCell)?d.isCellSelected(s,t,i)?(r=this.getParaFormatValueInCell(s,n,r),this.applyParaFormatCellInternal(s,n,r,o)):l===s?this.applyParaFormat(t.paragraph,t,i,n,r,o):this.applyParagraphFormatRow(l.ownerRow,t,i,n,r,o):this.applyParaFormatTableCell(s.ownerTable,s,a,n,r,o)):this.applyParagraphFormatRow(s.ownerRow,t,i,n,r,o):(l=d.getContainerCell(e),this.applyParagraphFormatRow(l.ownerRow,t,i,n,r,o))},o.prototype.applyParaFormatCellInternal=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];s instanceof G?("listFormat"===t&&i instanceof ja&&r&&s.paragraphFormat.listFormat.hasValue("listLevelNumber")&&i.listLevelNumber<s.paragraphFormat.listFormat.listLevelNumber&&(i.listLevelNumber=s.paragraphFormat.listFormat.listLevelNumber),this.isMeasureParaWidth=!0,this.applyParaFormatProperty(s,t,i,n),this.isMeasureParaWidth=!1):this.applyParagraphFormatTableInternal(s,t,i,n,r)}},o.prototype.getParaFormatValueInCell=function(e,t,i){return i="boolean"==typeof i?!this.documentHelper.selection.getFirstParagraph(e).paragraphFormat.getPropertyValue(t):i},o.prototype.applyParagraphFormatRow=function(e,t,i,n,r,o){r=this.getParaFormatValueInCell(e.childWidgets[0],n,r);for(var s=e.rowIndex;s<e.ownerTable.childWidgets.length;s++){for(var a=e.ownerTable.childWidgets[s],l=0;l<a.childWidgets.length;l++)this.applyParaFormatCellInternal(a.childWidgets[l],n,r,o);if(i.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(a,i.paragraph.associatedCell))return}this.getNextParagraphForFormatting(e.ownerTable,t,i,n,r,o)},o.prototype.applyParaFormatTableCell=function(e,t,i,n,r,o){for(var s=this.documentHelper.selection,a=(h=s.getCellLeft(t.ownerRow,t))+t.cellFormat.cellWidth,l=s.getCellLeft(i.ownerRow,i),d=l+i.cellFormat.cellWidth,l=this.updateSelectedCellsInTable(h,a,l,d),h=l.start,a=l.end,c=e.childWidgets.indexOf(i.ownerRow),p=!1,u=e.childWidgets.indexOf(t.ownerRow);u<=c;u++)for(var g=e.childWidgets[u],m=0;m<g.childWidgets.length;m++){var f=s.getCellLeft(g,g.childWidgets[m]);Math.round(h)<=Math.round(f)&&Math.round(f)<Math.round(a)&&(p||(r=this.getParaFormatValueInCell(g.childWidgets[m],n,r),p=!0),this.applyParaFormatCellInternal(g.childWidgets[m],n,r,o))}},o.prototype.applyParaFormatTable=function(e,t,i,n,r,o,s){e=e.combineWidget(this.owner.viewer);for(var a=this.documentHelper.selection,l=0;l<e.childWidgets.length;l++){for(var d=e.childWidgets[l],h=0;h<d.childWidgets.length;h++)this.applyParaFormatCellInternal(d.childWidgets[h],n,r,o,s);if(i.paragraph.isInsideTable&&a.containsRow(d,i.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.getNextParagraphForFormatting(e,t,i,n,r,o)},o.prototype.getNextParagraphForFormatting=function(e,t,i,n,r,o){var s=e.getSplitWidgets();e=s[s.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e),_.isNullOrUndefined(e)||(e instanceof G?("listFormat"===n&&r instanceof ja&&e.paragraphFormat.listFormat.hasValue("listLevelNumber")&&r.listLevelNumber<e.paragraphFormat.listFormat.listLevelNumber&&(r.listLevelNumber=e.paragraphFormat.listFormat.listLevelNumber),this.applyParaFormat(e,t,i,n,r,o)):this.applyParaFormatTable(e,t,i,n,r,o,!0))},o.prototype.applyParagraphFormatTableInternal=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)this.applyParaFormatCellInternal(s.childWidgets[a],t,i,n,r)},o.prototype.onApplyColumnFormat=function(e,t){if(!this.restrictFormatting){this.initHistory("SectionFormat");for(var i,n=this.documentHelper.selection,r=(n.owner.isShiftingEnabled=!0,n.start),o=n.end,s=(n.isForward||(r=n.end,o=n.start),this.documentHelper.clearContent(),r.paragraph.bodyWidget.sectionIndex),a=o.paragraph.bodyWidget.sectionIndex,l=!1,d=0;d<this.documentHelper.pages.length;d++)this.documentHelper.pages[d].bodyWidgets[0].index===s?i=d:l=!0;for(d=i;d<this.documentHelper.pages.length;d++){var h=this.documentHelper.pages[d].bodyWidgets[0],c=d;if(h.index!==s&&!(h.index>=s&&h.index<=a)){c=d-1;break}}l&&"differentOddAndEvenPages"==e&&r.paragraph.isInHeaderFooter&&(i=0,c=this.documentHelper.pages.length-1);for(var p=!0,u=0,d=i;d<=c;d++)u!==this.documentHelper.pages[d].bodyWidgets[0].index&&(p=p||!0),this.applyPropertyValueForSection(this.documentHelper.pages[d].bodyWidgets[0].sectionFormat,e,t,p),u=this.documentHelper.pages[d].bodyWidgets[0].index,p=!1;this.layoutWholeDocument(),this.fireContentChange()}},o.prototype.onApplySectionFormat=function(e,t){var i;this.restrictFormatting||(_.isNullOrUndefined(e)?this.initHistory("SectionFormat"):(i=e[0].toUpperCase()+e.slice(1),this.initHistory(i)),this.updateSectionFormat(e,t))},o.prototype.removeInlineHeaderFooterWidget=function(e,t,i,n){var r,o,s,a;0!=e&&(r=this.documentHelper.headersFooters[e],o=this.viewer.getHeaderFooter(t),s=this.selection.start.paragraph.containerWidget.sectionFormat.cloneFormat(),_.isNullOrUndefined(n)||(_.isNullOrUndefined(i)||(a=i[0].toUpperCase()+i.slice(1),this.initHistory(a),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.insertedFormat=n),a=this.selection.getParagraphInfo(this.selection.start),this.selection.editPosition=this.selection.getHierarchicalIndex(a.paragraph,a.offset.toString()),this.checkInsertPosition(this.selection)&&this.setPositionForHistory(this.selection.editPosition)),n?r&&!_.isNullOrUndefined(r[o])&&(s.removedHeaderFooters.push(r[o]),this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(s,i,n),delete r[o]):(a=this.viewer.getCurrentHeaderFooter(t,e),!_.isNullOrUndefined(a)&&_.isNullOrUndefined(r[o])&&(t=a.clone(),r[o]=t,s.removedHeaderFooters.push(t),this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(s,i,n))),this.selection.updateTextPositionForBlockContainer(this.selection.start.paragraph.containerWidget),this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.layoutWholeDocument(),this.isSkipOperationsBuild=!1,this.fireContentChange()))},o.prototype.updateHeaderFooters=function(e,t,i,n){var r=this.documentHelper.headersFooters[i],o=this.viewer.getHeaderFooter(n.headerFooterType),s=r[o];(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(_.isNullOrUndefined(s)?this.documentHelper.headersFooters[i][o]=n:_.isNullOrUndefined(s)||delete r[o]),this.selection.updateTextPositionForBlockContainer(this.selection.start.paragraph.containerWidget),this.layoutWholeDocument()},o.prototype.updateSectionFormat=function(e,t){1===this.documentHelper.selection.startPage&&"differentFirstPage"===e&&(o=void 0,o=this.documentHelper.selection.start.paragraph.containerWidget instanceof N?this.getFirstChildOfTable(this.documentHelper.selection.start.paragraph.containerWidget):this.documentHelper.selection.start.paragraph.containerWidget.childWidgets[0],o=this.selection.getHierarchicalIndex(o,"0"),this.documentHelper.selection.select(o,o));for(var i,n,r=this.documentHelper.selection,o=(r.owner.isShiftingEnabled=!0,r.start),s=r.end,a=(r.isForward||(o=r.end,s=r.start),this.documentHelper.clearContent(),o.paragraph.bodyWidget.sectionIndex),l=s.paragraph.bodyWidget.sectionIndex,d=!1,h=!1,c=0;c<this.documentHelper.pages.length;c++){for(var p=0;p<this.documentHelper.pages[c].bodyWidgets.length;p++)if(this.documentHelper.pages[c].bodyWidgets[p].index===a){if(i=c,r.isForward){h=!0;break}}else d=!0;if(h)break}for(c=i;c<this.documentHelper.pages.length;c++)for(p=0;p<this.documentHelper.pages[c].bodyWidgets.length;p++){var u=this.documentHelper.pages[c].bodyWidgets[p];(u.index===a||u.index>=a&&u.index<=l)&&(n=c)}d&&"differentOddAndEvenPages"==e&&o.paragraph.isInHeaderFooter&&(i=0,n=this.documentHelper.pages.length-1);for(var g=!0,m=0,c=i;c<=n;c++)for(var f,p=0;p<this.documentHelper.pages[c].bodyWidgets.length;p++)(this.documentHelper.pages[c].bodyWidgets[p].index>=a&&this.documentHelper.pages[c].bodyWidgets[p].index<=l||!r.isForward&&this.documentHelper.pages[c].bodyWidgets[p].index<=a&&this.documentHelper.pages[c].bodyWidgets[p].index>=l)&&(m!==this.documentHelper.pages[c].bodyWidgets[p].index&&(g=g||!0),this.applyPropertyValueForSection(this.documentHelper.pages[c].bodyWidgets[p].sectionFormat,e,t,g),m=this.documentHelper.pages[c].bodyWidgets[p].index,g=!1,f=this.documentHelper.pages[c].bodyWidgets[p],_.isNullOrUndefined(f.nextWidget)||f.sectionFormat.pageHeight===f.nextWidget.sectionFormat.pageHeight&&f.sectionFormat.pageWidth===f.nextWidget.sectionFormat.pageWidth||"NoBreak"!==f.nextWidget.sectionFormat.breakCode||(f.nextWidget.sectionFormat.breakCode="NewPage",f=this.documentHelper.layout.getBodyWidget(f.nextWidget,!1),_.isNullOrUndefined(f.nextWidget))||(f.nextWidget.sectionFormat.breakCode="NewPage"));this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.layoutWholeDocument(),this.isSkipOperationsBuild=!1,this.fireContentChange()},o.prototype.getFirstChildOfTable=function(e){return e.ownerTable.childWidgets[0].childWidgets[0].childWidgets[0]},o.prototype.onApplyTableFormat=function(e,t,i){var n,r;this.restrictFormatting||(n=this.getTableFormatAction(e),this.viewer.owner.isShiftingEnabled=!0,r=this.documentHelper.selection,i=(i=_.isNullOrUndefined(i)?r.start.paragraph.associatedCell.ownerTable:i).combineWidget(this.owner.viewer),r.isEmpty?(this.initHistory(n),this.applyTablePropertyValue(e,t,i)):this.updateSelectionTableFormat(this.selection,n,t),i.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(i),this.reLayout(r,!1))},o.prototype.getTableFormatAction=function(e){switch(e){case"tableAlignment":return"TableAlignment";case"leftIndent":return"TableLeftIndent";case"leftMargin":return"DefaultCellLeftMargin";case"rightMargin":return"DefaultCellRightMargin";case"bottomMargin":return"DefaultCellBottomMargin";case"topMargin":return"DefaultCellTopMargin";case"preferredWidth":return"TablePreferredWidth";case"preferredWidthType":return"TablePreferredWidthType";case"shading":return"Shading";case"bidi":return"TableBidi";case"title":return"TableTitle";case"description":return"TableDescription";default:return"DefaultCellSpacing"}},o.prototype.onApplyTableRowFormat=function(e,t){var i,n;this.restrictFormatting||(i=this.getRowAction(e),this.documentHelper.owner.isShiftingEnabled=!0,(n=this.documentHelper.selection).isEmpty?(this.initHistory(i),n.start.paragraph.associatedCell.ownerRow.ownerTable,this.applyRowPropertyValue(n,e,t,n.start.paragraph.associatedCell.ownerRow)):this.updateSelectionTableFormat(this.selection,i,t),this.reLayout(n,!1))},o.prototype.getRowAction=function(e){switch(e){case"height":return"RowHeight";case"heightType":return"RowHeightType";case"isHeader":return"RowHeader";default:return"AllowBreakAcrossPages"}},o.prototype.onApplyTableCellFormat=function(e,t){var i,n,r;this.restrictFormatting||(i=this.getTableCellAction(e),this.documentHelper.owner.isShiftingEnabled=!0,r=(r=(n=this.documentHelper.selection).start.paragraph.associatedCell.ownerTable).combineWidget(this.owner.viewer),n.isEmpty?(this.initHistory(i),this.applyCellPropertyValue(n,e,t,n.start.paragraph.associatedCell.cellFormat),r.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(r)):this.updateSelectionTableFormat(this.selection,i,t),this.reLayout(n,!1))},o.prototype.getTableCellAction=function(e){switch(e){case"verticalAlignment":return"CellContentVerticalAlignment";case"leftMargin":return"CellLeftMargin";case"rightMargin":return"CellRightMargin";case"bottomMargin":return"CellBottomMargin";case"topMargin":return"CellTopMargin";case"preferredWidth":return"CellPreferredWidth";case"shading":return"Shading";default:return"CellPreferredWidthType"}},o.prototype.applyPropertyValueForSection=function(e,t,i,n){n&&this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&("columns"===t&&(e.numberOfColumns=i.length),i=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(e,t,i),this.editorHistory.currentBaseHistoryInfo.insertedFormat=i),_.isNullOrUndefined(i)||(i instanceof Ma?_.isNullOrUndefined(t)&&e.copyFormat(i,this.editorHistory):"pageHeight"===t?e.pageHeight=i:"pageWidth"===t?e.pageWidth=i:"leftMargin"===t?e.leftMargin=i:"rightMargin"===t?e.rightMargin=i:"topMargin"===t?e.topMargin=i:"bottomMargin"===t?e.bottomMargin=i:"differentFirstPage"===t?e.differentFirstPage=i:"differentOddAndEvenPages"===t?e.differentOddAndEvenPages=i:"headerDistance"===t?e.headerDistance=i:"footerDistance"===t?e.footerDistance=i:"pageStartingNumber"===t?e.pageStartingNumber=i:"restartPageNumbering"===t?e.restartPageNumbering=i:"endnoteNumberFormat"===t?e.endnoteNumberFormat=i:"footNoteNumberFormat"===t?e.footNoteNumberFormat=i:"restartIndexForEndnotes"===t?e.restartIndexForEndnotes=i:"restartIndexForFootnotes"===t?e.restartIndexForFootnotes=i:"initialFootNoteNumber"===t?e.initialFootNoteNumber=i:"initialEndNoteNumber"===t?e.initialEndNoteNumber=i:"numberOfColumns"==t?e.numberOfColumns=i:"equalWidth"==t?e.equalWidth=i:"lineBetweenColumns"==t?e.lineBetweenColumns=i:"columns"==t&&(e.columns=i))},o.prototype.layoutWholeDocument=function(e,t){this.documentHelper.layout.isInitialLoad=!0,this.documentHelper.layout.isLayoutWhole=!0;var i=this.documentHelper.selection.start,n=this.documentHelper.selection.end,r=(i.isExistAfter(n)&&(i=this.documentHelper.selection.end,n=this.documentHelper.selection.start),"Continuous"==this.owner.layoutType&&(this.documentHelper.selection.isinEndnote||this.documentHelper.selection.isinFootnote)&&(this.documentHelper.selection.footnoteReferenceElement(i,n),i=n),this.selection.getParagraphInfo(i)),o=this.selection.getParagraphInfo(n),r=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),o=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),s=(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.combineSection());t||this.documentHelper.clearContent(),this.documentHelper.layout.layoutItems(s,!0),this.documentHelper.owner.isShiftingEnabled=!1,this.setPositionForCurrentIndex(i,r),this.setPositionForCurrentIndex(n,o),this.documentHelper.selection.selectPosition(i,n),this.reLayout(this.documentHelper.selection,void 0,e),this.documentHelper.layout.isLayoutWhole=!1,this.documentHelper.layout.isInitialLoad=!1},o.prototype.combineSection=function(){var e=[],t=this.documentHelper.pages[0].bodyWidgets[0];for(this.documentHelper.removeEmptyPages(!0);t=this.combineSectionChild(t,e,!1););for(var i=0;i<this.documentHelper.pages.length;i++)this.documentHelper.pages[i].destroy(),i--;return e},o.prototype.combineFollowingSection=function(){for(var e=[],t=this.documentHelper.selection.start.paragraph.bodyWidget.getSplitWidgets()[0],i=(t.childWidgets[0]instanceof G?this.updateWholeListItems(t.childWidgets[0]):(i=this.documentHelper.getFirstParagraphInFirstCell(t.childWidgets[0]),this.viewer.owner.editorModule.updateWholeListItems(i)),this.documentHelper.pages.indexOf(t.page)),n=0===t.indexInOwner?i:i+1;t=this.combineSectionChild(t,e,!1););for(var r=n;r<this.documentHelper.pages.length;r++)this.documentHelper.pages[r].destroy(),r--;for(var o=i;o<this.documentHelper.pages.length;o++)for(var s=0;s<this.documentHelper.pages[o].bodyWidgets.length;s++)0===this.documentHelper.pages[o].bodyWidgets[s].childWidgets.length&&(this.documentHelper.pages[o].bodyWidgets.splice(s,1),s--);return e},o.prototype.combineSectionChild=function(e,t,i){var n=e,r=new z,o=!1;r.sectionFormat=e.sectionFormat,r.index=n.index;do{o=!1,(n=e).lastChild&&e.lastChild.combineWidget(this.owner.viewer),e=e.nextRenderedWidget;for(var s=0;s<n.childWidgets.length;s++){var a=n.childWidgets[s];a instanceof K?this.documentHelper.layout.clearTableWidget(a,!0,!0,!0):(a.x=0,a.y=0,a.width=0,a.height=0),r.childWidgets.push(a),n.childWidgets.splice(s,1),s--,a.containerWidget=r}for(var l=0;l<n.page.bodyWidgets.length;l++){if(0!==n.page.bodyWidgets[l].childWidgets.length){o=!1;break}o=!0}}while(o&&i&&n.page.destroy(),e&&n.index===e.index);return t.push(r),e},o.prototype.updateSelectionTableFormat=function(e,t,i){switch(t){case"TableAlignment":this.editorHistory.initializeHistory("TableAlignment"),this.updateTableFormat(e,"tableAlignment",i);break;case"TableLeftIndent":this.editorHistory.initializeHistory("TableLeftIndent"),this.updateTableFormat(e,"leftIndent",i);break;case"DefaultCellSpacing":this.editorHistory.initializeHistory("DefaultCellSpacing"),this.updateTableFormat(e,"cellSpacing",i);break;case"DefaultCellLeftMargin":this.editorHistory.initializeHistory("DefaultCellLeftMargin"),this.updateTableFormat(e,"leftMargin",i);break;case"DefaultCellRightMargin":this.editorHistory.initializeHistory("DefaultCellRightMargin"),this.updateTableFormat(e,"rightMargin",i);break;case"DefaultCellTopMargin":this.editorHistory.initializeHistory("DefaultCellTopMargin"),this.updateTableFormat(e,"topMargin",i);break;case"TablePreferredWidth":this.editorHistory.initializeHistory("TablePreferredWidth"),this.updateTableFormat(e,"preferredWidth",i);break;case"TablePreferredWidthType":this.editorHistory.initializeHistory("TablePreferredWidthType"),this.updateTableFormat(e,"preferredWidthType",i);break;case"DefaultCellBottomMargin":this.editorHistory.initializeHistory("DefaultCellBottomMargin"),this.updateTableFormat(e,"bottomMargin",i);break;case"CellContentVerticalAlignment":this.editorHistory.initializeHistory("CellContentVerticalAlignment"),this.updateCellFormat(e,"verticalAlignment",i);break;case"CellLeftMargin":this.editorHistory.initializeHistory("CellLeftMargin"),this.updateCellFormat(e,"leftMargin",i);break;case"CellRightMargin":this.editorHistory.initializeHistory("CellRightMargin"),this.updateCellFormat(e,"rightMargin",i);break;case"CellTopMargin":this.editorHistory.initializeHistory("CellTopMargin"),this.updateCellFormat(e,"topMargin",i);break;case"CellBottomMargin":this.editorHistory.initializeHistory("CellBottomMargin"),this.updateCellFormat(e,"bottomMargin",i);break;case"CellPreferredWidth":this.editorHistory.initializeHistory("CellPreferredWidth"),this.updateCellFormat(e,"preferredWidth",i);break;case"CellPreferredWidthType":this.editorHistory.initializeHistory("CellPreferredWidthType"),this.updateCellFormat(e,"preferredWidthType",i);break;case"Shading":this.editorHistory.initializeHistory("Shading"),this.updateCellFormat(e,"shading",i);break;case"RowHeight":this.editorHistory.initializeHistory("RowHeight"),this.updateRowFormat(e,"height",i);break;case"RowHeightType":this.editorHistory.initializeHistory("RowHeightType"),this.updateRowFormat(e,"heightType",i);break;case"RowHeader":this.editorHistory.initializeHistory("RowHeader"),this.updateRowFormat(e,"isHeader",i);break;case"AllowBreakAcrossPages":this.editorHistory.initializeHistory("AllowBreakAcrossPages"),this.updateRowFormat(e,"allowBreakAcrossPages",i);break;case"TableBidi":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"bidi",i);break;case"TableTitle":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"title",i);break;case"TableDescription":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"description",i)}},o.prototype.updateTableFormat=function(e,t,i){var n=e.start;e.end;e.isForward||(n=e.end,e.start),this.initHistoryPosition(e,n),this.applyTablePropertyValue(t,i,n.paragraph.associatedCell.ownerTable),this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&this.documentHelper.layout.reLayoutTable(n.paragraph.associatedCell.ownerTable)},o.prototype.updateCellFormat=function(e,t,i){e.owner.isShiftingEnabled=!0;var n=e.start;e.end;e.isForward||(n=e.end,e.start),this.initHistoryPosition(e,n),this.updateFormatForCell(e,t,i)},o.prototype.updateRowFormat=function(e,t,i){var n=e.start,r=e.end;e.isForward||(n=e.end,r=e.start),this.initHistoryPosition(e,n),this.applyRowFormat(n.paragraph.associatedCell.ownerRow,n,r,t,i)},o.prototype.initHistoryPosition=function(e,t){this.documentHelper.owner.editorHistoryModule&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(_.isNullOrUndefined(t)?_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.start.getHierarchicalIndexInternal()):_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=t.getHierarchicalIndexInternal()))},o.prototype.startSelectionReLayouting=function(e,t,i,n){if(t.owner.isLayoutEnabled=!0,i.paragraph.isInsideTable){for(var r=i.paragraph.associatedCell.ownerTable;r.isInsideTable;)r=r.associatedCell.ownerTable;this.reLayoutSelectionOfTable(r,t,i,n)}else this.reLayoutSelection(e,t,i,n)},o.prototype.reLayoutSelectionOfTable=function(e,t,i,n){var r=!1;return this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),!(_.isNullOrUndefined(n.paragraph.associatedCell)||!e.contains(n.paragraph.associatedCell))||(e=t.getNextRenderedBlock(e),_.isNullOrUndefined(e)?r:this.reLayoutSelectionOfBlock(e,t,i,n))},o.prototype.reLayoutSelection=function(e,t,i,n){var r,o,s,a;return i.paragraph===e?(i.offset,t.getParagraphLength(e),o=(s=e.getInline(i.offset,r=a=0)).element,a=s.index,_.isNullOrUndefined(o)||(r=(o=a!==o.length||_.isNullOrUndefined(o.nextNode)?o:o.nextNode).line.children.indexOf(o)),s=0,i.currentWidget.paragraph===e&&(s=e.childWidgets.indexOf(i.currentWidget),r=i.currentWidget.children.indexOf(o)),o instanceof X&&!o.line&&0<r?this.documentHelper.layout.reLayoutParagraph(e,s,r-1):this.documentHelper.layout.reLayoutParagraph(e,s,r)):this.documentHelper.layout.reLayoutParagraph(e,0,0),n.paragraph===e||(a=t.getNextRenderedBlock(e),!_.isNullOrUndefined(a)&&this.reLayoutSelectionOfBlock(a,t,i,n))},o.prototype.reLayoutSelectionOfBlock=function(e,t,i,n){if(e instanceof G)return this.reLayoutSelection(e,t,i,n)},o.prototype.layoutItemBlock=function(e,t){var i;e.containerWidget instanceof _d||e.containerWidget instanceof fc?!_.isNullOrUndefined(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&(i=(e=e.combineWidget(this.viewer)).containerWidget,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,i,e,!1)):e.containerWidget instanceof N&&(i=e.containerWidget,i=this.documentHelper.selection.getContainerCell(i),!_.isNullOrUndefined(this.documentHelper.owner))&&this.documentHelper.owner.isLayoutEnabled&&this.documentHelper.layout.reLayoutTable(e)},o.prototype.removeSelectedContents=function(e){return this.removeSelectedContentInternal(e,e.start,e.end)},o.prototype.removeSelectedContentInternal=function(e,t,i){var n,r,o,s=t,a=i;return t.isExistBefore(i)||(s=i,a=t),s.paragraph===a.paragraph&&s.paragraph.childWidgets.indexOf(s.currentWidget)===s.paragraph.childWidgets.length-1&&s.offset===e.getParagraphLength(s.paragraph)&&s.offset+1===a.offset?(e.owner.isShiftingEnabled=!0,e.selectContent(s,!0),!0):(i=this.selection.getParagraphInfo(s),e.editPosition=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()),i=(t=s.clone()).paragraph.containerWidget,r=t.currentWidget.isFirstLine(),n=this.checkMultipleSectionSelected(t,a),s=this.removeSelectedContent(a.paragraph,e,s,a),a=new y(e.owner),n&&"DefaultPaste"==this.selection.currentPasteAction&&r&&t.offset<1&&(n=t.paragraph,r=new G,((o=new uh(r)).paragraph=r).containerWidget=i,r.childWidgets.push(o),i.childWidgets.push(r),r.index=n.index,r.x=t.location.x,r.y=t.location.y),this.setPositionForCurrentIndex(a,e.editPosition),e.selectContent(a,!0),s)},o.prototype.checkMultipleSectionSelected=function(e,t){return this.getBodyWidgetIndex(e)!=this.getBodyWidgetIndex(t)},o.prototype.getBodyWidgetIndex=function(e){var e=e.hierarchicalPosition,t=e.indexOf(";"),t=(e.substring(0,t),(e=e.substring(t).replace(";","")).indexOf(";")),e=e.substring(0,t);return parseInt(e,10)},o.prototype.removeSelectedContent=function(e,t,i,n){return!(n.paragraph.isInsideTable&&n.paragraph!==this.documentHelper.getLastParagraphInLastCell(n.paragraph.associatedCell.ownerTable)&&(!i.paragraph.isInsideTable||i.paragraph.associatedCell.ownerTable.index!==n.paragraph.associatedCell.ownerTable.index)||(t.owner.isShiftingEnabled=!0,this.deleteSelectedContent(e,t,i,n,2),0))},o.prototype.deleteSelectedContent=function(e,t,i,n,r,o){var s=i.currentWidget.getInline(i.offset,0);s.element,s.index,(s=n.currentWidget.getInline(n.offset,0)).element;s.index,n.paragraph!==e?this.deleteSelectedContent(n.paragraph,t,i,n,r):n.paragraph.isInsideTable&&(!i.paragraph.isInsideTable||i.paragraph.associatedCell&&!i.paragraph.associatedCell.equals(n.paragraph.associatedCell)||t.isCellSelected(n.paragraph.associatedCell,i,n)&&o)?(n.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.deleteTableCell(n.paragraph.associatedCell,t,i,n,r,o)):(s=void 0,this.owner.viewer instanceof Sd&&1<e.bodyWidget.sectionFormat.numberOfColumns&&e===e.bodyWidget.lastChild&&!_.isNullOrUndefined(e.bodyWidget.nextRenderedWidget)&&e.bodyWidget.index!==e.bodyWidget.nextRenderedWidget.index&&e.bodyWidget.page===e.bodyWidget.nextRenderedWidget.page&&(s=e.nextRenderedWidget),this.deletePara(e,i,n,r),this.delBlockContinue&&this.delBlock&&(this.delSection&&(o=e.bodyWidget instanceof z?e.bodyWidget:void 0,this.deleteSection(t,this.delSection,o,r),this.delSection=void 0),this.deleteBlock(this.delBlock,t,i,n,r),this.delBlockContinue=!1,this.delBlock=void 0),this.owner.viewer instanceof Sd&&void 0!==s&&(this.documentHelper.blockToShift=s))},o.prototype.mergeCells=function(){this.owner.isReadOnlyMode||!this.canEditContentControl||!this.owner.isDocumentLoaded||_.isNullOrUndefined(this.documentHelper)||this.selection.isEmpty||this.mergeSelectedCellsInTable()},o.prototype.deleteTable=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var e=this.selection.isForward?this.selection.start:this.selection.end;if(e.paragraph.isInsideTable){var t=this.getOwnerTable(this.selection.isForward).combineWidget(this.owner.viewer),i=(this.selection.selectTable(),[]),e=(this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&(i=this.checkAndRemoveComments(),this.initHistory("DeleteTable"),this.updateHistoryPosition(e,!0)),!0);if(!this.skipTracking()){for(var n=0,r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r];1===o.rowFormat.revisions.length&&"Insertion"===o.rowFormat.revisions[0].revisionType&&o.rowFormat.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)&&(this.isRemoveRevision=!0,this.unlinkRangeFromRevision(o.rowFormat,!0),this.isRemoveRevision=!1,0===o.rowFormat.revisions[0].range.length&&o.rowFormat.revisions.splice(0,1),n++)}n===t.childWidgets.length&&(e=!1)}var s=this.getParagraphForSelection(t);if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.insertedText=L.Table,this.editorHistory.currentBaseHistoryInfo.removedNodes.push(t.clone())),this.owner.enableTrackChanges&&e)for(var a,r=0;r<t.childWidgets.length;r++)0===r&&(a=t.childWidgets[0],s=this.selection.getFirstParagraph(a)),this.trackRowDeletion(t.childWidgets[r]);else this.removeBlock(t);this.selection.selectParagraphInternal(s,!0),(this.checkIsNotRedoing()||_.isNullOrUndefined(this.editorHistory))&&(this.reLayout(this.selection),this.updateHistoryForComments(i))}}},o.prototype.deleteColumn=function(){var e;!this.owner.isReadOnlyMode&&this.canEditContentControl&&(this.owner.enableTrackChanges?((e=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.owner.locale),this.alertDialog=C.DialogUtility.alert({title:e.getConstant("UnTrack"),content:e.getConstant("Merge Track"),showCloseIcon:!0,okButton:{text:"Ok",click:this.onDeleteColumnConfirmed.bind(this)},closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}),this.alertDialog.enableRtl=this.owner.enableRtl):this.onDeleteColumnConfirmed())},o.prototype.onDeleteColumnConfirmed=function(){var e,t,i,n,r,o=this.selection.isForward?this.selection.start:this.selection.end;this.selection.isForward?this.selection.end:this.selection.start;o.paragraph.isInsideTable&&(o=this.selection.start.clone(),t=this.selection.end.clone(),this.selection.selectColumn(),e=[],this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&(e=this.checkAndRemoveComments(),this.selection.start.setPositionInternal(o),this.selection.end.setPositionInternal(t),this.initHistory("DeleteColumn")),this.selection.start.setPositionInternal(o),this.selection.end.setPositionInternal(t),o=this.getOwnerCell(this.selection.isForward),t=this.getOwnerCell(!this.selection.isForward),i=o.ownerTable.combineWidget(this.owner.viewer),n=void(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(i)),t.nextWidget?(r=t.nextWidget,n=this.selection.getFirstParagraph(r)):o.previousWidget&&(r=o.previousWidget,n=this.selection.getFirstParagraph(r)),_.isNullOrUndefined(n)&&(n=this.getParagraphForSelection(i)),r=i.getColumnCellsForSelection(o,t),this.onDeleteColumn(i,r),0===i.childWidgets.length?(n=this.getParagraphForSelection(i),this.removeBlock(i),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),i.destroy()):this.updateTable(i),this.selection.selectParagraphInternal(n,!0),(_.isNullOrUndefined(this.editorHistory)||this.checkIsNotRedoing())&&(this.reLayout(this.selection,!0),this.updateHistoryForComments(e)),_.isNullOrUndefined(this.alertDialog)||(this.alertDialog.close(),this.alertDialog=void 0))},o.prototype.onDeleteColumn=function(e,t){for(var i=0,n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(1===r.childWidgets.length)0<=t.indexOf(r.childWidgets[0])&&(this.removeFieldInWidget(r.childWidgets[0],!0),e.childWidgets.splice(e.childWidgets.indexOf(r),1),r.destroy(),i+=1,n--);else{for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];0<=t.indexOf(s)&&(this.removeFieldInWidget(s,!0),r.childWidgets.splice(o,1),s.destroy(),o--)}0===r.childWidgets.length&&(e.childWidgets.splice(e.childWidgets.indexOf(r),1),r.destroy(),i+=1,n--)}}return i},o.prototype.deleteRow=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var e=this.selection.isForward?this.selection.start:this.selection.end,t=(this.selection.isForward?this.selection.end:this.selection.start,this.selection.getParagraphInfo(e)),t=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString());if(e.paragraph.isInsideTable){var i=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward),r=(this.selection.selectRow(),[]),o=(this.checkIsNotRedoing()&&(r=this.checkAndRemoveComments(),this.initHistory("DeleteRow")),this.selection.owner.isShiftingEnabled=!0,i.ownerTable.combineWidget(this.owner.viewer)),s=this.getOwnerRow(!0),a=(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(o),void 0);if(s.nextWidget&&(l=s.nextWidget.childWidgets[0],a=this.selection.getFirstParagraph(l)),_.isNullOrUndefined(a)&&(a=this.getParagraphForSelection(o)),e=e.clone(),this.selection.isEmpty)this.owner.enableTrackChanges?this.trackRowDeletion(s,!0,!1):this.removeRow(s);else{var e=this.selection.getContainerCellOf(i,n);if(e.ownerTable.contains(n))if(i=this.selection.getSelectedCell(i,e),n=this.selection.getSelectedCell(n,e),this.selection.containsCell(e,n))s=i.ownerRow,this.owner.enableTrackChanges?(_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack",this.editorHistory.currentBaseHistoryInfo.insertedText=L.Row),this.trackRowDeletion(s,!0,!1)):this.removeRow(s);else{var l,s=i.ownerRow,d=n.ownerRow;a=void 0,d.nextWidget&&(l=d.nextWidget.childWidgets[0],a=this.selection.getFirstParagraph(l)),_.isNullOrUndefined(a)&&(a=this.getParagraphForSelection(o));for(var h=0;h<o.childWidgets.length;h++){var c=o.childWidgets[h];c.rowIndex>=s.rowIndex&&c.rowIndex<=d.rowIndex&&(this.owner.enableTrackChanges&&this.checkIsNotRedoing()?this.trackRowDeletion(c,!0,!1):(this.removeFieldInBlock(c,!0),o.childWidgets.splice(h,1),c.destroy(),h--))}0===o.childWidgets.length?(this.removeBlock(o),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),o.destroy()):this.updateTable(o)}}!this.owner.enableTrackChanges||_.isNullOrUndefined(o.childWidgets)?this.selection.selectParagraphInternal(a,!0):(e=this.selection.getTextPosBasedOnLogicalIndex(t),this.selection.selectContent(e,!0)),(_.isNullOrUndefined(this.editorHistory)||this.checkIsNotRedoing())&&(this.reLayout(this.selection,!0),this.updateHistoryForComments(r))}}},o.prototype.trackRowDeletion=function(e,t,i,n){var r=e.rowFormat;if(!_.isNullOrUndefined(r)){var o=!0;if(0<r.revisions.length){var s=this.retrieveRevisionInOder(r);if("Insertion"===s.revisionType){if(this.isRevisionMatched(r,void 0))return _.isNullOrUndefined(t)||t?this.removeRow(e):this.removeRevisionsInRow(e),!0}else"Deletion"===s.revisionType&&(this.unlinkWholeRangeInRevision(r,s),o=!(!this.owner.enableTrackChanges||this.skipTracking()))}o&&((_.isNullOrUndefined(i)||i)&&this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack"),this.insertRevision(r,"Deletion"));for(var a=0;a<e.childWidgets.length;a++)for(var l,d=e.childWidgets[a],h=0;h<d.childWidgets.length;h++)d.childWidgets[h]instanceof K?this.trackInnerTable(d.childWidgets[h],t,i):(l=d.childWidgets[h],this.skipTableElements=!0,o&&!this.skipTracking()&&0!==n&&this.insertRevisionForBlock(l,"Deletion",void 0,void 0,!0,void 0,!0)&&h--,this.skipTableElements=!1)}return!1},o.prototype.trackInnerTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)this.trackRowDeletion(e.childWidgets[n],t,i)},o.prototype.returnDeleteRevision=function(e){for(var t=0;t<e.length;t++)if("Deletion"===e[t].revisionType)return e[t]},o.prototype.removeRow=function(e){var t=e.ownerTable;0<e.rowFormat.revisions.length&&this.removeRevisionsInRow(e),1===t.childWidgets.length?(this.removeBlock(t),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="Delete"),t.destroy()):(this.removeFieldInBlock(e,!0),t.childWidgets.splice(t.childWidgets.indexOf(e),1),e.destroy(),this.updateTable(t))},o.prototype.updateTable=function(e,t){(e=t?e:e.combineWidget(this.viewer)).updateRowIndex(0),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e)},o.prototype.getParagraphForSelection=function(e){var t=void 0,i=e.nextWidget||e.nextRenderedWidget,e=e.previousWidget||e.previousRenderedWidget;return i?t=i instanceof G?i:this.documentHelper.getFirstParagraphInFirstCell(i):e&&(t=e instanceof G?e:this.documentHelper.getLastParagraphInLastCell(e)),t},o.prototype.deletePara=function(e,t,i,n){e=e.combineWidget(this.owner.viewer);var r=this.documentHelper.selection,o=r.getStartOffset(e),s=r.getStartOffset(i.paragraph),a=o,l=0,d=!1,h=this.selection.getLineLength(e.lastChild),c=e,p=e.bodyWidget instanceof z?e.bodyWidget:void 0,u=void 0,g=void 0,m=this.combineLastBlock,f=(e===t.paragraph?(a=t.offset,u=t.currentWidget,(y=a)+1===this.documentHelper.selection.getLineLength(e.lastChild)&&a++,d=(d=!i.paragraph.isInsideTable||this.owner.enableTrackChanges&&!this.skipTracking()?d:this.isEndInAdjacentTable(e,i.paragraph))||this.combineLastBlock,this.combineLastBlock=!1):u=e.firstChild,e!==t.paragraph&&r.isSkipLayouting&&(r.isSkipLayouting=!1),l=e===i.paragraph?(g=i.currentWidget,i.offset):(g=e.lastChild,this.documentHelper.selection.getLineLength(e.lastChild)),_.isNullOrUndefined(e.previousRenderedWidget)||t.paragraph===e?void 0:e.previousRenderedWidget.combineWidget(this.documentHelper.viewer));if(this.owner.enableTrackChanges&&!_.isNullOrUndefined(f)&&f instanceof K&&e.isEmpty()&&_.isNullOrUndefined(e.nextRenderedWidget))this.delBlockContinue=!0,this.delBlock=f;else{!(o<a&&t.currentWidget===e.lastChild&&a===h&&(e===i.paragraph&&i.offset===a+1||e.nextRenderedWidget===i.paragraph&&i.offset===s)||this.editorHistory&&this.editorHistory.isUndoing&&this.editorHistory.currentHistoryInfo&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&f&&f.isPageBreak()&&(0===a&&!t.currentWidget.isFirstLine||0<a)||t.paragraph!==i.paragraph&&2===n&&t.paragraph===e&&t.paragraph.nextWidget===i.paragraph&&!this.owner.enableTrackChanges)&&(e.nextRenderedWidget instanceof K||_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||!("Reject Change"===this.editorHistory.currentBaseHistoryInfo.action&&t.paragraph===e&&i.paragraph!=e&&o<=a||"Accept Change"===this.editorHistory.currentBaseHistoryInfo.action&&t.currentWidget.isLastLine()&&(t.currentWidget==i.currentWidget&&t.offset+1>=i.paragraph.getLength()||t.currentWidget!==i.currentWidget&&t.paragraph===e)))||(d=!0),y+1===this.documentHelper.selection.getLineLength(e.lastChild)&&a--;var h=i.clone(),s=(h.offset=h.offset-1,!1),y=(!this.editorHistory||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||"Insert"!==this.editorHistory.currentBaseHistoryInfo.action&&"InsertTextParaReplace"!==this.editorHistory.currentBaseHistoryInfo.action||i.paragraph!==e||l!==r.getLineLength(e.lastChild)+1||(s=!0),t.paragraph===e&&t.isAtParagraphStart&&h.isAtParagraphEnd&&this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&"Insert"===this.editorHistory.currentBaseHistoryInfo.action),h=(y&&(this.editorHistory.currentBaseHistoryInfo.action="InsertTextParaReplace",i.paragraph!==e)&&this.owner.enableTrackChanges&&2===n&&(y=!1),t.paragraph===e);if(i.paragraph===e&&i.currentWidget!==e.lastChild||i.currentWidget===e.lastChild&&i.offset<=r.getLineLength(e.lastChild)||y)(i.currentWidget.isFirstLine()&&i.offset>o||!i.currentWidget.isFirstLine()||y)&&this.removeInlines(e,u,a,g,l,n),_.isNullOrUndefined(f)||h||y?(this.delBlockContinue=!1,this.delBlock=void 0):(this.delBlockContinue=!0,(x=(this.delBlock=f).bodyWidget instanceof z?f.bodyWidget:void 0)&&!p.equals(x)&&p.index!==x.index?this.delSection=x:this.delSection=void 0);else{if(t.paragraph===e&&(t.currentWidget!==e.firstChild||t.currentWidget===e.firstChild&&o<a))return this.delBlockContinue=!1,this.delBlock=void 0,4===n?void 0:void(this.skipTracking()&&"ParaMarkTrack"===this.editorHistory.currentBaseHistoryInfo.action?(this.addRemovedNodes(e.characterFormat.cloneFormat()),0<e.characterFormat.revisions.length&&this.unlinkRangeFromRevision(e.characterFormat,!0),e.characterFormat.revisions=[]):this.owner.enableTrackChanges&&!this.skipTracking()&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action&&"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action?d?(c=this.splitParagraph(e,e.firstChild,0,u,a,!0),this.deleteParagraphMark(c,r,n,!0),this.addRemovedNodes(e)):(t.paragraph!==i.paragraph&&a!==e.getLength()?((w=new G).childWidgets=void 0,this.addRemovedNodes(w),this.insertRevision(e.characterFormat,"Deletion")):(C=e==this.getLastParaForBodywidgetCollection(e))||this.handleDeleteParaMark(e,void 0),this.removeInlines(e,u,a,g,l,n),a!==e.getLength()&&(0<(w=e.lastChild).children.length&&(w=w.children[w.children.length-1],this.combineElementRevision(w.revisions,e.characterFormat.revisions)),e.isEmpty()?this.combineRevisionWithBlocks(e):this.combineRevisionWithBlocks(e.lastChild.children[e.lastChild.children.length-1]))):t.currentWidget.isFirstLine()||e.lastChild!==i.currentWidget||d?(!_.isNullOrUndefined(this.editorHistory)&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&"Reject Change"===this.editorHistory.currentBaseHistoryInfo.action&&t.paragraph===e&&i.paragraph!=e&&o<=a&&d&&(m=!0),c=this.splitParagraph(e,e.firstChild,0,u,a,!0),_.isNullOrUndefined(c)||_.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.deletaRevisionIDs(c.characterFormat),w=!1,i.paragraph.isEmpty()||!d||this.editorHistory&&this.editorHistory.currentHistoryInfo&&"PageBreak"===this.editorHistory.currentHistoryInfo.action||(w=!0),this.insertParagraphPaste(e,c,t,i,d,n,m,w),this.removeRevisionForBlock(e,void 0,!1,!0),this.addRemovedNodes(e),m=!1):this.removeInlines(e,u,a,g,l,n));(!this.owner.enableTrackChanges||this.skipTracking())&&i.paragraph===e&&i.paragraph.isInsideTable&&(t.currentWidget.isFirstLine()&&t.offset>r.getStartOffset(t.paragraph)||!t.currentWidget.isFirstLine())&&i.offset>=r.getLineLength(i.paragraph.lastChild)&&i.paragraph.nextRenderedWidget&&(this.combineLastBlock=!0);var v,o=void 0,w=e.previousWidget,u=w instanceof G?w:void 0,a=e.nextRenderedWidget;if(n<4){if(this.owner.enableTrackChanges&&!this.skipTracking()&&this.editorHistory.currentBaseHistoryInfo&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action){var b;this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.length,this.insertRevisionForBlock(e,"Deletion",void 0,void 0,void 0,s,void 0),e.characterFormat.revisions;if(e.isEmpty()?this.combineRevisionWithBlocks(e):this.combineRevisionWithBlocks(e.firstChild.children[0]),"Delete"!==this.editorHistory.currentBaseHistoryInfo.action||this.isInsertingTOC||((e===i.paragraph&&e.containerWidget&&!e.isEmpty()||_.isNullOrUndefined(t.paragraph.containerWidget)&&!_.isNullOrUndefined(i.paragraph.containerWidget)&&!i.paragraph.isEmpty())&&(b=this.selection.getParagraphInfo(i),this.selection.editPosition=this.selection.getHierarchicalIndex(b.paragraph,b.offset.toString())),e===t.paragraph&&(g=this.selection.getParagraph({index:this.selection.editPosition}),_.isNullOrUndefined(g.paragraph))&&(b=this.selection.getParagraphInfo(i),this.selection.editPosition=this.selection.getHierarchicalIndex(b.paragraph,b.offset.toString()))),t.paragraph!==e&&!_.isNullOrUndefined(f))return this.delBlockContinue=!0,void(this.delBlock=f)}else{o=this.checkAndInsertBlock(e,t,i,n,u),this.removeRevisionForBlock(e,void 0,!1,!0);var x,C=e==this.getLastParaForBodywidgetCollection(e),l=!1;if(this.owner.enableTrackChanges&&(C||s)){for(var I=e.childWidgets.length-1;-1<I;I--){var k=e.childWidgets[I];this.removeContent(k,0,this.documentHelper.selection.getLineLength(k),void 0,!1)}l=!0}else{w=this.selection.getNextParagraphBlock(e);C||e.isInsideTable||_.isNullOrUndefined(w)||e.bodyWidget.sectionIndex===w.bodyWidget.sectionIndex||(this.deleteSection(r,e.bodyWidget,w.bodyWidget,n),h=!0),this.addRemovedNodes(e.clone())}_.isNullOrUndefined(f)||h||y||(x=(this.delBlock=f).bodyWidget instanceof z?f.bodyWidget:void 0)&&p.index!==x.index&&(g=e.bodyWidget instanceof z?e.bodyWidget:void 0,this.deleteSection(r,x,g,n)),l||this.removeBlock(e)}this.documentHelper.blockToShift===e&&(this.documentHelper.blockToShift=void 0),_.isNullOrUndefined(o)?e!==t.paragraph||!_.isNullOrUndefined(a)&&(_.isNullOrUndefined(a)||_.isNullOrUndefined(a.bodyWidget)||_.isNullOrUndefined(p)||p.index===a.bodyWidget.index)||_.isNullOrUndefined(u)||(v=this.selection.getParagraphLength(u),r.editPosition=this.selection.getHierarchicalIndex(u,v.toString()),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(r.editPosition,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=r.editPosition)):(r.editPosition=this.selection.getHierarchicalIndex(o,"0"),v=r.getParagraphLength(o)+1,this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(o,v.toString())))}t.paragraph===e||_.isNullOrUndefined(f)?(this.delBlockContinue=!1,this.delBlock=void 0):(this.delBlockContinue=!0,this.delBlock=f)}this.insertParagraphPaste(e,c,t,i,d,n,m)}},o.prototype.deletaRevisionIDs=function(e){if(0<e.removedIds.length)for(;0<e.removedIds.length;)e.removedIds.splice(0,1)},o.prototype.deleteSection=function(e,t,i,n){var r,o,s,a;n<4&&(this.owner.enableCollaborativeEditing&&(s=o=void 0,a=this.owner.documentHelper.headersFooters[t.sectionIndex][0],_.isNullOrUndefined(a)||(o={paragraph:a.firstChild,offset:0},s=this.owner.selectionModule.getPositionInfoForHeaderFooter(o,{position:0,done:!1}),this.editorHistory.currentBaseHistoryInfo.headerFooterStart=s.position),0<(r=Object.keys(this.owner.documentHelper.headersFooters[t.sectionIndex]).length))&&(a=this.owner.documentHelper.headersFooters[t.sectionIndex][(r-1).toString()],_.isNullOrUndefined(a)||(r=this.owner.selectionModule.getParagraphLength(a.lastChild),o={paragraph:a.lastChild,offset:r+1},s=this.owner.selectionModule.getPositionInfoForHeaderFooter(o,{position:0,done:!1}),this.editorHistory.currentBaseHistoryInfo.headerFooterEnd=s.position)),this.combineSectionInternal(e,t,i)),2<n&&t.sectionFormat.copyFormat(i.sectionFormat)},o.prototype.combineSectionInternal=function(e,t,i){var n=t.getSplitWidgets()[0],r=[],o=n.y,r=(this.combineSectionChild(n,r,!0),(n=r[0]).lastChild.index),s=(this.updateBlockIndex(r+1,i.firstChild),0),a=i;a.y=o;for(var l=0;l<n.childWidgets.length;l++){var d=n.childWidgets.splice(l,1)[0];a.childWidgets.splice(s,0,d),d.containerWidget=a,this.documentHelper.layout.layoutBodyWidgetCollection(d.index,d.bodyWidget,d,!1),a=(d=d.getSplitWidgets().pop()).containerWidget,s=d.indexInOwner+1,l--}if(0<n.sectionIndex&&this.documentHelper.headersFooters[n.sectionIndex]){n.removedHeaderFooters=[];for(var h=this.documentHelper.headersFooters.splice(n.sectionIndex,1)[0],c=Object.keys(h),l=0;l<c.length;l++){var p=h[c[l]];this.removeFieldInWidget(p),this.removeFieldInWidget(p,!1,!0),p.page=void 0}n.removedHeaderFooters.push(h)}this.updateSectionIndex(void 0,i,!1),this.addRemovedNodes(n),this.documentHelper.removeEmptyPages(),!this.editorHistory||!this.editorHistory.isUndoing||this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.endRevisionLogicalIndex||this.editorHistory.currentBaseHistoryInfo.lastElementRevision)||(i.sectionFormat=t.sectionFormat);for(var u=i.page;this.documentHelper.layout.layoutHeaderFooter(u.bodyWidgets[0],this.viewer,u),u=u.nextPage;);},o.prototype.checkAndInsertBlock=function(e,t,i,n,r){if(e instanceof G&&e===t.paragraph||e instanceof K){var o=void 0;if(_.isNullOrUndefined(e.nextRenderedWidget)&&(_.isNullOrUndefined(r)||r.nextRenderedWidget instanceof K)){if(o=new G,1===n&&e instanceof G&&!_.isNullOrUndefined(e.paragraphFormat.baseStyle)&&"Normal"===e.paragraphFormat.baseStyle.name){if(o.characterFormat.copyFormat(e.characterFormat),_.isNullOrUndefined(e.previousRenderedWidget)&&0!==o.characterFormat.removedIds.length)for(;0<o.characterFormat.removedIds.length;)o.characterFormat.removedIds.splice(0,1);o.paragraphFormat.copyFormat(e.paragraphFormat)}o.index=e.index+1,o.containerWidget=e.containerWidget,e instanceof G&&(o.paragraphFormat.lineSpacing=e.paragraphFormat.lineSpacing,o.paragraphFormat.lineSpacingType=e.paragraphFormat.lineSpacingType,t=this.documentHelper.styles.findByName("Normal"),_.isNullOrUndefined(t)||(o.paragraphFormat.baseStyle=new ul,o.paragraphFormat.baseStyle.copyStyle(t))),this.documentHelper.layout.layoutBodyWidgetCollection(o.index,o.bodyWidget,o,!1),e.containerWidget instanceof Vd&&e.containerWidget.childWidgets.push(o)}return o}},o.prototype.splitParagraph=function(e,t,i,n,r,o){var s=new G,a=(s.paragraphFormat=new Xa(s),s.characterFormat=new B(s),s.paragraphFormat.copyFormat(e.paragraphFormat),s.characterFormat.copyFormat(e.characterFormat),new uh(s)),a=(s.childWidgets.push(a),e.index),l=e.indexInOwner;if(this.moveInlines(e,s,0,i,t,r,n,o),e.containerWidget.childWidgets[l])for(var d=e.containerWidget.childWidgets[l],h=0;h<d.childWidgets.length;h++)for(var c=d.childWidgets[h],p=0;p<c.children.length;p++){var u=c.children[p];u instanceof Bh&&this.removeFootnote(u)}return e.containerWidget.childWidgets.splice(l,0,s),s.index=a,s.containerWidget=e.containerWidget,this.updateNextBlocksIndex(s,!0),o&&this.removeBlock(e),this.documentHelper.layout.layoutBodyWidgetCollection(a,s.containerWidget,s,!1),s},o.prototype.removeCommentsInBlock=function(e){if(e instanceof K)for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];this.removeCommentsInBlock(s)}else this.removeCommentInPara(e)},o.prototype.removeCommentInPara=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++)this.removeCommentsInline(i.children[n])},o.prototype.removeCommentsInline=function(e){e instanceof up&&1!==e.commentType&&e.removeCommentMark()},o.prototype.removeBlock=function(e,t,i){var n,r;i||(this.removeFieldInBlock(e),this.removeFieldInBlock(e,!0),this.removeFieldInBlock(e,void 0,!0),this.removeCommentsInBlock(e)),e.isInsideTable?(r=e.associatedCell,n=e.associatedCell.childWidgets.indexOf(e),e.associatedCell.childWidgets,this.updateNextBlocksIndex(e,!1),e.associatedCell.childWidgets.splice(n,1),e.containerWidget=void 0,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,r,e,!1)):(r=e.containerWidget,this.checkAndRemoveRevisionFromBlock(e,!0),n=r.childWidgets.indexOf(e),r.childWidgets,this.updateNextBlocksIndex(e,!1),r.childWidgets.splice(n,1),e.containerWidget=void 0,r.height-=e.height,!_.isNullOrUndefined(r.containerWidget)&&r.containerWidget instanceof q&&(r.containerWidget.height-=e.height),this.documentHelper.layout.layoutBodyWidgetCollection(e.index,r,e,!1,t))},o.prototype.checkAndRemoveRevisionFromBlock=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n=void 0;if(this.isPasteRevertAction()||(n=this.skipTracking()),e.childWidgets[i]instanceof dh&&!n&&(n=e.childWidgets[i],this.removeDeletedCellRevision(n,t)),e.childWidgets[i]instanceof uh)for(var r=e.childWidgets[i],o=0;o<r.children.length;o++){var s=r.children[o];s instanceof Bh&&!this.selection.isEmpty&&this.removeFootnote(s)}}},o.prototype.removePrevParaMarkRevision=function(e,t){var i,n;t=!_.isNullOrUndefined(t)&&t,(this.owner.enableTrackChanges||0!=e.characterFormat.revisions.length)&&(i=-1,n=void 0,e=e,0<=(i=0<(e=t||_.isNullOrUndefined(e.previousRenderedWidget)?e:e.previousRenderedWidget).characterFormat.revisions.length?(n=e.characterFormat.revisions[e.characterFormat.revisions.length-1]).range.indexOf(e.characterFormat):i))&&!_.isNullOrUndefined(n)&&n.range[i]instanceof B&&(n.range.splice(i,1),this.owner.trackChangesPane.updateCurrentTrackChanges(n),e.characterFormat&&-1<e.characterFormat.revisions.indexOf(n)&&e.characterFormat.revisions.splice(e.characterFormat.revisions.indexOf(n),1),0==n.range.length)&&this.owner.revisionsInternal.remove(n)},o.prototype.isPasteRevertAction=function(){return!(_.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Paste"!==this.editorHistory.currentBaseHistoryInfo.action)},o.prototype.toCheckForTrack=function(e){if(this.owner.enableTrackChanges&&!this.skipTracking()&&e instanceof K&&0<e.childWidgets.length){e=e.childWidgets[0].rowFormat;if(0<e.revisions.length&&"Insertion"!==e.revisions[0].revisionType&&e.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)||0===e.revisions.length)return!0}return!1},o.prototype.removeFootnote=function(e,t){if(e.paragraph.bodyWidget.page.footnoteWidget){for(var i=e.paragraph.bodyWidget.page.footnoteWidget,n=0;n<i.bodyWidgets.length;n++)if(e===i.bodyWidgets[n].footNoteReference){if(i.height-=i.bodyWidgets[n].childWidgets[0].height,this.owner.enableTrackChanges)for(var r=0;r<i.bodyWidgets[n].childWidgets.length;r++)this.removeRevisionForBlock(i.bodyWidgets[n].childWidgets[r],void 0,!1,!0);i.bodyWidgets.splice(n,1),n--,this.isFootnoteElementRemoved=!0}0===i.bodyWidgets.length&&(e.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(this.documentHelper.footnoteCollection.indexOf(e),1),this.updateFootNoteIndex()},o.prototype.removeEndnote=function(e,t){var i=this.documentHelper.pages.length,i=this.documentHelper.pages[i-1].bodyWidgets[0];if(i.page.endnoteWidget){for(var n=i.page.endnoteWidget,r=0;r<n.bodyWidgets.length;r++)if(e===n.bodyWidgets[r].footNoteReference){if(n.height-=n.bodyWidgets[r].childWidgets[0].height,this.owner.enableTrackChanges)for(var o=0;o<n.bodyWidgets[r].childWidgets.length;o++)this.removeRevisionForBlock(n.bodyWidgets[r].childWidgets[o],void 0,!1,!0);n.bodyWidgets.splice(r,1),this.isEndnoteElementRemoved=!0,r--}0===n.bodyWidgets.length&&(i.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(this.documentHelper.endnoteCollection.indexOf(e),1),this.updateEndNoteIndex()},o.prototype.removeAutoShape=function(e){var t=e.line.paragraph.floatingElements.indexOf(e),i=e.line.paragraph.bodyWidget.floatingElements.indexOf(e);-1<i&&e.line.paragraph.bodyWidget.floatingElements.splice(i,1),e.line.paragraph.floatingElements.splice(t,1)},o.prototype.removeField=function(e,t,i){var n=this.documentHelper.fields;if(t?n=this.documentHelper.bookmarks.keys:i&&(n=this.documentHelper.contentControlCollection),0<e.floatingElements.length)for(var r=0;r<e.floatingElements.length;r++){var o=e.floatingElements[r];this.removeAutoShape(o),r--}for(var s,a,l=0;l<n.length;l++)((c=t?this.documentHelper.bookmarks.get(n[l]):n[l]).line.paragraph===e||c instanceof J&&!_.isNullOrUndefined(c.reference)&&c.reference.line.paragraph===e)&&(t?(this.documentHelper.bookmarks.remove(n[l]),c.line.children.splice(c.indexInOwner,1),_.isNullOrUndefined(c.line.paragraph.associatedCell)||((a=c.line.paragraph.associatedCell).isRenderBookmarkStart?a.isRenderBookmarkStart=!1:a.isRenderBookmarkEnd=!1),(s=c.reference)&&s.line.children.splice(s.indexInOwner,1),s&&!_.isNullOrUndefined(s.line.paragraph.associatedCell)&&((a=s.line.paragraph.associatedCell).isRenderBookmarkStart?a.isRenderBookmarkStart=!1:a.isRenderBookmarkEnd=!1)):i?this.documentHelper.contentControlCollection.splice(l,1):(this.documentHelper.fields.splice(l,1),-1!==this.documentHelper.formFields.indexOf(c)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(c),1)),l--);if(0<this.documentHelper.footnoteCollection.length)for(l=0;l<this.documentHelper.footnoteCollection.length;l++)if((c=this.documentHelper.footnoteCollection[l]).line.paragraph===e){if(c.paragraph.bodyWidget.page.footnoteWidget){for(var d=c.paragraph.bodyWidget.page.footnoteWidget,h=0;h<d.bodyWidgets.length;h++)c===d.bodyWidgets[h].footNoteReference&&(d.height-=d.bodyWidgets[h].height,d.bodyWidgets.splice(h,1),h--);0===d.bodyWidgets.length&&(c.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(l,1),l--}if(0<this.documentHelper.endnoteCollection.length)for(var c,l=0;l<this.documentHelper.endnoteCollection.length;l++)if((c=this.documentHelper.endnoteCollection[l]).line.paragraph===e){if(c.paragraph.bodyWidget.page.endnoteWidget){for(var p=c.paragraph.bodyWidget.page.endnoteWidget,h=0;h<p.bodyWidgets.length;h++)c===p.bodyWidgets[h].footNoteReference&&(p.height-=p.bodyWidgets[h].height,p.bodyWidgets.splice(h,1),h--);0===p.bodyWidgets.length&&(c.paragraph.bodyWidget.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(l,1),l--}},o.prototype.getTabsInSelection=function(){var e=[],t=this.owner.selectionModule,i=[];if(0===t.selectedWidgets.keys.length)return t.start.paragraph.paragraphFormat.getUpdatedTabs();if(t.start.paragraph===t.end.paragraph)return t.start.paragraph.paragraphFormat.getUpdatedTabs();for(var t=0<(i=t.start.paragraph!==t.end.paragraph?this.owner.selectionModule.getParagraphsInSelection():i).length?i[0]:void 0,n=_.isNullOrUndefined(t)?[]:t.paragraphFormat.getUpdatedTabs(),r=!0,o=0;o<n.length;o++)e.push(n[o]);for(var s=1;s<i.length;s++){for(var a=i[s].paragraphFormat.getUpdatedTabs(),l=[],r=!0,d=0;d<e.length;d++){for(o=0;o<a.length;o++)if(a[o].equals(e[d])){r=!1;break}r&&l.push(e[d])}for(d=0;d<l.length;d++)e.splice(e.indexOf(l[d]),1)}return e},o.prototype.updateTabStopCollection=function(e,t,i){var n=e.paragraphFormat.tabs;if(i){e.paragraphFormat.tabs=[];for(var r=0;r<t.length;r++)e.paragraphFormat.tabs.push(t[r])}else for(r=0;r<t.length;r++){for(var o=t[r],s=-1,a=0;a<n.length;a++){var l=n[a];if(o.position===l.position){s=a;break}if(o.position<l.position)break}0<=s?this.modifyTabStop(n[s],o):this.addTabStopToCollection(n,o)}},o.prototype.modifyTabStop=function(e,t){e.deletePosition=t.deletePosition,e.tabJustification=t.tabJustification,e.tabLeader=t.tabLeader},o.prototype.removeTabStops=function(e,t){for(var i=0;i<e.length;i++)for(var n=e[i].paragraphFormat.tabs,r=0;r<t.length;r++)for(var o=t[r],s=0;s<n.length;s++)if(n[s].equals(o)){n.splice(s,1);break}},o.prototype.addTabStopToCollection=function(e,t,i){for(var n=-1,r=0;r<e.length;r++)if(e[r].position>t.position){n=r;break}return n=-1===n?e.length:n,i||e.splice(n,0,t.clone()),n},o.prototype.addRemovedNodes=function(e,t){e instanceof up&&0===e.commentType&&e.commentMark&&e.removeCommentMark(),e instanceof E&&(0===e.type?this.documentHelper.contentControlCollection.splice(this.documentHelper.contentControlCollection.indexOf(e),1):this.updatePropertiesToBlock(e.reference)),e instanceof Z&&0===e.fieldType&&(-1!==this.documentHelper.fields.indexOf(e)&&this.documentHelper.fields.splice(this.documentHelper.fields.indexOf(e),1),-1!==this.documentHelper.formFields.indexOf(e))&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(e),1),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)?t?this.editorHistory.currentBaseHistoryInfo.removedNodes.splice(0,0,e):this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e):this.editHyperlinkInternal&&this.nodes.push(e)},o.prototype.deleteBlock=function(e,t,i,n,r){var o;e instanceof G?(this.deletePara(e,i,n,r),this.delBlockContinue&&this.delBlock&&(this.delSection&&(o=e.bodyWidget instanceof z?e.bodyWidget:void 0,this.deleteSection(t,this.delSection,o,r),this.delSection=void 0),-1!==this.delBlock.indexInOwner&&this.deleteBlock(this.delBlock,t,i,n,r),this.delBlockContinue=!1,this.delBlock=void 0)):(this.deleteTableBlock(e,t,i,n,r),_.isNullOrUndefined(e.childWidgets)||!this.owner.enableTrackChanges||this.skipTracking()||this.documentHelper.layout.reLayoutTable(e))},o.prototype.deleteTableCell=function(e,t,i,n,r,o){var s,a,l=!(i.paragraph.isInsideTable&&e.ownerTable.contains(i.paragraph.associatedCell)),d=e.ownerTable.previousRenderedWidget;i.paragraph.isInsideTable?(s=t.getContainerCellOf(e,i.paragraph.associatedCell)).ownerTable.contains(i.paragraph.associatedCell)?(a=t.getSelectedCell(e,s),t.getSelectedCell(i.paragraph.associatedCell,s),t.containsCell(s,i.paragraph.associatedCell)?t.isCellSelected(s,i,n)?(this.updateEditPosition(s,t),1===r||o?this.deleteCellsInTable(e.ownerRow.ownerTable,t,i,n,r):!(o=this.deleteCell(s,t,r,!0))&&2!==r&&this.editorHistory?this.editorHistory.currentBaseHistoryInfo=void 0:o&&this.documentHelper.layout.reLayoutTable(s.ownerRow.ownerTable)):a===s?(this.deletePara(n.paragraph,i,n,r),this.delBlockContinue&&this.delBlock&&(this.delSection&&(o=(o=n.paragraph).bodyWidget instanceof z?o.bodyWidget:void 0,this.deleteSection(t,this.delSection,o,r),this.delSection=void 0),this.deleteBlock(this.delBlock,t,i,n,r),this.delBlockContinue=!1,this.delBlock=void 0)):this.deleteContainer(a,t,i,n,r):2===r?this.deleteCell(e,t,2,!1):(l=!1,this.deleteCellsInTable(s.ownerTable,t,i,n,r))):this.deleteContainer(s,t,i,n,r):(o=t.getContainerCell(e),_.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing?this.deleteContainer(o,t,i,n,r):(this.deleteTableBlock(o.ownerTable,t,i,n,r),l=!1)),l&&(d.bodyWidget instanceof z&&d.bodyWidget,_.isNullOrUndefined(d)||this.deleteBlock(d,t,i,n,r))},o.prototype.deleteCellsInTable=function(e,t,i,n,r,o){var s,a=this,l="Delete",d=!1,h=i.paragraph.associatedCell,c=n.paragraph.associatedCell,p=(_.isNullOrUndefined(o)||(c=o),this.documentHelper.layout.getParentTable(h)),u=this.documentHelper.layout.getParentCell(h),g=this.documentHelper.layout.getParentCell(c),m=(_.isNullOrUndefined(o)&&i.paragraph.isInsideTable&&n.paragraph.isInsideTable&&this.selection.isCellSelected(u,i,n)&&(h=u,c=g),h.columnIndex),f=c.columnIndex+c.cellFormat.columnSpan-1,y=h.rowIndex,v=c.rowIndex,w=this.isWholeRowSelected(h.ownerRow,m,f);if(this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){if(l=this.editorHistory.currentBaseHistoryInfo.action,d="BackSpace"===this.editorHistory.currentBaseHistoryInfo.action||"DeleteCells"===this.editorHistory.currentBaseHistoryInfo.action||"InsertTable"===this.editorHistory.currentBaseHistoryInfo.action||"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action||_.isNullOrUndefined(h.ownerRow.previousWidget)&&_.isNullOrUndefined(c.ownerRow.nextWidget)&&"Cut"===this.editorHistory.currentBaseHistoryInfo.action,this.cloneTableToHistoryInfo(e,e===p),this.editorHistory.isRedoing&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)for(var b=0;b<e.childWidgets.length;b++){var x=e.childWidgets[b];x.index>=y&&x.index<=v&&w&&this.trackRowDeletion(x,!1)}if("RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)return;this.editorHistory.currentBaseHistoryInfo.action=d?"DeleteCells":"ClearCells",t.owner.isLayoutEnabled=!1}!this.owner.enableTrackChanges||this.skipTracking()||(s=!1,w)?this.onConfirmedTableCellsDeletion(e,t,y,v,m,f,d,r,w,l):1===r?(u=(o=new _.L10n("documenteditor",this.owner.defaultLocale)).getConstant("UnTrack"),g=o.getConstant("Merge Track"),o.setLocale(this.owner.locale),this.alertDialog=C.DialogUtility.alert({title:u,content:g,showCloseIcon:!0,okButton:{text:"Ok",click:function(){s=!0,a.onConfirmedTableCellsDeletion(e,t,y,v,m,f,d,r,w,l)}},closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"},close:function(){s||(a.documentHelper.layout.reLayoutTable(e),a.viewer.updateScrollBars())}}),this.alertDialog.enableRtl=this.owner.enableRtl):this.trackDeletedContentInTableCell(e,t,i,n,r,y,v,m,f)},o.prototype.removeDeletedCellRevision=function(e,t){0<e.rowFormat.revisions.length&&t&&this.unlinkRangeFromRevision(e.rowFormat,!0);for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];if(!_.isNullOrUndefined(o)&&o instanceof G){for(var s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(!_.isNullOrUndefined(a.children))for(var l=0;l<a.children.length;l++){var d=a.children[l];0<d.revisions.length&&this.unlinkRangeFromRevision(d,!0)}}this.unlinkRangeFromRevision(o.characterFormat,!0)}else if(!_.isNullOrUndefined(o)&&o instanceof K)for(var h=0;h<o.childWidgets.length;h++){var c=o.childWidgets[h];this.removeDeletedCellRevision(c,!0)}}},o.prototype.removeDeletedShapeRevision=function(e){var t=e.textFrame;if(!_.isNullOrUndefined(t))for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(!_.isNullOrUndefined(n)&&n instanceof G){for(var r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];if(!_.isNullOrUndefined(o.children))for(var s=0;s<o.children.length;s++){var a=o.children[s];0<a.revisions.length&&this.unlinkRangeFromRevision(a,!0)}}this.unlinkRangeFromRevision(n.characterFormat,!0)}}},o.prototype.insertShape=function(e,t){e=this.getShape(e,t);this.owner.documentHelper.selection.start.currentWidget.children.push(e),this.reLayout(this.owner.documentHelper.selection),this.documentHelper.currentPage.bodyWidgets[0].floatingElements.push(e)},o.prototype.getShape=function(e,t){var i=(new uc).clone(),n=(i.shapeId=parseInt(Date.now().toString().slice(0,10),10),i.name=e+(" "+(this.documentHelper.currentPage.bodyWidgets[0].floatingElements.length+1)),t=_.isNullOrUndefined(t)?{}:t,i.x=_.isNullOrUndefined(t.x)?50:t.x,i.y=_.isNullOrUndefined(t.x)?50:t.y,"UpDownArrow"===(i.autoShapeType=e)?(i.height=_.isNullOrUndefined(t.height)?140:t.height,i.width=_.isNullOrUndefined(t.width)?96:t.width):"LeftRightArrow"===e||"LeftRightArrowCallout"===e?(i.height=_.isNullOrUndefined(t.height)?80:t.height,i.width=_.isNullOrUndefined(t.width)?140:t.width):(i.height=_.isNullOrUndefined(t.height)?96:t.height,i.width=_.isNullOrUndefined(t.width)?96:t.width),i.visible=!!_.isNullOrUndefined(t.visible)||t.visible,i.widthScale=_.isNullOrUndefined(t.widthScale)?100:t.widthScale,i.heightScale=_.isNullOrUndefined(t.heightScale)?100:t.heightScale,i.verticalPosition=_.isNullOrUndefined(t.verticalPosition)?i.y:t.verticalPosition,i.verticalOrigin=_.isNullOrUndefined(t.verticalOrigin)?"Paragraph":t.verticalOrigin,i.verticalAlignment=_.isNullOrUndefined(t.verticalAlignment)?"None":t.verticalAlignment,i.verticalRelativePercent=-34028235e31,i.horizontalPosition=_.isNullOrUndefined(t.horizontalPosition)?i.x:t.horizontalPosition,i.horizontalRelativePercent=-34028235e31,i.heightRelativePercent=-34028235e31,i.widthRelativePercent=0,i.horizontalOrigin=_.isNullOrUndefined(t.horizontalOrigin)?"Column":t.horizontalOrigin,i.horizontalAlignment=_.isNullOrUndefined(t.horizontalAlignment)?"None":t.horizontalAlignment,i.zOrderPosition=251659264,i.allowOverlap=!!_.isNullOrUndefined(t.allowOverLap)||t.allowOverLap,i.textWrappingStyle=_.isNullOrUndefined(t.textWrappingStyle)?"InFrontOfText":t.textWrappingStyle,i.textWrappingType=_.isNullOrUndefined(t.textWrappingType)?"Both":t.textWrappingType,i.isBelowText=!_.isNullOrUndefined(t.isBelowText)&&t.isBelowText,i.distanceBottom=_.isNullOrUndefined(t.distanceBottom)?0:t.distanceBottom,i.distanceTop=_.isNullOrUndefined(t.distanceTop)?0:t.distanceTop,i.distanceLeft=_.isNullOrUndefined(t.distanceLeft)?12:t.distanceLeft,i.distanceRight=_.isNullOrUndefined(t.distanceRight)?12:t.distanceRight,i.isHorizontalRule=!_.isNullOrUndefined(t.isHorizontalRule)&&t.isHorizontalRule,i.layoutInCell=!!_.isNullOrUndefined(t.layoutInCell)||t.layoutInCell,i.lockAnchor=!_.isNullOrUndefined(t.lockAnchor)&&t.lockAnchor,new fc),n=(n.textVerticalAlignment="Arc"===e||"CurvedConnector"===e||"ElbowConnector"===e?"Top":"Middle",n.marginLeft=10,n.marginRight=10,n.marginTop=5,n.marginBottom=5,(i.textFrame=n).containerShape=i,new bc),n=("Arc"===e||"CurvedConnector"===e||"ElbowConnector"===e||"DoubleBracket"===e||"DoubleBrace"===e||"RightBrace"===e||"LeftBrace"===e||"RightBracket"===e||"LeftBracket"===e?(n.color=_.isNullOrUndefined(t.fillColor)?"#FFFFFFFF":t.fillColor,n.fill=!!_.isNullOrUndefined(t.fill)||t.fill):(n.fill=!!_.isNullOrUndefined(t.fill)||t.fill,n.color=_.isNullOrUndefined(t.fillColor)?"#156082FF":t.fillColor),i.fillFormat=n,new vc);return n.lineFormatType=_.isNullOrUndefined(t.lineFormatType)?"Solid":t.lineFormatType,n.dashStyle=_.isNullOrUndefined(t.dashStyle)?"Solid":t.dashStyle,n.line=!!_.isNullOrUndefined(t.line)||t.line,"Arc"===e||"CurvedConnector"===e||"ElbowConnector"===e||"DoubleBracket"===e||"DoubleBrace"===e||"RightBrace"===e||"LeftBrace"===e||"RightBracket"===e||"LeftBracket"===e?(n.color=_.isNullOrUndefined(t.lineColor)?"#156082FF":t.lineColor,n.weight=_.isNullOrUndefined(t.lineWeight)?.5:t.lineWeight):(n.color=_.isNullOrUndefined(t.lineColor)?"#042433FF":t.lineColor,n.weight=_.isNullOrUndefined(t.lineWeight)?1:t.lineWeight),i.lineFormat=n,i.line=this.owner.documentHelper.selection.start.currentWidget,i},o.prototype.trackDeletedContentInTableCell=function(e,t,i,n,r,o,s,a,l){var d,h=this.selection.hasMergedCells()?(c=this.selection.getCellFromSelectionInTable(0),this.selection.getCellFromSelectionInTable(1)):(c=this.selection.getCellFromSelection(0),this.selection.getCellFromSelection(1)),c=this.selection.getActualOffset(c,0),p=this.selection.getActualOffset(h,1),u=[],g=!1;this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&u.push.apply(u,this.editorHistory.currentBaseHistoryInfo.removedNodes);for(var m=0;m<e.childWidgets.length;m++){var f=e.childWidgets[m];if(f.index>=o&&f.index<=s)for(var y=0;y<f.childWidgets.length;y++){var v=f.childWidgets[y];if(v.columnIndex>=a&&v.columnIndex<=l)for(var w=f.childWidgets[y],b=w.childWidgets.length,x=0;x<w.childWidgets.length;x++){var C=w.childWidgets[x];if(C instanceof G){var I=C;this.insertRevisionForBlock(I,"Deletion",void 0,void 0,void 0,void 0,!0),b!==w.childWidgets.length&&(x--,b=w.childWidgets.length,g=!0),I.isEmpty()?this.combineRevisionWithBlocks(I):this.combineRevisionWithBlocks(I.lastChild.children[I.lastChild.children.length-1])}else for(var k=C,F=0;F<k.childWidgets.length;F++){var P=this.trackRowDeletion(k.childWidgets[F],void 0,!1);if(_.isNullOrUndefined(k.childWidgets)){x--;break}0<k.childWidgets.length&&P&&F--}}}}this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.removedNodes.length=0,(d=this.editorHistory.currentBaseHistoryInfo.removedNodes).push.apply(d,u),this.editorHistory.currentBaseHistoryInfo.isRevisionEndInAnotherCell=!0,this.editorHistory.currentBaseHistoryInfo.selectionStart=c,this.editorHistory.currentBaseHistoryInfo.insertPosition=c,this.editorHistory.currentBaseHistoryInfo.selectionEnd=p,this.editorHistory.currentBaseHistoryInfo.endPosition=p,g)&&(p=this.selection.getActualOffset(h,1),this.editorHistory.currentBaseHistoryInfo.selectionEnd=p,this.editorHistory.currentBaseHistoryInfo.endPosition=p,this.selection.editPosition=c)},o.prototype.onConfirmedTableCellsDeletion=function(e,t,i,n,r,o,s,a,l,d){for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[h],p=!1;if(c.index>=i&&c.index<=n&&(this.owner.enableTrackChanges&&!this.skipTracking()&&l&&!(p=this.trackRowDeletion(c,!1,void 0,a))||this.onConfirmedCellDeletion(c,t,i,n,r,o,s,a,l)),p||0===c.childWidgets.length){for(var u=e.childWidgets[h],g=u.previousRenderedWidget;!_.isNullOrUndefined(g);){for(var m=0;m<g.childWidgets.length;m++){var f=g.childWidgets[m];u.rowIndex<f.ownerRow.rowIndex+f.cellFormat.rowSpan&&f.cellFormat.rowSpan--}g=g.previousRenderedWidget}this.updateNextBlocksIndex(u,!1),e.childWidgets.splice(h,1),h--,n--}}t.owner.isLayoutEnabled=!0,0===e.childWidgets.length?(t.editPosition=this.selection.getHierarchicalIndex(e,"0"),this.setActionInternal(t,d),this.removeBlock(e)):(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e)),_.isNullOrUndefined(this.alertDialog)||(d=t.getTextPosBasedOnLogicalIndex(t.editPosition),t.selectContent(d,!0),this.reLayout(t),this.alertDialog.close(),this.alertDialog=void 0)},o.prototype.onConfirmedCellDeletion=function(e,t,i,n,r,o,s,a,l){var d=!1;this.removeDeletedCellRevision(e,l);for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[h];if(c.columnIndex>=r&&c.columnIndex<=o)if(d||(this.updateEditPosition(c,t),d=!0),s){var p=e.childWidgets[h];this.updateNextBlocksIndex(p,!1);for(var u=0;u<p.childWidgets.length;u++)for(var g=p.childWidgets[u],m=0;m<g.childWidgets.length;m++){var f=g.childWidgets[m];if(f instanceof uh)for(var y=f,v=0;v<y.children.length;v++){var w=y.children[v];w instanceof Bh&&this.removeFootnote(w)}}e.childWidgets.splice(h,1),h--}else a<4&&this.deleteCell(c,t,a,!1)}},o.prototype.removeRevisionForRow=function(e){0<e.rowFormat.revisions.length&&this.skipTracking()&&(this.unlinkRangeFromRevision(e.rowFormat,!0),this.addRemovedRevisionInfo(e.rowFormat,void 0))},o.prototype.removeRevisionsInRow=function(e){if(0<e.rowFormat.revisions.length)for(var t=0;t<e.rowFormat.revisions.length;t++){var i=e.rowFormat.revisions[t];this.unlinkWholeRangeInRevision(e.rowFormat,i)}},o.prototype.removeRevisionForCell=function(e,t){for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i]instanceof G)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.children.length;s++){var a=o.children[s];!_.isNullOrUndefined(a)&&0<a.revisions.length&&(this.unlinkRangeFromRevision(a,t),this.addRemovedRevisionInfo(a,void 0))}else e.childWidgets[i]instanceof K&&this.removeRevisionForInnerTable(e.childWidgets[i])},o.prototype.removeRevisionForInnerTable=function(e){if(0<e.childWidgets.length)for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];_.isNullOrUndefined(i)||this.removeRevisionForRow(i)}},o.prototype.removeRevisionForBlock=function(e,t,i,n){if(0<e.characterFormat.revisions.length&&!i&&(n&&this.addRemovedRevisionInfo(e.characterFormat,void 0,!1),_.isNullOrUndefined(t)?this.unlinkRangeFromRevision(e.characterFormat,!0):this.unlinkRangeByRevision(e.characterFormat,t),e.characterFormat.revisions=[]),!_.isNullOrUndefined(e))for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.children.length;s++){var a,l=o.children[s];l instanceof Bh&&("Footnote"===(a=l.nextValidNodeForTracking).footnoteType?this.removeFootnote(a):this.removeEndnote(a)),!_.isNullOrUndefined(l)&&0<l.revisions.length&&(n&&this.addRemovedRevisionInfo(l,void 0,!1),_.isNullOrUndefined(t)?this.unlinkRangeFromRevision(l,!0):this.unlinkRangeByRevision(l,t),l.revisions=[])}},o.prototype.unlinkRangeByRevision=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i];n.author===t.author&&n.revisionType===t.revisionType&&(e.revisions.splice(e.revisions.indexOf(t),1),n=t.range.indexOf(e),t.range.splice(n,1),this.owner.trackChangesPane.updateCurrentTrackChanges(t))}},o.prototype.isWholeRowSelected=function(e,t,i){return 0===t&&e.childWidgets.length-1===t+i},o.prototype.deleteCell=function(e,t,i,n){var r=e.childWidgets[0];if(1===e.childWidgets.length&&r instanceof G&&r.isEmpty())return!1;for(var o=e.childWidgets.length-1,s=e.childWidgets.length-1;-1<s;s--)if(r=e.childWidgets[s],i<4)if(r instanceof G&&s===o){var a=r;if(this.checkClearCells(t))a.isEmpty()||this.removeInlines(a,a.firstChild,0,a.lastChild,a.lastChild.getEndOffset(),i);else for(var l=a.childWidgets.length-1;0<=l;l--){for(var d=a.childWidgets[l],h=d.children.length-1;0<=h;h--){var c=d.children[h];c instanceof Bh?this.removeFootnote(c):c instanceof J&&0===c.bookmarkType&&this.documentHelper.bookmarks.containsKey(c.name)&&this.documentHelper.bookmarks.remove(c.name),this.unLinkFieldCharacter(c),d.children.splice(h,1)}1<a.childWidgets.length&&a.childWidgets.splice(l,1)}}else this.removeBlock(r),this.checkClearCells(t)&&(this.addRemovedNodes(r),1===e.childWidgets.length)&&(t.editPosition=this.selection.getHierarchicalIndex(e.childWidgets[0],"0"),this.updateHistoryPosition(t.editPosition,!0));return!0},o.prototype.paragrapghBookmarkCollection=function(e,t){for(var i=this.documentHelper.bookmarks,n=0;n<i.length;n++){var r=this.documentHelper.bookmarks.get(i.keys[n]);r.paragraph===e&&t.push(r)}return t},o.prototype.deleteContainer=function(e,t,i,n,r){var o=e.ownerTable;if(t.containsRow(o.lastChild,n.paragraph.associatedCell)&&!this.owner.enableTrackChanges)this.deleteContent(o,t,r);else if(this.toCheckForTrack(o)){this.cloneTableToHistoryInfo(o);for(var s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(this.trackRowDeletion(a),n.paragraph.isInsideTable&&t.containsRow(a,n.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(o)}}else if(0<o.childWidgets.length){e=o.childWidgets[o.childWidgets.length-1];if(t.containsRow(e,n.paragraph.associatedCell))if(this.owner.enableTrackChanges){this.cloneTableToHistoryInfo(o);for(var l=0;l<o.childWidgets.length;l++)this.trackRowDeletion(o.childWidgets[l],!1);_.isNullOrUndefined(o.childWidgets)||_.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.removeBlock(o)}else this.deleteContent(o,t,r);else for(var d=0;d<o.childWidgets.length;d++){var h=o.childWidgets[d];if(r<4&&(this.updateNextBlocksIndex(h,!1),o.childWidgets.splice(d,1),this.addRemovedNodes(h),d--),n.paragraph.isInsideTable&&t.containsRow(h,n.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(o)}}},o.prototype.deleteTableBlock=function(e,t,i,n,r){if(e=e.combineWidget(this.owner.viewer),i.paragraph.isInsideTable&&e.contains(i.paragraph.associatedCell)){var o=e.previousRenderedWidget,o=this.checkAndInsertBlock(e,i,n,r,o instanceof G?o:void 0);if(t.containsRow(e.firstChild,i.paragraph.associatedCell))if(this.owner.enableTrackChanges){this.cloneTableToHistoryInfo(e);for(var s=0;s<e.childWidgets.length;s++)if(this.trackRowDeletion(e.childWidgets[s])&&s--,_.isNullOrUndefined(e.childWidgets))break;_.isNullOrUndefined(e.childWidgets)||_.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.removeBlock(e)}else this.deleteContent(e,t,r);else this.owner.enableTrackChanges?_.isNullOrUndefined(n.paragraph.associatedCell)&&!n.paragraph.isInsideTable&&(a=e.lastChild.lastChild,this.deleteCellsInTable(e,t,i,n,r,a)):(a=this.splitTable(e,i.paragraph.associatedCell.ownerRow),this.deleteContent(e,t,r),this.documentHelper.layout.layoutBodyWidgetCollection(a.index,a.containerWidget,a,!1));_.isNullOrUndefined(o)||(t.editPosition=this.selection.getHierarchicalIndex(o,"0"),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=t.editPosition))}else{var a=e.previousRenderedWidget;if(this.owner.enableTrackChanges){this.cloneTableToHistoryInfo(e);for(s=0;s<e.childWidgets.length;s++)if(this.trackRowDeletion(e.childWidgets[s])&&s--,_.isNullOrUndefined(e.childWidgets))break;_.isNullOrUndefined(e.childWidgets)||_.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.removeBlock(e)}else this.deleteContent(e,t,r);_.isNullOrUndefined(a)||this.deleteBlock(a,t,i,n,r)}},o.prototype.splitTable=function(e,t){var i=new K;i.tableFormat.copyFormat(e.tableFormat),i.index=e.index;for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r===t)break;i.childWidgets.push(r),r.containerWidget=i,e.childWidgets.splice(n,1),n--}var o=e.getIndex();return e.containerWidget.childWidgets.splice(o,0,i),i.containerWidget=e.containerWidget,this.updateNextBlocksIndex(i,!0),i},o.prototype.updateEditPosition=function(e,t){e=this.documentHelper.getFirstParagraphInCell(e);t.editPosition=this.selection.getHierarchicalIndex(e,"0")},o.prototype.deleteContent=function(e,t,i){i<4&&(this.removeBlock(e),this.addRemovedNodes(e))},o.prototype.setActionInternal=function(e,t){this.documentHelper.owner.enableHistoryMode&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.action=t)},o.prototype.checkClearCells=function(e){return this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"ClearCells"!==this.editorHistory.currentBaseHistoryInfo.action},o.prototype.isEndInAdjacentTable=function(e,t){e=this.selection.getHierarchicalIndex(e,""),t=this.selection.getHierarchicalIndex(t,""),e=e.split(";"),t=t.split(";");return e.length<t.length},o.prototype.cloneTableToHistoryInfo=function(e,t){var i;if(this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo))return(i=e.clone()).index=e.index,this.editorHistory.currentBaseHistoryInfo.removedNodes.push(i),(this.documentHelper.selection.start.paragraph.isInsideTable&&this.documentHelper.selection.start.paragraph.associatedCell.ownerTable===e||t)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(e,"0"),!0),i},o.prototype.insertParagraphPaste=function(e,t,i,n,r,o,s,a){if(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var l=this.selection.getNextParagraphBlock(t);if(l&&0<i.offset&&l===n.paragraph&&e===i.paragraph&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var d=0;this.removeBlock(t),this.documentHelper.layout.clearListElementBox(l),this.documentHelper.layout.clearListElementBox(t);for(var h=0;h<t.childWidgets.length;h++){var c=t.childWidgets[h];l.childWidgets.splice(d,0,c),t.childWidgets.splice(h,1),h--,d++,c.paragraph=l}this.documentHelper.layout.reLayoutParagraph(l,0,0),r=!1;n=this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(";")+1);this.selection.editPosition=this.selection.getHierarchicalIndex(l,n)}}r&&this.deleteParagraphMark(t,this.selection,o,!1,s,a)},o.prototype.removeInlines=function(e,t,i,n,r,o){for(var s=!1,a=(this.documentHelper.layout.clearListElementBox(e),e.childWidgets.indexOf(t),this.selection.start.clone()),l=this.selection.end.clone(),d=this.selection.getElementInfo(a.currentWidget,0!==a.offset&&this.selection.isForward?a.offset+1:a.offset),h=this.selection.getElementInfo(l.currentWidget,0===l.offset||this.selection.isForward?l.offset:l.offset+1),c=((d.element instanceof Z&&2!==d.element.fieldType&&!(h.element instanceof Z)||h.element instanceof Z&&2!==h.element.fieldType&&!(d.element instanceof Z))&&(this.selection.isForward?d.element instanceof Z&&0===d.element.fieldType?(u=d.element.fieldEnd.line.getOffset(d.element.fieldEnd,1),(g=new y(this.owner)).setPositionParagraph(d.element.fieldEnd.line,u),l.isExistBefore(g)&&d.element.fieldSeparator&&(this.selection.start.setPositionParagraph(d.element.fieldSeparator.line,d.element.fieldSeparator.line.getOffset(d.element.fieldSeparator,1)),i=this.selection.start.offset,_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionStart=this.owner.selection.startOffset,this.editorHistory.currentBaseHistoryInfo.insertPosition=this.owner.selection.startOffset,this.selection.editPosition=this.owner.selection.startOffset))):h.element instanceof Z&&1===h.element.fieldType&&(c=h.element.fieldBegin.line.getOffset(h.element.fieldBegin,0),(p=new y(this.owner)).setPositionParagraph(h.element.fieldBegin.line,c),a.isExistAfter(p))&&(this.selection.end.setPositionParagraph(h.element.line,h.element.line.getOffset(h.element,0)),r=this.selection.end.offset,_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionEnd=this.owner.selection.endOffset)):d.element instanceof Z&&1===d.element.fieldType?(c=d.element.fieldBegin.line.getOffset(d.element.fieldBegin,0),(p=new y(this.owner)).setPositionParagraph(d.element.fieldBegin.line,c),l.isExistAfter(p)&&(this.selection.start.setPositionParagraph(d.element.line,d.element.line.getOffset(d.element,0)),r=this.selection.start.offset,_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionStart=this.owner.selection.startOffset,this.editorHistory.currentBaseHistoryInfo.insertPosition=this.owner.selection.endOffset,this.selection.editPosition=this.owner.selection.endOffset))):h.element instanceof Z&&0===h.element.fieldType&&h.element.fieldSeparator&&(u=h.element.fieldEnd.line.getOffset(h.element.fieldEnd,1),(g=new y(this.owner)).setPositionParagraph(h.element.fieldEnd.line,u),a.isExistBefore(g))&&(this.selection.end.setPositionParagraph(h.element.fieldSeparator.line,h.element.fieldSeparator.line.getOffset(h.element.fieldSeparator,1)),i=this.selection.end.offset,_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionEnd=this.owner.selection.endOffset,this.editorHistory.currentBaseHistoryInfo.insertPosition=this.owner.selection.endOffset,this.selection.editPosition=this.owner.selection.endOffset))),this.selection.getElementInfo(a.currentWidget,this.selection.isForward?a.offset:a.offset+1)),p=this.selection.getElementInfo(l.currentWidget,this.selection.isForward?l.offset+1:l.offset),d=(this.selection.isExcludeBookmarkStartEnd||this.isInsertingText||this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"Insert"===this.editorHistory.currentBaseHistoryInfo.action||_.isNullOrUndefined(c)||_.isNullOrUndefined(p)||!c.element||!p.element||!(c.element instanceof J)||!(p.element instanceof J)||c.element.name!==p.element.name||!_.isNullOrUndefined(c.element.nextElement)&&!_.isNullOrUndefined(p.element.previousElement)&&c.element.nextElement instanceof J&&p.element.previousElement instanceof J&&c.element.nextElement.name===p.element.previousElement.name||!_.isNullOrUndefined(c.element.nextElement)&&!_.isNullOrUndefined(p.element.previousElement)&&c.element.nextElement instanceof Z&&p.element.previousElement instanceof Z||(this.selection.isForward?(this.selection.start.setPositionParagraph(c.element.line,c.element.line.getOffset(c.element,0)),this.selection.end.setPositionParagraph(p.element.line,p.element.line.getOffset(p.element,1)),i=this.selection.start.offset,r=this.selection.end.offset,_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionStart=this.owner.selection.startOffset,this.editorHistory.currentBaseHistoryInfo.selectionEnd=this.owner.selection.endOffset,this.editorHistory.currentBaseHistoryInfo.insertPosition=this.owner.selection.startOffset,this.selection.editPosition=this.owner.selection.startOffset)):(this.selection.start.setPositionParagraph(c.element.line,c.element.line.getOffset(c.element,1)),this.selection.end.setPositionParagraph(p.element.line,p.element.line.getOffset(p.element,0)),i=this.selection.end.offset,r=this.selection.start.offset,_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionStart=this.owner.selection.startOffset,this.editorHistory.currentBaseHistoryInfo.selectionEnd=this.owner.selection.endOffset,this.editorHistory.currentBaseHistoryInfo.insertPosition=this.owner.selection.endOffset,this.selection.editPosition=this.owner.selection.endOffset))),this.selection.editPosition),u=this.selection.getParagraphInfo(this.selection.start),g=this.selection.getParagraphInfo(this.selection.end),h=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString()),c=this.selection.getHierarchicalIndex(g.paragraph,g.offset.toString()),m=e.childWidgets.length-1;0<=m;m--){var f=e.childWidgets[m];if(t===f&&n===f){this.removeContent(f,i,r,o),s=!0;break}if(n===f)s=!(e.isLayouted=!1),this.removeContent(f,0,r,o);else{if(t===f){this.removeContent(f,i,this.documentHelper.selection.getLineLength(f),o);break}s&&this.removeContent(f,0,this.documentHelper.selection.getLineLength(f),o)}}this.owner.enableTrackChanges&&!this.skipTracking()&&(this.selection.start.setPositionInternal(a),this.selection.end.setPositionInternal(l),this.skipReplace&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=void 0,this.updateInsertPosition()),this.selection.editPosition=d),s&&(e.isLayouted=!0,this.removeEmptyLine(e),this.documentHelper.layout.reLayoutParagraph(e,0,0),-1===this.selection.start.currentWidget.indexInOwner&&this.owner.enableTrackChanges&&!this.skipTracking()&&(p=this.selection.getTextPosBasedOnLogicalIndex(h),this.selection.start.setPositionInternal(p)),-1===this.selection.end.currentWidget.indexInOwner)&&this.owner.enableTrackChanges&&!this.skipTracking()&&(u=this.selection.getTextPosBasedOnLogicalIndex(c),this.selection.end.setPositionInternal(u))},o.prototype.skipTracking=function(){return!(_.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing)||!(_.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action&&"Accept Change"!==this.editorHistory.currentBaseHistoryInfo.action)},o.prototype.canHandleDeletion=function(){return!(_.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"DeleteRow"!==this.editorHistory.currentBaseHistoryInfo.action)},o.prototype.deleteCommentInSelection=function(e){var t=this.editorHistory.currentBaseHistoryInfo;!this.editorHistory||!this.editorHistory.currentBaseHistoryInfo||this.editorHistory.currentHistoryInfo||this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.initComplexHistory("DeleteCommentInline"),this.deleteCommentInternal(e),this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentHistoryInfo.addModifiedAction(t),this.selection.editPosition=t.insertPosition,this.editorHistory.currentHistoryInfo.insertPosition=this.selection.editPosition,this.editorHistory.currentBaseHistoryInfo=t)},o.prototype.removeContent=function(e,t,i,n,r){for(var o=this.selection.getLineLength(e),s=void 0,a=0,l=void 0,d=e.children.length-1;0<=d;d--){var h=e.children[d];if(this.owner.enableTrackChanges&&h instanceof X&&""===h.text)e.children.splice(d,1);else{if(h.isWidthUpdated=!1,_.isNullOrUndefined(n)||2!==n&&1!==n)for(var c=0;c<e.children.length;c++){var p,u=e.children[c];u instanceof X&&((p=u.text).length+a>t&&!(t<a)&&(s=p[t-a-1],_.isNullOrUndefined(s))&&t-a==0&&(s=l),p.length+a>i&&(" "===p[i-a]&&0===t||" "===s&&" "===p[i-a])&&(i+=1),l=p[p.length-1]),a+=u.length}if(i<=o-h.length)o-=h.length;else{var g,m,f=h.length,y=(i<o&&o-f<i&&(f=i-(o-h.length)),0);if(o-h.length<t&&(y=t-(o-h.length)),i<o&&(o-=h.length-f),0===y&&f===h.length?((!this.owner.enableTrackChanges||this.owner.enableTrackChanges&&this.skipTracking())&&(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||h instanceof J&&this.removedBookmarkElements.push(h),h instanceof J)&&this.documentHelper.bookmarks.containsKey(h.name)&&(this.owner.enableCollaborativeEditing&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.currentBaseHistoryInfo.markerData.push({bookmarkName:h.name}),this.documentHelper.bookmarks.remove(h.name)),(h instanceof Ic&&"Inline"!==h.textWrappingStyle||h instanceof uc)&&this.removeAutoShape(h),this.skipFieldDeleteTracking&&0<h.revisions.length&&(g=h)instanceof Z&&(1!==g.fieldType&&2!==g.fieldType||(g=g.fieldBegin),this.clearFieldElementRevisions(g,h.revisions)),this.canHandleDeletion()||this.owner.enableTrackChanges&&!this.skipTracking()&&!this.skipFieldDeleteTracking?(this.skipTableElements||this.skipFootNoteDeleteTracking||r||this.addRemovedNodes(h.clone()),this.handleDeleteTracking(h,t,i,d,r)):(h instanceof Bh&&(h.isLayout=!1),this.unLinkFieldCharacter(h),this.unlinkRangeFromRevision(h,!0),this.addRemovedRevisionInfo(h,void 0),r||this.addRemovedNodes(h),h instanceof Wc?(this.removedEditRangeStartElements.push(h),-1!=h.columnFirst&&-1!=h.columnLast&&this.removeEditRangeFromCollection(h)):h instanceof Sc&&this.removedEditRangeEndElements.push(h),g=h.previousNode,e.children.splice(d,1),_.isNullOrUndefined(g)||this.combineElementRevisionToPrevNxt(g),!_.isNullOrUndefined(e.layoutedElements)&&0<e.layoutedElements.length&&e.layoutedElements.splice(d,1))):h instanceof X&&(m=this.handleDeleteTracking(h,y,f),_.isNullOrUndefined(m)||this.skipTableElements||(0<h.revisions.length&&this.addRemovedRevisionInfo(h,m),this.addRemovedNodes(m))),(!this.owner.enableTrackChanges||this.editorHistory.isUndoing)&&h instanceof Bh&&("Footnote"===h.footnoteType?this.removeFootnote(h):this.removeEndnote(h)),o-(f-y)<=t)break;o-=f-y,this.documentHelper.layout.clearListElementBox(e.paragraph)}}}},o.prototype.deleteCommentWidgetInline=function(e){},o.prototype.clearFieldElementRevisions=function(e,t){for(var i=t,n=0;n<i.length;n++)for(var r=i[n],o=0;o<r.range.length;o++)if(r.range[o]===e)for(var s=o;s<r.range.length;){if(r.range[o]instanceof Z&&1===r.range[o].fieldType&&r.range[o].fieldBegin===e){r.removeRangeRevisionForItem(r.range[o]),0===r.range.length&&this.owner.revisions.remove(r);break}r.removeRangeRevisionForItem(r.range[o])}},o.prototype.addRemovedRevisionInfo=function(e,t,i){for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n].revisionID;(_.isNullOrUndefined(t)?e:t).removedIds.push(r)}_.isNullOrUndefined(t)&&(_.isNullOrUndefined(i)||i)&&(e.revisions=[])},o.prototype.removeEmptyLine=function(e){if(1<e.childWidgets.length)for(var t=0;t<e.childWidgets.length;t++)0===e.childWidgets[t].children.length&&1<e.childWidgets.length&&(e.childWidgets.splice(t,1),t--)},o.prototype.cloneListLevel=function(e){var t=new El(void 0);return this.copyListLevel(t,e),t},o.prototype.copyListLevel=function(e,t){_.isNullOrUndefined(t.paragraphFormat)||(e.paragraphFormat=new Xa(e),e.paragraphFormat.copyFormat(t.paragraphFormat)),_.isNullOrUndefined(t.characterFormat)||(e.characterFormat=new B(e),e.characterFormat.copyFormat(t.characterFormat)),_.isNullOrUndefined(t.followCharacter)||(e.followCharacter=t.followCharacter),_.isNullOrUndefined(t.listLevelPattern)||(e.listLevelPattern=t.listLevelPattern),_.isNullOrUndefined(t.numberFormat)||(e.numberFormat=t.numberFormat),_.isNullOrUndefined(t.restartLevel)||(e.restartLevel=t.restartLevel),_.isNullOrUndefined(t.startAt)||(e.startAt=t.startAt)},o.prototype.cloneLevelOverride=function(e){var t=new Wl;return _.isNullOrUndefined(e.startAt)||(t.startAt=e.startAt),_.isNullOrUndefined(e.overrideListLevel)||(t.overrideListLevel=e.overrideListLevel),_.isNullOrUndefined(e.levelNumber)||(t.levelNumber=e.levelNumber),t},o.prototype.updateListParagraphs=function(){this.documentHelper.listParagraphs=[];for(var e=0;e<this.documentHelper.pages.length;e++)for(var t=this.documentHelper.pages[e].bodyWidgets[0],i=0;i<t.childWidgets.length;i++)this.updateListParagraphsInBlock(t.childWidgets[i])},o.prototype.updateListParagraphsInBlock=function(e){if(e instanceof G)_.isNullOrUndefined(e.paragraphFormat)||_.isNullOrUndefined(e.paragraphFormat.listFormat)||_.isNullOrUndefined(e.paragraphFormat.listFormat.listId)||(0<=e.paragraphFormat.listFormat.listId&&e.paragraphFormat.clearIndent(),_.isNullOrUndefined(this.documentHelper.listParagraphs)&&(this.documentHelper.listParagraphs=[]),this.documentHelper.listParagraphs.push(e));else if(e instanceof K)for(var t=0;t<e.childWidgets.length;t++)for(var i=0;i<e.childWidgets[t].childWidgets.length;i++)for(var n=e.childWidgets[t].childWidgets[i],r=0;r<n.childWidgets.length;r++)this.updateListParagraphsInBlock(n.childWidgets[r])},o.prototype.onApplyList=function(e){var t=this.documentHelper.selection,i=(this.setOffsetValue(this.documentHelper.selection),this.initHistory("ListFormat"),new ja);_.isNullOrUndefined(e)||(i.listId=e.listId,i.nsid=e.nsid),this.documentHelper.owner.isShiftingEnabled=!0,t.isEmpty?(this.applyParaFormatProperty(t.start.paragraph,"listFormat",i,!1),this.isMeasureParaWidth=!0,this.layoutItemBlock(t.start.paragraph,!1),this.isMeasureParaWidth=!1):this.updateSelectionParagraphFormatting("listFormat",i,!1),this.documentHelper.owner.isShiftingEnabled=!0,this.layoutWholeDocument(),this.documentHelper.owner.isShiftingEnabled=!1,this.startParagraph=void 0,this.endParagraph=void 0},o.prototype.applyBulletOrNumbering=function(e,t,i){var n=this.documentHelper.selection,r=n.paragraphFormat.getList(),o=!1,s=n.start,a=(s=n.isForward?s:n.end).paragraph;if(_.isNullOrUndefined(r)){for(;!_.isNullOrUndefined(a.previousWidget)&&a.previousWidget instanceof G&&a.previousWidget.isEmpty()&&-1===a.previousWidget.paragraphFormat.listFormat.listId;)a=a.previousWidget;if(a.previousWidget&&a.previousWidget instanceof G&&-1!==a.previousWidget.paragraphFormat.listFormat.listId){for(var l=!1;!_.isNullOrUndefined(a.previousWidget)&&a.previousWidget instanceof G&&-1!==a.previousWidget.paragraphFormat.listFormat.listId&&s.paragraph.paragraphFormat.firstLineIndent<Math.abs(a.previousWidget.paragraphFormat.firstLineIndent);)a=a.previousWidget,l=!0;l||(a=a.previousWidget),r=this.documentHelper.getListById(a.paragraphFormat.listFormat.listId),o=!0}if(!o){for(;!_.isNullOrUndefined(a.nextWidget)&&a.nextWidget instanceof G&&a.nextWidget.isEmpty()&&-1===a.nextWidget.paragraphFormat.listFormat.listId;)a=a.nextWidget;a.nextWidget&&a.nextWidget instanceof G&&-1!==a.nextWidget.paragraphFormat.listFormat.listId&&(a=a.nextWidget,r=this.documentHelper.getListById(a.paragraphFormat.listFormat.listId),o=!0)}}var d,h=void 0,c=-1,p=!1;if(-1===a.paragraphFormat.listFormat.listId||_.isNullOrUndefined(a.paragraphFormat.listFormat.listLevel)||(this.listNumberFormat=a.paragraphFormat.listFormat.listLevel.numberFormat,this.listLevelPattern=a.paragraphFormat.listFormat.listLevel.listLevelPattern,this.listLevelNumber=a.paragraphFormat.listFormat.listLevelNumber),!_.isNullOrUndefined(r)){var u,c=a.paragraphFormat.listFormat.listLevelNumber,g=this.documentHelper.getListById(a.paragraphFormat.listFormat.listId),h=this.documentHelper.layout.getListLevel(g,c);if(0<c&&(u=this.documentHelper.layout.getListLevel(g,0),p=!_.isNullOrUndefined(u)&&0<c&&n.start.isInSameListParagraph(n.end)),0===(u=(u=g.abstractList)||this.documentHelper.getAbstractListById(r.abstractListId)).levels.length&&(h=this.documentHelper.layout.getListLevel(g,a.paragraphFormat.listFormat.listLevelNumber)),o){if("Bullet"!==t&&h.listLevelPattern===t&&(h.numberFormat===e||-1!==h.numberFormat.indexOf(e)))return n.paragraphFormat.listId=r.listId,n.paragraphFormat.listLevelNumber=c,void n.paragraphFormat.setList(r);h=u.levels[0]}}_.isNullOrUndefined(r)||!_.isNullOrUndefined(r)&&0===c&&(h.listLevelPattern!==t||h.numberFormat!==e||h.characterFormat.fontFamily!==i&&"Bullet"===h.listLevelPattern)?(o=!1,r=new Vu,0<this.documentHelper.lists.length?r.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:r.listId=0,u=new Hl,0<this.documentHelper.abstractLists.length?u.abstractListId=this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1:u.abstractListId=0,r.nsid=u.nsid,r.abstractListId=u.abstractListId,r.abstractList=u,this.documentHelper.abstractLists.push(u),"bullet"===e||"multiLevel"===e||"numbering"===e?this.addListLevels(u,e,n):((d=new El(u)).listLevelPattern=t,d.numberFormat=e,"Bullet"!==t?d.startAt=1:d.characterFormat.fontFamily=i,d.paragraphFormat.leftIndent=36,d.paragraphFormat.firstLineIndent=-18,u.levels.push(d),n.paragraphFormat.listLevelNumber=0),n.paragraphFormat.setList(r)):!p||_.isNullOrUndefined(r)||o?!_.isNullOrUndefined(r)&&o?n.paragraphFormat.setList(r):n.paragraphFormat.setList(void 0):(g=this.documentHelper.getListById(a.paragraphFormat.listFormat.listId),d=this.documentHelper.layout.getListLevel(g,c),"Bullet"===t?(d.numberFormat=e,d.characterFormat.fontFamily=i,d.listLevelPattern=t):(d.listLevelPattern=t,d.characterFormat.fontFamily=i,h=d.numberFormat.substring(d.numberFormat.length-1),d.numberFormat.length!==e.length&&0<c?d.numberFormat=e:e.substring(e.length-1)!==d.numberFormat.substring(d.numberFormat.length-1)&&(d.numberFormat=d.numberFormat.replace(h,e.substring(e.length-1)))),n.paragraphFormat.setList(g))},o.prototype.addListLevels=function(e,t,i){for(var n=[String.fromCharCode(61558),String.fromCharCode(61656),String.fromCharCode(61607),String.fromCharCode(61623),String.fromCharCode(61608)],r=e.levels.length;r<9;r++){var o=new El(e);if(t.match("bullet"))o.listLevelPattern="Bullet",o.numberFormat=n[r<5?r%5:r%5+1],o.characterFormat.fontFamily=r<3||5===r?"Wingdings":"Symbol";else{if(t.match("multiLevel")){for(var s=0;s<r+1;s++)o.numberFormat+="%"+(s+1).toString()+".";o.listLevelPattern="Number"}else o.numberFormat="%"+(r+1).toString()+")",o.listLevelPattern=r%3==0?"Number":r%3==1?"LowLetter":"LowRoman";o.startAt=1,o.restartLevel=r}o.paragraphFormat.leftIndent=0===r?36:36*r,o.paragraphFormat.firstLineIndent=-18,e.levels.push(o),i.paragraphFormat.listLevelNumber=r}},o.prototype.insertPageBreak=function(){this.owner.isReadOnlyMode||this.documentHelper.selection.start.paragraph.isInsideTable||this.documentHelper.selection.start.paragraph.isInHeaderFooter||(this.initComplexHistory("PageBreak"),this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.onEnter("PageBreak"),this.isSkipOperationsBuild=!1,this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.owner.enableAutoFocus&&this.selection.checkForCursorVisibility())},o.prototype.insertColumnBreak=function(){var e;this.owner.isReadOnlyMode||this.documentHelper.selection.start.paragraph.isInsideTable||this.documentHelper.selection.start.paragraph.isInHeaderFooter||(this.initComplexHistory("ColumnBreak"),e=this.documentHelper.selection.start.paragraph,this.viewer instanceof Sd&&1<e.bodyWidget.sectionFormat.columns.length&&(e=this.documentHelper.layout.getBodyWidget(e.bodyWidget,!1),_.isNullOrUndefined(e.nextRenderedWidget)||e.page!==e.nextRenderedWidget.page||this.documentHelper.layout.combineMultiColumn(e)),this.onEnter("ColumnBreak"),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.owner.enableAutoFocus&&this.selection.checkForCursorVisibility())},o.prototype.onEnter=function(e){this.handledEnter=!0;var t,i=this.documentHelper.selection,n=!1;if((_.isNullOrUndefined(i.start.paragraph.paragraphFormat.baseStyle)||"Normal"===i.start.paragraph.paragraphFormat.baseStyle.name||"Normal (Web)"===i.start.paragraph.paragraphFormat.baseStyle.name)&&((t=new bm(void 0)).cloneFormat(this.selection.characterFormat),i.start.paragraph.lastChild.children[i.start.paragraph.lastChild.children.length-1]instanceof Bh)&&(t.baselineAlignment="Normal"),i.isEmpty&&i.start.paragraph.isInsideTable&&(i.start.paragraph.associatedCell.ownerTable.isInsideTable||1===i.startPage)&&0===i.start.paragraph.associatedCell.ownerTable.index&&0===i.start.paragraph.associatedCell.columnIndex&&0===i.start.paragraph.associatedCell.rowIndex&&0===i.start.paragraph.index&&0===i.start.offset&&(n=!0),!this.isXmlMapped){if(i.isEmpty){var r=i.getHyperlinkField();if(!_.isNullOrUndefined(r))return void i.fireRequestNavigate(r);if((r=i.start.paragraph).isEmpty()&&-1!==r.paragraphFormat.listFormat.listId&&!n)return void this.onApplyListInternal(this.documentHelper.getListById(r.paragraphFormat.listFormat.listId),r.paragraphFormat.listFormat.listLevelNumber-1)}var o=this.checkAndRemoveComments(),s=(this.initHistory("Enter"),!0);if(s=i.isEmpty||i.isImageSelected?s:this.removeSelectedContents(i)){i.isImageSelected&&!i.isForward&&(s=i.start,i.start=i.end,i.end=s),i.owner.isShiftingEnabled=!0,this.updateInsertPosition();s=this.selection.getParagraphInfo(i.start),s=this.selection.getHierarchicalIndex(s.paragraph,s.offset.toString());if(this.splitParagraphInternal(i,i.start.paragraph,i.start.currentWidget,i.start.offset,n),this.setPositionForCurrentIndex(i.start,s),!_.isNullOrUndefined(e)&&("PageBreak"===e||"ColumnBreak"===e)){var s=i.start.paragraph,a=new G,l=(a.characterFormat.copyFormat(s.characterFormat),a.paragraphFormat.copyFormat(s.paragraphFormat),new X);switch(e){case"PageBreak":l.text="\f";break;case"ColumnBreak":l.text=String.fromCharCode(14)}var d=new uh(a);d.children.push(l),l.line=d,a.childWidgets.push(d),this.owner.enableTrackChanges&&0<s.characterFormat.revisions.length&&((d=this.retrieveRevisionInOder(s.characterFormat)).range.push(a.characterFormat),a.characterFormat.revisions.push(d),this.owner.trackChangesPane.updateCurrentTrackChanges(d),a.characterFormat.removedIds=[]),this.insertParagraph(a,!0),i.selectParagraphInternal(a,!0)}var s=i.start.paragraph.nextWidget,h=(_.isNullOrUndefined(s)&&(s=i.getNextRenderedBlock(i.start.paragraph)),i.selectParagraphInternal(n?i.start.paragraph:s,!0),n||this.updateEndPosition(),!_.isNullOrUndefined(e)&&this.editorHistory&&this.owner.editorHistoryModule.updateHistory(),this.reLayout(i),this.selection.start.paragraph.containerWidget.firstChild);if(!_.isNullOrUndefined(h)){h.isChangeDetected=!1;for(var c=h.nextRenderedWidget;this.owner.isSpellCheck&&!_.isNullOrUndefined(c);)(h=c).isChangeDetected=!1,c=h.nextRenderedWidget}r=i.start.paragraph.previousWidget;!_.isNullOrUndefined(r)&&!r.isEmpty()&&r.lastChild.children[r.lastChild.children.length-1]instanceof X&&this.checkAndConvertToHyperlink(i,!0,r)}_.isNullOrUndefined(t)||_.isNullOrUndefined(i.start.paragraph)||!i.start.paragraph.isEmpty()||n||(this.selection.isRetrieveFormatting=!0,this.selection.characterFormat.cloneFormat(t),this.selection.isRetrieveFormatting=!1),this.documentHelper.layout.islayoutFootnote=!1,this.updateHistoryForComments(o),this.handledEnter=!1}},o.prototype.splitParagraphInternal=function(e,t,i,n,r){var o=0,s=t.index,a=t,l=!1;for(a.isChangeDetected=0===n;this.owner.isSpellCheck&&!_.isNullOrUndefined(a.nextRenderedWidget);)(a=a.nextRenderedWidget).isChangeDetected=!0;var d,h=new G,c=new uh(h);h.childWidgets.push(c),h.paragraphFormat.ownerBase=h,i!==t.lastChild||n!==e.getLineLength(i)||t.isContainsShapeAlone()?(h.paragraphFormat.copyFormat(t.paragraphFormat),h.characterFormat.copyFormat(t.characterFormat),!(0<n)&&i.isFirstLine()||t.isContainsShapeAlone()?(c=t.previousRenderedWidget,e=!1,!_.isNullOrUndefined(c)&&c instanceof G&&(e=0<c.characterFormat.revisions.length),this.owner.enableTrackChanges&&(e?this.checkToMatchEmptyParaMark(t,h)||this.insertParaRevision(t):(c=t.firstChild.children[0].previousValidNodeForTracking,_.isNullOrUndefined(c)||this.checkParaMarkMatchedWithElement(c,h.characterFormat,!0,"Insertion")?_.isNullOrUndefined(c)&&(o++,s++):this.insertParaRevision(h)))):(t=t.combineWidget(this.owner.viewer),this.moveInlines(t,h,0,0,t.firstChild,n,i),this.owner.enableTrackChanges&&this.insertParaRevision(h,t.firstChild)),t=t.getSplitWidgets()[0]):(r||(t.paragraphFormat.baseStyle&&"Normal"!==t.paragraphFormat.baseStyle.name&&t.paragraphFormat.baseStyle.next instanceof ul?(t.paragraphFormat.baseStyle.name===t.paragraphFormat.baseStyle.next.name?(h.paragraphFormat.copyFormat(t.paragraphFormat),h.characterFormat.copyFormat(t.characterFormat)):h.paragraphFormat.baseStyle=t.paragraphFormat.baseStyle.next,this.selection.skipFormatRetrieval=!1):(h.paragraphFormat.copyFormat(t.paragraphFormat),h.characterFormat.copyFormat(t.characterFormat)),0<t.lastChild.children.length&&t.characterFormat.copyFormat(t.lastChild.children[t.lastChild.children.length-1].characterFormat)),this.handledEnter&&this.selection.isEmpty&&this.selection.start.isAtParagraphEnd&&0<t.characterFormat.revisions.length&&(l=!0,h.characterFormat.removedIds=[]),this.owner.enableTrackChanges&&(e=t.lastChild,!_.isNullOrUndefined(e))&&0<e.children.length&&(c=e.children[e.children.length-1].previousValidNodeForTracking,_.isNullOrUndefined(c)||this.checkParaMarkMatchedWithElement(c,t.characterFormat,!1,"Insertion")||(l?(this.insertParaRevision(h),l=!1):this.insertParaRevision(t))),o++,s++),r?((d=t.associatedCell.ownerTable.containerWidget).childWidgets.splice(s=o=0,0,h),h.containerWidget=d,h.index=0,this.updateNextBlocksIndex(h,!0),this.owner.selectionModule.start.setPositionParagraph(h.firstChild,0),this.owner.selectionModule.end.setPositionParagraph(h.firstChild,1),_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionStart=this.owner.selectionModule.startOffset,this.editorHistory.currentBaseHistoryInfo.selectionEnd=this.owner.selectionModule.startOffset,this.editorHistory.currentBaseHistoryInfo.insertPosition=this.owner.selectionModule.startOffset,this.editorHistory.currentBaseHistoryInfo.endPosition=this.owner.selectionModule.endOffset)):(o+=t.getIndex(),(d=t.containerWidget).childWidgets.splice(o,0,h),h.containerWidget=d,h.index=s,this.updateNextBlocksIndex(h,!0)),(!_.isNullOrUndefined(d.containerWidget)&&d.containerWidget instanceof q||d instanceof N&&!_.isNullOrUndefined(d.bodyWidget)&&d.bodyWidget.containerWidget instanceof q)&&(n=this.documentHelper.textHelper.getParagraphMarkSize(h.characterFormat).Height,d instanceof N?(d.bodyWidget.height+=n,d.bodyWidget.containerWidget.height+=n):(d.containerWidget.height+=n,d.height+=n)),this.owner.enableTrackChanges&&0===h.characterFormat.revisions.length&&(i=void 0,0!==t.characterFormat.revisions.length||r?(l||r)&&(i=h):i=t,_.isNullOrUndefined(i)||this.checkToMatchEmptyParaMark(i)||this.insertParaRevision(i)),this.documentHelper.layout.layoutBodyWidgetCollection(s,d,h,!1)},o.prototype.insertParaRevision=function(e,t){this.owner.enableTrackChanges&&_.isNullOrUndefined(t)&&!this.isRevisionMatched(e.characterFormat,"Insertion")&&(e.characterFormat.revisions=[],this.insertRevision(e.characterFormat,"Insertion")),_.isNullOrUndefined(t)||(t.paragraph.isInsideTable?this.insertRevision(e.characterFormat,"Insertion"):this.applyRevisionForParaMark(e,t,"Insertion",!0))},o.prototype.applyRevisionForParaMark=function(e,t,i,n){var r=t?t.children[0]:void 0,o=(_.isNullOrUndefined(r)||(r=r.nextValidNodeForTracking),e.lastChild),o=0===o.children.length?void 0:o.children[o.children.length-1].previousValidNodeForTracking,s=!1,a=e.characterFormat.revisions.length;if(_.isNullOrUndefined(o)||(s=this.checkParaMarkMatchedWithElement(o,e.characterFormat,!1,i)),!_.isNullOrUndefined(r))if(e.characterFormat.revisions.length>a){if(this.isRevisionMatched(r,i))for(var l=e.characterFormat.revisions[0],d=this.getMatchedRevisionsToCombine(r.revisions,i),h=0;h<d.length;h++)d[h]!==l&&(s=!0,this.clearAndUpdateRevisons(d[h].range,l,l.range.indexOf(e.characterFormat)+1))}else s=this.checkParaMarkMatchedWithElement(r,e.characterFormat,!0,i);!s&&(this.owner.enableTrackChanges||!_.isNullOrUndefined(t)&&0<t.paragraph.characterFormat.revisions.length)&&(this.insertRevision(e.characterFormat,i),n)&&0<o.revisions.length&&!_.isNullOrUndefined(r)&&0<r.revisions.length&&this.updateRevisionForSpittedTextElement(o,r)},o.prototype.checkParaMarkMatchedWithElement=function(e,t,i,n){n=this.getMatchedRevisionsToCombine(e.revisions,n);return 0<n.length&&(this.mapMatchedRevisions(n,e,t,i),!0)},o.prototype.checkToMatchEmptyParaMark=function(e,t){var i=e.previousRenderedWidget;if(!_.isNullOrUndefined(i)&&i instanceof G&&0<i.characterFormat.revisions.length){var n=this.getMatchedRevisionsToCombine(i.characterFormat.revisions,"Insertion");if(0<n.length)return _.isNullOrUndefined(t)?this.mapMatchedRevisions(n,i.characterFormat,e.characterFormat,!1):this.mapMatchedRevisions(n,i.characterFormat,t.characterFormat,!1),!0}return!1},o.prototype.checkToMatchEmptyParaMarkBack=function(e){var t,i=e.nextRenderedWidget,n=i.childWidgets[0],r=n.children[0];if(!_.isNullOrUndefined(i)&&i instanceof G&&0<i.characterFormat.revisions.length){if(0<(t=this.getMatchedRevisionsToCombine(i.characterFormat.revisions,"Deletion")).length)return null!=i&&null!=n&&null!=r&&1==r.revisions.length?this.mapMatchedRevisions(t,r,e.characterFormat,!0):this.mapMatchedRevisions(t,i.characterFormat,e.characterFormat,!0),!0}else if(null!=r&&1==r.revisions.length)if(0<(t=this.getMatchedRevisionsToCombine(r.revisions,"Deletion")).length)return this.mapMatchedRevisions(t,r,e.characterFormat,!0),!0;return!1},o.prototype.updateNextBlocksIndex=function(e,t){if(!(_.isNullOrUndefined(e.nextRenderedWidget)||e.nextRenderedWidget instanceof G&&e.bodyWidget.index!==e.nextRenderedWidget.bodyWidget.index)){var i=e.containerWidget.childWidgets.indexOf(e)+1;if(e.containerWidget instanceof z&&!(e.containerWidget.containerWidget instanceof q))if(1<e.containerWidget.page.bodyWidgets.length&&1<e.containerWidget.sectionFormat.numberOfColumns)for(var n=e.containerWidget.indexInOwner,r=this.documentHelper.pages.indexOf(e.containerWidget.page);r<this.documentHelper.pages.length;r++){for(var o=this.documentHelper.pages[r],s=0;s<o.bodyWidgets.length;s++)if(o.bodyWidgets[s].indexInOwner===n){for(var a=i;a<o.bodyWidgets[s].childWidgets.length;a++){var l=o.bodyWidgets[s].childWidgets[a];this.updateIndex(l,t)}i=0,_.isNullOrUndefined(o.bodyWidgets[s].nextRenderedWidget)||o.bodyWidgets[s].nextRenderedWidget.sectionIndex!==o.bodyWidgets[s].sectionIndex||n++}n!==e.containerWidget.indexInOwner&&!_.isNullOrUndefined(o.bodyWidgets[o.bodyWidgets.length-1].nextRenderedWidget)&&1<o.bodyWidgets[o.bodyWidgets.length-1].nextRenderedWidget.sectionFormat.columns.length&&(n=0)}else if(1<e.containerWidget.page.bodyWidgets.length){for(var d=e.containerWidget.index,r=this.documentHelper.pages.indexOf(e.containerWidget.page);r<this.documentHelper.pages.length;r++)for(o=this.documentHelper.pages[r],s=0;s<o.bodyWidgets.length;s++)if(o.bodyWidgets[s].index===d){for(a=i;a<o.bodyWidgets[s].childWidgets.length;a++){l=o.bodyWidgets[s].childWidgets[a];this.updateIndex(l,t)}i=0}}else for(d=e.containerWidget.index,s=this.documentHelper.pages.indexOf(e.containerWidget.page);s<this.documentHelper.pages.length;s++){if((o=this.documentHelper.pages[s]).bodyWidgets[0].index!==d)return;for(a=i;a<o.bodyWidgets[0].childWidgets.length;a++){l=o.bodyWidgets[0].childWidgets[a];this.updateIndex(l,t)}i=0}else if(e.containerWidget instanceof N)for(var h=e.containerWidget.getSplitWidgets(),c=h.indexOf(e.containerWidget);c<h.length;c++){for(var p=h[c].childWidgets,u=i;u<p.length;u++)this.updateIndex(p[u],t);i=0}else if(e.containerWidget instanceof dh)for(r=i;r<e.containerWidget.childWidgets.length;r++){var g=e.containerWidget.childWidgets[r];g.rowIndex===e.containerWidget.index&&this.updateIndex(g,t)}else if(e.containerWidget instanceof K)for(r=i;r<e.containerWidget.childWidgets.length;r++){var m=e.containerWidget.childWidgets[r];this.updateIndex(m,t);for(s=0;s<m.childWidgets.length;s++)m.childWidgets[s].rowIndex=m.index}else if(e.containerWidget instanceof Xd||e.containerWidget instanceof fc||!_.isNullOrUndefined(e.containerWidget)&&e.containerWidget.containerWidget instanceof q)for(r=i;r<e.containerWidget.childWidgets.length;r++){var f=e.containerWidget.childWidgets[r];this.updateIndex(f,t)}}},o.prototype.updateIndex=function(e,t){t?e.index++:e.index--},o.prototype.updateEndPosition=function(){var e=this.documentHelper.selection;this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.updateHistoryPosition(e.start,!1)},o.prototype.checkAndRemoveComments=function(){var e=this.selection;if(e.isEmpty||this.owner.enableTrackChanges)return[];var t=this.getSelectedComments();if(0<t.commentEndInfo.length||0<t.commentStartInfo.length){this.initComplexHistory("RemoveComment");for(var i=this.selection.start,n=this.selection.end,r=(this.selection.isForward||(i=this.selection.end,n=this.selection.start),this.selection.getParagraphInfo(i)),o=this.selection.getParagraphInfo(n),s=0;s<t.commentEndInfo.length;s++){var a=t.commentEndInfo[s].comment,l=a.commentStart,d=a.commentEnd,h=this.selection.getParagraphInfoInternal(l.line,l.line.getOffset(l,0)),l=this.selection.getParagraphInfoInternal(d.line,d.line.getOffset(d,0));if(o.paragraph===l.paragraph){if(0<a.replyComments.length)for(var c=0;c<a.replyComments.length;c++){var p=a.replyComments[c];_.isNullOrUndefined(p.commentEnd)||o.offset--}o.offset--}if(r.paragraph===h.paragraph){d=h.offset<r.offset;if(0<a.replyComments.length)for(c=0;c<a.replyComments.length;c++){p=a.replyComments[c];_.isNullOrUndefined(p.commentStart)||(this.selection.getParagraphInfoInternal(p.commentStart.line,p.commentStart.line.getOffset(p.commentStart,0)).offset<r.offset&&r.offset--,o.paragraph===h.paragraph&&o.offset--)}d&&r.offset--,o.paragraph===h.paragraph&&o.offset--}this.deleteCommentInternal(a)}if(0<t.commentStartInfo.length)for(var u=0;u<t.commentStartInfo.length;u++)t.commentStartInfo[u].line.paragraph.equals(o.paragraph)&&o.offset--,this.removeInline(t.commentStartInfo[u]);i=e.getLineInfoBasedOnParagraph(r.paragraph,r.offset),n=(e.start.setPositionFromLine(i.line,i.offset),e.getLineInfoBasedOnParagraph(o.paragraph,o.offset));e.end.setPositionFromLine(n.line,n.offset)}return t.commentStartInfo},o.prototype.updateHistoryForComments=function(e){if(this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&"RemoveComment"===this.editorHistory.currentHistoryInfo.action){if(!_.isNullOrUndefined(e))for(var t=0;t<e.length;t++)this.initInsertInline(e[t],!1);this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory()}},o.prototype.onBackSpace=function(){this.removeEditRange=!0;var e=this.documentHelper.selection;if(this.documentHelper.triggerSpellCheck=!0,0<e.bookmarks.length&&this.extendSelectionToBookmarkStart(),e.isEmpty)this.singleBackspace(e,!1);else{var t=this.checkAndRemoveComments(),i=(this.initHistory("BackSpace"),this.deleteSelectedContents(e,!0));if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(i?this.editorHistory.currentBaseHistoryInfo=void 0:(this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.isSkipOperationsBuild=!_.isNullOrUndefined(this.alertDialog),this.reLayout(e),this.isSkipOperationsBuild=!1,this.insertSpaceInFormField())),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)){for(var n=0;n<t.length;n++)this.initInsertInline(t[n],!1);this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory()}this.owner.isSpellCheck&&(this.documentHelper.triggerSpellCheck=!1)}i=this.documentHelper.owner.editor.getContentControl();_.isNullOrUndefined(i)||(this.selection.contentControleditRegionHighlighters.clear(),this.selection.onHighlightContentControl()),this.removeEditRange=!1,this.documentHelper.layout.islayoutFootnote=!1,this.updateXmlMappedContentControl()},o.prototype.insertRemoveBookMarkElements=function(e){var t=!1;if(!this.isRemoteAction)for(var i=0;i<this.removedBookmarkElements.length;i++){var n,r,o,s=this.removedBookmarkElements[i];0===s.bookmarkType?(n=s)&&n.reference&&-1!==this.removedBookmarkElements.indexOf(n.reference)?(r=this.removedBookmarkElements.indexOf(n.reference),o=this.removedBookmarkElements.indexOf(n),this.removedBookmarkElements.splice(r,1),this.removedBookmarkElements.splice(o,1),i--):(this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(n.clone(),void 0,!0),this.editorHistory.currentHistoryInfo&&i===this.removedBookmarkElements.length-1&&0===this.removedEditRangeStartElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)):(n=s)&&n.reference&&-1!==this.removedBookmarkElements.indexOf(n.reference)?(r=this.removedBookmarkElements.indexOf(n.reference),o=this.removedBookmarkElements.indexOf(n),this.removedBookmarkElements.splice(r,1),this.removedBookmarkElements.splice(o,1),i--):(this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(n.clone(),void 0,!0),this.editorHistory.currentHistoryInfo&&i===this.removedBookmarkElements.length-1&&0===this.removedEditRangeStartElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0))}return this.removedBookmarkElements=[],t},o.prototype.insertRemovedEditRangeEndElements=function(e){var t=!1;if(!this.isRemoteAction)for(var i=this.removedEditRangeEndElements.length-1;0<=i;i--){var n,r,o=this.removedEditRangeEndElements[i];o&&-1!==this.removedEditRangeStartElements.indexOf(o.editRangeStart)?(r=this.removedEditRangeEndElements.indexOf(o),n=this.removedEditRangeStartElements.indexOf(o.editRangeStart),this.removedEditRangeEndElements.splice(r,1),this.removedEditRangeStartElements.splice(n,1),i--):(this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(o.clone(),void 0,!0),(r=this.selection.start.paragraph.getInline(this.selection.start.offset,0)).element.editRangeStart.editRangeEnd=r.element,this.editorHistory.currentHistoryInfo&&0===i&&0===this.removedEditRangeStartElements.length&&0===this.removedBookmarkElements.length&&(this.editorHistory.updateComplexHistory(),t=!0))}return this.removedEditRangeEndElements=[],t},o.prototype.insertRemovedEditRangeStartElements=function(e){var t=!1;if(!this.isRemoteAction)for(var i=0;i<this.removedEditRangeStartElements.length;i++){var n,r,o=this.removedEditRangeStartElements[i];o&&-1!==this.removedEditRangeEndElements.indexOf(o.editRangeEnd)?(r=this.removedEditRangeEndElements.indexOf(o.editRangeEnd),n=this.removedEditRangeStartElements.indexOf(o),this.removedEditRangeEndElements.splice(r,1),this.removedEditRangeStartElements.splice(n,1),i--):(this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(o.clone(),void 0,!0),(r=this.selection.start.paragraph.getInline(this.selection.start.offset,0)).element.editRangeEnd.editRangeStart=r.element,this.editorHistory.currentHistoryInfo&&i===this.removedEditRangeStartElements.length-1&&0===this.removedBookmarkElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0))}return this.removedEditRangeStartElements=[],t},o.prototype.deleteSelectedContents=function(e,t,i){t=this.deleteSelectedContentInternal(e,t,e.start,e.end,i),i=e.getTextPosBasedOnLogicalIndex(e.editPosition);return e.selectContent(i,!0),t},o.prototype.removeWholeElement=function(e){this.initHistory("BackSpace"),this.deleteSelectedContents(e,!0),this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e)},o.prototype.getSelectedComments=function(){for(var e=this.documentHelper.comments,t=[],i=[],n=0;n<e.length;n++){var r=e[n],o=r.commentEnd,s=r.commentStart;if(!_.isNullOrUndefined(o)&&this.selection.isElementInSelection(o,!0))t.push(o);else if(!_.isNullOrUndefined(s)&&this.selection.isElementInSelection(s,!1)){i.push(s);for(var a=0;a<r.replyComments.length;a++)r.replyComments[a].commentStart&&i.push(r.replyComments[a].commentStart)}}return{commentStartInfo:i,commentEndInfo:t}},o.prototype.singleBackspace=function(e,t){var i=this.editorHistory;if(i&&!t&&!i.canRedo()&&i.canUndo()){var n=i.undoStack[i.undoStack.length-1],r=this.selection.getParagraphInfo(e.start),o=this.selection.getParagraphInfo(e.end);if("AutoFormatHyperlink"===n.action&&n.insertPosition===this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())&&n.endPosition===this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()))return void i.undo()}for(var s,a=e.start.paragraph,r=e.start.currentWidget,l=e.start.offset,n=r.getInline(l,0),d=n.element,h=!1,c=l,p=!1;d instanceof up;){var u=d,d=d.previousNode;if(_.isNullOrUndefined(d)&&(d=s),_.isNullOrUndefined(d)||0!=d.commentType?d instanceof Y&&(d=void 0):s=d.previousNode,d&&(c=d.length),!(0!==u.commentType||!_.isNullOrUndefined(d)&&d instanceof up)){c=_.isNullOrUndefined(d)?(d=u,0):d.length,p=!0;break}1===u.commentType&&(h||(this.initComplexHistory("RemoveComment"),h=!0),this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.deleteCommentInternal(u.comment),p=!(this.isSkipOperationsBuild=!1))}if(p&&(_.isNullOrUndefined(d)?(b=a.childWidgets[0],e.start.setPositionParagraph(b,0),e.end.setPositionParagraph(b,0)):(a=d.line.paragraph,l=d.line.getOffset(d,c),e.start.setPositionParagraph(d.line,l),e.end.setPositionParagraph(d.line,l))),d instanceof E){var g=this.getContentControl();if(this.selection.selectContentControlInternal(g),!_.isNullOrUndefined(g)&&1===d.type&&g.contentControlProperties.lockContentControl||_.isNullOrUndefined(d.nextElement)){if(!this.selection.isEmpty)return;this.onBackSpace()}if(!_.isNullOrUndefined(g)&&0===d.type&&d.nextElement!==g.reference||!_.isNullOrUndefined(g)&&0===d.type&&g.contentControlProperties.lockContentControl&&d.nextElement===g.reference)return}if(this.selection.isInlineFormFillMode()){if(d instanceof Z&&2===d.fieldType)return;if(1===this.getFieldResultText().length)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField())}if((n.index,d instanceof X&&(d.ignoreOnceItems=[]),d instanceof X&&(d.ignoreOnceItems=[]),d instanceof Z&&2===d.fieldType)&&j.isLinkedFieldCharacter(d))return k=d.fieldBegin,m=d.fieldEnd,k.nextNode instanceof J&&k.nextNode.reference&&(m=k.nextNode.reference),e.start.setPositionParagraph(k.line,k.line.getOffset(k,0)),e.end.setPositionParagraph(m.line,m.line.getOffset(m,0)+1),void e.fireSelectionChanged(!0);if(!this.owner.enableTrackChanges&&d instanceof Bh&&("Footnote"===d.footnoteType?this.removeFootnote(d):this.removeEndnote(d)),d&&(d instanceof E||d.previousNode instanceof E)&&(d instanceof E&&d.previousNode&&!(d.previousElement instanceof Y)&&(a=(d=d.previousNode).line.paragraph,l=d.line.getOffset(d,d.length)),d)&&1===d.length&&d.nextNode instanceof E&&d.previousNode instanceof E){var o=d.previousNode,m=d.nextNode;if(!o.contentControlProperties.lockContentControl)return e.start.setPositionParagraph(o.line,o.line.getOffset(o,0)),e.end.setPositionParagraph(m.line,m.line.getOffset(m,0)+1),void this.removeWholeElement(e)}if(d instanceof Z&&1===d.fieldType&&!this.selection.isInlineFormFillMode()){i=e.getPreviousValidElement(d);if(i instanceof Z)return a=(d=i.fieldBegin).line.paragraph,l=d.line.getOffset(d,0),d.nextNode instanceof J&&d.nextNode.reference&&(r=d.nextNode.reference,e.start.setPositionParagraph(r.line,r.line.getOffset(r,1))),e.end.setPositionParagraph(d.line,l),void e.fireSelectionChanged(!0);i!==d&&(a=(d=i).line.paragraph,l=d.line.getOffset(d,d.length))}if(d instanceof Wc||d instanceof Sc){if(d.nextNode instanceof Sc&&d.editRangeEnd===d.nextNode||d.previousNode instanceof Wc&&d.editRangeStart===d.previousNode)return;if(d instanceof Wc&&!(d.previousNode instanceof Sc))return;if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType&&(d instanceof Wc||d instanceof Sc))return;if(d instanceof Sc)for(;!_.isNullOrUndefined(d.previousNode)&&(a=(d=d.previousNode).line.paragraph,l=d.line.getOffset(d,d.length),d instanceof Sc););if(1===d.length&&d.nextNode instanceof Sc&&d.previousNode instanceof Wc)return n=d.previousNode,m=d.nextNode,e.start.setPositionParagraph(n.line,n.line.getOffset(n,0)),e.end.setPositionParagraph(m.line,m.line.getOffset(m,0)+1),void this.removeWholeElement(e)}if(d&&(d instanceof J||d.previousNode instanceof J)){if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType&&(d.previousNode&&d.previousNode instanceof Wc||d.previousNode instanceof Sc))return;if(d instanceof J)if(d.previousNode){if((d=d.previousNode)instanceof Z&&!this.selection.isInlineFormFillMode())return a=(d=d.fieldBegin).line.paragraph,l=d.line.getOffset(d,0),d.nextNode instanceof J&&d.nextNode.reference&&(o=d.nextNode.reference,e.start.setPositionParagraph(o.line,o.line.getOffset(o,1))),e.end.setPositionParagraph(d.line,l),void e.fireSelectionChanged(!0);a=d.line.paragraph,l=d.line.getOffset(d,d.length),e.start.setPositionFromLine(d.line,l),e.end.setPositionInternal(e.start)}else if(1===d.bookmarkType){if(a.previousRenderedWidget instanceof G)return r=(f=a.previousRenderedWidget).lastChild,e.start.setPositionParagraph(d.line,d.line.getOffset(d,0)),e.end.setPositionParagraph(r,r.getEndOffset()),void this.removeWholeElement(e)}else{if(!(d.paragraph.previousWidget instanceof G))return;e.start.setPositionFromLine(d.line,0),e.end.setPositionInternal(e.start),l=0}else if(d.nextNode instanceof J&&d instanceof J&&0===d.bookmarkType&&d.reference===d.nextNode)return void this.deleteBookmark(d.name);if(1===d.length&&d.nextNode instanceof J&&d.previousNode instanceof J)return k=d.previousNode,m=d.nextNode,e.start.setPositionParagraph(k.line,k.line.getOffset(k,0)),e.end.setPositionParagraph(m.line,m.line.getOffset(m,0)+1),void this.removeWholeElement(e)}if(t||this.initHistory("BackSpace"),l===e.getStartOffset(a)&&e.start.currentWidget.isFirstLine()){if(a.paragraphFormat.listFormat&&-1!==a.paragraphFormat.listFormat.listId)return void(!_.isNullOrUndefined(this.editorHistory)&&!_.isNullOrUndefined(this.editorHistory.undoStack)&&0<this.editorHistory.undoStack.length&&"ListFormat"===this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].action?this.onApplyListInternal(this.documentHelper.getListById(a.paragraphFormat.listFormat.listId),a.paragraphFormat.listFormat.listLevelNumber-1):this.onApplyList(void 0));if(0!==a.paragraphFormat.firstLineIndent)return this.onApplyParagraphFormat("firstLineIndent",0,!1,!1),void(0!==a.paragraphFormat.leftIndent&&this.onApplyParagraphFormat("leftIndent",0,!1,!1));if(0!==a.paragraphFormat.leftIndent)return void this.onApplyParagraphFormat("leftIndent",0,!1,!1);if(!a.paragraphFormat.bidi&&"Left"!==a.paragraphFormat.textAlignment)return void this.onApplyParagraphFormat("textAlignment","Left",!1,!0);if(a.previousRenderedWidget instanceof G){e.owner.isShiftingEnabled=!0;var f,y=a.previousRenderedWidget;if(this.owner.enableTrackChanges&&null!=a.previousRenderedWidget&&0==a.previousRenderedWidget.characterFormat.revisions.length)w=(v=(this.checkToMatchEmptyParaMarkBack(y)||this.insertRevision(y.characterFormat,"Deletion"),this.documentHelper.selection.getLineLength(y.lastChild)),y.childWidgets.length-1),this.documentHelper.layout.reLayoutParagraph(y,w,0),e.selects(y.childWidgets[w],v,!0),this.addRemovedNodes(a);else if(y.isEmpty()&&!this.owner.enableTrackChanges)this.removePrevParaMarkRevision(a),a!==a.bodyWidget.lastChild||y.bodyWidget.index===a.bodyWidget.index?(this.removeBlock(y),this.addRemovedNodes(y),f=a.previousRenderedWidget,!_.isNullOrUndefined(f)&&f instanceof G&&f.isEmpty()&&f.bodyWidget.index!==a.bodyWidget.index&&e.moveToPreviousCharacter()):(v=this.documentHelper.selection.getLineLength(y.lastChild),w=y.childWidgets.length-1,e.selects(y.childWidgets[w],v,!0));else if(this.owner.enableTrackChanges&&null!=y.characterFormat.revisions&&"Deletion"==y.characterFormat.revisions[0].revisionType){var v=this.documentHelper.selection.getLineLength(y.lastChild),w=y.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(y,w,0),e.selects(y.childWidgets[w],v,!0),this.addRemovedNodes(a)}else if(this.owner.enableTrackChanges&&null!=y.characterFormat.revisions&&e.start.isAtParagraphStart&&y.isEmpty())this.addRemovedRevisionInfo(y.characterFormat,void 0,!1),this.addRemovedNodes(y),this.removePrevParaMarkRevision(a),this.removeBlock(y,!1,!0);else{var i=!1,v=(a===a.bodyWidget.lastChild&&y.bodyWidget.index!==a.bodyWidget.index||"NoBreak"===a.bodyWidget.sectionFormat.breakCode&&a===a.bodyWidget.firstChild||(null!=y.characterFormat.revisions&&(this.addRemovedRevisionInfo(y.characterFormat,void 0,!1),this.addRemovedNodes(y.characterFormat)),this.removePrevParaMarkRevision(a),this.removeBlock(a,!1,!0),i=!0),this.documentHelper.selection.getLineLength(y.lastChild)),w=y.childWidgets.length-1,b=void 0;if(!a.isEmpty()&&i)for(var x=0;x<a.childWidgets.length;x++){b=a.childWidgets[x],y.childWidgets.push(b);for(var C,I=0;I<b.children.length;I++)b.children[I]instanceof Bh&&-1===this.documentHelper.footnoteCollection.indexOf(b.children[I])&&(b.children[I].isLayout=!1,C=parseInt(b.children[I].text),this.documentHelper.footnoteCollection.splice(C-1,0,b.children[I]));a.childWidgets.splice(x,1),x--,b.paragraph=y}this.documentHelper.layout.reLayoutParagraph(y,w,0),e.selects(y.childWidgets[w],v,!0),i&&this.addRemovedNodes(a)}this.setPositionForHistory(),0<this.documentHelper.layout.getFootNoteWidgetsOf(a).length&&(n=this.documentHelper.layout,o=a.bodyWidget,n.layoutfootNote(o.page.footnoteWidget)),this.reLayout(e)}else this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0)}else{t||(e.owner.isShiftingEnabled=!0);var r=this.selection.getParagraphInfo(e.start),b=e.start.currentWidget,k=l-1,g=(k<0&&(b=b.previousLine,k=this.documentHelper.selection.getLineLength(b)+k),this.removeAtOffset(b,e,k),this.documentHelper.owner.editor.getContentControl());!_.isNullOrUndefined(g)&&g.contentControlProperties.isTemporary&&this.removeContentControl(),this.setPositionParagraph(r.paragraph,r.offset-1,!1),this.setPositionForHistory(),t?this.fireContentChange():this.reLayout(e)}h&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory())},o.prototype.setPositionForHistory=function(e){var t=this.documentHelper.selection;this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(_.isNullOrUndefined(e)?(this.updateHistoryPosition(t.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition):(this.editorHistory.currentBaseHistoryInfo.insertPosition=e,this.editorHistory.currentBaseHistoryInfo.endPosition=e))},o.prototype.removeAtOffset=function(e,t,i){for(var n=0,r=e.paragraph.childWidgets.indexOf(e),o=e.children.length,s=0;s<o;s++){var a=e.children[s];if(!(a instanceof Y)){if(this.removeCharacter(a,i,n,e,r,s))break;n+=a.length}}},o.prototype.removeCharacter=function(e,t,i,n,r,o,s){var a,l,d,h=!1;return e instanceof J&&e.reference&&e.line!==e.reference.line&&!(n.children[o]instanceof J)?(_.isNullOrUndefined(e.line.previousLine)?_.isNullOrUndefined(e.line.paragraph.previousRenderedWidget)?_.isNullOrUndefined(e.line.paragraph.nextRenderedWidget)||(e.line.paragraph.nextRenderedWidget.firstChild.children.splice(e.line.paragraph.nextRenderedWidget.firstChild.children.length,0,e),e.line=e.line.paragraph.nextRenderedWidget.firstChild):(e.line.paragraph.previousRenderedWidget.lastChild.children.splice(e.line.paragraph.previousRenderedWidget.lastChild.children.length,0,e),e.line=e.line.paragraph.previousRenderedWidget.lastChild):(e.line.previousLine.children.splice(e.line.previousLine.children.length,0,e),e.line=e.line.previousLine),n.children.splice(o,1),!_.isNullOrUndefined(n.layoutedElements)&&0<n.layoutedElements.length&&n.layoutedElements.splice(o,1),!0):(t<i+e.length&&(a=t-i,e.ischangeDetected=!0,this.owner.isSpellCheck&&(d=e.nextElement,l=e.previousElement,this.owner.spellCheckerModule.removeErrorsFromCollection({element:e,text:e.text}),!_.isNullOrUndefined(d)&&d instanceof X&&(d.ischangeDetected=!0,this.owner.spellCheckerModule.removeErrorsFromCollection({element:d,text:d.text})),!_.isNullOrUndefined(l)&&l instanceof X&&(l.ischangeDetected=!0,this.owner.spellCheckerModule.removeErrorsFromCollection({element:l,text:l.text})),e.canTrigger||(this.documentHelper.triggerSpellCheck=!1)),t===i&&1===e.length?(this.owner.enableTrackChanges&&!this.skipTracking()?(this.addRemovedNodes(e.clone()),this.handleDeleteTracking(e,a,1,o)):(this.unLinkFieldCharacter(e),this.unlinkRangeFromRevision(e,!0),this.addRemovedRevisionInfo(e,void 0),this.addRemovedNodes(e),this.owner.enableTrackChanges&&this.editorHistory.isRedoing&&e instanceof Bh&&("Footnote"===e.footnoteType?this.removeFootnote(e):this.removeEndnote(e)),n.children.splice(o,1),!_.isNullOrUndefined(n.layoutedElements)&&0<n.layoutedElements.length&&n.layoutedElements.splice(o,1)),this.documentHelper.layout.reLayoutParagraph(n.paragraph,r,o,void 0,s)):(d=this.handleDeleteTracking(e,a,1),this.documentHelper.layout.reLayoutParagraph(n.paragraph,r,o,void 0,s),_.isNullOrUndefined(d)||(0<e.revisions.length&&this.addRemovedRevisionInfo(e,d),this.addRemovedNodes(d))),e instanceof Wc&&(this.selection.skipEditRangeRetrieval=!0,this.removeUserRestrictionsInternal(e,void 0,!0),this.selection.updateEditRangeCollection(),this.fireContentChange(),this.selection.skipEditRangeRetrieval=!1),e instanceof J&&0===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)&&this.documentHelper.bookmarks.remove(e.name),h=!0),h)},o.prototype.removeCharacterInLine=function(e,t,i){var n,r=new X;return e instanceof X&&(e.isWidthUpdated=!1,r.characterFormat.copyFormat(e.characterFormat),r.text=e.text.substr(t,i=1===i?1:i-t),n=e.text,e.text=n.substring(0,t)+n.substring(t+i,n.length),e.contentControlProperties)&&(r.contentControlProperties=e.contentControlProperties.clone()),r},o.prototype.removeRevisionsInformation=function(e,t,i,n){var r=e.previousElement;"Insertion"===this.retrieveRevisionInOder(r).revisionType&&this.isRevisionMatched(r,void 0)&&e.line.children.splice(n,1)},o.prototype.handleDeleteTracking=function(e,t,i,n,r,o,s){var a=this.owner.enableTrackChanges,l=(_.isNullOrUndefined(this.editorHistory)||this.editorHistory.isUndoing||this.editorHistory.isRedoing,void 0);if(this.canHandleDeletion()||a&&(!this.skipTracking()||e.paragraph.isInsideTable&&!_.isNullOrUndefined(this.editorHistory)&&this.editorHistory.isRedoing&&this.editorHistory.currentBaseHistoryInfo&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)){if(e instanceof J||e instanceof up||e instanceof Wc||e instanceof Sc)return void(e instanceof J&&e.previousElement instanceof Z&&e.previousElement.formFieldData?0<e.previousElement.revisions.length&&this.removeRevisionsInformation(e,t,i,n):a&&e instanceof J?(this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e)):e.line.children.splice(e.indexInOwner,1));a=!1;if(this.owner.editorHistoryModule&&(a=!_.isNullOrUndefined(this.owner.editorHistoryModule.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action),this.skipTableElements||this.updateEndRevisionIndex(),0<e.revisions.length){var d,h,c=this.retrieveRevisionInOder(e),p=this.owner.revisions.changes.indexOf(c);if(_.isNullOrUndefined(this.owner.editorHistoryModule)||_.isNullOrUndefined(this.owner.editorHistoryModule.currentBaseHistoryInfo)||r||(r=_.isNullOrUndefined(n)?t:0,g=_.isNullOrUndefined(n)?1===i?1:i-t:e.length,this.owner.editorHistoryModule.currentBaseHistoryInfo.recordInsertRevisionDeletetion(e,r,g)),"Insertion"===c.revisionType)if(this.isRevisionMatched(e,void 0))_.isNullOrUndefined(n)?(l=this.removeCharacterInLine(e,t,i),r=e.revisions[0],_.isNullOrUndefined(r)||this.owner.trackChangesPane.updateCurrentTrackChanges(r)):(g=c.range.indexOf(e),c.range.splice(g,1),this.owner.trackChangesPane.updateCurrentTrackChanges(c),0===c.range.length&&this.owner.revisionsInternal.remove(c),this.unLinkFieldCharacter(e),e.line.children.splice(n,1)),e instanceof Bh&&("Footnote"===e.footnoteType?this.removeFootnote(e):this.removeEndnote(e));else if(_.isNullOrUndefined(n)){var u=this.removeCharacterInLine(e,t,i),r=e.revisions[0];if(_.isNullOrUndefined(r)||this.owner.trackChangesPane.updateCurrentTrackChanges(r),0===t){var g=e.previousElement;this.handleDeletionForInsertRevision(g,e,u,i,t,!0)}else if(e.length!==t)for(var m=e.revisions.length-1;0<=m;m--){var f=e.revisions[m],y=f.range.indexOf(e),v=new X,y=(v.characterFormat.copyFormat(e.characterFormat),v.line=e.line,v.text=e.text.substr(t),v.revisions.splice(0,0,f),f.range.splice(y+1,0,v),u.revisions.splice(0,0,f),u.line=e.line,u.isWidthUpdated=!1,f.range.splice(y+1,0,u),this.owner.trackChangesPane.updateCurrentTrackChanges(f),e.text=e.text.substr(0,t),e.isWidthUpdated=!1,e.indexInOwner);e.line.children.splice(y+1,0,v),e.line.children.splice(y+1,0,u),this.addRemovedNodes(u.clone()),this.insertRevision(u,"Deletion"),this.updateLastElementRevision(u)}else e.length===t?(r=e.nextElement,this.handleDeletionForInsertRevision(r,e,u,i,t,!1)):(1===i?a||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)):this.updateCursorForInsertRevision(e,t,i),this.addRemovedNodes(u.clone()),this.insertInlineInternal(u,"Deletion"))}else this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e);else"Deletion"===c.revisionType&&(-1!==p&&c.author!==this.owner.currentUser&&0<c.range.length&&(r=(g=c.range)[0]instanceof B?0:g[0].line.getOffset(g[0],0),(d=g[g.length-1]instanceof B?g[g.length-2]:g[g.length-1]).line.getOffset(d,d.length),d=!1,h=void 0,0===t&&i>=this.selection.getLineLength(e.line)||t+1===i&&e instanceof X&&1===e.length?(g.splice(g.indexOf(e),1),this.owner.trackChangesPane.updateCurrentTrackChanges(c),e.revisions.splice(e.revisions.indexOf(c),1),(h=!_.isNullOrUndefined(e.nextNode)&&0<e.nextNode.revisions.length?this.getMatchedRevisionsToCombine(e.nextNode.revisions,"Deletion"):h)&&0===h.length&&e.previousNode instanceof X&&0<e.previousNode.revisions.length&&this.updateRevisionForSpittedTextElement(e.previousNode,void 0),this.checkToCombineRevisionsInSides(e,"Deletion")?this.combineElementRevision(e.revisions,e.revisions):(this.insertRevision(e,"Deletion"),d=!0,this.updateLastElementRevision(e)),d&&e.line.getOffset(e,0)===r&&-1!==this.owner.revisions.changes.indexOf(c)&&0===c.range.length&&this.owner.revisions.changes.splice(p,1)):1!==i&&(this.handleDeleteBySplitting(e,t,i),0<(e=(g=this.selection.start.currentWidget.getInline(this.selection.start.offset,0).element)?g:e).revisions.length)&&e.nextNode instanceof mh&&0<e.nextNode.revisions.length&&this.combineElementRevision(e.revisions,e.nextNode.revisions)),1===i?(a?this.selection.start.moveNextPosition():this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)):this.isRevisionMatched(e,"Deletion")?this.updateCursorForInsertRevision(e,t,i):(h=c.range.indexOf(e),i<=e.line.getOffset(e,e.length)&&c.range.length>h+1?(this.updateRevisionForSpittedTextElement(e,c.range[h+1]),c.range.splice(c.range.indexOf(e),1),this.toCombineOrInsertRevision(e,"Deletion"),this.owner.trackChangesPane.updateCurrentTrackChanges(c)):1===c.range.length||0===t?(this.handleDeleteBySplitting(e,t,i),0<h&&1!==c.range.length&&(this.updateRevisionForSpittedTextElement(c.range[h-1],c.range[h]),(c=this.retrieveRevisionInOder(e)).range.splice(c.range.indexOf(e),1))):(c.range.splice(c.range.indexOf(e),1),this.toCombineOrInsertRevision(e,"Deletion"))),this.updateLastElementRevision(e))}else _.isNullOrUndefined(n)?this.handleDeleteBySplitting(e,t,i):(this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.skipFootNoteDeleteTracking||this.updateLastElementRevision(e))}else{l=this.removeCharacterInLine(e,t,i);c=e.revisions[0];_.isNullOrUndefined(c)||this.owner.trackChangesPane.updateCurrentTrackChanges(c)}return l},o.prototype.toCombineOrInsertRevision=function(e,t){this.checkToCombineRevisionsInSides(e,t)?this.combineElementRevision(e.revisions,e.revisions):(this.insertRevision(e,t),this.updateLastElementRevision(e))},o.prototype.updateLastElementRevision=function(e){this.skipTableElements||!this.editorHistory||!this.editorHistory.currentBaseHistoryInfo||this.skipReplace||!_.isNullOrUndefined(this.owner.searchModule)&&this.owner.searchModule.isRepalceTracking||(_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.lastElementRevision)&&(this.editorHistory.currentBaseHistoryInfo.lastElementRevision=e),e.isMarkedForRevision=!0)},o.prototype.updateEndRevisionIndex=function(){var e;!_.isNullOrUndefined(this.editorHistory.undoStack)&&0<this.editorHistory.undoStack.length&&(e=this.editorHistory.undoStack[this.editorHistory.undoStack.length-1]).lastElementRevision&&_.isNullOrUndefined(e.endRevisionLogicalIndex)&&e.updateEndRevisionInfo()},o.prototype.retrieveRevisionInOder=function(e){if(1===e.revisions.length)return e.revisions[0];for(var t=0;t<e.revisions.length;t++)if("Deletion"===e.revisions[t].revisionType)return e.revisions[t];return e.revisions[e.revisions.length-1]},o.prototype.handleDeletionForInsertRevision=function(e,t,i,n,r,o){var s;!_.isNullOrUndefined(e)&&0===t.revisions.length&&this.isRevisionMatched(e,"Deletion")?(this.addRemovedNodes(i.clone()),this.insertTextInline(e,this.selection,i.text,0)):(s=(e=t.revisions[t.revisions.length-1]).range.indexOf(t),e.range.splice(o?s:s+1,0,i),this.owner.trackChangesPane.updateCurrentTrackChanges(e),i.revisions.splice(0,0,e),o=!1,this.owner.editorHistoryModule&&(o=!_.isNullOrUndefined(this.owner.editorHistoryModule.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action),1!==n||o?this.updateCursorForInsertRevision(t,r,n):(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)),this.addRemovedNodes(i.clone()),this.insertInlineInternal(i,"Deletion"))},o.prototype.handleDeleteBySplitting=function(e,t,i){var n,r=!1,o=(this.owner.editorHistoryModule&&(r=!_.isNullOrUndefined(this.owner.editorHistoryModule.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action),1===i?0<(o=e.line.getOffset(e,0))?((s=new y(this.owner)).setPositionForLineWidget(e.line,o+t),this.selection.start.setPositionInternal(s),this.selection.end.setPositionInternal(this.selection.start)):r||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)):this.updateCursorForInsertRevision(e,t,i),!1),s=(0<e.revisions.length&&e.length-1===t?!_.isNullOrUndefined(e.nextNode)&&0<e.nextNode.revisions.length&&!_.isNullOrUndefined(e.nextNode)&&0<e.nextNode.revisions.length&&(n=this.getMatchedRevisionsToCombine(e.nextNode.revisions,"Deletion"),_.isNullOrUndefined(n)||0!==n.length||(o=!0)):0<e.revisions.length&&(n=this.getMatchedRevisionsToCombine(e.revisions,"Deletion"),_.isNullOrUndefined(n)||0!==n.length||(o=!0)),this.removeCharacterInLine(e,t,i)),r=e.revisions[0];_.isNullOrUndefined(r)||this.owner.trackChangesPane.updateCurrentTrackChanges(r),0<e.revisions.length&&(s.removedIds=$a.cloneRevisions(e.revisions)),this.addRemovedNodes(s.clone()),""!==s.text||this.owner.enableTrackChanges&&!this.skipTracking()?this.insertTextInternal(s.text,!1,"Deletion",!1,o):this.deleteParagraphMark(e.paragraph,this.selection,0,!0)},o.prototype.updateCursorForInsertRevision=function(e,t,i){var n=e.line.getOffset(e,0),n=(0<n&&(t=n+t,i=n+i),new y(this.owner)),t=(n.setPositionFromLine(e.line,t),new y(this.owner));t.setPositionFromLine(e.line,i),n.isExistBefore(t)?(this.selection.end.setPositionInternal(n),this.selection.start.setPositionInternal(n)):(this.selection.start.setPositionInternal(t),this.selection.end.setPositionInternal(t))},o.prototype.checkToCombineRevisionsInSides=function(e,t){var i,n=e.previousNode,r=e.nextNode,o=!1;return _.isNullOrUndefined(n)||(n instanceof J||(n=n.previousValidNodeForTracking),_.isNullOrUndefined(n))||0<(i=this.getMatchedRevisionsToCombine(n.revisions,t)).length&&(this.mapMatchedRevisions(i,n,e,!1),o=!0),_.isNullOrUndefined(r)||(r instanceof J||(r=r.nextValidNodeForTracking),_.isNullOrUndefined(r))||0<(i=this.getMatchedRevisionsToCombine(r.revisions,t)).length&&(o?this.combineElementRevision(e.revisions,r.revisions):this.mapMatchedRevisions(i,r,e,!0),o=!0),o},o.prototype.delete=function(){this.removeEditRange=!0;var e=this.documentHelper.selection;if(0<e.bookmarks.length&&this.extendSelectionToBookmarkStart(),e.isEmpty)this.singleDelete(e,!1);else{var t=this.checkAndRemoveComments(),i=(this.initHistory("Delete"),void 0),i=e.isForward?e.end:e.start,i=this.selection.getParagraphInfo(i),n=(this.deleteSelectedContentInternal(e,!1,e.start,e.end),new y(e.owner)),r=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString());if(!this.owner.enableTrackChanges||this.skipTracking()||this.isInsertingTOC||-1===i.paragraph.indexInOwner||(e.editPosition=r),this.setPositionForCurrentIndex(n,e.editPosition),e.selectContent(n,!0),this.reLayout(e),this.insertSpaceInFormField(),this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&"RemoveComment"===this.editorHistory.currentHistoryInfo.action){for(var o=0;o<t.length;o++)this.initInsertInline(t[o],!1);this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory()}}this.removeEditRange=!1,this.documentHelper.layout.islayoutFootnote=!1,this.updateXmlMappedContentControl()},o.prototype.deleteEditElement=function(e){this.initHistory("Delete"),this.deleteSelectedContentInternal(e,!1,e.start,e.end);var t=new y(e.owner);this.setPositionForCurrentIndex(t,e.editPosition),e.selectContent(t,!0),this.reLayout(e)},o.prototype.removeContentControlMark=function(e,t){return!e.contentControlProperties.lockContentControl&&(this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,0)),this.selection.end.setPositionParagraph(t.line,t.line.getOffset(t,0)+1),this.deleteEditElement(this.selection),!0)},o.prototype.singleDelete=function(e,t){var i=e.start.currentWidget,n=e.start.paragraph,r=e.start.offset,o=0,i=i.getInline(e.start.offset,o),s=i.element;if(this.selection.isInlineFormFillMode()){if(s instanceof Z&&1===s.fieldType)return;var a=this.getFieldResultText();if(s instanceof X||(s=s.nextElement),1===a.length&&s instanceof X)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField());if(s instanceof Z&&1===s.fieldType)return}if(o=i.index,n.paragraphFormat.listFormat&&-1!==n.paragraphFormat.listFormat.listId&&this.documentHelper.isListTextSelected&&"List"===e.contextType)this.onApplyList(void 0);else{if(!_.isNullOrUndefined(s)&&o===s.length&&!_.isNullOrUndefined(s.nextNode)){if((s=s.nextNode)instanceof Z&&1===s.fieldType&&!_.isNullOrUndefined(s.fieldBegin.formFieldData))return;if(s instanceof Bh)return;o=0}for(var a=s instanceof up;s instanceof up;){if(!s.nextNode){o=1;break}s=s.nextNode,o=0}if(a&&(n=s.line.paragraph,r=s.line.getOffset(s,o),e.start.setPositionParagraph(s.line,r),e.end.setPositionParagraph(s.line,r)),!this.owner.enableTrackChanges&&s instanceof Bh&&("Footnote"===s.footnoteType?this.removeFootnote(s):this.removeEndnote(s)),!_.isNullOrUndefined(s)){var a=void 0,l=e.getNextValidElement(s);if(l instanceof mh&&(a=l),!_.isNullOrUndefined(a)&&a instanceof Z&&0===a.fieldType)return n=(s=a.fieldEnd).line.paragraph,r=s.line.getOffset(s,1),e.end.setPositionParagraph(s.line,r),s.nextNode instanceof J&&(l=s.nextNode,e.end.setPositionParagraph(l.line,l.line.getOffset(l,1))),void e.fireSelectionChanged(!0);s!==a&&(n=(s=a).line.paragraph,r=s.line.getOffset(s,0),s instanceof Z)&&1===s.fieldType&&r++}if(s instanceof Wc||s instanceof Sc){if(s.nextNode instanceof Sc&&s.editRangeEnd===s.nextNode||s.previousNode instanceof Wc&&s.editRangeStart===s.previousNode)return;if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType){if(s instanceof Wc||s instanceof Sc)return}else s instanceof Wc?(r=(s=s.nextNode).line.getOffset(s,0),n=s.line.paragraph):s instanceof Sc&&r++;if(1===s.length&&s.nextNode instanceof Sc&&s.previousNode instanceof Wc)return l=s.previousNode,a=s.nextNode,e.start.setPositionParagraph(l.line,l.line.getOffset(l,0)),e.end.setPositionParagraph(a.line,a.line.getOffset(a,0)+1),void this.deleteEditElement(e)}if(s&&(s instanceof E||s.nextNode instanceof E)){if(s instanceof E&&s.nextNode)return n=(s=s.nextNode).line.paragraph,r=s.line.getOffset(s,0),e.start.setPositionParagraph(s.line,r),void e.end.setPositionParagraph(s.line,r);if(s&&1===s.length&&s.nextNode instanceof E&&s.previousNode instanceof E&&this.removeContentControlMark(s.previousNode,s.nextNode))return;if(s instanceof E&&s.previousNode instanceof E&&s.previousNode.reference===s&&this.removeContentControlMark(s.previousNode,s))return}if(s&&(s instanceof J&&0===s.bookmarkType||s.nextNode instanceof J)){if(s.nextNode&&s instanceof J&&(n=(s=s.nextNode).line.paragraph,r=s.line.getOffset(s,0),e.start.setPositionParagraph(s.line,r),e.end.setPositionParagraph(s.line,r)),1===s.length&&s.nextNode instanceof J&&s.previousNode instanceof J)return l=s.previousNode,a=s.nextNode,e.start.setPositionParagraph(l.line,l.line.getOffset(l,0)),e.end.setPositionParagraph(a.line,a.line.getOffset(a,0)+1),void this.deleteEditElement(e);s instanceof J&&(r=s.line.getOffset(s,1))}if(e.start.currentWidget.isLastLine()&&r===this.documentHelper.selection.getLineLength(e.start.currentWidget)){if(n.isInsideTable&&_.isNullOrUndefined(n.nextWidget))return;l=void 0,a=e.getNextParagraphBlock(n);if(_.isNullOrUndefined(a)){if(0<r)return;if(n.previousWidget instanceof G&&(l=n.previousWidget),n.previousWidget instanceof q)return;if(n.previousWidget instanceof K)return;if(_.isNullOrUndefined(l)||n.isEmpty()&&0<l.characterFormat.revisions.length)return}t||this.initHistory("Delete"),(n.isEndsWithPageBreak||n.isEndsWithColumnBreak)&&(d=(r=n.lastChild).children[r.children.length-1],this.selection.start.setPositionForSelection(r,d,0,this.selection.start.location));var d,h,r=this.selection.getParagraphInfo(e.start);e.editPosition=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),this.checkInsertPosition(e)&&this.setPositionForHistory(e.editPosition),e.owner.isShiftingEnabled=!0,n.isEmpty()?(this.removePrevParaMarkRevision(n,!0),d=e.getNextParagraphBlock(n),!_.isNullOrUndefined(d)&&d instanceof G&&d.bodyWidget.index!==n.bodyWidget.index&&(this.deleteSection(e,n.bodyWidget,d.bodyWidget,0),this.editorHistory.currentBaseHistoryInfo.type="SectionBreak"),this.removeBlock(n,!1,!0),this.addRemovedNodes(n),_.isNullOrUndefined(a)?_.isNullOrUndefined(l)?(r=e.getParagraphLength(void 0)+1,this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(void 0,r.toString()))):(e.selectParagraphInternal(l,!1),this.setPositionForHistory()):e.selectParagraphInternal(a,!0)):this.owner.enableTrackChanges&&n.nextRenderedWidget instanceof G?(r=(d=n.nextRenderedWidget).childWidgets.length-1,n=n.combineWidget(this.owner.viewer),h=this.splitParagraph(n,n.firstChild,0,e.start.currentWidget,e.start.offset,!0),null!=n&&0!=n.characterFormat.revisions.length&&"Insertion"==n.characterFormat.revisions[0].revisionType?(this.removePrevParaMarkRevision(n,!0),this.deleteParagraphMark(h,e,0),this.addRemovedNodes(n),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0)):(this.removePrevParaMarkRevision(n,!0),this.deleteParagraphMark(h,e,0,!0),this.addRemovedNodes(n),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selects(d.childWidgets[r],0,!0))):(n=n.combineWidget(this.owner.viewer),h=this.splitParagraph(n,n.firstChild,0,e.start.currentWidget,e.start.offset,!0),this.removePrevParaMarkRevision(n,!0),this.deleteParagraphMark(h,e,0),this.addRemovedNodes(n),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0)),this.reLayout(e)}else{l=i.element;if(l instanceof E){a=this.getContentControl();if(this.selection.selectContentControlInternal(a),!_.isNullOrUndefined(a)&&1===l.type&&a.contentControlProperties.lockContentControl&&_.isNullOrUndefined(l.nextElement)){if(!this.selection.isEmpty)return;this.delete()}if(!_.isNullOrUndefined(a)&&0===l.type&&l.nextElement!==a.reference||!_.isNullOrUndefined(a)&&0===l.type&&a.contentControlProperties.lockContentControl&&l.nextElement===a.reference)return}else this.singleDeleteInternal(e,t,n)}e.start.currentWidget.getInline(e.start.offset+1,0).element instanceof J&&(e.start.offset++,e.end.offset++)}},o.prototype.singleDeleteInternal=function(e,t,i){t||(e.owner.isShiftingEnabled=!0,this.initHistory("Delete")),this.checkInsertPosition(e)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition);var n=this.selection.getParagraphInfo(e.start),r=e.start.currentWidget,o=e.start.offset,s=e.getLineLength(e.start.currentWidget);s<=o&&(r=r.nextLine,o-=s),this.removeAtOffset(r,e,o),(!this.owner.enableTrackChanges||_.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Delete"!==this.editorHistory.currentBaseHistoryInfo.action||s===e.getLineLength(e.start.currentWidget))&&this.owner.enableTrackChanges&&!this.skipTracking()?this.setPositionParagraph(n.paragraph,n.offset+1,!1):this.setPositionParagraph(n.paragraph,n.offset,!1),t?this.fireContentChange():this.reLayout(e)},o.prototype.deleteParagraphMark=function(e,t,i,n,r,o){if(!_.isNullOrUndefined(e.containerWidget)){e=e.combineWidget(this.owner.viewer);var s=t.getNextParagraphBlock(e);if(!(e.isInsideTable&&_.isNullOrUndefined(e.nextWidget)||_.isNullOrUndefined(s))){e.containerWidget instanceof z&&e.containerWidget;var a=void 0,a=t.getNextRenderedBlock(e)instanceof K?t.getNextRenderedBlock(e):void 0;if(s.isInsideTable&&!_.isNullOrUndefined(a)&&a.contains(s.associatedCell)){if(i<4){var l=0;this.removeBlock(e),this.documentHelper.layout.clearListElementBox(s),this.documentHelper.layout.clearListElementBox(e);for(var d=e.childWidgets.length-1;0<=d;d--)for(var h=e.childWidgets[d],c=h.children.length-1;0<=c;c--){var p=h.children[c];l+=p.length,s.firstChild.children.unshift(p),p.line=s.firstChild}this.documentHelper.layout.reLayoutParagraph(s,0,0),0<l&&(t.editPosition=this.selection.getHierarchicalIndex(s,l.toString()))}}else if(i<4){e.childWidgets.length;a=s.getSplitWidgets(),s=s.combineWidget(this.owner.viewer);if(this.documentHelper.layout.clearListElementBox(s),this.documentHelper.layout.clearListElementBox(e),this.updateEditPositionOnMerge(e,s),!(!_.isNullOrUndefined(n)&&n)||this.handleDeleteParaMark(e,a[0])){for(var n=e.childWidgets.length-1,d=(e.childWidgets[n].children.length,0);d<s.childWidgets.length;d++){var u=s.childWidgets[d];if(0<s.characterFormat.revisions.length)for(var g,m=0;m<s.characterFormat.revisions.length;m++)-1!==s.characterFormat.revisions[m].range.indexOf(s.characterFormat)&&(g=s.characterFormat.revisions[m].range.indexOf(s.characterFormat),s.characterFormat.revisions[m].range.splice(g,1),s.characterFormat.revisions[m].range.splice(g,0,e.characterFormat)),e.characterFormat.revisions.push(s.characterFormat.revisions[m]);s.childWidgets.splice(d,1),e.childWidgets.push(u),u.paragraph=e,d--}for(d=0;d<s.floatingElements.length;d++){var f=s.floatingElements[d];s.floatingElements.splice(d,1),e.floatingElements.push(f),d--}s.bodyWidget.index!==e.bodyWidget.index&&(this.deleteSection(t,e.bodyWidget,s.bodyWidget,i),this.editorHistory.currentBaseHistoryInfo.type="SectionBreak"),0===s.childWidgets.length&&s.childWidgets.push(new uh(s)),this.documentHelper.layout.reLayoutParagraph(e,0,0),this.removeBlock(s),!this.editorHistory||"Insert"===this.editorHistory.currentBaseHistoryInfo.action||o||this.addRemovedNodes(s,r)}}}}},o.prototype.handleDeleteParaMark=function(e,t){if(!this.owner.enableTrackChanges&&0<e.characterFormat.revisions.length)for(var i=0;i<e.characterFormat.revisions.length;i++){var n=e.characterFormat.revisions[i],r=n.range.indexOf(e.characterFormat);return n.range.splice(r,1),this.owner.trackChangesPane.updateCurrentTrackChanges(n),0===n.range.length&&this.owner.revisions.remove(n),!0}var o,s,a;return!this.owner.enableTrackChanges||(o=!1,0<e.characterFormat.revisions.length&&(s=this.retrieveRevisionByType(e.characterFormat,"Deletion"),!_.isNullOrUndefined(s)&&this.isRevisionMatched(s,"Deletion")&&(a=e.characterFormat.revisions.indexOf(s),e.characterFormat.revisions.splice(a,1),s.range.splice(s.range.indexOf(e.characterFormat),1),this.owner.trackChangesPane.updateCurrentTrackChanges(s),0===s.range.length&&this.owner.revisions.remove(s),t=e.nextRenderedWidget instanceof G?e.nextRenderedWidget:void 0,this.applyRevisionForParaMark(e,t?t.firstChild:void 0,"Deletion",!1),o=!1),a=this.retrieveRevisionByType(e.characterFormat,"Insertion"),!_.isNullOrUndefined(a)&&this.isRevisionMatched(e.characterFormat,"Insertion")&&(r=a.range.indexOf(e.characterFormat),a.range.splice(r,1),this.owner.trackChangesPane.updateCurrentTrackChanges(a),0===a.range.length&&this.owner.revisions.remove(a),o=!0),!!o))||(this.applyRevisionForParaMark(e,t?t.firstChild:void 0,"Deletion",!1),!1)},o.prototype.insertDeleteParaMarkRevision=function(e,t){var i,n=e.lastChild,n=0<n.children.length?n.children[n.children.length-1].previousValidNodeForTracking:void 0;_.isNullOrUndefined(n)||0<(i=this.getMatchedRevisionsToCombine(n.revisions,"Deletion")).length&&this.mapMatchedRevisions(i,n,e.characterFormat,!1);t.firstChild.children[0].nextValidNodeForTracking},o.prototype.retrieveRevisionByType=function(e,t){for(var i=0;i<e.revisions.length;i++)if(e.revisions[i].revisionType===t)return e.revisions[i]},o.prototype.combineRevisionOnDeleteParaMark=function(e,t,i){t=(e=e.childWidgets[t].children[i]).nextNode.nextValidNodeForTracking,e=e.nextValidNodeForTracking;0<t.revisions.length&&0<e.revisions.length&&this.combineElementRevisions(e,t)},o.prototype.updateEditPositionOnMerge=function(e,t){this.documentHelper.selection.editPosition===this.selection.getHierarchicalIndex(t,"0")&&void 0===t.nextRenderedWidget&&(this.documentHelper.selection.editPosition=this.selection.getHierarchicalIndex(e,this.documentHelper.selection.getLineLength(e.lastChild).toString()))},o.prototype.checkEndPosition=function(e){return this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.endPosition)},o.prototype.checkInsertPosition=function(e){return this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)},o.prototype.checkIsNotRedoing=function(){return this.documentHelper.owner.enableHistoryMode&&!this.editorHistory.isRedoing},o.prototype.deleteSelectedContentInternal=function(e,t,i,n,r){var o=i,s=n,n=(i.isExistBefore(n)||(o=n,s=i),this.selection.getParagraphInfo(o)),i=(e.editPosition=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),!1);return t&&o.isInSameParagraph(s)&&(o.offset<s.offset&&o.offset===e.getParagraphLength(s.paragraph)&&(i=e.getNextRenderedBlock(o.paragraph)instanceof K,_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||"Accept All"!==this.editorHistory.currentBaseHistoryInfo.action&&"Accept Change"!==this.editorHistory.currentBaseHistoryInfo.action&&"Reject All"!==this.editorHistory.currentBaseHistoryInfo.action&&"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action&&!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||(i=!1)),!(1===s.offset&&s.offset>e.getParagraphLength(s.paragraph))||s.paragraph.isInsideTable&&_.isNullOrUndefined(s.paragraph.nextWidget)||(t=!1)),i||(e.owner.isShiftingEnabled=!0,this.checkInsertPosition(e)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.editPosition),this.deleteSelectedContent(s.paragraph,e,o,s,t?1:0,r)),i},o.prototype.initHistory=function(e){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initializeHistory(e)},o.prototype.initComplexHistory=function(e){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initComplexHistory(this.documentHelper.selection,e)},o.prototype.insertPicture=function(e,t,i,n,r){var o=this,s=new Ic(!0);s.width=t,s.height=i,_.isNullOrUndefined(n)&&""==n||(s.alternateText=n),s.textWrappingStyle="Inline",".svg"===j.formatClippedString(e).extension?(s.metaFileImageString=e,s.isMetaFile=!0,this.generateFallBackImage(e,t,i,s,r),this.owner.enableCollaborativeEditing||(this.documentHelper.addBase64StringInCollection(s),s.element.src=this.documentHelper.getImageString(s),this.insertPictureInternal(s,r))):_.isNullOrUndefined(this.documentHelper)||(s.imageString=e,s.element.crossOrigin="Anonymous",this.documentHelper.addBase64StringInCollection(s),n=this.documentHelper.getImageString(s),_.isNullOrUndefined(n)||!j.startsWith(n,"http://")&&!j.startsWith(n,"https://")||(0<new URL(n).search.length?n+="&t="+(new Date).getTime():n+="?t="+(new Date).getTime(),this.viewer.documentHelper.getBase64(e,t,i).then(function(e){_.isNullOrUndefined(o.viewer)||_.isNullOrUndefined(o.viewer.documentHelper)||(o.viewer.documentHelper.images.get(parseInt(s.imageString))[1]=e)})),s.element.src=n,this.insertPictureInternal(s,r))},o.prototype.generateFallBackImage=function(e,n,r,o,s){var a=this,l=new Image;l.onload=function(){a.isImageInsert&&a.owner.enableCollaborativeEditing&&(a.isRemoteAction=!0);var e=Math.max(1,window.devicePixelRatio||1),t=document.createElement("canvas"),i=(t.width=n*e,t.height=r*e,t.getContext("2d"));i.scale(e,e),i.drawImage(l,0,0,n,r),o.imageString=t.toDataURL("image/png",1),a.owner.enableCollaborativeEditing&&(a.documentHelper.addBase64StringInCollection(o),o.element.src=a.documentHelper.getImageString(o),a.insertPictureInternal(o,s,a.isRemoteAction),a.isImageInsert=!1,a.isRemoteAction=!1)},l.src=e,this.isRemoteAction&&this.insertInlineInSelection(this.selection,o)},o.prototype.insertPictureInternal=function(e,t,i){var n,r=this.documentHelper.selection,o=this.checkAndRemoveComments();this.initHistory("InsertInline"),t&&this.fitImageToPage(r,e),this.owner.enableCollaborativeEditing&&(n=t=void 0,e.isMetaFile?(t=this.documentHelper.images.get(parseInt(e.imageString))[1].toString(),n=this.documentHelper.images.get(parseInt(e.metaFileImageString))[0].toString()):t=this.documentHelper.images.get(parseInt(e.imageString)).toString(),t={imageString:t,height:j.convertPixelToPoint(e.height),width:j.convertPixelToPoint(e.width),metaString:n,alternativeText:e.alternateText},this.editorHistory.currentBaseHistoryInfo.insertedData=t,this.editorHistory.currentBaseHistoryInfo.insertedText=L.Image),i||this.insertInlineInSelection(r,e),this.reLayout(r),this.updateHistoryForComments(o)},o.prototype.fitImageToPage=function(e,t){var i,e=e.start.paragraph.bodyWidget,n=e.sectionFormat.pageHeight-e.sectionFormat.topMargin-e.sectionFormat.topMargin,r=0;r=e instanceof z&&1<e.sectionFormat.columns.length?(i=e.columnIndex,e.sectionFormat.columns[i].width):j.convertPointToPixel(e.sectionFormat.pageWidth-e.sectionFormat.leftMargin-e.sectionFormat.rightMargin),t.width>r&&(t.height=t.height*r/t.width,t.width=r),t.height>n&&(t.width=t.width*n/t.height,t.height=n)},o.prototype.insertInlineInSelection=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),!_.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&this.owner.enableCollaborativeEditing&&((this.editorHistory.currentBaseHistoryInfo.insertedElement=t)instanceof up?this.editorHistory.currentBaseHistoryInfo.insertedText=0==t.commentType?L.Marker_Start:L.Marker_End:t instanceof Bh?(this.editorHistory.currentBaseHistoryInfo.insertedText=L.Marker_Start,this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(t))):(t instanceof J||t instanceof Wc||t instanceof Sc||t instanceof Z||t instanceof X&&0==t.removedIds.length)&&(this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(t,this.editorHistory.isUndoing)),t instanceof Z)&&0===t.fieldType&&(this.editorHistory.currentBaseHistoryInfo.fieldBegin=t)),this.updateInsertPosition(),this.insertInlineInternal(t),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},o.prototype.onPortrait=function(){var e=new Ma,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;i<t&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},o.prototype.onLandscape=function(){var e=new Ma,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t<i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},o.prototype.copyValues=function(){var e=new Ma;return e.bottomMargin=this.documentHelper.selection.sectionFormat.bottomMargin,e.topMargin=this.documentHelper.selection.sectionFormat.topMargin,e.leftMargin=this.documentHelper.selection.sectionFormat.leftMargin,e.rightMargin=this.documentHelper.selection.sectionFormat.rightMargin,e.pageHeight=this.documentHelper.selection.sectionFormat.pageHeight,e.pageWidth=this.documentHelper.selection.sectionFormat.pageWidth,e.footerDistance=this.documentHelper.selection.sectionFormat.footerDistance,e.headerDistance=this.documentHelper.selection.sectionFormat.headerDistance,e},o.prototype.changeMarginValue=function(e){var t=this.copyValues();"lastCustomSetting"===e||"normal"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=72,t.rightMargin=72):"narrow"===e?(t.topMargin=36,t.bottomMargin=36,t.leftMargin=36,t.rightMargin=36):"moderate"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=54,t.rightMargin=54):"wide"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=144,t.rightMargin=144):"mirrored"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=72):"office2003Default"===e&&(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=90),this.onApplySectionFormat(void 0,t)},o.prototype.onPaperSize=function(e){var t=this.copyValues(),i=this.documentHelper.selection.sectionFormat.pageWidth,n=this.documentHelper.selection.sectionFormat.pageHeight;"letter"===e?i<n?(t.pageWidth=612,t.pageHeight=792):(t.pageWidth=792,t.pageHeight=612):"tabloid"===e?i<n?(t.pageWidth=792,t.pageHeight=1224):(t.pageWidth=1224,t.pageHeight=792):"legal"===e?i<n?(t.pageWidth=612,t.pageHeight=1008):(t.pageWidth=1008,t.pageHeight=612):"statement"===e?i<n?(t.pageWidth=396,t.pageHeight=612):(t.pageWidth=612,t.pageHeight=396):"executive"===e?i<n?(t.pageWidth=522,t.pageHeight=756):(t.pageWidth=756,t.pageHeight=522):"a3"===e?i<n?(t.pageWidth=841.9,t.pageHeight=1190.55):(t.pageWidth=1190.55,t.pageHeight=841.9):"a4"===e?i<n?(t.pageWidth=595.3,t.pageHeight=841.9):(t.pageWidth=841.9,t.pageHeight=595.3):"a5"===e?i<n?(t.pageWidth=419.55,t.pageHeight=595.3):(t.pageWidth=595.3,t.pageHeight=419.55):"b4"===e?i<n?(t.pageWidth=728.5,t.pageHeight=1031.8):(t.pageWidth=1031.8,t.pageHeight=728.5):"b5"===e&&(i<n?(t.pageWidth=515.9,t.pageHeight=728.5):(t.pageWidth=728.5,t.pageHeight=515.9)),this.onApplySectionFormat(void 0,t)},o.prototype.updateListItemsTillEnd=function(e,t){for(var i=t?this.documentHelper.selection.getNextRenderedBlock(e):e;!_.isNullOrUndefined(i)&&!this.documentHelper.isTextInput;)this.updateRenderedListItems(i),i=i.getSplitWidgets().pop().nextRenderedWidget},o.prototype.updateWholeListItems=function(e,t,i){this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[];e.bodyWidget.index;for(var n,r=0;r<this.documentHelper.pages.length;r++){for(var o=this.documentHelper.pages[r],s=0;s<o.bodyWidgets.length&&(n=this.getNextBlockForList(o.bodyWidgets[s].firstChild),_.isNullOrUndefined(n));s++);if(!_.isNullOrUndefined(n))break}do{if(!n)break;var a=t?{paragraph:null,listId:i}:null;if(this.updateListItems(n,e,a)){if(_.isNullOrUndefined(a))break;return a.paragraph==e?null:a.paragraph}}while(n=n.getSplitWidgets().pop().nextRenderedWidget,n=_.isNullOrUndefined(n)?n:this.getNextBlockForList(n));return null},o.prototype.getNextBlockForList=function(e){if(e instanceof G&&this.documentHelper.layout.isFirstElementWithPageBreak(e)){var t=e.nextRenderedWidget;if(!_.isNullOrUndefined(t)&&t.equals(e))return t}return e},o.prototype.updateListItems=function(e,t,i){return e instanceof G?this.updateListItemsForPara(e,t,i):this.updateListItemsForTable(e,t,i)},o.prototype.updateListItemsForTable=function(e,t,i){if(_.isNullOrUndefined(i)&&t instanceof K&&e.equals(t))return!0;var n=e.firstChild;do{if(this.updateListItemsForRow(n,t,i))return!0}while(n=n.getSplitWidgets().pop().nextRenderedWidget);return!1},o.prototype.updateListItemsForRow=function(e,t,i){if(_.isNullOrUndefined(i)&&t.isInsideTable&&-1!==e.childWidgets.indexOf(this.documentHelper.selection.getContainerCell(t.associatedCell)))return!0;var n=e.firstChild;do{if(this.updateListItemsForCell(n,t,i),!_.isNullOrUndefined(i)&&!_.isNullOrUndefined(i.paragraph))return!0}while(n=n.nextRenderedWidget);return!1},o.prototype.updateListItemsForCell=function(e,t,i){if(0!==e.childWidgets.length)for(var n=e.firstChild;this.updateListItems(n,t,i),(_.isNullOrUndefined(i)||_.isNullOrUndefined(i.paragraph))&&(n=n.getSplitWidgets().pop().nextRenderedWidget););},o.prototype.updateRenderedListItems=function(e){e instanceof G?(e.isEndsWithColumnBreak&&(e=e.nextRenderedWidget),this.updateRenderedListItemsForPara(e)):this.updateRenderedListItemsForTable(e)},o.prototype.updateRenderedListItemsForTable=function(e){for(var t=e.firstChild;this.updateRenderedListItemsForRow(t),t=t.getSplitWidgets().pop().nextRenderedWidget;);},o.prototype.updateRenderedListItemsForRow=function(e){for(var t=e.firstChild;this.updateRenderedListItemsForCell(t),t=t.nextRenderedWidget;);},o.prototype.updateRenderedListItemsForCell=function(e){if(0!==e.childWidgets.length)for(var t=e.firstChild;this.updateRenderedListItems(t),t=t.getSplitWidgets().pop().nextRenderedWidget;);},o.prototype.updateListItemsForPara=function(e,t,i){if(e.equals(t))return _.isNullOrUndefined(i)||(i.paragraph=e),!0;var t=void 0,n=0;if(!_.isNullOrUndefined(e.paragraphFormat)&&!_.isNullOrUndefined(e.paragraphFormat.listFormat)){if(!_.isNullOrUndefined(i)&&e.paragraphFormat.listFormat.listId===i.listId)return i.paragraph=e,!0;t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),n=e.paragraphFormat.listFormat.listLevelNumber}return _.isNullOrUndefined(t)||_.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId))||_.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId).levels[n])||(i=this.documentHelper.layout.getListLevel(t,n),this.updateListNumber(i,e,!1)),!1},o.prototype.updateRenderedListItemsForPara=function(e){var t,i;_.isNullOrUndefined(this.documentHelper.getListById(e.paragraphFormat.listFormat.listId))||(i=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),t=e.paragraphFormat.listFormat.listLevelNumber,_.isNullOrUndefined(i))||_.isNullOrUndefined(this.documentHelper.getAbstractListById(i.abstractListId))||_.isNullOrUndefined(this.documentHelper.getAbstractListById(i.abstractListId).levels[e.paragraphFormat.listFormat.listLevelNumber])||(i=this.documentHelper.layout.getListLevel(i,t),this.updateListNumber(i,e,!0))},o.prototype.updateListNumber=function(e,t,i){var n,r,o=void 0;0<t.childWidgets.length&&0<(r=t.childWidgets[0]).children.length&&(o=r.children[0]),!_.isNullOrUndefined(o)&&o.nextElement instanceof Y&&(n=o.width+o.nextElement.width),!_.isNullOrUndefined(o)&&o instanceof Y&&(r=this.documentHelper.layout.getListNumber(t.paragraphFormat.listFormat),i)&&(i=o.width,o.text=r,this.documentHelper.isIosDevice&&(r=(r=o.text)===String.fromCharCode(61623)?String.fromCharCode(9679):r===String.fromCharCode(61551)+String.fromCharCode(32)?String.fromCharCode(9675):r)!==o.text&&(o.text=r),i<(r=this.documentHelper.textHelper.getTextSize(o,o.characterFormat))&&(o.width=r),this.documentHelper.textHelper.updateTextSize(o,t),!_.isNullOrUndefined(n))&&o.width<n&&(o.nextElement.width=n-o.width)},o.prototype.getOffsetValue=function(e){var t;this.startParagraph&&(t=e.getLineInfoBasedOnParagraph(this.startParagraph,this.startOffset),e.start.setPositionFromLine(t.line,t.offset)),e.start.updatePhysicalPosition(!0),e.isEmpty?e.end.setPositionInternal(e.start):(this.endParagraph&&(t=e.getLineInfoBasedOnParagraph(this.endParagraph,this.endOffset),e.end.setPositionFromLine(t.line,t.offset)),e.end.updatePhysicalPosition(!0))},o.prototype.setPositionParagraph=function(e,t,i){var n=this.documentHelper.selection,e=n.getLineInfoBasedOnParagraph(e,t);n.start.setPositionFromLine(e.line,e.offset),n.end.setPositionInternal(n.start),i||n.fireSelectionChanged(!0)},o.prototype.setPositionForCurrentIndex=function(e,t){t=this.selection.getParagraph({index:t}),t=this.selection.getLineInfoBasedOnParagraph(t.paragraph,t.offset);e.setPositionForLineWidget(t.line,t.offset)},o.prototype.insertPageNumber=function(e){e=_.isNullOrUndefined(e)?"":" \\*"+e,this.createFields("PAGE "+e+" \\* MERGEFORMAT")},o.prototype.insertPageCount=function(e){e=_.isNullOrUndefined(e)?"":" *"+e,this.createFields("NUMPAGES "+e+" * MERGEFORMAT")},o.prototype.createFields=function(e){var t=new G,i=new uh(t),n=new Z(0),r=(i.children.push(n),new Vh),o=(r.fieldBegin=n,r.text="1",new X),e=(o.text=e,i.children.push(o),new Z(2)),o=((e.fieldBegin=n).fieldSeparator=e,i.children.push(e),i.children.push(r),new Z(1)),r=(o.fieldBegin=n,(o.fieldSeparator=e).fieldEnd=o,n.fieldEnd=o,i.children.push(o),n.line=i,t.childWidgets.push(i),this.documentHelper.fields.push(n),new z);r.sectionFormat=new Ma(r),r.childWidgets.push(t),this.pasteContentsInternal([r],!1)},o.prototype.insertBookmark=function(e){if(!this.selection.isPlainContentControl()){var t=!1;if(this.documentHelper.bookmarks.containsKey(e)){var i=this.documentHelper.bookmarks.get(e),t=!0;if(this.initComplexHistory("InsertBookmark"),this.documentHelper.owner.editorModule.isRemoteAction=!0,this.deleteBookmark(e),this.documentHelper.owner.editorModule.isRemoteAction=!1,_.isNullOrUndefined(i.reference)||_.isNullOrUndefined(i.reference.paragraph.associatedCell))_.isNullOrUndefined(i.properties)||(n=parseInt(i.properties.columnFirst),o=(r=i.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(r.rowIndex,n),!_.isNullOrUndefined(o)&&o.isRenderBookmarkStart&&(o.isRenderBookmarkStart=!1));else if((r=i.reference.paragraph.associatedCell.ownerRow).isRenderBookmarkEnd&&(r.isRenderBookmarkEnd=!1),!_.isNullOrUndefined(i.properties)){for(var n=parseInt(i.properties.columnFirst),r=i.paragraph.associatedCell.ownerRow,o=r.getCellUsingColumnIndex(r.rowIndex,n),r=(_.isNullOrUndefined(o)||(o.isRenderBookmarkStart=!1),parseInt(i.properties.columnLast)),s=i.reference.paragraph.associatedCell.ownerRow,a=void 0,l=r;_.isNullOrUndefined(a)&&-1<l;)a=s.getCell(s.rowIndex,l),_.isNullOrUndefined(a)&&l--;a.isRenderBookmarkEnd&&(a.isRenderBookmarkEnd=!1)}}var n=this.createBookmarkElements(e),o=n[0],i=n[1];o.properties=this.selection.getBookmarkProperties(o),i.properties=this.selection.getBookmarkProperties(i),this.owner.isShiftingEnabled=!0,t||this.initComplexHistory("InsertBookmark"),this.insertElements([i],[o],!0),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal(),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),this.documentHelper.bookmarks.add(e,o),_.isNullOrUndefined(o.properties)?(this.selection.start.setPositionForSelection(o.line,o,1,this.selection.start.location),r=0,_.isNullOrUndefined(i.properties)||i.properties.isAfterParagraphMark&&(r=2),this.selection.end.setPositionForSelection(i.line,i,r,this.selection.end.location),n=this.documentHelper.blockToShift,!_.isNullOrUndefined(n)&&this.viewer instanceof Sd&&1<n.bodyWidget.sectionFormat.columns.length&&(t=this.documentHelper.layout.getBodyWidget(n.bodyWidget,!1),_.isNullOrUndefined(t.nextRenderedWidget)||"NoBreak"!==t.nextRenderedWidget.sectionFormat.breakCode||t.page!==t.nextRenderedWidget.page||this.reLayout(this.selection)),this.owner.isShiftingEnabled=!1,this.selection.fireSelectionChanged(!0)):(this.selection.selectBookmarkInTable(o),this.documentHelper.owner.isShiftingEnabled=!1),1==this.owner.documentEditorSettings.showBookmarks&&this.viewer.updateScrollBars(),this.fireContentChange()}},o.prototype.createBookmarkElements=function(e){var t=new J(0),i=(t.name=e,new J(1));return i.name=e,[(t.reference=i).reference=t,i]},o.prototype.deleteBookmark=function(e){var t,i,n,r,o,s,a,l=this.documentHelper.bookmarks.get(e);l instanceof J&&(t=l.reference,i=this.selection.start.clone(),n=this.selection.end.clone(),o=!1,s=void 0,(r=this.selection.getElementInfo(i.currentWidget,i.offset)).element===l&&(o=!0,s=this.selection.getElementInfo(i.currentWidget,i.offset+1)),a=this.selection.getElementInfo(n.currentWidget,n.offset),this.selection.start.setPositionParagraph(l.line,l.line.getOffset(l,l.length)),this.selection.end.setPositionParagraph(t.line,t.line.getOffset(t,t.length)-1),this.initHistory("DeleteBookmark"),this.selection.selectPosition(i,n),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertedText=L.Marker_Start,this.editorHistory.currentBaseHistoryInfo.markerData.push({bookmarkName:e}),this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(l)),this.deleteBookmarkInternal(l),this.editorHistory&&this.editorHistory.updateHistory(),o&&!_.isNullOrUndefined(s)&&this.selection.start.setPositionParagraph(s.element.line,s.element.line.getOffset(s.element,r.index)-1),a.element!==l)&&a.element!==t&&this.selection.end.setPositionParagraph(a.element.line,a.element.line.getOffset(a.element,a.index)),this.fireContentChange(),1==this.owner.documentEditorSettings.showBookmarks&&this.viewer.updateScrollBars()},o.prototype.deleteBookmarkInternal=function(e){var t=e.previousNode;if(t instanceof Z&&0===t.fieldType&&!_.isNullOrUndefined(t.formFieldData)&&(t.formFieldData.name=""),_.isNullOrUndefined(e.properties))!this.documentHelper.selection.isRenderBookmarkAtEnd(e)||_.isNullOrUndefined(e.reference)||_.isNullOrUndefined(e.reference.paragraph.associatedCell)||(i=e.reference.paragraph.associatedCell.ownerRow).isRenderBookmarkEnd&&(i.isRenderBookmarkEnd=!1);else{var t=parseInt(e.properties.columnFirst),i=(i=e.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(i.rowIndex,t),t=(_.isNullOrUndefined(i)||(i.isRenderBookmarkStart=!1),parseInt(e.properties.columnLast));if(!_.isNullOrUndefined(e.reference)&&!_.isNullOrUndefined(e.reference.paragraph.associatedCell)){for(var n=e.reference.paragraph.associatedCell.ownerRow,r=void 0,o=t;_.isNullOrUndefined(r)&&-1<o;)r=n.getCell(n.rowIndex,o),_.isNullOrUndefined(r)&&o--;r.isRenderBookmarkEnd&&(r.isRenderBookmarkEnd=!1)}}this.documentHelper.bookmarks.remove(e.name),e.line.children.splice(e.indexInOwner,1),_.isNullOrUndefined(e.reference)||e.reference.line.children.splice(e.reference.indexInOwner,1);i=e.line.paragraph;e.line.paragraph.isInHeaderFooter&&(t=void 0,i.containerWidget instanceof N?t=i.containerWidget.getContainerTable().containerWidget:i.containerWidget instanceof Xd&&(t=i.containerWidget),this.updateHeaderFooterWidget(t))},o.prototype.getSelectionInfo=function(e){var t=this.selection.start,i=this.selection.end,n=(this.selection.isForward||(t=this.selection.end,i=this.selection.start),i.offset===this.selection.getLineLength(i.currentWidget)+1&&this.selection.isParagraphLastLine(i.currentWidget)||this.owner.documentHelper.isDragging||(i.offset+=1),this.selection.getParagraphInfo(t)),r=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),n=this.selection.getParagraphInfo(i),n=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),o=this.selection.selectedWidgets.keys;return _.isNullOrUndefined(e)||1!=e||this.selection.hasMergedCells()?(o[0]instanceof N&&t.paragraph.isInsideTable&&(e=this.selection.getCellFromSelectionInTable(0),!_.isNullOrUndefined(e))&&e instanceof N&&(r=this.selection.getActualOffset(e,0)),o[o.length-1]instanceof N&&i.paragraph.isInsideTable&&(e=this.selection.getCellFromSelectionInTable(1),!_.isNullOrUndefined(e))&&e instanceof N&&(n=this.selection.getActualOffset(e,1))):(t.paragraph.isInsideTable&&(o=this.selection.getCellFromSelection(0),!_.isNullOrUndefined(o))&&o instanceof N&&(r=this.selection.getActualOffset(o,0)),i.paragraph.isInsideTable&&(e=this.selection.getCellFromSelection(1),!_.isNullOrUndefined(e))&&e instanceof N&&(n=this.selection.getActualOffset(e,1))),{start:r,end:n}},o.prototype.insertElements=function(e,t,i){var n=this.getSelectionInfo(i);i&&!_.isNullOrUndefined(t[0].properties)&&0==t[0].bookmarkType&&(n=this.owner.selection.updateSelectionInfo(n)),_.isNullOrUndefined(t)||(this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(n.start),t,void 0),this.owner.isSpellCheck&&i&&t[0].previousElement&&t[0].previousElement instanceof X&&(t[0].previousElement.ischangeDetected=!0)),_.isNullOrUndefined(e)||(this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(n.end),e,void 0),this.owner.isSpellCheck&&i&&e[0].reference.line!==e[0].line&&e[0].previousElement&&e[0].previousElement instanceof X&&(e[0].previousElement.ischangeDetected=!0))},o.prototype.insertElementsInternal=function(e,t,i){this.selection.selectPosition(e,e),this.initHistory("InsertElements"),!_.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(t[0]instanceof J&&this.editorHistory||t[0]instanceof Wc||t[0]instanceof Sc)&&this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(t[0])),this.updateInsertPosition();var n=this.selection.getParagraphInfo(this.selection.start);if(this.selection.start.paragraph.isEmpty()){var r=this.selection.start.paragraph;r.childWidgets[0].children.push(t[0]),t[0].line=r.childWidgets[0],t[0].linkFieldCharacter(this.documentHelper),this.documentHelper.layout.reLayoutParagraph(r,0,0),this.setPositionParagraph(n.paragraph,n.offset+length,!0),e.setPositionForSelection(t[0].line,t[0],t[0].length,this.selection.start.location)}else{for(var r=this.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,0),n=r.element,r=r.index,o=t[0],s=(this.insertElementInternal(n,o,r,void 0,!0),o.indexInOwner),a=o,l=1;l<t.length;l++)a=t[l],o.line.children.splice(s+l,0,a);e.setPositionForSelection(a.line,a,a.length,this.selection.start.location)}this.selection.selectPosition(e,e),this.editorHistory&&(this.checkEndPosition()&&this.updateHistoryPosition(this.selection.start,!1),this.editorHistory.updateHistory())},o.prototype.getMarkerData=function(e,t,i,n){var r,o,s,a,l,d,h={};return(this.editorHistory.currentBaseHistoryInfo||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(e instanceof J?(r=d="",l=a=s=o=void 0,0==e.bookmarkType?(this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.editorHistory.currentBaseHistoryInfo.insertedText=L.Marker_Start),_.isNullOrUndefined(e.properties)||(d=e.properties.columnFirst,r=e.properties.columnLast)):(this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.editorHistory.currentBaseHistoryInfo.insertedText=L.Marker_End),_.isNullOrUndefined(e.properties)||(o=e.properties.isAfterParagraphMark,s=e.properties.isAfterTableMark,a=e.properties.isAfterRowMark,l=e.properties.isAfterCellMark)),h={bookmarkName:e.name,type:"Bookmark",skipOperation:t,columnFirst:d,columnLast:r,isAfterParagraphMark:o,isAfterTableMark:s,isAfterRowMark:a,isAfterCellMark:l}):e instanceof Wc||e instanceof Sc?(d=void 0,e instanceof Wc?(d=e,this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.editorHistory.currentBaseHistoryInfo.insertedText=L.Marker_Start)):(d=e.editRangeStart,this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.editorHistory.currentBaseHistoryInfo.insertedText=L.Marker_End)),h={user:""===d.user?d.group:d.user,type:"EditRange",editRangeId:d.editRangeId,skipOperation:t,columnFirst:_.isNullOrUndefined(d.columnFirst)?void 0:d.columnFirst.toString(),columnLast:_.isNullOrUndefined(d.columnLast)?void 0:d.columnLast.toString()}):e instanceof Z?(0==e.fieldType?this.editorHistory.currentBaseHistoryInfo.insertedText=L.Marker_Start:2==e.fieldType?this.editorHistory.currentBaseHistoryInfo.insertedText=L.Field_Separator:this.editorHistory.currentBaseHistoryInfo.insertedText=L.Marker_End,h={type:"Field"}):e instanceof Bh?h={type:e.footnoteType}:e instanceof X&&(this.editorHistory.currentBaseHistoryInfo.insertedText=e.text)),h=this.owner.enableTrackChanges&&!_.isNullOrUndefined(i)?this.getRevisionMarkerData(h,i,t,n):h},o.prototype.getRevisionMarkerData=function(e,t,i,n){return(e=_.isNullOrUndefined(e)?{}:e).revisionId=t.revisionID,e.revisionType=t.revisionType,e.author=t.author,e.date=t.date,e.skipOperation=i,e.isAcceptOrReject=n,e},o.prototype.getCommentElementBox=function(e){var e=e.split(";"),t=this.documentHelper.comments[parseInt(e[1],10)];return 2<e.length&&""!==e[2]?t.replyComments[parseInt(e[2],10)]:t},o.prototype.getBlock=function(e){var t=this.selection.getBodyWidget(e);return this.getBlockInternal(t,e)},o.prototype.getBlockInternal=function(e,t){var i,n,r;if(""!==t.index&&!_.isNullOrUndefined(t))return r=t.index.indexOf(";"),n=t.index.substring(0,r),t.index=t.index.substring(r).replace(";",""),i=e,r=parseInt(n,10),(n=this.selection.getBlockByIndex(e,r))?(e=n,0<=t.index.indexOf(";")?e instanceof G?(0<=t.index.indexOf(";")&&(t.index="0"),{node:e,position:t}):e instanceof Vd?(r=this.getBlockInternal(e,t),{node:_.isNullOrUndefined(r)?void 0:r.node,position:_.isNullOrUndefined(r)?void 0:r.position}):{node:i,position:t}:{node:e,position:t}):{node:i,position:t}},o.prototype.updateHistoryPosition=function(e,t){var i,n;this.editorHistory&&!_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(n=void 0,n=e instanceof y?(i=this.selection.getParagraphInfo(e),this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString())):e,t?this.editorHistory.currentBaseHistoryInfo.insertPosition=n:this.editorHistory.currentBaseHistoryInfo.endPosition=n)},o.prototype.applyBorders=function(e){this.initHistory("Borders");var t=this.selection.isForward?this.selection.start:this.selection.end,i=this.selection.isForward?this.selection.end:this.selection.start,n=(n=t.paragraph.associatedCell.ownerTable).combineWidget(this.owner.viewer),i=(this.editorHistory&&this.cloneTableToHistoryInfo(n),t.paragraph.associatedCell,i.paragraph.associatedCell),r=this.getBorder(e.borderColor,e.lineWidth,e.borderStyle);if(_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.insertedFormat=t.paragraph.associatedCell.cellFormat.borders),this.selection.isEmpty)"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"LeftBorder"!==e.type||i.cellFormat.borders.left.copyFormat(r),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"TopBorder"!==e.type||i.cellFormat.borders.top.copyFormat(r),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"RightBorder"!==e.type||i.cellFormat.borders.right.copyFormat(r),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"BottomBorder"!==e.type||i.cellFormat.borders.bottom.copyFormat(r),"AllBorders"!==e.type&&"InsideBorders"!==e.type&&"InsideVerticalBorder"!==e.type||i.cellFormat.borders.vertical.copyFormat(r),"AllBorders"!==e.type&&"InsideBorders"!==e.type&&"InsideHorizontalBorder"!==e.type||i.cellFormat.borders.horizontal.copyFormat(r),"NoBorder"===e.type&&this.clearAllBorderValues(i.cellFormat.borders);else{if("OutsideBorders"===e.type||"TopBorder"===e.type)for(var o=this.getTopBorderCellsOnSelection(),s=0;s<o.length;s++)o[s].cellFormat.borders.top.copyFormat(r);if("OutsideBorders"===e.type||"LeftBorder"===e.type)for(o=this.getLeftBorderCellsOnSelection(),s=0;s<o.length;s++)o[s].cellFormat.borders.left.copyFormat(r);if("OutsideBorders"===e.type||"RightBorder"===e.type)for(o=this.getRightBorderCellsOnSelection(),s=0;s<o.length;s++)o[s].cellFormat.borders.right.copyFormat(r);if("OutsideBorders"===e.type||"BottomBorder"===e.type)for(o=this.getBottomBorderCellsOnSelection(),s=0;s<o.length;s++)o[s].cellFormat.borders.bottom.copyFormat(r)}if("BottomBorder"===e.type||"AllBorders"===e.type||"OutsideBorders"===e.type||"NoBorder"===e.type)for(var a=this.getAdjacentCellToApplyBottomBorder(),s=0;s<a.length;s++){var l=a[s];"NoBorder"===e.type?l.cellFormat.borders.top.copyFormat(this.clearBorder()):l.cellFormat.borders.top.copyFormat(r)}if("AllBorders"===e.type||"OutsideBorders"===e.type||"RightBorder"===e.type||"NoBorder"===e.type){a=this.getAdjacentCellToApplyRightBorder();for(s=0;s<a.length;s++){l=a[s];"NoBorder"===e.type?l.cellFormat.borders.left.copyFormat(this.clearBorder()):l.cellFormat.borders.left.copyFormat(r)}}"AllBorders"!==e.type&&"NoBorder"!==e.type||this.applyAllBorders(r,e.type),"InsideBorders"!==e.type&&"InsideVerticalBorder"!==e.type&&"InsideHorizontalBorder"!==e.type&&"NoBorder"!==e.type||this.applyInsideBorders(r,e.type,n),this.updateGridForTableDialog(n,!1),this.reLayout(this.selection,!1),this.editorHistory.updateHistory()},o.prototype.applyAllBorders=function(e,t){for(var i=this.selection.getSelectedCells(),n=0;n<i.length;n++)"NoBorder"===t?(i[n].cellFormat.borders.left.copyFormat(this.clearBorder()),i[n].cellFormat.borders.right.copyFormat(this.clearBorder()),i[n].cellFormat.borders.top.copyFormat(this.clearBorder()),i[n].cellFormat.borders.bottom.copyFormat(this.clearBorder())):(i[n].cellFormat.borders.left.copyFormat(e),i[n].cellFormat.borders.right.copyFormat(e),i[n].cellFormat.borders.top.copyFormat(e),i[n].cellFormat.borders.bottom.copyFormat(e))},o.prototype.applyInsideBorders=function(e,t,i){for(var n=this.selection.getSelectedCells(),r=0;r<n.length;r++){var o=n[r],s=o.ownerRow===n[n.length-1].ownerRow,a=o.columnIndex+o.cellFormat.columnSpan-1===n[n.length-1].columnIndex;if("NoBorder"===t?(o.cellFormat.borders.right.copyFormat(this.clearBorder()),o.cellFormat.borders.bottom.copyFormat(this.clearBorder())):(a||"InsideHorizontalBorder"===t||o.cellFormat.borders.right.copyFormat(e),s||"InsideVerticalBorder"===t||o.cellFormat.borders.bottom.copyFormat(e)),!s&&"InsideVerticalBorder"!==t){s=o.ownerRow.rowIndex+o.cellFormat.rowSpan,s=i.childWidgets[s];if(s)for(var l=this.getAdjacentBottomBorderOnEmptyCells(s,o,!0),d=0;d<l.length;d++)"NoBorder"===t?l[d].cellFormat.borders.top.copyFormat(this.clearBorder()):l[d].cellFormat.borders.top.copyFormat(e)}if(!a&&"InsideHorizontalBorder"!==t)for(var h=this.getSelectedCellsNextWidgets(o,i),c=0;c<h.length;c++)"NoBorder"===t?h[c].cellFormat.borders.left.copyFormat(this.clearBorder()):h[c].cellFormat.borders.left.copyFormat(e)}},o.prototype.getTopBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,t=[],i=this.selection.getSelectedCells(),n=0;n<i.length;n++)i[n].ownerRow===e.ownerRow&&t.push(i[n]);return t},o.prototype.getLeftBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,t=this.selection.getSelectedCells(),i=[],n=0;n<t.length;n++)t[n].columnIndex===e.columnIndex&&i.push(t[n]);return i},o.prototype.getRightBorderCellsOnSelection=function(){for(var e=this.selection.getSelectedCells(),t=[],i=0;i<e.length;i++)e[i].columnIndex+e[i].cellFormat.columnSpan-1===e[e.length-1].columnIndex&&t.push(e[i]);return t},o.prototype.getBottomBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.end:this.selection.start).paragraph.associatedCell,t=this.selection.getSelectedCells(),i=[],n=0;n<t.length;n++)t[n].ownerRow===e.ownerRow&&i.push(t[n]);return i},o.prototype.clearAllBorderValues=function(e){var t=this.clearBorder();e.bottom.copyFormat(t),e.left.copyFormat(t),e.right.copyFormat(t),e.top.copyFormat(t),e.vertical.copyFormat(t),e.horizontal.copyFormat(t)},o.prototype.clearBorder=function(){var e=new Va;return e.lineStyle="Cleared",e},o.prototype.getAdjacentCellToApplyBottomBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var n=(n=t.paragraph.associatedCell.ownerTable).combineWidget(this.owner.viewer),r=t.paragraph.associatedCell,o=i.paragraph.associatedCell,t=o.ownerRow.rowIndex+o.cellFormat.rowSpan,s=n.childWidgets[t];if(s)if(1<o.cellFormat.columnSpan)for(var a=o.columnIndex;a<o.columnIndex+o.cellFormat.columnSpan;a++)s.childWidgets[a]&&e.push(s.childWidgets[a]);else if(e=this.getAdjacentBottomBorderOnEmptyCells(s,o),!this.selection.isEmpty)for(a=0;a<s.childWidgets.length;a++){var l=s.childWidgets[a].columnIndex;l>=r.columnIndex&&l<=o.columnIndex&&s.childWidgets[a]&&e.push(s.childWidgets[a])}return e},o.prototype.getAdjacentBottomBorderOnEmptyCells=function(e,t,i){var n=[];if(1<t.cellFormat.columnSpan)for(var r=t.columnIndex;r<t.columnIndex;r++)n.push(e.childWidgets[r]);else if(this.selection.isEmpty||i)for(r=0;r<e.childWidgets.length;r++)e.childWidgets[r].columnIndex===t.columnIndex&&n.push(e.childWidgets[r]);return n},o.prototype.getAdjacentCellToApplyRightBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var n=(n=t.paragraph.associatedCell.ownerTable).combineWidget(this.owner.viewer);t.paragraph.associatedCell,i.paragraph.associatedCell;if(this.selection.isEmpty)i=t.paragraph.associatedCell,e=this.getSelectedCellsNextWidgets(i,n);else for(var r=this.getRightBorderCellsOnSelection(),o=0;o<r.length;o++){var s=r[o];e=e.concat(this.getSelectedCellsNextWidgets(s,n))}return e},o.prototype.getSelectedCellsNextWidgets=function(e,t){var i=[];if(!_.isNullOrUndefined(e.nextWidget)&&(i.push(e.nextWidget),1<e.cellFormat.rowSpan))for(var n=e.ownerRow.rowIndex+e.cellFormat.rowSpan,r=e.ownerRow.rowIndex+1;r<n;r++){var o=t.childWidgets[r];if(o)for(var s=0;s<o.childWidgets.length;s++)o.childWidgets[s].columnIndex===e.nextWidget.columnIndex&&i.push(o.childWidgets[s])}return i},o.prototype.getBorder=function(e,t,i){var n=new Va;return n.color=e||"#000000",n.lineWidth=t||1,n.lineStyle=i||"Single",n},o.prototype.applyBordersInternal=function(e,t){_.isNullOrUndefined(e)||_.isNullOrUndefined(e)||(_.isNullOrUndefined(e.top)||this.applyBorder(e.top,t.top),_.isNullOrUndefined(e.bottom)||this.applyBorder(e.bottom,t.bottom),_.isNullOrUndefined(e.left)||this.applyBorder(e.left,t.left),_.isNullOrUndefined(e.right)||this.applyBorder(e.right,t.right),_.isNullOrUndefined(e.horizontal)||this.applyBorder(e.horizontal,t.horizontal),_.isNullOrUndefined(e.vertical)||this.applyBorder(e.vertical,t.vertical),_.isNullOrUndefined(e.diagonalUp)||this.applyBorder(e.diagonalUp,t.diagonalUp),_.isNullOrUndefined(e.diagonalDown))||this.applyBorder(e.diagonalDown,t.diagonalDown)},o.prototype.applyShading=function(e,t){_.isNullOrUndefined(t)||_.isNullOrUndefined(e)||(_.isNullOrUndefined(t.backgroundColor)||e.backgroundColor===t.backgroundColor||(e.backgroundColor=t.backgroundColor),_.isNullOrUndefined(t.foregroundColor)||e.foregroundColor===t.foregroundColor||(e.foregroundColor=t.foregroundColor),_.isNullOrUndefined(t.textureStyle))||e.textureStyle===t.textureStyle||(e.textureStyle=t.textureStyle)},o.prototype.applyBorder=function(e,t){_.isNullOrUndefined(e)||_.isNullOrUndefined(t)||(_.isNullOrUndefined(t.color)||e.color===t.color||(e.color=t.color),_.isNullOrUndefined(t.lineStyle)||e.lineStyle===t.lineStyle||(e.lineStyle=t.lineStyle),_.isNullOrUndefined(t.lineWidth)||e.lineWidth===t.lineWidth||(e.lineWidth=t.lineWidth),_.isNullOrUndefined(t.shadow)||e.shadow===t.shadow||(e.shadow=t.shadow),_.isNullOrUndefined(t.space))||e.space===t.space||(e.space=t.space)},o.prototype.onTableFormat=function(e,t,i){if(!_.isNullOrUndefined(this.selection.tableFormat)){if(_.isNullOrUndefined(t)&&(t=!1),this.documentHelper.owner.isShiftingEnabled=!0,this.editorHistory.initializeHistory("TableFormat"),_.isNullOrUndefined(i)&&(i=this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer)),t)for(var n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++)r.childWidgets[o].cellFormat.shading.copyFormat(e.shading);this.applyTableFormat(i,void 0,e),this.reLayout(this.selection,!1)}},o.prototype.applyTableFormat=function(e,t,i){this.applyTablePropertyValue(void 0,i,e)},o.prototype.applyTablePropertyValue=function(e,t,i){i=i.tableFormat;!_.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(t=this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(i,e,t),this.editorHistory.currentBaseHistoryInfo.insertedFormat=t),t instanceof Fl?_.isNullOrUndefined(e)&&this.handleTableFormat(i,t):("preferredWidth"===e?i.preferredWidth=t:"leftIndent"===e?i.leftIndent=t:"tableAlignment"===e?i.tableAlignment=t:"cellSpacing"===e?i.cellSpacing=t:"leftMargin"===e?i.leftMargin=t:"rightMargin"===e?i.rightMargin=t:"topMargin"===e?i.topMargin=t:"bottomMargin"===e?i.bottomMargin=t:"preferredWidthType"===e?i.preferredWidthType=t:"bidi"===e?i.bidi=t:"title"===e?i.title=t:"description"===e&&(i.description=t),"shading"===e?i.shading=t:"borders"===e&&(i.borders=t))},o.prototype.handleTableFormat=function(e,t){(this.isBordersAndShadingDialog||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(_.isNullOrUndefined(e.borders)||this.applyBordersInternal(e.borders,t.borders),_.isNullOrUndefined(e.shading)||this.applyShading(e.shading,t.shading)),this.isBordersAndShadingDialog||(t.hasValue("bidi")&&t.bidi!==e.bidi&&(e.bidi=t.bidi),t.hasValue("preferredWidth")&&t.preferredWidth!==e.preferredWidth&&(e.preferredWidth=t.preferredWidth),t.hasValue("preferredWidthType")&&t.preferredWidthType!==e.preferredWidthType&&(e.preferredWidthType=t.preferredWidthType),t.hasValue("tableAlignment")&&t.tableAlignment!==e.tableAlignment&&(e.tableAlignment=t.tableAlignment),t.hasValue("leftIndent")&&t.leftIndent!==e.leftIndent&&(e.leftIndent=t.leftIndent)),this.updateGridForTableDialog(e.ownerBase,!1),t.title!==e.title&&(e.title=t.title),t.description!==e.description&&(e.description=t.description)},o.prototype.updateGridForTableDialog=function(e,t){e.tableHolder&&(e.updateRowIndex(0),e.isGridUpdated=!1),this.documentHelper.layout.reLayoutTable(e)},o.prototype.onRowFormat=function(e){var t,i;_.isNullOrUndefined(this.selection)||_.isNullOrUndefined(e)||(this.editorHistory.initializeHistory("RowFormat"),this.documentHelper.owner.isShiftingEnabled=!0,t=this.selection.isForward?this.selection.start:this.selection.end,i=this.selection.isForward?this.selection.end:this.selection.start,t.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.applyRowFormat(t.paragraph.associatedCell.ownerRow,t,i,void 0,e),this.reLayout(this.selection,!1))},o.prototype.applyRowFormat=function(e,t,i,n,r){this.applyRowPropertyValue(this.documentHelper.selection,n,r,e),i.paragraph.associatedCell.ownerRow===e||(e=e.nextWidget,_.isNullOrUndefined(e))||this.applyRowFormat(e,t,i,n,r)},o.prototype.applyRowPropertyValue=function(e,t,i,n){var r=n.rowFormat;_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(r,t,i),this.editorHistory.currentBaseHistoryInfo.insertedFormat=i),i instanceof Ya?_.isNullOrUndefined(t)&&this.handleRowFormat(i,r):("heightType"===t?r.heightType=i:"height"===t?r.height=i:"isHeader"===t?r.isHeader=i:"allowBreakAcrossPages"===t&&(r.allowBreakAcrossPages=i),_.isNullOrUndefined(n.ownerTable)||this.layoutItemBlock(n.ownerTable,!0))},o.prototype.handleRowFormat=function(e,t){e.hasValue("allowBreakAcrossPages")&&e.allowBreakAcrossPages!==t.allowBreakAcrossPages&&(t.allowBreakAcrossPages=e.allowBreakAcrossPages),e.hasValue("isHeader")&&e.isHeader!==t.isHeader&&(t.isHeader=e.isHeader),e.hasValue("heightType")&&e.heightType!==t.heightType&&(t.heightType=e.heightType),e.hasValue("height")&&e.height!==t.height&&(t.height=e.height),this.updateGridForTableDialog(t.ownerBase.ownerTable,!0)},o.prototype.onCellFormat=function(e){_.isNullOrUndefined(this.selection)||_.isNullOrUndefined(e)||(this.editorHistory.initializeHistory("CellFormat"),this.updateFormatForCell(this.selection,void 0,e),this.reLayout(this.selection,!1))},o.prototype.onParaFormat=function(e){_.isNullOrUndefined(this.selection)||_.isNullOrUndefined(e)||(this.editorHistory.initializeHistory("ParagraphFormat"),this.updateParagraphFormat(void 0,e,!1),this.reLayout(this.selection,!1))},o.prototype.updateCellMargins=function(e,t){var i=e.start,n=e.end;e.isForward||(i=e.end,n=e.start),this.initHistoryPosition(e,i),this.documentHelper.owner.cellOptionsDialogModule.applyCellMarginValue(i.paragraph.associatedCell.ownerRow,i,n,t)},o.prototype.updateFormatForCell=function(e,t,i){for(var n=e.start,r=e.end,o=(e.isForward||(n=e.end,r=e.start),n.paragraph.associatedCell),s=r.paragraph.associatedCell,e=o.ownerTable.combineWidget(this.owner.viewer),a=o.columnIndex;a<=s.columnIndex;a++)for(var l=this.getSelectedCellInColumn(o.ownerTable,o.ownerRow.rowIndex,a,s.ownerRow.rowIndex),d=0;d<l.length;d++)this.applyCellPropertyValue(this.documentHelper.selection,t,i,l[d].cellFormat);this.updateGridForTableDialog(e,!1)},o.prototype.getSelectedCellInColumn=function(e,t,i,n){for(var r=[],o=t;o<=n;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)s.childWidgets[a].columnIndex===i&&r.push(s.childWidgets[a]);return r},o.prototype.getColumnCells=function(e,t,i){for(var n=[],r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];i?a.columnIndex+a.cellFormat.columnSpan===t&&n.push(a):a.columnIndex===t&&n.push(a)}return n},o.prototype.getTableWidth=function(e){return 0!==e.tableFormat.preferredWidth||"Percent"===e.tableFormat.preferredWidthType?"Auto"===e.tableFormat.preferredWidthType||"Point"===e.tableFormat.preferredWidthType?e.tableFormat.preferredWidth:0===e.tableFormat.preferredWidth?0:j.convertPixelToPoint(this.owner.viewer.clientArea.width)/100*e.tableFormat.preferredWidth:j.convertPixelToPoint(this.documentHelper.layout.getTableWidth(e))},o.prototype.applyCellPropertyValue=function(e,t,i,n){if(_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(n,t,i),this.editorHistory.currentBaseHistoryInfo.insertedFormat=i),i instanceof Tl)return _.isNullOrUndefined(t)&&this.handleCellFormat(i,n),i;"leftMargin"===t?n.leftMargin=i:"topMargin"===t?n.topMargin=i:"rightMargin"===t?n.rightMargin=i:"bottomMargin"===t?n.bottomMargin=i:"preferredWidth"===t?(n.preferredWidth=i,n.cellWidth=i):"cellWidth"===t?n.cellWidth=i:"columnSpan"===t?n.columnSpan=i:"rowSpan"===t?n.rowSpan=i:"preferredWidthType"===t?n.preferredWidthType=i:"verticalAlignment"===t&&(n.verticalAlignment=i),"shading"===t?n.shading=i:"borders"===t&&(n.borders=i)},o.prototype.handleCellFormat=function(e,t){_.isNullOrUndefined(e)||_.isNullOrUndefined(t)||(this.isBordersAndShadingDialog?(_.isNullOrUndefined(e.borders)||this.applyBordersInternal(t.borders,e.borders),_.isNullOrUndefined(e.shading)||this.applyShading(t.shading,e.shading)):(e.hasValue("preferredWidth")&&t.preferredWidth!==e.preferredWidth&&(t.preferredWidth=e.preferredWidth),e.hasValue("preferredWidthType")&&t.preferredWidthType!==e.preferredWidthType&&(t.preferredWidthType=e.preferredWidthType),e.hasValue("verticalAlignment")&&t.verticalAlignment!==e.verticalAlignment&&(t.verticalAlignment=e.verticalAlignment)))},o.prototype.destroy=function(){this.tableResize&&(this.tableResize.destroy(),this.tableResize=void 0),this.previousCharFormat&&(this.previousCharFormat.destroy(),this.previousCharFormat=void 0),this.previousParaFormat&&(this.previousParaFormat.destroy(),this.previousParaFormat=void 0),this.alertDialog&&this.alertDialog.destroy(),this.alertDialog=void 0,this.base64&&this.base64.destroy(),this.base64=void 0,this.endParagraph=void 0,this.copiedData=void 0,this.copiedTextContent=void 0,this.listNumberFormat=void 0,this.nodes=[],this.removedTextNodes=[],this.removedBookmarkElements=[],this.editStartRangeCollection=[],this.documentHelper=void 0,this.editRangeID=void 0,this.isCellFormatApplied=void 0},o.prototype.updateToc=function(e){var t;_.isNullOrUndefined(e)&&(e=this.selection.getTocFieldInternal()),this.documentHelper.layout.isTocField(e)&&-1!==(t=this.selection.getFieldCode(e)).toLocaleLowerCase().indexOf("toc")&&this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(t,e)))},o.prototype.getTocSettings=function(e,t){var i={includePageNumber:!0,rightAlign:!0};if("toc \\mergeformat"===e.toLowerCase())i.startLevel=1,i.endLevel=3;else for(var n=e.split("\\"),r=0;r<n.length;r++){var o,s=n[r];if(0!==s.length)switch(s[0]){case"o":_.isNullOrUndefined(s.match(/\d+/g))?(i.startLevel=1,i.endLevel=9):(o=s.match(/\d+/g).map(Number),i.startLevel=o[0],i.endLevel=o[1]);break;case"h":i.includeHyperlink=!0;break;case"n":i.includePageNumber=!1;break;case"p":i.rightAlign=!1;break;case"u":i.includeOutlineLevels=!0;break;case"t":this.decodeTSwitch(i,s)}}e=t.paragraph.paragraphFormat.getUpdatedTabs();return 0<e.length&&(i.tabLeader=e[e.length-1].tabLeader),i.rightAlign&&_.isNullOrUndefined(i.tabLeader)&&(i.tabLeader="Dot"),i},o.prototype.decodeTSwitch=function(e,t){e.levelSettings={};for(var i=(t=(t=(t=(t=t.replace("t","")).replace('"',"")).replace('"',"")).trim()).split(","),n=0;n<i.length;n++)e.levelSettings[i[n]]=parseInt(i[n+1],10),n++},o.prototype.insertTableOfContents=function(e){var t,i,n,r,o,s;this.selection.isPlainContentControl()||(this.isInsertingTOC=!0,t=this.checkAndRemoveComments(),this.initComplexHistory("TOC"),s=void(_.isNullOrUndefined(e)&&(e={startLevel:1,endLevel:3,includeHyperlink:!0,includeOutlineLevels:!0,includePageNumber:!0,rightAlign:!0,tabLeader:"Dot"})),n=void 0,(s="TableOfContents"===this.selection.contextType?this.selection.getTocFieldInternal():s)instanceof Z&&(this.selection.start.setPositionForSelection(s.line,s,0,this.selection.start.location),i=2,s.fieldEnd.paragraph===s.fieldEnd.paragraph.bodyWidget.lastChild&&i--,this.selection.end.setPositionForSelection(s.fieldEnd.line,s.fieldEnd,i,this.selection.end.location),this.delete()),n=this.constructTocFieldCode(e),s=this.selection.start.isAtParagraphStart,i=this.selection.getParagraphInfo(this.selection.start),i=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()),0<(e=this.buildToc(this.validateTocSettings(e),n,!0,s)).length?(n=new G,r=new uh(n),n.childWidgets.push(r),o=0,s=e[o=s?o:1].childWidgets[0].children[0],this.appendEndField(s,r),e.push(n),this.appendEmptyPara(e)):((o=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.owner.locale),C.DialogUtility.alert({title:o.getConstant("No Headings"),content:o.getConstant("Add Headings"),showCloseIcon:!0,closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}).enableRtl=this.owner.enableRtl),this.setPositionForCurrentIndex(this.selection.start,i),this.selection.end.setPositionInternal(this.selection.start),(s=new z).sectionFormat=new Ma(s),s.childWidgets=e,this.pasteContentsInternal([s],!1),this.updatePageRef(),this.isInsertingTOC=!1,this.editorHistory&&(this.editorHistory.updateComplexHistory(),this.updateHistoryForComments(t)),0===e.length&&(this.owner.editorHistoryModule.undo(),this.owner.editorHistoryModule.redoStack.pop()))},o.prototype.appendEmptyPara=function(e){var t=new G,i=new uh(t);t.childWidgets.push(i),e.push(t)},o.prototype.constructTocFieldCode=function(e){var t="TOC",e=(_.isNullOrUndefined(e.startLevel)||0===e.startLevel||_.isNullOrUndefined(e.endLevel)||0===e.endLevel||(t=t+' \\o "'+e.startLevel+"-"+e.endLevel+'"'),e.includePageNumber&&!e.rightAlign&&(t+=' \\p " "'),e.includePageNumber||(t+=" \\n"),e.includeHyperlink&&(t+=" \\h \\z"),e.includeOutlineLevels&&(t+=" \\u"),this.constructTSwitch(e));return 6<e.length&&(t+=e),t},o.prototype.constructTSwitch=function(e){var t="";if(!_.isNullOrUndefined(e.levelSettings))for(var i=0,n=Object.keys(e.levelSettings);i<n.length;i++)var r=n[i],t=t+r+","+e.levelSettings[r].toString()+",";return t=' \\t "'+(t=t.slice(0,-1))+'"'},o.prototype.appendEndField=function(e,t){var i=new Z(1);i.fieldSeparator=e.fieldSeparator,(e.fieldSeparator.fieldEnd=i).fieldBegin=e,(i.fieldBegin.fieldEnd=i).line=t,0<e.revisions.length&&((e=e.revisions[e.revisions.length-1]).range.push(i),this.owner.trackChangesPane.updateCurrentTrackChanges(e),i.revisions.push(e)),t.children.push(i)},o.prototype.validateTocSettings=function(e){return(_.isNullOrUndefined(e.startLevel)||e.startLevel<1)&&(e.startLevel=1),(_.isNullOrUndefined(e.endLevel)||e.endLevel<e.endLevel)&&(e.endLevel=3<e.startLevel?e.startLevel:3),_.isNullOrUndefined(e.includeHyperlink)&&(e.includeHyperlink=!1),_.isNullOrUndefined(e.includePageNumber)&&(e.includePageNumber=!1),_.isNullOrUndefined(e.rightAlign)&&(e.rightAlign=!1),_.isNullOrUndefined(e.levelSettings)&&(e.levelSettings={}),e},o.prototype.buildToc=function(e,t,i,n,r){for(var o,s=this.documentHelper.pages[0].bodyWidgets[0],a=[],l=(this.createHeadingLevels(e),e.includeOutlineLevels&&this.createOutlineLevels(e),this.selection.start.paragraph.bodyWidget.sectionFormat),d=s.childWidgets[0];void 0!==d;)d instanceof G&&(this.isHeadingStyle(d)||e.includeOutlineLevels&&this.isOutlineLevelStyle(d))&&(o=this.insertTocBookmark(d),this.createTOCWidgets(d,a,t,o,e,i,n,l,r),i=!1),d=this.selection.getNextParagraphBlock(d.getSplitWidgets().pop());return this.tocStyles={},a},o.prototype.createOutlineLevels=function(e){for(var t=e.startLevel;t<=e.endLevel;t++){var i="Level"+t.toString();_.isNullOrUndefined(this.tocStyles[i])&&(this.tocStyles[i]=t)}},o.prototype.createHeadingLevels=function(e){for(var t=e.startLevel;t<=e.endLevel;t++){var i="Heading "+t.toString();_.isNullOrUndefined(this.tocStyles[i])&&(this.tocStyles[i]=t)}if(!_.isNullOrUndefined(e.levelSettings))for(var n=0,r=Object.keys(e.levelSettings);n<r.length;n++){var o=r[n];this.tocStyles[o]=e.levelSettings[o]}},o.prototype.isHeadingStyle=function(e){e=e.paragraphFormat.baseStyle;return void 0!==e&&!_.isNullOrUndefined(this.tocStyles[e.name])},o.prototype.isOutlineLevelStyle=function(e){e=e.paragraphFormat.outlineLevel;return!_.isNullOrUndefined(this.tocStyles[e])},o.prototype.createTocFieldElement=function(e,t,i){var n=new Z(0),r=(n.hasFieldEnd=!0,(n.line=e).children.push(n),new X),t=(r.text=t,(r.line=e).children.push(r),new Z(2));return t.fieldBegin=n,((t.fieldBegin.fieldSeparator=t).line=e).children.push(t),n},o.prototype.createTOCWidgets=function(e,t,i,n,r,o,s,a,l){for(var d,h,c,p=void 0,u=void 0,g=void 0,m=!1,f=(1!==t.length||3!==t[0].childWidgets[0].children.length||_.isNullOrUndefined(o)||o?(u=new G,c=void 0,d=e.paragraphFormat.baseStyle.name,c=r.includeOutlineLevels&&_.isNullOrUndefined(this.tocStyles[d])?e.paragraphFormat.outlineLevel:d,d="TOC "+this.tocStyles[c],c="Heading "+this.tocStyles[c],h=void 0,l?(h=this.documentHelper.styles.findByName(c,"Paragraph"),_.isNullOrUndefined(h)&&(this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(c)),this.documentHelper.styles,!0),h=this.documentHelper.styles.findByName(c,"Paragraph"))):(h=this.documentHelper.styles.findByName(d,"Paragraph"),_.isNullOrUndefined(h)&&(this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(d)),this.documentHelper.styles,!0),h=this.documentHelper.styles.findByName(d,"Paragraph"))),u.paragraphFormat.applyStyle(h),r.rightAlign&&r.includePageNumber&&((c=new Ka).position=a.pageWidth-(a.leftMargin+a.rightMargin),c.tabLeader=r.tabLeader,c.deletePosition=0,c.tabJustification="Right",u.paragraphFormat.tabs.push(c)),g=new uh(u),u.childWidgets.push(g)):g=t[0].childWidgets[0],void 0!==o&&o&&(_.isNullOrUndefined(s)||s||(this.appendEmptyPara(t),m=!0),this.createTocFieldElement(g,i)),""),y=!1,v=e;v instanceof G;){for(var w=0;w<v.childWidgets.length;w++)for(var b=v.childWidgets[w],x=0;x<b.children.length;x++){var C=b.children[x];C.isPageBreak||C.isColumnBreak||(C instanceof Z||C instanceof J||y?C instanceof Z&&(0===C.fieldType?y=!0:2===C.fieldType&&(y=!1)):(C instanceof X||C instanceof Y)&&(f+=C=-1!==(C=C.text).indexOf("\t")?C.replace(new RegExp("\t","g")," "):C))}v=v.nextSplitWidget}""!==f&&(r.includeHyperlink&&void 0!==n?p=this.insertTocHyperlink(g,n,f,e):((d=new X).text=f,(d.line=g).children.push(d)),r.includePageNumber&&void 0!==n&&(r.rightAlign&&((h=new _h).text="\t",(h.line=g).children.push(h)),a=this.insertTocPageNumber(n,g,r.rightAlign,e),this.appendEndField(a,g)),r.includeHyperlink)&&void 0!==p&&this.appendEndField(p,g),_.isNullOrUndefined(u)||""===f&&!o||(t.push(u),l)||!this.owner.enableTrackChanges||_.isNullOrUndefined(u)||(1===t.length||m?this.insertRevisionForBlock(u,"Insertion",!0):(c=this.owner.revisionsInternal.changes[0],this.insertRevisionForBlock(u,"Insertion",!0,c)))},o.prototype.insertTocHyperlink=function(e,t,i,n){var t=this.createTocFieldElement(e,' HYPERLINK \\l "'+t+'" ',!0),r=new X,i=(r.text=i,n.paragraphFormat.baseStyle.name);return this.documentHelper.styles.findByName(i,"Paragraph").characterFormat.isEqualTocFormat(n.characterFormat)?(i=this.documentHelper.styles.findByName("Normal","Paragraph"),r.characterFormat.copyTocFormat(i.characterFormat)):r.characterFormat.copyTocFormat(n.characterFormat),(r.line=e).children.push(r),t},o.prototype.getPageNumber=function(e){e=e.bodyWidget.sectionFormat.restartPageNumbering?e.bodyWidget.page.currentPageNum:this.documentHelper.pages.indexOf(e.bodyWidget.page)+1;return e},o.prototype.insertTocPageNumber=function(e,t,i,n){var r=this.createTocFieldElement(t," PAGEREF"+e+" \\h ",!0),n=this.getPageNumber(n).toString(),o=new Vh;return o.fieldBegin=r,o.text=n=i?n:" "+n,(o.line=t).children.push(o),this.pageRefFields[e]=o,r},o.prototype.updatePageRef=function(){for(var e=0,t=Object.keys(this.pageRefFields);e<t.length;e++){var i,n,r=t[e];this.documentHelper.bookmarks.containsKey(r)&&(i=this.documentHelper.bookmarks.get(r),(i=this.getPageNumber(i.paragraph).toString())!==(r=this.pageRefFields[r]).text)&&(r.isWidthUpdated=!1,r.text=i,n=(i=r.paragraph).childWidgets.indexOf(r.line),r=r.line.children.indexOf(r),_.isNullOrUndefined(i.containerWidget)||this.documentHelper.layout.reLayoutParagraph(i,n,r))}},o.prototype.insertTocBookmark=function(e){var t=void 0;if(0<e.childWidgets.length){var e=e.getSplitWidgets(),i=e[0],e=e.pop(),i=i.childWidgets[0],e=e.childWidgets[e.childWidgets.length-1];if(void 0!==i&&void 0!==e){var n=i.children[0];if(n instanceof Y||n instanceof up)for(;(n=n.nextNode)instanceof Y||n instanceof up;);if(!_.isNullOrUndefined(n)&&n instanceof J&&0===n.bookmarkType&&n.name.toLowerCase().match("^_toc"))return n.name;var r=e.children[e.children.length-1];void 0!==n&&void 0!==r&&(this.selection.start.setPositionForSelection(i,n,0,this.selection.start.location),this.selection.end.setPositionForSelection(e,r,r.length,this.selection.end.location),t=this.generateBookmarkName(),this.insertBookmark(t))}}return t},o.prototype.generateBookmarkName=function(){var e="";do{this.tocBookmarkId++;for(var t=10-this.tocBookmarkId.toString().length,i="";0<t-1;)i="0"+i,t--}while(e="_Toc"+i+this.tocBookmarkId,this.documentHelper.bookmarks.containsKey(e));return e},o.prototype.onCellContentAlignment=function(e,t){this.owner.isShiftingEnabled=!0;var i,n=this.owner.selectionModule;n.isEmpty&&n.start.paragraph.isInsideTable?(this.owner.editorHistoryModule&&this.owner.editorHistoryModule.initComplexHistory(n,"MultiSelection"),n.selectTableCell(),this.initHistory("CellContentVerticalAlignment"),i=n.start.paragraph.associatedCell.cellFormat,this.applyCellPropertyValue(n,"verticalAlignment",e,i),this.reLayout(n,!1),this.initHistory("TextAlignment"),this.updateParagraphFormat("textAlignment",t,!1),this.reLayout(this.owner.selectionModule,!1)):(this.owner.editorHistoryModule&&this.owner.editorHistoryModule.initComplexHistory(n,"MultiSelection"),_.isNullOrUndefined(n.getTable(n.start,n.end))||(this.updateSelectionTableFormat(n,"CellContentVerticalAlignment",e),this.reLayout(this.owner.selectionModule,!1),this.initHistory("TextAlignment"),this.updateSelectionParagraphFormatting("textAlignment",t,!1),this.reLayout(n,!1))),this.owner.editorHistoryModule&&this.owner.editorHistoryModule.updateComplexHistory()},o.prototype.insertEditRangeElement=function(e){if(!this.documentHelper.isDocumentProtected&&!this.documentHelper.selection.isEmpty){this.initComplexHistory("RestrictEditing"),this.selection.skipEditRangeRetrieval=!0;var t=this.documentHelper.selection;this.selection.start,this.selection.end;if(this.selection.isForward||(this.selection.end,this.selection.start),t.start.paragraph.isInsideTable&&t.end.paragraph.isInsideTable&&t.start.paragraph.associatedCell.ownerTable.contains(t.end.paragraph.associatedCell)){var i=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward);if(i.rowIndex===n.rowIndex){for(var r=i.ownerRow.childWidgets.indexOf(i),o=i.ownerRow.childWidgets.indexOf(n),s=[],a=[],l=r;l<=o;l++){var d=this.addEditElement(e),h=(l==r&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=d),d.columnFirst=l,d.columnLast=l,d.line=t.start.currentWidget,d.editRangeEnd);h.line=t.end.currentWidget,s.push(d),a.push(h),this.insertElements(void 0,[d])}for(var c=this.selection.getLastParagraph(n).lastChild,p=0;p<a.length;p++)a[p].line=c,0==p&&(this.selection.start.setPositionParagraph(c,this.selection.getLineLength(c)),this.selection.end.setPositionParagraph(c,this.selection.getLineLength(c))),this.insertElements(void 0,[a[p]]);this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var u=s[0].line.getOffset(s[0],1);this.selection.start.setPositionParagraph(s[0].line,u),u=a[0].line.getOffset(a[0],1),this.selection.end.setPositionParagraph(a[0].line,u)}else{this.insertEditRangeInsideTable(i,n,e),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();i=this.documentHelper.getFirstParagraphInCell(i).childWidgets[0],n=this.selection.getLastParagraph(n).childWidgets[0],u=i.getOffset(i.children[0],1);this.selection.start.setPositionParagraph(i,u),u=n.getOffset(n.children[0],1),this.selection.end.setPositionParagraph(n,u)}this.selection.fireSelectionChanged(!0),this.fireContentChange()}else this.addRestrictEditingForSelectedArea(e);this.selection.skipEditRangeRetrieval=!1}},o.prototype.insertEditRangeInsideTable=function(e,t,i){for(var n=(h=e.ownerTable.combineWidget(this.owner.viewer)).childWidgets.indexOf(t.ownerRow),r=h.childWidgets.indexOf(e.ownerRow),o=(a=this.selection.getCellLeft(e.ownerRow,e))+e.cellFormat.cellWidth,s=this.selection.getCellLeft(t.ownerRow,t),t=s+t.cellFormat.cellWidth,s=this.updateSelectedCellsInTable(a,o,s,t),a=s.start,o=s.end,l=[],d=r;d<=n;d++){for(var h,c=(h=e.ownerTable.combineWidget(this.owner.viewer)).childWidgets[d],p=-1,u=-1,g=0;g<c.childWidgets.length;g++){var m=c.childWidgets[g],m=this.selection.getCellLeft(c,m);this.checkCellWithInSelection(a,o,m)&&(-1===p&&(p=g),u=g)}for(var f=[],y=p;y<=u;y++){var v=void 0,w=void 0,b=(p<=y&&y<=u&&(x=c.childWidgets[p],w=(v=this.documentHelper.getFirstParagraphInCell(x)).childWidgets[0]),this.addEditElement(i)),x=(y===p&&(this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=b),this.selection.start.setPositionParagraph(w,this.selection.getStartOffset(v)),this.selection.end.setPositionParagraph(w,this.selection.getStartOffset(v))),b.columnFirst=y,b.columnLast=y,b.line=w,this.insertElements(void 0,[b]),b.editRangeEnd);if(f.push(x),0<l.length&&y===u){for(var C=0;C<l.length;C++)l[C].line=b.line,this.insertElements(void 0,[l[C]]);l=[]}}if(l=f,d===n&&0<l.length)for(var I=c.childWidgets[u],k=this.selection.getLastParagraph(I).lastChild,C=0;C<l.length;C++)l[C].line=k,0==C&&(this.selection.start.setPositionParagraph(k,this.selection.getLineLength(k)),this.selection.end.setPositionParagraph(k,this.selection.getLineLength(k))),this.insertElements(void 0,[l[C]])}},o.prototype.addRestrictEditingForSelectedArea=function(e){var e=this.addEditElement(e),t=e.editRangeEnd,i=(this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=e),this.owner.isShiftingEnabled=!0,this.insertElements([t],[e]),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal(),e.line.getOffset(e,1)),e=(this.selection.start.setPositionParagraph(e.line,i),i=t.line.getOffset(t,1),this.selection.end.setPositionParagraph(t.line,i),this.documentHelper.blockToShift);!_.isNullOrUndefined(e)&&this.viewer instanceof Sd&&1<e.bodyWidget.sectionFormat.columns.length&&(t=this.documentHelper.layout.getBodyWidget(e.bodyWidget,!1),_.isNullOrUndefined(t.nextRenderedWidget)||"NoBreak"!==t.nextRenderedWidget.sectionFormat.breakCode||t.page!==t.nextRenderedWidget.page||this.reLayout(this.selection)),this.owner.isShiftingEnabled=!1,this.selection.fireSelectionChanged(!0),this.fireContentChange()},o.prototype.addEditElement=function(e,t){var i=new Wc,e=("everyone"===e.toLocaleLowerCase()?i.group=e:i.user=e,new Sc);return(e.editRangeStart=i).editRangeEnd=e,t?(i.editRangeId=t,e.editRangeId=t):(t=this.getEditRangeID(9),i.editRangeId=t,e.editRangeId=t),this.editStartRangeCollection.push(i),this.addEditCollectionToDocument(),this.editStartRangeCollection=[],i},o.prototype.getEditRangeID=function(e){var t=Math.pow(10,e-1),i=Math.pow(10,e)-1,i=Math.floor(Math.random()*(i-t+1))+t;return this.editRangeID.includes(i)?this.getEditRangeID(e):(this.editRangeID.push(i),i)},o.prototype.protect=function(e){this.documentHelper.isDocumentProtected=!0,this.documentHelper.protectionType=e,this.selection.highlightEditRegion(),this.editorHistory&&this.editorHistory.destroy()},o.prototype.addEditCollectionToDocument=function(){for(var e=0;e<this.editStartRangeCollection.length;e++){var t,i=this.editStartRangeCollection[e],n=""===i.user?i.group:i.user;0<this.documentHelper.editRanges.length&&this.documentHelper.editRanges.containsKey(n)?this.documentHelper.editRanges.get(n).push(i):((t=[]).push(i),this.documentHelper.editRanges.add(n,t))}this.selection.updateEditRangeCollection()},o.prototype.updateRangeCollection=function(e,t){var i;0<this.documentHelper.editRanges.length&&this.documentHelper.editRanges.containsKey(t)?this.documentHelper.editRanges.get(t).push(e):((i=[]).push(e),this.documentHelper.editRanges.add(t,i))},o.prototype.removeUserRestrictions=function(e){var t,i,n;(this.selection.checkSelectionIsAtEditRegion()||this.selection.isEditRangeCellSelected())&&(this.selection.skipEditRangeRetrieval=!0,t=this.selection.getEditRangeStartElement(),this.selection.skipEditRangeRetrieval=!0,i=this.selection.start,n=this.selection.end,this.selection.isForward||(i=this.selection.end,n=this.selection.start),!this.selection.isEmpty&&i.paragraph.isInsideTable&&n.paragraph.isInsideTable&&this.selection.isCellSelected(i.paragraph.associatedCell,i,n)?(i=i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),n=n.paragraph.associatedCell,i.contains(n)&&this.removeEditRangeElementsOnTable(e)):this.removeEditRangeElements(t,e),this.fireContentChange(),this.selection.skipEditRangeRetrieval=!1)},o.prototype.removeEditRangeElements=function(e,t){this.initHistory("RemoveEditRange"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(e)),this.editorHistory.currentBaseHistoryInfo.setEditRangeInfo(e),this.editorHistory.updateHistory()),e.user!==t&&e.group!==t||this.removeUserRestrictionsInternal(e,t),this.selection.updateEditRangeCollection()},o.prototype.removeEditRangeElementsOnTable=function(e){var t=this.selection.selectedWidgets.keys;if(t){this.initComplexHistory("RemoveEditRange");for(var i=0;i<t.length;i++)if(t[i]instanceof N){var n=t[i],r=n.containerWidget.editRangeID.values;if(0<r.length){for(var o=void 0,s=0,a=r;s<a.length;s++){var l=a[s];l.columnFirst==n.index&&l.columnLast==n.index&&(o=l)}o&&(r=o.editRangeEnd,this.selection.start.setPositionParagraph(o.line,o.line.getOffset(o,o.length)),this.selection.end.setPositionParagraph(r.line,r.line.getOffset(r,r.length)-1),o.user!==e&&o.group!==e||this.removeEditRangeElements(o,e))}}this.editorHistory&&this.editorHistory.updateComplexHistoryInternal()}},o.prototype.removeUserRestrictionsInternal=function(e,t,i){var n=t,t=(_.isNullOrUndefined(t)&&(n=""===e.user?e.group:e.user),this.documentHelper.editRanges.get(n).indexOf(e));this.documentHelper.editRanges.get(n).splice(t,1),0===this.documentHelper.editRanges.get(n).length&&this.documentHelper.editRanges.remove(n),-1!=e.columnFirst&&-1!=e.columnLast&&this.removeEditRangeFromCollection(e),e.removeEditRangeMark(),i||(e.editRangeEnd.line.children.splice(e.editRangeEnd.indexInOwner,1),e.line.children.splice(e.indexInOwner,1))},o.prototype.removeEditRangeFromCollection=function(e){var t=e.paragraph.associatedCell.ownerRow;if(t.editRangeID.containsKey(e.editRangeId)){var i=t.getCellUsingColumnIndex(t.rowIndex,e.columnFirst);_.isNullOrUndefined(i)||i.isRenderEditRangeStart&&i.isRenderEditRangeEnd&&(i.isRenderEditRangeEnd=!1,i.isRenderEditRangeStart=!1,t.editRangeID.remove(e.editRangeId))}else for(var n=e.paragraph.associatedCell.ownerTable,r=t.rowIndex-1;0<=r;r--){var o=n.childWidgets[r];if(o.editRangeID.containsKey(e.editRangeId)){var s=o.getCellUsingColumnIndex(o.rowIndex,e.columnFirst);if(!_.isNullOrUndefined(s)&&s.isRenderEditRangeStart&&s.isRenderEditRangeEnd){s.isRenderEditRangeEnd=!1,s.isRenderEditRangeStart=!1,o.editRangeID.remove(e.editRangeId);break}}}},o.prototype.removeAllEditRestrictions=function(){this.selection.skipEditRangeRetrieval=!0;for(var e=this.selection.start,t=this.selection.end,i=[],n=this.documentHelper.editRanges.keys,r=0;r<n.length;r++)for(var i=this.documentHelper.editRanges.get(n[r]),o=0;o<i.length;o++)i[o].editRangeEnd.line.children.splice(i[o].editRangeEnd.indexInOwner,1),i[o].line.children.splice(i[o].indexInOwner,1);this.documentHelper.editRanges.clear(),this.selection.updateEditRangeCollection(),this.selection.start.setPositionInternal(e),this.selection.end.setPositionInternal(t),this.selection.editRegionHighlighters.clear(),this.owner.viewer.updateScrollBars(),this.selection.fireSelectionChanged(!1),this.selection.skipEditRangeRetrieval=!1},o.prototype.insertFormField=function(e){var t;_.isNullOrUndefined(this.selection.start)||this.owner.enableHeaderAndFooter||this.selection.isPlainContentControl()||(this.initHistory("InsertHyperlink"),t=!0,(t=this.selection.isEmpty?t:this.removeSelectedContents(this.selection))&&this.insertFormFieldInternal(e))},o.prototype.insertFormFieldInternal=function(e){this.updateInsertPosition();var t=[],i=this.getCharacterFormat(this.selection),n=new B(void 0),i=(n.copyFormat(i),new Z(0)),r=(i.formFieldData=this.getFormFieldData(e),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.formFieldType=e,this.editorHistory.currentBaseHistoryInfo.fieldBegin=i),i.characterFormat.copyFormat(n),t.push(i),new J(0)),o=(r.characterFormat.copyFormat(n),i.formFieldData.name=this.getBookmarkName(e,"Insert",this.formFieldCounter),r.name=i.formFieldData.name,t.push(r),new X),o=(o.text=this.getFormFieldCode(e),t.push(o),new Z(2)),s=(t.push(o),new X),e=(s.characterFormat.copyFormat(n),"CheckBox"===e?(s.text=String.fromCharCode(9744),this.documentHelper.layout.setCheckBoxFontSize(i.formFieldData,s.characterFormat)):s.text=this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),t.push(s),new Z(1)),s=(e.characterFormat.copyFormat(n),t.push(e),i.fieldSeparator=e.fieldSeparator=o,i.fieldEnd=o.fieldEnd=e,o.fieldBegin=e.fieldBegin=i,new J(1)),o=(s.characterFormat.copyFormat(n),s.name=i.formFieldData.name,(s.reference=r).reference=s,t.push(s),this.documentHelper.layout.isInsertFormField=!0,this.insertElement(t),this.documentHelper.layout.isInsertFormField=!1,this.selection.start.paragraph,e.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(i)&&this.documentHelper.fields.push(i),this.addFormFieldWidget(i),s.line.getOffset(s,1));this.selection.selects(s.line,o,!0),this.updateEndPosition(),this.reLayout(this.selection,!0)},o.prototype.addFormFieldWidget=function(e){if(-1===this.documentHelper.formFields.indexOf(e)){var t=!1;if(0<this.documentHelper.formFields.length)for(var i=this.selection.getElementPosition(e).startPosition,n=0;n<this.documentHelper.formFields.length;n++){var r=this.selection.getElementPosition(this.documentHelper.formFields[n]).startPosition;if(i.isExistBefore(r)){t=!0,this.documentHelper.formFields.splice(n,0,e);break}}t||this.documentHelper.formFields.push(e)}},o.prototype.getFormFieldData=function(e){switch(e){case"Text":return new Ch;case"CheckBox":return new Fh;case"DropDown":return new Sh}},o.prototype.setFormField=function(e,t){var i,n;_.isNullOrUndefined(t.format)?_.isNullOrUndefined(t.sizeType)?_.isNullOrUndefined(t.dropdownItems)||(i="DropDown",n=new Sh):(i="CheckBox",n=new Fh):(i="Text",n=new Ch),_.isNullOrUndefined(i)||_.isNullOrUndefined(n)||(n.name=(_.isNullOrUndefined(t.name)?e.formFieldData:t).name,n.copyFieldInfo(t),this.editFormField(i,n))},o.prototype.editFormField=function(e,t){var i,n=this.selection.getCurrentFormField();if(_.isNullOrUndefined(n)||_.isNullOrUndefined(n.formFieldData))return!1;this.initComplexHistory("FormField"),""!==t.name&&(n.formFieldData.name!==t.name&&this.documentHelper.bookmarks.containsKey(t.name)&&this.deleteBookmark(t.name),(l=new J(0)).name=t.name,(i=new J(1)).name=t.name,(l.reference=i).reference=l),this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=_.isNullOrUndefined(this.editorHistory)||this.editorHistory&&_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo);var r=n.characterFormat.cloneFormat(),o=new B,r=(o.copyFormat(r),n.fieldSeparator.nextElement.characterFormat.cloneFormat()),s=n.line.getOffset(n,0),a=(this.selection.start.setPositionParagraph(n.line,s),n.fieldEnd),n=(s=(a=n.nextNode&&n.nextNode instanceof J?n.nextNode.reference:a).line.getOffset(a,1),this.selection.end.setPositionParagraph(a.line,s),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(this.selection,!1),this.skipFieldDeleteTracking=!1,this.updateInsertPosition(),[]),a=new Z(0),s=(a.formFieldData=t,this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.formFieldType=e,this.editorHistory.currentBaseHistoryInfo.fieldBegin=a),n.push(a),a.characterFormat.copyFormat(o),_.isNullOrUndefined(l)||n.push(l),new X),l=(s.text=this.getFormFieldCode(e),n.push(s),new Z(2)),r=(l.characterFormat.copyFormat(o),n.push(l),(s=new X).characterFormat.copyFormat(r),s.text=this.getDefaultText(t),"CheckBox"===e?(s.characterFormat.copyFormat(a.characterFormat),"Exactly"===t.sizeType&&(s.characterFormat.fontSize=t.size)):t instanceof Ch&&""!==t.defaultValue&&("Text"===t.type?s.text=j.formatText(t.format,t.defaultValue):"Number"===t.type?s.text=j.formatNumber(t.format,t.defaultValue):s.text=j.formatDate(t.format,t.defaultValue)),n.push(s),new Z(1)),e=(r.characterFormat.copyFormat(o),n.push(r),r),t=(_.isNullOrUndefined(i)||(e=i,n.push(i)),a.fieldSeparator=r.fieldSeparator=l,a.fieldEnd=l.fieldEnd=r,l.fieldBegin=r.fieldBegin=a,this.documentHelper.layout.isInsertFormField=!0,this.insertElement(n),this.documentHelper.layout.isInsertFormField=!1,this.selection.start.paragraph,r.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(a)&&this.documentHelper.fields.push(a),this.addFormFieldWidget(a),e.line.getOffset(e,1));return this.selection.selects(e.line,t,!0),this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.updateHistory(),this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.editorHistory.updateComplexHistory(),this.isSkipOperationsBuild=!1),this.reLayout(this.selection,!0),this.editHyperlinkInternal=!1,this.nodes=[],!0},o.prototype.getDefaultText=function(e){var t="";return e instanceof Fh?t=e.defaultValue?String.fromCharCode(9745):String.fromCharCode(9744):e instanceof Sh?t=0<e.dropdownItems.length?e.dropdownItems[0]:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5):e instanceof Ch&&(t=""!==e.defaultValue?e.defaultValue:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5)),t},o.prototype.getFormFieldCode=function(e){switch(e){case"Text":return"FORMTEXT";case"CheckBox":return"FORMCHECKBOX";case"DropDown":return"FORMDROPDOWN"}},o.prototype.toggleCheckBoxFormField=function(e,t,i){var n,r=e.formFieldData;r instanceof Fh&&r.enabled&&(this.initHistory("UpdateFormField"),this.editorHistory&&(n=void 0,r instanceof Fh&&(n=r.checked),this.editorHistory.currentBaseHistoryInfo.fieldBegin=e,this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(e,n),this.editorHistory.updateHistory()),r.checked=t?i:!r.checked,n=e.fieldSeparator.nextNode,r.checked?n.text=String.fromCharCode(9745):n.text=String.fromCharCode(9744),n.isWidthUpdated=!1,this.owner.documentHelper.layout.reLayoutParagraph(e.line.paragraph,0,0),this.reLayout(this.selection,!1))},o.prototype.toggleContentControlCheckBox=function(e){var t=e.nextNode;t.isWidthUpdated=!1,t.text=t.text===String.fromCharCode(9744)?String.fromCharCode(9746):String.fromCharCode(9744),t.text===String.fromCharCode(9744)?e.contentControlProperties.isChecked=!1:e.contentControlProperties.isChecked=!0,this.reLayout(this.selection,!0)},o.prototype.updateFormField=function(e,t,i){var n=e.formFieldData;n&&this.updateFormFieldInternal(e,n,t,i)},o.prototype.updateContentControl=function(e,t,i){var n;"RichText"===e.contentControlProperties.type||"Text"===e.contentControlProperties.type||"Date"===e.contentControlProperties.type||"Picture"===e.contentControlProperties.type?this.updateContentControlResult(e,t,i):"CheckBox"===e.contentControlProperties.type?(e.contentControlProperties.isChecked="true"==t&&!i,(n=e.nextElement)&&(e.contentControlProperties.isChecked&&!i?n.text=String.fromCharCode(9746):n.text=String.fromCharCode(9744))):"ComboBox"!==e.contentControlProperties.type&&"DropDownList"!==e.contentControlProperties.type||(n=new Qh,i?(i=new _.L10n("documenteditor",this.owner.defaultLocale),n.displayText=i.getConstant("Choose an item"),n.value=i.getConstant("Choose an item")):(n.displayText=t,n.value=t),e.contentControlProperties.contentControlListItems.push(n),this.dropDownChange(e,n.displayText)),this.selection.contentControleditRegionHighlighters.clear(),this.selection.isHighlightContentControlEditRegion=!0,this.selection.onHighlightContentControl()},o.prototype.updateContentControlResult=function(e,t,i){if(this.selection.selectContentControlInternal(e),"Picture"===e.contentControlProperties.type)this.insertImageAsync(t=i?"":t);else if((i||_.isNullOrUndefined(t)||""===t)&&((i=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.owner.locale),t="Date"===e.contentControlProperties.type?i.getConstant("Default Date Picker"):i.getConstant("Default Content Control Text")),"RichText"===e.contentControlProperties.type){try{"object"!=typeof t&&(t=JSON.parse(t))}catch(e){t=JSON.stringify({sections:[{blocks:[{inlines:[{text:t}]}]}]})}this.paste(t)}else this.insertText(t)},o.prototype.updateFormFieldInternal=function(e,t,i,n){t instanceof Ch?(n=i=""===i?n?this.getDefaultText(t):this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5):i,"Text"===t.type&&""!==t.format&&(n=j.formatText(t.format,i)),this.updateFormFieldResult(e,n)):t instanceof Sh&&(n=t.dropdownItems[i],t.selectedIndex=i,this.updateFormFieldResult(e,n));t=e.fieldEnd.line.getOffset(e.fieldEnd,1),i=new y(this.owner);i.setPositionParagraph(e.fieldEnd.line,t),this.documentHelper.selection.selectRange(i,i),this.reLayout(this.selection,!1)},o.prototype.updateFormFieldResult=function(e,t){this.selection.selectFieldInternal(e,!1,!0),this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.insertText(t),this.isSkipOperationsBuild=!1},o.prototype.checkBookmarkAvailability=function(e,t){for(var i=this.documentHelper.bookmarks,n=0;n<i.length;n++)if(i.containsKey(e))return!1;return!0},o.prototype.getBookmarkName=function(e,t,i){for(var n,r=!1;!1===r;)r=this.checkBookmarkAvailability(n=e+i,t),i+=1;return n},o.prototype.applyFormTextFormat=function(e){var t,i;_.isNullOrUndefined(e)||(t=i=this.getFieldResultText(e),i=j.formatText(e.formFieldData.format,i),null!=e.fieldSeparator&&this.applyTextFormatInternal(e,i),this.initHistory("FormTextFormat"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(e,t),this.editorHistory.updateHistory()))},o.prototype.insertSpaceInFormField=function(){var e;this.documentHelper.isInlineFormFillProtectedMode&&this.selection.isInlineFormFillMode()&&(0!==(e=this.getFieldResultText()).length&&"\r"!==e||(this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField())))},o.prototype.getFieldResultText=function(e){_.isNullOrUndefined(e)&&(e=this.selection.getCurrentFormField());var t=this.selection.startOffset,i=this.selection.endOffset,e=(this.selection.isModifyingSelectionInternally=!0,this.selection.selectFieldInternal(e,!1,!0),this.selection.getText(!1));return this.selection.select(t,i),this.selection.isModifyingSelectionInternally=!1,e},o.prototype.contentControlDropDownChange=function(){var e=this.documentHelper.owner.editor.getContentControl();_.isNullOrUndefined(e)||("ComboBox"==e.contentControlProperties.type||"DropDownList"==e.contentControlProperties.type?this.documentHelper.contentDropDown.showPopUp(e):"Date"==e.contentControlProperties.type&&this.documentHelper.owner.dateContentDialogModule.show())},o.prototype.applyTextFormatInternal=function(e,t){var i=e.fieldSeparator.nextElement,n=0;t=t.replace(/\r/g,"");do{if(!_.isNullOrUndefined(i)&&i instanceof X&&(i.text=t.slice(n,n+i.text.length),n+=i.length),_.isNullOrUndefined(i.nextElement))if(_.isNullOrUndefined(i.line.nextLine)){this.documentHelper.layout.layoutBodyWidgetCollection(i.paragraph.index,i.paragraph.bodyWidget,i.paragraph,!0);var r=i.paragraph.nextRenderedWidget;if(_.isNullOrUndefined(r))break;for(r instanceof K&&(r=this.documentHelper.getFirstParagraphBlock(r));r.isEmpty();)r=r.nextRenderedWidget;i=r.childWidgets[0].children[0]}else i=i.line.nextLine.children[0];else i=i.nextElement}while(!(i instanceof Z&&1===i.fieldType&&i.fieldBegin.formFieldData instanceof Ch));this.documentHelper.layout.layoutBodyWidgetCollection(i.paragraph.index,i.paragraph.bodyWidget,i.paragraph,!0),this.selection.isFormatUpdated=!0,this.reLayout(this.selection,!1),this.selection.isFormatUpdated=!1},o.prototype.constructCommentInitial=function(e){for(var t=e.split(" "),i="",n=0;n<t.length;n++)0<t[n].length&&""!==t[n]&&(i+=t[n][0]);return i},o.prototype.insertFootnote=function(){if(!(this.selection.isinFootnote||this.selection.isinEndnote||this.selection.isPlainContentControl())){this.isFootNoteInsert=!0,this.isFootNote=!0;var e,t=new Bh,i=(t.characterFormat.baselineAlignment="Superscript",t.footnoteType="Footnote",t.text="s",new G),n=new uh(i),r=new Op,r=(i.paragraphFormat.afterSpacing=0,r.characterFormat.baselineAlignment="Superscript",r.line=n,r.text="?",n.children.push(r),new X);if(r.text=" ",(r.line=n).children.push(r),i.childWidgets.push(n),t.bodyWidget.childWidgets.push(i),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(t),t.paragraph.bodyWidget.page.footnoteWidget)for(var o=0;o<t.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets.length;o++)t.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets[o].footNoteReference===t&&(e=t.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets[o].childWidgets[0]);this.selection.start.setPositionForLineWidget(e.childWidgets[0],r.line.getOffset(r,t.text.length)),this.selection.end.setPositionInternal(this.selection.start),this.updateFootNoteIndex(),this.reLayout(this.selection,!1),this.documentHelper.layout.isLayoutWhole=!0,this.isSkipOperationsBuild=!0,this.layoutWholeDocument(),this.isSkipOperationsBuild=!1,this.documentHelper.layout.isLayoutWhole=!1,this.separator("footnote"),this.continuationSeparator("footnote"),this.isFootNote=!1,this.isFootNoteInsert=!1}},o.prototype.updateFootnoteCollection=function(e){if(-1===this.documentHelper.footnoteCollection.indexOf(e)){var t=!1;if(0<this.documentHelper.footnoteCollection.length)for(var i=this.selection.getElementPosition(e).startPosition,n=0;n<this.documentHelper.footnoteCollection.length;n++){var r=this.selection.getElementPosition(this.documentHelper.footnoteCollection[n]).startPosition;if(i.isExistBefore(r)){t=!0,this.documentHelper.footnoteCollection.splice(n,0,e);break}}t||this.documentHelper.footnoteCollection.push(e)}},o.prototype.insertEndnote=function(){if(!(this.selection.isinFootnote||this.selection.isinEndnote||this.selection.isPlainContentControl())){this.documentHelper.layout.isEndnoteContentChanged=!0;var e,t=new Bh,i=(t.characterFormat.baselineAlignment="Superscript",t.footnoteType="Endnote",t.text="s",new G),n=new uh(i),r=new Op,o=(i.paragraphFormat.afterSpacing=0,r.characterFormat.baselineAlignment="Superscript",r.line=n,r.text="?",n.children.push(r),new X),n=(o.text=" ",(o.line=n).children.push(o),i.childWidgets.push(n),t.bodyWidget.childWidgets.push(i),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(t),this.documentHelper.pages.length),s=this.documentHelper.pages[n-1].bodyWidgets[0];if(s.page.endnoteWidget)for(var a=0;a<s.page.endnoteWidget.bodyWidgets.length;a++)s.page.endnoteWidget.bodyWidgets[a].footNoteReference===t&&(e=s.page.endnoteWidget.bodyWidgets[a].childWidgets[0]);this.selection.start.setPositionForLineWidget(e.childWidgets[0],r.line.getOffset(o,t.text.length)),this.selection.end.setPositionInternal(this.selection.start),this.updateEndNoteIndex(),this.reLayout(this.selection,!1),this.documentHelper.layout.isLayoutWhole=!0,this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.layoutWholeDocument(),this.isSkipOperationsBuild=!1,this.documentHelper.layout.isLayoutWhole=!1,this.owner.documentHelper.blockToShift=void 0,this.separator("endnote"),this.continuationSeparator("endnote"),this.documentHelper.layout.isEndnoteContentChanged=!1}},o.prototype.updateEndnoteCollection=function(e){if(-1===this.documentHelper.endnoteCollection.indexOf(e)){var t=!1;if(0<this.documentHelper.endnoteCollection.length)for(var i=this.selection.getElementPosition(e).startPosition,n=0;n<this.documentHelper.endnoteCollection.length;n++){var r=this.selection.getElementPosition(this.documentHelper.endnoteCollection[n]).startPosition;if(i.isExistBefore(r)){t=!0,this.documentHelper.endnoteCollection.splice(n,0,e);break}}t||this.documentHelper.endnoteCollection.push(e);var o=this.documentHelper.pages.length;if(0<this.documentHelper.endnoteCollection.length){var s,a,l=!1,d=void 0,h=this.documentHelper.endnoteCollection.indexOf(e),c=1,p=void 0,u=this.documentHelper.pages[o-1].bodyWidgets[0];if(u.page.endnoteWidget)for(var g=0;g<u.page.endnoteWidget.bodyWidgets.length;g++){var m=this.documentHelper.endnoteCollection.indexOf(u.page.endnoteWidget.bodyWidgets[g].footNoteReference);if(h<m&&m-h==1){c=g,l=!0;break}}s=e,u.page.endnoteWidget instanceof q&&"Endnote"===u.page.endnoteWidget.footNoteType?d=u.page.endnoteWidget:(p=!0,(d=new q).footNoteType="Endnote",d.page=u.page,(o=new G).characterFormat=new B,o.paragraphFormat=new Xa,o.index=0,a=new uh(o),o.childWidgets.push(a),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+18));for(var f=s.bodyWidget,g=0;g<s.bodyWidget.childWidgets.length;g++){var y=s.bodyWidget.childWidgets[g];this.documentHelper.layout.isLayoutWhole?y.containerWidget=void 0:((y.containerWidget=f).page=u.page,f.sectionFormat=d.sectionFormat,y.containerWidget.containerWidget=d),l?d.bodyWidgets.splice(c,0,f):d.bodyWidgets.push(f)}c++,p&&(u.page.endnoteWidget=d),d.height+=0}}},o.prototype.updateEndNoteIndex=function(){for(var e=this.documentHelper.endnoteCollection,t=0;t<e.length;t++){var i=this.documentHelper.layout.getFootEndNote(e[t].paragraph.bodyWidget.sectionFormat.endnoteNumberFormat,t+1);if(""!=i){if(e[t].text=i,void 0!==e[t].revisions)for(var n=0;n<e[t].revisions.length;)this.owner.trackChangesPane.updateCurrentTrackChanges(e[t].revisions[n]),n++;var r=e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0];if(!_.isNullOrUndefined(r)&&((r instanceof Op||j.checkTextFormat(r.text))&&(r.text=i,r.width=e[t].bodyWidget.footNoteReference.width),null!=r.revisions))for(n=0;n<r.revisions.length;)this.owner.trackChangesPane.updateCurrentTrackChanges(r.revisions[n]),n++}}},o.prototype.separator=function(e){var t=new G,i=new uh(t),n=new X;n.characterFormat.fontColor="#00000000",n.line=i,n.text=String.fromCharCode(3),i.children.push(n),t.childWidgets.push(i),"footnote"===e&&this.documentHelper.footnotes.separator.length<1?this.documentHelper.footnotes.separator.push(t):"endnote"===e&&this.documentHelper.endnotes.separator.length<1&&this.documentHelper.endnotes.separator.push(t)},o.prototype.continuationSeparator=function(e){var t=new G,i=new uh(t),n=new X;n.characterFormat.fontColor="#00000000",n.line=i,n.text=String.fromCharCode(4),i.children.push(n),t.childWidgets.push(i),"footnote"===e&&this.documentHelper.footnotes.continuationSeparator.length<1?this.documentHelper.footnotes.continuationSeparator.push(t):"endnote"===e&&this.documentHelper.endnotes.continuationSeparator.length<1&&this.documentHelper.endnotes.continuationSeparator.push(t)},o.prototype.updateFootNoteIndex=function(){for(var e=this.documentHelper.footnoteCollection,t=0;t<e.length;t++){var i=this.documentHelper.layout.getFootEndNote(e[t].paragraph.bodyWidget.sectionFormat.footNoteNumberFormat,t+1);if(""!=i){if(e[t].text=i,void 0!==e[t].revisions)for(var n=0;n<e[t].revisions.length;)this.owner.trackChangesPane.updateCurrentTrackChanges(e[t].revisions[n]),n++;var r=e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0];if(!_.isNullOrUndefined(r)&&r instanceof Op&&(r.text=i,r.width=e[t].bodyWidget.footNoteReference.width,null!=r.revisions))for(n=0;n<r.revisions.length;)this.owner.trackChangesPane.updateCurrentTrackChanges(r.revisions[n]),n++}}},o.prototype.setCharFormatForCollaborativeEditing=function(e){var t;_.isNullOrUndefined(this.editorHistory)||_.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||!this.owner.enableCollaborativeEditing||(j.writeCharacterFormat(t={},!0,e,void 0,!0),this.editorHistory.currentBaseHistoryInfo.type="CharacterFormat",this.editorHistory.currentBaseHistoryInfo.format=JSON.stringify(t))},o.prototype.clear=function(){this.pageRefFields&&(this.pageRefFields={})},o);function o(e){var n=this;this.nodes=[],this.editHyperlinkInternal=!1,this.startParagraph=void 0,this.endParagraph=void 0,this.formFieldCounter=1,this.skipFieldDeleteTracking=!1,this.skipFootNoteDeleteTracking=!1,this.isForHyperlinkFormat=!1,this.isTrackingFormField=!1,this.isInsertText=!1,this.casingIndex=-1,this.checkLastLetterSpace="",this.checkLastLetterSpaceDot="",this.pasteFootNoteType="",this.isInsertingText=!1,this.keywordIndex=0,this.dictionaryObjcetIDIncreament=1,this.dictionaryObjectIndexIncrement=0,this.XMLFilesCount=1,this.XMLFilesNameSpaceCount=1,this.xmlData=[],this.dictionaryObject=[],this.isFootnoteElementRemoved=!1,this.isEndnoteElementRemoved=!1,this.handledEnter=!1,this.removeEditRange=!1,this.isRemoveRevision=!1,this.isFootNoteInsert=!1,this.isTableInsert=!1,this.isFootNote=!1,this.isHandledComplex=!1,this.isUserInsert=!1,this.tableResize=void 0,this.tocStyles={},this.triggerPageSpellCheck=!0,this.chartType=!1,this.removedBookmarkElements=[],this.removedEditRangeStartElements=[],this.removedEditRangeEndElements=[],this.tocBookmarkId=0,this.copiedData=void 0,this.isPasteContentCheck=!1,this.pageRefFields={},this.delBlockContinue=!1,this.delBlock=void 0,this.delSection=void 0,this.isInsertingTOC=!1,this.isMeasureParaWidth=!1,this.editStartRangeCollection=[],this.skipReplace=!1,this.skipTableElements=!1,this.editRangeID=[],this.isImageInsert=!1,this.isSkipOperationsBuild=!1,this.isCellFormatApplied=!1,this.revisionData=void 0,this.splittedRevisions=[],this.isSkipComments=!1,this.isRemoteAction=!1,this.isIncrementalSave=!1,this.listNumberFormat="",this.listLevelNumber=0,this.isXmlMapped=!1,this.isAutoList=!1,this.isLastParaMarkCopied=!1,this.combineLastBlock=!1,this.remotePasteRevision=[],this.isFieldOperation=!1,this.copiedContent="",this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.pasteTextPosition=void 0,this.isPaste=!1,this.isPasteListUpdated=!1,this.isHtmlPaste=!1,this.isInsertField=!1,this.isBordersAndShadingDialog=!1,this.pasteImageIndex=void 0,this.onTextInputInternal=function(){if(_.Browser.isDevice){var e=n.documentHelper,t=new RegExp(String.fromCharCode(160),"g"),i=new RegExp(String.fromCharCode(10),"g");e.prefix=e.prefix.replace(t," ").replace(i," ");i=(t=e.editableDiv.textContent.replace(t," ").replace(i," ")).substring(2);if(e.isCompositionStart&&e.isCompositionUpdated)e.isCompositionUpdated=!1,!e.owner.isReadOnlyMode&&e.owner.isDocumentLoaded&&n.canEditContentControl&&e.prefix.substring(2)!==i&&(n.selection.isEmpty&&n.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,n.selection.start.offset-(e.prefix.length-2)),n.handleTextInput(i),e.prefix="@"+String.fromCharCode(160)+i);else if(e.isCompositionStart&&e.isCompositionEnd&&""===e.suffix)e.prefix.substring(2)!==i?n.selection.isEmpty&&e.isCompositionStart?(e.isCompositionStart=!1,n.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,n.selection.start.offset-e.prefix.substring(2).length),n.selection.retrieveCurrentFormatProperties(),""!==e.suffix&&""!==i||n.handleTextInput(i)):n.selection.isEmpty||(e.isCompositionStart=!1,n.handleTextInput(i)):""===i?(e.isCompositionStart=!1,n.handleBackKey()):e.prefix.substring(2)===i&&""===e.suffix&&(e.isCompositionStart=!1,n.handleTextInput(" ")),e.isCompositionEnd=!1;else{if(e.isCompositionEnd||e.isCompositionStart&&!e.isCompositionUpdated){if(i.length<e.prefix.length&&i===e.prefix.substring(2,e.prefix.length-1)||e.editableDiv.innerText.length<2)return void n.handleBackKey();if(""!==e.suffix&&e.editableDiv.innerText[e.editableDiv.innerText.length-1]!==String.fromCharCode(160))return e.isCompositionStart=!1,n.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,n.selection.start.offset-(e.prefix.length-2)),n.selection.end.setPositionForLineWidget(e.selection.end.currentWidget,n.selection.end.offset+e.suffix.length),n.selection.retrieveCurrentFormatProperties(),void n.handleTextInput(i)}"\r"!==t&&"\b"!==t&&t!==String.fromCharCode(27)&&!e.owner.isReadOnlyMode&&!1===e.isControlPressed&&n.canEditContentControl&&("@"===t||"@"!==t[0]||""===t||t.length<e.prefix.length&&i===e.prefix.substring(2,e.prefix.length-1)?(n.handleBackKey(),e.editableDiv.innerText.length<2&&n.predictText()):0===t.indexOf(e.prefix)&&t.length>e.prefix.length?n.handleTextInput(t.substring(e.prefix.length)):-1===t.indexOf(e.prefix)&&t[t.length-1]!==String.fromCharCode(160)&&" "!==t[t.length-1]?(i.charAt(0).toLowerCase()+i.slice(1)===e.prefix.substring(2)&&n.selection.start.setPositionParagraph(e.selection.start.currentWidget,n.selection.start.offset-(e.prefix.length-2)),n.handleTextInput(i)):2!==t.length&&n.handleTextInput(" "))}}else(t=n.documentHelper.editableDiv.innerText)!==String.fromCharCode(160)?"\r"!==t&&"\b"!==t&&t!==String.fromCharCode(27)&&!n.owner.isReadOnlyMode&&!1===n.documentHelper.isControlPressed&&n.canEditContentControl&&n.handleTextInput(t):n.handleTextInput(" "),n.documentHelper.editableDiv.innerText=""},this.onPaste=function(e){!n.owner.isReadOnlyMode&&n.canEditContentControl&&n.pasteInternal(e),e.preventDefault()},this.documentHelper=e,_.isNullOrUndefined(this.documentHelper)||(this.tableResize=new Kg(this.documentHelper.owner)),this.base64=new ol}Object.defineProperty($g.prototype,"currentImageElementBox",{get:function(){return this.currentImageElementBoxIn},set:function(e){this.currentImageElementBoxIn=e},enumerable:!0,configurable:!0}),Object.defineProperty($g.prototype,"resizeMarkSize",{get:function(){return this.resizeMarkSizeIn},set:function(e){this.resizeMarkSizeIn=e},enumerable:!0,configurable:!0}),Object.defineProperty($g.prototype,"isShapeResize",{get:function(){return this.currentImageElementBox instanceof uc},enumerable:!0,configurable:!0}),Object.defineProperty($g.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),$g.prototype.getModuleName=function(){return"ImageResizer"},$g.prototype.setImageResizerPositions=function(e,t,i,n){this.imageResizerDivElement.style.top=t.toString()+"px",this.imageResizerDivElement.style.left=e.toString()+"px",this.imageResizerDivElement.style.borderWidth="0px",this.imageResizerDivElement.style.height=n+"px",this.owner.viewer instanceof Wd?this.imageResizerDivElement.style.width=i-e-this.documentHelper.scrollbarWidth+"px":this.imageResizerDivElement.style.width=i+"px",this.imageResizerDivElement.style.backgroundColor="transparent",this.imageResizerDivElement.style.overflow="hidden",this.imageResizerDivElement.style.position="absolute"},$g.prototype.initializeImageResizer=function(){this.imageResizerDivElement=document.createElement("div"),this.imageResizerDivElement.style.zIndex="1",this.imageResizerDivElement.style.display="none",this.documentHelper.pageContainer.appendChild(this.imageResizerDivElement)},$g.prototype.positionImageResizer=function(e){this.selectedImageWidget.clear(),_.isNullOrUndefined(this.documentHelper.currentPage)||(o=this.imageResizerDivElement),_.isNullOrUndefined(o)||o.contains(this.imageResizerDiv)||(this.imageResizerDiv=this.initResizeMarks(o,this)),this.imageResizerDiv.style.width=e.width+"px",this.imageResizerDiv.style.height=e.height+"px";var t,i=(this.currentImageElementBox=e).line,n=e instanceof Ic&&"Inline"!==e.textWrappingStyle?(t=e.y,e.x):(t=this.documentHelper.selection.getTop(i)+e.margin.top,this.documentHelper.selection.getLeftInternal(i,e,0)),r=this.documentHelper.selection.getPage(i.paragraph),o=(this.currentPage=r,_.isNullOrUndefined(o)||(this.owner.viewer instanceof Wd&&(this.imageResizerDivElement.style.width=r.boundingRectangle.width-r.boundingRectangle.x-n-this.documentHelper.scrollbarWidth+"px"),this.imageResizerDivElement.style.display="block",this.owner.viewer instanceof Wd?o.style.width=r.boundingRectangle.width-this.documentHelper.scrollbarWidth-r.boundingRectangle.x-n+"px":o.style.width=r.boundingRectangle.width+"px",o.style.height=r.boundingRectangle.height+"px",o.style.left=r.boundingRectangle.x+"px",o.style.top=r.boundingRectangle.y+"px",o.style.borderWidth="0px",o.style.backgroundColor="transparent",o.style.overflow="hidden",o.style.position="absolute"),this.documentHelper.getPageWidth(r)),r=parseFloat(this.imageResizerDivElement.style.width),o=((this.documentHelper.visibleBounds.width-r*this.documentHelper.zoomFactor)/2<30&&0,o<r&&this.documentHelper.zoomFactor,this.imageResizerDivElement),r=parseFloat(o.style.width),o=parseFloat(o.style.height),s=parseFloat(this.imageResizerDiv.style.width),a=parseFloat(this.imageResizerDiv.style.height),l=(this.resizeMarkSize-1)/2,s=s+2*l,a=a+2*l;s>(r-n)*this.documentHelper.zoomFactor+l&&(s=(r-n)*this.documentHelper.zoomFactor),a>(o-t)*this.documentHelper.zoomFactor+l&&(a=(o-t)*this.documentHelper.zoomFactor),this.imageResizerDivElement.style.width=parseInt(this.imageResizerDivElement.style.width.replace("px",""),10)*this.documentHelper.zoomFactor+"px",this.imageResizerDivElement.style.height=parseInt(this.imageResizerDivElement.style.height.replace("px",""),10)*this.documentHelper.zoomFactor+"px",a=this.documentHelper.render.getScaledValue(e.height),s=this.documentHelper.render.getScaledValue(e.width),t=e instanceof Ic?(n=this.documentHelper.render.getScaledValue(n),this.documentHelper.render.getScaledValue(t)):(n=e.x*this.documentHelper.zoomFactor,e.y*this.documentHelper.zoomFactor),this.setImageResizerPosition(n,t,s,a,this),this.owner.selectionModule.isInShape?this.resizeContainerDiv.style.borderStyle="dashed":this.resizeContainerDiv.style.borderStyle="solid",this.selectedImageWidget.containsKey(i)||(r=new tm(e.height,e.width),this.selectedImageWidget.add(i,r))},$g.prototype.showImageResizer=function(){_.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display=""),_.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display=""),_.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.style.display="",this.bottomLeftRectParent.style.display=""),_.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.style.display="",this.bottomRightRectParent.style.display=""),_.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="",this.bottomMiddleRectParent.style.display=""),_.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.style.display="",this.rightMiddleRectParent.style.display=""),_.isNullOrUndefined(this.topRightRect)||(this.topRightRect.style.display="",this.topRightRectParent.style.display=""),_.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.style.display="",this.topLeftRectParent.style.display=""),_.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.style.display="",this.leftMiddleRectParent.style.display=""),_.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.style.display="",this.topMiddleRectParent.style.display=""),this.isImageResizerVisible=!0},$g.prototype.hideImageResizer=function(){_.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display="none"),_.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display="none"),_.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.style.display="none",this.bottomLeftRectParent.style.display="none"),_.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.style.display="none",this.bottomRightRectParent.style.display="none"),_.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="none",this.bottomMiddleRectParent.style.display="none"),_.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.style.display="none",this.rightMiddleRectParent.style.display="none"),_.isNullOrUndefined(this.topRightRect)||(this.topRightRect.style.display="none",this.topRightRectParent.style.display="none"),_.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.style.display="none",this.topLeftRectParent.style.display="none"),_.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.style.display="none",this.leftMiddleRectParent.style.display="none"),_.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.style.display="none",this.topMiddleRectParent.style.display="none"),this.isImageResizerVisible=!1,this.currentPage=void 0},$g.prototype.initResizeMarks=function(e,t){return this.initResizeContainerDiv(t),e.appendChild(t.resizeContainerDiv),t.topRightRectParent=document.createElement("div"),t.topRightRectParent.style.cursor="ne-resize",t.topRightRectParent.id=this.documentHelper.owner.containerId+"_TopRightRectParent",this.applyProperties(t.topRightRectParent),t.topRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.opacity="-1",e.appendChild(t.topRightRectParent),t.topRightRect=document.createElement("div"),t.topRightRect.id=this.documentHelper.owner.containerId+"_TopRightRect",t.topRightRect.style.cursor="ne-resize",this.applyProperties(t.topRightRect),e.appendChild(t.topRightRect),t.topLeftRectParent=document.createElement("div"),t.topLeftRectParent.style.cursor="nw-resize",t.topLeftRectParent.id=this.documentHelper.owner.containerId+"_TopLeftRectParent",this.applyProperties(t.topLeftRectParent),t.topLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.opacity="-1",e.appendChild(t.topLeftRectParent),t.topLeftRect=document.createElement("div"),t.topLeftRect.id=this.documentHelper.owner.containerId+"_TopLeftRect",t.topLeftRect.style.cursor="nw-resize",this.applyProperties(t.topLeftRect),e.appendChild(t.topLeftRect),t.topMiddleRectParent=document.createElement("div"),t.topMiddleRectParent.style.cursor="n-resize",t.topMiddleRectParent.id=this.documentHelper.owner.containerId+"_TopMiddleRectParent",this.applyProperties(t.topMiddleRectParent),t.topMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.opacity="-1",e.appendChild(t.topMiddleRectParent),t.topMiddleRect=document.createElement("div"),t.topMiddleRect.id=this.documentHelper.owner.containerId+"_TopMiddleRect",t.topMiddleRect.style.cursor="n-resize",this.applyProperties(t.topMiddleRect),e.appendChild(t.topMiddleRect),t.bottomRightRectParent=document.createElement("div"),t.bottomRightRectParent.style.cursor="se-resize",t.bottomRightRectParent.id=this.documentHelper.owner.containerId+"_BottomRightRectParent",this.applyProperties(t.bottomRightRectParent),t.bottomRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.opacity="-1",e.appendChild(t.bottomRightRectParent),t.bottomRightRect=document.createElement("div"),t.bottomRightRect.id=this.documentHelper.owner.containerId+"_BottomRightRect",t.bottomRightRect.style.cursor="se-resize",this.applyProperties(t.bottomRightRect),e.appendChild(t.bottomRightRect),t.bottomLeftRectParent=document.createElement("div"),t.bottomLeftRectParent.style.cursor="sw-resize",t.bottomLeftRectParent.id=this.documentHelper.owner.containerId+"_BottomLeftRectParent",this.applyProperties(t.bottomLeftRectParent),t.bottomLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.opacity="-1",e.appendChild(t.bottomLeftRectParent),t.bottomLeftRect=document.createElement("div"),t.bottomLeftRect.id=this.documentHelper.owner.containerId+"_BottomLeftRect",t.bottomLeftRect.style.cursor="sw-resize",this.applyProperties(t.bottomLeftRect),e.appendChild(t.bottomLeftRect),t.bottomMiddleRectParent=document.createElement("div"),t.bottomMiddleRectParent.style.cursor="s-resize",t.bottomMiddleRectParent.id=this.documentHelper.owner.containerId+"_BottomMiddleRectParent",this.applyProperties(t.bottomMiddleRectParent),t.bottomMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.opacity="-1",e.appendChild(t.bottomMiddleRectParent),t.bottomMiddleRect=document.createElement("div"),t.bottomMiddleRect.id=this.documentHelper.owner.containerId+"_BottomMiddleRect",t.bottomMiddleRect.style.cursor="s-resize",this.applyProperties(t.bottomMiddleRect),e.appendChild(t.bottomMiddleRect),t.rightMiddleRectParent=document.createElement("div"),t.rightMiddleRectParent.style.cursor="e-resize",t.rightMiddleRectParent.id=this.documentHelper.owner.containerId+"_RightMiddleRectParent",this.applyProperties(t.rightMiddleRectParent),t.rightMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.opacity="-1",e.appendChild(t.rightMiddleRectParent),t.rightMiddleRect=document.createElement("div"),t.rightMiddleRect.id=this.documentHelper.owner.containerId+"_RightMiddleRect",t.rightMiddleRect.style.cursor="e-resize",this.applyProperties(t.rightMiddleRect),e.appendChild(t.rightMiddleRect),t.leftMiddleRectParent=document.createElement("div"),t.leftMiddleRectParent.style.cursor="w-resize",t.leftMiddleRectParent.id=this.documentHelper.owner.containerId+"_LeftMiddleRectParent",this.applyProperties(t.leftMiddleRectParent),t.leftMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.opacity="-1",e.appendChild(t.leftMiddleRectParent),t.leftMiddleRect=document.createElement("div"),t.leftMiddleRect.id=this.documentHelper.owner.containerId+"_LeftMiddleRect",t.leftMiddleRect.style.cursor="w-resize",this.applyProperties(t.leftMiddleRect),e.appendChild(t.leftMiddleRect),t.resizeContainerDiv},$g.prototype.setImageResizerPosition=function(e,t,i,n,r){r.resizeContainerDiv.style.width=i+"px",r.resizeContainerDiv.style.height=n+"px",r.resizeContainerDiv.style.left=e+"px",r.resizeContainerDiv.style.top=t+"px",r.topRightRect.style.left=e+i-5+"px",r.topRightRect.style.top=t-4+"px",r.topLeftRect.style.left=e-5+"px",r.topLeftRect.style.top=t-4+"px",r.topMiddleRect.style.left=parseFloat(r.topLeftRect.style.left)+i/2-4+"px",r.topMiddleRect.style.top=t-4+"px",r.bottomRightRect.style.left=r.topRightRect.style.left,r.bottomRightRect.style.top=parseFloat(r.topRightRect.style.top)+n+"px",r.bottomLeftRect.style.left=r.topLeftRect.style.left,r.bottomLeftRect.style.top=parseFloat(r.topLeftRect.style.top)+n+"px",r.bottomMiddleRect.style.left=r.topMiddleRect.style.left,r.bottomMiddleRect.style.top=parseFloat(r.topMiddleRect.style.top)+n+"px",r.rightMiddleRect.style.left=e+i-4+"px",r.rightMiddleRect.style.top=parseFloat(r.topRightRect.style.top)+n/2+"px",r.leftMiddleRect.style.left=r.topLeftRect.style.left,r.leftMiddleRect.style.top=parseFloat(r.topLeftRect.style.top)+n/2+"px",r.topRightRectParent.style.left=this.documentHelper.isTouchInput?e+i-15+"px":e+i-8+"px",r.topRightRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",r.topLeftRectParent.style.left=this.documentHelper.isTouchInput?e-15+"px":e-8+"px",r.topLeftRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",r.topMiddleRectParent.style.left=parseFloat(r.topLeftRectParent.style.left)+i/2-4+"px",r.topMiddleRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",r.bottomRightRectParent.style.left=r.topRightRectParent.style.left,r.bottomRightRectParent.style.top=parseFloat(r.topRightRectParent.style.top)+n+"px",r.bottomLeftRectParent.style.left=r.topLeftRectParent.style.left,r.bottomLeftRectParent.style.top=parseFloat(r.topLeftRectParent.style.top)+n+"px",r.bottomMiddleRectParent.style.left=r.topMiddleRectParent.style.left,r.bottomMiddleRectParent.style.top=parseFloat(r.topMiddleRectParent.style.top)+n+"px",r.rightMiddleRectParent.style.left=this.documentHelper.isTouchInput?e+i-15+"px":e+i-7+"px",r.rightMiddleRectParent.style.top=parseFloat(r.topRightRectParent.style.top)+n/2+"px",r.leftMiddleRectParent.style.left=r.topLeftRectParent.style.left,r.leftMiddleRectParent.style.top=parseFloat(r.topLeftRectParent.style.top)+n/2+"px",this.setImageResizingPoints(r),this.documentHelper.isTouchInput?this.applyPropertiesForTouch():this.applyPropertiesForMouse()},$g.prototype.setImageResizingPoints=function(e){this.imageResizerPoints.resizeContainerDiv.x=parseFloat(e.resizeContainerDiv.style.left),this.imageResizerPoints.resizeContainerDiv.y=parseFloat(e.resizeContainerDiv.style.top),this.imageResizerPoints.bottomLeftRectParent.x=parseFloat(e.bottomLeftRectParent.style.left),this.imageResizerPoints.bottomLeftRectParent.y=parseFloat(e.bottomLeftRectParent.style.top),this.imageResizerPoints.bottomRightRectParent.x=parseFloat(e.bottomRightRectParent.style.left),this.imageResizerPoints.bottomRightRectParent.y=parseFloat(e.bottomRightRectParent.style.top),this.imageResizerPoints.bottomMiddleRectParent.x=parseFloat(e.bottomMiddleRectParent.style.left),this.imageResizerPoints.bottomMiddleRectParent.y=parseFloat(e.bottomMiddleRectParent.style.top),this.imageResizerPoints.topLeftRectParent.x=parseFloat(e.topLeftRectParent.style.left),this.imageResizerPoints.topLeftRectParent.y=parseFloat(e.topLeftRectParent.style.top),this.imageResizerPoints.topRightRectParent.x=parseFloat(e.topRightRectParent.style.left),this.imageResizerPoints.topRightRectParent.y=parseFloat(e.topRightRectParent.style.top),this.imageResizerPoints.topMiddleRectParent.x=parseFloat(e.topMiddleRectParent.style.left),this.imageResizerPoints.topMiddleRectParent.y=parseFloat(e.topMiddleRectParent.style.top),this.imageResizerPoints.leftMiddleRectParent.x=parseFloat(e.leftMiddleRectParent.style.left),this.imageResizerPoints.leftMiddleRectParent.y=parseFloat(e.leftMiddleRectParent.style.top),this.imageResizerPoints.rightMiddleRectParent.x=parseFloat(e.rightMiddleRectParent.style.left),this.imageResizerPoints.rightMiddleRectParent.y=parseFloat(e.rightMiddleRectParent.style.top)},$g.prototype.initResizeContainerDiv=function(e){e.resizeContainerDiv=document.createElement("div"),e.resizeContainerDiv.id=this.documentHelper.owner.containerId+"_ResizeDivElement",e.resizeContainerDiv.style.position="absolute",e.resizeContainerDiv.style.border="1px solid #bfbfbf",e.resizeContainerDiv.style.zIndex="30",e.resizeContainerDiv.style.backgroundColor="transparent",e.resizeContainerDiv.style.display="block"},$g.prototype.applyProperties=function(e){e.style.position="absolute",e.style.width="8px",e.style.height="8px",e.style.fontSize="0px",e.style.zIndex=" 551",e.style.backgroundColor="#ffffff",e.style.border="1px solid #bfbfbf",e.style.boxShadow="0 1px 2px 0 #bfbfbf 0.35",e.style.color="#000000"},$g.prototype.handleImageResizing=function(e,t,i){t/=this.documentHelper.zoomFactor,i/=this.documentHelper.zoomFactor,this.leftValue=_.isNullOrUndefined(this.leftValue)?t:this.leftValue,this.topValue=_.isNullOrUndefined(this.topValue)?i:this.topValue;var n,r,o,s,a=this.selectedResizeElement.id.split("_"),a=a[a.length-1];switch(a){case"TopRightRectParent":t=(n=this.topRightResizing(e)).left,i=n.top;break;case"TopLeftRectParent":t=-(n=this.topLeftResizing(e)).left,i=-n.top;break;case"TopMiddleRectParent":t=0,i=this.topMiddleResizing(e);break;case"BottomRightRectParent":t=(n=this.bottomRightResizing(e)).left,i=n.top;break;case"BottomLeftRectParent":t=-(n=this.bottomLeftResizing(e)).left,i=-n.top;break;case"BottomMiddleRectParent":i=e.y-i,t=0;break;case"RightMiddleRectParent":t=e.x-t,i=0;break;case"LeftMiddleRectParent":t=this.leftMiddleResizing(e),i=0}0===t&&0===i||(o=this.currentImageElementBox.line.paragraph,r=this.currentImageElementBox,!_.isNullOrUndefined(o)&&o.isInsideTable&&(o=o.containerWidget,_.isNullOrUndefined(o)||(o=o.containerWidget,r=j.convertPointToPixel(r.height),s=o.height-r,0<i&&o.y+s+r+i>this.viewer.clientArea.bottom&&(this.isImageMoveToNextPage=!0))),this.owner.enableHistoryMode&&this.initHistoryForImageResizer(this.currentImageElementBox),_.isNullOrUndefined(this.currentImageElementBox)||(o=10<this.currentImageElementBox.width+t?this.currentImageElementBox.width+t:10,s=10<this.currentImageElementBox.height+i?this.currentImageElementBox.height+i:10,"BottomRightRectParent"!==a&&"TopRightRectParent"!==a&&"BottomLeftRectParent"!==a&&"TopLeftRectParent"!==a||(s=this.currentImageElementBox.height/this.currentImageElementBox.width*o,o=this.currentImageElementBox.width/this.currentImageElementBox.height*s),this.currentImageElementBox.width=o,this.currentImageElementBox.height=s,this.currentImageElementBox.line.paragraph,this.positionImageResizer(this.currentImageElementBox)),this.isImageResizing=!0)},$g.prototype.handleImageResizingOnMouse=function(e){var t,i;_.isNullOrUndefined(this.selectedResizeElement)||(t=parseFloat(this.selectedResizeElement.style.left),i=parseFloat(this.selectedResizeElement.style.top),e=new nl(e.offsetX,e.offsetY),e=this.viewer.findFocusedPage(e,!0),this.handleImageResizing(e,t,i))},$g.prototype.topMiddleResizing=function(e){var t;return this.topValue>=e.y?(t=this.topValue/e.y,this.topValue=e.y,this.viewer instanceof Sd&&this.topValue<=this.viewer.pageGap&&(t=1)):(t=-(e.y/this.topValue),this.topValue=e.y,0===this.topValue&&(t=-1)),t},$g.prototype.leftMiddleResizing=function(e){var t;return this.leftValue>=e.x?(t=this.leftValue/e.x,this.leftValue=e.x,0===this.leftValue&&(t=1,this.leftValue=parseFloat(this.selectedResizeElement.style.left))):(t=-(e.x/this.leftValue),this.leftValue=e.x),t},$g.prototype.topRightResizing=function(e){e=this.leftValue<=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e);return e},$g.prototype.topLeftResizing=function(e){e=this.leftValue>=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e);return e},$g.prototype.bottomRightResizing=function(e){e=this.leftValue<=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e);return e},$g.prototype.bottomLeftResizing=function(e){e=this.leftValue>=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e);return e},$g.prototype.getOuterResizingPoint=function(e){var t,i=e.x-this.leftValue;return this.leftValue=e.x,t=e.y-this.topValue,this.topValue=e.y,{left:i,top:t}},$g.prototype.getInnerResizingPoint=function(e){var t,i=-(this.leftValue-e.x);return this.leftValue=e.x,t=-(this.topValue-e.y),this.topValue=e.y,{left:i,top:t}},$g.prototype.handleImageResizingOnTouch=function(e){var t,i;_.isNullOrUndefined(this.selectedResizeElement)||(t=parseFloat(this.selectedResizeElement.style.left)+24,i=parseFloat(this.selectedResizeElement.style.top)+24,e=e.touches,e=new nl(e[0].clientX,e[0].clientY),e=this.viewer.findFocusedPage(e,!0),_.isNullOrUndefined(this.currentImageElementBox))||_.isNullOrUndefined(this.currentImageElementBox)||this.handleImageResizing(e,t,i)},$g.prototype.getImagePoint=function(e){var t=this.documentHelper.render.getScaledValue(e.x,1),i=this.documentHelper.render.getScaledValue(e.y,2),t=(e=new nl(t,i),this.imageResizerPoints),i="",n=void 0,r=t.bottomMiddleRectParent,o=t.bottomRightRectParent,s=t.bottomLeftRectParent,a=t.topMiddleRectParent,l=t.topRightRectParent,d=t.topLeftRectParent,h=t.rightMiddleRectParent,t=t.leftMiddleRectParent;return _.isNullOrUndefined(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(e.x>r.x&&e.x<=r.x+15&&e.y>r.y&&e.y<=r.y+15?(n=this.bottomMiddleRectParent,i="s-resize"):e.x>o.x&&e.x<=o.x+15&&e.y>o.y&&e.y<=o.y+15?(n=this.bottomRightRectParent,i="se-resize"):e.x>s.x&&e.x<=s.x+15&&e.y>s.y&&e.y<=s.y+15?(n=this.bottomLeftRectParent,i="sw-resize"):e.x>a.x&&e.x<=a.x+15&&e.y>a.y&&e.y<=a.y+15?(n=this.topMiddleRectParent,i="n-resize"):e.x>l.x&&e.x<=l.x+15&&e.y>l.y&&e.y<=l.y+15?(n=this.topRightRectParent,i="ne-resize"):e.x>d.x&&e.x<=d.x+15&&e.y>d.y&&e.y<=d.y+15?(n=this.topLeftRectParent,i="nw-resize"):e.x>t.x&&e.x<=t.x+15&&e.y>t.y&&e.y<=t.y+15?(n=this.leftMiddleRectParent,i="w-resize"):e.x>h.x&&e.x<=h.x+15&&e.y>h.y&&e.y<=h.y+15?(n=this.rightMiddleRectParent,i="e-resize"):!_.isNullOrUndefined(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(i="move")),{selectedElement:n,resizePosition:i}},$g.prototype.applyPropertiesForMouse=function(){_.isNullOrUndefined(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="14px",this.bottomMiddleRectParent.style.height="14px",this.bottomRightRectParent.style.width="14px",this.bottomRightRectParent.style.height="14px",this.bottomLeftRectParent.style.width="14px",this.bottomLeftRectParent.style.height="14px",this.topMiddleRectParent.style.width="14px",this.topMiddleRectParent.style.height="14px",this.topRightRectParent.style.width="14px",this.topRightRectParent.style.height="14px",this.topLeftRectParent.style.width="14px",this.topLeftRectParent.style.height="14px",this.leftMiddleRectParent.style.width="14px",this.leftMiddleRectParent.style.height="14px",this.rightMiddleRectParent.style.width="14px",this.rightMiddleRectParent.style.height="14px")},$g.prototype.getImagePointOnTouch=function(e){var t=this.documentHelper.render.getScaledValue(e.x,1),i=this.documentHelper.render.getScaledValue(e.y,2),t=(e=new nl(t,i),this.imageResizerPoints),i="",n=void 0,r=t.bottomMiddleRectParent,o=t.bottomRightRectParent,s=t.bottomLeftRectParent,a=t.topMiddleRectParent,l=t.topRightRectParent,d=t.topLeftRectParent,h=t.rightMiddleRectParent,t=t.leftMiddleRectParent;return _.isNullOrUndefined(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(e.x>r.x&&e.x<=r.x+25&&e.y>r.y&&e.y<=r.y+25?(n=this.bottomMiddleRectParent,i="s-resize"):e.x>o.x&&e.x<=o.x+25&&e.y>o.y&&e.y<=o.y+25?(n=this.bottomRightRectParent,i="se-resize"):e.x>s.x&&e.x<=s.x+25&&e.y>s.y&&e.y<=s.y+25?(n=this.bottomLeftRectParent,i="sw-resize"):e.x>a.x&&e.x<=a.x+25&&e.y>a.y&&e.y<=a.y+25?(n=this.topMiddleRectParent,i="n-resize"):e.x>l.x&&e.x<=l.x+25&&e.y>l.y&&e.y<=l.y+25?(n=this.topRightRectParent,i="ne-resize"):e.x>d.x&&e.x<=d.x+25&&e.y>d.y&&e.y<=d.y+25?(n=this.topLeftRectParent,i="nw-resize"):e.x>t.x&&e.x<=t.x+25&&e.y>t.y&&e.y<=t.y+25?(n=this.leftMiddleRectParent,i="w-resize"):e.x>h.x&&e.x<=h.x+25&&e.y>h.y&&e.y<=h.y+25?(n=this.rightMiddleRectParent,i="e-resize"):!_.isNullOrUndefined(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(i="move")),{selectedElement:n,resizePosition:i}},$g.prototype.applyPropertiesForTouch=function(){_.isNullOrUndefined(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="30px",this.bottomMiddleRectParent.style.height="30px",this.bottomRightRectParent.style.width="30px",this.bottomRightRectParent.style.height="30px",this.bottomLeftRectParent.style.width="30px",this.bottomLeftRectParent.style.height="30px",this.topMiddleRectParent.style.width="30px",this.topMiddleRectParent.style.height="30px",this.topRightRectParent.style.width="30px",this.topRightRectParent.style.height="30px",this.topLeftRectParent.style.width="30px",this.topLeftRectParent.style.height="30px",this.leftMiddleRectParent.style.width="30px",this.leftMiddleRectParent.style.height="30px",this.rightMiddleRectParent.style.width="30px",this.rightMiddleRectParent.style.height="30px")},$g.prototype.mouseUpInternal=function(){this.currentImageElementBox.width=parseFloat(this.imageResizerDiv.style.width)/this.documentHelper.zoomFactor,this.currentImageElementBox.height=parseFloat(this.imageResizerDiv.style.height)/this.documentHelper.zoomFactor,this.owner.isShiftingEnabled=!0,this.owner.editorModule.setOffsetValue(this.owner.selectionModule),this.documentHelper.layout.layoutBodyWidgetCollection(this.currentImageElementBox.line.paragraph.index,this.currentImageElementBox.line.paragraph.containerWidget,this.currentImageElementBox.line.paragraph,!1),this.updateHistoryForImageResizer(),this.owner.editorModule.reLayout(this.owner.selectionModule,!0),this.viewer.updateScrollBars()},$g.prototype.initHistoryForImageResizer=function(e){!_.isNullOrUndefined(this.owner)&&_.isNullOrUndefined(this.baseHistoryInfo)&&(this.baseHistoryInfo=new Ug(this.owner),this.baseHistoryInfo.action="ImageResizing",this.baseHistoryInfo.updateSelection(),this.baseHistoryInfo.modifiedProperties.push(new Pg(e)))},$g.prototype.updateHistoryForImageResizer=function(){var e;_.isNullOrUndefined(this.owner)||_.isNullOrUndefined(this.baseHistoryInfo)||(e=this.baseHistoryInfo.modifiedProperties[0],this.currentImageElementBox.width===e.width&&this.currentImageElementBox.height===e.height?this.baseHistoryInfo.modifiedProperties.pop():(this.baseHistoryInfo.insertedText=L.Image,this.baseHistoryInfo.insertedData={width:j.convertPixelToPoint(this.currentImageElementBox.width),height:j.convertPixelToPoint(this.currentImageElementBox.height),alternativeText:this.currentImageElementBox.alternateText},this.owner.editorHistoryModule.recordChanges(this.baseHistoryInfo)),this.baseHistoryInfo=void 0)},$g.prototype.updateImageResizerPosition=function(){var e,t,i,n,r,o;_.isNullOrUndefined(this.currentImageElementBox)||(this.currentImageElementBox instanceof Ic,r=(e=this.currentImageElementBox).line,n=i=t=void 0,this.currentImageElementBox instanceof Ic?(o=this.documentHelper.selection.getTop(r)+e.margin.top,t=this.documentHelper.selection.getLeftInternal(r,e,0),i=o*this.documentHelper.zoomFactor,n=t*this.documentHelper.zoomFactor):(n=e.x*this.documentHelper.zoomFactor,i=e.y*this.documentHelper.zoomFactor),r=this.documentHelper.render.getScaledValue(e.height,2),o=this.documentHelper.render.getScaledValue(e.width,1),this.setImageResizerPosition(n,i,o,r,this))},$g.prototype.destroy=function(){_.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.innerHTML=""),_.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.innerHTML=""),_.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.innerHTML=""),_.isNullOrUndefined(this.topRightRect)||(this.topRightRect.innerHTML=""),_.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.innerHTML=""),_.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.innerHTML=""),_.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.innerHTML=""),_.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.innerHTML=""),_.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.innerHTML=""),_.isNullOrUndefined(this.imageResizerDiv)||(this.imageResizerDiv.innerHTML=""),_.isNullOrUndefined(this.selectedImageWidget)||this.selectedImageWidget.destroy(),_.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.innerHTML="",_.isNullOrUndefined(this.imageResizerDivElement.parentElement))||this.imageResizerDivElement.parentElement.removeChild(this.imageResizerDivElement),this.imageResizerDivElement=void 0,this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.imageResizerDiv=void 0,this.selectedImageWidget=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.currentImageElementBoxIn=void 0,this.imageResizerPoints=void 0,this.resizeMarkSizeIn=void 0,this.currentPage=void 0,this.documentHelper=void 0,this.owner=void 0};var Qg=$g;function $g(e,t){this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.topLeftRectParent=void 0,this.topMiddleRectParent=void 0,this.topRightRectParent=void 0,this.bottomLeftRectParent=void 0,this.bottomMiddleRectParent=void 0,this.bottomRightRectParent=void 0,this.leftMiddleRectParent=void 0,this.rightMiddleRectParent=void 0,this.resizeMarkSizeIn=7,this.selectedImageWidget=void 0,this.baseHistoryInfo=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.isImageMoveToNextPage=!1,this.selectedResizeElement=void 0,this.topValue=void 0,this.leftValue=void 0,this.owner=e,this.selectedImageWidget=new T,this.documentHelper=t,this.imageResizerPoints=new em,_.isNullOrUndefined(this.imageResizerDiv)&&this.viewer&&this.documentHelper.pageContainer&&this.initializeImageResizer()}var em=function(){this.resizeContainerDiv=new nl(0,0),this.topLeftRectParent=new nl(0,0),this.topMiddleRectParent=new nl(0,0),this.topRightRectParent=new nl(0,0),this.bottomLeftRectParent=new nl(0,0),this.bottomMiddleRectParent=new nl(0,0),this.bottomRightRectParent=new nl(0,0),this.leftMiddleRectParent=new nl(0,0),this.rightMiddleRectParent=new nl(0,0)},tm=(Object.defineProperty(im.prototype,"height",{get:function(){return this.heightIn},set:function(e){this.heightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(im.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),im);function im(e,t){this.heightIn=0,this.widthIn=0,this.heightIn=e,this.widthIn=t}Object.defineProperty(nm.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(nm.prototype,"selection",{get:function(){return this.owner.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(nm.prototype,"collaborativeEditingSettings",{get:function(){return this.owner.documentEditorSettings.collaborativeEditingSettings},enumerable:!0,configurable:!0}),nm.prototype.getModuleName=function(){return"CollaborativeEditing"},nm.prototype.updateAction=function(e){Array.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var i=e[parseInt(t.toString(),10)];switch(i.action){case"LockContent":this.transFormLockRegion(i),this.lockRegion(i.selectionInfo.start,i.selectionInfo.end,i.author);break;case"SaveContent":this.version=i.version,this.updateRegion(i.author,i.data);break;case"UnlockContent":this.version=i.version,this.updateRegion(i.author,i.data),this.removeEditRange(i.author)}}},nm.prototype.transFormLockRegion=function(e){var t,i,n,r,o=e.selectionInfo.previousLockInfo;_.isNullOrUndefined(o)||(t=o.author,r=n=0,this.documentHelper.editRanges.containsKey(t)&&0<(t=this.documentHelper.editRanges.get(t)).length&&(t=this.selection.getPosition(t[0]),t=this.selection.getHierarchicalIndexByPosition(t.endPosition).split(";"),i=o.end.split(";"),n=parseInt(t[0],10)-parseInt(i[0],10),r=parseInt(t[1],10)-parseInt(i[1],10),e.selectionInfo.start.split(";")[0]===o.end.split(";")[0]?(e.selectionInfo.start=this.tranformPosition(e.selectionInfo.start,n,r),e.selectionInfo.end=this.tranformPosition(e.selectionInfo.end,n,r)):(e.selectionInfo.start=this.tranformPosition(e.selectionInfo.start,n,0),e.selectionInfo.end=this.tranformPosition(e.selectionInfo.end,n,0))))},nm.prototype.lockContent=function(e){var t,i,n,r,o,s,a,l=this;this.canLock()&&(t=this.owner.selectionModule.start,i=this.owner.selectionModule.end,this.owner.selectionModule.isForward||(t=this.owner.selectionModule.end,i=this.owner.selectionModule.start),t.paragraph.isInsideTable?(r=this.owner.documentHelper.layout.getParentTable(t.paragraph),n=this.owner.documentHelper.getFirstParagraphBlock(r),t.setPosition(n.childWidgets[0],!0)):t.paragraphStartInternal(this.owner.selectionModule,!1),i.paragraph.isInsideTable?(r=this.owner.documentHelper.layout.getParentTable(i.paragraph),r=(n=this.owner.documentHelper.getLastParagraphBlock(r)).lastChild.getEndOffset(),i.setPositionParagraph(n.lastChild,r)):i.moveToParagraphEndInternal(this.owner.selectionModule,!1),n=this.owner.selectionModule.getHierarchicalIndexByPosition(t),r=this.owner.selectionModule.getHierarchicalIndexByPosition(i),o={start:n,end:r,roomName:this.owner.documentEditorSettings.collaborativeEditingSettings.roomName,author:_.isNullOrUndefined(e)?this.owner.currentUser:e,version:this.version},s=this.selection.getParagraphInfo(t),a=this.selection.getParagraphInfo(i),this.owner.selectionModule.select(n,r),(e=new A).url=this.owner.serviceUrl+this.owner.serverActionSettings.canLock,e.contentType="application/json;charset=UTF-8",e.onSuccess=function(e){l.successHandler(e,o,s,a)},e.onFailure=this.failureHandler.bind(this),e.onError=this.failureHandler.bind(this),e.customHeaders=this.owner.headers,e.send(o))},nm.prototype.canLock=function(){var e=this.documentHelper.editRanges;if(e.containsKey(this.owner.currentUser))return!1;for(var t=e.keys,i=0;i<t.length;i++){var n=e.get(t[parseInt(i.toString(),10)]);if(!_.isNullOrUndefined(n)&&0<n.length&&this.isSelectionInEditableRange(n[0]))return!1}return!0},nm.prototype.getPreviousLockedRegion=function(){var e=this.documentHelper.editRanges;if(!e.containsKey(this.owner.currentUser)){for(var t,i=e.keys,n=0;n<i.length;n++){var r=e.get(i[parseInt(n.toString(),10)])[0],o=this.selection.getPosition(r).startPosition;o.isExistBefore(this.selection.start)&&(_.isNullOrUndefined(t)||o.isExistAfter(this.selection.getPosition(t).startPosition))&&(t=r)}return t}},nm.prototype.unlockContent=function(e){var t;this.documentHelper.editRanges.containsKey(e)&&(this.saveTimer&&clearTimeout(this.saveTimer),t=JSON.stringify(this.serializeEditableRegion(e)),t={action:"UnlockContent",author:e,version:this.version,data:t,selectionInfo:{start:"",end:"",roomName:this.collaborativeEditingSettings.roomName,author:this.owner.currentUser,version:this.version},roomName:this.collaborativeEditingSettings.roomName},this.removeEditRange(e),this.owner.editorHistoryModule.clearHistory(),this.owner.fireContentChange(),this.owner.trigger(be,t))},nm.prototype.removeEditRange=function(e){this.documentHelper.editRanges.containsKey(e)&&(this.updateLockRegion(e,!1),this.owner.editorModule.removeUserRestrictionsInternal(this.documentHelper.editRanges.get(e)[0]),this.documentHelper.clearContent(),this.selection.updateEditRangeCollection(),this.documentHelper.owner.viewer.updateScrollBars())},nm.prototype.saveContent=function(){var e=this,t=(this.saveTimer&&clearTimeout(this.saveTimer),this.collaborativeEditingSettings.saveTimeout);_.isNullOrUndefined(t)&&(t=3e3),this.saveTimer=Number(setTimeout(function(){e.saveContentInternal()},t))},nm.prototype.saveContentInternal=function(){var e;this.documentHelper.editRanges.containsKey(this.owner.currentUser)&&(e=this.documentHelper.editRanges.get(this.owner.currentUser)[0],e=this.selection.getPosition(e),e={action:"SaveContent",author:this.owner.currentUser,version:this.version,data:JSON.stringify(this.serializeEditableRegion(this.owner.currentUser)),selectionInfo:{start:this.selection.getHierarchicalIndexByPosition(e.startPosition),end:this.selection.getHierarchicalIndexByPosition(e.endPosition),roomName:this.collaborativeEditingSettings.roomName,author:this.owner.currentUser,version:this.version},roomName:this.collaborativeEditingSettings.roomName},this.owner.trigger(be,e))},nm.prototype.serializeEditableRegion=function(e){var e=this.documentHelper.editRanges.get(e)[0],t=e.editRangeEnd,i=new y(this.owner),e=(i.setPosition(e.line,!0),new y(this.owner)),t=(e.setPosition(t.line,!1),this.owner.sfdtExportModule.isPartialExport=!0,this.owner.sfdtExportModule.write(0,i.currentWidget,i.offset,e.currentWidget,e.offset,!1));return this.owner.sfdtExportModule.isPartialExport=!1,t},nm.prototype.successHandler=function(e,t,i,n){JSON.parse(e.data).canLock?(t.start=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()),t.end=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),(e=this.getPreviousLockedRegion())&&(i=this.selection.getPosition(e),t.previousLockInfo={start:this.selection.getHierarchicalIndexByPosition(i.startPosition),end:this.selection.getHierarchicalIndexByPosition(i.endPosition),author:e.user,roomName:"",version:0}),n={action:"LockContent",selectionInfo:t,author:this.owner.currentUser,version:this.version,data:"",roomName:this.collaborativeEditingSettings.roomName},this.owner.trigger(be,n)):((i=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.owner.locale),C.DialogUtility.alert({content:i.getConstant("Already locked"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"Center",Y:"Center"}}).enableRtl=this.owner.enableRtl)},nm.prototype.failureHandler=function(){var e=new _.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),C.DialogUtility.alert({content:e.getConstant("Error in establishing connection with web server"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"Center",Y:"Center"}}).enableRtl=this.owner.enableRtl},nm.prototype.lockRegion=function(e,t,i){e=this.selection.getTextPosBasedOnLogicalIndex(e),t=this.selection.getTextPosBasedOnLogicalIndex(t);this.lockRegionInternal(e,t,i)},nm.prototype.lockRegionInternal=function(e,t,i){var n=this.owner.editorModule.addEditElement(i),r=n.editRangeEnd;this.insertElements(e,t,[r],[n]),this.updateLockInfo(n.paragraph,r.paragraph,i,!0),this.owner.viewer.updateScrollBars()},nm.prototype.insertElements=function(e,t,i,n){var r=e.paragraph.equals(t.paragraph);_.isNullOrUndefined(n)||this.insertElementsInternal(e,n),_.isNullOrUndefined(i)||this.insertElementsInternal(t,i),this.documentHelper.layout.reLayoutParagraph(n[0].paragraph,0,0),r||this.documentHelper.layout.reLayoutParagraph(i[0].paragraph,0,0)},nm.prototype.insertElementsInternal=function(e,t){if(e.paragraph.isEmpty()){var i=e.paragraph;i.childWidgets[0].children.push(t[0]),t[0].line=i.childWidgets[0]}else for(var n,i=e.currentWidget.getInline(e.offset,0),e=i.element,i=i.index,r=t[0],o=(this.insertElementInternal(e,r,i),r.indexInOwner),s=1;s<t.length;s++)n=t[parseInt(s.toString(),10)],r.line.children.splice(o+s,0,n)},nm.prototype.insertElementInternal=function(e,t,i){var n=e.line,r=n.paragraph,o=e.indexInOwner,r=r.paragraphFormat.bidi&&e.isRightToLeft;i===e.length?(r||o++,n.children.splice(o,0,t)):0===i&&(_.isNullOrUndefined(e.previousNode)?(n.children.splice(0,0,t),o=0):n.children.splice(o,0,t)),t.line=e.line},nm.prototype.setEditableRegion=function(){var e;this.documentHelper.editRanges.containsKey(this.owner.currentUser)&&(e=this.documentHelper.editRanges.get(this.owner.currentUser)[0],e=this.getParentBlock(e.paragraph),this.lockStart=this.owner.selectionModule.getHierarchicalIndex(e,"0").split(";"))},nm.prototype.isSelectionInEditableRange=function(e){if(!_.isNullOrUndefined(this.owner.selectionModule)){var t=this.owner.selectionModule.start,i=this.owner.selectionModule.end,n=(this.owner.selectionModule.isForward||(t=(n=[i,t])[0],i=n[1]),this.owner.selectionModule.getPosition(e));if((t.isExistAfter(n.startPosition)||t.isAtSamePosition(n.startPosition))&&(i.isExistBefore(n.endPosition)||i.isAtSamePosition(n.endPosition))||(n.startPosition.isExistAfter(t)||n.startPosition.isAtSamePosition(t))&&(n.endPosition.isExistBefore(i)||n.endPosition.isAtSamePosition(i))||n.startPosition.isExistAfter(t)&&n.startPosition.isExistBefore(i)&&(i.isExistAfter(n.endPosition)||i.isExistBefore(n.endPosition))||n.endPosition.isExistBefore(i)&&n.endPosition.isExistAfter(t)&&(t.isExistBefore(n.startPosition)||t.isExistAfter(n.startPosition)))return!0}return!1},nm.prototype.updateRegion=function(e,t){if(this.documentHelper.editRanges.containsKey(e)){for(var i=this.documentHelper.editRanges.get(e),i=(1===i.length&&(this.documentHelper.editRanges.remove(e),i[0].removeEditRangeMark()),this.setEditableRegion(),i[0]),n=i.editRangeEnd,r=this.getParentBlock(i.paragraph),o=this.getParentBlock(n.paragraph),n=this.isSelectionInEditableRange(i),i=void 0,s=void 0,a=(this.owner.editorModule.isRemoveRevision=!0,n||(i=this.owner.selectionModule.getParagraphInfo(this.owner.selectionModule.start),s=this.owner.selectionModule.getParagraphInfo(this.owner.selectionModule.end)),[]);o!==r;){var l=o.combineWidget(this.owner.viewer),d=((o=l.previousRenderedWidget).bodyWidget.index!==l.bodyWidget.index&&a.push(l.bodyWidget),l.containerWidget.childWidgets[l.indexInOwner]);this.removeDuplicateCollection(d),l.containerWidget.removeChild(l.indexInOwner)}if(!_.isNullOrUndefined(r)){var h=r.index,c=r.containerWidget,p=(a.push(c),r.containerWidget.childWidgets.indexOf(r)),d=c.childWidgets[p],u=(c.removeChild(p),this.removeDuplicateCollection(d),[]),g=[],c=[];if(this.owner.editorModule.isPasteListUpdated=!1,this.owner.editorModule.getBlocks(JSON.parse(t),!1,g,u,c),a.length!==g.length)if(1===a.length&&a.unshift(this.owner.editorModule.splitBodyWidget(y=a[0],g[g.length-2].sectionFormat,y.childWidgets[p-1])),a.length<g.length)for(var m=1;m<g.length-1;m++){var f=new vp(this.owner.documentHelper),y=new z,v=(f.bodyWidgets.push(y),y.page=f,a.splice(m,0,y),y.index=a[m-1].index,y.sectionFormat=new Ma(y),y.sectionFormat.copyFormat(g[m].sectionFormat),a[m-1].page.index);if(this.documentHelper.insertPage(v,f),this.owner.editorModule.updateSectionIndex(a[m-1].sectionFormat,a[m-1],!0),a.length===g.length)break}for(var w=0;w<a.length;w++){for(var b=a[w],x=0,C=0,I=(w===a.length-1&&(x=h,C=p),g[w].childWidgets),k=0;k<I.length;k++)I[k].containerWidget=b,I[k].index=x,b.childWidgets.splice(C,0,I[k]),C++,x++;(o=I[I.length-1]).nextRenderedWidget&&o.nextRenderedWidget.index!==o.index&&this.updateNextBlocksIndex(o,!0),this.documentHelper.layout.layoutBodyWidgetCollection(I[0].index,b,void 0,!1)}for(var F=0;F<u.length;F++){var P=u[F];if(this.owner.editorModule.addCommentWidget(P,!1,this.owner.showComments,!1),0<P.replyComments.length)for(w=0;w<P.replyComments.length;w++)this.owner.commentReviewPane.addReply(P.replyComments[w],!1,!1)}0<c.length&&this.updateRevisionCollection(c),this.owner.trackChangesPane.updateTrackChanges();t=this.documentHelper.editRanges.get(e);n?0<t.length&&(c=this.selection.getPosition(t[0]),this.selection.selectPosition(c.endPosition,c.endPosition)):this.tranformSelection(i,s),this.tranformHistoryPosition(),this.selection.updateEditRangeCollection(),this.updateLockRegion(e),this.documentHelper.removeEmptyPages(),this.owner.viewer.updateScrollBars(),this.owner.editorModule.isRemoveRevision=!1}}},nm.prototype.updateRevisionCollection=function(e){var t=0,i=this.getRevisionTextPosition(e[0]),n=!1;if(0<this.owner.revisionsInternal.changes.length&&!_.isNullOrUndefined(i))for(var r=0;r<this.owner.revisionsInternal.changes.length;r++)if(this.getRevisionTextPosition(this.owner.revisionsInternal.changes[r]).isExistAfter(i)){t=r,n=!0;break}for(var o=0;o<e.length;o++)n?(this.owner.revisionsInternal.changes.splice(t,0,e[o]),t++):this.owner.revisionsInternal.changes.push(e[o])},nm.prototype.getRevisionTextPosition=function(e){if(0<e.range.length){e=e.range[0];if(e instanceof mh)return this.selection.getElementPosition(e).startPosition;if(e instanceof Ya){var t=e.ownerBase.firstChild.firstChild;if(t.bodyWidget)return this.selection.getTextPosBasedOnLogicalIndex(this.selection.getHierarchicalIndex(t,"0"))}else if(e instanceof B){var i,t=e.ownerBase;if(t.lastChild.paragraph.bodyWidget)return e=t.getLength(),(i=new y(this.owner)).setPositionParagraph(t.lastChild,e),i}}},nm.prototype.tranformSelection=function(e,t){this.documentHelper.skipScrollToPosition=!0;e=this.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),t=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString());this.selection.select(e,t)},nm.prototype.tranformHistoryPosition=function(){var e,t;this.documentHelper.editRanges.containsKey(this.owner.currentUser)&&(t=this.documentHelper.editRanges.get(this.owner.currentUser)[0],t=this.getParentBlock(t.paragraph),t=this.selection.getHierarchicalIndex(t,"0").split(";"),!_.isNullOrUndefined(this.lockStart))&&1<this.lockStart.length&&(e=parseInt(t[0],10)-parseInt(this.lockStart[0],10),t=parseInt(t[1],10)-parseInt(this.lockStart[1],10),this.transformHistory(e,t))},nm.prototype.transformHistory=function(e,t){if(this.owner.enableEditorHistory){var i=this.owner.editorHistoryModule.undoStack;if(!_.isNullOrUndefined(i))for(var n=0;n<i.length;n++)this.transformBaseHistoryInfo(i[n],e,t);var r=this.owner.editorHistoryModule.redoStack;if(!_.isNullOrUndefined(r))for(n=0;n<r.length;n++)this.transformBaseHistoryInfo(r[n],e,t)}},nm.prototype.transformBaseHistoryInfo=function(e,t,i){if(e.endPosition&&(e.endPosition=this.tranformPosition(e.endPosition,t,i)),e.insertPosition&&(e.insertPosition=this.tranformPosition(e.insertPosition,t,i)),e.selectionStart&&(e.selectionStart=this.tranformPosition(e.selectionStart,t,i)),e.selectionEnd&&(e.selectionEnd=this.tranformPosition(e.selectionEnd,t,i)),e instanceof qg)for(var n=e.modifiedActions,r=0;r<n.length;r++)this.transformBaseHistoryInfo(n[r],t,i)},nm.prototype.tranformPosition=function(e,t,i){e=e.split(";");return e[0]=(parseInt(e[0],10)+t).toString(),e[1]=(parseInt(e[1],10)+i).toString(),e.join(";")},nm.prototype.getParentBlock=function(e){return(e=e.isInsideTable?this.owner.documentHelper.layout.getParentTable(e):e).combineWidget(this.owner.viewer)},nm.prototype.removeDuplicateCollection=function(e){if(this.removeFieldInBlock(e,!1,!1),this.removeFieldInBlock(e,!0,!1),this.removeFieldInBlock(e,!1,!0),e instanceof K)for(var t,i=0;i<e.childWidgets.length;i++)e.childWidgets[i]instanceof dh&&(t=e.childWidgets[i],this.owner.editorModule.removeDeletedCellRevision(t));else this.owner.editorModule.removeRevisionForBlock(e,void 0,!1,!1)},nm.prototype.removeFieldInBlock=function(e,t,i){e instanceof K?this.removeFieldTable(e,t,i):(this.owner.editorModule.removeField(e,t,i),this.removeComment(e))},nm.prototype.removeFieldTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)for(var s=r.childWidgets[o],a=0;a<s.childWidgets.length;a++)this.removeFieldInBlock(s.childWidgets[a],t,i)},nm.prototype.removeComment=function(e){if(0<this.documentHelper.comments.length)for(var t=0;t<this.documentHelper.comments.length;t++){var i=this.documentHelper.comments[t];i.commentStart.line.paragraph===e&&(this.documentHelper.comments.splice(t,1),this.owner.commentReviewPane.deleteComment(i),t--)}},nm.prototype.updateNextBlocksIndex=function(e,t){var i=e.getSplitWidgets().pop().nextRenderedWidget,n=1,r=(i.bodyWidget.index===e.bodyWidget.index&&(n=e.index-i.index+1),e.containerWidget.childWidgets.indexOf(e)+1);if(e.containerWidget instanceof z)for(var o=e.containerWidget.index,s=this.documentHelper.pages.indexOf(e.containerWidget.page);s<this.documentHelper.pages.length;s++){var a=this.documentHelper.pages[s];if(a.bodyWidgets[0].index!==o)return;for(var l=r;l<a.bodyWidgets[0].childWidgets.length;l++)a.bodyWidgets[0].childWidgets[l].index+=n;r=0}},nm.prototype.updateLockRegion=function(e,t){var i;_.isNullOrUndefined(e)&&(e=this.owner.currentUser),t=!!_.isNullOrUndefined(t)||t,this.documentHelper.editRanges.containsKey(e)&&1===(i=this.documentHelper.editRanges.get(e)).length&&!_.isNullOrUndefined(i[0].editRangeEnd)&&(i=i[0],this.updateLockInfo(i.paragraph,i.editRangeEnd.paragraph,e,t))},nm.prototype.updateLockInfo=function(e,t,i,n){for(e.isInsideTable&&(e=this.documentHelper.layout.getParentTable(e)),t.isInsideTable&&(t=this.documentHelper.layout.getParentTable(t));e.lockedBy=n?i:void 0,e.locked=n,e!==t&&(e=e.nextRenderedWidget,!_.isNullOrUndefined(e))&&e;);},nm.prototype.pullAction=function(){var e,t=this;this.owner&&((e=new A).url=this.owner.serviceUrl+this.owner.serverActionSettings.getPendingActions,e.contentType="application/json;charset=UTF-8",e.onSuccess=function(e){"string"==typeof e&&(e=JSON.parse(e)),t.updateAction(JSON.parse(e.data)),C.hideSpinner(t.owner.element)},e.onFailure=this.failureHandler.bind(this),e.onError=this.failureHandler.bind(this),e.customHeaders=this.owner.headers,C.showSpinner(this.owner.element),e.send({roomName:this.collaborativeEditingSettings.roomName,version:this.version}))},nm.prototype.destroy=function(){this.owner=void 0};pl=nm;function nm(e){this.version=0,this.owner=e}Object.defineProperty(om.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),om.prototype.getModuleName=function(){return"XmlPane"},om.prototype.enableDisableElements=function(e){e?_.classList(this.element,[],["e-de-overlay"]):_.classList(this.element,["e-de-overlay"],[])},om.prototype.initializeXmlMapping=function(){var e=this,t=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale,this.documentHelper.owner.locale),i="xml_mapping_properties",n=(this.element=_.createElement("div",{id:this.documentHelper.owner.element.id+i,className:"e-de-op"}),this.createDivTemplate("_header_footer",this.element,"padding-bottom:0")),r=(_.classList(n,["e-de-cntr-pane-padding"],[]),n.style.paddingLeft="0px",_.createElement("label",{className:"e-de-prop-header-label"})),o=(r.innerHTML=t.getConstant("XML Mapping"),o=this.isRtl?"float:left;":"float:right;",_.createElement("span",{id:"_header_footer_close",className:"e-de-ctnr-close e-de-close-icon e-icons",styles:"display:inline-block;cursor:pointer;"+o})),r=(o.addEventListener("click",function(){e.onClose()}),n.appendChild(r),n.appendChild(o),this.createDivTemplate(i+"_xml",this.element)),n=(_.classList(r,["e-de-cntr-pane-padding"],[]),r.style.paddingLeft="0px",r.style.paddingRight="5px",r.style.width="275px",_.createElement("label",{className:"e-de-ctnr-prop-label",styles:"height:20px;"})),o=(n.innerHTML=t.getConstant("Custom XML Part"),r.appendChild(n),this.createDivTemplate(i+"_xmlDiv",r)),t=this.createDivTemplate(i+"_firstPageDiv",o),n=(_.classList(t,["e-de-hdr-ftr-frst-div"],[]),_.createElement("input",{id:i+"_firstPageDiv_dropdownlist",className:"e-de-prop-sub-label"})),r=(n.type="text",n.tabIndex=1,t.appendChild(n),this.positionLabelDiv=_.createElement("div",{id:i+"_positionLabelDiv",className:"e-de-scrollbar-hide",styles:"width:270px;height:310px;list-style:none;padding-right:5px;overflow:auto;"}),this.element.appendChild(this.positionLabelDiv),_.createElement("div",{id:"tree",className:"e-de-scrollbar-hide",styles:"width:270px;height:310px;list-style:none;padding-right:5px;overflow:auto;"})),o=document.createElement("ul");o.contentEditable="false",o.style.width="auto",o.className="e-list-parent e-ul",o.style.paddingLeft="0px",o.id="e-de-pane-contextmenu-list",o.style.listStyle="none",o.style.margin="0px",o.style.maxHeight="auto",o.oncontextmenu=this.disableBrowserContextmenu,this.treeviewObject=new k.TreeView({fields:this.field,cssClass:"e-de-custom-treeview"}),this.treeviewObject.appendTo(r),this.positionLabelDiv.appendChild(r),this.positionLabelDiv.appendChild(o),this.documentHelper.owner.editor.dictionaryObject[this.documentHelper.owner.editor.dictionaryObjectIndexIncrement++]={ID:"Default",Data:this.hierarchicalData},this.documentHelper.owner.editor.xmlData&&0===this.documentHelper.owner.editor.xmlData.length&&(this.documentHelper.owner.editor.xmlData=this.hierarchicalData)},om.prototype.initializeContextMenu=function(){var e={target:"#tree",items:[{text:"Insert Content control",id:"Insert",items:[{text:"Rich Text",id:"RichText"},{text:"Plain Text",id:"PlainText"},{text:"Picture",id:"Picture"},{text:"CheckBox",id:"CheckBox"},{text:"Combo Box",id:"ComboBox"},{text:"Dropdown List",id:"DropdownList"},{text:"Date Picker",id:"DatePicker"}]},{text:"Map to selected content control",id:"MapToSelectedContentControl"}],select:this.handleContextMenuItem.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this)};this.contextMenuInstance=new k.ContextMenu(e,"#e-de-pane-contextmenu-list")},om.prototype.intializeDropDownList=function(){this.dropDownListObject=new U.DropDownList({dataSource:this.DropDownListData,fields:{text:"Value",value:"ID"},text:this.DropDownListData[0].Value,select:this.handleDropDownList.bind(this)}),this.dropDownListObject.appendTo("#xml_mapping_properties_firstPageDiv_dropdownlist")},om.prototype.handleDropDownList=function(e){for(var t,i=e.item.innerText,n=0;n<this.DropDownListData.length;n++)this.dropDownListObject.dataSource[n].Value==i&&(t=this.dropDownListObject.dataSource[n].ID);if("(Add new part...)"===i)this.documentHelper.owner.prefixMappings=" ",this.handleFileSelect();else if(/(no namespace)/.test(i)){this.documentHelper.owner.prefixMappings=" ";for(n=0;n<this.documentHelper.owner.editor.dictionaryObject.length;n++)t===this.documentHelper.owner.editor.dictionaryObject[n].ID&&this.handleTreeviewObject(n)}else if("Choose an XML file"===i)this.documentHelper.owner.prefixMappings=" ",this.handleTreeviewObject(0);else{this.documentHelper.owner.prefixMappings=i;for(n=0;n<this.documentHelper.owner.editor.dictionaryObject.length;n++)t===this.documentHelper.owner.editor.dictionaryObject[n].ID&&this.handleTreeviewObject(n)}},om.prototype.handleTreeviewObject=function(e){this.treeviewObject.fields.dataSource=this.documentHelper.owner.editor.dictionaryObject[e].Data,this.treeviewObject.dataBind(),this.documentHelper.owner.editor.xmlData=this.documentHelper.owner.editor.dictionaryObject[e].Data},om.prototype.contextMenuBeforeOpen=function(e){var t=this.documentHelper.owner.editor.getContentControl(),i=this.documentHelper.owner.getImageContentControl(),n=this.treeviewObject.selectedNodes;this.treeviewObject.getNode(n[0]).hasChildren&&(e.cancel=!0),_.isNullOrUndefined(this.contextMenuInstance)||(_.isNullOrUndefined(t)&&_.isNullOrUndefined(i)?this.contextMenuInstance.enableItems(["Map to selected content control"],!1):this.contextMenuInstance.enableItems(["Map to selected content control"],!0))},om.prototype.handleContextMenuItem=function(e){var t=e.element.id;switch(t){case"RichText":case"PlainText":case"Picture":case"ComboBox":case"DropdownList":case"CheckBox":case"DatePicker":this.applyContentControl(t);break;case"MapToSelectedContentControl":var i=this.documentHelper.owner.editor.getContentControl(),n=this.documentHelper.owner.getImageContentControl();_.isNullOrUndefined(i)&&_.isNullOrUndefined(n)||(this.documentHelper.owner.isXmlMapCC=!0,this.documentHelper.owner.isXmlMapCC&&!_.isNullOrUndefined(this.documentHelper.owner.editor.xmlData.length)&&0<this.documentHelper.owner.editor.xmlData.length&&this.getXmlPath(),this.documentHelper.owner.selection.selectContentInternal(i),this.insertContent())}},om.prototype.disableBrowserContextmenu=function(){return!1},om.prototype.applyContentControl=function(e){var t=this,i=(this.documentHelper.owner.isXmlMapCC=!0,this.documentHelper.owner.isXmlMapCC&&!_.isNullOrUndefined(this.documentHelper.owner.editor.xmlData.length)&&0<this.documentHelper.owner.editor.xmlData.length&&this.getXmlPath(),this.documentHelper.owner.editor.getContentControl()),n=this.documentHelper.owner.getImageContentControl();if(_.isNullOrUndefined(i)&&_.isNullOrUndefined(n))switch(e){case"PlainText":this.documentHelper.owner.editor.insertContentControl("Text"),this.insertContent();break;case"RichText":this.documentHelper.owner.editor.insertContentControl("RichText"),this.insertContent();break;case"Picture":this.documentHelper.owner.showDialog("PictureContentControl");break;case"ComboBox":this.documentHelper.owner.editor.insertContentControl("ComboBox"),this.insertContent();break;case"DropdownList":this.documentHelper.owner.editor.insertContentControl("DropDownList"),this.insertContent();break;case"CheckBox":this.documentHelper.owner.editor.insertContentControl("CheckBox");break;case"DatePicker":this.documentHelper.owner.editor.insertContentControl("Date"),this.insertContent()}else{i=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);i.setLocale(this.documentHelper.owner.locale),this.alertDialog=C.DialogUtility.alert({title:i.getConstant("Information"),content:i.getConstant("Discard Content Control"),okButton:{text:i.getConstant("Ok")},showCloseIcon:!0,closeOnEscape:!0,animationSettings:{effect:"Zoom"},position:{X:"center",Y:"center"},close:function(){t.closeDialogUtils.bind(t)}})}},om.prototype.insertContent=function(){for(var e,t=this.treeviewObject.selectedNodes.toString(),i=1;i<this.documentHelper.owner.editor.xmlData.length;i++)t!=this.documentHelper.owner.editor.xmlData[i].id.toString()||_.isNullOrUndefined(this.documentHelper.owner.editor.xmlData[i].displayValue)||(e=this.documentHelper.owner.editor.xmlData[i].displayValue.toString(),this.documentHelper.owner.editor.insertText(e));this.documentHelper.owner.isXmlMapCC=!1},om.prototype.getXmlPath=function(){for(var e=this.treeviewObject.selectedNodes.toString(),t="",i=Number(e)-1,n=this.documentHelper.owner.editor.xmlData.length-1;0<=n;n--)_.isNullOrUndefined(this.documentHelper.owner.editor.xmlData[i])||this.documentHelper.owner.editor.xmlData[i].pid!=this.documentHelper.owner.editor.xmlData[n].id.toString()||(t="\\"+this.documentHelper.owner.editor.xmlData[n].displayText+"[1]\\"+t,i=n);e=Number(e)-1;this.documentHelper.owner.editor.xmlData[e]&&(t=t+this.documentHelper.owner.editor.xmlData[e].displayText.toString()+"[1]",this.documentHelper.owner.xPathString=t)},om.prototype.closeDialogUtils=function(){this.alertDialog.close(),this.alertDialog=void 0},om.prototype.createDivTemplate=function(e,t,i){i=i?_.createElement("div",{id:e,styles:i}):_.createElement("div",{id:e});return t.appendChild(i),i},om.prototype.onFileSelect=function(e){var i=this,n=new FileReader;n.onload=function(){var e=n.result,e=(i.documentHelper.owner.editor.getPrefixMapping(e),i.documentHelper.owner.editor.parseXml(e)),t=i.documentHelper.owner.editor.objectToArray(e);i.documentHelper.owner.editor.setXmlData(e,t),i.addingNewFileToDropDownList()},n.readAsText(e)},om.prototype.addingNewFileToDropDownList=function(){1==this.documentHelper.owner.editor.XMLFilesNameSpaceCount&&null==this.documentHelper.owner.prefixMappings?(this.DropDownListData.splice(this.DropDownListData.length-1,0,{ID:"(no namespace)_"+this.documentHelper.owner.editor.XMLFilesCount,Value:"(no namespace)"}),this.documentHelper.owner.editor.XMLFilesNameSpaceCount++):1<this.documentHelper.owner.editor.XMLFilesNameSpaceCount&&null==this.documentHelper.owner.prefixMappings?(this.DropDownListData.splice(this.DropDownListData.length-1,0,{ID:"(no namespace)_"+this.documentHelper.owner.editor.XMLFilesCount,Value:"(no namespace) ("+this.documentHelper.owner.editor.XMLFilesNameSpaceCount+")"}),this.documentHelper.owner.editor.XMLFilesNameSpaceCount++):this.documentHelper.owner.prefixMappings&&this.DropDownListData.splice(this.DropDownListData.length-1,0,{ID:"(no namespace)_"+this.documentHelper.owner.editor.XMLFilesCount,Value:this.documentHelper.owner.prefixMappings}),this.dropDownListObject.dataSource=this.DropDownListData,this.dropDownListObject.refresh(),this.dropDownListObject.value=null,this.dropDownListObject.text=this.DropDownListData[0].Value,this.documentHelper.owner.editor.XMLFilesCount++},om.prototype.showXmlProperties=function(e){(this.isXmlPaneShow=e)?(this.localeValue=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localeValue.setLocale(this.documentHelper.owner.locale),_.isNullOrUndefined(om)||(this.initializeXmlMapping(),this.documentHelper.owner.enableRtl,this.documentHelper.optionsPaneContainer.insertBefore(this.documentHelper.owner.xmlPaneModule.element,this.documentHelper.viewerContainer),this.documentHelper.owner.isXmlPaneTool=!0),this.documentHelper.owner.resize(),e&&!this.contextMenuInstance&&(this.initializeContextMenu(),this.intializeDropDownList()),this.documentHelper.updateViewerSize()):(this.documentHelper.updateViewerSize(),_.isNullOrUndefined(this.element)||"none"!==this.element.style.display&&(this.element.style.display="none"),this.destroyInternal(),this.documentHelper.owner.isXmlPaneTool=!1,this.documentHelper.owner.triggerResize())},om.prototype.destroyInternal=function(){this.treeviewObject&&(this.treeviewObject.destroy(),this.treeviewObject=void 0),this.contextMenuInstance&&(this.contextMenuInstance.destroy(),this.contextMenuInstance=void 0),this.positionLabelDiv&&(this.positionLabelDiv.innerHTML="",this.positionLabelDiv=void 0),this.dropDownListObject&&(this.dropDownListObject.destroy(),this.dropDownListObject=void 0),this.element&&(this.element.innerHTML="",this.element.parentElement)&&this.element.parentElement.removeChild(this.element),this.element=void 0},om.prototype.destroy=function(){this.treeviewObject&&(this.treeviewObject.destroy(),this.treeviewObject=void 0),this.contextMenuInstance&&(this.contextMenuInstance.destroy(),this.contextMenuInstance=void 0),this.positionLabelDiv&&(this.positionLabelDiv.innerHTML="",this.positionLabelDiv=void 0),this.dropDownListObject&&(this.dropDownListObject.destroy(),this.dropDownListObject=void 0),this.element&&(this.element.innerHTML="",this.element.parentElement)&&this.element.parentElement.removeChild(this.element),this.element=void 0,this.documentHelper=void 0};var rm=om;function om(e,t){var i=this;this.isXmlPaneShow=!1,this.contextMenuInstance=void 0,this.DropDownListData=[{ID:"Choose",Value:"Choose an XML file"},{ID:"Add",Value:"(Add new part...)"}],this.hierarchicalData=[],this.field={dataSource:this.hierarchicalData,id:"id",text:"displayText",hasChildren:"hasChild",value:"displayValue",parentID:"pid",tooltip:"tooltip"},this.handleFileSelect=function(){var e=document.createElement("input");e.type="file",e.accept=".xml",e.onchange=function(e){var e=e.target;e.files&&0<e.files.length&&(e=e.files[0],i.onFileSelect(e))},e.click()},this.onClose=function(){i.showXmlProperties(!1),i.documentHelper.owner.selectionModule.closeXmlPane(),i.documentHelper.owner.documentEditorSettings.showNavigationPane=!1,i.documentHelper.updateFocus(),i.destroyInternal()},this.documentHelper=e,this.isRtl=t}am.prototype.find=function(e,t){return this.findNext(e,t,"0;0;0")},am.prototype.findNext=function(e,t,i){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===i&&(i="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var n=this.owner.searchModule.textSearchResults;return this.findDocument(n,e,!0,t,i),n.length,n.currentSearchResult},am.prototype.stringToRegex=function(e,t){if(-1<(e=-1<e.indexOf("\\")?e.split("\\").join("\\\\"):e).indexOf("(")||-1<e.indexOf(")")||-1<e.indexOf(".")||-1<e.indexOf("[")||-1<e.indexOf("]")||-1<e.indexOf("$")||-1<e.indexOf("{")||-1<e.indexOf("}")||-1<e.indexOf("*")||-1<e.indexOf("|")||-1<e.indexOf("^")||-1<e.indexOf("?")||-1<e.indexOf("+")){for(var i="",n=0;n<e.length;n++)"("===e[parseInt(n.toString(),10)]||")"===e[parseInt(n.toString(),10)]||"."===e[parseInt(n.toString(),10)]||"["===e[parseInt(n.toString(),10)]||"]"===e[parseInt(n.toString(),10)]||"$"===e[parseInt(n.toString(),10)]||"{"===e[parseInt(n.toString(),10)]||"}"===e[parseInt(n.toString(),10)]||"*"===e[parseInt(n.toString(),10)]||"|"===e[parseInt(n.toString(),10)]||"^"===e[parseInt(n.toString(),10)]||"?"===e[parseInt(n.toString(),10)]||"+"===e[parseInt(n.toString(),10)]?i+="\\"+e[parseInt(n.toString(),10)]:i+=e[parseInt(n.toString(),10)];e=i}return"WholeWord"!==t&&"CaseSensitiveWholeWord"!==t||(e=this.wordBefore+e+this.wordAfter),RegExp(e,"CaseSensitive"===t||"CaseSensitiveWholeWord"===t?"g":"ig")},am.prototype.isPatternEmpty=function(e){var t=this.wordBefore+this.wordAfter,e=e.toString();return 0===e.length||e===t},am.prototype.findAll=function(e,t,i){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===i&&(i="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var n=this.owner.searchModule.textSearchResults;if(this.findDocument(n,e,!1,t,i),0<n.length&&n.currentIndex<0&&(n.currentIndex=0),!_.isNullOrUndefined(n.currentSearchResult))return e={source:this.documentHelper.owner},this.documentHelper.owner.trigger(Ce,e),n},am.prototype.getElementInfo=function(e,t,i,n,r,o,s,a,l){var d=e,h="",c=new T,p=0;do{if(e instanceof X&&!_.isNullOrUndefined(e.text)&&""!==e.text?(c.add(e,l?h.length+p:h.length),p=0,h+=e===d?e.text.substring(t):e.text):e instanceof Z?(u=e,_.isNullOrUndefined(u.fieldEnd)||(e=_.isNullOrUndefined(u.fieldSeparator)?u.fieldEnd:u.fieldSeparator)):e instanceof uc&&!_.isNullOrUndefined(e.textFrame)&&0<e.textFrame.childWidgets.length&&this.findInlineText(e.textFrame,n,r,o,s,a),e instanceof X||(p+=e.length),!_.isNullOrUndefined(e)&&_.isNullOrUndefined(e.nextNode)){var u=e.paragraph.nextSplitWidget;if(!l&&!_.isNullOrUndefined(u)&&u!==e.paragraph&&0<u.childWidgets.length&&u.childWidgets[0]instanceof uh&&0<u.childWidgets[0].children.length){e=u.childWidgets[0].children[0];continue}break}if(!_.isNullOrUndefined(e)){if(!_.isNullOrUndefined(i)&&!i){var g=e.line.children,m=e.line.children.length;if(!(g.indexOf(e)<m-1)){e=void 0;break}}e=e.nextNode}}while(1);return{elementsWithOffset:c,fullText:h.toString()}},am.prototype.updateMatchedTextLocation=function(e,t,i,n,r,o,s,a){for(var l=0;l<e.length;l++){var d=e[parseInt(l.toString(),10)],h=void 0;if(_.isNullOrUndefined(a)||!(d.index<a)){for(var c=t.addResult(),p=i.keys,u=!1,g=0;g<p.length;g++){var m=p[parseInt(g.toString(),10)],f=i.get(m),y=m.length;if(m===r&&(y-=n),_.isNullOrUndefined(c.start)&&d.index<f+y&&(v=d.index-f,m===r&&(v+=n),b=m.line.getOffset(m,v),c.start=this.getTextPosition(m.line,b.toString()),c.start.location=this.owner.selectionModule.getPhysicalPositionInternal(m.line,b,!0),c.start.setPositionParagraph(m.line,b)),d.index+d[0].length<=f+y){var v=d.index+d[0].length-f;if(m===r&&(v+=n),(_.isNullOrUndefined(this.owner.searchModule.textSearchResults)||0===this.owner.searchModule.textSearchResults.length)&&" "!==m.text.charAt(m.text.length-1)&&!_.isNullOrUndefined(m.nextElement)&&(m.nextElement instanceof J||m.nextElement instanceof up)){for(var w=m.nextElement;w&&!((w=w.nextElement)instanceof X););if(w&&w instanceof X&&" "!==w.text.charAt(0)){u=!0;continue}}var b=0;b=(u=(_.isNullOrUndefined(this.owner.searchModule.textSearchResults)||0===this.owner.searchModule.textSearchResults.length)&&m.previousElement&&(m.previousElement instanceof J||m.previousElement instanceof up)?!0:u)?m.line.getOffset(m,0)+m.length:m.line.getOffset(m,v),c.end=this.getTextPosition(m.line,b.toString()),c.end.location=this.owner.selectionModule.getPhysicalPositionInternal(m.line,b,!0),c.end.setPositionParagraph(m.line,b),h=!0;break}}if(o){t.currentIndex=0;break}if(t.currentIndex<0&&!_.isNullOrUndefined(s)&&(s.isExistBefore(c.start)||s.isAtSamePosition(c.start))&&(t.currentIndex=t.indexOf(c)),!_.isNullOrUndefined(a)&&h)break}}},am.prototype.findDocument=function(e,t,i,n,r){if(!this.isPatternEmpty(t)){void 0===n&&(n="None");var o,s=void 0,a=void 0;if(void 0!==r&&(a=this.owner.selectionModule.end),void 0!==r&&i&&void 0!==a&&void 0!==a.paragraph&&a.paragraph instanceof G){var r=a.currentWidget.getInline(this.owner.selectionModule.start.offset,0);if(s=r.element,r=r.index,!_.isNullOrUndefined(s)){for(var l=void 0,l=this.findInline(s,t,n,r,i,e,a);0===e.length&&!_.isNullOrUndefined(l);){for(;!_.isNullOrUndefined(l)&&0===l.childWidgets.length;)l=this.owner.selectionModule.getNextParagraph(l.containerWidget);if(_.isNullOrUndefined(l))break;var d=l.childWidgets[0],s=d.children[0]instanceof Y?d.children[2]instanceof X?d.children[2]:void 0:d.children[0];if(_.isNullOrUndefined(s))break;l=this.findInline(s,t,n,0,i,e,a)}if(0<e.length)return}}for(o=this.documentHelper.pages[0].bodyWidgets[0];!_.isNullOrUndefined(o)&&0===o.childWidgets.length;)o=o.nextWidget;if(!_.isNullOrUndefined(o)&&0!==o.childWidgets.length){this.findInlineText(o,t,n,i,e,a);for(var h=this.documentHelper.headersFooters,c=0;c<h.length;c++){var p=h[parseInt(c.toString(),10)];if(p)for(var u in p)Object.prototype.hasOwnProperty.call(p,u)&&(u=p[parseInt(u.toString(),10)],_.isNullOrUndefined(u)||_.isNullOrUndefined(u.page)||this.findInlineText(u,t,n,i,e,a))}for(var g=this.documentHelper.endnoteCollection,c=0;c<g.length;c++){var m=g[parseInt(c.toString(),10)];!m||_.isNullOrUndefined(m)||_.isNullOrUndefined(m.bodyWidget.page)||this.findInlineText(m.bodyWidget,t,n,i,e,a)}for(var f=this.documentHelper.footnoteCollection,c=0;c<f.length;c++){var y=f[parseInt(c.toString(),10)];!y||_.isNullOrUndefined(y)||_.isNullOrUndefined(y.bodyWidget.page)||this.findInlineText(y.bodyWidget,t,n,i,e,a)}i&&!_.isNullOrUndefined(e)&&e.length}}},am.prototype.findInlineText=function(e,t,i,n,r,o){for(var s=this.owner.documentHelper.getFirstParagraphBlock(e.childWidgets[0]);!_.isNullOrUndefined(s)&&1===s.childWidgets.length&&0===s.childWidgets[0].children.length;)s=this.owner.selectionModule.getNextParagraphBlock(s);for(;!_.isNullOrUndefined(s)&&0<s.childWidgets.length;){var a=s.childWidgets[0].children[0];if(_.isNullOrUndefined(a))break;for(this.findInline(a,t,i,0,n,r,o),s=this.owner.selectionModule.getNextParagraphBlock(s);!_.isNullOrUndefined(s)&&(1===s.childWidgets.length&&0===s.childWidgets[0].children.length||!_.isNullOrUndefined(s.previousSplitWidget));)s=this.owner.selectionModule.getNextParagraphBlock(s)}n&&!_.isNullOrUndefined(r)&&r.length},am.prototype.findInline=function(e,t,i,n,r,o,s){for(var a,l=e,i=this.getElementInfo(e,n,void 0,t,i,r,o,s),d=i.fullText,h=[],i=i.elementsWithOffset;!_.isNullOrUndefined(a=t.exec(d));)h.push(a);if(this.updateMatchedTextLocation(h,o,i,n,l,r,s),!r)return this.owner.selectionModule.getNextParagraphBlock(e.line.paragraph)},am.prototype.getTextPosition=function(e,t){var i=new y(this.owner),e=i.getHierarchicalIndex(e,t);return i.setPositionForCurrentIndex(e),i};var sm=am;function am(e){this.wordBefore="\\b",this.wordAfter="\\b",this.owner=e,this.documentHelper=this.owner.documentHelper}Object.defineProperty(dm.prototype,"left",{get:function(){return this.leftInternal},set:function(e){this.leftInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(dm.prototype,"width",{get:function(){return this.widthInternal},set:function(e){this.widthInternal=e},enumerable:!0,configurable:!0});var lm=dm;function dm(e,t){this.leftInternal=0,this.widthInternal=0,this.leftInternal=e,this.widthInternal=t}Object.defineProperty(cm.prototype,"start",{get:function(){return this.startIn},set:function(e){this.startIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(cm.prototype,"end",{get:function(){return this.endIn},set:function(e){this.endIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(cm.prototype,"text",{get:function(){return this.documentHelper.selection.getTextInternal(this.start,this.end,!1)},enumerable:!0,configurable:!0}),cm.prototype.destroy=function(){this.start=void 0,this.end=void 0};var hm=cm;function cm(e){this.startIn=void 0,this.endIn=void 0,this.owner=e,this.documentHelper=this.owner.documentHelper}Object.defineProperty(um.prototype,"length",{get:function(){return void 0===this.innerList?0:this.innerList.length},enumerable:!0,configurable:!0}),Object.defineProperty(um.prototype,"currentSearchResult",{get:function(){if(!(void 0===this.innerList||this.currentIndex<0||this.currentIndex>=this.length))return this.innerList[this.currentIndex]},enumerable:!0,configurable:!0}),um.prototype.addResult=function(){var e=new hm(this.owner);return _.isNullOrUndefined(this.innerList)&&(this.innerList=[]),this.innerList.push(e),e},um.prototype.clearResults=function(){if(this.currentIndex=-1,!_.isNullOrUndefined(this.innerList))for(var e=this.innerList.length-1;0<=e;e--)this.innerList[parseInt(e.toString(),10)].destroy(),this.innerList.splice(e,1)},um.prototype.indexOf=function(e){return _.isNullOrUndefined(this.innerList)?-1:this.innerList.indexOf(e)},um.prototype.destroy=function(){_.isNullOrUndefined(this.innerList)||this.clearResults(),this.innerList=void 0};var pm=um;function um(e){this.currentIndex=-1,this.owner=e}Object.defineProperty(mm.prototype,"length",{get:function(){return this.searchModule.textSearchResults.length},enumerable:!0,configurable:!0}),Object.defineProperty(mm.prototype,"index",{get:function(){return this.searchModule.textSearchResults.currentIndex},set:function(e){0===this.length||e<0||e>this.searchModule.textSearchResults.length-1||(this.searchModule.textSearchResults.currentIndex=e,this.navigate())},enumerable:!0,configurable:!0}),mm.prototype.getTextSearchResultsOffset=function(){for(var e,t=[],i=0;i<this.searchModule.textSearchResults.innerList.length;i++)e=this.getOffset(this.searchModule.textSearchResults.innerList[parseInt(i.toString(),10)]),t.push(e);return t},mm.prototype.getOffset=function(e){var t=e.start,e=e.end,t=this.searchModule.documentHelper.owner.selectionModule.getParagraphInfo(t),i=this.searchModule.documentHelper.owner.selectionModule.getHierarchicalIndex(t.paragraph,t.offset.toString()),t=this.searchModule.documentHelper.owner.selectionModule.getParagraphInfo(e);return{startOffset:i,endOffset:this.searchModule.documentHelper.owner.selectionModule.getHierarchicalIndex(t.paragraph,t.offset.toString())}},mm.prototype.getModuleName=function(){return"SearchResults"},mm.prototype.replace=function(e){-1!==this.index&&this.searchModule.replaceInternal(e)},mm.prototype.replaceAll=function(e){-1!==this.index&&this.searchModule.replaceAllInternal(e)},mm.prototype.navigate=function(){this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult),this.searchModule.highlight(this.searchModule.textSearchResults)},mm.prototype.clear=function(){this.searchModule.textSearchResults.clearResults(),this.searchModule.clearSearchHighlight(),this.searchModule.viewer.renderVisiblePages()};var gm=mm;function mm(e){this.searchModule=e}Object.defineProperty(ym.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(ym.prototype,"searchResults",{get:function(){return this.searchResultsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(ym.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),ym.prototype.getModuleName=function(){return"Search"},ym.prototype.find=function(e,t){_.isNullOrUndefined(t)&&(t="None");e=this.textSearch.find(e,t);_.isNullOrUndefined(e)||this.navigate(e)},ym.prototype.findAll=function(e,t){_.isNullOrUndefined(e||""===e)||(_.isNullOrUndefined(t)&&(t="None"),e=this.textSearch.findAll(e,t),!_.isNullOrUndefined(e)&&0<e.length&&(this.navigate(e.innerList[e.currentIndex]),this.highlight(e)))},ym.prototype.replace=function(e,t,i){if(_.isNullOrUndefined(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||!this.viewer.owner.editorModule.canEditContentControl||_.isNullOrUndefined(i))return 0;_.isNullOrUndefined(this.viewer)||this.clearSearchHighlight(),this.navigate(t);var n=this.documentHelper.selection.start;if(this.owner.enableTrackChanges&&this.documentHelper.selection.start.currentWidget&&0<this.documentHelper.selection.end.currentWidget.getInline(this.owner.selectionModule.start.offset,0).element.revisions.length&&(this.isRepalceTracking=!0),i.indexOf(t)<0)return 0;this.owner.editorModule.insertTextInternal(e,!0);var i=t.end,t=new y(this.viewer.owner),r=(0===i.currentWidget.children.length?(r=i.currentWidget.paragraph.childWidgets[0],t.setPositionParagraph(r,n.offset-e.length)):t.setPositionParagraph(i.currentWidget,n.offset-e.length),this.documentHelper.selection.selectRange(n,t),{source:this.viewer.owner});return this.viewer.owner.trigger(Ce,r),1},ym.prototype.replaceInternal=function(e,t){var i,n,r;""===e||_.isNullOrUndefined(e)||(_.isNullOrUndefined(t)&&(t="None"),i=this.textSearchResults.currentSearchResult.text,r=this.viewer.owner.searchModule.textSearch.stringToRegex(i,t),n=this.owner.selectionModule.end.getHierarchicalIndexInternal(),r=this.viewer.owner.searchModule.textSearch.findNext(r,t,n),!_.isNullOrUndefined(r)&&(this.navigate(r),this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=r,this.replace(e,r,this.textSearchResults),n=this.owner.selectionModule.end.getHierarchicalIndexInternal(),r=this.textSearch.findNext(i,t,n))&&(this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=r,this.navigate(r)))},ym.prototype.replaceAll=function(e,t){if(this.documentHelper.layout.isReplacingAll=!0,_.isNullOrUndefined(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||_.isNullOrUndefined(t))return 0;this.owner.editorHistoryModule&&this.owner.editorHistoryModule.initComplexHistory(this.owner.selectionModule,"ReplaceAll");for(var i=t.length,n=(this.viewer.owner.isLayoutEnabled=!1,t.innerList[0].text),r=i-1;0<=r;r--){var o,s=t.innerList[parseInt(r.toString(),10)];0===s.start.currentWidget.children.length?r=(t=this.textSearch.findAll(n)).length:(this.navigate(s),!this.viewer.owner.isReadOnlyMode&&this.viewer.owner.editorModule.canEditContentControl&&(o=!0,0<r&&t.innerList[r-1].start.paragraph.equals(s.start.paragraph)&&(o=!1),this.owner.editorModule.insertTextInternal(e,!0,void 0,o),s.destroy()))}return this.owner.editorHistoryModule&&!_.isNullOrUndefined(this.owner.editorHistoryModule.currentHistoryInfo)?this.owner.editorHistoryModule.updateComplexHistory():this.owner.editorModule.updateComplexWithoutHistory(2),this.searchResults.clear(),this.documentHelper.layout.isReplacingAll=!1,i},ym.prototype.replaceAllInternal=function(e,t){_.isNullOrUndefined(e)||(_.isNullOrUndefined(t)&&(t="None"),0<this.textSearchResults.length&&(this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]),this.highlight(this.textSearchResults),this.replaceAll(e,this.textSearchResults)))},ym.prototype.navigate=function(e){var t;e&&(t=e.start,e=e.end,_.isNullOrUndefined(this.owner)||_.isNullOrUndefined(this.owner.selectionModule)||_.isNullOrUndefined(t)||_.isNullOrUndefined(e)||_.isNullOrUndefined(t.paragraph)||_.isNullOrUndefined(e.paragraph)||(this.owner.selectionModule.selectRange(t,e),this.documentHelper.updateFocus()))},ym.prototype.highlight=function(e){this.searchHighlighters=new T;for(var t=0;t<e.innerList.length;t++){var i=e.innerList[parseInt(t.toString(),10)];this.highlightResult(i)}this.viewer.renderVisiblePages()},ym.prototype.highlightResult=function(e){this.highlightSearchResult(e.start.paragraph,e.start,e.end)},ym.prototype.highlightSearchResult=function(e,t,i){var n,r,t=this.documentHelper.selection.getStartLineWidget(e,t,null,0),o=t.index,s=(n=t.element)?n.line:e.childWidgets[0],t=this.documentHelper.selection.getEndLineWidget(i,null,0),a=t.index,l=(r=t.element)?r.line:i.paragraph.childWidgets[i.paragraph.childWidgets.length-1],d=this.documentHelper.selection.getTop(s),h=this.documentHelper.selection.getLeftInternal(s,n,o);if(_.isNullOrUndefined(s)||s!==l){if(!_.isNullOrUndefined(s)){e!==s.paragraph&&(e=s.paragraph);m=this.documentHelper.selection.getWidth(s,!0)-(h-s.paragraph.x);if(e.bidi||n instanceof X&&n.isRightToLeft){var c=0,p=this.documentHelper.selection.getElementsForward(s,n,r,e.bidi);if(p)for(v=!1,g=0;g<p.length;g++){w=(y=p[g])instanceof X?y.length:1;c=this.documentHelper.selection.getLeftInternal(s,y,w),v=!1,h=y===n?this.documentHelper.selection.getLeftInternal(s,y,o):this.documentHelper.selection.getLeftInternal(s,y,0),y instanceof X&&(v=y.isRightToLeft),m=Math.abs(c-h),this.createHighlightBorder(s,m,v?c:h,d)}}else this.createHighlightBorder(s,m,h,d);for(var u=s.paragraph.childWidgets.indexOf(s),g=0;g<e.childWidgets.length;g++){if(e===s.paragraph&&(u+=1),this.highlightSearchResultParaWidget(e,u,l,r,a),e===l.paragraph)return;u=0,e=l.paragraph,g--}}}else{var c=this.documentHelper.selection.getLeftInternal(l,r,a),t=!1,m=(r instanceof X&&(t=r.isRightToLeft),0);if(m=Math.abs(c-h),(t=!t&&n instanceof X?n.isRightToLeft:t)||e.bidi){var f=this.documentHelper.selection.getElementsForward(s,n,r,e.bidi);if(f&&1<f.length)for(var g=0;g<f.length;g++){var y,v=!1,w=(y=f[g])instanceof X?y.length:1;c=y===n?(h=this.documentHelper.selection.getLeftInternal(s,y,o),this.documentHelper.selection.getLeftInternal(s,y,w)):y===r?(h=this.documentHelper.selection.getLeftInternal(s,y,0),this.documentHelper.selection.getLeftInternal(s,y,a)):(h=this.documentHelper.selection.getLeftInternal(s,y,0),this.documentHelper.selection.getLeftInternal(s,y,w)),y instanceof X&&(v=y.isRightToLeft),m=Math.abs(c-h),this.createHighlightBorder(s,m,v?c:h,d)}else this.createHighlightBorder(s,m,t?c:h,d)}else this.createHighlightBorder(s,m,h,d)}},ym.prototype.createHighlightBorder=function(e,t,i,n){var r=this.addSearchHighlightBorder(e),o=this.viewer.owner.selectionModule.getPage(e.paragraph);o.boundingRectangle.y,o.boundingRectangle.x,r.left=Math.ceil(i),r.width=Math.floor(t),Math.floor(e.height),this.documentHelper.containerContext},ym.prototype.addSearchHighlightBorder=function(e){var t=void 0,i=this.searchHighlighters,i=(i.containsKey(e)?t=i.get(e):i.add(e,t=[]),new lm(0,0));return t.push(i),i},ym.prototype.highlightSearchResultParaWidget=function(e,t,i,n,r){for(var o=0,s=0,a=!1,l=t;l<e.childWidgets.length;l++){var d=e.childWidgets[l],h=(l===t&&(o=this.documentHelper.selection.getTop(d)),this.documentHelper.selection.getLeft(d));if(n instanceof X&&(a=n.isRightToLeft),d===i){var c=0;if(a||e.bidi){for(var p=this.documentHelper.selection.getElementsBackward(d,n,n,e.bidi),u=0;u<p.length;u++){var g,m=p[u],f=!1,h=this.documentHelper.selection.getLeftInternal(d,m,0);c=m===n?this.documentHelper.selection.getLeftInternal(d,m,r):(g=m instanceof X?m.length:1,this.documentHelper.selection.getLeftInternal(d,m,g)),m instanceof X&&(f=m.isRightToLeft),s=Math.abs(c-h),this.createHighlightBorder(d,s,f?c:h,o)}return}return c=this.documentHelper.selection.getLeftInternal(i,n,r),s=Math.abs(c-h),void this.createHighlightBorder(d,s,a?c:h,o)}s=this.documentHelper.selection.getWidth(d,!0)-(h-e.x),this.createHighlightBorder(d,s,h,o),o+=d.height}},ym.prototype.addSearchResultItems=function(e){_.isNullOrUndefined(e)||""===e||(_.isNullOrUndefined(this.owner.findResultsList)&&(this.owner.findResultsList=[]),this.owner.findResultsList.push(e))},ym.prototype.addFindResultView=function(e){for(var t=0;t<e.innerList.length;t++){var i=e.innerList[t];this.addFindResultViewForSearch(i)}},ym.prototype.addFindResultViewForSearch=function(e){if(null!=e.start&&null!=e.end&&null!=e.start.paragraph&&null!=e.end.paragraph){var t=void 0,i=0,n=e.start.currentWidget.getInline(e.start.offset,i),r=n.element,o=(i=n.index,""),s=0,n=(r instanceof Z&&(r=(n=this.owner.selectionModule.getRenderedInline(r,i)).element.nextNode instanceof X?n.element.nextNode:n.element,i=n.index),this.owner.selectionModule.getElementBoxInternal(r,i)),a=n.element;if(i=n.index,null!=a){a instanceof X&&0<i&&(o=a.text.substring(0,i));for(var l=a.line.children.indexOf(a),s=o.lastIndexOf(" ");s<0&&0<l&&a.line.children[l-1]instanceof X;)o=a.line.children[l-1].text+o,l--,s=o.lastIndexOf(" ")}var r=o.lastIndexOf("\v"),i=(0<r?o=o.substring(0,r):(s=o.lastIndexOf(" "))<0||o.substring(s+1),e.text,0),r=e.end.currentWidget.getInline(e.end.offset,i),d=r.element,i=r.index,t="";if(null!=n&&(a=(n=this.owner.selectionModule.getElementBoxInternal(d,i)).element,i=n.index),null!=a){a instanceof X&&i<a.length&&(t=a.text.substring(i));for(l=a.line.children.indexOf(a);l+1<a.line.children.length&&a.line.children[l+1]instanceof X||a.line.children[l+1]instanceof Z;)a.line.children[l+1]instanceof Z?l+=2:(t+=a.line.children[l+1].text,l+=1)}s=t.lastIndexOf(" "),t="\v"===t?"":t;r="",d="",n=e.start.paragraph.containerWidget,i=n instanceof Xd?n.headerFooterType:"";-1!=i.indexOf("Header")?r='<span class="e-de-header-footer-list">Header: </span>':-1!=i.indexOf("Footer")&&(d='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+r+o+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+t+"</li>",r='<span class="e-de-header-footer-list">Footer: </span>'),d='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+r+o+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+t+"</li>",this.addSearchResultItems(d)}},ym.prototype.clearSearchHighlight=function(){_.isNullOrUndefined(this.searchHighlighters)||(this.searchHighlighters.clear(),this.searchHighlighters=void 0);var e={source:this.viewer.owner};this.viewer.owner.trigger(Ce,e)},ym.prototype.destroy=function(){this.textSearchResults&&this.textSearchResults.destroy(),this.textSearchResults=void 0,this.owner=void 0};var fm=ym;function ym(e){this.searchHighlighters=void 0,this.owner=e,this.searchHighlighters=new T,this.textSearch=new sm(this.owner),this.textSearchResults=new pm(this.owner),this.searchResultsInternal=new gm(this)}Object.defineProperty(wm.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),wm.prototype.getModuleName=function(){return"OptionsPane"},wm.prototype.initOptionsPane=function(e,t){this.viewer;this.localeValue=e,this.optionsPane=_.createElement("div",{className:"e-de-op",styles:"display:none;"}),this.optionsPane.addEventListener("keydown",this.onKeyDownOnOptionPane),this.findTab=_.createElement("div",{id:this.documentHelper.owner.containerId+"_findTabDiv",className:"e-de-op-tab"}),this.optionsPane.appendChild(this.findTab),this.searchDiv=_.createElement("div",{className:"e-de-op-header",innerHTML:e.getConstant(this.searchText)}),this.findTab.appendChild(this.searchDiv),this.closeButton=_.createElement("button",{className:"e-de-op-close-button e-de-close-icon e-de-op-icon-btn e-btn e-flat e-icon-btn",id:"close",attrs:{type:"button"}}),this.closeButton.setAttribute("aria-label",e.getConstant("Close")),this.findTab.appendChild(this.closeButton);var i=_.createElement("span",{className:"e-de-op-close-icon e-de-close-icon e-btn-icon e-icons"}),i=(this.closeButton.appendChild(i),this.focusedElement.push(this.closeButton),this.tabDiv=_.createElement("div"),this.findTab.appendChild(this.tabDiv),this.findTabButton=_.createElement("div",{innerHTML:e.getConstant(this.findPaneText)}),this.replaceTabButton=_.createElement("div",{innerHTML:e.getConstant(this.replacePaneText)}),this.headingTabButton=_.createElement("div",{innerHTML:e.getConstant(this.headingPaneText)}),[{header:{text:this.headingTabButton}},{header:{text:this.findTabButton}},{header:{text:this.replaceTabButton}}]),i=(this.tabInstance=new k.Tab({items:i,enableRtl:t,selected:this.selectedTabItem.bind(this)}),this.tabInstance.isStringTemplate=!0,this.tabInstance.appendTo(this.tabDiv),this.findTabContentDiv=_.createElement("div",{className:"e-de-search-tab-content",styles:"display:none;"}),this.findTab.appendChild(this.findTabContentDiv),this.searchTextBoxContainer=_.createElement("div",{className:"e-input-group e-de-op-input-group"}),this.findTabContentDiv.appendChild(this.searchTextBoxContainer),this.searchInput=_.createElement("input",{className:"e-input e-de-search-input",id:this.documentHelper.owner.containerId+"_option_search_text_box",attrs:{placeholder:e.getConstant("Search for")}}),this.searchTextBoxContainer.appendChild(this.searchInput),this.searchIcon=_.createElement("span",{className:"e-de-op-icon e-de-op-search-icon e-input-group-icon e-icon",id:this.documentHelper.owner.containerId+"_search-icon"}),this.searchIcon.tabIndex=0,this.searchTextBoxContainer.appendChild(this.searchIcon),this.focusedElement.push(this.searchIcon),this.navigateToPreviousResult=_.createElement("span",{className:"e-de-op-icon e-de-op-nav-btn e-arrow-up e-spin-up e-btn-icon e-icon e-input-group-icon"}),this.navigateToPreviousResult.tabIndex=0,this.searchTextBoxContainer.appendChild(this.navigateToPreviousResult),this.focusedElement.push(this.navigateToPreviousResult),this.navigateToNextResult=_.createElement("span",{className:"e-de-op-icon e-de-op-nav-btn e-arrow-down e-spin-down e-btn-icon e-icon e-input-group-icon"}),this.navigateToNextResult.tabIndex=0,this.searchTextBoxContainer.appendChild(this.navigateToNextResult),this.focusedElement.push(this.navigateToNextResult),this.checkboxDiv=_.createElement("div",{className:"e-de-op-more-less",styles:"display:none"}),this.matchInput=_.createElement("input",{attrs:{type:"checkbox"},id:this.documentHelper.owner.containerId+"_matchCase"}),this.checkboxDiv.appendChild(this.matchInput),this.matchCase=new H.CheckBox({label:e.getConstant("Match case"),enableRtl:t,checked:!1,change:this.matchChange.bind(this)}),this.matchCase.appendTo(this.matchInput),this.focusedElement.push(this.matchInput),this.matchInput.tabIndex=0,this.wholeInput=_.createElement("input",{attrs:{type:"checkbox"},id:this.documentHelper.owner.containerId+"_wholeWord"+(t?"_e-de-rtl":"_e-de-ltr")}),this.checkboxDiv.appendChild(this.wholeInput),this.wholeWord=new H.CheckBox({label:e.getConstant("Whole words"),enableRtl:t,checked:!1,change:this.wholeWordsChange.bind(this)}),this.wholeWord.appendTo(this.wholeInput),this.focusedElement.push(this.wholeInput),this.wholeInput.tabIndex=0,this.findTab.appendChild(this.checkboxDiv),this.replaceTabContentDiv=_.createElement("div",{className:"e-de-op-replacetabcontentdiv",styles:"display:none;"}),this.findTab.appendChild(this.replaceTabContentDiv),this.createReplacePane(t),this.resultContainer=_.createElement("div",{styles:"width:85%;display:none;",className:"e-de-op-result-container"}),this.findTab.appendChild(this.resultContainer),this.messageDiv=_.createElement("div",{className:this.documentHelper.owner.containerId+"_messageDiv e-de-op-msg",innerHTML:this.localeValue.getConstant(this.messageDivText),id:this.documentHelper.owner.containerId+"_search_status"}),this.resultContainer.appendChild(this.messageDiv),_.createElement("div",{id:this.documentHelper.owner.containerId+"_resultDiv"}));this.optionsPane.appendChild(i),this.findDiv=_.createElement("div",{className:"findDiv",styles:"display:none;"}),i.appendChild(this.findDiv),this.resultsListBlock=_.createElement("div",{id:this.documentHelper.owner.containerId+"_list_box_container",styles:"display:none;width:270px;list-style:none;padding-right:5px;overflow:auto;",className:"e-de-result-list-block"}),this.findDiv.appendChild(this.resultsListBlock),this.treeviewDiv=_.createElement("div",{className:"e-de-scrollbar-hide",styles:"height:375px;overflow:auto;padding-top:5px",id:this.documentHelper.owner.containerId+"_treeDiv"}),this.initHeadingTab(),this.onWireEvents(),t&&(this.optionsPane.classList.add("e-de-rtl"),this.closeButton.classList.add("e-de-rtl"),this.searchDiv.classList.add("e-de-rtl"))},wm.prototype.updateHeadingTab=function(){_.isNullOrUndefined(this.treeviewDiv)||(this.isUpdateHeading=!0,this.treeviewDiv.innerHTML="",this.data=this.dataForTreeview(),this.initHeadingTab(),this.isUpdateHeading=!1)},wm.prototype.initHeadingTab=function(){var e=_.createElement("div",{id:"tree"});!_.isNullOrUndefined(this.data)&&0<this.data.length?(this.treeviewObject=new k.TreeView({fields:{dataSource:this.data,id:"id",text:"name",parentID:"pid",hasChildren:"hasChild",tooltip:"tooltipText"},nodeClicked:this.nodeClick.bind(this),cssClass:"e-de-custom-treeview"}),_.isNullOrUndefined(this.treeviewDiv)||(this.treeviewDiv.innerHTML="",this.treeviewObject.appendTo(e),this.treeviewDiv.appendChild(e),_.isNullOrUndefined(this.findTab))||this.findTab.appendChild(this.treeviewDiv)):_.isNullOrUndefined(this.treeviewDiv)||(this.treeviewDiv.innerHTML=this.localeValue.getConstant("No Headings"),this.findTab.appendChild(this.treeviewDiv))},wm.prototype.nodeClick=function(e){var t=this.treeviewObject.selectedNodes[0];_.isNullOrUndefined(t)||this.documentHelper.selection.navigateBookmark(this.data[t-1].hyperlink.toString(),!0)},wm.prototype.dataForTreeview=function(){this.data=[];var e=this.createDataSourceForTreeview(),t=(this.documentHelper.blockToShift=void 0,[]);if(!_.isNullOrUndefined(this.treeviewDiv)){var i=1;if(!_.isNullOrUndefined(e)&&0<e.length)for(var n=0;n<e.length;n++){var r=null;if("Level1"!==e[n].paragraphFormat.outlineLevel&&0<n){var o=n-1;if(e[n].paragraphFormat.outlineLevel===e[n-1].paragraphFormat.outlineLevel)r=t[o].pid;else if(Number(e[n].paragraphFormat.outlineLevel.substr(5,1))>Number(e[o].paragraphFormat.outlineLevel.substr(5,1)))r=t[o].id,t[o].hasChild=!0,t[o].expanded=!0;else for(o--;0<o;){if(Number(e[n].paragraphFormat.outlineLevel.substr(5,1))>Number(e[o].paragraphFormat.outlineLevel.substr(5,1))){r=t[o].id,t[o].hasChild=!0,t[o].expanded=!0;break}if(Number(e[n].paragraphFormat.outlineLevel.substr(5,1))===Number(e[o].paragraphFormat.outlineLevel.substr(5,1))){r=t[o].pid;break}o--}}var s=e[n].childWidgets[0],a=void 0,l=void 0,d=void 0,s=(_.isNullOrUndefined(s.children[3])?(a=s.children[0].text,l=s.children[0].text,d="Toc00000000"+i,i++):(l=s.children[3].text,a=s.children[3].text,d=s.children[1].text),{pid:r,id:n+1,name:a,hyperlink:15<d.length?d.substring(15,d.length-2):d,tooltipText:l});t.push(s)}}return t},wm.prototype.createDataSourceForTreeview=function(){var e={startLevel:1,endLevel:9,includeOutlineLevels:!0,includeHyperlink:!0},t=this.documentHelper.selection.start.clone(),i=this.documentHelper.selection.end.clone(),n=(this.documentHelper.owner.editor.initComplexHistory("TOC"),this.constructHeadingFieldCode(e)),e=this.documentHelper.owner.editorModule.buildToc(this.validateHeadingSettings(e),n,!1,!0,!0);return this.documentHelper.owner.editorHistory&&(this.documentHelper.owner.editorHistory.updateComplexHistory(),1<this.documentHelper.owner.editorHistory.undoStack.length)&&!_.isNullOrUndefined(this.documentHelper.owner.editorHistory.undoStack[this.documentHelper.owner.editorHistory.undoStack.length-1].modifiedActions)&&this.documentHelper.owner.editorHistory.undoStack.pop(),this.documentHelper.selection.selectPosition(t,i),e},wm.prototype.validateHeadingSettings=function(e){return(_.isNullOrUndefined(e.startLevel)||e.startLevel<1)&&(e.startLevel=1),(_.isNullOrUndefined(e.endLevel)||e.endLevel<e.endLevel)&&(e.endLevel=3<e.startLevel?e.startLevel:3),_.isNullOrUndefined(e.includeHyperlink)&&(e.includeHyperlink=!1),_.isNullOrUndefined(e.includePageNumber)&&(e.includePageNumber=!1),_.isNullOrUndefined(e.rightAlign)&&(e.rightAlign=!1),_.isNullOrUndefined(e.levelSettings)&&(e.levelSettings={}),e},wm.prototype.constructHeadingFieldCode=function(e){var t="TOC",e=(_.isNullOrUndefined(e.startLevel)||0===e.startLevel||_.isNullOrUndefined(e.endLevel)||0===e.endLevel||(t=t+' \\o "'+e.startLevel+"-"+e.endLevel+'"'),e.includePageNumber&&!e.rightAlign&&(t+=' \\p " "'),e.includePageNumber||(t+=" \\n"),e.includeHyperlink&&(t+=" \\h \\z"),e.includeOutlineLevels&&(t+=" \\u"),this.constructTSwitch(e));return 6<e.length&&(t+=e),t},wm.prototype.constructTSwitch=function(e){var t="";if(!_.isNullOrUndefined(e.levelSettings))for(var i=0,n=Object.keys(e.levelSettings);i<n.length;i++)var r=n[i],t=t+r+","+e.levelSettings[r].toString()+",";return t=' \\t "'+(t=t.slice(0,-1))+'"'},wm.prototype.createReplacePane=function(e){this.replaceDiv=_.createElement("div"),this.replaceTabContentDiv.appendChild(this.replaceDiv),this.replaceWith=_.createElement("input",{className:"e-de-op-replacewith e-input",attrs:{placeholder:this.localeValue.getConstant("Replace with")}}),this.replaceDiv.appendChild(this.replaceWith),e=e?(t="text-align:left","margin-left:10px"):(t="text-align:right","margin-right:10px");var t=_.createElement("div",{styles:t,className:"e-de-op-dlg-footer"}),e=(this.replaceDiv.appendChild(t),this.replaceButton=_.createElement("button",{className:"e-control e-btn e-flat e-replace",styles:e,innerHTML:this.localeValue.getConstant(this.replaceButtonText),attrs:{type:"button"}}),t.appendChild(this.replaceButton),this.replaceButton.setAttribute("aria-label",this.localeValue.getConstant(this.replaceButtonText)),this.replaceAllButton=_.createElement("button",{className:"e-control e-btn e-flat e-replaceall",innerHTML:this.localeValue.getConstant(this.replaceAllButtonText),attrs:{type:"button"}}),t.appendChild(this.replaceAllButton),this.replaceAllButton.setAttribute("aria-label",this.localeValue.getConstant(this.replaceAllButtonText)),this.matchDiv=_.createElement("div",{styles:"display:none;padding-top:10px;"}),this.replaceDiv.appendChild(this.matchDiv),_.createElement("div",{className:"e-de-op-search-replacediv"}));this.replaceDiv.appendChild(e),this.occurrenceDiv=_.createElement("div",{styles:"display:none;"}),this.replaceDiv.appendChild(this.occurrenceDiv)},wm.prototype.selectedTabItem=function(e){var t,i=this.findTab.getElementsByClassName("e-content").item(0),n=(e.previousIndex!==e.selectedIndex&&(t=i.children[0],n=i.children[1],t=t.firstElementChild)&&(t.parentElement&&t.parentElement.removeChild(t),n.appendChild(t)),i.children[0]);_.isNullOrUndefined(n)||(0===e.selectedIndex?(this.isOptionsPane=!1,this.onHeadingPane()):1===e.selectedIndex?(this.isOptionsPane=!0,this.onFindPane()):(this.isOptionsPane=!1,this.onReplacePane()))},wm.prototype.navigateSearchResult=function(e){e&&this.documentHelper.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]),this.documentHelper.owner.searchModule.highlight(this.results),this.documentHelper.owner.searchModule.addFindResultView(this.results),this.resultsListBlock.style.display="block",this.resultContainer.style.display="block";for(var t=this.documentHelper.owner.findResultsList,i="",n=0;n<t.length;n++)i+=t[n];e=this.optionsPane.offsetHeight-this.findTab.offsetHeight;this.resultsListBlock.style.height=e+"px",this.clearFocusElement(),this.resultsListBlock.innerHTML=i;for(n=0;n<this.resultsListBlock.children.length;n++)this.focusedElement.push(this.resultsListBlock.children[n]);e=this.results.currentIndex,this.messageDiv.innerHTML=this.localeValue.getConstant("Result")+" "+(e+1)+" "+this.localeValue.getConstant("of")+" "+this.resultsListBlock.children.length,e=this.resultsListBlock.children[e];e.classList.contains("e-de-search-result-item")&&(e.classList.remove("e-de-search-result-item"),e.classList.add("e-de-search-result-hglt"),e.children[0].classList.add("e-de-op-search-word-text"),this.scrollToPosition(e))},wm.prototype.wholeWordsChange=function(){this.matchInput.checked&&this.wholeInput.checked?this.findOption="CaseSensitiveWholeWord":this.matchInput.checked&&!this.wholeInput.checked?this.findOption="CaseSensitive":!this.matchInput.checked&&this.wholeInput.checked?this.findOption="WholeWord":this.findOption="None",this.searchOptionChange()},wm.prototype.matchChange=function(){this.matchInput.checked&&this.wholeInput.checked?this.findOption="CaseSensitiveWholeWord":!this.matchInput.checked&&this.wholeInput.checked?this.findOption="WholeWord":this.matchInput.checked&&!this.wholeInput.checked?this.findOption="CaseSensitive":this.findOption="None";var e=this.optionsPane.offsetHeight-this.findTab.offsetHeight;this.resultsListBlock.style.height=e+"px",this.searchOptionChange()},wm.prototype.onWireEvents=function(){this.searchIcon.addEventListener("click",this.searchIconClickInternal),this.navigateToNextResult.addEventListener("click",this.navigateNextResultButtonClick),this.navigateToPreviousResult.addEventListener("click",this.navigatePreviousResultButtonClick),this.searchInput.addEventListener("keydown",this.onKeyDown),this.searchInput.addEventListener("keyup",this.onEnableDisableReplaceButton),this.resultsListBlock.addEventListener("click",this.resultListBlockClick),this.closeButton.addEventListener("click",this.close),this.replaceButton.addEventListener("click",this.onReplaceButtonClick),this.replaceAllButton.addEventListener("click",this.onReplaceAllButtonClick)},wm.prototype.onKeyDownInternal=function(){var e=document.getElementById(this.documentHelper.owner.containerId+"_option_search_text_box");if(!_.isNullOrUndefined(e)){e.blur();e=e.value;if(""!==e){1<=e.length&&this.searchIcon.classList.contains("e-de-op-search-icon")&&(this.searchIcon.classList.add("e-de-op-search-close-icon"),this.searchIcon.classList.remove("e-de-op-search-icon"));this.isOptionsPane;this.clearSearchResultItems(),this.documentHelper.owner.searchModule.clearSearchHighlight();var e=this.documentHelper.owner.searchModule.textSearch.stringToRegex(e,this.findOption),t=this.documentHelper.selection.end.getHierarchicalIndexInternal(),e=(this.results=this.documentHelper.owner.searchModule.textSearch.findAll(e,this.findOption,t),this.results);if(_.isNullOrUndefined(e)&&this.viewer.renderVisiblePages(),null!=e&&0<e.length){-1===this.focusedElement.indexOf(this.navigateToPreviousResult)&&this.isOptionsPane&&this.focusedElement.push(this.navigateToPreviousResult),-1===this.focusedElement.indexOf(this.navigateToNextResult)&&this.isOptionsPane&&this.focusedElement.push(this.navigateToNextResult),this.documentHelper.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]),this.documentHelper.owner.searchModule.highlight(e),this.documentHelper.owner.searchModule.addFindResultView(e),this.resultContainer.style.display="block",this.resultsListBlock.style.display="block";var t=this.optionsPane.offsetHeight-this.findTab.offsetHeight,i=(this.resultsListBlock.style.height=t+"px",this.documentHelper.owner.findResultsList),n="";this.clearFocusElement(),this.resultsListBlock.innerHTML="";for(var r=0;r<i.length;r++)n+=i[r];this.resultsListBlock.innerHTML=n;for(r=0;r<this.resultsListBlock.children.length;r++)this.focusedElement.push(this.resultsListBlock.children[r]);this.resultsListBlock.children;e=this.results.currentIndex,t=(this.messageDiv.innerHTML=this.localeValue.getConstant("Result")+" "+(e+1)+" "+this.localeValue.getConstant("of")+" "+this.resultsListBlock.children.length,this.resultsListBlock.children[e]);t.classList.contains("e-de-search-result-item")&&(t.classList.remove("e-de-search-result-item"),t.classList.add("e-de-search-result-hglt"),t.children[0].classList.add("e-de-op-search-word-text")),this.navigateToNextResult.focus(),this.focusedIndex=this.focusedElement.indexOf(this.navigateToNextResult),this.getMessageDivHeight()}else this.messageDiv.innerHTML=this.localeValue.getConstant("No matches"),this.resultContainer.style.display="block",this.resultsListBlock.style.display="none",this.clearFocusElement(),this.resultsListBlock.innerHTML=""}}},wm.prototype.onHeadingPane=function(){this.treeviewDiv.style.display="block",this.refreshHeadingPaneHeight(),this.messageDiv.classList.remove("e-de-op-msg"),this.messageDiv.classList.remove("e-de-op-replace-messagediv"),this.replaceDiv.style.display="none",this.occurrenceDiv.style.display="none",this.findDiv.style.display="none",this.findTabContentDiv.style.display="none",this.checkboxDiv.style.display="none",this.resultContainer.style.display="none"},wm.prototype.refreshHeadingPaneHeight=function(){var e;_.isNullOrUndefined(this.optionsPane)||_.isNullOrUndefined(this.searchDiv)||_.isNullOrUndefined(this.tabDiv)||(e=window.getComputedStyle(this.searchDiv),e=parseFloat(e.marginBottom),e=this.optionsPane.offsetHeight-(e+this.searchDiv.offsetHeight+this.tabDiv.offsetHeight),this.treeviewDiv.style.height=e+"px")},wm.prototype.onFindPane=function(){this.replaceDiv.style.display="none",this.occurrenceDiv.style.display="none",this.treeviewDiv.style.display="none",this.findDiv.style.display="block",this.findTabContentDiv.style.display="block",this.checkboxDiv.style.display="block",this.resultContainer.style.display="block",_.isNullOrUndefined(this.results)||0!==this.results.length||(this.resultsListBlock.innerHTML="",this.resultsListBlock.style.display="none",this.messageDiv.innerHTML=this.localeValue.getConstant("No matches"));this.isOptionsPane;var e=this.optionsPane.offsetHeight-(this.findTab.offsetHeight-this.replaceTabContentDiv.offsetHeight);this.resultsListBlock.style.height=e+"px",this.replaceTabContentDiv.style.display="none",this.findDiv.style.display="block",this.messageDiv.style.display="block",this.focusedElement=[],this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput),this.focusedIndex=1,this.searchInput.select(),this.getMessageDivHeight()},wm.prototype.getMessageDivHeight=function(){!this.isOptionsPane&&this.messageDiv.classList.contains("e-de-op-msg")?(this.messageDiv.classList.add("e-de-op-replace-messagediv"),this.messageDiv.classList.remove("e-de-op-msg")):this.isOptionsPane&&this.messageDiv.classList.contains("e-de-op-replace-messagediv")&&(this.messageDiv.classList.add("e-de-op-msg"),this.messageDiv.classList.remove("e-de-op-replace-messagediv"))},wm.prototype.onReplacePane=function(){this.findDiv.style.display="block",this.replaceDiv.style.display="block",this.replaceTabContentDiv.style.display="block",this.findDiv.style.display="block",this.treeviewDiv.style.display="none",this.findTabContentDiv.style.display="block",this.checkboxDiv.style.display="block",this.resultContainer.style.display="block";this.isOptionsPane;var e=this.optionsPane.offsetHeight-this.findTab.offsetHeight;this.resultsListBlock.style.height=e+"px",this.isOptionsPane=!1,0!==this.searchInput.value.length?(this.replaceButton.disabled=!1,this.replaceAllButton.disabled=!1):(this.replaceButton.disabled=!0,this.replaceAllButton.disabled=!0),this.focusedElement=[],this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput,this.replaceWith,this.replaceButton,this.replaceAllButton),this.focusedIndex=1,(""===this.searchInput.value?this.searchInput:this.replaceWith).select(),this.getMessageDivHeight()},wm.prototype.replaceAll=function(){this.optionsPane;var e,t,i,n=this.searchInput.value,r=this.replaceWith.value;""===n||_.isNullOrUndefined(n)||(e=this.documentHelper.owner.searchModule.textSearch.stringToRegex(n,this.findOption),t=this.documentHelper.selection.end.getHierarchicalIndexInternal(),e=this.documentHelper.owner.searchModule.textSearch.findAll(e,this.findOption,t),t=_.isNullOrUndefined(r)?"":r,i=_.isNullOrUndefined(e)?0:e.length,this.documentHelper.owner.searchModule.replaceAll(t,e),this.documentHelper.layout.isReplacingAll=!1,this.matchDiv.style.display="block",this.matchDiv.innerHTML=this.localeValue.getConstant("All Done")+"!",this.occurrenceDiv.style.display="block",this.occurrenceDiv.innerHTML=this.localeValue.getConstant("We replaced all")+" "+i+" "+this.localeValue.getConstant("instances")+" "+this.localeValue.getConstant("of")+' "'+n+'" '+this.localeValue.getConstant("with")+' "'+r+'" ')},wm.prototype.hideMatchDiv=function(){this.matchDiv.style.display="none",this.occurrenceDiv.style.display="none"},wm.prototype.updateListItems=function(e){for(var t=this.resultsListBlock.getElementsByClassName("e-de-search-result-hglt"),i=0;i<t.length;i++){var n=t[i];_.classList(n,["e-de-search-result-item"],["e-de-search-result-hglt"]),_.classList(n.children[0],[],["e-de-op-search-word-text"])}var r=this.resultsListBlock.children[this.results.currentIndex];_.classList(r,["e-de-search-result-hglt"],["e-de-search-result-item"]),_.classList(r.children[0],["e-de-op-search-word-text"],[]),this.scrollToPosition(r),this.documentHelper.owner.searchModule.navigate(e),this.documentHelper.owner.searchModule.highlight(this.results)},wm.prototype.scrollToPosition=function(e){var t=e.getBoundingClientRect();0<t.top?(t=t.top-e.parentElement.getBoundingClientRect().top,e.parentElement.offsetHeight-t<=e.offsetHeight?(Math.ceil(t+e.offsetHeight)===e.parentElement.scrollHeight&&(e.parentElement.scrollTop=t),e.parentElement.scrollTop=e.parentElement.scrollTop+e.parentElement.offsetHeight/100*30):t<0&&(e.parentElement.scrollTop=e.parentElement.scrollTop-e.parentElement.offsetHeight/100*30)):e.parentElement.scrollTop=0},wm.prototype.clearFocusElement=function(){for(var e=0;e<this.resultsListBlock.children.length;e++){var t=this.focusedElement.indexOf(this.resultsListBlock.children[e]);-1!==t&&this.focusedElement.splice(t,1)}this.focusedIndex=1},wm.prototype.showHideOptionsPane=function(e){var t,i,n;_.isNullOrUndefined(this.documentHelper.owner.selectionModule)||(this.documentHelper.owner.fireOptionPaneChange(e),e?(this.localeValue=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localeValue.setLocale(this.documentHelper.owner.locale),_.isNullOrUndefined(this.optionsPane)&&(this.initOptionsPane(this.localeValue,this.documentHelper.owner.enableRtl),e=void 0,e=this.documentHelper.owner.enableRtl?"display:inline-flex;direction:rtl;":"display:inline-flex;",this.documentHelper.optionsPaneContainer.setAttribute("style",e),this.documentHelper.optionsPaneContainer.insertBefore(this.documentHelper.owner.optionsPaneModule.optionsPane,this.documentHelper.viewerContainer)),this.optionsPane.style.display="block",this.documentHelper.owner.isReadOnlyMode?this.tabInstance.hideTab(2):this.tabInstance.hideTab(2,!1),this.isReplace&&!this.documentHelper.owner.isReadOnlyMode?(this.tabInstance.select(2),this.isReplace=!1,this.isOptionsPane=!1):this.tabInstance.select(1),n=document.getElementById(this.documentHelper.owner.containerId+"_treeDiv"),_.isNullOrUndefined(n)||(n.innerHTML="",this.data=this.dataForTreeview(),this.initHeadingTab()),this.searchDiv.innerHTML=this.localeValue.getConstant(this.searchText),this.isOptionsPaneShow=!0,e=document.getElementById(this.documentHelper.owner.getDocumentEditorElement().id+"_option_search_text_box"),i=this.documentHelper.owner.selectionModule.text,_.isNullOrUndefined(i)||(i=(t=j.indexOfAny(i,["\v","\r"]))<0?i:i.substring(0,t)),e.value=i,e.select(),!_.isNullOrUndefined(e.value)&&e.value.match(/[!\@\#$%\^&*\(\)_\-+\=\[\]\{\};:"\|,.<>\/?`~\s\\؟°÷×،؛]/)&&""!==e.value?(this.wholeInput.checked=!1,this.wholeWord.disabled=!0):this.wholeWord.disabled=!1,this.messageDiv.innerHTML="",this.searchIcon.classList.contains("e-de-op-search-close-icon")&&(this.searchIcon.classList.add("e-de-op-search-icon"),this.searchIcon.classList.remove("e-de-op-search-close-icon")),this.documentHelper.selection.caret.style.display="none",this.focusedIndex=1,this.focusedElement=[],this.isOptionsPane?this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput):this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput,this.replaceWith,this.replaceButton,this.replaceAllButton),this.documentHelper.updateViewerSize()):(_.isNullOrUndefined(this.optionsPane)||(this.clearSearchResultItems(),_.isNullOrUndefined(this.documentHelper.owner.searchModule)||this.documentHelper.owner.searchModule.clearSearchHighlight(),this.isOptionsPaneShow=!1,t=document.getElementById(this.documentHelper.owner.containerId+"_list_box_container"),i=document.getElementById(this.documentHelper.owner.containerId+"_search_status"),_.isNullOrUndefined(t)||_.isNullOrUndefined(i)||(t.style.display="none",this.clearFocusElement(),t.innerHTML="",i.innerHTML=this.localeValue.getConstant("No matches")),n=document.getElementById(this.documentHelper.owner.containerId+"_treeDiv"),_.isNullOrUndefined(n))||(n.innerHTML=""),this.documentHelper.updateViewerSize(),_.isNullOrUndefined(this.optionsPane)||"none"!==this.optionsPane.style.display&&(this.documentHelper.selection.updateCaretPosition(),this.optionsPane.style.display="none"),this.documentHelper.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.documentHelper.owner.enableAutoFocus&&(this.documentHelper.selection.caret.style.display="block")),this.documentHelper.owner.triggerResize())},wm.prototype.clearSearchResultItems=function(){_.isNullOrUndefined(this.documentHelper.owner.findResultsList)||(this.documentHelper.owner.findResultsList=[])},wm.prototype.destroy=function(){this.optionsPane&&(this.optionsPane.innerHTML="",this.optionsPane=void 0),this.resultsListBlock&&(this.resultsListBlock.innerHTML="",this.resultsListBlock=void 0),this.messageDiv&&(this.messageDiv.innerHTML="",this.messageDiv=void 0),this.resultContainer&&(this.resultContainer.innerHTML=""),this.resultContainer=void 0,this.searchInput&&(this.searchInput.value="",this.searchInput=void 0),this.searchDiv&&(this.searchDiv.innerHTML="",this.searchDiv=void 0),this.searchTextBoxContainer&&(this.searchTextBoxContainer.innerHTML="",this.searchTextBoxContainer=void 0),this.replaceWith&&(this.replaceWith.innerHTML="",this.replaceWith=void 0),this.findDiv&&(this.findDiv.innerHTML="",this.findDiv=void 0),this.treeviewDiv&&(this.treeviewDiv.innerHTML="",this.treeviewDiv=void 0),this.replaceButton&&(this.replaceButton.innerHTML="",this.replaceButton=void 0),this.replaceAllButton&&(this.replaceAllButton.innerHTML="",this.replaceAllButton=void 0),this.matchInput&&(this.matchInput.innerHTML="",this.matchCase=void 0),this.wholeInput&&(this.wholeInput.innerHTML="",this.wholeWord=void 0),_.isNullOrUndefined(this.results)||this.results.destroy(),this.focusedElement&&(this.focusedElement=[]),this.focusedElement=void 0,this.destroyInternal(),this.documentHelper=void 0},wm.prototype.destroyInternal=function(){this.searchText&&(this.searchText=void 0),this.resultsText&&(this.resultsText=void 0),this.messageDivText&&(this.messageDivText=void 0),this.replaceButtonText&&(this.replaceButtonText=void 0),this.replaceAllButtonText&&(this.replaceAllButtonText=void 0),this.tabDiv&&(this.tabDiv=void 0)};var vm=wm;function wm(e){var a=this;this.isOptionsPaneShow=!1,this.findOption="None",this.matchCase=void 0,this.wholeWord=void 0,this.searchText="Navigation",this.resultsText="Results",this.messageDivText="No matches",this.replaceButtonText="Replace",this.replaceAllButtonText="Replace All",this.focusedIndex=-1,this.focusedElement=[],this.isOptionsPane=!0,this.replacePaneText="Replace",this.findPaneText="Find",this.headingPaneText="Heading",this.matchDivReplaceText="No matches",this.tabInstance=void 0,this.isReplace=!1,this.isUpdateHeading=!1,this.searchOptionChange=function(){a.clearSearchResultItems(),a.documentHelper.owner.searchModule.clearSearchHighlight();var e,t=a.searchInput.value;""!==t&&(t=a.documentHelper.owner.searchModule.textSearch.stringToRegex(t,a.findOption),e=a.documentHelper.selection.end.getHierarchicalIndexInternal(),a.results=a.documentHelper.owner.searchModule.textSearch.findAll(t,a.findOption,e),null!=a.results&&0<a.results.length?a.navigateSearchResult(!1):(a.viewer.renderVisiblePages(),a.messageDiv.innerHTML=a.localeValue.getConstant("No matches"),a.resultContainer.style.display="block",a.resultsListBlock.style.display="none",a.clearFocusElement(),a.resultsListBlock.innerHTML=""))},this.onEnableDisableReplaceButton=function(){0!==a.searchInput.value.length?(a.replaceButton.disabled=!1,a.replaceAllButton.disabled=!1):(a.replaceButton.disabled=!0,a.replaceAllButton.disabled=!0),!_.isNullOrUndefined(a.searchInput.value)&&a.searchInput.value.match(/[!\@\#$%\^&*\(\)_\-+\=\[\]\{\};:"\|,.<>\/?`~\s\\؟°÷×،؛]/)&&""!==a.searchInput.value?(a.wholeWord.checked=!1,a.wholeWord.disabled=!0):a.wholeWord.disabled=!1},this.onKeyDownOnOptionPane=function(e){var t,i,n;9===e.keyCode?(e.preventDefault(),t=void 0,t=e.shiftKey?0===a.focusedIndex||_.isNullOrUndefined(a.focusedIndex)?a.focusedElement.length-1:a.focusedIndex-1:a.focusedElement.length-1===a.focusedIndex||_.isNullOrUndefined(a.focusedIndex)?0:a.focusedIndex+1,(n=a.focusedElement[t]).focus(),n instanceof HTMLInputElement&&n.select(),a.focusedIndex=t,n instanceof HTMLLIElement&&a.scrollToPosition(n)):13===e.keyCode?(a.hideMatchDiv(),e.target!==a.searchInput&&e.target!==a.closeButton&&(e.preventDefault(),-1!==(i=a.focusedElement.indexOf(e.target)))&&((t=a.focusedElement[i]).click(),t.focus(),a.focusedIndex=i)):40!==e.keyCode&&38!==e.keyCode||"none"!==a.resultsListBlock.style.display&&(n=i=void 0,40===e.keyCode?7<a.focusedIndex?a.focusedIndex+1<a.focusedElement.length&&((n=a.focusedElement[a.focusedIndex+1]).focus(),a.focusedIndex=a.focusedIndex+1):(i=a.focusedElement.length-a.resultsListBlock.children.length+a.results.currentIndex+1)<a.focusedElement.length&&((n=a.focusedElement[i]).focus(),a.focusedIndex=i):6<a.focusedIndex&&(i=a.focusedIndex-1,(n=a.focusedElement[i]).focus(),a.focusedIndex=i))},this.onReplaceButtonClick=function(){a.optionsPane;var e,t,i=a.searchInput.value,n=a.replaceWith.value,r=a.documentHelper.owner.searchModule.textSearchResults;""===i||_.isNullOrUndefined(i)||null!=a.documentHelper.owner.selectionModule&&(t=a.documentHelper.owner.selectionModule.text,a.documentHelper.owner.selectionModule.isEmpty||(a.documentHelper.owner.selectionModule.isForward?a.documentHelper.owner.selectionModule.selectContent(a.documentHelper.owner.selectionModule.start,!0):a.documentHelper.owner.selectionModule.selectContent(a.documentHelper.owner.selectionModule.end,!0)),_.isNullOrUndefined(r)||_.isNullOrUndefined(r.currentSearchResult)?(a.documentHelper.owner.searchModule.findAll(i,a.findOption),a.messageDiv.style.display="block",a.messageDiv.innerHTML=a.localeValue.getConstant(a.matchDivReplaceText)):(e=r.currentSearchResult,a.documentHelper.owner.searchModule.navigate(e),e.text===t?(t=_.isNullOrUndefined(n)?"":n,a.documentHelper.owner.searchModule.replace(t,e,r),n=a.documentHelper.owner.searchModule.textSearch.stringToRegex(i,a.findOption),t=a.documentHelper.selection.end.getHierarchicalIndexInternal(),a.results=a.documentHelper.owner.searchModule.textSearch.findAll(n,a.findOption,t),_.isNullOrUndefined(a.results)||_.isNullOrUndefined(a.results.currentSearchResult)?(a.messageDiv.style.display="block",a.messageDiv.innerHTML=a.localeValue.getConstant(a.matchDivReplaceText)):a.documentHelper.owner.searchModule.navigate(a.results.currentSearchResult),a.documentHelper.owner.findResultsList=[],!_.isNullOrUndefined(a.results)&&0<a.results.innerList.length?a.navigateSearchResult(!0):a.resultsListBlock.innerHTML=""):a.documentHelper.owner.searchModule.findAll(i,a.findOption)))},this.onReplaceAllButtonClick=function(){a.replaceAll(),a.resultsListBlock.style.display="none",a.messageDiv.innerHTML="",a.documentHelper.updateFocus()},this.searchIconClickInternal=function(){var e=document.getElementById(a.documentHelper.owner.containerId+"_option_search_text_box"),t=e.value;""!==t&&(a.hideMatchDiv(),a.searchIcon.classList.contains("e-de-op-search-close-icon")?(a.searchIcon.classList.add("e-de-op-search-icon"),a.searchIcon.classList.remove("e-de-op-search-close-icon"),e.value="",a.messageDiv.innerHTML=a.localeValue.getConstant("No matches"),a.resultContainer.style.display="block",a.resultsListBlock.style.display="none",a.matchDiv.style.display="none",a.occurrenceDiv.style.display="none",a.onEnableDisableReplaceButton(),a.clearFocusElement(),a.resultsListBlock.innerHTML="",a.clearSearchResultItems(),a.documentHelper.owner.searchModule.clearSearchHighlight(),a.viewer.renderVisiblePages()):(a.searchIcon.classList.contains("e-de-op-search-icon")&&1<=t.length&&(a.searchIcon.classList.add("e-de-op-search-close-icon"),a.searchIcon.classList.remove("e-de-op-search-icon"),a.onEnableDisableReplaceButton()),a.clearSearchResultItems(),a.documentHelper.owner.searchModule.clearSearchHighlight(),e=a.documentHelper.owner.searchModule.textSearch.stringToRegex(t,a.findOption),t=a.documentHelper.selection.end.getHierarchicalIndexInternal(),a.results=a.documentHelper.owner.searchModule.textSearch.findAll(e,a.findOption,t),null!=a.results&&0<a.results.length?(e=a.results.innerList[a.results.currentIndex].start,t=a.results.innerList[a.results.currentIndex].end,a.documentHelper.scrollToPosition(e,t,!0),a.navigateSearchResult(!1),a.getMessageDivHeight(),a.isOptionsPane,e=a.optionsPane.offsetHeight-a.findTab.offsetHeight,a.resultsListBlock.style.height=e+"px"):(a.messageDiv.innerHTML=a.localeValue.getConstant("No matches"),a.resultContainer.style.display="block",a.resultsListBlock.style.display="none",a.clearFocusElement(),a.resultsListBlock.innerHTML="")))},this.navigateNextResultButtonClick=function(){if(null!=document.getElementById(a.documentHelper.owner.containerId+"_list_box_container")&&"none"!==document.getElementById(a.documentHelper.owner.containerId+"_list_box_container").style.display){for(var e=a.documentHelper.owner.selectionModule.end,t=void 0,i=0,n=i=e.isExistAfter(a.results.currentSearchResult.start)?a.results.currentIndex:i;n<a.results.length;n++){var r=a.results.innerList[n];if(e.isExistBefore(r.start)||e.isAtSamePosition(r.start)){t=r,a.results.currentIndex=n;break}}_.isNullOrUndefined(t)&&(a.results.currentIndex=0,t=a.results.innerList[0]),a.messageDiv.innerHTML=a.localeValue.getConstant("Result")+" "+(a.results.currentIndex+1)+" "+a.localeValue.getConstant("of")+" "+a.resultsListBlock.children.length,a.updateListItems(t),a.focusedIndex=a.focusedElement.indexOf(a.navigateToNextResult)}},this.navigatePreviousResultButtonClick=function(){if(null!=document.getElementById(a.documentHelper.owner.containerId+"_list_box_container")&&"none"!==document.getElementById(a.documentHelper.owner.containerId+"_list_box_container").style.display){for(var e=void 0,t=a.documentHelper.owner.selectionModule.start,i=a.results.currentIndex,n=i=t.isExistAfter(a.results.currentSearchResult.start)?a.results.length-1:i;0<=n;n--){var r=a.results.innerList[n];if(t.isExistAfter(r.start)||a.documentHelper.owner.selectionModule.end.isAtSamePosition(r.start)){e=r,a.results.currentIndex=n;break}}_.isNullOrUndefined(e)&&(a.results.currentIndex=a.results.length-1,e=a.results.innerList[a.results.currentIndex]),a.messageDiv.innerHTML=a.localeValue.getConstant("Result")+" "+(a.results.currentIndex+1)+" "+a.localeValue.getConstant("of")+" "+a.resultsListBlock.children.length,a.updateListItems(e),a.focusedIndex=a.focusedElement.indexOf(a.navigateToPreviousResult)}},this.onKeyDown=function(e){var t=e.which||e.keyCode;13===t&&9!==e.keyCode&&40!==e.keyCode?(e.preventDefault(),a.findDiv.style.height="",a.onKeyDownInternal()):8===t&&0===a.searchInput.value.length?a.resultContainer.style.display="block":9!==e.keyCode&&40!==e.keyCode&&27!==e.keyCode?(a.documentHelper.owner.searchModule.clearSearchHighlight(),a.clearSearchResultItems(),a.viewer.renderVisiblePages(),a.resultsListBlock.style.display="none",a.messageDiv.innerHTML=a.localeValue.getConstant("No matches"),a.resultContainer.style.display="none",a.clearFocusElement(),a.resultsListBlock.innerHTML="",a.searchIcon.classList.contains("e-de-op-search-close-icon")&&(a.searchIcon.classList.add("e-de-op-search-icon"),a.searchIcon.classList.remove("e-de-op-search-close-icon"))):27===t&&27===e.keyCode&&(a.showHideOptionsPane(!1),a.documentHelper.owner.documentEditorSettings.showNavigationPane=!1,a.documentHelper.updateFocus())},this.close=function(){a.clearFocusElement(),a.showHideOptionsPane(!1),a.documentHelper.owner.documentEditorSettings.showNavigationPane=!1,a.resultsListBlock.innerHTML="",a.focusedIndex=1,a.isOptionsPane=!0,a.documentHelper.updateFocus()},this.resultListBlockClick=function(e){for(var t,i=e.target,n=a.resultsListBlock.children,r=0,o=0;o<n.length;o++){var s=n[o];s.classList.contains("e-de-search-result-hglt")&&(s.classList.remove("e-de-search-result-hglt"),s.children[0].classList.remove("e-de-op-search-word-text"),s.classList.add("e-de-search-result-item"))}for(o=0;o<n.length;o++)i===n[o]&&(t=n[r=o]).classList.contains("e-de-search-result-item")&&(t.classList.remove("e-de-search-result-item"),t.classList.add("e-de-search-result-hglt"),t.children[0].classList.add("e-de-op-search-word-text"),a.focusedIndex=a.focusedElement.indexOf(t));e=a.results.innerList[r];a.results.currentIndex=r,a.messageDiv.innerHTML=a.localeValue.getConstant("Result")+" "+(r+1)+" "+a.localeValue.getConstant("of")+" "+a.resultsListBlock.children.length,a.documentHelper.owner.searchModule.navigate(e),a.documentHelper.owner.searchModule.highlight(a.results),t&&t.focus()},this.documentHelper=e}Object.defineProperty(xm.prototype,"fontSize",{get:function(){return this.fontSizeIn},set:function(e){e!==this.fontSizeIn&&(this.fontSizeIn=e,this.notifyPropertyChanged("fontSize"))},enumerable:!0,configurable:!0}),Object.defineProperty(xm.prototype,"renderedFontFamily",{get:function(){return this.renderedFontFamilyIn},enumerable:!0,configurable:!0}),Object.defineProperty(xm.prototype,"fontFamily",{get:function(){return this.fontFamilyIn},set:function(e){e!==this.fontFamilyIn&&(this.fontFamilyIn=this.renderedFontFamilyIn=e,this.notifyPropertyChanged("fontFamily"))},enumerable:!0,configurable:!0}),Object.defineProperty(xm.prototype,"fontColor",{get:function(){return this.fontColorIn},set:function(e){e!==this.fontColorIn&&(this.fontColorIn=e,this.notifyPropertyChanged("fontColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(xm.prototype,"bold",{get:function(){return this.boldIn},set:function(e){e!==this.boldIn&&(this.boldIn=e,this.notifyPropertyChanged("bold"))},enumerable:!0,configurable:!0}),Object.defineProperty(xm.prototype,"italic",{get:function(){return this.italicIn},set:function(e){e!==this.italic&&(this.italicIn=e,this.notifyPropertyChanged("italic"))},enumerable:!0,configurable:!0}),Object.defineProperty(xm.prototype,"strikethrough",{get:function(){return this.strikeThroughIn},set:function(e){e!==this.strikeThroughIn&&(this.strikeThroughIn=e,this.notifyPropertyChanged("strikethrough"))},enumerable:!0,configurable:!0}),Object.defineProperty(xm.prototype,"baselineAlignment",{get:function(){return this.baselineAlignmentIn},set:function(e){e!==this.baselineAlignmentIn&&(this.baselineAlignmentIn=e,this.notifyPropertyChanged("baselineAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(xm.prototype,"underline",{get:function(){return this.underlineIn},set:function(e){e!==this.underlineIn&&(this.underlineIn=e,this.notifyPropertyChanged("underline"))},enumerable:!0,configurable:!0}),Object.defineProperty(xm.prototype,"highlightColor",{get:function(){return this.highlightColorIn},set:function(e){e===this.highlightColorIn&&"NoColor"!==e||(this.highlightColorIn=e,this.notifyPropertyChanged("highlightColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(xm.prototype,"allCaps",{get:function(){return this.allCapsIn},set:function(e){e!==this.allCapsIn&&(this.allCapsIn=e,this.notifyPropertyChanged("allCaps"))},enumerable:!0,configurable:!0}),xm.prototype.getPropertyValue=function(e){switch(e){case"bold":return this.bold;case"italic":return this.italic;case"fontSize":return 1<=this.fontSize?this.fontSize:void 0;case"fontFamily":return this.fontFamily;case"strikethrough":return this.strikethrough;case"baselineAlignment":return this.baselineAlignment;case"highlightColor":return this.highlightColor;case"underline":return this.underline;case"fontColor":return this.fontColor;case"allCaps":return this.allCaps;default:return}},xm.prototype.notifyPropertyChanged=function(e){var t;!_.isNullOrUndefined(this.selection)&&(this.selection.isCleared||this.selection.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.selection.owner.isDocumentLoaded||this.selection.owner.isPastingContent)&&!this.selection.isRetrieveFormatting||_.isNullOrUndefined(this.selection)||_.isNullOrUndefined(this.selection.start)||this.selection.isRetrieveFormatting||(t=this.getPropertyValue(e),_.isNullOrUndefined(t))||this.selection.owner.editorModule.onApplyCharacterFormat(e,t)},xm.prototype.copyFormat=function(e,t){this.styleName=_.isNullOrUndefined(e.baseCharStyle)?"Default Paragraph Font":e.baseCharStyle.name,this.fontSize=e.fontSize,this.renderedFontFamilyIn=t,this.fontFamily=e.fontFamily,this.bold=e.bold,this.italic=e.italic,this.baselineAlignment=e.baselineAlignment,this.underline=e.underline,this.fontColor=e.fontColor,this.highlightColor=e.highlightColor,this.strikethrough=e.strikethrough,this.bidi=e.bidi,this.bdo=e.bdo,this.boldBidi=e.boldBidi,this.italicBidi=e.italicBidi,this.fontFamilyBidi=e.fontFamilyBidi,this.fontSizeBidi=e.fontSizeBidi,this.allCaps=e.allCaps},xm.prototype.combineFormat=function(e,t){_.isNullOrUndefined(this.bold)||this.bold===e.bold||(this.bold=void 0),_.isNullOrUndefined(this.italic)||this.italic===e.italic||(this.italic=void 0),0!==this.fontSize&&this.fontSize!==e.fontSize&&(this.fontSize=0),_.isNullOrUndefined(this.renderedFontFamily)||this.renderedFontFamily===t||(this.renderedFontFamilyIn=void 0),_.isNullOrUndefined(this.fontFamily)||this.fontFamily===e.fontFamily||(this.fontFamily=void 0),_.isNullOrUndefined(this.highlightColor)||this.highlightColor===e.highlightColor||(this.highlightColor=void 0),_.isNullOrUndefined(this.baselineAlignment)||this.baselineAlignment===e.baselineAlignment||(this.baselineAlignment=void 0),_.isNullOrUndefined(this.fontColor)||this.fontColor===e.fontColor||(this.fontColor=void 0),_.isNullOrUndefined(this.underline)||this.underline===e.underline||(this.underline=void 0),_.isNullOrUndefined(this.strikethrough)||this.strikethrough===e.strikethrough||(this.strikethrough=void 0),_.isNullOrUndefined(this.boldBidi)||this.boldBidi===e.boldBidi||(this.boldBidi=void 0),_.isNullOrUndefined(this.italicBidi)||this.italicBidi===e.italicBidi||(this.italicBidi=void 0),0!==this.fontSizeBidi&&this.fontSizeBidi!==e.fontSizeBidi&&(this.fontSizeBidi=0),_.isNullOrUndefined(this.fontFamilyBidi)||this.fontFamilyBidi===e.fontFamilyBidi||(this.fontFamilyBidi=void 0),_.isNullOrUndefined(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),_.isNullOrUndefined(this.bdo)||this.bdo===e.bdo||(this.bdo=void 0),_.isNullOrUndefined(this.allCaps)||this.allCaps===e.allCaps||(this.allCaps=void 0)},xm.prototype.canRetrieveNextCharacterFormat=function(){return!(_.isNullOrUndefined(this.bold)&&_.isNullOrUndefined(this.italic)&&0===this.fontSize&&_.isNullOrUndefined(this.fontFamily)&&_.isNullOrUndefined(this.highlightColor)&&_.isNullOrUndefined(this.baselineAlignment)&&_.isNullOrUndefined(this.fontColor)&&_.isNullOrUndefined(this.underline)&&_.isNullOrUndefined(this.strikethrough)&&_.isNullOrUndefined(this.boldBidi)&&_.isNullOrUndefined(this.italicBidi)&&0===this.fontSizeBidi&&_.isNullOrUndefined(this.fontFamilyBidi)&&_.isNullOrUndefined(this.bdo)&&_.isNullOrUndefined(this.allCaps))},xm.prototype.cloneFormat=function(e){this.bold=e.bold,this.italic=e.italic,this.underline=e.underline,this.strikethrough=e.strikethrough,this.baselineAlignment=e.baselineAlignment,this.highlightColor=e.highlightColor,this.fontSize=e.fontSize,this.fontFamily=e.fontFamily,this.fontColor=e.fontColor,this.styleName=e.styleName,this.bidi=e.bidi,this.bdo=e.bdo,this.boldBidi=e.boldBidi,this.italicBidi=e.italicBidi,this.fontSizeBidi=e.fontSizeBidi,this.fontFamilyBidi=e.fontFamilyBidi,this.allCaps=e.allCaps},xm.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.strikethrough===e.strikethrough&&this.bold===e.bold&&this.fontFamily===e.fontFamily&&this.underline===e.underline&&this.highlightColor===e.highlightColor&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.fontColor===e.fontColor&&this.allCaps===e.allCaps},xm.prototype.clearFormat=function(){this.fontSizeIn=0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.highlightColorIn=void 0,this.baselineAlignmentIn=void 0,this.styleName=void 0,this.bidi=void 0,this.bdo=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontFamilyBidi=void 0,this.fontSizeBidi=void 0,this.allCapsIn=void 0},xm.prototype.destroy=function(){this.fontSizeIn=void 0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.selection=void 0,this.styleName=void 0,this.bidi=void 0,this.bdo=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontFamilyBidi=void 0,this.fontSizeBidi=void 0,this.allCapsIn=void 0};var bm=xm;function xm(e){this.boldIn=void 0,this.italicIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.fontSizeIn=0,this.scriptType=V.FontScriptType.English,this.fontColorIn=void 0,this.allCapsIn=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontSizeBidi=0,this.bidi=void 0,this.bdo=void 0,this.selection=e}Object.defineProperty(Im.prototype,"color",{get:function(){return this.colorIn},set:function(e){e!==this.colorIn&&(this.colorIn=e,this.notifyPropertyChanged("color"))},enumerable:!0,configurable:!0}),Object.defineProperty(Im.prototype,"lineStyle",{get:function(){return this.lineStyleIn},set:function(e){e!==this.lineStyleIn&&(this.lineStyleIn=e,this.notifyPropertyChanged("lineStyle"))},enumerable:!0,configurable:!0}),Object.defineProperty(Im.prototype,"lineWidth",{get:function(){return this.lineWidthIn},set:function(e){e!==this.lineWidthIn&&(this.lineWidthIn=e,this.notifyPropertyChanged("lineWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(Im.prototype,"shadow",{get:function(){return this.shadowIn},set:function(e){e!==this.shadowIn&&(this.shadowIn=e,this.notifyPropertyChanged("shadow"))},enumerable:!0,configurable:!0}),Object.defineProperty(Im.prototype,"space",{get:function(){return this.spaceIn},set:function(e){e!==this.spaceIn&&(this.spaceIn=e,this.notifyPropertyChanged("space"))},enumerable:!0,configurable:!0}),Im.prototype.copyFormat=function(e){this.color=e.color,this.lineStyle=e.lineStyle,this.lineWidth=e.lineWidth,this.shadow=e.shadow,this.space=e.space},Im.prototype.combineFormat=function(e){_.isNullOrUndefined(this.color)||this.color===e.color||(this.color=void 0),_.isNullOrUndefined(this.lineStyle)||this.lineStyle===e.lineStyle||(this.lineStyle=void 0),_.isNullOrUndefined(this.lineWidth)||this.lineWidth===e.lineWidth||(this.lineWidth=void 0),_.isNullOrUndefined(this.shadow)||this.shadow===e.shadow||(this.shadow=void 0),_.isNullOrUndefined(this.space)||this.space===e.space||(this.space=void 0)},Im.prototype.getPropertyValue=function(e){switch(e){case"color":return this.color;case"lineStyle":return this.lineStyle;case"lineWidth":return this.lineWidth;case"space":return this.space;case"shadow":return this.shadow}},Im.prototype.notifyPropertyChanged=function(e){var t,i;!(_.isNullOrUndefined(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)||_.isNullOrUndefined(this.selection)||_.isNullOrUndefined(this.selection.start)||this.selection.isRetrieveFormatting||(t=this.selection.owner.editorModule,i=this.getPropertyValue(e),_.isNullOrUndefined(i))||t.applyParagraphBorders(e,this.borderType,i)},Im.prototype.destroy=function(){_.isNullOrUndefined(this.colorIn)||(this.colorIn=void 0),_.isNullOrUndefined(this.lineStyleIn)||(this.lineStyleIn=void 0),_.isNullOrUndefined(this.lineWidthIn)||(this.lineWidthIn=void 0),_.isNullOrUndefined(this.spaceIn)||(this.spaceIn=void 0),_.isNullOrUndefined(this.shadowIn)||(this.shadowIn=void 0)};var Cm=Im;function Im(e,t,i){this.colorIn=void 0,this.lineStyleIn=void 0,this.lineWidthIn=void 0,this.shadowIn=void 0,this.spaceIn=void 0,this.borderType=t,this.ownerBase=i,this.selection=e}Object.defineProperty(Fm.prototype,"top",{get:function(){return this.topIn},enumerable:!0,configurable:!0}),Object.defineProperty(Fm.prototype,"bottom",{get:function(){return this.bottomIn},enumerable:!0,configurable:!0}),Object.defineProperty(Fm.prototype,"left",{get:function(){return this.leftIn},enumerable:!0,configurable:!0}),Object.defineProperty(Fm.prototype,"right",{get:function(){return this.rightIn},enumerable:!0,configurable:!0}),Object.defineProperty(Fm.prototype,"horizontal",{get:function(){return this.horizontalIn},enumerable:!0,configurable:!0}),Object.defineProperty(Fm.prototype,"vertical",{get:function(){return this.verticalIn},enumerable:!0,configurable:!0}),Fm.prototype.copyFormat=function(e){this.top.copyFormat(e.top),this.bottom.copyFormat(e.bottom),this.left.copyFormat(e.left),this.right.copyFormat(e.right),this.horizontal.copyFormat(e.horizontal),this.vertical.copyFormat(e.vertical)},Fm.prototype.combineFormat=function(e){this.top.combineFormat(e.top),this.bottom.combineFormat(e.bottom),this.left.combineFormat(e.left),this.right.combineFormat(e.right),this.vertical.combineFormat(e.vertical),this.horizontal.combineFormat(e.horizontal)},Fm.prototype.destroy=function(){_.isNullOrUndefined(this.topIn)||(this.topIn.destroy(),this.topIn=void 0),_.isNullOrUndefined(this.topIn)||(this.bottomIn.destroy(),this.bottomIn=void 0),_.isNullOrUndefined(this.leftIn)||(this.leftIn.destroy(),this.leftIn=void 0),_.isNullOrUndefined(this.rightIn)||(this.rightIn.destroy(),this.rightIn=void 0),_.isNullOrUndefined(this.horizontalIn)||(this.horizontalIn.destroy(),this.horizontalIn=void 0),_.isNullOrUndefined(this.verticalIn)||(this.verticalIn.destroy(),this.verticalIn=void 0)};var km=Fm;function Fm(e,t){this.ownerBase=void 0,this.ownerBase=t,this.selection=e,this.topIn=new Cm(this.selection,"topBorder",this),this.bottomIn=new Cm(this.selection,"bottomBorder",this),this.rightIn=new Cm(this.selection,"rightBorder",this),this.leftIn=new Cm(this.selection,"leftBorder",this),this.horizontalIn=new Cm(this.selection,"horizontalBorder",this),this.verticalIn=new Cm(this.selection,"verticalBorder",this)}Object.defineProperty(Tm.prototype,"borders",{get:function(){return this.bordersIn},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"rightIndent",{get:function(){return this.rightIndentIn},set:function(e){e!==this.rightIndentIn&&(this.rightIndentIn=e,this.notifyPropertyChanged("rightIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"firstLineIndent",{get:function(){return this.firstLineIndentIn},set:function(e){e!==this.firstLineIndentIn&&(this.firstLineIndentIn=e,this.notifyPropertyChanged("firstLineIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"textAlignment",{get:function(){return this.textAlignmentIn},set:function(e){e!==this.textAlignmentIn&&(this.textAlignmentIn=e,this.notifyPropertyChanged("textAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"outlineLevel",{get:function(){return this.outlineLevelIn},set:function(e){e!==this.outlineLevelIn&&(this.outlineLevelIn=e,this.notifyPropertyChanged("outlineLevel"))},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"afterSpacing",{get:function(){return this.afterSpacingIn},set:function(e){e!==this.afterSpacingIn&&(this.afterSpacingIn=e,this.notifyPropertyChanged("afterSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"beforeSpacing",{get:function(){return this.beforeSpacingIn},set:function(e){e!==this.beforeSpacingIn&&(this.beforeSpacingIn=e,this.notifyPropertyChanged("beforeSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"spaceAfterAuto",{get:function(){return this.spaceAfterAutoIn},set:function(e){e!==this.spaceAfterAutoIn&&(this.spaceAfterAutoIn=e,this.notifyPropertyChanged("spaceAfterAuto"))},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"spaceBeforeAuto",{get:function(){return this.spaceBeforeAutoIn},set:function(e){e!==this.spaceBeforeAutoIn&&(this.spaceBeforeAutoIn=e,this.notifyPropertyChanged("spaceBeforeAuto"))},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"lineSpacing",{get:function(){return this.lineSpacingIn},set:function(e){e!==this.lineSpacingIn&&(this.lineSpacingIn=e,this.notifyPropertyChanged("lineSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"lineSpacingType",{get:function(){return this.lineSpacingTypeIn},set:function(e){e!==this.lineSpacingTypeIn&&(this.lineSpacingTypeIn=e,this.notifyPropertyChanged("lineSpacingType"))},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"listLevelNumber",{get:function(){return this.listLevelNumberIn},set:function(e){e!==this.listLevelNumberIn&&(this.listLevelNumberIn=e,this.notifyPropertyChanged("listLevelNumber"))},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"bidi",{get:function(){return this.bidiIn},set:function(e){this.bidiIn=e,this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"keepWithNext",{get:function(){return this.keepWithNextIn},set:function(e){this.keepWithNextIn=e,this.notifyPropertyChanged("keepWithNext")},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"keepLinesTogether",{get:function(){return this.keepLinesTogetherIn},set:function(e){this.keepLinesTogetherIn=e,this.notifyPropertyChanged("keepLinesTogether")},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"widowControl",{get:function(){return this.widowControlIn},set:function(e){this.widowControlIn=e,this.notifyPropertyChanged("widowControl")},enumerable:!0,configurable:!0}),Object.defineProperty(Tm.prototype,"contextualSpacing",{get:function(){return this.contextualSpacingIn},set:function(e){this.contextualSpacingIn=e,this.notifyPropertyChanged("contextualSpacing")},enumerable:!0,configurable:!0}),Tm.prototype.validateLineSpacing=function(){return"Multiple"!==this.lineSpacingType&&this.lineSpacingIn<12},Object.defineProperty(Tm.prototype,"listText",{get:function(){var e=void 0,t=this.documentHelper.getListById(this.listId);if(t instanceof Vu&&-1<this.listLevelNumberIn&&this.listLevelNumberIn<9){var i=t.getListLevel(this.listLevelNumber);if(i instanceof El)if("Bullet"===i.listLevelPattern)e=i.numberFormat;else{e=i.numberFormat;for(var n,r=0;r<9;r++)-1<e.indexOf("%"+(r+1))&&(r===this.listLevelNumberIn||t.getListLevel(r),e=(n=this.selection.getListTextElementBox(this.selection.start.paragraph))?n.text:"")}}return e},enumerable:!0,configurable:!0}),Tm.prototype.getPropertyValue=function(e){switch(e){case"leftIndent":return this.leftIndent;case"rightIndent":return this.rightIndent;case"firstLineIndent":return this.firstLineIndent;case"beforeSpacing":return this.beforeSpacing;case"afterSpacing":return this.afterSpacing;case"spaceAfterAuto":return this.spaceAfterAuto;case"spaceBeforeAuto":return this.spaceBeforeAuto;case"textAlignment":return this.textAlignment;case"lineSpacing":return this.lineSpacing;case"lineSpacingType":return this.lineSpacingType;case"bidi":return this.bidi;case"contextualSpacing":return this.contextualSpacing;case"keepWithNext":return this.keepWithNext;case"keepLinesTogether":return this.keepLinesTogether;case"widowControl":return this.widowControl;case"outlineLevel":return this.outlineLevel;default:return}},Tm.prototype.notifyPropertyChanged=function(e){if((_.isNullOrUndefined(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!_.isNullOrUndefined(this.selection)&&!_.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.selection.owner.editorModule;if("lineSpacing"===e||"lineSpacingType"===e){var i=this.selection.owner.editorHistoryModule;if((!i||!i.isUndoing&&!i.isRedoing)&&this.validateLineSpacing())return this.selection.owner.editorHistoryModule.initComplexHistory(this.selection,"LineSpacing"),"lineSpacing"===e?(this.lineSpacingTypeIn="Multiple",i=this.getPropertyValue("lineSpacingType"),t.onApplyParagraphFormat("lineSpacingType",i,!1,!1),t.onApplyParagraphFormat(e,this.getPropertyValue(e),!1,!1)):(t.onApplyParagraphFormat(e,this.getPropertyValue(e),!1,!1),this.lineSpacingIn=12,t.onApplyParagraphFormat("lineSpacing",this.getPropertyValue("lineSpacing"),!1,!1)),void this.selection.owner.editorHistoryModule.updateComplexHistory()}i=this.getPropertyValue(e);("leftIndent"!==e&&"rightIndent"!==e&&"firstLineIndent"!==e||-1056<=i&&i<1056)&&("listLevelNumber"===e?t.onApplyListInternal(this.documentHelper.getListById(this.listId),this.listLevelNumber):t.onApplyParagraphFormat(e,i,"textAlignment"===e,!1))}},Tm.prototype.copyFormat=function(e){this.styleName=_.isNullOrUndefined(e.baseStyle)?"Normal":e.baseStyle.name,this.leftIndent=e.leftIndent,this.rightIndent=e.rightIndent,this.firstLineIndent=e.firstLineIndent,this.afterSpacing=e.afterSpacing,this.beforeSpacing=e.beforeSpacing,this.spaceAfterAuto=e.spaceAfterAuto,this.spaceBeforeAuto=e.spaceBeforeAuto,this.lineSpacing=e.lineSpacing,this.lineSpacingType=e.lineSpacingType,this.textAlignment=e.textAlignment,this.outlineLevel=e.outlineLevel,this.bidi=e.bidi,this.keepLinesTogether=e.keepLinesTogether,this.keepWithNext=e.keepWithNext,this.widowControl=e.widowControl,this.contextualSpacing=e.contextualSpacing,this.borders.copyFormat(e.borders),_.isNullOrUndefined(e.listFormat)||_.isNullOrUndefined(e.listFormat.listId)?(this.listId=void 0,this.listLevelNumber=0):(this.listId=e.listFormat.listId,this.listLevelNumber=e.listFormat.listLevelNumber)},Tm.prototype.copyToFormat=function(e){_.isNullOrUndefined(e)||(_.isNullOrUndefined(this.afterSpacing)||(e.afterSpacing=this.afterSpacing),_.isNullOrUndefined(this.beforeSpacing)||(e.beforeSpacing=this.beforeSpacing),_.isNullOrUndefined(this.spaceAfterAuto)||(e.spaceAfterAuto=this.spaceAfterAuto),_.isNullOrUndefined(this.spaceBeforeAuto)||(e.spaceBeforeAuto=this.spaceBeforeAuto),_.isNullOrUndefined(this.leftIndent)||(e.leftIndent=this.leftIndent),_.isNullOrUndefined(this.rightIndent)||(e.rightIndent=this.rightIndent),_.isNullOrUndefined(this.textAlignment)||(e.textAlignment=this.textAlignment),_.isNullOrUndefined(this.outlineLevel)||(e.outlineLevel=this.outlineLevel),_.isNullOrUndefined(this.lineSpacing)||(e.lineSpacing=this.lineSpacing),_.isNullOrUndefined(this.lineSpacingType)||(e.lineSpacingType=this.lineSpacingType),_.isNullOrUndefined(this.firstLineIndent)||(e.firstLineIndent=this.firstLineIndent),_.isNullOrUndefined(this.bidi)||(e.bidi=this.bidi),_.isNullOrUndefined(this.keepWithNext)||(e.keepWithNext=this.keepWithNext),_.isNullOrUndefined(this.keepLinesTogether)||(e.keepLinesTogether=this.keepLinesTogether),_.isNullOrUndefined(this.widowControl)||(e.widowControl=this.widowControl),_.isNullOrUndefined(this.contextualSpacing))||(e.contextualSpacing=this.contextualSpacing)},Tm.prototype.combineFormat=function(e){_.isNullOrUndefined(this.leftIndent)||this.leftIndent===e.leftIndent||(this.leftIndent=void 0),_.isNullOrUndefined(this.rightIndent)||this.rightIndent===e.rightIndent||(this.rightIndent=void 0),_.isNullOrUndefined(this.firstLineIndent)||this.firstLineIndent===e.firstLineIndent||(this.firstLineIndent=void 0),0!==this.lineSpacing&&this.lineSpacing!==e.lineSpacing&&(this.lineSpacing=0),-1!==this.beforeSpacing&&this.beforeSpacing!==e.beforeSpacing&&(this.beforeSpacing=-1),-1!==this.afterSpacing&&this.afterSpacing!==e.afterSpacing&&(this.afterSpacing=-1),_.isNullOrUndefined(this.spaceAfterAuto)||this.spaceAfterAuto===e.spaceAfterAuto||(this.spaceAfterAuto=void 0),_.isNullOrUndefined(this.spaceBeforeAuto)||this.spaceBeforeAuto===e.spaceBeforeAuto||(this.spaceBeforeAuto=void 0),_.isNullOrUndefined(this.lineSpacingType)||this.lineSpacingType===e.lineSpacingType||(this.lineSpacingType=void 0),_.isNullOrUndefined(this.textAlignment)||this.textAlignment===e.textAlignment||(this.textAlignment=void 0),_.isNullOrUndefined(this.outlineLevel)||this.outlineLevel===e.outlineLevel||(this.outlineLevel=void 0),0<=this.listLevelNumber&&!_.isNullOrUndefined(this.listId)&&(_.isNullOrUndefined(e.listFormat)||e.listFormat.listLevelNumber!==this.listLevelNumber)&&(this.listLevelNumber=-1),(_.isNullOrUndefined(e.listFormat)||_.isNullOrUndefined(e.listFormat.listId)||!_.isNullOrUndefined(this.listId)&&this.listId!==e.listFormat.listId)&&(this.listId=void 0),_.isNullOrUndefined(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),_.isNullOrUndefined(this.keepLinesTogether)||this.keepLinesTogether===e.keepLinesTogether||(this.keepLinesTogether=void 0),_.isNullOrUndefined(this.keepWithNext)||this.keepWithNext===e.keepWithNext||(this.keepWithNext=void 0),_.isNullOrUndefined(this.widowControl)||this.widowControl===e.widowControl||(this.widowControl=void 0),_.isNullOrUndefined(this.contextualSpacing)||this.contextualSpacing===e.contextualSpacing||(this.contextualSpacing=void 0),!_.isNullOrUndefined(this.styleName)&&e.baseStyle&&this.styleName!==e.baseStyle.name&&(this.styleName=void 0),this.borders.combineFormat(e.borders)},Tm.prototype.clearFormat=function(){this.leftIndent=0,this.rightIndent=0,this.beforeSpacing=0,this.afterSpacing=0,this.spaceAfterAuto=void 0,this.spaceBeforeAuto=void 0,this.firstLineIndent=0,this.lineSpacing=1,this.textAlignment=void 0,this.lineSpacingType=void 0,this.listId=void 0,this.listLevelNumber=-1,this.styleName=void 0,this.bidi=void 0,this.contextualSpacing=void 0},Tm.prototype.getList=function(){var e=this.documentHelper.getListById(this.listId);if(!_.isNullOrUndefined(e)){var t=new Vu,i=new Hl,n=this.documentHelper.getAbstractListById(e.abstractListId),r=this.selection.owner.editorModule;if(_.isNullOrUndefined(n))i.levels.push(new El(i));else for(var o=0;o<n.levels.length;o++){var s=r.cloneListLevel(n.levels[o]);i.levels.push(s),s.ownerBase=i}if(!_.isNullOrUndefined(e.levelOverrides))for(o=0;o<e.levelOverrides.length;o++){var a=r.cloneLevelOverride(e.levelOverrides[o]);t.levelOverrides.push(a)}return t.abstractList=i,t.abstractListId=i.abstractListId,t.sourceListId=e.listId,t}},Tm.prototype.setList=function(e,t){var i,n,r,o;this.documentHelper.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.documentHelper.owner.isDocumentLoaded||(i=this.documentHelper.getListById(this.listId),n=void 0,r=e?this.documentHelper.getAbstractListById(e.abstractListId):void 0,_.isNullOrUndefined(i)||_.isNullOrUndefined(e)||_.isNullOrUndefined(r)||e.sourceListId!==i.listId?_.isNullOrUndefined(e)?this.selection.owner.editorModule.onApplyList(void 0):(this.selection.owner.isLayoutEnabled=!1,_.isNullOrUndefined(r)||-1!==this.documentHelper.abstractLists.indexOf(r)||this.documentHelper.abstractLists.push(r),-1===this.documentHelper.lists.indexOf(e)&&this.documentHelper.lists.push(e),this.selection.owner.isLayoutEnabled=!0,this.selection.owner.editorModule.onApplyList(e)):(o=this.documentHelper.owner.editorHistoryModule,this.documentHelper.layout.getListLevel(i,1),this.selection.owner.isLayoutEnabled=!1,this.documentHelper.owner.editorModule.setOffsetValue(this.selection),o&&(n=o.updateListChangesInHistory(r,i)),this.documentHelper.owner.editorModule.updateListParagraphs(),o&&o.applyListChanges(this.selection,n),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],t&&this.documentHelper.layout.clearInvalidList(e),this.documentHelper.owner.editorModule.layoutWholeDocument(),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!1),o&&o.currentBaseHistoryInfo&&(0<o.currentBaseHistoryInfo.modifiedProperties.length&&o.currentBaseHistoryInfo.updateSelection(),o.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange()))},Tm.prototype.destroy=function(){this.leftIndentIn=void 0,this.rightIndentIn=void 0,this.beforeSpacingIn=void 0,this.afterSpacingIn=void 0,this.spaceBeforeAutoIn=void 0,this.spaceAfterAutoIn=void 0,this.firstLineIndentIn=void 0,this.lineSpacingIn=void 0,this.textAlignmentIn=void 0,this.lineSpacingTypeIn=void 0,this.listId=void 0,this.listLevelNumberIn=void 0,this.documentHelper=void 0,this.selection=void 0,this.styleName=void 0,this.bidi=void 0,this.contextualSpacing=void 0,_.isNullOrUndefined(this.bordersIn)||(this.bordersIn.destroy(),this.bordersIn=void 0)};var Pm=Tm;function Tm(e,t){this.leftIndentIn=0,this.rightIndentIn=0,this.beforeSpacingIn=0,this.afterSpacingIn=0,this.spaceAfterAutoIn=void 0,this.spaceBeforeAutoIn=void 0,this.textAlignmentIn=void 0,this.outlineLevelIn=void 0,this.firstLineIndentIn=0,this.lineSpacingIn=1,this.lineSpacingTypeIn=void 0,this.bidiIn=void 0,this.keepWithNextIn=void 0,this.keepLinesTogetherIn=void 0,this.widowControlIn=void 0,this.contextualSpacingIn=void 0,this.listLevelNumberIn=-1,this.selection=e,this.documentHelper=t,this.bordersIn=new km(this.selection,this)}Object.defineProperty(Hm.prototype,"linkToPrevious",{get:function(){return this.linkToPreviousIn},set:function(e){this.linkToPreviousIn=e,this.notifyPropertyChanged("linkToPrevious")},enumerable:!0,configurable:!0}),Hm.prototype.notifyPropertyChanged=function(e){var t,i,n,r=this.selection;!_.isNullOrUndefined(r)&&(r.isCleared||r.owner.isPastingContent||r.owner.isReadOnlyMode||!r.owner.isDocumentLoaded)&&!r.isRetrieveFormatting||_.isNullOrUndefined(r)||_.isNullOrUndefined(r.start)||r.isRetrieveFormatting||(t=this.getPropertyvalue(e),_.isNullOrUndefined(t))||(i=(n=r.start.paragraph.bodyWidget).sectionIndex,n=n.headerFooterType,r.owner.editorModule.removeInlineHeaderFooterWidget(i,n,e,t))},Hm.prototype.getPropertyvalue=function(e){if("linkToPrevious"==e&&!_.isNullOrUndefined(this.linkToPrevious))return this.linkToPrevious};var Sm=Hm;function Hm(e){this.linkToPreviousIn=!0,this.selection=e}Object.defineProperty(Wm.prototype,"pageHeight",{get:function(){return this.pageHeightIn},set:function(e){this.pageHeightIn=e,this.notifyPropertyChanged("pageHeight")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"pageWidth",{get:function(){return this.pageWidthIn},set:function(e){this.pageWidthIn=e,this.notifyPropertyChanged("pageWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){this.topMarginIn=e,this.notifyPropertyChanged("topMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"headerDistance",{get:function(){return this.headerDistanceIn},set:function(e){this.headerDistanceIn=e,this.notifyPropertyChanged("headerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"firstPageHeader",{get:function(){return this.firstPageHeaderIn},set:function(e){this.firstPageHeaderIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"firstPageFooter",{get:function(){return this.firstPageFooterIn},set:function(e){this.firstPageFooterIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"oddPageHeader",{get:function(){return this.oddPageHeaderIn},set:function(e){this.oddPageHeaderIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"oddPageFooter",{get:function(){return this.oddPageFooterIn},set:function(e){this.oddPageFooterIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"evenPageHeader",{get:function(){return this.evenPageHeaderIn},set:function(e){this.evenPageHeaderIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"evenPageFooter",{get:function(){return this.evenPageFooterIn},set:function(e){this.evenPageFooterIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"pageStartingNumber",{get:function(){return this.pageStartingNumberIn},set:function(e){this.pageStartingNumberIn=e,this.notifyPropertyChanged("pageStartingNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"restartPageNumbering",{get:function(){return this.restartPageNumberingIn},set:function(e){this.restartPageNumberingIn=e,this.notifyPropertyChanged("restartPageNumbering")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"footerDistance",{get:function(){return this.footerDistanceIn},set:function(e){this.footerDistanceIn=e,this.notifyPropertyChanged("footerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"differentFirstPage",{get:function(){return this.differentFirstPageIn},set:function(e){this.differentFirstPageIn=e,this.notifyPropertyChanged("differentFirstPage")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"differentOddAndEvenPages",{get:function(){return this.differentOddAndEvenPagesIn},set:function(e){this.differentOddAndEvenPagesIn=e,this.notifyPropertyChanged("differentOddAndEvenPages")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"endnoteNumberFormat",{get:function(){return this.endnoteNumberFormatIn},set:function(e){this.endnoteNumberFormatIn=e,this.notifyPropertyChanged("endnoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"footNoteNumberFormat",{get:function(){return this.footNoteNumberFormatIn},set:function(e){this.footNoteNumberFormatIn=e,this.notifyPropertyChanged("footNoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"initialFootNoteNumber",{get:function(){return this.initialFootNoteNumberIn},set:function(e){this.initialFootNoteNumberIn=e,this.notifyPropertyChanged("initialFootNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"initialEndNoteNumber",{get:function(){return this.initialEndNoteNumberIn},set:function(e){this.initialEndNoteNumberIn=e,this.notifyPropertyChanged("initialEndNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"restartIndexForFootnotes",{get:function(){return this.restartIndexForFootnotesIn},set:function(e){this.restartIndexForFootnotesIn=e,this.notifyPropertyChanged("restartIndexForFootnotes")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"restartIndexForEndnotes",{get:function(){return this.restartIndexForEndnotesIn},set:function(e){this.restartIndexForEndnotesIn=e,this.notifyPropertyChanged("restartIndexForEndnotes")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"numberOfColumns",{get:function(){return 0==this.columns.length?1:this.columns.length},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"equalWidth",{get:function(){return this.equalWidthIn},set:function(e){this.equalWidthIn=e,this.notifyPropertyChanged("equalWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"lineBetweenColumns",{get:function(){return this.lineBetweenColumnsIn},set:function(e){this.lineBetweenColumnsIn=e,this.notifyPropertyChanged("lineBetweenColumns")},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"columns",{get:function(){return this.columnsIn},set:function(e){this.columnsIn=e;var t=this.selection;!_.isNullOrUndefined(t)&&(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode||!t.owner.isDocumentLoaded)&&!t.isRetrieveFormatting||_.isNullOrUndefined(t)||_.isNullOrUndefined(t.start)||t.isRetrieveFormatting||this.selection.owner.editorModule.onApplyColumnFormat("columns",e)},enumerable:!0,configurable:!0}),Object.defineProperty(Wm.prototype,"breakCode",{get:function(){return this.breakCodeIn},set:function(e){this.breakCodeIn=e,this.notifyPropertyChanged("breakCode")},enumerable:!0,configurable:!0}),Wm.prototype.copyFormat=function(e){this.pageHeight=e.pageHeight,this.pageWidth=e.pageWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.headerDistance=e.headerDistance,this.footerDistance=e.footerDistance,this.differentFirstPage=e.differentFirstPage,this.differentOddAndEvenPages=e.differentOddAndEvenPages,this.bidi=e.bidi,this.pageStartingNumber=e.pageStartingNumber,this.restartPageNumbering=e.restartPageNumbering,this.endnoteNumberFormat=e.endnoteNumberFormat,this.footNoteNumberFormat=e.footNoteNumberFormat,this.restartIndexForEndnotes=e.restartIndexForEndnotes,this.restartIndexForFootnotes=e.restartIndexForFootnotes,this.initialEndNoteNumber=e.initialEndNoteNumber,this.initialFootNoteNumber=e.initialFootNoteNumber,this.equalWidth=e.equalWidth,this.lineBetweenColumns=e.lineBetweenColumns,this.columns=[];for(var t=0,i=e.columns;t<i.length;t++){var n=i[t],r=new Um(this.selection);r.width=j.convertPixelToPoint(n.width),r.space=j.convertPixelToPoint(n.space),this.columns.push(r)}if(this.breakCode=e.breakCode,this.selection.owner.enableHeaderAndFooter){var e=this.selection.documentHelper.headersFooters,o=this.selection.start.paragraph.containerWidget,s=o.sectionIndex,o=o.headerFooterType,a=!1;if(0==s)this.oddPageHeader.linkToPrevious=!1,this.oddPageFooter.linkToPrevious=!1,this.evenPageHeader.linkToPrevious=!1,this.evenPageFooter.linkToPrevious=!1,this.firstPageHeader.linkToPrevious=!1,this.firstPageFooter.linkToPrevious=!1;else if(e[s]){var l=this.selection.viewer.getHeaderFooter(o),e=e[s][l];if(_.isNullOrUndefined(e)&&(a=!0),!_.isNullOrUndefined(e)||a)switch(o){case"OddHeader":this.oddPageHeader.linkToPrevious=!!a;break;case"OddFooter":this.oddPageFooter.linkToPrevious=!!a;break;case"EvenHeader":this.evenPageHeader.linkToPrevious=!!a;break;case"EvenFooter":this.evenPageFooter.linkToPrevious=!!a;break;case"FirstPageHeader":this.firstPageHeader.linkToPrevious=!!a;break;case"FirstPageFooter":this.firstPageFooter.linkToPrevious=!!a}}}},Wm.prototype.applyColumnFormat=function(){},Wm.prototype.notifyPropertyChanged=function(e){var t,i=this.selection;!_.isNullOrUndefined(i)&&(i.isCleared||i.owner.isPastingContent||i.owner.isReadOnlyMode||!i.owner.isDocumentLoaded)&&!i.isRetrieveFormatting||_.isNullOrUndefined(i)||_.isNullOrUndefined(i.start)||i.isRetrieveFormatting||(t=this.getPropertyvalue(e),_.isNullOrUndefined(t))||i.owner.editorModule.onApplySectionFormat(e,t)},Wm.prototype.getPropertyvalue=function(e){switch(e){case"pageHeight":return 0<this.pageHeight?this.pageHeight:void 0;case"pageWidth":return 0<this.pageWidth?this.pageWidth:void 0;case"leftMargin":return 0<=this.leftMargin?this.leftMargin:void 0;case"rightMargin":return 0<=this.rightMargin?this.rightMargin:void 0;case"topMargin":return 0<=this.topMargin?this.topMargin:void 0;case"bottomMargin":return 0<=this.bottomMargin?this.bottomMargin:void 0;case"differentFirstPage":return _.isNullOrUndefined(this.differentFirstPage)?void 0:this.differentFirstPage;case"differentOddAndEvenPages":return _.isNullOrUndefined(this.differentOddAndEvenPages)?void 0:this.differentOddAndEvenPages;case"headerDistance":return this.headerDistanceIn;case"footerDistance":return this.footerDistance;case"pageStartingNumber":return _.isNullOrUndefined(this.pageStartingNumber)?void 0:this.pageStartingNumber;case"restartPageNumbering":return _.isNullOrUndefined(this.restartPageNumbering)?void 0:this.restartPageNumbering;case"endnoteNumberFormat":return this.endnoteNumberFormatIn;case"restartIndexForEndnotes":return this.restartIndexForEndnotesIn;case"restartIndexForFootnotes":return this.restartIndexForFootnotesIn;case"footNoteNumberFormat":return this.footNoteNumberFormatIn;case"initialFootNoteNumber":return this.initialFootNoteNumber;case"initialEndNoteNumber":return this.initialEndNoteNumber;case"equalWidth":return this.equalWidthIn;case"lineBetweenColumns":return this.lineBetweenColumnsIn;case"columns":return this.columnsIn;case"breakCode":return this.breakCodeIn;default:return}},Wm.prototype.combineFormat=function(e){0<this.pageHeight&&this.pageHeight!==e.pageHeight&&(this.pageHeight=0),0<this.pageWidth&&this.pageWidth!==e.pageWidth&&(this.pageWidth=0),-1<this.leftMargin&&this.leftMargin!==e.leftMargin&&(this.leftMargin=-1),-1<this.topMargin&&this.topMargin!==e.topMargin&&(this.topMargin=-1),-1<this.rightMargin&&this.rightMargin!==e.rightMargin&&(this.rightMargin=-1),-1<this.bottomMargin&&this.bottomMargin!==e.bottomMargin&&(this.bottomMargin=-1),0!==this.headerDistance&&this.headerDistance!==e.headerDistance&&(this.headerDistance=0),0!==this.footerDistance&&this.footerDistance!==e.footerDistance&&(this.footerDistance=0),_.isNullOrUndefined(this.differentFirstPage)||this.differentFirstPage===e.differentFirstPage||(this.differentFirstPage=void 0),_.isNullOrUndefined(this.pageStartingNumber)||this.pageStartingNumber===e.pageStartingNumber||(this.pageStartingNumber=void 0),_.isNullOrUndefined(this.restartPageNumbering)||this.restartPageNumbering===e.restartPageNumbering||(this.restartPageNumbering=void 0),_.isNullOrUndefined(this.differentOddAndEvenPages)||this.differentOddAndEvenPages===e.differentOddAndEvenPages||(this.differentOddAndEvenPages=void 0),_.isNullOrUndefined(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),_.isNullOrUndefined(this.endnoteNumberFormat)||this.endnoteNumberFormat===e.endnoteNumberFormat||(this.endnoteNumberFormat=void 0),_.isNullOrUndefined(this.restartIndexForEndnotes)||this.restartIndexForEndnotes===e.restartIndexForEndnotes||(this.restartIndexForEndnotes=void 0),_.isNullOrUndefined(this.restartIndexForFootnotes)||this.restartIndexForFootnotes===e.restartIndexForFootnotes||(this.restartIndexForFootnotes=void 0),_.isNullOrUndefined(this.footNoteNumberFormat)||this.footNoteNumberFormat===e.footNoteNumberFormat||(this.footNoteNumberFormat=void 0),_.isNullOrUndefined(this.initialFootNoteNumber)||this.initialFootNoteNumber===e.initialFootNoteNumber||(this.initialFootNoteNumber=void 0),_.isNullOrUndefined(this.initialEndNoteNumber)||this.initialEndNoteNumber===e.initialEndNoteNumber||(this.initialEndNoteNumber=void 0)},Wm.prototype.clearFormat=function(){this.headerDistance=0,this.footerDistance=0,this.pageHeight=0,this.pageWidth=0,this.leftMargin=-1,this.rightMargin=-1,this.topMargin=-1,this.bottomMargin=-1,this.differentFirstPage=void 0,this.differentOddAndEvenPages=void 0,this.bidi=void 0,this.pageStartingNumber=void 0,this.restartPageNumbering=void 0,this.endnoteNumberFormat=void 0,this.footNoteNumberFormat=void 0,this.restartIndexForFootnotes=void 0,this.restartIndexForEndnotes=void 0,this.initialFootNoteNumber=1,this.initialEndNoteNumber=1},Wm.prototype.destroy=function(){this.headerDistanceIn=void 0,this.footerDistanceIn=void 0,this.pageHeightIn=void 0,this.pageWidthIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.selection=void 0,this.bidi=void 0,this.pageStartingNumberIn=void 0,this.restartPageNumberingIn=void 0,this.endnoteNumberFormatIn=void 0,this.footNoteNumberFormatIn=void 0,this.restartIndexForFootnotesIn=void 0,this.restartIndexForEndnotesIn=void 0,this.initialEndNoteNumber=void 0,this.initialFootNoteNumber=void 0,this.firstPageHeaderIn=void 0,this.firstPageFooterIn=void 0,this.oddPageHeaderIn=void 0,this.oddPageFooterIn=void 0,this.evenPageHeaderIn=void 0,this.evenPageFooterIn=void 0};var Nm=Wm;function Wm(e){this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.bidi=void 0,this.selection=e,this.firstPageHeaderIn=new Sm(e),this.firstPageFooterIn=new Sm(e),this.oddPageHeaderIn=new Sm(e),this.oddPageFooterIn=new Sm(e),this.evenPageHeaderIn=new Sm(e),this.evenPageFooterIn=new Sm(e)}Object.defineProperty(Em.prototype,"table",{get:function(){return this.tableIn},set:function(e){this.tableIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"title",{get:function(){return this.titleIn},set:function(e){_.isNullOrUndefined(this.table)||(this.titleIn=e,this.notifyPropertyChanged("title"))},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"description",{get:function(){return this.descriptionIn},set:function(e){_.isNullOrUndefined(this.table)||(this.descriptionIn=e,this.notifyPropertyChanged("description"))},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"tableAlignment",{get:function(){return this.tableAlignmentIn},set:function(e){e!==this.tableAlignmentIn&&(this.tableAlignmentIn=e,this.notifyPropertyChanged("tableAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"cellSpacing",{get:function(){return this.cellSpacingIn},set:function(e){e!==this.cellSpacingIn&&(this.cellSpacingIn=e,this.notifyPropertyChanged("cellSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(Em.prototype,"bidi",{get:function(){return this.bidiIn},set:function(e){this.bidiIn=e,this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),Em.prototype.getPropertyValue=function(e){switch(e){case"tableAlignment":return this.tableAlignment;case"leftIndent":return this.leftIndent;case"cellSpacing":return this.cellSpacing;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"background":var t=new Il;return t.backgroundColor=this.background,t;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"bidi":return this.bidi;case"title":return this.title;case"description":return this.description;default:return}},Em.prototype.notifyPropertyChanged=function(e){var t;!_.isNullOrUndefined(this.selection)&&(this.selection.isCleared||!this.selection.owner.isDocumentLoaded||this.selection.owner.isReadOnlyMode||this.selection.owner.isPastingContent)&&!this.selection.isRetrieveFormatting||_.isNullOrUndefined(this.selection)||_.isNullOrUndefined(this.selection.start)||this.selection.isRetrieveFormatting||(t=this.getPropertyValue(e),"background"===e&&(e="shading"),_.isNullOrUndefined(t))||this.selection.owner.editorModule.onApplyTableFormat(e,t)},Em.prototype.copyFormat=function(e){this.leftIndent=e.leftIndent,this.background=e.shading.backgroundColor,this.tableAlignment=e.tableAlignment,this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.cellSpacing=e.cellSpacing,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType,this.bidi=e.bidi,this.title=e.title,this.description=e.description},Em.prototype.clearFormat=function(){this.table=void 0,this.leftIndent=0,this.background=void 0,this.leftIndent=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.bottomMargin=0,this.cellSpacing=0,this.tableAlignment=void 0,this.bidi=void 0},Em.prototype.destroy=function(){this.leftIndentIn=void 0,this.backgroundIn=void 0,this.leftIndentIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.cellSpacingIn=void 0,this.tableAlignmentIn=void 0,this.tableIn=void 0,this.selection=void 0,this.bidi=void 0};var Om=Em;function Em(e){this.leftIndentIn=0,this.backgroundIn=void 0,this.tableAlignmentIn=void 0,this.cellSpacingIn=0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.preferredWidthIn=0,this.bidiIn=void 0,this.selection=e}Object.defineProperty(Bm.prototype,"verticalAlignment",{get:function(){return this.verticalAlignmentIn},set:function(e){e!==this.verticalAlignmentIn&&(this.verticalAlignmentIn=e,this.notifyPropertyChanged("verticalAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(Bm.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(Bm.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(Bm.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(Bm.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(Bm.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(Bm.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(Bm.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),Bm.prototype.notifyPropertyChanged=function(e){var t=this.selection;_.isNullOrUndefined(t)||(t.isCleared||!t.owner.isDocumentLoaded||t.owner.isReadOnlyMode||t.owner.isPastingContent)&&!t.isRetrieveFormatting||_.isNullOrUndefined(this.selection.start)||this.selection.isRetrieveFormatting||(t=this.getPropertyValue(e),"background"===e&&(e="shading"),_.isNullOrUndefined(t))||this.selection.owner.editorModule.onApplyTableCellFormat(e,t)},Bm.prototype.getPropertyValue=function(e){switch(e){case"verticalAlignment":return this.verticalAlignment;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"background":var t=new Il;return t.backgroundColor=this.background,t;default:return}},Bm.prototype.copyFormat=function(e){this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.background=e.shading.backgroundColor,this.verticalAlignment=e.verticalAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType},Bm.prototype.clearCellFormat=function(){this.leftMargin=void 0,this.rightMargin=void 0,this.topMargin=void 0,this.bottomMargin=void 0,this.background=void 0,this.verticalAlignment=void 0},Bm.prototype.combineFormat=function(e){_.isNullOrUndefined(this.leftMargin)||this.leftMargin===e.leftMargin||(this.leftMargin=void 0),_.isNullOrUndefined(this.topMargin)||this.topMargin===e.topMargin||(this.topMargin=void 0),_.isNullOrUndefined(this.rightMargin)||this.rightMargin===e.rightMargin||(this.rightMargin=void 0),_.isNullOrUndefined(this.bottomMargin)||this.bottomMargin===e.bottomMargin||(this.bottomMargin=void 0),_.isNullOrUndefined(this.background)||this.background===e.shading.backgroundColor||(this.background=void 0),_.isNullOrUndefined(this.verticalAlignment)||this.verticalAlignment===e.verticalAlignment||(this.verticalAlignment=void 0),_.isNullOrUndefined(this.preferredWidth)||this.preferredWidth===e.preferredWidth||(this.preferredWidth=void 0),_.isNullOrUndefined(this.preferredWidthType)||this.preferredWidthType===e.preferredWidthType||(this.preferredWidthType=void 0)},Bm.prototype.clearFormat=function(){this.background=void 0,this.bottomMargin=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.verticalAlignment=void 0},Bm.prototype.destroy=function(){this.backgroundIn=void 0,this.verticalAlignmentIn=void 0,this.bottomMarginIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.selection=void 0};var Lm=Bm;function Bm(e){this.verticalAlignmentIn=void 0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.backgroundIn=void 0,this.preferredWidthTypeIn=void 0,this.selection=e}Object.defineProperty(Mm.prototype,"height",{get:function(){return this.heightIn},set:function(e){e!==this.heightIn&&(this.heightIn=e,this.notifyPropertyChanged("height"))},enumerable:!0,configurable:!0}),Object.defineProperty(Mm.prototype,"heightType",{get:function(){return this.heightTypeIn},set:function(e){e!==this.heightTypeIn&&(this.heightTypeIn=e,this.notifyPropertyChanged("heightType"))},enumerable:!0,configurable:!0}),Object.defineProperty(Mm.prototype,"isHeader",{get:function(){return this.isHeaderIn},set:function(e){e!==this.isHeaderIn&&(this.isHeaderIn=e,this.notifyPropertyChanged("isHeader"))},enumerable:!0,configurable:!0}),Object.defineProperty(Mm.prototype,"allowBreakAcrossPages",{get:function(){return this.allowRowBreakAcrossPagesIn},set:function(e){e!==this.allowRowBreakAcrossPagesIn&&(this.allowRowBreakAcrossPagesIn=e,this.notifyPropertyChanged("allowBreakAcrossPages"))},enumerable:!0,configurable:!0}),Mm.prototype.notifyPropertyChanged=function(e){var t,i=this.selection;!_.isNullOrUndefined(i)&&(i.isCleared||i.owner.isReadOnlyMode||!i.owner.isDocumentLoaded||i.owner.isPastingContent)&&!i.isRetrieveFormatting||_.isNullOrUndefined(i)||_.isNullOrUndefined(i.start)||i.isRetrieveFormatting||(t=this.getPropertyValue(e),_.isNullOrUndefined(t))||i.owner.editorModule.onApplyTableRowFormat(e,t)},Mm.prototype.getPropertyValue=function(e){switch(e){case"height":return this.height;case"heightType":return this.heightType;case"isHeader":return this.isHeader;case"allowBreakAcrossPages":return this.allowBreakAcrossPages;default:return}},Mm.prototype.copyFormat=function(e){this.height=e.height,this.heightType=e.heightType,this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader},Mm.prototype.combineFormat=function(e){_.isNullOrUndefined(this.height)||this.height===e.height||(this.height=void 0),_.isNullOrUndefined(this.heightType)||this.heightType===e.heightType||(this.heightType=void 0),_.isNullOrUndefined(this.allowBreakAcrossPages)||this.allowBreakAcrossPages===e.allowBreakAcrossPages||(this.allowBreakAcrossPages=void 0),_.isNullOrUndefined(this.isHeader)||this.isHeader===e.isHeader||(this.isHeader=void 0)},Mm.prototype.clearRowFormat=function(){this.height=void 0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},Mm.prototype.clearFormat=function(){this.height=0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},Mm.prototype.destroy=function(){this.heightIn=void 0,this.heightTypeIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.isHeaderIn=void 0,this.selection=void 0};var Rm=Mm;function Mm(e){this.heightIn=void 0,this.heightTypeIn=void 0,this.isHeaderIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.selection=e}Object.defineProperty(Dm.prototype,"width",{get:function(){return this.image?this.image.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(Dm.prototype,"height",{get:function(){return this.image?this.image.height:0},enumerable:!0,configurable:!0}),Object.defineProperty(Dm.prototype,"alternateText",{get:function(){return this.image?this.image.alternateText:null},set:function(e){e!==this.alternateText&&(this.image.alternateText=e)},enumerable:!0,configurable:!0}),Dm.prototype.resize=function(e,t){this.updateImageFormat(e,t,this.alternateText)},Dm.prototype.applyImageAlternativeText=function(e){this.updateImageFormat(this.width,this.height,e)},Dm.prototype.updateImageFormat=function(e,t,i){this.image&&this.selection.owner.editorModule&&this.selection.owner.editorModule.onImageFormat(this.image,e,t,i)},Dm.prototype.copyImageFormat=function(e){this.image=e},Dm.prototype.clearImageFormat=function(){this.image=void 0};var Am=Dm;function Dm(e){this.selection=e}Vm.prototype.copyFormat=function(e){this.width=e.width,this.space=e.space},Object.defineProperty(Vm.prototype,"width",{get:function(){return this.widthIn},set:function(e){e!==this.widthIn&&(this.widthIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(Vm.prototype,"space",{get:function(){return this.spaceIn},set:function(e){e!==this.spaceIn&&(this.spaceIn=e)},enumerable:!0,configurable:!0}),Vm.prototype.getPropertyValue=function(e){switch(e){case"space":return this.space;case"width":return this.width;default:return}},Vm.prototype.notifyPropertyChanged=function(e){var t=this.selection;_.isNullOrUndefined(t)||this.selection.owner.editorModule.onApplyColumnFormat("columns",this.selection.sectionFormat.columns)},Vm.prototype.clearFormat=function(){this.widthIn=0,this.spaceIn=0},Vm.prototype.destroy=function(){this.widthIn=void 0,this.spaceIn=void 0};var Um=Vm;function Vm(e){this.widthIn=0,this.spaceIn=0,this.selection=e}qm.prototype.writeHtml=function(e,t){this.keywordIndex=t?1:0;var i="";(this.document=e).hasOwnProperty(Pa[this.keywordIndex])&&this.serializeImages(e[Pa[this.keywordIndex]]);for(var n=0;n<e[Re[this.keywordIndex]].length;n++)i+=this.serializeSection(e[Re[this.keywordIndex]][n]);return i},qm.prototype.serializeImages=function(e){for(var t in this.images=new T,e){var i;Array.isArray(e[""+t])?this.images.add(parseInt(t),e[""+t]):((i=[]).push(e[""+t]),this.images.add(parseInt(t),i))}},qm.prototype.serializeSection=function(e){for(var t="",i=void 0,n=[],r=0;r<e[S[this.keywordIndex]].length;r++){var o=e[S[this.keywordIndex]][r];o.hasOwnProperty(ko[this.keywordIndex])?(t+=this.serializeParagraph(o,n),i=this.getListLevel(o)):o.hasOwnProperty(S[this.keywordIndex])?t+=this.serializeSection(o):t=(t+=this.closeList())+this.serializeTable(o)}if(0<n.length&&(_.isNullOrUndefined(i)||_.isNullOrUndefined(this.prevListLevel)||this.prevListLevel[Ss[this.keywordIndex]]===i[Ss[this.keywordIndex]]&&this.prevListLevel[De[this.keywordIndex]][_t[this.keywordIndex]]===i[De[this.keywordIndex]][_t[this.keywordIndex]]))for(;0<n.length;)t+=this.closeList(),n.pop();return t+=this.closeList(),this.prevListLevel=void 0,this.isOrdered=void 0,t},qm.prototype.serializeParagraph=function(e,t){var i="",n=!1,r=!1,o=void 0,s=0,a=(_.isNullOrUndefined(this.prevListLevel)||(r=!0),[]),l=void 0;if(_.isNullOrUndefined(e[De[this.keywordIndex]][ei[this.keywordIndex]])||(l=this.getListLevel(e),r||(this.prevListLevel=l),this.prevListLevel!==l&&(r=!1),_.isNullOrUndefined(t)||_.isNullOrUndefined(l)||_.isNullOrUndefined(this.prevListLevel)||!(this.prevListLevel[Ss[this.keywordIndex]]<l[Ss[this.keywordIndex]]&&this.prevListLevel!==l||this.prevListLevel[De[this.keywordIndex]][_t[this.keywordIndex]]!==l[De[this.keywordIndex]][_t[this.keywordIndex]])||(t.push(t.length),o=this.prevListLevel[Ss[this.keywordIndex]],s=this.prevListLevel[De[this.keywordIndex]][_t[this.keywordIndex]]),this.prevListLevel=l),!_.isNullOrUndefined(t)&&0<t.length&&(_.isNullOrUndefined(l)||_.isNullOrUndefined(this.prevListLevel)||this.prevListLevel[Ss[this.keywordIndex]]===o&&this.prevListLevel[De[this.keywordIndex]][_t[this.keywordIndex]]===s))for(;0<t.length;)i+=this.closeList(),t.pop();return r||t&&0!==t.length||(i+=this.closeList()),(n=_.isNullOrUndefined(l)?n:!0)&&!r&&(i+=this.getHtmlList(l,e[De[this.keywordIndex]][ei[this.keywordIndex]][qt[this.keywordIndex]])),a.push('style="'+this.serializeParagraphStyle(e,"",n)+';white-space:pre"'),n?i+=this.createAttributesTag("li",a):(this.prevListLevel=void 0,this.isOrdered=void 0,i+=this.createAttributesTag(this.getStyleName(e[De[this.keywordIndex]][Pt[this.keywordIndex]]),a)),0===e[ko[this.keywordIndex]].length?i+="<span />":i=this.serializeInlines(e,i),n?-1<(i+=this.endTag("li")).indexOf("<ul")?this.isOrdered=!1:-1<i.indexOf("<ol")&&(this.isOrdered=!0):i+=this.endTag(this.getStyleName(e[De[this.keywordIndex]][Pt[this.keywordIndex]])),i},qm.prototype.closeList=function(){var e="";return _.isNullOrUndefined(this.isOrdered)||(e=this.isOrdered?this.endTag("ol"):this.endTag("ul"),this.isOrdered=void 0),e},qm.prototype.getListLevel=function(e){for(var t=void 0,i=void 0,n=0;n<this.document[Ue[this.keywordIndex]].length;n++)if(this.document[Ue[this.keywordIndex]][n][Ut[this.keywordIndex]]===e[De[this.keywordIndex]][ei[this.keywordIndex]][Ut[this.keywordIndex]]){i=this.document[Ue[this.keywordIndex]][n];break}if(i)for(var r=0;r<this.document[Ve[this.keywordIndex]].length;r++)if(this.document[Ve[this.keywordIndex]][r][Os[this.keywordIndex]]===i[Os[this.keywordIndex]]){var o=e[De[this.keywordIndex]][ei[this.keywordIndex]][qt[this.keywordIndex]],t=this.document[Ve[this.keywordIndex]][r][Ls[this.keywordIndex]][o];break}return t},qm.prototype.getHtmlList=function(e,t){var i="";if(e[Fs[this.keywordIndex]]===(1==this.keywordIndex?10:"Bullet")){switch(i+='<ul type="',t){case 0:i+="disc",e[Ae[this.keywordIndex]][Ft[this.keywordIndex]]="Symbol";break;case 1:i+="circle",e[Ae[this.keywordIndex]][Ft[this.keywordIndex]]="Symbol";break;case 2:i+="square",e[Ae[this.keywordIndex]][Ft[this.keywordIndex]]="Wingdings";break;default:i+="disc",e[Ae[this.keywordIndex]][Ft[this.keywordIndex]]="Symbol"}i+='">'}else{switch(i+='<ol type="',e[Fs[this.keywordIndex]]){case"UpRoman":case 2:i+="I";break;case"LowRoman":case 3:i+="i";break;case"UpLetter":case 4:i+="A";break;case"LowLetter":case 5:i+="a";break;default:i+="1"}i+='" start="'+e[Ts[this.keywordIndex]].toString()+'">'}return i},qm.prototype.serializeInlines=function(e,t){for(var i=void 0,n=0,r=0;e[ko[this.keywordIndex]].length>n;){var o,i=e[ko[this.keywordIndex]][n];if(i.hasOwnProperty(dr[this.keywordIndex])&&"\t"===i[dr[this.keywordIndex]])r++;else if(0<r&&((o=[]).push('style="mso-tab-count:'+r.toString()+'"'),t+=this.createAttributesTag("span",o)+this.endTag("span"),r=0),i.hasOwnProperty(Br[this.keywordIndex]))t+=this.serializeImageContainer(i);else if(i.hasOwnProperty(Kr[this.keywordIndex]))0===i[Kr[this.keywordIndex]]?(s=e[ko[this.keywordIndex]][n+1],_.isNullOrUndefined(s[dr[this.keywordIndex]])&&(s=e[ko[this.keywordIndex]][n+2]),_.isNullOrUndefined(s)||_.isNullOrUndefined(s[dr[this.keywordIndex]])||!(0<=s[dr[this.keywordIndex]].indexOf("TOC")||0<=s[dr[this.keywordIndex]].indexOf("HYPERLINK"))?this.fieldCheck=void 0:(this.fieldCheck=1,(o=[]).push('style="'+this.serializeInlineStyle(i[Ae[this.keywordIndex]])+'"'),t+=this.createAttributesTag("a",o))):2===i[Kr[this.keywordIndex]]?_.isNullOrUndefined(this.fieldCheck)?this.fieldCheck=0:this.fieldCheck=2:(_.isNullOrUndefined(this.fieldCheck)||0===this.fieldCheck||(t+=this.endTag("a")),this.fieldCheck=0);else{var s=_.isNullOrUndefined(i[dr[this.keywordIndex]])?"":i[dr[this.keywordIndex]];if(i.hasOwnProperty(Us[this.keywordIndex]))switch(i[Us[this.keywordIndex]]){case 0:t+="<a name="+i[dt[this.keywordIndex]]+">";break;case 1:t+="</a>"}0===this.fieldCheck&&(t+=this.serializeSpan(s,i[Ae[this.keywordIndex]])),1===this.fieldCheck&&(t=t+(' href= "'+s.replace(/"/g,"").replace("HYPERLINK","").trim())+'">'),2===this.fieldCheck&&(t+=this.serializeSpan(s,i[Ae[this.keywordIndex]]))}n++}return t},qm.prototype.serializeContentInlines=function(e,t){return t=this.serializeInlines(e,t)},qm.prototype.serializeSpan=function(e,t){var i,n="";return(-1!==e.indexOf("\v")?n+="<br>":-1!==e.indexOf("\f")?n+='<br style = "page-break-after:always;"/>':(i=[],this.serializeInlineStyle(t),i.push('style="'+this.serializeInlineStyle(t)+'"'),n=(n=(n+=this.createAttributesTag("span",i))+this.decodeHtmlNames(e.toString()))+this.endTag("span"))).toString()},qm.prototype.getStyleName=function(e){switch(e){case"Heading 1":return"h1";case"Heading 2":return"h2";case"Heading 3":return"h3";case"Heading 4":return"h4";case"Heading 5":return"h5";default:return"p"}},qm.prototype.serializeImageContainer=function(e){var t="",i=[],n=(this.serializeInlineStyle(e[Ae[this.keywordIndex]]),""),r=(_.isNullOrUndefined(e[Br[this.keywordIndex]])||(n=this.images.get(parseInt(e[Br[this.keywordIndex]]))[j.parseBoolValue(e[Ar[this.keywordIndex]])?1:0]),j.convertPointToPixel(e[mr[this.keywordIndex]])),e=j.convertPointToPixel(e[fr[this.keywordIndex]]);return i.push('width="'+r.toString()+'"'),i.push('height="'+e.toString()+'"'),i.push('src="'+n+'"'),(t=(t+=this.createAttributesTag("img",i))+this.endTag("img")).toString()},qm.prototype.serializeCell=function(e,t){var i,n="",r=[],o="",r=[];_.isNullOrUndefined(e[Qo[this.keywordIndex]])||(_.isNullOrUndefined(e[Qo[this.keywordIndex]][Ki[this.keywordIndex]][$i[this.keywordIndex]])||"empty"===e[Qo[this.keywordIndex]][Ki[this.keywordIndex]][$i[this.keywordIndex]]||r.push('bgcolor="'+j.getColor(e[Qo[this.keywordIndex]][Ki[this.keywordIndex]][$i[this.keywordIndex]])+'"'),!_.isNullOrUndefined(e[Qo[this.keywordIndex]][Ei[this.keywordIndex]])&&1<e[Qo[this.keywordIndex]][Ei[this.keywordIndex]]&&r.push('colspan="'+e[Qo[this.keywordIndex]][Ei[this.keywordIndex]].toString()+'"'),!_.isNullOrUndefined(e[Qo[this.keywordIndex]][Li[this.keywordIndex]])&&1<e[Qo[this.keywordIndex]][Li[this.keywordIndex]]&&r.push('rowspan="'+e[Qo[this.keywordIndex]][Li[this.keywordIndex]].toString()+'"'),_.isNullOrUndefined(e[Qo[this.keywordIndex]][Oi[this.keywordIndex]])||0===e[Qo[this.keywordIndex]][Oi[this.keywordIndex]]||(i=j.convertPointToPixel(e[Qo[this.keywordIndex]][Oi[this.keywordIndex]]),r.push('width="'+i.toString()+'"')),i=_.isNullOrUndefined(e[Qo[this.keywordIndex]][Bi[this.keywordIndex]])?"top":this.convertVerticalAlignment(e[Qo[this.keywordIndex]][Bi[this.keywordIndex]]),r.push('valign="'+i+'"'),_.isNullOrUndefined(e[Qo[this.keywordIndex]][gi[this.keywordIndex]])||0===e[Qo[this.keywordIndex]][gi[this.keywordIndex]]||(o+="padding-left:"+e[Qo[this.keywordIndex]][gi[this.keywordIndex]].toString()+"pt;"),_.isNullOrUndefined(e[Qo[this.keywordIndex]][mi[this.keywordIndex]])||0===e[Qo[this.keywordIndex]][mi[this.keywordIndex]]||(o+="padding-right:"+e[Qo[this.keywordIndex]][mi[this.keywordIndex]].toString()+"pt;"),_.isNullOrUndefined(e[Qo[this.keywordIndex]][fi[this.keywordIndex]])||0===e[Qo[this.keywordIndex]][fi[this.keywordIndex]]||(o+="padding-top:"+e[Qo[this.keywordIndex]][fi[this.keywordIndex]].toString()+"pt;"),_.isNullOrUndefined(e[Qo[this.keywordIndex]][yi[this.keywordIndex]])||0===e[Qo[this.keywordIndex]][yi[this.keywordIndex]]||(o+="padding-bottom:"+e[Qo[this.keywordIndex]][yi[this.keywordIndex]].toString()+"pt;"),_.isNullOrUndefined(e[Qo[this.keywordIndex]][si[this.keywordIndex]]))||(o+=this.serializeCellBordersStyle(e[Qo[this.keywordIndex]][si[this.keywordIndex]],t)),0!==o.length&&r.push('style="'+o+'"'),n+=this.createAttributesTag("td",r);for(var s=0;s<e[S[this.keywordIndex]].length;s++){var a=e[S[this.keywordIndex]][s];a.hasOwnProperty(ts[this.keywordIndex])?n+=this.serializeTable(a):n+=this.serializeParagraph(a)}return n+=this.endTag("td")},qm.prototype.convertVerticalAlignment=function(e){switch(e){case"Center":case 1:return"middle";case"Bottom":case 2:return"bottom";default:return"top"}},qm.prototype.serializeTable=function(e){var t="";t+=this.createTableStartTag(e);for(var i=0;i<e[ts[this.keywordIndex]].length;i++)t+=this.serializeRow(e[ts[this.keywordIndex]][i]);return t+=this.createTableEndTag()},qm.prototype.serializeRow=function(e){var t="";t+=this.createRowStartTag(e);for(var i=0;i<e[es[this.keywordIndex]].length;i++)t+=this.serializeCell(e[es[this.keywordIndex]][i],e);return t},qm.prototype.serializeParagraphStyle=function(e,t,i,n){var r="",n=(_.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=n),0<e[ko[this.keywordIndex]].length&&(r+=this.serializeCharacterFormat(e[Ae[this.keywordIndex]])),!1);return 0==e[ko[this.keywordIndex]].length&&(n=!0),r=(r+=this.serializeCharacterFormat(e[Ae[this.keywordIndex]],n))+this.serializeParagraphFormat(e[De[this.keywordIndex]],i)},qm.prototype.serializeInlineStyle=function(e){return this.serializeCharacterFormat(e)},qm.prototype.serializeTableBorderStyle=function(e){var t="",i={},i=e[zr[this.keywordIndex]];return _.isNullOrUndefined(i)||i[ln[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||i[ln[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!_.isNullOrUndefined(i)&&j.parseBoolValue(i[nn[this.keywordIndex]])&&(t+="border-left-style:none;"):(i[Or[this.keywordIndex]]=_.isNullOrUndefined(i[Or[this.keywordIndex]])?"#000000":i[Or[this.keywordIndex]],i[dn[this.keywordIndex]]=_.isNullOrUndefined(i[dn[this.keywordIndex]])?.5:i[dn[this.keywordIndex]],t+=this.serializeBorderStyle(i,"left")),i=e[Dr[this.keywordIndex]],_.isNullOrUndefined(i)||i[ln[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||i[ln[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!_.isNullOrUndefined(i)&&j.parseBoolValue(i[nn[this.keywordIndex]])&&(t+="border-top-style:none;"):(i[Or[this.keywordIndex]]=_.isNullOrUndefined(i[Or[this.keywordIndex]])?"#000000":i[Or[this.keywordIndex]],i[dn[this.keywordIndex]]=_.isNullOrUndefined(i[dn[this.keywordIndex]])?.5:i[dn[this.keywordIndex]],t+=this.serializeBorderStyle(i,"top")),i=e[Vr[this.keywordIndex]],_.isNullOrUndefined(i)||i[ln[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||i[ln[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!_.isNullOrUndefined(i)&&j.parseBoolValue(i[nn[this.keywordIndex]])&&(t+="border-right-style:none;"):(i[Or[this.keywordIndex]]=_.isNullOrUndefined(i[Or[this.keywordIndex]])?"#000000":i[Or[this.keywordIndex]],i[dn[this.keywordIndex]]=_.isNullOrUndefined(i[dn[this.keywordIndex]])?.5:i[dn[this.keywordIndex]],t+=this.serializeBorderStyle(i,"right")),i=e[Ur[this.keywordIndex]],_.isNullOrUndefined(i)||i[ln[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||i[ln[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!_.isNullOrUndefined(i)&&j.parseBoolValue(i[nn[this.keywordIndex]])&&(t+="border-bottom-style:none;"):(i[Or[this.keywordIndex]]=_.isNullOrUndefined(i[Or[this.keywordIndex]])?"#000000":i[Or[this.keywordIndex]],i[dn[this.keywordIndex]]=_.isNullOrUndefined(i[dn[this.keywordIndex]])?.5:i[dn[this.keywordIndex]],t+=this.serializeBorderStyle(i,"bottom")),t},qm.prototype.serializeCellBordersStyle=function(e,t){var i="",n={},n=e[zr[this.keywordIndex]];return _.isNullOrUndefined(n)||n[ln[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[ln[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!_.isNullOrUndefined(n)&&j.parseBoolValue(n[nn[this.keywordIndex]])?i+="border-left-style:none;":_.isNullOrUndefined(t[$o[this.keywordIndex]][si[this.keywordIndex]][zr[this.keywordIndex]])||(n=t[$o[this.keywordIndex]][si[this.keywordIndex]][zr[this.keywordIndex]],_.isNullOrUndefined(n))||n[ln[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[ln[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(n[Or[this.keywordIndex]]=_.isNullOrUndefined(n[Or[this.keywordIndex]])?"#000000":n[Or[this.keywordIndex]],n[dn[this.keywordIndex]]=_.isNullOrUndefined(n[dn[this.keywordIndex]])?.5:n[dn[this.keywordIndex]],i+=this.serializeBorderStyle(n,"left")):(n[Or[this.keywordIndex]]=_.isNullOrUndefined(n[Or[this.keywordIndex]])?"#000000":n[Or[this.keywordIndex]],n[dn[this.keywordIndex]]=_.isNullOrUndefined(n[dn[this.keywordIndex]])?.5:n[dn[this.keywordIndex]],i+=this.serializeBorderStyle(n,"left")),n=e[Dr[this.keywordIndex]],_.isNullOrUndefined(n)||n[ln[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[ln[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!_.isNullOrUndefined(n)&&j.parseBoolValue(n[nn[this.keywordIndex]])?i+="border-top-style:none;":_.isNullOrUndefined(t[$o[this.keywordIndex]][si[this.keywordIndex]][Dr[this.keywordIndex]])||(n=t[$o[this.keywordIndex]][si[this.keywordIndex]][Dr[this.keywordIndex]],_.isNullOrUndefined(n))||n[ln[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[ln[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(n[Or[this.keywordIndex]]=_.isNullOrUndefined(n[Or[this.keywordIndex]])?"#000000":n[Or[this.keywordIndex]],n[dn[this.keywordIndex]]=_.isNullOrUndefined(n[dn[this.keywordIndex]])?.5:n[dn[this.keywordIndex]],i+=this.serializeBorderStyle(n,"top")):(n[Or[this.keywordIndex]]=_.isNullOrUndefined(n[Or[this.keywordIndex]])?"#000000":n[Or[this.keywordIndex]],n[dn[this.keywordIndex]]=_.isNullOrUndefined(n[dn[this.keywordIndex]])?.5:n[dn[this.keywordIndex]],i+=this.serializeBorderStyle(n,"top")),n=e[Vr[this.keywordIndex]],_.isNullOrUndefined(n)||n[ln[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[ln[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!_.isNullOrUndefined(n)&&j.parseBoolValue(n[nn[this.keywordIndex]])?i+="border-right-style:none;":_.isNullOrUndefined(t[$o[this.keywordIndex]][si[this.keywordIndex]][Vr[this.keywordIndex]])||(n=t[$o[this.keywordIndex]][si[this.keywordIndex]][Vr[this.keywordIndex]],_.isNullOrUndefined(n))||n[ln[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[ln[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(n[Or[this.keywordIndex]]=_.isNullOrUndefined(n[Or[this.keywordIndex]])?"#000000":n[Or[this.keywordIndex]],n[dn[this.keywordIndex]]=_.isNullOrUndefined(n[dn[this.keywordIndex]])?.5:n[dn[this.keywordIndex]],i+=this.serializeBorderStyle(n,"right")):(n[Or[this.keywordIndex]]=_.isNullOrUndefined(n[Or[this.keywordIndex]])?"#000000":n[Or[this.keywordIndex]],n[dn[this.keywordIndex]]=_.isNullOrUndefined(n[dn[this.keywordIndex]])?.5:n[dn[this.keywordIndex]],i+=this.serializeBorderStyle(n,"right")),n=e[Ur[this.keywordIndex]],_.isNullOrUndefined(n)||n[ln[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[ln[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!_.isNullOrUndefined(n)&&j.parseBoolValue(n[nn[this.keywordIndex]])?i+="border-bottom-style:none;":_.isNullOrUndefined(t[$o[this.keywordIndex]][si[this.keywordIndex]][Ur[this.keywordIndex]])||(n=t[$o[this.keywordIndex]][si[this.keywordIndex]][Ur[this.keywordIndex]],_.isNullOrUndefined(n))||n[ln[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[ln[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(n[Or[this.keywordIndex]]=_.isNullOrUndefined(n[Or[this.keywordIndex]])?"#000000":n[Or[this.keywordIndex]],n[dn[this.keywordIndex]]=_.isNullOrUndefined(n[dn[this.keywordIndex]])?.5:n[dn[this.keywordIndex]],i+=this.serializeBorderStyle(n,"bottom")):(n[Or[this.keywordIndex]]=_.isNullOrUndefined(n[Or[this.keywordIndex]])?"#000000":n[Or[this.keywordIndex]],n[dn[this.keywordIndex]]=_.isNullOrUndefined(n[dn[this.keywordIndex]])?.5:n[dn[this.keywordIndex]],i+=this.serializeBorderStyle(n,"bottom")),i},qm.prototype.serializeBorderStyle=function(e,t){var i=(i="")+("border-"+t+"-style:"+this.convertBorderLineStyle(e[ln[this.keywordIndex]]))+";";return 0<e[dn[this.keywordIndex]]&&(i+="border-"+t+"-width:"+e[dn[this.keywordIndex]].toString()+"pt;"),_.isNullOrUndefined(e[Or[this.keywordIndex]])||(i+="border-"+t+"-color:"+j.getColor(e[Or[this.keywordIndex]])+";"),i},qm.prototype.convertBorderLineStyle=function(e){switch(e){case"Single":case 0:return"solid";case"None":case 1:return"none";case"Dot":case 2:return"dotted";case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":case 3:case 4:case 5:case 6:return"dashed";case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:return"double";case"SingleWavy":case 18:return"solid";case"DoubleWavy":case 19:return"double";case"DashDotStroked":case 20:return"solid";case"Emboss3D":case 21:return"ridge";case"Engrave3D":case 22:return"groove";case"Outset":case 23:return"outset";case"Inset":case 24:return"inset";default:return"solid"}},qm.prototype.serializeCharacterFormat=function(e,t){var i,n;return _.isNullOrUndefined(e[Ca[this.keywordIndex]])?(n=(n="font-weight:")+(j.parseBoolValue(e[ft[this.keywordIndex]])?"bold":"normal")+";font-style:",j.parseBoolValue(e[yt[this.keywordIndex]])?n+="italic":n+="normal",n=(n+=";")+this.serializeTextDecoration(e),e[bt[this.keywordIndex]]!==(1==this.keywordIndex?1:"Superscript")&&e[bt[this.keywordIndex]]!==(1==this.keywordIndex?2:"Subscript")||(n=(n+="vertical-align:")+(e[bt[this.keywordIndex]]===(1==this.keywordIndex?1:"Superscript")?"super":"sub")+";"),_.isNullOrUndefined(e[Ct[this.keywordIndex]])||e[Ct[this.keywordIndex]]===(1==this.keywordIndex?0:"NoColor")||t||(n=(n+="background-color:")+(1==this.keywordIndex?this.getHighlightColorCode(e[Ct[this.keywordIndex]]):j.getHighlightColorCode(e.highlightColor.toString()))+";"),i=e[kt[this.keywordIndex]],_.isNullOrUndefined(i)||(n=(n+="color:")+j.getColor(i)+";"),!_.isNullOrUndefined(e[Lt[this.keywordIndex]])&&j.parseBoolValue(e[Lt[this.keywordIndex]])&&(n+="text-transform:uppercase;"),i=e[It[this.keywordIndex]],_.isNullOrUndefined(i)||(n=(n+="font-size:")+i.toString()+"pt;"),i=e[Ft[this.keywordIndex]],_.isNullOrUndefined(i)||(n=(n+="font-family:")+i.toString()+";"),i=e[Vt[this.keywordIndex]],_.isNullOrUndefined(i)||(n=(n+="letter-spacing:")+i.toString()+"pt;"),i=e[zt[this.keywordIndex]],(n=_.isNullOrUndefined(i)?n:(n+="transform:scaleX(")+(i/100).toString()+");").toString()):this.serializeCharacterFormat(e[Ca[this.keywordIndex]],t)},qm.prototype.serializeTextDecoration=function(e){var t="";return e[xt[this.keywordIndex]]!==(1==this.keywordIndex?1:"SingleStrike")&&e[xt[this.keywordIndex]]!==(1==this.keywordIndex?2:"DoubleStrike")||(t+="line-through "),_.isNullOrUndefined(e[vt[this.keywordIndex]])||e[vt[this.keywordIndex]]===(1==this.keywordIndex?0:"None")||(t+="underline"),t=1<t.length?"text-decoration:"+t+";":t},qm.prototype.serializeParagraphFormat=function(e,t,i){var n,r,o;return _.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=i),_.isNullOrUndefined(e[Ca[this.keywordIndex]])?(i="",o=this.getTextAlignment(e[Kt[this.keywordIndex]]),_.isNullOrUndefined(o)||(i+="text-align:"+o.toLowerCase()+";"),o=e[Xt[this.keywordIndex]],_.isNullOrUndefined(o)||(i+="margin-top:"+o.toString()+"pt; "),o=e[jt[this.keywordIndex]],_.isNullOrUndefined(o)||(i+="margin-right:"+o.toString()+"pt; "),o=e[Zt[this.keywordIndex]],_.isNullOrUndefined(o)||(i+="margin-bottom:"+o.toString()+"pt; "),o=e[_t[this.keywordIndex]],_.isNullOrUndefined(o=t?0:o)||(i+="margin-left:"+o.toString()+"pt; "),o=e[Gt[this.keywordIndex]],_.isNullOrUndefined(o=t?0:o)||0===o||(i+="text-indent:"+o.toString()+"pt;"),!_.isNullOrUndefined(e[ai[this.keywordIndex]])&&0<e[ai[this.keywordIndex]].length&&(i+=this.serializeTabs(e[ai[this.keywordIndex]])),o=e[Qt[this.keywordIndex]],_.isNullOrUndefined(o)||(n=(r=e[$t[this.keywordIndex]])===(1==this.keywordIndex?0:"Multiple"),r=r===(1==this.keywordIndex?0:"AtLeast"),1==o&&n?i+="line-height:normal;":n?i+="line-height:"+(100*Math.abs(o)).toString()+"%;":(!r||12<=o)&&(i+="line-height:"+o.toString()+"pt;")),i.toString()):this.serializeParagraphFormat(e[Ca[this.keywordIndex]],t)},qm.prototype.serializeTabs=function(e){for(var t="tab-stops:",i=0;i<e.length;i++){var n,r=e[i];r.hasOwnProperty(zs[this.keywordIndex])&&""!==(n=this.getTabJustification(r[zs[this.keywordIndex]]))&&(t+=n+" "),r.hasOwnProperty(js[this.keywordIndex])&&""!==(n=this.getTabLeader(r[js[this.keywordIndex]]))&&(t+=n+" "),r.hasOwnProperty(qs[this.keywordIndex])&&(t+=r[qs[this.keywordIndex]].toString()+"pt"),i!==e.length-1&&(t+=" ")}return t+=";"},qm.prototype.getTabLeader=function(e){switch(e){case"Dot":case 2:return"dotted";case"Hyphen":case 3:return"dashed";case"Underscore":case 4:return"heavy";default:return""}},qm.prototype.getTabJustification=function(e){switch(e){case"Bar":case 1:return"bar";case"Center":case 2:return"center";case"Decimal":case 3:return"decimal";case"Right":case 5:return"right";default:return""}},qm.prototype.createAttributesTag=function(e,t){for(var i=(i="")+"<"+e,n=0;n<t.length;n++)i=(i+=" ")+t[n];return"a"!==e&&(i+=">"),i},qm.prototype.createTag=function(e){var t="";return(t+="<")+e+">"},qm.prototype.endTag=function(e){var t="";return t+"<"+"/"+e+">"},qm.prototype.createTableStartTag=function(e){var t="",i="",n=[];return _.isNullOrUndefined(e[ss[this.keywordIndex]])||(_.isNullOrUndefined(e[ss[this.keywordIndex]][Ki[this.keywordIndex]])||_.isNullOrUndefined(e[ss[this.keywordIndex]][Ki[this.keywordIndex]][$i[this.keywordIndex]])||"empty"===e[ss[this.keywordIndex]][Ki[this.keywordIndex]][$i[this.keywordIndex]]||n.push('bgcolor="'+j.getColor(e[ss[this.keywordIndex]][Ki[this.keywordIndex]][$i[this.keywordIndex]])+'"'),!_.isNullOrUndefined(e[ss[this.keywordIndex]][Gi[this.keywordIndex]])&&0<e[ss[this.keywordIndex]][Gi[this.keywordIndex]]?n.push('cellspacing="'+(72*e[ss[this.keywordIndex]][Gi[this.keywordIndex]]/96*2).toString()+'"'):i+="border-collapse:collapse;",n.push('cellpadding="0"'),_.isNullOrUndefined(e[Ho[this.keywordIndex]])||n.push('title="'+e[Ho[this.keywordIndex]]+'"'),_.isNullOrUndefined(e[is[this.keywordIndex]])||n.push('summary="'+e[is[this.keywordIndex]]+'"'),_.isNullOrUndefined(e[ss[this.keywordIndex]][_t[this.keywordIndex]])||0===e[ss[this.keywordIndex]][_t[this.keywordIndex]]||e[ss[this.keywordIndex]][Zi[this.keywordIndex]]!==(1==this.keywordIndex?0:"Left")||(i+="margin-left:"+e[ss[this.keywordIndex]][_t[this.keywordIndex]].toString()+"pt;"),_.isNullOrUndefined(e[ss[this.keywordIndex]])||(i+=this.serializeTableWidth(e[ss[this.keywordIndex]])),_.isNullOrUndefined(e[ss[this.keywordIndex]][si[this.keywordIndex]]))||(i+=this.serializeTableBorderStyle(e[ss[this.keywordIndex]][si[this.keywordIndex]])),0!==i.length&&n.push('style="',i.toString()+'"'),t+this.createAttributesTag("table",n)},qm.prototype.serializeTableWidth=function(e){var t="";switch(e[Ji[this.keywordIndex]]){case"Percent":case 1:t+="width: "+e[Xi[this.keywordIndex]].toString()+"%;";break;case"Point":case 2:t+="width: "+e[Xi[this.keywordIndex]].toString()+"pt;";break;case"Auto":case 0:t+="width: auto;"}return t},qm.prototype.getHighlightColorCode=function(e){var t="#ffffff";switch(e){case 1:t="#ffff00";break;case 2:t="#00ff00";break;case 3:t="#00ffff";break;case 4:t="#ff00ff";break;case 5:t="#0000ff";break;case 6:t="#ff0000";break;case 7:t="#000080";break;case 8:t="#008080";break;case 9:t="#008000";break;case 10:t="#800080";break;case 11:t="#800000";break;case 12:t="#808000";break;case 13:t="#808080";break;case 14:t="#c0c0c0";break;case 15:t="#000000"}return t},qm.prototype.getTextAlignment=function(e){switch(e){case 1:return"Center";case 2:return"Right";case 3:return"Justify";default:return"Left"}},qm.prototype.createTableEndTag=function(){var e="";return e+=this.endTag("table")},qm.prototype.createRowStartTag=function(e){var t="",i=[];return j.parseBoolValue(e[$o[this.keywordIndex]][Mi[this.keywordIndex]])&&(t+=this.createTag("thead")),!_.isNullOrUndefined(e[$o[this.keywordIndex]][fr[this.keywordIndex]])&&0<e[$o[this.keywordIndex]][fr[this.keywordIndex]]&&(e=j.convertPointToPixel(e[$o[this.keywordIndex]][fr[this.keywordIndex]]),i.push('height="'+e+'"')),t+this.createAttributesTag("tr",i)},qm.prototype.createRowEndTag=function(e){var t="";return t+=this.endTag("tr"),j.parseBoolValue(e[$o[this.keywordIndex]][Mi[this.keywordIndex]])&&(t+=this.endTag("thead")),t},qm.prototype.decodeHtmlNames=function(e){if("\t"===e)return"&emsp;";var t=(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")).split(" "),i="";if(0<t.length)for(var i=t[0],n=0;n<t.length-1;n++)i+=" "+t[n+1];return i};var zm=qm;function qm(){this.document=void 0,this.prevListLevel=void 0,this.isOrdered=void 0,this.keywordIndex=void 0,this.fieldCheck=0}Object.defineProperty(a.prototype,"isHighlightEditRegion",{get:function(){return this.isHighlightEditRegionIn},set:function(e){this.isHighlightEditRegionIn=e,this.onHighlight()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isHighlightContentControlEditRegion",{get:function(){return this.isHighlightContentControlEditRegionIn},set:function(e){this.isHighlightContentControlEditRegionIn=e,this.onHighlightContentControl()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"htmlWriter",{get:function(){return _.isNullOrUndefined(this.htmlWriterIn)&&(this.htmlWriterIn=new zm),this.htmlWriterIn},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"start",{get:function(){if(!_.isNullOrUndefined(this.owner)&&!_.isNullOrUndefined(this.viewer))return _.isNullOrUndefined(this.startInternal)&&(this.startInternal=this.owner.documentStart),this.startInternal},set:function(e){this.startInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"characterFormat",{get:function(){return this.characterFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"paragraphFormat",{get:function(){return this.paragraphFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"sectionFormat",{get:function(){return this.sectionFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"tableFormat",{get:function(){return this.tableFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"cellFormat",{get:function(){return this.cellFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rowFormat",{get:function(){return this.rowFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"imageFormat",{get:function(){return this.imageFormatInternal},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"end",{get:function(){return this.endInternal},set:function(e){this.endInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"startPage",{get:function(){return!this.owner.isDocumentLoaded||_.isNullOrUndefined(this.viewer)||this.viewer instanceof Wd||_.isNullOrUndefined(this.documentHelper.selectionStartPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionStartPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"endPage",{get:function(){return!this.owner.isDocumentLoaded||_.isNullOrUndefined(this.viewer)||this.viewer instanceof Wd||_.isNullOrUndefined(this.documentHelper.selectionEndPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionEndPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isForward",{get:function(){return this.start.isExistBefore(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isinFootnote",{get:function(){return this.isFootNoteParagraph(this.start.paragraph)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isinEndnote",{get:function(){return this.isEndNoteParagraph(this.start.paragraph)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isEmpty",{get:function(){return!!_.isNullOrUndefined(this.start)||this.start.isAtSamePosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"startOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.start)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"endOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isInShape",{get:function(){var e=this.start.paragraph.containerWidget;do{if(e instanceof fc)return!0}while(e=e&&e.containerWidget);return!1},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"text",{get:function(){return this.getText(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"contextType",{get:function(){return this.contextTypeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bookmarks",{get:function(){return this.getSelBookmarks(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"sfdt",{get:function(){if(this.owner.editorModule&&!this.isEmpty)return JSON.stringify(this.writeSfdt())},enumerable:!0,configurable:!0}),a.prototype.getBookmarks=function(e){return this.getSelBookmarks(e)},Object.defineProperty(a.prototype,"isCleared",{get:function(){return _.isNullOrUndefined(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isInField",{get:function(){return!_.isNullOrUndefined(this.getHyperlinkField(!0))},enumerable:!0,configurable:!0}),a.prototype.getFieldInfo=function(){var e=this.getHyperlinkField(!0);if(!_.isNullOrUndefined(e))return{code:this.getFieldCode(e),result:this.owner.editorModule.getFieldResultText(e)}},a.prototype.isFootNoteParagraph=function(e){e=this.getContainerWidget(e);return e instanceof q&&"Footnote"===e.footNoteType},a.prototype.isEndNoteParagraph=function(e){e=this.getContainerWidget(e);return e instanceof q&&"Endnote"===e.footNoteType},a.prototype.isFootEndNoteParagraph=function(e){return!!this.isFootNoteParagraph(e)||!!this.isEndNoteParagraph(e)},a.prototype.getSelBookmarks=function(e){for(var t,i,n,r,o,s=[],a=this.documentHelper.bookmarks,l=this.start,d=this.end,h=(this.isForward||(l=this.end,d=this.start),!1),c=this.getSelectedCells(),p=0;p<a.length;p++)(e||!e&&0!==a.keys[p].indexOf("_"))&&(o=(t=a.get(a.keys[p])).reference,!_.isNullOrUndefined(o))&&(i=this.getElementPosition(t).startPosition,o=this.getElementPosition(o,!0).startPosition,(i.paragraph.isInsideTable||o.paragraph.isInsideTable)&&0<c.length?0<=c.indexOf(i.paragraph.associatedCell)||0<=c.indexOf(o.paragraph.associatedCell)?h=!0:(h=!1,(c.indexOf(i.paragraph.associatedCell)<0||c.indexOf(o.paragraph.associatedCell)<0)&&(n=d.paragraph.isInsideTable&&d.paragraph.associatedCell,r=o.paragraph.associatedCell,n)&&r&&n.ownerTable.equals(r.ownerTable)&&n.ownerTable&&c.indexOf(this.getCellInTable(n.ownerTable,r))):h=!1,(l.isExistAfter(i)||l.isAtSamePosition(i))&&(d.isExistBefore(o)||d.isAtSamePosition(o))||(i.isExistAfter(l)||i.isAtSamePosition(l))&&(o.isExistBefore(d)||o.isAtSamePosition(d))||i.isExistAfter(l)&&i.isExistBefore(d)&&(d.isExistAfter(o)||d.isExistBefore(o))||o.isExistBefore(d)&&o.isExistAfter(l)&&(l.isExistBefore(i)||l.isExistAfter(i))||h)&&s.push(t.name);return s},Object.defineProperty(a.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),a.prototype.getModuleName=function(){return"Selection"},a.prototype.checkLayout=function(){"Continuous"===this.owner.layoutType&&(this.isWebLayout=!0,this.documentHelper.isHeaderFooter=!0,this.owner.layoutType="Pages",this.owner.viewer.destroy(),this.owner.viewer=new Sd(this.owner),this.owner.editorModule.layoutWholeDocument())},a.prototype.goToHeader=function(){this.checkLayout(),this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget,this.start.paragraph.bodyWidget.page),this.isWebLayout=!1},a.prototype.goToFooter=function(){this.checkLayout(),this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget,this.start.paragraph.bodyWidget.page),this.isWebLayout=!1},a.prototype.closeHeaderFooter=function(){this.disableHeaderFooter(),this.documentHelper.isHeaderFooter&&"Pages"===this.owner.layoutType&&(this.owner.layoutType="Continuous",this.documentHelper.isHeaderFooter=!1)},a.prototype.closeXmlPane=function(){this.disableXml(),this.owner.enableXMLPane=!1,this.documentHelper.isHeaderFooter&&"Pages"===this.owner.layoutType&&(this.owner.layoutType="Continuous",this.documentHelper.isHeaderFooter=!1)},a.prototype.goToPage=function(e){this.owner.scrollToPage(e),1<=e&&e<=this.owner.documentHelper.pages.length&&(e=this.owner.documentHelper.pages[e-1],this.updateTextPositionForBlockContainer(e.bodyWidgets[0]))},a.prototype.selectTable=function(){this.owner.enableSelection&&this.selectTableInternal()},a.prototype.selectRow=function(){this.owner.enableSelection&&this.selectTableRow()},a.prototype.selectColumn=function(){this.owner.enableSelection&&this.selectColumnInternal()},a.prototype.selectCell=function(){this.owner.enableSelection&&this.selectTableCell()},a.prototype.select=function(e,t){var i;"string"==typeof e?(i=this.getTextPosBasedOnLogicalIndex(e),t=this.getTextPosBasedOnLogicalIndex(t),this.selectPosition(i,t)):(i=new nl(e.x,e.y),t=this.viewer.findFocusedPage(i,!0),e.extend?this.moveTextPosition(t,this.end):this.documentHelper.updateTextPositionForSelection(t,1))},a.prototype.selectByHierarchicalIndex=function(e,t){e=this.getTextPosBasedOnLogicalIndex(e),t=this.getTextPosBasedOnLogicalIndex(t);this.selectPosition(e,t)},a.prototype.selectField=function(e){!this.isInField&&_.isNullOrUndefined(e)||(_.isNullOrUndefined(e)&&(e=this.getHyperlinkField(!0)),this.selectFieldInternal(e))},a.prototype.selectContentControlInternal=function(e){var t,i,n;e&&(n=e.line.getOffset(e,1),t=new y(this.owner),i=e.reference,t.setPositionParagraph(e.line,n),e=i.line.getOffset(i,0),(n=new y(this.owner)).setPositionParagraph(i.line,e),this.documentHelper.selection.selectRange(t,n))},a.prototype.selectFieldInternal=function(e,t,i){var n,r,o,s;e&&(n=this.documentHelper.isFormFillProtectedMode||i,r=e.fieldEnd,s=(e=n?e.fieldSeparator:e).line.getOffset(e,n?1:0),(o=new y(this.owner)).setPositionParagraph(e.line,s),s=(r=e.nextNode instanceof J&&!n&&e.nextElement.reference?e.nextElement.reference:r).line.getOffset(r,n?0:1),(e=new y(this.owner)).setPositionParagraph(r.line,s),this.documentHelper.selection.selectRange(o,e),i||this.triggerFormFillEvent(t))},a.prototype.selectContentInternal=function(e){var t,i,n;e&&(t=e.reference,n=e.line.getOffset(e,0),(i=new y(this.owner)).setPositionParagraph(e.line,n),e=t.line.getOffset(t,0),(n=new y(this.owner)).setPositionParagraph(t.line,e),i.offset++,n.offset,this.documentHelper.selection.selectRange(i,n))},a.prototype.selectShape=function(e){var t,i,n;e&&(i=e.line.getOffset(e,0),(t=new y(this.owner)).setPositionParagraph(e.line,i),i=e.line.getOffset(e,1),(n=new y(this.owner)).setPositionParagraph(e.line,i),this.documentHelper.selection.selectRange(t,n))},a.prototype.toggleBold=function(){this.owner.editorModule&&this.owner.editorModule.toggleBold()},a.prototype.toggleItalic=function(){this.owner.editorModule&&this.owner.editorModule.toggleItalic()},a.prototype.toggleAllCaps=function(){this.owner.editorModule&&this.owner.editorModule.toggleAllCaps()},a.prototype.toggleUnderline=function(e){this.owner.editorModule&&this.owner.editorModule.toggleUnderline(e)},a.prototype.toggleStrikethrough=function(e){this.owner.editorModule&&this.owner.editorModule.toggleStrikethrough(e)},a.prototype.toggleHighlightColor=function(e){this.owner.editorModule&&this.owner.editorModule.toggleHighlightColor(e)},a.prototype.toggleSubscript=function(){this.owner.editorModule&&this.owner.editorModule.toggleSubscript()},a.prototype.toggleSuperscript=function(){this.owner.editorModule&&this.owner.editorModule.toggleSuperscript()},a.prototype.toggleTextAlignment=function(e){this.owner.editorModule&&this.owner.editorModule.toggleTextAlignment(e)},a.prototype.increaseIndent=function(){this.owner.editorModule&&this.owner.editorModule.increaseIndent()},a.prototype.decreaseIndent=function(){this.owner.editorModule&&this.owner.editorModule.decreaseIndent()},a.prototype.navigateHyperlink=function(){var e=this.getHyperlinkField();e&&this.fireRequestNavigate(e)},a.prototype.fireRequestNavigate=function(e){var t=this.getFieldCode(e);0===t.toLowerCase().indexOf("ref ")&&!t.match("\\h")||(e={isHandled:!1,navigationLink:(t=new kg(e,this)).navigationLink,linkType:t.linkType,localReference:t.localReference,source:this.owner},this.owner.trigger(we,e),e.isHandled)||this.documentHelper.selection.navigateBookmark(t.localReference,!0)},a.prototype.copyHyperlink=function(){var e=this.getHyperlinkField(),e=this.getLinkText(e,!0);this.copyToClipboard(e)},a.prototype.isHideSelection=function(e){var t=e.bodyWidget,i=t.sectionFormat,i=i.pageHeight-i.footerDistance,t=t.page.boundingRectangle.height/100*40;return 0<=this.contextType.indexOf("Footer")&&e.y+e.height>j.convertPointToPixel(i)||0<=this.contextType.indexOf("Header")&&e.y+e.height>t},a.prototype.highlightSelection=function(e,t){if(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.hideImageResizer(),this.isEmpty){if(!this.isInShape&&this.isHideSelection(this.start.paragraph))return void this.hideCaret();this.isInShape&&this.showResizerForShape(),this.updateCaretPosition()}else this.isForward?this.highlightSelectedContent(this.start,this.end):this.highlightSelectedContent(this.end,this.start),this.documentHelper.isComposingIME&&this.updateCaretPosition();this.documentHelper.updateTouchMarkPosition(),e&&this.documentHelper.scrollToPosition(this.start,this.end,void 0,t)},a.prototype.createHighlightBorder=function(e,t,i,n,r,o){t<0&&(t=0);var s=e.paragraph,a=[];if(0<s.floatingElements.length)for(var l=0;l<s.floatingElements.length;l++){var d,h,c,p=s.floatingElements[l];p.line===e&&(d=this.start,h=this.end,this.isForward||(d=this.end,h=this.start),c=p.line.getOffset(p,0),d.currentWidget!==e&&h.currentWidget!==e||d.currentWidget===e&&d.offset<=c&&(h.currentWidget===e&&h.offset>=c+1||h.currentWidget!==e)||d.currentWidget!==e&&h.currentWidget===e&&h.offset>=c)&&a.push(p)}var u=this.getPage(e.paragraph),g=(e.height,this.selectedWidgets),m=void 0,f=void 0;if(this.isHighlightContentControlEditRegion&&!_.isNullOrUndefined(o))this.addContentControlEditRegionHighlight(e,i,t,o);else if(this.isHightlightEditRegionInternal)this.addEditRegionHighlight(e,i,t);else if(this.isHighlightFormFields)this.addFormFieldHighlight(e,i,t);else{if(g.containsKey(e))g.get(e)instanceof Cg?(m=g.get(e),r&&(g.remove(e),g.add(e,f=[]))):f=g.get(e);else if(r)g.add(e,f=[]);else{o=this.getWrapPosition(e,s);if(0<o.length){o=this.splitSelectionHighlightPosition(i,t,o);if(0<o.length)return o[0].floatingItems=a,g.add(e,o),void this.renderHighlight(u,e,o,n,a)}(m=new Cg(i,t)).floatingItems=a,g.add(e,m)}void 0===m&&((m=new Cg(i,t)).floatingItems=a,g.add(e,m)),this.renderHighlight(u,e,[m],n,a),r&&f.push(m)}},a.prototype.renderHighlight=function(e,t,i,n,r){var o=this.owner.documentHelper,s=this.getPageTop(e),a=e.boundingRectangle.x,l=t.height;if(this.viewer.containerTop<=s||s<this.viewer.containerTop+o.selectionCanvas.height){var d=o.zoomFactor;this.clipSelection(e,s);for(var h=0;h<i.length;h++){var c=i[h],p=c.left,c=c.width;this.documentHelper.isComposingIME?this.renderDashLine(o.selectionContext,e,t,a+p*d-this.viewer.containerLeft,n,c*d,l):(this.documentHelper.selectionContext.fillStyle="gray",o.selectionContext.globalAlpha=.4,o.selectionContext.fillRect(a+p*d-this.viewer.containerLeft,s+n*d-this.viewer.containerTop,c*d,l*d))}if(0<r.length)for(var u=0;u<r.length;u++){var p=r[u].x,g=r[u].y,m=r[u].width,f=r[u].height;o.selectionContext.fillRect(a+p*d-this.viewer.containerLeft,s+g*d-this.viewer.containerTop,m*d,f*d)}o.selectionContext.restore()}},a.prototype.getWrapPosition=function(e,t){var i=t.bodyWidget;if(!_.isNullOrUndefined(i)&&0<i.floatingElements.length&&0<e.children.length){for(var n=this.getLeftInternal(e,e.children[0],0),r=0,o=[],s=!1,a=0;a<e.children.length;a++){var l,d=e.children[a];d instanceof hc&&"Inline"!==d.textWrappingStyle||(0<d.padding.left&&(1===o.length&&0===o[0].end&&(o[0].end=o[0].start-t.x,o[0].start=t.x,n=t.x),(l={}).start=n+r,l.end=0,s&&(l.end=n+r+d.padding.left),o.push(l)),r+=d.padding.left+d.width,d instanceof X&&(s=!0))}return 1===o.length&&0===o[0].end&&(o[0].end=o[0].start-t.x,o[0].start=t.x),o}return[]},a.prototype.splitSelectionHighlightPosition=function(e,t,i){for(var n=[],r=0;r<i.length;r++){var o=i[r];e<o.start&&e+t<o.end||e>o.end||(e<o.start&&e+t>o.end?(n.push(new Cg(e,o.start-e)),t=e+t-o.end,e=o.end):e===o.start&&(t<o.end?(t=e+t-o.end,e=o.end):(e+=o.end,t-=o.end)),r===i.length-1&&n.push(new Cg(e,t)))}return n},a.prototype.addEditRegionHighlight=function(e,t,i){var n=void 0,r=this.editRegionHighlighters,r=(r.containsKey(e)?n=r.get(e):r.add(e,n=[]),new Cg(t,i));return this.isCurrentUser&&(r.color=""!==this.owner.userColor?this.owner.userColor:"#FFFF00"),n.push(r),r},a.prototype.addContentControlEditRegionHighlight=function(e,t,i,n){var r=this.contentControleditRegionHighlighters,o=[];r.containsKey(n)||r.add(n,new T);r.get(n).add(e,o);r=new Cg(t,i);o.push(r)},a.prototype.addFormFieldHighlight=function(e,t,i){var n=void 0,r=this.formFieldHighlighters,r=(r.containsKey(e)?n=r.get(e):r.add(e,n=[]),new Cg(t,i));n.push(r)},a.prototype.createHighlightBorderInsideTable=function(e){var t=this.getPage(e),i=void 0,n=e.x-e.margin.left+e.leftBorderWidth,r=e.width+e.margin.left+e.margin.right-e.leftBorderWidth-e.rightBorderWidth,o=e.y,s=e.height,a=this.getPageTop(t),l=t.boundingRectangle.x,d=this.documentHelper.isPageInVisibleBound(t,a),h=this.selectedWidgets;this.isHightlightEditRegionInternal||this.isHighlightFormFields||(h.containsKey(e)&&h.get(e)instanceof Cg?(i=h.get(e),d&&this.documentHelper.selectionContext.clearRect(l+i.left*this.documentHelper.zoomFactor-this.viewer.containerLeft,a+o*this.documentHelper.zoomFactor-this.viewer.containerTop,i.width*this.documentHelper.zoomFactor,s*this.documentHelper.zoomFactor)):(i=new Cg(n,r),h.containsKey(e)&&h.remove(h.get(e)),h.add(e,i))),d&&(this.documentHelper.selectionContext.fillStyle="gray",this.documentHelper.selectionContext.globalAlpha=.4,h=this.documentHelper.zoomFactor,this.clipSelection(t,a),this.documentHelper.selectionContext.fillRect(l+n*h-this.viewer.containerLeft,a+o*h-this.viewer.containerTop,r*h,s*h),this.documentHelper.selectionContext.restore())},a.prototype.clipSelection=function(e,t){var i,n=this.owner.documentHelper,r=this.viewer instanceof Wd&&this.documentHelper.zoomFactor<1?(i=e.boundingRectangle.width/this.documentHelper.zoomFactor,e.boundingRectangle.height/this.documentHelper.zoomFactor):(i=e.boundingRectangle.width*this.documentHelper.zoomFactor,e.boundingRectangle.height*this.documentHelper.zoomFactor),e=e.boundingRectangle.x;n.selectionContext.beginPath(),n.selectionContext.save(),n.selectionContext.rect(e-this.viewer.containerLeft,t-this.viewer.containerTop,i,r),n.selectionContext.clip()},a.prototype.addSelectionHighlight=function(e,t,i,n){if(this.selectedWidgets.containsKey(t)){var r=this.documentHelper.render.getScaledValue(t.height),o=this.selectedWidgets.get(t),s=void 0;if(o instanceof Cg?(s=[]).push(o):s=o,!_.isNullOrUndefined(s))for(var a=0;a<s.length;a++){var l=s[a],d=this.documentHelper.render.getScaledValue(s[a].width),h=this.documentHelper.render.getScaledValue(s[a].left,1);if(_.isNullOrUndefined(n)&&(n=this.owner.selectionModule.getPage(t.paragraph)),this.owner.selectionModule.clipSelection(n,this.owner.selectionModule.getPageTop(n)),this.documentHelper.isComposingIME)this.renderDashLine(e,n,t,h,i,d,r);else if(e.globalAlpha=.4,e.fillStyle="gray",e.fillRect(h,this.documentHelper.render.getScaledValue(i,2),d,r),l.floatingItems&&0<l.floatingItems.length)for(var c=0;c<l.floatingItems.length;c++){var p=l.floatingItems[c],d=this.documentHelper.render.getScaledValue(p.width),h=this.documentHelper.render.getScaledValue(p.x,1),u=this.documentHelper.render.getScaledValue(p.y,2);e.fillRect(h,u,d,this.documentHelper.render.getScaledValue(p.height))}e.restore()}}},a.prototype.renderDashLine=function(e,t,i,n,r,o,s){var a=this.characterFormat.fontColor,a=a?j.getColor(a):"#000000",l=(e.globalAlpha=1,this.owner.editorModule.copyInsertFormat(new B,!1)),l=this.documentHelper.textHelper.getHeight(l),t=this.getPageTop(t),l=l.Height-l.BaselineOffset;r=this.documentHelper.render.getUnderlineYPosition(i)+r+4-l,this.documentHelper.render.renderDashLine(e,n,t-this.viewer.containerTop+r*this.documentHelper.zoomFactor,o,a,!0)},a.prototype.addSelectionHighlightTable=function(e,t,i){if(this.selectedWidgets.containsKey(t)){var n=this.selectedWidgets.get(t),r=void 0;if(n instanceof Cg?(r=[]).push(n):r=n,!_.isNullOrUndefined(r))for(var o=0;o<r.length;o++){var s=this.documentHelper.render.getScaledValue(r[o].left,1),a=this.documentHelper.render.getScaledValue(t.y,2),l=this.documentHelper.render.getScaledValue(r[o].width),d=this.documentHelper.render.getScaledValue(t.height);e.fillStyle="gray",_.isNullOrUndefined(i)&&(i=this.owner.selectionModule.getPage(t)),this.owner.selectionModule.clipSelection(i,this.owner.selectionModule.getPageTop(i)),e.fillRect(s,a,l,d),e.restore()}}},a.prototype.removeSelectionHighlight=function(e){var t=0,i=0,n=void 0;if(e instanceof uh){var r=e,o=r.paragraph,n=_.isNullOrUndefined(o)?void 0:this.getPage(r.paragraph);if(_.isNullOrUndefined(n))return;t=this.getTop(r),i=r.height}else if(e instanceof N){if(n=_.isNullOrUndefined(e)?void 0:this.getPage(e),_.isNullOrUndefined(n))return;t=e.y,i=e.height}if(!_.isNullOrUndefined(n)){var o=this.selectedWidgets.get(e),s=void 0;if(o instanceof Cg?(s=[]).push(o):s=o,!_.isNullOrUndefined(s))for(var a=0;a<s.length;a++){var l=s[a].width,d=s[a].left,h=n.boundingRectangle,c=this.documentHelper.pages.indexOf(n),p=this.viewer.pageGap,p=(h.y-p*(c+1))*this.documentHelper.zoomFactor+p*(c+1),c=h.x,h=this.documentHelper.zoomFactor;(this.viewer.containerTop<=p||p<this.viewer.containerTop+this.documentHelper.selectionCanvas.height)&&this.documentHelper.selectionContext.clearRect(c+d*h-this.viewer.containerLeft-.5,p+t*h-this.viewer.containerTop-.5,l*h+.5,i*h+.5)}}},a.prototype.selectCurrentWord=function(e){var t=this.start.clone(),i=this.end.clone();this.selectCurrentWordRange(t,i,e||!1),this.selectRange(t,i)},a.prototype.selectParagraph=function(){_.isNullOrUndefined(this.start)||(this.start.paragraphStartInternal(this,!1),this.end.moveToParagraphEndInternal(this,!1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},a.prototype.selectLine=function(){_.isNullOrUndefined(this.start)||(this.moveToLineStart(),this.handleShiftEndKey())},a.prototype.moveToDocumentStart=function(){this.handleControlHomeKey()},a.prototype.moveToDocumentEnd=function(){this.handleControlEndKey()},a.prototype.moveToParagraphStart=function(){this.isForward?(this.start.paragraphStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.paragraphStartInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.fireSelectionChanged(!0)},a.prototype.moveToParagraphEnd=function(){this.isForward?(this.start.moveToParagraphEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.moveToParagraphEndInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.fireSelectionChanged(!0)},a.prototype.moveToNextLine=function(){this.moveDown()},a.prototype.moveToPreviousLine=function(){this.moveUp()},a.prototype.moveToNextCharacter=function(){this.handleRightKey()},a.prototype.moveToPreviousCharacter=function(){this.handleLeftKey()},a.prototype.selectCurrentWordRange=function(e,t,i){var n,r,o;_.isNullOrUndefined(e)||(0<e.offset&&(n=e.clone(),o=(r=e.currentWidget.getInline(e.offset,0)).element,r.index,!_.isNullOrUndefined(o)&&o instanceof Z&&1===o.fieldType?2<e.offset&&(!_.isNullOrUndefined(o.fieldSeparator)||_.isNullOrUndefined(o.fieldBegin))?(n.setPositionParagraph(n.currentWidget,e.offset-2),n.moveToWordEndInternal(0,!1),n.paragraph===e.paragraph&&n.offset===e.offset-1||e.moveToWordStartInternal(2)):3<e.offset&&_.isNullOrUndefined(o.fieldSeparator)&&(n.setPositionParagraph(n.currentWidget,e.offset-3),n.moveToWordEndInternal(0,!1),n.paragraph===e.paragraph&&n.offset===e.offset||e.moveToWordStartInternal(2)):(n.setPositionParagraph(n.currentWidget,e.offset-1),n.moveToWordEndInternal(0,!1),n.paragraph===e.paragraph&&n.offset===e.offset||e.moveToWordStartInternal(2))),t.moveToWordEndInternal(2,i))},a.prototype.extendToParagraphStart=function(){_.isNullOrUndefined(this.start)||(this.end.paragraphStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},a.prototype.extendToParagraphEnd=function(){_.isNullOrUndefined(this.start)||(this.end.moveToParagraphEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},a.prototype.moveNextPosition=function(){var e;_.isNullOrUndefined(this.start)||(this.isEmpty&&(this.start.moveNextPosition(),this.end.setPositionInternal(this.start)),this.updateForwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode&&!this.getCurrentFormField()&&(e=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!0,e)))},a.prototype.moveToNextParagraph=function(){_.isNullOrUndefined(this.start)||(this.end.moveToNextParagraphStartInternal(),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},a.prototype.nextFootnote=function(){if(this.isinFootnote)for(var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.footnoteCollection.length,this.documentHelper.footnoteCollection.indexOf(e)),i=this.documentHelper.footnoteCollection[t+1],n=(_.isNullOrUndefined(i)&&(i=e),this.start.clone()),r=this.end.clone(),o=0;o<this.documentHelper.pages.length;o++)for(var s=this.documentHelper.pages[o].footnoteWidget,a=1;a<s.bodyWidgets.length;a++)s.bodyWidgets[a].footNoteReference===i&&(n.setPositionParagraph(s.bodyWidgets[a].childWidgets[0].childWidgets[0],0),r.setPositionInternal(n),this.selectRange(n,r))},a.prototype.previousFootnote=function(){if(this.isinFootnote)for(var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.footnoteCollection.length,this.documentHelper.footnoteCollection.indexOf(e)),i=this.documentHelper.footnoteCollection[t-1],n=(_.isNullOrUndefined(i)&&(i=e),this.start.clone()),r=this.end.clone(),o=0;o<this.documentHelper.pages.length;o++)for(var s=this.documentHelper.pages[o].footnoteWidget,a=1;a<s.bodyWidgets.length;a++)s.bodyWidgets[a].footNoteReference===i&&(n.setPositionParagraph(s.bodyWidgets[a].childWidgets[0].childWidgets[0],0),r.setPositionInternal(n),this.selectRange(n,r))},a.prototype.nextEndnote=function(){if(this.isinEndnote)for(var e=this.start.paragraph.bodyWidget.footNoteReference,t=this.documentHelper.endnoteCollection.indexOf(e),i=this.documentHelper.endnoteCollection[t+1],n=(_.isNullOrUndefined(i)&&(i=e),this.start.clone()),r=this.end.clone(),o=this.documentHelper.pages[this.endPage-1].endnoteWidget,s=0;s<o.childWidgets.length;s++)o.bodyWidgets[s].footNoteReference===i&&(n.setPositionParagraph(o.bodyWidgets[s].childWidgets[0].childWidgets[0],0),r.setPositionInternal(n),this.selectRange(n,r))},a.prototype.previousEndnote=function(){if(this.isinEndnote)for(var e=this.start.paragraph.bodyWidget.footNoteReference,t=this.documentHelper.endnoteCollection.indexOf(e),i=this.documentHelper.endnoteCollection[t-1],n=(_.isNullOrUndefined(i)&&(i=e),this.start.clone()),r=this.end.clone(),o=this.documentHelper.pages[this.endPage-1].endnoteWidget,s=0;s<o.childWidgets.length;s++)o.bodyWidgets[s].footNoteReference===i&&(n.setPositionParagraph(o.bodyWidgets[s].childWidgets[0].childWidgets[0],0),r.setPositionInternal(n),this.selectRange(n,r))},a.prototype.movePreviousPosition=function(){var e;_.isNullOrUndefined(this.start)||(this.isEmpty&&(this.start.movePreviousPosition(),this.end.setPositionInternal(this.start)),this.updateBackwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode&&!this.getCurrentFormField()&&(e=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!1,e)))},a.prototype.moveToPreviousParagraph=function(){_.isNullOrUndefined(this.start)||(this.end.moveToPreviousParagraph(this),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},a.prototype.extendToPreviousLine=function(){_.isNullOrUndefined(this.start)||(this.end.moveToPreviousLine(this,this.upDownSelectionLength),this.fireSelectionChanged(!0))},a.prototype.extendToLineEnd=function(){_.isNullOrUndefined(this.start)||(this.end.moveToLineEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},a.prototype.extendToLineStart=function(){_.isNullOrUndefined(this.start)||(this.end.moveToLineStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.start.paragraph===this.end.paragraph&&this.start.offset===this.start.currentWidget.getEndOffset()&&this.isParagraphLastLine(this.start.currentWidget)&&this.isParagraphFirstLine(this.end.currentWidget)&&this.start.setPositionParagraph(this.start.currentWidget,this.start.offset+1),this.fireSelectionChanged(!0))},a.prototype.moveUp=function(){if(this.documentHelper.isFormFillProtectedMode)this.selectPrevNextFormField(!1);else if(!_.isNullOrUndefined(this.start)){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x;var e,t=this.start.currentWidget.paragraph.bodyWidget.columnIndex,i=(this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns,this.start.currentWidget.paragraph.bodyWidget.index),n=(this.start.moveUp(this,this.upDownSelectionLength),e=1<this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns,this.start.currentWidget.paragraph.bodyWidget.columnIndex);if(e)if(t===n||i!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)this.end.setPositionInternal(this.start);else for(;!(_.isNullOrUndefined(this.start.currentWidget.paragraph.previousRenderedWidget)||i!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns||i!==this.start.currentWidget.paragraph.bodyWidget.index&&1<this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns&&t>this.start.currentWidget.paragraph.bodyWidget.columnIndex||(this.start.moveUp(this,this.upDownSelectionLength),t===this.start.currentWidget.paragraph.bodyWidget.columnIndex)););this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0)}},a.prototype.moveDown=function(){if(this.documentHelper.isFormFillProtectedMode)this.selectPrevNextFormField(!0);else if(!_.isNullOrUndefined(this.start)){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x;var e=this.start.currentWidget.paragraph.bodyWidget.columnIndex,t=this.start.currentWidget.paragraph.bodyWidget.index,i=1<this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns,n=(this.start.moveDown(this,this.upDownSelectionLength),this.start.currentWidget.paragraph.bodyWidget.columnIndex);if(i)if(e===n||t!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)this.end.setPositionInternal(this.start);else for(;!(_.isNullOrUndefined(this.start.currentWidget.paragraph.nextRenderedWidget)||t!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns||t!==this.start.currentWidget.paragraph.bodyWidget.index&&1<this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns&&this.documentHelper.layout.getBodyWidget(this.start.currentWidget.paragraph.bodyWidget,!1)===this.start.currentWidget.paragraph.bodyWidget||(this.start.moveDown(this,this.upDownSelectionLength),e===this.start.currentWidget.paragraph.bodyWidget.columnIndex)););this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0)}},a.prototype.updateForwardSelection=function(){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start))},a.prototype.updateBackwardSelection=function(){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end))},a.prototype.getFirstBlockInFirstCell=function(e){if(0<e.childWidgets.length){var e=e.childWidgets[0];if(0<e.childWidgets.length)return 0===(e=e.childWidgets[0]).childWidgets.length?void 0:e.childWidgets[0]}},a.prototype.getFirstCellInRegion=function(e,t,i,n){var r,o=this.getCellLeft(e,t),s=o+t.cellFormat.cellWidth,a=!0;if(o<=i&&i<s)for(var l=0;l<e.childWidgets.length;l++){var d=this.getCellLeft(e,e.childWidgets[l]);if(j.round(o,2)<=j.round(d,2)&&j.round(d,2)<j.round(s,2))return a=!1,e.childWidgets[l]}else for(var h=0;h<e.childWidgets.length;h++){var c=this.getCellLeft(e,e.childWidgets[h]);if(c<=i&&c+e.childWidgets[h].cellFormat.cellWidth>i)return a=!1,e.childWidgets[h]}if(a){if(!_.isNullOrUndefined(e.previousRenderedWidget)&&n)return r=e.previousRenderedWidget,this.getFirstCellInRegion(r,t,i,n);if(!_.isNullOrUndefined(e.nextRenderedWidget)&&!n)return this.getFirstCellInRegion(e.nextRenderedWidget,t,i,n)}return e.childWidgets[0]},a.prototype.getFirstParagraph=function(e){for(;e.previousSplitWidget;)e=e.previousSplitWidget;var t=e.firstChild;return this.documentHelper.getFirstParagraphBlock(t)},a.prototype.getLastBlockInLastCell=function(e){if(0<e.childWidgets.length){for(var e=e.childWidgets[e.childWidgets.length-1],t=e.childWidgets[e.childWidgets.length-1];0===t.childWidgets.length&&!_.isNullOrUndefined(t.previousSplitWidget);)t=t.previousSplitWidget;return t.childWidgets[t.childWidgets.length-1]}},a.prototype.moveToLineStart=function(){_.isNullOrUndefined(this.start)||(this.updateBackwardSelection(),this.start.moveToLineStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},a.prototype.moveToLineEnd=function(){_.isNullOrUndefined(this.start)||(this.updateForwardSelection(),this.start.moveToLineEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},a.prototype.getPageTop=function(e){return(e.boundingRectangle.y-this.viewer.pageGap*(this.documentHelper.pages.indexOf(e)+1))*this.documentHelper.zoomFactor+this.viewer.pageGap*(this.documentHelper.pages.indexOf(e)+1)},a.prototype.moveTextPosition=function(e,t,i){var n;_.isNullOrUndefined(this.start)||(n=this.documentHelper.getLineWidgetInternal(e,!0),_.isNullOrUndefined(n)||this.updateTextPositionWidget(n,e,t,!0),this.upDownSelectionLength=t.location.x,(n=this.start.getHierarchicalIndexInternal())===(e=this.end.getHierarchicalIndexInternal())||i||(y.isForwardSelection(n,e)?t.validateForwardFieldSelection(n,e):t.validateBackwardFieldSelection(n,e)),this.fireSelectionChanged(!0))},a.prototype.getDocumentStart=function(){var e=this.documentHelper.pages[0].bodyWidgets[0].childWidgets[0];return this.setPositionForBlock(e,!0)},a.prototype.getDocumentEnd=function(){for(var e,t=void 0,i=this.owner.documentStart,n=this.documentHelper.pages[this.documentHelper.pages.length-1];n.previousPage&&1===n.bodyWidgets.length&&0===n.bodyWidgets[0].childWidgets.length;)n=n.previousPage;return!_.isNullOrUndefined(i)&&0<n.bodyWidgets[n.bodyWidgets.length-1].childWidgets.length&&(i=void 0,(e=(e=n.bodyWidgets[n.bodyWidgets.length-1].childWidgets)[e.length-1])instanceof Qd&&(i=e),t=this.setPositionForBlock(i,!1)),t},a.prototype.handleControlEndKey=function(){var e=void 0;_.isNullOrUndefined(this.owner.documentEnd)||(e=this.owner.documentEnd),_.isNullOrUndefined(e)||this.owner.selectionModule.selectContent(e,!0),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},a.prototype.handleControlHomeKey=function(){var e=void 0;_.isNullOrUndefined(this.owner.documentStart)||(e=this.owner.documentStart),_.isNullOrUndefined(e)||this.owner.selectionModule.selectContent(e,!0),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},a.prototype.handleControlLeftKey=function(){this.extendToWordStartInternal(!0),this.checkForCursorVisibility()},a.prototype.handleControlRightKey=function(){this.extendToWordEndInternal(!0),this.checkForCursorVisibility()},a.prototype.handleControlDownKey=function(){this.moveToNextParagraph(),this.checkForCursorVisibility()},a.prototype.handleControlUpKey=function(){this.moveToPreviousParagraph(),this.checkForCursorVisibility()},a.prototype.handleShiftLeftKey=function(){this.extendBackward(),this.checkForCursorVisibility()},a.prototype.handleShiftUpKey=function(){this.extendToPreviousLine(),this.checkForCursorVisibility()},a.prototype.handleShiftRightKey=function(){this.extendForward(),this.checkForCursorVisibility()},a.prototype.handleShiftDownKey=function(){this.extendToNextLine(),this.checkForCursorVisibility()},a.prototype.handleControlShiftLeftKey=function(){(this.isForward?this.start:this.end).isCurrentParaBidi?this.extendToWordEndInternal(!1):this.extendToWordStartInternal(!1),this.checkForCursorVisibility()},a.prototype.handleControlShiftUpKey=function(){this.extendToParagraphStart(),this.checkForCursorVisibility()},a.prototype.handleControlShiftRightKey=function(){(this.isForward?this.start:this.end).isCurrentParaBidi?this.extendToWordStartInternal(!1):this.extendToWordEndInternal(!1),this.checkForCursorVisibility()},a.prototype.handleControlShiftDownKey=function(){this.extendToParagraphEnd(),this.checkForCursorVisibility()},a.prototype.handleLeftKey=function(){this.end.isCurrentParaBidi?this.moveNextPosition():this.movePreviousPosition(),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},a.prototype.handleUpKey=function(){this.isMoveDownOrMoveUp=!0,this.moveUp(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},a.prototype.handleRightKey=function(){this.end.isCurrentParaBidi?this.movePreviousPosition():this.moveNextPosition(),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},a.prototype.handleEndKey=function(){this.moveToLineEnd(),this.checkForCursorVisibility()},a.prototype.handleHomeKey=function(){this.moveToLineStart(),this.checkForCursorVisibility()},a.prototype.handleDownKey=function(){this.isMoveDownOrMoveUp=!0,this.moveDown(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},a.prototype.handleShiftEndKey=function(){this.extendToLineEnd(),this.checkForCursorVisibility()},a.prototype.handleShiftHomeKey=function(){this.extendToLineStart(),this.checkForCursorVisibility()},a.prototype.handleControlShiftEndKey=function(){var e=void 0;_.isNullOrUndefined(this.owner.documentEnd)||(e=this.owner.documentEnd),_.isNullOrUndefined(e)||(this.end.setPosition(e.currentWidget,!1),this.fireSelectionChanged(!0)),this.checkForCursorVisibility()},a.prototype.handleControlShiftHomeKey=function(){var e=void 0;_.isNullOrUndefined(this.owner.documentStart)||(e=this.owner.documentStart),_.isNullOrUndefined(e)||(this.end.setPositionInternal(e),this.fireSelectionChanged(!0)),this.checkForCursorVisibility()},a.prototype.handleSpaceBarKey=function(){this.owner.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.owner.documentHelper.protectionType&&"CheckBox"===this.getFormFieldType()&&this.owner.editorModule.toggleCheckBoxFormField(this.getCurrentFormField())},a.prototype.handleTabKey=function(e,t){var i=this.start,n=(this.isForward||(i=this.end),!1),r=!1;_.isNullOrUndefined(i)||(0!==i.offset&&(this.isForward||0!==this.end.offset)||-1!=i.paragraph.paragraphFormat.listFormat.listId||(i.currentWidget.isFirstLine()&&(n=!0),r=!0),this.start.paragraph.isInsideTable&&this.end.paragraph.isInsideTable&&(e||t)?this.owner.documentHelper.isDocumentProtected||"FormFieldsOnly"===this.documentHelper.protectionType||(t?this.selectPreviousCell():this.selectNextCell()):!e&&!t||_.isNullOrUndefined(i)||i.offset!==this.getStartOffset(i.paragraph)||_.isNullOrUndefined(i.paragraph.paragraphFormat)||_.isNullOrUndefined(i.paragraph.paragraphFormat.listFormat)||-1===i.paragraph.paragraphFormat.listFormat.listId||this.owner.isReadOnlyMode?this.owner.isReadOnlyMode||this.documentHelper.isFormFillProtectedMode||(n&&i.paragraph.paragraphFormat.firstLineIndent<this.documentHelper.defaultTabWidth?this.documentHelper.owner.editorModule.onApplyParagraphFormat("firstLineIndent",this.documentHelper.defaultTabWidth,!0,!1):r?t?this.owner.editorModule.decreaseIndent():j.convertPointToPixel(i.paragraph.paragraphFormat.firstLineIndent+i.paragraph.paragraphFormat.leftIndent)<this.documentHelper.viewer.clientArea.width&&this.owner.editorModule.increaseIndent():this.owner.editorModule.handleTextInput("\t")):(e=this.documentHelper.selection,n=i.paragraph,e.isForward||(n=e.end.paragraph),this.owner.editorModule.isFirstParaForList(e,n)?t?this.owner.editorModule.updateListLevelIndent(-this.documentHelper.defaultTabWidth,n):this.owner.editorModule.updateListLevelIndent(this.documentHelper.defaultTabWidth,n):this.owner.editorModule.updateListLevel(!t)),"FormFieldsOnly"===this.documentHelper.protectionType&&0<this.documentHelper.formFields.length&&this.selectPrevNextFormField(!t),this.checkForCursorVisibility())},a.prototype.handlePageUpPageDownKey=function(t,i){var n=this,r=this.end.location.x,o=this.end.location.y,e=this.end.paragraph.bodyWidget.page,s=this.getPageTop(e),a=this.documentHelper.viewerContainer.scrollTop,o=o*this.documentHelper.zoomFactor+(s-a),r=r*this.documentHelper.zoomFactor+e.boundingRectangle.x,l=(t?this.documentHelper.viewerContainer.scrollTop+=this.documentHelper.visibleBounds.height:this.documentHelper.viewerContainer.scrollTop-=this.documentHelper.visibleBounds.height,!1);a===this.documentHelper.viewerContainer.scrollTop&&(l=!0),i&&(this.documentHelper.skipScrollToPosition=!0),setTimeout(function(){var e;l?i?(e=void 0,e=t?n.getDocumentEnd():n.getDocumentStart(),n.end.setPositionForLineWidget(e.currentWidget,e.offset),n.fireSelectionChanged(!0)):t?n.moveToDocumentEnd():n.moveToDocumentStart():n.select({x:r,y:o,extend:i})},0)},a.prototype.getFormFieldInFormFillMode=function(){for(var e,t=this.owner.selectionModule.start,i=this.documentHelper.formFields.length-1;0<=i;i--)if(this.documentHelper.formFields[i].formFieldData.enabled){if(this.getElementPosition(this.documentHelper.formFields[i]).startPosition.isExistBefore(t)){e=this.documentHelper.formFields[i];break}0===i&&(e=this.documentHelper.formFields[this.documentHelper.formFields.length-1])}return e},a.prototype.selectPrevNextFormField=function(e,t){if(this.documentHelper.isFormFillProtectedMode){t=t||this.getCurrentFormField();t=this.documentHelper.formFields.indexOf(t);if(e)for(var i=t;;i++){if(i===this.documentHelper.formFields.length-1?i=0:i+=1,this.documentHelper.formFields[i].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[i],!0);break}i-=1}else for(i=t;;i--){if(0===i?i=this.documentHelper.formFields.length-1:i-=1,this.documentHelper.formFields[i].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[i],!0);break}i+=1}}},a.prototype.navigateToNextFormField=function(){for(var e,t=this.owner.selectionModule.end,i=0;i<this.documentHelper.formFields.length;i++)if(e=this.documentHelper.formFields[i],this.documentHelper.formFields[i].formFieldData.enabled){if(this.getElementPosition(this.documentHelper.formFields[i]).startPosition.isExistAfter(t)){e.formFieldData instanceof Ch&&"Text"===e.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[i]):this.selectFieldInternal(this.documentHelper.formFields[i]);break}i===this.documentHelper.formFields.length-1&&((e=this.documentHelper.formFields[0]).formFieldData instanceof Ch&&"Text"===e.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[0]):this.selectFieldInternal(this.documentHelper.formFields[0]))}},a.prototype.selectTextElementStartOfField=function(e){var t=e.fieldSeparator.nextElement;if(t){for(;!(t instanceof X);)t=t.nextElement;var i=e.line.getOffset(t,0),i=this.getPhysicalPositionInternal(e.line,i,!1);this.selectInternal(e.line,t,0,i)}},a.prototype.triggerFormFillEvent=function(e){var t,i=this.previousSelectedFormField,n=this.currentFormField;n!==i&&i&&i.formFieldData instanceof Ch&&"Text"===i.formFieldData.type&&(t={fieldName:(i=""===i.formFieldData.format||this.isFormatUpdated||(this.owner.editorModule.applyFormTextFormat(i),_.isNullOrUndefined(this.previousSelectedFormField))?i:this.previousSelectedFormField).formFieldData.name,value:this.owner.editorModule.getFieldResultText(i)},this.owner.trigger(se,t)),n!==i&&n&&(n.formFieldData instanceof Ch&&"Text"===n.formFieldData.type&&null==e||(n.formFieldData instanceof Ch&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode||n.formFieldData instanceof Fh)&&e)&&(t={fieldName:n.formFieldData.name,value:this.owner.editorModule.getFieldResultText(n)},this.owner.trigger(ae,t))},a.prototype.selectPreviousCell=function(){var e,t=this.start.paragraph.associatedCell,i=t.ownerRow;i.ownerTable;_.isNullOrUndefined(t.previousWidget)?_.isNullOrUndefined(i.previousRenderedWidget)||(e=void 0,i.previousRenderedWidget instanceof dh&&(e=i.previousRenderedWidget),this.selectTableCellInternal(e.childWidgets[e.childWidgets.length-1],!0)):(i=void 0,t.previousWidget instanceof N&&(i=t.previousWidget),this.selectTableCellInternal(i,!0))},a.prototype.selectNextCell=function(){var e,t=this.start.paragraph.associatedCell,i=t.ownerRow;i.ownerTable;_.isNullOrUndefined(t.nextWidget)?_.isNullOrUndefined(i.nextRenderedWidget)&&!this.owner.isReadOnlyMode?this.owner.editorModule.insertRow(!1):(e=void 0,i.nextRenderedWidget instanceof dh&&(e=i.nextRenderedWidget),this.selectTableCellInternal(e.childWidgets[0],!0)):(i=void 0,t.nextRenderedWidget instanceof N&&(i=t.nextRenderedWidget),this.selectTableCellInternal(i,!0))},a.prototype.selectTableCellInternal=function(e,t){var i=this.getFirstParagraph(e),e=this.getLastParagraph(e);i===e&&e.isEmpty()?this.selectParagraphInternal(e,!0):(e=e.childWidgets[0],this.start.setPosition(i.childWidgets[0],!0),this.end.setPositionParagraph(e,e.getEndOffset()),this.fireSelectionChanged(!0))},a.prototype.selectTableInternal=function(){var e,t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start),_.isNullOrUndefined(t)||_.isNullOrUndefined(i)||_.isNullOrUndefined(this.getTable(t,i))||(t=this.getContainerCellOf(t.paragraph.associatedCell,i.paragraph.associatedCell).ownerTable,i=this.documentHelper.getFirstParagraphBlock(t),e=(t=this.documentHelper.getLastParagraphBlock(t)).lastChild.getEndOffset(),this.start.setPosition(i.childWidgets[0],!0),this.end.setPositionParagraph(t.lastChild,e+1)),this.selectPosition(this.start,this.end)},a.prototype.getTableRevision=function(){var e,t=this.start.clone(),i=this.end.clone(),n=(this.isForward||(t=this.end.clone(),i=this.start.clone()),_.isNullOrUndefined(t)||_.isNullOrUndefined(i)||_.isNullOrUndefined(this.getTable(t,i))||(r=this.getContainerCellOf(t.paragraph.associatedCell,i.paragraph.associatedCell).ownerTable,n=this.documentHelper.getFirstParagraphBlock(r),e=(r=this.documentHelper.getLastParagraphBlock(r)).lastChild.getEndOffset(),t.setPosition(n.childWidgets[0],!0),i.setPositionParagraph(r.lastChild,e+1)),this.getAbsolutePositionFromRelativePosition(t)),r=this.getAbsolutePositionFromRelativePosition(i);return Math.abs(r-n)},a.prototype.selectColumnInternal=function(){var e,t,i,n,r,o=this.start,s=this.end;this.isForward||(o=this.end,s=this.start),_.isNullOrUndefined(o)||_.isNullOrUndefined(s)||_.isNullOrUndefined(this.getTable(o,s))||(e=this.getContainerCellOf(o.paragraph.associatedCell,s.paragraph.associatedCell)).ownerTable.contains(s.paragraph.associatedCell)&&(o=this.getSelectedCell(o.paragraph.associatedCell,e),t=this.getSelectedCell(s.paragraph.associatedCell,e),this.containsCell(e,s.paragraph.associatedCell)?(o.ownerRow,0<(s=e.ownerTable.getColumnCellsForSelection(e,e)).length&&(i=this.getFirstParagraph(s[0]),n=this.getLastParagraph(s[s.length-1]),this.start.setPosition(i.firstChild,!0),r=n.lastChild,this.end.setPositionParagraph(r,r.getEndOffset()+1))):(s=e.ownerTable.getColumnCellsForSelection(o,o),o=e.ownerTable.getColumnCellsForSelection(t,t),0<s.length&&0<o.length&&(i=this.getFirstParagraph(s[0]),n=this.getLastParagraph(o[o.length-1]),this.start.setPosition(i.firstChild,!0),r=n.lastChild,this.end.setPositionParagraph(r,r.getEndOffset()+1)))),this.selectPosition(this.start,this.end)},a.prototype.selectTableRow=function(){var e,t,i,n,r=this.start,o=this.end;this.isForward||(r=this.end,o=this.start),_.isNullOrUndefined(r)||_.isNullOrUndefined(o)||_.isNullOrUndefined(this.getTable(r,o))||(n=void 0,(n=this.getContainerCellOf(r.paragraph.associatedCell,o.paragraph.associatedCell)).ownerTable.contains(o.paragraph.associatedCell)&&(r=this.getSelectedCell(r.paragraph.associatedCell,n),e=this.getSelectedCell(o.paragraph.associatedCell,n),i=this.containsCell(n,o.paragraph.associatedCell)?(n=r.ownerRow,t=this.getFirstParagraph(n.childWidgets[0]),this.getLastParagraph(n.childWidgets[n.childWidgets.length-1])):(t=this.getFirstParagraph(r.ownerRow.childWidgets[0]),i=void 0,this.getLastParagraph(e.ownerRow.childWidgets[e.ownerRow.childWidgets.length-1])),this.start.setPosition(t.firstChild,!0),this.end.setPositionParagraph(i.lastChild,i.lastChild.getEndOffset()+1))),this.selectPosition(this.start,this.end)},a.prototype.selectTableCell=function(){var e,t,i,n=this.start,r=this.end;this.isForward||(n=this.end,r=this.start),_.isNullOrUndefined(this.getTable(n,r))||(this.isEmpty?n.paragraph.isInsideTable&&!_.isNullOrUndefined(n.paragraph.associatedCell)&&((t=this.getFirstParagraph(n.paragraph.associatedCell))===(i=this.getLastParagraph(r.paragraph.associatedCell))?this.start.setPosition(i.firstChild,!0):this.start.setPosition(t.firstChild,!0),this.end.setPositionParagraph(i.lastChild,i.lastChild.getEndOffset()+1)):(e=this.getContainerCell(n.paragraph.associatedCell),this.containsCell(e,n.paragraph.associatedCell)&&this.containsCell(e,r.paragraph.associatedCell)&&(t=this.getFirstParagraph(e),i=this.getLastParagraph(e),_.isNullOrUndefined(t)||_.isNullOrUndefined(i)||(this.start.setPosition(t.firstChild,!0),this.end.setPositionParagraph(i.lastChild,i.lastChild.getEndOffset()+1)))),this.selectPosition(this.start,this.end))},a.prototype.selectAll=function(){this.documentHelper.skipScrollToPosition=!0;var e=this.getContainerWidget(this.start.paragraph);if(this.owner.enableHeaderAndFooter)var t=this.getContainerWidget(this.start.paragraph),i=this.setPositionForBlock(t.firstChild,!0),n=this.setPositionForBlock(t.lastChild,!1);else if(this.isInShape){var t=this.getCurrentTextFrame();i=this.setPositionForBlock(t.firstChild,!0),n=this.setPositionForBlock(t.lastChild,!1)}else if(e instanceof q&&"Footnote"===e.footNoteType){for(var r=void 0,o=void 0,s=this.documentHelper.pages.length,r=0;r<=s-1;r++)if(!_.isNullOrUndefined(this.documentHelper.pages[r].footnoteWidget)){i=this.setPositionForBlock(this.documentHelper.pages[r].footnoteWidget.bodyWidgets[0].firstChild,!0);break}for(o=s-1;0<=o;o--)if(!_.isNullOrUndefined(this.documentHelper.pages[o].footnoteWidget)){var a=this.documentHelper.pages[o].footnoteWidget.bodyWidgets.length,l=this.documentHelper.pages[o].footnoteWidget.bodyWidgets[a-1].childWidgets.length;n=this.setPositionForBlock(this.documentHelper.pages[o].footnoteWidget.bodyWidgets[a-1].childWidgets[l-1],!1);break}}else n=e instanceof q&&"Endnote"===e.footNoteType?(t=this.getContainerWidget(this.start.paragraph),i=this.setPositionForBlock(t.bodyWidgets[0].firstChild,!0),this.setPositionForBlock(t.bodyWidgets[t.bodyWidgets.length-1].firstChild,!1)):(i=this.owner.documentStart,this.owner.documentEnd);_.isNullOrUndefined(i)||(this.start.setPositionInternal(i),this.end.setPositionParagraph(n.currentWidget,n.offset+1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},a.prototype.extendBackward=function(){_.isNullOrUndefined(this.start)||((this.isForward?this.start:this.end).isCurrentParaBidi?this.end.moveForward():this.end.moveBackward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},a.prototype.extendForward=function(){_.isNullOrUndefined(this.start)||((this.isForward?this.start:this.end).isCurrentParaBidi?this.end.moveBackward():this.end.moveForward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},a.prototype.extendToWordStartEnd=function(){return!(!this.start.paragraph.isInsideTable&&!this.end.paragraph.isInsideTable||this.start.paragraph.associatedCell===this.end.paragraph.associatedCell&&!this.isCellSelected(this.start.paragraph.associatedCell,this.start,this.end))},a.prototype.extendToWordStart=function(){this.extendToWordStartInternal(!1)},a.prototype.extendToWordEnd=function(){this.extendToWordEndInternal(!1)},a.prototype.extendToWordStartInternal=function(e){_.isNullOrUndefined(this.start)||(this.extendToWordStartEnd()?this.end.moveToPreviousParagraphInTable(this):e&&this.end.isCurrentParaBidi?this.end.moveToWordEndInternal(e?0:1,!1):this.end.moveToWordStartInternal(e?0:1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},a.prototype.extendToWordEndInternal=function(e){_.isNullOrUndefined(this.start)||(this.extendToWordStartEnd()?this.end.moveToNextParagraphInTable():e&&this.end.isCurrentParaBidi?this.end.moveToWordStartInternal(e?0:1):this.end.moveToWordEndInternal(e?0:1,!1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},a.prototype.extendToNextLine=function(){_.isNullOrUndefined(this.start)||(this.end.moveToNextLine(this.upDownSelectionLength),this.fireSelectionChanged(!0))},a.prototype.getTextPosition=function(e){var t=new y(this.owner);return t.setPositionForCurrentIndex(e),t},a.prototype.getText=function(e){var t,i;if(!(_.isNullOrUndefined(this.start)||_.isNullOrUndefined(this.end)||_.isNullOrUndefined(this.start.paragraph)||_.isNullOrUndefined(this.end.paragraph)))return t=this.start,i=this.end,t.isAtSamePosition(i)?"":this.getTextInternal(t,i,e)},a.prototype.getTextInternal=function(e,t,i){e.isExistAfter(t)&&(n=t,t=e,e=n);var n=e,r=t;if(!(_.isNullOrUndefined(e)||_.isNullOrUndefined(t)||_.isNullOrUndefined(e.paragraph)||_.isNullOrUndefined(t.paragraph))){var o=0,s=e.offset,a=t.offset,e=e.currentWidget.getInline(s,o),s=(o=e.index,e.element),e=(s instanceof Z&&!_.isNullOrUndefined(s.fieldEnd)&&(s=(e=this.getRenderedInline(s,o)).element,o=e.index),t.currentWidget.getInline(a,0)),t=e.element,e=e.index,l="";if(s instanceof Ic&&i&&0===o?l=mh.objectCharacter:s instanceof X&&(l=_.isNullOrUndefined(s.text)||""===s.text||s.text.length<o?l:s.text.substring(o)),n.paragraph===r.paragraph)s instanceof mh&&(s===t&&s instanceof X?l=l.length<e-o?l:l.substring(0,e-o):s.nextNode instanceof mh&&(l+=this.getTextInline(s.nextNode,r.paragraph,t,e,i)));else if(s instanceof mh&&s.nextNode instanceof mh)l+=this.getTextInline(s.nextNode,r.paragraph,t,e,i);else{var d=this.documentHelper.selection.getNextParagraphBlock(n.paragraph);for(l+="\r";!_.isNullOrUndefined(d)&&d.isEmpty();){if(l+="\r",d===r.paragraph)return l;d=this.documentHelper.selection.getNextParagraphBlock(d)}_.isNullOrUndefined(d)||d.isEmpty()||(l+=this.getTextInline(d.childWidgets[0].children[0],r.paragraph,t,e,i))}return a===r.currentWidget.getEndOffset()+1&&(l+="\r"),l}},a.prototype.getHierarchicalIndex=function(e,t){var i,n,r,o;if(e){if(i=e instanceof Xd?(r=-1!==e.headerFooterType.indexOf("Header")?"H":"F",o=e.page.index.toString(),e.page.sectionIndex+";"+r+";"+o+";"+t):e instanceof z&&!_.isNullOrUndefined(e.containerWidget)&&e.containerWidget instanceof q?e.containerWidget.bodyWidgets.indexOf(e)+";"+t:e.index+";"+t,e instanceof fc)return n=e.containerShape.line.getOffset(e.containerShape,1),this.getHierarchicalIndex(e.containerShape.paragraph,i="S;"+n+";"+t);if(e instanceof q&&(r="Footnote"===e.footNoteType?"FN":"EN",o=e.page.index.toString(),i=e.page.sectionIndex+";"+r+";"+o+";"+t),e.containerWidget)return e instanceof N&&e.rowIndex!==e.containerWidget.index&&(i=e.rowIndex+";"+i,e=e.containerWidget),this.getHierarchicalIndex(e.containerWidget,i)}return i},a.prototype.getHierarchicalIndexByPosition=function(e){e=this.getParagraphInfo(e);return this.getHierarchicalIndex(e.paragraph,e.offset.toString())},a.prototype.getTextPosBasedOnLogicalIndex=function(e){var t=new y(this.owner),e=this.getParagraph({index:e}),e=this.getLineInfoBasedOnParagraph(e.paragraph,e.offset);return t.setPositionForLineWidget(e.line,e.offset),t},a.prototype.getLineInfoBasedOnParagraph=function(e,t){var i=this.getParagraphLength(e),n=e.nextSplitWidget;for(i+1<t&&_.isNullOrUndefined(n)&&(t=i);i<t&&n instanceof G;)t-=i,e=n,i=this.getParagraphLength(e),n=e.nextSplitWidget;return this.getLineInfo(e,t)},a.prototype.getParagraph=function(e){return{paragraph:this.getParagraphInternal(this.getBodyWidget(e),e),offset:parseInt(e.index,10)}},a.prototype.getBodyWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t),n=(e.index=e.index.substring(t).replace(";",""),parseInt(i,10));parseInt(i,10);return t=e.index.indexOf(";"),"H"===(i=e.index.substring(0,t))||"F"===i?this.getHeaderFooterWidget(e):"FN"===i||"EN"===i?this.getFootNoteWidget(e):(t=parseInt(i,10),this.getBodyWidgetInternal(n,t))},a.prototype.getFootNoteWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t),n=(e.index=e.index.substring(t).replace(";",""),"FN"===i),t=e.index.indexOf(";"),i=e.index.substring(0,t),r=(e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10),this.documentHelper.pages[t]);return t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10),(n?r.footnoteWidget:r.endnoteWidget).bodyWidgets[t]},a.prototype.getHeaderFooterWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t),n=(e.index=e.index.substring(t).replace(";",""),"H"===i),t=e.index.indexOf(";"),i=e.index.substring(0,t),e=(e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10),this.documentHelper.pages[t]),i=n?e.headerWidget:e.footerWidget;return _.isNullOrUndefined(i)||(i.page=e),i},a.prototype.getBodyWidgetInternal=function(e,t){for(var i=0;i<this.documentHelper.pages.length;i++)for(var n=0;n<this.documentHelper.pages[i].bodyWidgets.length;n++){var r=this.documentHelper.pages[i].bodyWidgets[n];if(r.index===e&&0<r.childWidgets.length&&r.firstChild.index<=t&&r.lastChild.index>=t)return r;if(r.index>e)break}},a.prototype.getParagraphInternal=function(e,t){if(!_.isNullOrUndefined(t.index)){var i=t.index.indexOf(";"),n="0";if(0<=i&&(n=t.index.substring(0,i),t.index=t.index.substring(i).replace(";","")),i=parseInt(n,10),e instanceof dh&&i>=e.childWidgets.length&&(t.index="0;0",i=e.childWidgets.length-1),i=this.getBlockByIndex(e,i)){"S"===(n=t.index.substring(0,1))&&(t.index=t.index.substring(1).replace(";",""),n=t.index.substring(0,t.index.indexOf(";")),t.index=t.index.substring(t.index.indexOf(";")).replace(";",""),r=t.index.substring(0,t.index.indexOf(";")),t.index=t.index.substring(t.index.indexOf(";")).replace(";",""),i=i.getInline(parseInt(n),0).element.textFrame.childWidgets[r]);n=i;if(n instanceof G)return 0<t.index.indexOf(";")&&(t.index="0"),n;if(n instanceof Vd)return 0<t.index.indexOf(";")?this.getParagraphInternal(n,t):n instanceof K?this.documentHelper.getFirstParagraphInFirstCell(n):void 0}else if(e){var r=e.getSplitWidgets().pop().nextRenderedWidget;if(r instanceof Vd)return t.index="0",r instanceof K?this.documentHelper.getFirstParagraphInFirstCell(r):r}}},a.prototype.getBlockByIndex=function(e,t){var i;if(e){for(var n=0;n<e.childWidgets.length;n++)if(e.childWidgets[n].index===t){i=e.childWidgets[n];break}if(!(i||e instanceof Xd))return this.getBlockByIndex(e.nextSplitWidget,t)}return i},a.prototype.getParagraphInfo=function(e){return this.getParagraphInfoInternal(e.currentWidget,e.offset)},a.prototype.getCellFromSelection=function(e){var t=this.getSelectedCells();if(!this.hasMergedCells()){if(0==e&&0<t.length){if(!(this.selectedWidgets.keys[0]instanceof N))return;for(var i,n=(i=t[0]).rowIndex,r=i.columnIndex,o=i.ownerTable.index,s=0;s<t.length;s++)(a=t[s]).rowIndex<n&&(n=a.rowIndex),a.columnIndex<r&&(r=a.columnIndex),a.ownerTable.index<o&&(o=a.ownerTable.index);for(s=0;s<t.length;s++)n==(a=t[s]).rowIndex&&r==a.columnIndex&&o==a.ownerTable.index&&(i=a)}else if(1==e&&0<t.length){if(!(this.selectedWidgets.keys[this.selectedWidgets.length-1]instanceof N))return;for(n=(i=t[t.length-1]).rowIndex,r=i.columnIndex,o=i.ownerTable.index,s=t.length-1;0<=s;s--)(a=t[s]).rowIndex>n&&(n=a.rowIndex),a.columnIndex>r&&(r=a.columnIndex),a.ownerTable.index>o&&(o=a.ownerTable.index);for(var a,s=0;s<t.length;s++)n==(a=t[s]).rowIndex&&r==a.columnIndex&&o==a.ownerTable.index&&(i=a)}return i instanceof N?i:void 0}},a.prototype.getCellFromSelectionInTable=function(e){for(var t,i=this.getSelectedCells(),n=this.getCellBoundsInfo(),r=[],o=[],s=0;s<i.length;s++){var a=i[s];r.push(a.rowIndex),o.push(a.columnIndex)}if(r.sort(),o.sort(),1==e)for(var l=n.row.rowLast,d=n.column.colLast,h=!1;!h&&_.isNullOrUndefined(t);){for(s=0;s<i.length;s++){var c=i[s];if(c.rowIndex==l&&c.columnIndex==d){h=!0,t=c;break}}h||--l}else if(0==e){l=n.row.rowFirst,d=n.column.colFirst;for(h=!1;!h&&_.isNullOrUndefined(t);){for(s=0;s<i.length;s++){var p=i[s];if(p.rowIndex==l&&p.columnIndex==d){h=!0,t=p;break}}h||(d+=1)}}return t},a.prototype.getActualOffset=function(e,t){var i,n;return 0==t?(n=this.getFirstParagraph(e),i=this.getHierarchicalIndex(n,this.getStartOffset(n).toString())):1==t&&(t=(n=this.getLastParagraph(e)).lastChild,e=this.getParagraphLength(n,t)+this.getLineLength(t)+1,i=this.getHierarchicalIndex(n,e.toString())),i},a.prototype.getBookmarkProperties=function(e){var t=this.selectedWidgets.keys;if(0==e.bookmarkType){if(!(t[0]instanceof N))return;var i=this.getCellBoundsInfo();if(!_.isNullOrUndefined(i))return{columnFirst:i.column.colFirst.toString(),columnLast:i.column.colLast.toString()}}if(1==e.bookmarkType){if(t[t.length-1]instanceof N)return;i={},t=(this.isParagraphMarkSelected()&&this.end.paragraph.isInsideTable&&(i.isAfterParagraphMark=!0),e.reference),e=this.getSelectedCells();if(t&&!_.isNullOrUndefined(t.properties)&&1==e.length&&this.isCellSelected(e[0],this.start,this.end)&&(i.isAfterCellMark=!0,delete i.isAfterParagraphMark),this.isTableSelected()&&(i.isAfterTableMark=!0),this.isRowSelected()&&(i.isAfterRowMark=!0),!_.isNullOrUndefined(i.isAfterParagraphMark)||!_.isNullOrUndefined(i.isAfterCellMark))return i}},a.prototype.isParagraphMarkSelected=function(){var e=this.end.currentWidget,e=(e instanceof uh&&(t=e.paragraph),this.getParagraphLength(t)),t=this.endOffset.split(";");return e<parseInt(t[t.length-1])},a.prototype.isRowSelected=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),_.isNullOrUndefined(e.paragraph.associatedCell)||_.isNullOrUndefined(t.paragraph.associatedCell))return!1;var i,n,r=t.paragraph.associatedCell.ownerRow.getSplitWidgets();if(0<r[0].childWidgets.length){if(0===(n=r[0].childWidgets[0]).childWidgets.length)return;i=n.childWidgets[0]}for(var r=r[r.length-1],o=r.childWidgets[r.childWidgets.length-1];0===o.childWidgets.length&&!_.isNullOrUndefined(o.previousSplitWidget);)o=o.previousSplitWidget;return r=o.childWidgets[o.childWidgets.length-1],n.equals(i.associatedCell)&&t.paragraph.associatedCell.equals(r.associatedCell)&&(!i.associatedCell.equals(r.associatedCell)||0===e.offset&&t.offset===this.getLineLength(r.lastChild)+1)},a.prototype.getCellBoundsInfo=function(){var e=this.getSelectedCells();if(0<e.length){for(var t=e[0].columnIndex,i=e[e.length-1].columnIndex,n=e[0].rowIndex,r=e[e.length-1].rowIndex,o=0;o<e.length;o++){var s=e[o];s.columnIndex<t&&(t=s.columnIndex),s.columnIndex>i&&(i=s.columnIndex),s.rowIndex<n&&(n=s.rowIndex),s.rowIndex>r&&(r=s.rowIndex)}return{column:{colFirst:t,colLast:i},row:{rowFirst:n,rowLast:r}}}},a.prototype.hasMergedCells=function(){for(var e=this.getSelectedCells(),t=0;t<e.length;t++){var i=e[t];if(1<i.cellFormat.rowSpan||1<i.cellFormat.columnSpan)return!0}return!1},a.prototype.getParagraphInfoInternal=function(e,t){for(var i=e.paragraph,n=this.getParagraphLength(i,e)+t,r=i.previousSplitWidget;r instanceof G;)i=r,n+=this.documentHelper.selection.getParagraphLength(i),r=i.previousSplitWidget;return{paragraph:i,offset:n}},a.prototype.getListTextElementBox=function(e){var t;if(!_.isNullOrUndefined(e))return e.isEmpty()||1<(e=e.childWidgets[0]).children.length&&e.children[0]instanceof Y&&(t=e.children[0]),t},a.prototype.getListLevel=function(e){var t=void 0,i=0;if(_.isNullOrUndefined(e.paragraphFormat)||_.isNullOrUndefined(e.paragraphFormat.listFormat)||(t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber),!_.isNullOrUndefined(t)&&!_.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId))&&!_.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId).levels))return this.documentHelper.layout.getListLevel(t,i)},a.prototype.getTextInline=function(e,t,i,n,r){var o,s="";do{if(e===i)return e instanceof X?(o=e,_.isNullOrUndefined(o.text)||""===o.text||(o.text.length<n?s+=o.text:s+=o.text.substring(0,n))):e instanceof Ic&&r&&n===e.length&&(s+=mh.objectCharacter),s}while((e instanceof X?s+=e.text:e instanceof Ic&&r?s+=mh.objectCharacter:e instanceof Z&&!_.isNullOrUndefined(e.fieldEnd)&&(e=_.isNullOrUndefined(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator),!_.isNullOrUndefined(e.nextNode))&&(e=e.nextNode,!_.isNullOrUndefined(e)));if(t!==e.line.paragraph){for(var a,l=this.documentHelper.selection.getNextParagraphBlock(e.line.paragraph);!_.isNullOrUndefined(l)&&l.isEmpty();){if(s+="\r",l===t)return s;l=this.documentHelper.selection.getNextParagraphBlock(l)}_.isNullOrUndefined(l)||l.isEmpty()||(a=l.childWidgets[0],_.isNullOrUndefined(l.previousSplitWidget)&&(s+="\r"),s+=this.getTextInline(a.children[0],t,i,n,r))}return s},a.prototype.getFieldCode=function(e,t){var i="";if(!(_.isNullOrUndefined(e)||e.fieldEnd instanceof Z))return i;for(var n=e.paragraph,r=e.fieldEnd.paragraph,o=(e.fieldSeparator instanceof Z&&(r=e.fieldSeparator.paragraph),e.line.indexInOwner),s=e.indexInOwner;i+=this.getFieldCodeInternal(n,o,s),n!==r&&(s=o=0,(n=this.getNextParagraphBlock(n))instanceof G););return t?i:i.trim()},a.prototype.getFieldCodeInternal=function(e,t,i){for(var n="",r=t;r<e.childWidgets.length;r++){for(var o=e.childWidgets[r],s=i;s<o.children.length;s++){var a=o.children[s];if(a instanceof X&&(n+=a.text),a instanceof Z&&(2===a.fieldType||1===a.fieldType))return n}i=0}return n},a.prototype.getTocFieldInternal=function(){var e=this.start.paragraph;for(this.isEmpty||this.isForward||(e=this.end.paragraph);e instanceof G&&0<e.childWidgets.length;){var t=e.firstChild;if(0<t.children.length){var t=t.children[0],i=t.nextNode;if(t instanceof Z&&0===t.fieldType&&i instanceof X&&0===i.text.trim().toLowerCase().indexOf("toc"))return t}e=e.previousRenderedWidget}},a.prototype.getNextParagraph=function(e){if(e.nextRenderedWidget instanceof z)return e=e.nextRenderedWidget.childWidgets[0],this.documentHelper.getFirstParagraphBlock(e)},a.prototype.getPreviousParagraph=function(e){if(e.previousRenderedWidget instanceof z)return e=(e=e.previousRenderedWidget).childWidgets[e.childWidgets.length-1],this.documentHelper.getLastParagraphBlock(e)},a.prototype.getNextStartInline=function(e,t){var e=e.getInline(t,0),t=e.element,e=e.index;return t=(!_.isNullOrUndefined(t)&&e===t.length&&t.nextNode instanceof Z||t instanceof uc)&&(e=this.getNextValidElement(t.nextNode))instanceof Z&&0===e.fieldType?e:t},a.prototype.getPreviousTextInline=function(e){return e.previousNode instanceof X?e.previousNode:e.previousNode instanceof Z&&j.isLinkedFieldCharacter(e.previousNode)?0===e.previousNode.fieldType||1===e.previousNode.fieldType?e.previousNode:e.previousNode.fieldBegin:_.isNullOrUndefined(e.previousNode)?void 0:this.getPreviousTextInline(e.previousNode)},a.prototype.getNextTextInline=function(e){return e.nextNode instanceof X?e.nextNode:e.nextNode instanceof Z&&j.isLinkedFieldCharacter(e.nextNode)?1===e.nextNode.fieldType||0===e.nextNode.fieldType?e.nextNode:e.nextNode.fieldEnd:_.isNullOrUndefined(e.nextNode)?void 0:this.getNextTextInline(e.nextNode)},a.prototype.getContainerTable=function(e){if((e=e.isInsideTable?e.associatedCell.ownerTable.isInsideTable?this.getContainerTable(e.associatedCell.ownerTable):e.associatedCell.ownerTable:e)instanceof K)return e},a.prototype.isElementInSelection=function(e,t){var t=e.line.getOffset(e,t?0:1),i=new y(this.owner),e=(i.setPositionParagraph(e.line,t),this.start),t=this.end;return this.isForward||(e=this.end,t=this.start),(i.isExistAfter(e)||i.isAtSamePosition(e))&&(i.isExistBefore(t)||i.isAtSamePosition(t))},a.prototype.isSelectionInsideElement=function(e){var t,i,n;return!!this.isEmpty&&(i=e.line.getOffset(e,0),(t=new y(this.owner)).setPositionParagraph(e.line,i),i=e.line.getOffset(e,e.length),(n=new y(this.owner)).setPositionParagraph(e.line,i),this.start.isExistAfter(t)||this.start.isAtSamePosition(t))&&(this.start.isExistBefore(n)||this.start.isAtSamePosition(n))},a.prototype.isExistBefore=function(e,t){var i,n,r,o;return e.isInsideTable?(r=e.associatedCell,t.isInsideTable?r===(i=t.associatedCell)?r.childWidgets.indexOf(e)<r.childWidgets.indexOf(t):r.ownerRow===i.ownerRow?r.cellIndex<i.cellIndex:r.ownerTable===i.ownerTable?r.ownerRow.rowIndex<i.ownerRow.rowIndex:(o=this.getContainerCellOf(r,i)).ownerTable.contains(i)?(r=this.getSelectedCell(r,o),i=this.getSelectedCell(i,o),r===o?this.isExistBefore(e,i.ownerTable):i===o?this.isExistBefore(r.ownerTable,t):o.ownerRow===i.ownerRow?o.cellIndex<i.cellIndex:o.ownerTable===i.ownerTable?o.ownerRow.rowIndex<i.ownerRow.rowIndex:this.isExistBefore(r.ownerTable,i.ownerTable)):this.isExistBefore(o.ownerTable,this.getContainerTable(i.ownerTable)):(n=this.getContainerTable(e),this.isExistBefore(n,t))):t.isInsideTable?(n=this.getContainerTable(t),this.isExistBefore(e,n)):e.containerWidget===t.containerWidget?e.index<t.index:e.containerWidget instanceof z&&t.containerWidget instanceof z&&((r=this.documentHelper.pages.indexOf(e.containerWidget.page))===(o=this.documentHelper.pages.indexOf(t.containerWidget.page))?e.containerWidget.indexInOwner<t.containerWidget.indexInOwner:r===o&&e.containerWidget.containerWidget instanceof q&&t.containerWidget.containerWidget instanceof q?this.documentHelper.pages[r].footnoteWidget.bodyWidgets.indexOf(e.containerWidget)<this.documentHelper.pages[o].footnoteWidget.bodyWidgets.indexOf(t.containerWidget):r===o&&e.containerWidget.index!==t.containerWidget.index?this.documentHelper.pages[r].bodyWidgets.indexOf(e.containerWidget)<this.documentHelper.pages[o].bodyWidgets.indexOf(t.containerWidget):r<o)},a.prototype.isExistAfter=function(e,t){var i,n,r,o;return e.isInsideTable?(o=e.associatedCell,t.isInsideTable?o===(i=t.associatedCell)?o.childWidgets.indexOf(e)>o.childWidgets.indexOf(t):o.ownerRow===i.ownerRow?o.cellIndex>i.cellIndex:o.ownerTable===i.ownerTable?o.ownerRow.rowIndex>i.ownerRow.rowIndex:(n=this.getContainerCellOf(o,i)).ownerTable.contains(i)?(o=this.getSelectedCell(o,n),i=this.getSelectedCell(i,n),o===n?this.isExistAfter(e,i.ownerTable):i===n?this.isExistAfter(o.ownerTable,t):n.ownerRow===i.ownerRow?n.cellIndex>i.cellIndex:n.ownerTable===i.ownerTable?n.ownerRow.rowIndex>i.ownerRow.rowIndex:this.isExistAfter(o.ownerTable,i.ownerTable)):this.isExistAfter(n.ownerTable,this.getContainerTable(i.ownerTable)):(r=this.getContainerTable(e),this.isExistAfter(r,t))):t.isInsideTable?(r=this.getContainerTable(t),this.isExistAfter(e,r)):e.containerWidget===t.containerWidget?e.index>t.index:(e.containerWidget instanceof z&&t.containerWidget instanceof z||e.containerWidget instanceof q&&t.containerWidget instanceof q)&&(o=this.documentHelper.pages.indexOf(e.containerWidget.page),this.documentHelper.pages.indexOf(t.containerWidget.page)<o)},a.prototype.isExistBeforeInline=function(e,t){if(e.line===t.line)return e.line.children.indexOf(e)<=t.line.children.indexOf(t);if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)<t.line.paragraph.childWidgets.indexOf(t.line);e=e.line.paragraph,t=t.line.paragraph;if(e.containerWidget===t.containerWidget){if(e.isInsideTable)return e.associatedCell.childWidgets.indexOf(e)<t.associatedCell.childWidgets.indexOf(t);if(!(e.containerWidget instanceof Xd))return e.containerWidget.childWidgets.indexOf(e)<t.containerWidget.childWidgets.indexOf(t)}return this.isExistBefore(e,t)},a.prototype.isExistAfterInline=function(e,t,i){if(e.line===t.line)return n=this.documentHelper.selection,i?e.line.children.indexOf(e)>=t.line.children.indexOf(t):e===t&&n.start.offset!==n.end.offset?e.line.children.indexOf(e)===t.line.children.indexOf(t):e.line.children.indexOf(e)>t.line.children.indexOf(t);if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)>t.line.paragraph.childWidgets.indexOf(t.line);var i=e.line.paragraph,n=t.line.paragraph;if(i.containerWidget===n.containerWidget){if(i.isInsideTable)return i.associatedCell.childWidgets.indexOf(i)>n.associatedCell.childWidgets.indexOf(n);if(!(i.containerWidget instanceof Xd))return i.containerWidget.childWidgets.indexOf(i)>n.containerWidget.childWidgets.indexOf(n)}return this.isExistAfter(i,n)},a.prototype.getNextRenderedBlock=function(e){return _.isNullOrUndefined(e.nextWidget)?e.nextRenderedWidget:e.nextWidget},a.prototype.getPreviousRenderedBlock=function(e){return _.isNullOrUndefined(e.previousWidget)?e.previousRenderedWidget:e.previousWidget},a.prototype.getNextParagraphBlock=function(e){return e.nextRenderedWidget instanceof G?e.nextRenderedWidget:e.nextRenderedWidget instanceof K?this.documentHelper.getFirstParagraphInFirstCell(e.nextRenderedWidget):e.containerWidget instanceof N?this.getNextParagraphCell(e.containerWidget):e.containerWidget instanceof z?(e.containerWidget,this.getNextParagraph(e.containerWidget)):e.containerWidget instanceof Xd&&this.isMoveDownOrMoveUp?this.getFirstBlockInNextHeaderFooter(e):void 0},a.prototype.getFirstBlockInNextHeaderFooter=function(e){var t,e=e.containerWidget;if(-1!==e.headerFooterType.indexOf("Header"))t=e.page.footerWidget.firstChild;else{if(!e.page.nextPage)return;var e=e.page.nextPage,i=e.headerWidget;(i.page=e).footerWidget&&(e.footerWidget.page=e),t=i.firstChild}return t instanceof G?t:this.getFirstBlockInFirstCell(t)},a.prototype.getLastBlockInPreviousHeaderFooter=function(e){var t,e=e.containerWidget;if(-1!==e.headerFooterType.indexOf("Footer"))t=e.page.headerWidget.lastChild;else{if(!e.page.previousPage)return;var e=e.page.previousPage,i=e.footerWidget;(i.page=e).headerWidget&&(e.headerWidget.page=e),t=i.lastChild}return t instanceof G?t:this.getFirstBlockInFirstCell(t)},a.prototype.getPreviousParagraphBlock=function(e,t){return e.previousRenderedWidget instanceof G?e.previousRenderedWidget:e.previousRenderedWidget instanceof K?this.documentHelper.getLastParagraphInLastCell(e.previousRenderedWidget):e.containerWidget instanceof N?this.getPreviousParagraphCell(e.containerWidget):e.containerWidget instanceof z?this.getPreviousParagraph(e.containerWidget):e.containerWidget instanceof Xd&&this.isMoveDownOrMoveUp&&!t?this.getLastBlockInPreviousHeaderFooter(e):void 0},a.prototype.hasValidInline=function(e,t,i){for(var n=e.childWidgets.indexOf(t.line);n<e.childWidgets.length;n++)for(var r=0;r<e.childWidgets[n].children.length;r++){var o=e.childWidgets[n].children[r];if(0!==o.length){if(o===i)return!1;if(o instanceof X||o instanceof Ic||o instanceof Z&&j.isLinkedFieldCharacter(o))return!0}}return!1},a.prototype.getParagraphLength=function(e,t,i,n){var r=0;if(!_.isNullOrUndefined(e))for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];if(t instanceof uh&&t===s){i&&(r+=this.getLineLength(s,i,n));break}r+=this.getLineLength(s,void 0,n)}return r},a.prototype.getLineLength=function(e,t,i){for(var n=0,r=e.paragraph.bidi,o=r?e.children.length-1:0;r?-1<o:o<e.children.length;r?o--:o++){var s=e.children[o];if(!(s instanceof Y)){if(i)if(s instanceof uc)for(var a=0;a<s.textFrame.childWidgets.length;a++){var l=s.textFrame.childWidgets[a];n+=this.getParagraphLength(l)+1}else if(s instanceof Bh)for(a=0;a<s.bodyWidget.childWidgets.length;a++){l=s.bodyWidget.childWidgets[a];n+=this.getParagraphLength(l)+1}if(t&&t.element instanceof mh&&t.element===s){n+=t.index;break}n+=s.length}}return n},a.prototype.getLineInfo=function(e,t){for(var i,n=void 0,r=e.childWidgets.length,o=0;o<r&&(n=e.childWidgets[o],!(t<=(i=this.getLineLength(n))||o===r-1));o++)t-=i;return{line:n,offset:t}},a.prototype.getElementInfo=function(e,t){for(var i=void 0,n=0;n<e.children.length;n++)if(!((i=e.children[n])instanceof Y)){if(!(t>i.length)||t===i.length+1&&_.isNullOrUndefined(i.nextNode))break;t-=i.length}return{element:i,index:t}},a.prototype.getStartOffset=function(e){return 0<e.childWidgets.length?(e=e.childWidgets[0],this.getStartLineOffset(e)):0},a.prototype.getStartLineOffset=function(e){for(var t=0,i=0;i<e.children.length;i++){var n=e.children[i];if(0!==n.length){if(n instanceof X||n instanceof Ic||n instanceof J||n instanceof uc||n instanceof Wc||n instanceof Sc||n instanceof up||n instanceof Z&&j.isLinkedFieldCharacter(n)||n instanceof E)return t;n instanceof Y||(t+=n.length)}}return t},a.prototype.getPreviousSelectionCell=function(e){var t;return _.isNullOrUndefined(e.previousRenderedWidget)?this.getPreviousSelectionRow(e.ownerRow):this.isForward?(t=(t=e.previousRenderedWidget.childWidgets)[t.length-1])instanceof G?t:this.getPreviousParagraphSelection(t.childWidgets[t.childWidgets.length-1]):(t=e.previousRenderedWidget.childWidgets[0])instanceof G?t:this.documentHelper.getFirstParagraphInLastRow(t)},a.prototype.getPreviousSelectionRow=function(e){return _.isNullOrUndefined(e.previousRenderedWidget)?this.getPreviousSelectionBlock(e.ownerTable):this.isForward?this.getPreviousParagraphSelection(e.previousRenderedWidget):(e=e.previousRenderedWidget.childWidgets[0].childWidgets[0],this.documentHelper.getFirstParagraphBlock(e))},a.prototype.getNextSelectionBlock=function(e){return e.nextRenderedWidget instanceof G?e.nextRenderedWidget:e.nextRenderedWidget instanceof K?this.isEmpty||this.isForward?this.documentHelper.getLastParagraphInFirstRow(e.nextRenderedWidget):this.getNextParagraphSelection(e.nextRenderedWidget.childWidgets[0]):e.containerWidget instanceof N?this.getNextSelectionCell(e.containerWidget):e.containerWidget instanceof z?this.getNextSelection(e.containerWidget):void 0},a.prototype.getNextSelectionCell=function(e){var t;return _.isNullOrUndefined(e.nextRenderedWidget)?this.getNextSelectionRow(e.ownerRow):this.isEmpty||this.isForward?(t=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1],this.documentHelper.getLastParagraphBlock(t)):(t=e.nextRenderedWidget.childWidgets[0])instanceof G?t:this.getNextParagraphSelection(t.childWidgets[0])},a.prototype.getNextSelectionRow=function(e){var t;return _.isNullOrUndefined(e.nextRenderedWidget)?this.getNextSelectionBlock(e.ownerTable):this.isEmpty||this.isForward?(t=(t=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1]).childWidgets[t.childWidgets.length-1],this.documentHelper.getLastParagraphBlock(t)):this.getNextParagraphSelection(e.nextRenderedWidget)},a.prototype.getNextSelection=function(e){if(e.nextRenderedWidget instanceof z)return(e=e.nextRenderedWidget.childWidgets[0])instanceof G?e:this.isEmpty||this.isForward?this.documentHelper.getLastParagraphInFirstRow(e):this.getNextParagraphSelection(e.childWidgets[0])},a.prototype.getNextParagraphSelection=function(e){var t,i=e.childWidgets[0],e=(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)&&(t=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell),i=this.getFirstCellInRegion(e,t,this.upDownSelectionLength,!1)),i.childWidgets[0]);return this.documentHelper.getFirstParagraphBlock(e)},a.prototype.getPreviousSelectionBlock=function(e){return e.previousRenderedWidget instanceof G?e.previousRenderedWidget:e.previousRenderedWidget instanceof K?this.isForward?this.getPreviousParagraphSelection(e.previousRenderedWidget.childWidgets[e.previousRenderedWidget.childWidgets.length-1]):this.documentHelper.getFirstParagraphInLastRow(e.previousRenderedWidget):e.containerWidget instanceof N?this.getPreviousSelectionCell(e.containerWidget):e.containerWidget instanceof z?this.getPreviousSelection(e.containerWidget):void 0},a.prototype.getPreviousSelection=function(e){if(e.previousRenderedWidget instanceof z)return(e=(e=e.previousRenderedWidget).childWidgets[e.childWidgets.length-1])instanceof G?e:this.isForward?this.getPreviousParagraphSelection(e.childWidgets[e.childWidgets.length-1]):this.documentHelper.getFirstParagraphInLastRow(e)},a.prototype.getPreviousParagraphSelection=function(e){var t,i=e.childWidgets[e.childWidgets.length-1],e=(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)&&(t=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell),i=this.getLastCellInRegion(e,t,this.upDownSelectionLength,!0)),i.childWidgets[i.childWidgets.length-1]);return this.documentHelper.getLastParagraphBlock(e)},a.prototype.getLastCellInRegion=function(e,t,i,n){var r=this.getCellLeft(e,t),o=r+t.cellFormat.cellWidth,s=!0;if(r<=i&&i<o)for(var a=e.childWidgets.length-1;0<=a;a--){var l=this.getCellLeft(e,e.childWidgets[a]);if(j.round(r,2)<=j.round(l,2)&&j.round(l,2)<j.round(o,2))return s=!1,e.childWidgets[a]}else for(a=e.childWidgets.length-1;0<=a;a--)if((l=this.getCellLeft(e,e.childWidgets[a]))<=i&&l+e.childWidgets[a].cellFormat.cellWidth>i)return s=!1,e.childWidgets[a];if(s){if(!_.isNullOrUndefined(e.previousRenderedWidget)&&n)return this.getLastCellInRegion(e.previousRenderedWidget,t,i,n);if(!_.isNullOrUndefined(e.nextRenderedWidget)&&!n)return this.getLastCellInRegion(e.nextRenderedWidget,t,i,n)}return e.childWidgets[e.childWidgets.length-1]},a.prototype.getCellInTable=function(e,t){for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable))return t;t=t.ownerTable.associatedCell}return t},a.prototype.getPreviousValidOffset=function(e,t){if(0===t)return 0;for(var i=0,n=0,r=(e.paragraphFormat.bidi,0);r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.children.length;s++){var a=o.children[s];if(!(0===a.length||a instanceof Y)){if(t<=n+a.length)return t-1===n?i:t-1;(a instanceof X||a instanceof Ic||a instanceof up||a instanceof J||a instanceof Z&&j.isLinkedFieldCharacter(a))&&(i=n+a.length),n+=a.length}}return t-1===n?i:t-1},a.prototype.getNextValidOffset=function(e,t){for(var i=0,n=0;n<e.children.length;n++){var r=e.children[n];if(!(0===r.length||r instanceof Y)){if(t<i+r.length&&(r instanceof X||r instanceof Ic||r instanceof Z&&j.isLinkedFieldCharacter(r)))return(i<t?t:i)+1;if(t===i+r.length&&r instanceof Z&&1===r.fieldType&&r.previousNode instanceof Ic)return t;i+=r.length}}return t},a.prototype.getParagraphMarkSize=function(e,t,i){var n,r,o=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat),s=o.BaselineOffset,a=o.Height,l=s;return e instanceof G&&(0<e.childWidgets.length&&e.childWidgets[0],n=this.documentHelper.layout.getLineSpacing(e,a),r=this.documentHelper.layout.getBeforeSpacing(e),t=l-s,i=a-l-(o.Height-s),"Multiple"===(l=e.paragraphFormat.lineSpacingType)?a<n?i+=n-a:t+=n-a:("Exactly"===l||n>t+o.Height+i)&&(t+=n-(t+o.Height+i)),t+=r,i+=this.documentHelper.layout.getAfterSpacing(e)),{width:o.Width,height:o.Height,topMargin:t,bottomMargin:i}},a.prototype.getPhysicalPositionInternal=function(e,t,i){var n,r,o;return e.paragraph.isEmpty()?(o=(n=e.paragraph).x,0<n.childWidgets.length&&(r=n.childWidgets[0],o=this.getLeft(r)),r=this.getParagraphMarkSize(e.paragraph,0,0),(0<t||0===t&&n.isEmpty()&&n.bidi)&&(o+=r.width),new nl(o,n.y+r.topMargin)):(r=(n=e.getInline(t,o=0,e.paragraph.bidi)).element,o=n.index,this.getPhysicalPositionInline(r,o,i))},a.prototype.highlightSelectedContent=function(e,t){var i,n,r,o,s,a;e.paragraph.isInsideTable&&(!t.paragraph.isInsideTable||!e.paragraph.associatedCell.equals(t.paragraph.associatedCell)||!this.documentHelper.isSelectionChangedOnMouseMoved&&this.isCellSelected(e.paragraph.associatedCell,e,t)||this.isCellPrevSelected)?(this.highlightCell(e.paragraph.associatedCell,this,e,t),this.isCellPrevSelected=!0):(i=void 0,n=0,this.owner.isReadOnlyMode||e.paragraph!==t.paragraph||(e.offset+1===t.offset?(i=(s=t.currentWidget.getInline(t.offset,n)).element,n=s.index,(i instanceof Ic||i instanceof uc)&&e.currentWidget.getOffset(i,0)!==e.offset&&(i=void 0)):(a=(o=e.currentWidget.getInline(e.offset,s=0)).element,(s=o.index)===a.length&&(a=this.getNextRenderedElementBox(a,s)),r=(o=t.currentWidget.getInline(t.offset,s)).element,s=o.index,a instanceof Z&&r instanceof Z&&!_.isNullOrUndefined(a.fieldSeparator)&&(o=a.fieldSeparator.nextNode)instanceof Ic&&o.nextNode===r&&(i=o))),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&(i instanceof Ic||i instanceof uc)?(a=(s=this.getElementBoxInternal(i,n)).element,n=s.index,this.owner.enableImageResizerMode&&!this.owner.editorModule.isRemoteAction&&(this.owner.imageResizerModule.positionImageResizer(a),this.owner.imageResizerModule.showImageResizer()),this.documentHelper.isTouchInput&&(this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none")):(e.paragraph.isInsideTable&&e.paragraph.associatedCell.equals(t.paragraph.associatedCell)&&t.paragraph.equals(this.getLastParagraph(t.paragraph.associatedCell))&&this.getParagraphLength(t.paragraph)+1==t.offset&&t.offset--,this.highlight(e.paragraph,e,t),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,e,t),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)),this.isInShape&&this.showResizerForShape())},a.prototype.showResizerForShape=function(){var e=this.getCurrentTextFrame().containerShape;this.owner.imageResizerModule.positionImageResizer(e),this.owner.imageResizerModule.showImageResizer()},a.prototype.highlight=function(e,t,i,n){var r,o=void 0,s=void 0,t=this.getStartLineWidget(e,t,void 0,0),a=t.element,o=_.isNullOrUndefined(a)?e.childWidgets[0]:a.line,l=t.index,t=this.getEndLineWidget(i,void 0,0),s=(r=t.element)?r.line:i.paragraph.childWidgets[i.paragraph.childWidgets.length-1],d=t.index,h=0,c=0;if(_.isNullOrUndefined(o)||(h=this.getTop(o),c=this.getLeftInternal(o,a,l)),_.isNullOrUndefined(o)||o!==s){if(!_.isNullOrUndefined(o)){o.paragraph.x;g=(e!==o.paragraph&&(e=o.paragraph),this.getWidth(o,!0)-(c-o.paragraph.x));if(e.bidi||a instanceof X&&a.isRightToLeft){var p=0,u=this.getElementsForward(o,a,r,e.bidi);if(u){for(v=!1,f=0;f<u.length;f++){w=(v=!1,c=(y=u[f])===a?this.getLeftInternal(o,y,l):this.getLeftInternal(o,y,0),y instanceof X?y.length:1);p=this.getLeftInternal(o,y,w),y instanceof X&&(v=y.isRightToLeft),g=Math.abs(p-c),this.createHighlightBorder(o,g,v?p:c,h,!0,n)}o.isLastLine()&&(b=u[u.length-1].line.paragraph.characterFormat,x=this.documentHelper.textHelper.getParagraphMarkSize(b).Width,c=e.bidi?this.getLineStartLeft(o)-x:v?o.paragraph.x+this.getWidth(o,!1):p,this.createHighlightBorder(o,x,c,h,!0,n))}else this.createHighlightBorder(o,g,c,h,!1,n)}else this.createHighlightBorder(o,g,c,h,!1,n);t=o.paragraph.childWidgets.indexOf(o);if(this.highlightParagraph(e,t+1,s,r,d,n),-1!==e.childWidgets.indexOf(i.currentWidget))return}this.isHideSelection(e)?this.isHighlightNext=!1:(this.isHighlightNext=!0,this.hightLightNextParagraph=e)}else{var p=this.getLeftInternal(s,r,d),g=0,t=!1;if(!(t=r instanceof X?r.isRightToLeft:t)&&a instanceof X&&(t=a.isRightToLeft),g=Math.abs(p-c),t||e.bidi){var m=this.getElementsForward(o,a,r,e.bidi);if(m&&1<m.length)for(var f=0;f<m.length;f++){var y,v=!1,w=(y=m[f])instanceof X?y.length:1;if(p=y===a?(c=this.getLeftInternal(o,y,l),this.getLeftInternal(o,y,w)):y===r?(c=this.getLeftInternal(o,y,0),this.getLeftInternal(o,y,d)):(c=this.getLeftInternal(o,y,0),this.getLeftInternal(o,y,w)),y instanceof X&&(v=y.isRightToLeft),g=Math.abs(p-c),y===r&&y instanceof X&&d>y.length){var b=y.line.paragraph.characterFormat,x=this.documentHelper.textHelper.getParagraphMarkSize(b).Width;if(e.bidi&&!v){g-=x,this.createHighlightBorder(o,g,c,h,!0,n),c=this.getLineStartLeft(o)-x,this.createHighlightBorder(o,x,c,h,!0,n);continue}}this.createHighlightBorder(o,g,v?p:c,h,!0,n)}else r instanceof X&&d>r.length?(b=r.line.paragraph.characterFormat,x=this.documentHelper.textHelper.getParagraphMarkSize(b).Width,!e.bidi&&t?(this.createHighlightBorder(o,g-=x,p+=x,h,!0,n),p+=r.width,this.createHighlightBorder(o,x,p,h,!0,n)):e.bidi&&!t?(this.createHighlightBorder(o,g-=x,c,h,!0,n),c=this.getLineStartLeft(o)-x,this.createHighlightBorder(o,x,c,h,!0,n)):this.createHighlightBorder(o,g,t?p:c,h,!1,n)):this.createHighlightBorder(o,g,t?p:c,h,!1,n)}else this.createHighlightBorder(o,g,e.bidi?p:c,h,!1,n)}},a.prototype.highlightNextBlock=function(e,t,i){e=e.nextRenderedWidget;_.isNullOrUndefined(e)||(e instanceof G?(this.isHighlightNext=!1,this.highlight(e,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightTable(e,t,i))},a.prototype.getStartLineWidget=function(e,t,i,n){var r=e===t.paragraph?t.offset:this.getStartOffset(e),o=void 0;return i=(o=(e===t.paragraph?t.currentWidget:e.firstChild).getInline(r,n)).element,n=o.index,i instanceof Z&&(i=(e=this.getRenderedInline(i,n)).element,n=e.index),r===this.getParagraphLength(t.paragraph)+1&&n++,{index:n,element:i}},a.prototype.getEndLineWidget=function(e,t,i){var n=e.currentWidget.getInline(e.offset,i);return t=n.element,i=n.index,t instanceof Z&&(t=(n=this.getRenderedInline(t,i)).element,i=n.index),{index:i=e.paragraph.childWidgets.indexOf(e.currentWidget)===e.paragraph.childWidgets.length-1&&e.offset===this.getLineLength(e.currentWidget)+1?t?t.length+1:1:i,element:t}},a.prototype.getLineWidgetInternal=function(e,t,i){var n;return 0===e.children.length&&e instanceof uh?e:(n=(t=e.getInline(t,e=0)).element,e=t.index,n instanceof mh?n.line:this.getLineWidgetInternalInline(n,e,i))},a.prototype.getLineWidgetParagraph=function(e,t){var i;return 0===t.children.length?t:(i=(e=t.getInline(e,t=0)).element,t=e.index,this.getLineWidget(i,t))},a.prototype.highlightCells=function(e,t,i){var n=this.getCellLeft(t.ownerRow,t),r=n+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth,a=((n=o<n?o:n)>this.upDownSelectionLength&&(n=this.upDownSelectionLength),(r=r<s?s:r)<this.upDownSelectionLength&&(r=this.upDownSelectionLength),e.getSplitWidgets()),l=a.indexOf(t.ownerRow.ownerTable),d=a.indexOf(i.ownerRow.ownerTable);if(l===d)for(var h=e.childWidgets.indexOf(i.ownerRow),c=e.childWidgets.indexOf(t.ownerRow);c<=h;c++)this.highlightRow(e.childWidgets[c],n,r);else for(var p=0,u=0,c=l;c<=d;c++){e=a[c];for(var p=c===l?e.childWidgets.indexOf(t.ownerRow):0,u=c===d?e.childWidgets.indexOf(i.ownerRow):e.childWidgets.length-1,g=p;g<=u;g++)this.highlightRow(e.childWidgets[g],n,r)}},a.prototype.highlightTable=function(e,t,i){this.highlightInternal(e.childWidgets[0],t,i),i.paragraph.isInsideTable&&e.contains(i.paragraph.associatedCell)||this.highlightNextBlock(e,t,i)},a.prototype.getCellLeft=function(e,t){var i=0;return i+=t.x-t.margin.left},a.prototype.getNextParagraphRow=function(e){var t;return _.isNullOrUndefined(e.nextRenderedWidget)?this.getNextParagraphBlock(e.ownerTable):(t=(e=e.nextRenderedWidget.childWidgets[0]).childWidgets[0],_.isNullOrUndefined(t)?this.getNextParagraphCell(e):this.documentHelper.getFirstParagraphBlock(t))},a.prototype.getPreviousParagraphRow=function(e){return _.isNullOrUndefined(e.previousRenderedWidget)?this.getPreviousParagraphBlock(e.ownerTable):(e=(e=e.previousRenderedWidget.lastChild).lastChild||e.previousSplitWidget.lastChild,this.documentHelper.getLastParagraphBlock(e))},a.prototype.containsRow=function(e,t){if(-1!==e.childWidgets.indexOf(t))return!0;for(;t.ownerTable.isInsideTable;){if(-1!==e.childWidgets.indexOf(t))return!0;t=t.ownerTable.associatedCell}return-1!==e.childWidgets.indexOf(t)},a.prototype.highlightRow=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){var r=this.getCellLeft(e,e.childWidgets[n]);j.round(t,2)<=j.round(r,2)&&j.round(r,2)<j.round(i,2)&&this.highlightCellWidget(e.childWidgets[n])}},a.prototype.highlightInternal=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)this.highlightCellWidget(e.childWidgets[n]);i.paragraph.isInsideTable&&this.containsRow(e,i.paragraph.associatedCell)||e.nextRenderedWidget instanceof dh&&this.highlightInternal(e.nextRenderedWidget,t,i)},a.prototype.getLastParagraph=function(e){for(;e.nextSplitWidget&&0<e.nextSplitWidget.childWidgets.length;)e=e.nextSplitWidget;var t=(0<e.childWidgets.length?e:e.previousSplitWidget).lastChild;return this.documentHelper.getLastParagraphBlock(t)},a.prototype.containsCell=function(e,t){if(e.equals(t))return!0;for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable.associatedCell))return!0;t=t.ownerTable.associatedCell}return!1},a.prototype.isCellSelected=function(e,t,i){var n=this.getLastParagraph(e);return n===i.paragraph&&i.offset===this.getParagraphLength(n)+1||!this.containsCell(e,t.paragraph.associatedCell)||!this.containsCell(e,i.paragraph.associatedCell)},a.prototype.getContainerCellOf=function(e,t){for(;e.ownerTable.isInsideTable;){if(e.ownerTable.contains(t))return e;e=e.ownerTable.associatedCell}return e},a.prototype.getSelectedCell=function(e,t){if(!e.ownerTable.equals(t.ownerTable))for(;e.ownerTable.isInsideTable;){if(e.ownerTable.associatedCell.equals(t))return e;e=e.ownerTable.associatedCell}return e},a.prototype.getSelectedCells=function(){for(var e=[],t=0;t<this.selectedWidgets.keys.length;t++){var i=this.selectedWidgets.keys[t];i instanceof N&&e.push(i)}return e},a.prototype.getLevelFormatNumber=function(){return"%"+((this.paragraphFormat.listLevelNumber<=0?0:this.paragraphFormat.listLevelNumber)+1)+"."},a.prototype.getNextParagraphCell=function(e){var t;return e.nextRenderedWidget&&e.nextRenderedWidget instanceof N?(t=(e=(e=e.nextRenderedWidget).getSplitWidgets()[0]instanceof N?e.getSplitWidgets()[0]:e).firstChild)?this.documentHelper.getFirstParagraphBlock(t):this.getNextParagraphCell(e):(e.nextSplitWidget&&0===e.nextSplitWidget.childWidgets.length&&(e=e.getSplitWidgets().pop()),this.getNextParagraphRow(e.containerWidget))},a.prototype.getPreviousParagraphCell=function(e){var t;return!_.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof N?(t=(e=e.previousRenderedWidget).lastChild,this.documentHelper.getLastParagraphBlock(t)):this.getPreviousParagraphRow(e.ownerRow)},a.prototype.getContainerCell=function(e){for(;!_.isNullOrUndefined(e.ownerTable)&&e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},a.prototype.highlightCell=function(e,t,i,n){if(n.paragraph.isInsideTable){var r=this.getContainerCellOf(e,n.paragraph.associatedCell);if(r.ownerTable.contains(n.paragraph.associatedCell)){var o=this.getSelectedCell(e,r),s=this.getSelectedCell(n.paragraph.associatedCell,r);if(this.containsCell(r,n.paragraph.associatedCell))this.isCellSelected(r,i,n)?this.highlightCellWidget(r):o===r?(this.highlight(i.paragraph,i,n),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,i,n),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightContainer(o,i,n);else if(this.highlightCellWidget(r),r.ownerRow.equals(s.ownerRow))for(o=r;!_.isNullOrUndefined(o.nextRenderedWidget)&&(o=o.nextRenderedWidget,this.highlightCellWidget(o),o!==s););else this.highlightCells(r.ownerTable,r,s)}else this.highlightContainer(r,i,n)}else{r=this.getContainerCell(e);this.highlightContainer(r,i,n)}},a.prototype.highlightContainer=function(e,t,i){this.highlightInternal(e.containerWidget,t,i),this.highlightNextBlock(e.ownerTable.getSplitWidgets().pop(),t,i)},a.prototype.getPreviousValidElement=function(e){var t=void 0;if(this.documentHelper.isFormFillProtectedMode&&2===e.fieldType)return e;for(;e instanceof Z;)j.isLinkedFieldCharacter(e)&&(e instanceof Z&&0===e.fieldType?t=e:e instanceof Z&&1===e.fieldType&&(t=e,!_.isNullOrUndefined(e.fieldSeparator))||(t=e=e.fieldBegin)),e=e.previousNode;return _.isNullOrUndefined(t)?e:t},a.prototype.getNextValidElement=function(e){var t=void 0;if(e instanceof J&&1===e.bookmarkType)return e;for(;e instanceof Z;){if(0===e.fieldType&&!_.isNullOrUndefined(e.fieldEnd))return _.isNullOrUndefined(t)?e:t;1!==e.fieldType||_.isNullOrUndefined(e.fieldBegin)||(t=e),e=e.nextNode}return _.isNullOrUndefined(t)?e:t},a.prototype.validateTextPosition=function(e,t){var i=e.nextNode;return e.length===t&&(i instanceof Z||!(e instanceof Ic)&&(i instanceof J||i instanceof up))?((i=this.getNextValidElement(e.nextNode))instanceof Z&&1===i.fieldType||i instanceof J&&1===i.bookmarkType||i instanceof up&&1===i.commentType)&&(e=i,t=this.documentHelper.isFormFillProtectedMode?0:1):0===t&&e.previousNode instanceof Z&&(t=(e=this.getPreviousValidElement(e.previousNode))instanceof Z?0:e.length,e instanceof Z)&&1===e.fieldType&&t++,{element:e,index:t}},a.prototype.getPhysicalPositionInline=function(e,t,i){var n=void 0,n=this.getElementBox(e,t,i).element,i=void 0;if(_.isNullOrUndefined(n)||_.isNullOrUndefined(n.line)){if(!(e instanceof Z&&1===e.fieldType))return e instanceof Z||e instanceof J||e instanceof up?this.getFieldCharacterPosition(e):new nl(0,0);n=e}var r,o,s=n.margin,a=0;return n instanceof X&&"\v"===n.text&&_.isNullOrUndefined(e.nextNode)&&!this.owner.editorModule.handledEnter?(i=this.getNextLineWidget(n.line.paragraph,n),t=0):i=n.line,a=this.getTop(i),n instanceof Ic&&"Inline"===n.textWrappingStyle?(r=n.line.paragraph.characterFormat,o=this.getPreviousTextElement(e),_.isNullOrUndefined(o)?(e=this.getNextTextElement(e),_.isNullOrUndefined(e)||(r=e.characterFormat)):r=o.characterFormat,e=this.documentHelper.textHelper.getHeight(r),0<n.margin.top+n.height-e.BaselineOffset&&(a+=n.margin.top+n.height-e.BaselineOffset)):n instanceof Z||(a+=0<s.top?s.top:0),o=_.isNullOrUndefined(n)||_.isNullOrUndefined(i)?0:this.getLeftInternal(i,n,t),new nl(o,a)},a.prototype.getFieldCharacterPosition=function(e){var t=this.getNextValidElementForField(e);return _.isNullOrUndefined(t)?(e=e.line.paragraph,this.getEndPosition(e)):this.getPhysicalPositionInline(t,0,!0)},a.prototype.isRenderBookmarkAtEnd=function(e){var t,i=1==e.bookmarkType?e.reference:e;return!(!i||!_.isNullOrUndefined(i.properties)||(t=i.reference?i.reference.paragraph.associatedCell:void 0,_.isNullOrUndefined(t))||(i=(i=i.reference?i.reference.paragraph.associatedCell.ownerRow:void 0)?i.childWidgets[i.childWidgets.length-1]:void 0,_.isNullOrUndefined(i))||(t!=i||1===e.bookmarkType&&!_.isNullOrUndefined(e.line)&&e.line.children.indexOf(e)!==e.line.children.length-1))},a.prototype.getNextValidElementForField=function(e){e instanceof Z&&0===e.fieldType&&j.isLinkedFieldCharacter(e)&&(t=e,e=_.isNullOrUndefined(t.fieldSeparator)?t.fieldEnd:t.fieldSeparator);var t=void 0;return t=_.isNullOrUndefined(e.nextNode)?t:this.getNextValidElement(e.nextNode)},a.prototype.getEndPosition=function(e){var t=e.x,i=e.y,n=void 0,n=(0<e.childWidgets.length&&(n=e.childWidgets[e.childWidgets.length-1],e.paragraphFormat.bidi?t=this.getLeft(n):t+=this.getWidth(n,!1)),_.isNullOrUndefined(n)||(i=this.getTop(n)),this.getParagraphMarkSize(e,0,0));return new nl(t,i+n.topMargin)},a.prototype.getElementBox=function(e,t,i){var n=void 0;return{element:n=e instanceof Z||e instanceof J||e instanceof up?n:e,index:t}},a.prototype.getPreviousTextElement=function(e){return e.previousNode instanceof X?e.previousNode:_.isNullOrUndefined(e.previousNode)?void 0:this.getPreviousTextElement(e.previousNode)},a.prototype.getNextTextElement=function(e){return e.nextNode instanceof X?e.nextNode:_.isNullOrUndefined(e.nextNode)?void 0:this.getNextTextElement(e.nextNode)},a.prototype.getNextRenderedElementBox=function(e,t){if(e instanceof Z){var i=e;if(0===i.fieldType&&i===(e=this.getRenderedField(i)))return i;t=1}for(;!_.isNullOrUndefined(e)&&t===e.length&&e.nextNode instanceof Z;){var n=this.getNextValidElement(e.nextNode);if(n instanceof Z&&0===n.fieldType){i=n;if(e=this.getRenderedField(i),!_.isNullOrUndefined(e)&&i===e)return i;t=1}else e=n}return e},a.prototype.getElementBoxInternal=function(e,t){return{element:e,index:t}},a.prototype.getLineWidget=function(e,t){return this.getLineWidgetInternalInline(e,t,!0)},a.prototype.getLineWidgetInternalInline=function(e,t,i){var n,r=this.getElementBox(e,t,i),o=r.element;return t=r.index,_.isNullOrUndefined(o)?(e=this.getNextValidElementForField(r=e),_.isNullOrUndefined(e)?(n=void 0,0<(r=r.line.paragraph).childWidgets.length?r.childWidgets[r.childWidgets.length-1]:n):this.getLineWidget(e,0)):i&&o instanceof X&&"\v"===o.text&&1===t?this.getNextLineWidget(o.line.paragraph,o):o.line},a.prototype.getNextLineWidget=function(e,t){var i,n=void 0,r=e;return 0<r.childWidgets.length&&((i=r.childWidgets.indexOf(t.line))===r.childWidgets.length-1?(r=e,i=-1):i>r.childWidgets.length-1?(r=this.getNextParagraphBlock(e),i=-1):i<0&&(i=(r=e).childWidgets.indexOf(t.line)),n=r.childWidgets[i+1]),n},a.prototype.getCaretHeight=function(e,t,i,n,r,o){var t=this.getElementBox(e,t,!1).element,s=e;if(_.isNullOrUndefined(t))return s instanceof Z?this.getFieldCharacterHeight(s,i,n,r,o):{height:this.documentHelper.textHelper.getHeight(i).Height,topMargin:r,isItalic:o};var s=t.margin,a=t.height,l=0;if(t instanceof Ic){var d=this.getPreviousTextElement(e),h=this.getNextTextElement(e);if(_.isNullOrUndefined(d)&&_.isNullOrUndefined(h)){var e=e.line.paragraph,c=this.getParagraphMarkSize(e,0,0),l=(c.topMargin,c.bottomMargin,c.height);o=e.characterFormat.italic,n||(l+=this.documentHelper.layout.getAfterSpacing(e))}else{if(_.isNullOrUndefined(d))return o=h.characterFormat.italic,this.getCaretHeight(h,0,h.characterFormat,n,r,o);if(_.isNullOrUndefined(h)||!(t instanceof Ic))return o=d.characterFormat.italic,this.getCaretHeight(d,d.length,d.characterFormat,n,r,o);var c=this.documentHelper.textHelper.getHeight(t.characterFormat),e=c.Height,h=c.BaselineOffset;l=t.margin.top<0&&h>t.margin.top+t.height?t.margin.top+t.height+e-h:e,n||(l+=t.margin.bottom)}}else{d=this.characterFormat.baselineAlignment,c=a;"Normal"!==d&&n&&(c/=1.5,"Subscript"===d)&&(r=a-c),l=(s.top<0?s.top:0)+c,n||(l+=s.bottom)}return n?{height:h=l<(h=this.documentHelper.textHelper.getHeight(i).Height)?l:h,topMargin:r,isItalic:o}:{height:l,topMargin:r,isItalic:o}},a.prototype.getFieldCharacterHeight=function(e,t,i,n,r){var o,s,a,l=this.getNextValidElementForField(e);return _.isNullOrUndefined(l)?(e=e.line.paragraph,o=this.documentHelper.textHelper.getParagraphMarkSize(t).Height,a=(s=this.getParagraphMarkSize(e,e=0,0)).height,s.topMargin,e=s.bottomMargin,i?{height:o=a<o?a:o,topMargin:n,isItalic:r}:{height:a+=e,topMargin:n,isItalic:r}):this.getCaretHeight(l,0,t,i,n,r)},a.prototype.getRenderedInline=function(e,t){if(this.documentHelper.isFormFillProtectedMode&&2===e.fieldType)return{element:e,index:t};for(var i=this.getPreviousValidElement(e);i instanceof Z;)(i=this.getPreviousTextElement(i))instanceof Z&&(i=i.previousNode);if(!_.isNullOrUndefined(i))return{element:i,index:t=i.length};var n=this.getNextRenderedElementBox(e,t=0);if(n instanceof Z&&0===n.fieldType)for(n=(n=n.fieldSeparator).nextNode;n instanceof Z;)n=(n=n instanceof Z&&0===n.fieldType&&j.isLinkedFieldCharacter(n)?_.isNullOrUndefined(n.fieldSeparator)?n.fieldEnd:n.fieldSeparator:n).nextNode;return{element:n,index:t}},a.prototype.getRenderedField=function(e){var t=e;if(!_.isNullOrUndefined(e.fieldSeparator)){var i=(t=e.fieldSeparator).line.paragraph;if(i!==e.fieldEnd.line.paragraph||this.hasValidInline(i,t,e.fieldEnd))return t}return t=e.fieldEnd},a.prototype.isLastRenderedInline=function(e,t){for(;t===e.length&&e.nextNode instanceof Z;){var i=this.getNextValidElement(e.nextNode);if(t=0,(e=i instanceof Z&&0===i.fieldType?i:e)instanceof Z&&0===e.fieldType&&!_.isNullOrUndefined(e.fieldEnd)){i=e;if(_.isNullOrUndefined(i.fieldSeparator))e=i.fieldEnd,t=1;else{var n=(e=i.fieldSeparator).line.paragraph;if(t=1,n!==i.fieldEnd.line.paragraph||this.hasValidInline(n,e,i.fieldEnd))break;e=i.fieldEnd}}}return t===e.length&&_.isNullOrUndefined(e.nextNode)},a.prototype.getPage=function(e){var t,i=void 0;return e.containerWidget instanceof fc?(t=e.containerWidget.containerShape).line&&(i=this.getPage(t.line.paragraph)):e.containerWidget instanceof _d?(e.containerWidget,i=e.containerWidget.page):_.isNullOrUndefined(e.containerWidget)||(i=this.getPage(e.containerWidget)),i},a.prototype.clearSelectionHighlightInSelectedWidgets=function(){var e=!1,t=this.selectedWidgets.keys;if(!this.viewer.documentHelper.isDragStarted){for(var i=0;i<t.length;i++)this.removeSelectionHighlight(t[i]),e=!0;this.selectedWidgets.clear()}return e},a.prototype.clearChildSelectionHighlight=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t]instanceof uh?this.clearSelectionHighlightLineWidget(e.childWidgets[t]):e.childWidgets[t]instanceof N?this.clearSelectionHighlight(e.childWidgets[t]):e.childWidgets[t]instanceof Vd&&this.clearChildSelectionHighlight(e.childWidgets[t])},a.prototype.getLineWidgetBodyWidget=function(e,t,i){i=!!_.isNullOrUndefined(i)||i;var n=e;if(n instanceof _d)for(var r=0;r<n.floatingElements.length;r++){var o=n.floatingElements[r];if(o instanceof K){var s=o.getTableCellWidth();if(t.x<=o.x+s&&t.x>=o.x&&t.y<=o.y+o.height&&t.y>=o.y)return this.getLineWidgetTableWidget(o,t)}else if(o instanceof hc&&"Behind"!==o.textWrappingStyle&&o.x<=t.x&&o.x+o.width>=t.x&&o.y<=t.y&&o.y+o.height>=t.y)return o.line}if(e instanceof q)for(var a=void 0,l=!1,d=0;d<e.bodyWidgets.length;d++)if(e.sectionFormat.columns.length<=1){for(var h=0;h<e.bodyWidgets[d].childWidgets.length;h++)if((p=e.bodyWidgets[d].childWidgets[h])instanceof Vd&&p.y<=t.y&&p.y+p.height>=t.y)return p instanceof G?this.getLineWidgetParaWidget(p,t):this.getLineWidgetTableWidget(p,t)}else{var c=e.bodyWidgets[d];if(c.firstChild.x+c.sectionFormat.columns[c.columnIndex].width>=t.x&&c.firstChild.x<=t.x&&c.firstChild.y<=t.y&&this.documentHelper.layout.getNextWidgetHeight(c)>=t.y||c.firstChild.x+c.sectionFormat.columns[c.columnIndex].width<t.x&&c.firstChild.y<=t.y&&this.documentHelper.layout.getNextWidgetHeight(c)>=t.y?a=c:e.x>t.x&&c.firstChild.y<=t.y&&this.documentHelper.layout.getNextWidgetHeight(c)>=t.y&&!l&&(a=c,l=!0),d===e.bodyWidgets.length-1&&!_.isNullOrUndefined(a))for(var p,h=0;h<a.childWidgets.length;h++)if((p=a.childWidgets[h])instanceof Vd&&p.y<=t.y&&p.y+p.height>=t.y)return p instanceof G?this.getLineWidgetParaWidget(p,t):this.getLineWidgetTableWidget(p,t)}for(var u=0;u<e.childWidgets.length;u++){if((f=e.childWidgets[u])instanceof q)return f[u];if(f instanceof Vd&&f.y<=t.y&&f.y+f.height>=t.y){if(f instanceof G)return this.getLineWidgetParaWidget(f,t);var g=f;if(!g.wrapTextAround)return this.getLineWidgetTableWidget(g,t)}}var m=void 0;if(i&&0<e.childWidgets.length){i=e.childWidgets[0];if(i instanceof Vd&&i.y<=t.y)if(e.childWidgets[e.childWidgets.length-1]instanceof G)for(u=0;u<e.childWidgets.length;u++)m=this.getLineWidgetParaWidget(e.childWidgets[u],t);else for(u=0;u<e.childWidgets.length;u++)m=this.getLineWidgetTableWidget(e.childWidgets[u],t);else{var f=void 0;i instanceof Vd&&(f=i),_.isNullOrUndefined(f)||(m=f instanceof G?this.getLineWidgetParaWidget(i,t):this.getLineWidgetTableWidget(i,t))}}return m},a.prototype.getLineWidgetParaWidget=function(e,t){for(var i=e.childWidgets,n=e.y,r=0;r<i.length;r++){var o=i[r],s=(n+=o.marginTop,o.height);if(o.nextLine&&0<o.nextLine.marginTop&&(s+=o.nextLine.marginTop),n<=t.y&&n+s>=t.y)return o;n+=o.height}var a=void 0;return a=0<i.length?e.y<=t.y?i[i.length-1]:i[0]:a},a.prototype.highlightParagraph=function(e,t,i,n,r,o){var s=0,a=0,l=!1,d=n;e.paragraphFormat.bidi&&0<i.children.indexOf(n)&&(d=i.children[0]);for(var h=t;h<e.childWidgets.length;h++){var c=e.childWidgets[h],p=(h===t?s=this.getTop(c):s+=c.marginTop,n instanceof X&&(l=n.isRightToLeft),this.getLeft(c));if(c===i){var u=0;if(l||e.bidi){for(var g=this.getElementsBackward(c,d,n,e.bidi),m=0;m<g.length;m++){var f=g[m],y=!1;if(u=f===n?this.getLeftInternal(c,f,f.length):(v=f instanceof X?f.length:1,this.getLeftInternal(c,f,v)),p=this.getLeftInternal(c,f,0),f instanceof X&&(y=f.isRightToLeft),a=Math.abs(u-p),f===n&&f instanceof X&&r>f.length){var v=this.documentHelper.textHelper.getParagraphMarkSize(f.line.paragraph.characterFormat).Width;if(!e.bidi&&y)u+=v;else if(e.bidi&&!y){a-=v,this.createHighlightBorder(c,a,p,s,!0,o),p=this.getLineStartLeft(c)-v,this.createHighlightBorder(c,v,p,s,!0,o);continue}}this.createHighlightBorder(c,a,y?u:p,s,!0,o)}return}return u=this.getLeftInternal(i,n,r,!0),a=Math.abs(u-p),void this.createHighlightBorder(c,a,l?u:p,s,!1,o)}a=this.getWidth(c,!0)-(p-e.x),e.bidi&&c.isLastLine()&&(p-=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat).Width),this.createHighlightBorder(c,a,p,s,!1,o),s+=c.height}},a.prototype.getLineWidgetTableWidget=function(e,t){for(var i=void 0,n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r instanceof dh&&r.y<=t.y&&!("Exactly"===r.rowFormat.heightType&&r.y+j.convertPointToPixel(r.rowFormat.height)<t.y)){var o,s,i=this.getLineWidgetRowWidget(r,t),r=void 0,a=(!_.isNullOrUndefined(i)&&i.paragraph.containerWidget instanceof N&&(r=i.paragraph.containerWidget),0),l=0,d=(_.isNullOrUndefined(r)||(s=r.ownerRow.containerWidget,a=j.convertPointToPixel(s.tableFormat.cellSpacing),l=r.cellFormat.rowSpan),0),h=0,c=0,p=0;if(0<a&&(d=0===r.cellIndex?a:a/2,h=r.cellIndex===r.ownerRow.childWidgets.length-1?a:a/2,o=void 0,s=void(r.containerWidget instanceof dh&&(o=r.containerWidget)),r.containerWidget.containerWidget instanceof K&&(s=r.containerWidget.containerWidget),_.isNullOrUndefined(o)||_.isNullOrUndefined(s)||(c=0===r.ownerRow.rowIndex?a:a/2,p=r.ownerRow.rowIndex+l===r.ownerTable.childWidgets.length?a:a/2)),!_.isNullOrUndefined(i)&&i.paragraph.x<=t.x&&i.paragraph.x+i.width>=t.x&&i.paragraph.y<=t.y&&this.getTop(i)+i.height>=t.y||!_.isNullOrUndefined(r)&&r.x-r.margin.left-d<=t.x&&r.x+r.width+r.margin.right+h>=t.x&&r.y-r.margin.top-c<=t.y&&r.y+r.height+r.margin.bottom+p>=t.y)break}}return i},a.prototype.getLineWidgetRowWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n,r=0,o=0;if(0<(n=j.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))&&(r=0===e.childWidgets[i].columnIndex?n:n/2,o=e.childWidgets[i].cellIndex===e.childWidgets[i].ownerRow.childWidgets.length-1?n:n/2),e.childWidgets[i].x-e.childWidgets[i].margin.left-r<=t.x&&e.childWidgets[i].x+e.childWidgets[i].width+e.childWidgets[i].margin.right+o>=t.x)return this.getLineWidgetCellWidget(e.childWidgets[i],t)}var s=void 0;return s=0<e.childWidgets.length?e.childWidgets[0].x<=t.x?this.getLineWidgetCellWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetCellWidget(e.childWidgets[0],t):s},a.prototype.getFirstBlock=function(e){if(0<e.childWidgets.length)return e.childWidgets[0]},a.prototype.highlightCellWidget=function(e){var t=[];e.previousSplitWidget||e.nextSplitWidget?t=e.getSplitWidgets():t.push(e);for(var i=0;i<t.length;i++)e=t[i],this.clearChildSelectionHighlight(e),this.createHighlightBorderInsideTable(e)},a.prototype.clearSelectionHighlight=function(e){this.selectedWidgets.containsKey(e)&&(this.removeSelectionHighlight(e),this.selectedWidgets.remove(e))},a.prototype.getLineWidgetCellWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i].y<=t.y&&e.childWidgets[i].y+e.childWidgets[i].height>=t.y)return e.childWidgets[i]instanceof G?this.getLineWidgetParaWidget(e.childWidgets[i],t):this.getLineWidgetTableWidget(e.childWidgets[i],t);var n=void 0;return n=0<e.childWidgets.length&&e.childWidgets[0].y-e.margin.top<=t.y?e.childWidgets[e.childWidgets.length-1]instanceof G?this.getLineWidgetParaWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetTableWidget(e.childWidgets[0],t):n},a.prototype.updateTextPosition=function(e,t){var i=t,n=void 0,r=0,o=!1,s=(this.owner.enableHeaderAndFooter&&(-1!=(s=this.start.paragraph.bodyWidget).headerFooterType.indexOf("Header")?this.comparePageWidthAndMargins(s.page.headerWidget,s.page):this.comparePageWidthAndMargins(s.page.footerWidget,s.page)),this.updateTextPositionIn(e,n,r,t,!1));_.isNullOrUndefined(s)||(n=s.element,r=s.index,i=s.caretPosition,o=s.isImageSelected,this.isImageSelected=o),o?(this.selectInternal(e,n,r,i),0===r?this.extendForward():this.extendBackward()):(_.isNullOrUndefined(this.owner.imageResizerModule)||this.owner.imageResizerModule.selectedImageWidget.clear(),this.selectInternal(e,n,r,i))},a.prototype.updateTextPositionIn=function(e,t,i,n,r){var o=!1,s=this.getTop(e),a=e.paragraph.x,l=this.getFirstElement(e,a),d=l.element,h=!1,c=!1,a=l.left,p=e.renderedElements;if(_.isNullOrUndefined(d)){var l=this.getParagraphMarkSize(e.paragraph,0,0),u=l.topMargin;l.bottomMargin;(!(this.documentHelper.mouseDownOffset.y>=s&&this.documentHelper.mouseDownOffset.y<s+e.height)||this.documentHelper.mouseDownOffset.x<a+l.width)&&r&&n.x>a+l.width/2?(a+=l.width,0<p.length&&(i=(t=p[p.length-1]).length),i++):e.paragraph.isEmpty()&&e.paragraph.bidi&&(a+=l.width),n=new nl(a,0<u?s+u:s)}else if(!_.isNullOrUndefined(d)){if(n.x>a+d.margin.left||d instanceof hc&&"Inline"!==d.textWrappingStyle){var g=!1;0<e.paragraph.floatingElements.length&&(g=this.documentHelper.checkPointIsInLine(e,n));for(var m=p.indexOf(d);m<p.length;m++){if((d=p[m])instanceof hc&&"Inline"!==d.textWrappingStyle){if(!this.documentHelper.isInShapeBorder(d,n)||this.documentHelper.isSelectionChangedOnMouseMoved||g)continue;a=d.x,s=d.y;break}var f=!1;if((d instanceof Y||d instanceof X)&&(f=d.line.paragraph.paragraphFormat.bidi),n.x<a+d.margin.left+d.width+d.padding.left||m===p.length-1||p[m+1]instanceof Y&&f)break;a+=d.margin.left+d.width+d.padding.left}if(d instanceof X&&(h=d.isRightToLeft,c=d.line.paragraph.paragraphFormat.bidi),n.x>a+d.margin.left+d.width+d.padding.left&&!(d instanceof uc))i=d instanceof X?d.length:1,h&&c&&(i=0),(d instanceof X&&"\v"!==d.text&&"\f"!==d.text&&d.text!==String.fromCharCode(14)||r)&&(a+=d.margin.left+d.width+d.padding.left);else if(d instanceof X){d instanceof X&&h&&(a+=d.width+d.padding.left);var y=0,y=h?a+d.margin.left-n.x:n.x-a-d.margin.left-d.padding.left;a+=d.margin.left+d.padding.left;for(var v=0,w=0,m=1;m<=d.length;m++){var b=0;if(y<(b=m===d.length?d.width+d.padding.left:this.documentHelper.textHelper.getWidth(d.text.substr(0,m),d.characterFormat,d.scriptType))||m===d.length){(b-v)/2<y-v?(h?a-=b:a+=b,w=m):(h?a-=v:a+=v,w=m-1,1!==m||d===p[0]||p[0]instanceof hc&&"Inline"!==p[0].textWrappingStyle||(x=p.indexOf(d),p[x-1]instanceof Y)||h||(w=(d=(d=p[x-1])instanceof hc&&"Inline"!==d.textWrappingStyle&&0==w&&!_.isNullOrUndefined(d.previousElement)?p[p.indexOf(d)-1]:d)instanceof X?d.length:1));break}v=b}i=w}else{var x,o=d instanceof Ic||d instanceof uc;n.x-a-d.margin.left>d.width/2?(i=1,a+=d.margin.left+d.width+d.padding.left):d===p[0]||o||(x=p.indexOf(d),p[x-1]instanceof Y)||(i=(d=p[x-1])instanceof X?d.length:1)}d instanceof X&&("\v"===d.text||"\f"===d.text||d.text===String.fromCharCode(14))&&(i=0)}else h=d.isRightToLeft,c=d.line.paragraph.paragraphFormat.bidi,i=d instanceof X&&(c||h)&&n.x<a+d.margin.left+d.width+d.padding.left?this.getTextLength(d.line,d)+d.length:this.getTextLength(d.line,d),a+=d.margin.left;d instanceof X?s+=0<d.margin.top?d.margin.top:0:(l=this.documentHelper.textHelper.getHeight(d.characterFormat),u=d.height,d instanceof J&&!this.documentHelper.layout.hasValidElement(d.line.paragraph)&&(u=l.Height),s+=d.margin.top+u-l.BaselineOffset),(t=d)instanceof Z&&2===t.fieldType&&!_.isNullOrUndefined(t.fieldBegin)&&(t=t.fieldBegin,i=0),t instanceof Sc&&(i=0),!_.isNullOrUndefined(t.previousElement)&&t.previousElement instanceof hc&&"Inline"!==t.previousElement.textWrappingStyle&&0==i&&(t=t.previousElement);c=this.validateTextPosition(t,i),u=(t=c.element,i=c.index,_.isNullOrUndefined(t.nextNode)&&i===t.length),l=t.line.isEndsWithLineBreak&&t instanceof X&&"\v"===t.text;r&&t.nextNode instanceof Z&&i===t.length&&(u=this.isLastRenderedInline(t,i)),(r&&u||l)&&(b=0,u?(b=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat),(!(this.documentHelper.mouseDownOffset.y>=s&&this.documentHelper.mouseDownOffset.y<s+e.height)||this.documentHelper.mouseDownOffset.x<a+b)&&n.x>a+b/2&&(a+=b,i=t.length+1)):l&&(a+=b=d.width+d.padding.left)),n=new nl(a,s)}return{element:t,index:i,caretPosition:n,isImageSelected:o}},a.prototype.checkAllFloatingElements=function(e,t){var i,n=!1,r=!1;if(!_.isNullOrUndefined(e))for(var o=e.paragraph.bodyWidget,n=!1,r=!1,s=0;s<o.floatingElements.length;s++)if(!(o.floatingElements[s]instanceof K)&&(i=o.floatingElements[s],t.x<i.x+i.margin.left+i.width)&&t.x>i.x&&t.y<i.y+i.margin.top+i.height&&t.y>i.y){n=!0,this.documentHelper.isInShapeBorder(i,t)&&(r=!0);break}return{element:i,caretPosition:t,isShapeSelected:n,isInShapeBorder:r}},a.prototype.getTextLength=function(e,t){var i=0,n=e.renderedElements,r=n.indexOf(t);0<n.length&&n[0]instanceof Y&&(n[1]instanceof Y?r-=2:--r);for(var o=1;o<r;o++)i+=n[o].length;return i},a.prototype.getLeft=function(e){for(var t=e.paragraph.x,i=e.paragraph.paragraphFormat,n=(this.isParagraphFirstLine(e)&&!i.bidi&&"Right"!==i.textAlignment&&(t+=j.convertPointToPixel(i.firstLineIndent)),e.renderedElements),r=0;r<n.length;r++){var o=n[r];if(!(o instanceof Y)||i.bidi){t+=o.margin.left;break}t+=0===r?o.margin.left+o.width:o.width}return t},a.prototype.getTop=function(e){for(var t=e.paragraph.y,i=e.paragraph.childWidgets.indexOf(e),n=0;n<i;n++)var r=e.paragraph.childWidgets[n],t=t+r.height+r.marginTop;return t+=e.marginTop},a.prototype.getFirstElement=function(e,t){for(var i=0,n=(t+=i=this.isParagraphFirstLine(e)&&!e.paragraph.paragraphFormat.bidi?j.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent):i,void 0),r=e.renderedElements,o=0;o<r.length&&((n=r[o])instanceof Y||n instanceof up);o++)n=e.paragraph.paragraphFormat.bidi?void(t+=n.margin.left):void(t+=n.margin.left+n.width);return{element:n,left:t}},a.prototype.getIndexInInline=function(e){var t=0;if(e instanceof X)for(var i=e.line.children.indexOf(e),n=0;n<i;n++){var r=e.line.children[n];r instanceof Z||r instanceof Y||(t+=r.length)}return t},a.prototype.isParagraphFirstLine=function(e){return!(!_.isNullOrUndefined(e.paragraph.previousSplitWidget)||e!==e.paragraph.firstChild)},a.prototype.isParagraphLastLine=function(e){return!(!_.isNullOrUndefined(e.paragraph.nextSplitWidget)||e!==e.paragraph.lastChild)},a.prototype.getWidth=function(e,t){var i=0,n=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!n.bidi&&(i+=j.convertPointToPixel(n.firstLineIndent));for(var r=0;r<e.children.length;r++){var o=e.children[r];o instanceof hc&&"Inline"!==o.textWrappingStyle||(i+=o.margin.left+o.width+o.padding.left)}return t&&e.paragraph.childWidgets.indexOf(e)===e.paragraph.childWidgets.length-1&&_.isNullOrUndefined(e.paragraph.nextSplitWidget)&&(i+=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat)),i},a.prototype.getLeftInternal=function(e,t,i,n){for(var r=e.paragraph.x,o=e.paragraph.paragraphFormat,s=(this.isParagraphFirstLine(e)&&!o.bidi&&(r+=j.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent)),e.renderedElements),a=s.indexOf(t),l=((1===s.length&&s[0]instanceof Y||2===s.length&&s[0]instanceof Y&&s[1]instanceof Y)&&(a=s.length),!1),d=0;d<a;d++){var h=s[d];(l=h instanceof Z&&2===h.fieldType?!1:l)||h instanceof hc&&"Inline"!==h.textWrappingStyle||(1===d&&h instanceof Y?r+=h.width:h instanceof _h&&t===h?r+=h.margin.left:r+=h.margin.left+h.width+h.padding.left,h instanceof Z&&0===h.fieldType&&(l=!0))}var c=!1,p=e.paragraph.bidi,n=(!_.isNullOrUndefined(t)&&(c=t.characterRange===V.CharacterRangeType.RightToLeft,p=t.line.paragraph.paragraphFormat.bidi,r=0===i&&n?r+t.margin.left:r+t.margin.left+t.padding.left,t instanceof hc&&!_.isNullOrUndefined(t.nextElement)&&(r+=t.nextElement.margin.left+t.nextElement.padding.left),c||1===this.documentHelper.moveCaretPosition&&!c&&p)&&(r+=t.width),0);if(t instanceof X){if(0!==this.documentHelper.moveCaretPosition&&(p||c))return(c&&p&&2===this.documentHelper.moveCaretPosition||c&&!p&&1===this.documentHelper.moveCaretPosition)&&(r-=t.width),this.documentHelper.moveCaretPosition=0,r;i!==t.length||c?i>t.length?(n=this.documentHelper.textHelper.getParagraphMarkWidth(t.line.paragraph.characterFormat),c?r-=t.width+n:r+=t.width+n):(n=i===t.length&&c&&"Justify"===o.textAlignment?t.width:this.documentHelper.textHelper.getWidth(t.text.substr(0,i),t.characterFormat,t.scriptType),c?r-=n:r+=n):r+=t.width,this.documentHelper.moveCaretPosition=0}else 0<i&&(_.isNullOrUndefined(t)||t instanceof Y?r+=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat):(t instanceof hc&&"Inline"!==t.textWrappingStyle||(r+=t.width),2===i&&(p=t.line.paragraph,r+=this.documentHelper.textHelper.getParagraphMarkWidth(p.characterFormat))));return r},a.prototype.getLineStartLeft=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;return this.isParagraphFirstLine(e)&&!i.bidi&&(t+=j.convertPointToPixel(i.firstLineIndent)),0<e.children.length&&(t+=e.children[0].margin.left),t},a.prototype.updateTextPositionWidget=function(e,t,i,n){var t=this.updateTextPositionIn(e,void 0,0,t,n),n=t.element,r=t.index,t=t.caretPosition;i.setPositionForSelection(e,n,r,t)},a.prototype.clearSelectionHighlightLineWidget=function(e){!_.isNullOrUndefined(this.owner)&&0<this.selectedWidgets.length&&this.clearSelectionHighlight(this)},a.prototype.getFirstElementInternal=function(e){for(var t=void 0,i=e.children.length,n=0;n<i&&(t=e.children[n])instanceof Y;n++)t=void 0;return t},a.prototype.selectRange=function(e,t,i){this.start.setPositionInternal(e),this.end.setPositionInternal(t),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0,!0,i)},a.prototype.selectParagraphInternal=function(e,t){_.isNullOrUndefined(e)||_.isNullOrUndefined(e.firstChild)||(e=e.firstChild,t?this.start.setPosition(e,t):(t=e.getEndOffset(),this.start.setPositionParagraph(e,t))),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0)},a.prototype.setPositionForBlock=function(e,t){var i;return(e=e instanceof K?t?this.documentHelper.getFirstParagraphInFirstCell(e):this.documentHelper.getLastParagraphInLastCell(e):e)instanceof G&&(i=new y(this.owner),t?i.setPosition(e.firstChild,!0):(t=e.lastChild,i.setPositionParagraph(t,t.getEndOffset()))),i},a.prototype.selectContent=function(e,t){if(_.isNullOrUndefined(e))throw new Error("textPosition is undefined.");this.start.setPositionInternal(e),this.end.setPositionInternal(e),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0)},a.prototype.selectInternal=function(e,t,i,n){this.start.setPositionForSelection(e,t,i,n),this.end.setPositionInternal(this.start),this.upDownSelectionLength=n.x,this.fireSelectionChanged(!0)},a.prototype.selects=function(e,t,i){this.documentHelper.clearSelectionHighlight(),this.start.setPositionForLineWidget(e,t),this.end.setPositionInternal(this.start),i||this.fireSelectionChanged(!0)},a.prototype.selectPosition=function(e,t){if(_.isNullOrUndefined(e)||_.isNullOrUndefined(t))throw new Error("TextPosition cannot be undefined");if(_.isNullOrUndefined(e.paragraph)||e.offset>this.getParagraphLength(e.paragraph)+1)throw new Error("Start TextPosition is not valid.");if(_.isNullOrUndefined(t.paragraph)||t.offset>this.getParagraphLength(t.paragraph)+1)throw new Error("End TextPosition is not valid.");e.isAtSamePosition(t)?this.selectRange(e,e):(e.isExistBefore(t)?t.validateForwardFieldSelection(e.getHierarchicalIndexInternal(),t.getHierarchicalIndexInternal()):e.validateForwardFieldSelection(t.getHierarchicalIndexInternal(),e.getHierarchicalIndexInternal()),this.selectRange(e,t))},a.prototype.fireSelectionChanged=function(e,t,i){this.isSelectBookmark||(this.isExcludeBookmarkStartEnd=!1),this.isEmpty||(this.isForward?(this.start.updatePhysicalPosition(!0),this.end.updatePhysicalPosition(!1)):(this.start.updatePhysicalPosition(!1),this.end.updatePhysicalPosition(!0))),this.isModifyingSelectionInternally||(0<this.documentHelper.formFields.length&&!this.owner.editor.isRemoteAction?this.currentFormField=this.getCurrentFormField():this.currentFormField=void 0,!_.isNullOrUndefined(this.previousSelectedFormField)&&_.isNullOrUndefined(this.previousSelectedFormField.fieldSeparator)&&(this.previousSelectedFormField=this.currentFormField),this.skipFormatRetrieval||this.retrieveCurrentFormatProperties(),this.documentHelper.clearSelectionHighlight(),this.hideToolTip(),this.owner.isLayoutEnabled&&!this.owner.isShiftingEnabled&&this.highlightSelection(!0,i),this.documentHelper.restrictEditingPane.isShowRestrictPane&&!this.skipEditRangeRetrieval&&this.documentHelper.restrictEditingPane.updateUserInformation(),e&&(this.start.paragraph.isInHeaderFooter&&!this.owner.enableHeaderAndFooter?this.owner.enableHeaderAndFooter=!0:!this.start.paragraph.isInHeaderFooter&&this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1),this.owner.fireSelectionChange()),this.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.documentHelper.isFormFillProtectedMode&&e&&(this.triggerFormFillEvent(t),this.previousSelectedFormField=this.currentFormField),this.owner.rulerHelper&&this.owner.documentEditorSettings&&this.owner.documentEditorSettings.showRuler&&!this.owner.isReadOnlyMode&&this.owner.rulerHelper.updateRuler(this.owner,!1))},a.prototype.retrieveCurrentFormatProperties=function(){this.isRetrieveFormatting=!0;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start),this.retrieveImageFormat(e,t),this.retrieveCharacterFormat(e,t),this.retrieveParagraphFormat(e,t),this.retrieveSectionFormat(e,t),this.retrieveTableFormat(e,t),this.isRetrieveFormatting=!1,this.setCurrentContextType()},a.prototype.retrieveImageFormat=function(e,t){var i;(i=e.currentWidget===t.currentWidget&&e.offset+1===t.offset&&(i=(t=t.currentWidget.getInline(t.offset,0)).element,t.index,i instanceof Ic)&&e.currentWidget.getOffset(i,0)!==e.offset?void 0:i)instanceof Ic?this.imageFormat.copyImageFormat(i):this.imageFormat.clearImageFormat()},a.prototype.getPreviousContextType=function(e){var t,i=this.start;if(0<i.offset)return t=i.currentWidget.getInline(i.offset,0).element,t=e?t.previousElement:i.currentWidget.getInline(i.offset-1,0).element,this.getContextElement(t)},a.prototype.getNextContextType=function(e){var t=this.start,i=t.currentWidget.getInline(t.offset,0).element,i=e&&i.nextElement?i.nextElement:t.currentWidget.getInline(t.offset+1,0).element;return this.getContextElement(i)},a.prototype.getContextElement=function(e){return e instanceof X?"Text":e instanceof Z||e instanceof Vh?"Field":e instanceof J?"Bookmark":e instanceof Ic?"Image":e instanceof uc?"Shape":e instanceof fp||e instanceof up?"Comment":e instanceof Y?"List":e instanceof Wc||e instanceof Sc?"EditRange":void 0},a.prototype.getContentControlInfo=function(){var e=this.documentHelper.owner.editor.getContentControl();if(!_.isNullOrUndefined(e)){for(var t=void 0,i=0;i<e.line.children.length;i++)e.line.children[i]instanceof X&&(t=e.line.children[i].text);return{title:e.contentControlProperties.title,tag:e.contentControlProperties.tag,value:t,canDelete:e.contentControlProperties.lockContentControl,canEdit:e.contentControlProperties.lockContents,type:e.contentControlProperties.type}}},a.prototype.setCurrentContextType=function(){var e=!!this.imageFormat.image,t=!_.isNullOrUndefined(this.tableFormat)&&!_.isNullOrUndefined(this.tableFormat.table),i=this.start.paragraph.paragraphFormat.baseStyle;if(i instanceof ul&&0===i.name.toLowerCase().indexOf("toc")){i=this.getTocFieldInternal();if(!_.isNullOrUndefined(i))return void(this.contextTypeInternal="TableOfContents")}var i=this.getCurrentRevision();if(!_.isNullOrUndefined(i)&&this.owner.showRevisions?(this.owner.trackChangesPane.currentSelectedRevision=i[0],_.isNullOrUndefined(this.owner.documentHelper.currentSelectedComment)&&this.owner.commentReviewPane.selectReviewTab("Changes"),this.owner.notify("reviewPane",{comment:this.owner.showComments,changes:!0,isUserClosed:!1})):_.isNullOrUndefined(this.owner.trackChangesPane.currentSelectedRevision)||(this.owner.trackChangesPane.currentSelectedRevision=void 0),this.start.paragraph.isInHeaderFooter?(i=-1!==this.start.paragraph.bodyWidget.headerFooterType.indexOf("Header"),this.contextTypeInternal=t?e?i?"HeaderTableImage":"FooterTableImage":i?"HeaderTableText":"FooterTableText":e?i?"HeaderImage":"FooterImage":i?"HeaderText":"FooterText"):this.contextTypeInternal=t?e?"TableImage":"TableText":e?"Image":"Text",!_.isNullOrUndefined(this.owner.editor)&&!_.isNullOrUndefined(this.owner.editor.documentHelper)&&this.owner.editor.documentHelper.contentControlCollection&&0<this.owner.editor.documentHelper.contentControlCollection.length){i=this.owner.editor.getContentControl(),t=this.owner.getImageContentControl();if(!_.isNullOrUndefined(i)||!_.isNullOrUndefined(t))switch((i||t).contentControlProperties.type){case"RichText":this.contextTypeInternal="RichTextContentControl";break;case"Text":this.contextTypeInternal="PlainTextContentControl";break;case"Picture":this.contextTypeInternal="PictureContentControl";break;case"ComboBox":this.contextTypeInternal="ComboBoxContentControl";break;case"DropDownList":this.contextTypeInternal="DropDownListContentControl";break;case"CheckBox":this.contextTypeInternal="CheckBoxContentControl";break;case"Date":this.contextTypeInternal="DatePickerContentControl"}}},a.prototype.addItemRevisions=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i];this.selectRevision(n),t?n.accept():n.reject()}},a.prototype.hasRevisions=function(){return!!this.getCurrentRevision()},a.prototype.getCurrentRevision=function(){var e=this.start,t=this.end,i=(this.isForward||(e=this.end,t=this.start),!1),n=((i=this.owner.enableTrackChanges&&this.owner.editorHistoryModule&&this.owner.editorHistoryModule.currentBaseHistoryInfo&&"BackSpace"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action?!0:i)&&this.getLineLength(e.currentWidget)>=e.offset+1?e.currentWidget.getInline(e.offset+1,0):e.currentWidget.getInline(e.offset,0)).element,r=e.paragraph,i=(i&&this.getLineLength(e.currentWidget)>=e.offset+2?e.currentWidget.getInline(e.offset+2,0):e.currentWidget.getInline(e.offset+1,0)).element;if(n&&n===i){e=n.line.getOffset(n,n.length);if((i=new y(this.owner)).setPositionParagraph(n.line,e),t.offset===i.offset&&!_.isNullOrUndefined(n.nextElement))return}if(!_.isNullOrUndefined(n)&&0<n.revisions.length)return n.revisions;if(r.isInsideTable){e=r.associatedCell;if(!_.isNullOrUndefined(e.ownerRow)&&0<e.ownerRow.rowFormat.revisions.length)return e.ownerRow.rowFormat.revisions}return t.offset>t.paragraph.getLength()&&0<t.paragraph.characterFormat.revisions.length?t.paragraph.characterFormat.revisions:void 0},a.prototype.processLineRevisions=function(e,t){for(var i=0;i<e.children.length;i++){var n=e.children[i];0<n.revisions.length&&this.addItemRevisions(n,t)}},a.prototype.handleAcceptReject=function(e){if(this.isEmpty){var t=this.start.currentWidget.getInline(this.start.offset+1,0).element,i=this.start.paragraph;if(!_.isNullOrUndefined(t)&&0<t.revisions.length&&this.addItemRevisions(t,e),i.isInsideTable){var n=i.associatedCell;if(_.isNullOrUndefined(n)){if(!i.isEmpty())for(var r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=void 0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];this.processLineRevisions(a,e)}}else 0<n.ownerRow.rowFormat.revisions.length&&this.addItemRevisions(n.ownerRow.rowFormat,e)}}else for(var l=this.getselectedRevisionElements(),r=0;r<l.length;r++)this.acceptReject(l[r],e)},a.prototype.acceptReject=function(e,t){this.selectRevision(e),t?e.accept():e.reject()},a.prototype.getselectedRevisionElements=function(){var e=[],t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start);for(var n=0;n<this.selectedWidgets.length;n++){var r=this.selectedWidgets.keys[n];if(r instanceof uh)e=this.getSelectedLineRevisions(r,t,i,e);else if(r instanceof N){0<r.ownerRow.rowFormat.revisions.length&&(e=this.addRevisionsCollec(r.ownerRow.rowFormat.revisions,e));for(var o=0;o<r.childWidgets.length;o++)for(var s=r.childWidgets[o],a=0;a<s.childWidgets.length;a++)var l=s.childWidgets[a],e=this.getSelectedLineRevisions(l,t,i,e)}}return e},a.prototype.getSelectedLineRevisions=function(e,t,i,n){0<e.paragraph.characterFormat.revisions.length&&(n=this.addRevisionsCollec(e.paragraph.characterFormat.revisions,n));for(var r=0;r<e.children.length;r++){var o=e.children[r],s=o.line.getOffset(o,0),a=new y(this.owner),l=(a.setPositionParagraph(o.line,s),s=o.line.getOffset(o,o.length),new y(this.owner));l.setPositionParagraph(o.line,s),(l.isExistAfter(t)&&l.isExistBefore(i)||a.isExistAfter(t)&&a.isExistBefore(i)||a.isAtSamePosition(t)||t.isExistAfter(a)&&i.isExistBefore(l))&&0<o.revisions.length&&(n=this.addRevisionsCollec(o.revisions,n))}return n},a.prototype.addRevisionsCollec=function(e,t){for(var i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t},a.prototype.retrieveTableFormat=function(e,t){var i=this.getTable(e,t);_.isNullOrUndefined(i)?this.tableFormat.clearFormat():(this.tableFormat.table=i,this.tableFormat.copyFormat(i.tableFormat),this.retrieveCellFormat(e,t),this.retrieveRowFormat(e,t))},a.prototype.retrieveCellFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.cellFormat.copyFormat(e.paragraph.associatedCell.cellFormat),this.getCellFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.cellFormat.clearCellFormat()},a.prototype.retrieveRowFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.rowFormat.copyFormat(e.paragraph.associatedCell.ownerRow.rowFormat),this.getRowFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.rowFormat.clearRowFormat()},a.prototype.getCellFormat=function(e,t,i){if(!t.paragraph.associatedCell.equals(i.paragraph.associatedCell))for(var n=!1,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(n=o===t.paragraph.associatedCell.ownerRow?!0:n)for(var s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(this.isCellSelected(a,t,i)&&this.cellFormat.combineFormat(a.cellFormat),a===i.paragraph.associatedCell)return void this.cellFormat.combineFormat(a.cellFormat)}}},a.prototype.getRowFormat=function(e,t,i){t=t.paragraph.associatedCell.ownerRow;if(t!==i.paragraph.associatedCell.ownerRow)for(var n=e.childWidgets.indexOf(t)+1;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(this.rowFormat.combineFormat(r.rowFormat),r===i.paragraph.associatedCell.ownerRow)return}},a.prototype.getTable=function(e,t){if(!_.isNullOrUndefined(e.paragraph.associatedCell)&&!_.isNullOrUndefined(t.paragraph.associatedCell)){var i=e.paragraph.associatedCell.ownerTable,n=e.paragraph.associatedCell.ownerTable;if(i===n)return i;if(i.contains(e.paragraph.associatedCell))return i;if(n.contains(e.paragraph.associatedCell))return n;if(!i.isInsideTable||!n.isInsideTable)return;do{if((i=i.associatedCell.ownerTable)===n||i.contains(n.associatedCell))return i;if(n.contains(i.associatedCell))return n}while(!_.isNullOrUndefined(i.associatedCell))}},a.prototype.getContainerWidget=function(e){var t;if(e.containerWidget instanceof fc)t=e.containerWidget.containerShape.line.paragraph.bodyWidget;else if(e.containerWidget instanceof _d)t=(!_.isNullOrUndefined(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof q?e.containerWidget:e).containerWidget;else for(t=e.containerWidget;!(t instanceof _d);)t=(t=t instanceof fc?t.containerShape.line.paragraph:t).containerWidget;return t},a.prototype.retrieveSectionFormat=function(e,t){e=this.getContainerWidget(e.paragraph),t=this.getContainerWidget(t.paragraph);if(!_.isNullOrUndefined(e)){this.sectionFormat.copyFormat(e.sectionFormat);for(var e=this.documentHelper.pages.indexOf(e.page),i=this.documentHelper.pages.indexOf(t.page),n=e+1;n<=i;n++)this.sectionFormat.combineFormat(this.documentHelper.pages[n].bodyWidgets[0].sectionFormat)}},a.prototype.retrieveParagraphFormat=function(e,t){this.getParagraphFormatForSelection(e.paragraph,this,e,t)},a.prototype.getParagraphFormatForSelection=function(e,t,i,n){!i.paragraph.isInsideTable||n.paragraph.isInsideTable&&i.paragraph.associatedCell===n.paragraph.associatedCell&&!this.isCellSelected(i.paragraph.associatedCell,i,n)?(this.getParagraphFormatInternalInParagraph(e,i,n),n.paragraph===e||(e=this.getNextRenderedBlock(e),_.isNullOrUndefined(e))||this.getParagraphFormatInternalInBlock(e,i,n)):this.getParagraphFormatInternalInCell(i.paragraph.associatedCell,i,n)},a.prototype.getParagraphsInSelection=function(){var e=this.owner.selectionModule,t=e.selectedWidgets.keys,i=[];if(e.isEmpty||e.start.paragraph===e.end.paragraph)return[e.start.paragraph];for(var n=0;n<t.length;n++){var r=t[n];-1===i.indexOf(r.paragraph)&&i.push(r.paragraph)}return i},a.prototype.getParagraphFormatInternalInParagraph=function(e,t,i){t.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat)},a.prototype.getParagraphFormatInternalInBlock=function(e,t,i){var n;e instanceof G?(this.getParagraphFormatInternalInParagraph(e,t,i),i.paragraph===e||(n=this.getNextRenderedBlock(e),_.isNullOrUndefined(n))||this.getParagraphFormatInternalInBlock(n,t,i)):this.getParagraphFormatInternalInTable(e,t,i)},a.prototype.getParagraphFormatInternalInTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getParagraphFormatInCell(r.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e);this.getParagraphFormatInternalInBlock(s,t,i)},a.prototype.getParagraphFormatInCell=function(e){for(var t=0;t<e.childWidgets.length;t++)this.getParagraphFormatInBlock(e.childWidgets[t])},a.prototype.getParagraphFormatInBlock=function(e){e instanceof G?this.getParagraphFormatInParagraph(e):this.getParagraphFormatInTable(e)},a.prototype.getParagraphFormatInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)this.getParagraphFormatInCell(i.childWidgets[n])},a.prototype.getParagraphFormatInParagraph=function(e){this.start.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat)},a.prototype.getParagraphFormatInternalInCell=function(e,t,i){var n,r,o,s;i.paragraph.isInsideTable?(n=this.getContainerCellOf(e,i.paragraph.associatedCell)).ownerTable.contains(i.paragraph.associatedCell)?(r=this.getSelectedCell(e,n),o=this.getSelectedCell(i.paragraph.associatedCell,n),this.containsCell(n,i.paragraph.associatedCell)?this.isCellSelected(n,t,i)?this.getParagraphFormatInCell(n):r===n?(this.getParagraphFormatInternalInParagraph(t.paragraph,t,i),i.paragraph===t.paragraph||(s=this.getNextRenderedBlock(t.paragraph),_.isNullOrUndefined(s))||this.getParagraphFormatInternalInBlock(s,t,i)):this.getParagraphFormatInRow(r.ownerRow,t,i):this.getParaFormatForCell(n.ownerTable,n,o)):this.getParagraphFormatInRow(n.ownerRow,t,i):(s=this.getContainerCell(e),this.getParagraphFormatInRow(s.ownerRow,t,i))},a.prototype.getParaFormatForCell=function(e,t,i){for(var n=this.getCellLeft(t.ownerRow,t),r=n+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth,a=(r<s&&(r=s),(n=(n=o<n?o:n)>this.upDownSelectionLength?this.upDownSelectionLength:n)<this.upDownSelectionLength&&(n=this.upDownSelectionLength),e.childWidgets.indexOf(i.ownerRow)),l=e.childWidgets.indexOf(t.ownerRow);l<=a;l++)for(var d=e.childWidgets[l],h=0;h<d.childWidgets.length;h++){var c=d.childWidgets[h],p=this.getCellLeft(d,c);j.round(n,2)<=j.round(p,2)&&j.round(p,2)<j.round(r,2)&&this.getParagraphFormatInCell(c)}},a.prototype.getParagraphFormatInRow=function(e,t,i){for(var n=e.rowIndex;n<e.ownerTable.childWidgets.length;n++){for(var r=e.ownerTable.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getParagraphFormatInCell(r.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e.ownerTable);this.getParagraphFormatInternalInBlock(s,t,i)},a.prototype.retrieveCharacterFormat=function(e,t){if(this.characterFormat.copyFormat(e.paragraph.characterFormat),e.paragraph.isEmpty()&&this.characterFormat.copyFormat(e.paragraph.characterFormat,this.documentHelper.textHelper.getFontNameToRender(0,e.paragraph.characterFormat)),e.paragraph!==t.paragraph||!e.currentWidget.isLastLine()||e.offset!==this.getLineLength(e.currentWidget)||e.offset+1!==t.offset){var i=e.paragraph;if(e.paragraph===t.paragraph&&this.isSelectList)(o=this.getListLevel(e.paragraph))&&o.characterFormat.uniqueCharacterFormat&&this.characterFormat.copyFormat(o.characterFormat);else{for(e.offset!==this.getParagraphLength(i)||this.isEmpty||(i=this.getNextParagraphBlock(i));!_.isNullOrUndefined(i)&&i!==t.paragraph&&i.isEmpty();)i=this.getNextParagraphBlock(i);var n,r,o=i===e.paragraph?e.offset:0;_.isNullOrUndefined(i)||i.isEmpty()||(n=new y(this.owner),r=e.currentWidget.getInline(o,0),o=this.getPhysicalPositionInternal(e.currentWidget,o,!0),n.setPositionForSelection(e.currentWidget,r.element,r.index,o),this.getCharacterFormatForSelection(i,this,n,t))}}},a.prototype.getCharacterFormatForSelection=function(e,t,i,n){i.paragraph instanceof G&&i.paragraph.isInsideTable&&(!n.paragraph.isInsideTable||i.paragraph.associatedCell!==n.paragraph.associatedCell||this.isCellSelected(i.paragraph.associatedCell,i,n))?this.getCharacterFormatInTableCell(i.paragraph.associatedCell,t,i,n):this.getCharacterFormat(e,i,n)},a.prototype.getCharacterFormatForTableRow=function(e,t,i){for(var n=e.rowIndex;n<e.ownerTable.childWidgets.length;n++){for(var r=e.ownerTable.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(r.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e.ownerTable);this.getCharacterFormatForBlock(s,t,i)},a.prototype.getCharacterFormatInTableCell=function(e,t,i,n){var r,o,s;n.paragraph.isInsideTable?(r=this.getContainerCellOf(e,n.paragraph.associatedCell)).ownerTable.contains(n.paragraph.associatedCell)?(s=this.getSelectedCell(e,r),o=this.getSelectedCell(n.paragraph.associatedCell,r),this.containsCell(r,n.paragraph.associatedCell)?this.isCellSelected(r,i,n)?this.getCharacterFormatForSelectionCell(r,i,n):s===r?this.getCharacterFormat(i.paragraph,i,n):this.getCharacterFormatForTableRow(s.ownerRow,i,n):this.getCharacterFormatInternalInTable(r.ownerTable,r,o,i,n)):this.getCharacterFormatForTableRow(r.ownerRow,i,n):(s=this.getContainerCell(e),this.getCharacterFormatForTableRow(s.ownerRow,i,n))},a.prototype.getCharacterFormatInternalInTable=function(e,t,i,n,r){for(var o=this.getCellLeft(t.ownerRow,t),s=o+t.cellFormat.cellWidth,a=this.getCellLeft(i.ownerRow,i),l=a+i.cellFormat.cellWidth,d=((o=a<o?a:o)>this.upDownSelectionLength&&(o=this.upDownSelectionLength),(s=s<l?l:s)<this.upDownSelectionLength&&(s=this.upDownSelectionLength),e.childWidgets.indexOf(i.ownerRow)),h=e.childWidgets.indexOf(t.ownerRow);h<=d;h++)for(var c=e.childWidgets[h],p=0;p<c.childWidgets.length;p++){var u=c.childWidgets[p],g=this.getCellLeft(c,u);j.round(o,2)<=j.round(g,2)&&j.round(g,2)<j.round(s,2)&&this.getCharacterFormatForSelectionCell(u,n,r)}},a.prototype.getCharacterFormat=function(e,t,i){if((e===t.paragraph||e===i.paragraph||e.isEmpty()||(this.getCharacterFormatInternal(e,this),this.characterFormat.canRetrieveNextCharacterFormat()))&&(i.paragraph!==e||t.paragraph===e||0!==i.offset)){var n=0,r=this.getParagraphLength(e);if(e===t.paragraph){n=t.offset;if(this.setCharacterFormat(e,t,i,r))return}var o=-1!==e.childWidgets.indexOf(t.currentWidget)?e.childWidgets.indexOf(t.currentWidget):0,s=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):e.childWidgets.length-1,a=i.offset;e!==i.paragraph&&(a=r);for(var l=o;l<=s;l++)for(var d=e.childWidgets[l],h=(l!==o&&(n=this.getStartLineOffset(d)),a=d===i.currentWidget?i.offset:this.getLineLength(d),0),c=0;c<d.children.length;c++){var p=d.children[c];if(!(p instanceof Y))if(n>=h+p.length)h+=p.length;else if(p instanceof Z&&0===p.fieldType&&j.isLinkedFieldCharacter(p)){var u=_.isNullOrUndefined(p.fieldEnd)?p.fieldBegin:p.fieldEnd;for(c--;this.characterFormat.combineFormat(p.characterFormat),h+=p.length,p=p.nextNode,l++,c++,!_.isNullOrUndefined(p)&&p!==u;);}else{if((p instanceof X||p instanceof Z)&&this.characterFormat.combineFormat(p.characterFormat,this.documentHelper.textHelper.getFontNameToRender(p.scriptType,p.characterFormat)),_.isNullOrUndefined(p)||a<=h+p.length)break;h+=p.length}}i.paragraph===e||(r=this.getNextRenderedBlock(e),_.isNullOrUndefined(r))||this.getCharacterFormatForBlock(r,t,i)}},a.prototype.setCharacterFormat=function(e,t,i,n){var r,o=t.offset,s=t.currentWidget.getInline(o,0),a=s.index,s=s.element;if(_.isNullOrUndefined(s)){t.paragraph.childWidgets.indexOf(t.currentWidget);if(t.currentWidget.previousLine)return s=t.currentWidget.previousLine.children[t.currentWidget.previousLine.children.length-1],this.characterFormat.copyFormat(s.characterFormat,this.documentHelper.textHelper.getFontNameToRender(s.scriptType,s.characterFormat)),!0}if(o<n){if(this.isEmpty)return s instanceof X||s instanceof Z&&(0===s.fieldType||1===s.fieldType)?(t=this.getPreviousTextElement(s),this.characterFormat.copyFormat((s=0===o&&t?t:s).characterFormat,this.documentHelper.textHelper.getFontNameToRender(s.scriptType,s.characterFormat))):_.isNullOrUndefined(this.getPreviousTextElement(s))?_.isNullOrUndefined(this.getNextTextElement(s))?this.characterFormat.copyFormat(e.characterFormat):(r=this.getNextTextElement(s),this.characterFormat.copyFormat(r.characterFormat,this.documentHelper.textHelper.getFontNameToRender(r.scriptType,s.characterFormat))):(r=this.getPreviousTextElement(s),this.characterFormat.copyFormat(r.characterFormat,this.documentHelper.textHelper.getFontNameToRender(r.scriptType,s.characterFormat))),!0;a!==s.length||_.isNullOrUndefined(s.nextNode)?s instanceof X?this.characterFormat.copyFormat(s.characterFormat,this.documentHelper.textHelper.getFontNameToRender(s.scriptType,s.characterFormat)):s instanceof Z&&this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(s)):this.characterFormat.copyFormat(this.getNextValidCharacterFormat(s),this.documentHelper.textHelper.getFontNameToRender(s.scriptType,s.characterFormat))}else if(n===i.offset)return s instanceof X||s instanceof Z?this.characterFormat.copyFormat(s.characterFormat,this.documentHelper.textHelper.getFontNameToRender(s.scriptType,s.characterFormat)):_.isNullOrUndefined(s)?this.characterFormat.copyFormat(e.characterFormat):(s=this.getPreviousTextElement(s),_.isNullOrUndefined(s)||this.characterFormat.copyFormat(s.characterFormat,this.documentHelper.textHelper.getFontNameToRender(s.scriptType,s.characterFormat))),!0;return!1},a.prototype.getCharacterFormatForBlock=function(e,t,i){e instanceof G?this.getCharacterFormat(e,t,i):this.getCharacterFormatInTable(e,t,i)},a.prototype.getCharacterFormatInTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(r.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e);_.isNullOrUndefined(s)||this.getCharacterFormatForBlock(s,t,i)},a.prototype.getCharacterFormatForSelectionCell=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)this.getCharacterFormatForBlock(e.childWidgets[n],t,i)},a.prototype.getCharacterFormatInternal=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.children.length;r++){var o=n.children[r];o instanceof Ic||o instanceof Z||o instanceof Y||t.characterFormat.combineFormat(o.characterFormat)}},a.prototype.getNextValidCharacterFormat=function(e){var t=this.getNextTextElement(e);return _.isNullOrUndefined(t)?e.characterFormat:(t instanceof Z&&(void 0).fieldType,_.isNullOrUndefined(void 0)?t.characterFormat:this.getNextValidCharacterFormatOfField(void 0))},a.prototype.getNextValidCharacterFormatOfField=function(e){var t=e,e=(j.isLinkedFieldCharacter(e)&&(t=_.isNullOrUndefined(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator),void 0);return _.isNullOrUndefined(t.nextNode)||(e=this.getNextValidElement(t.nextNode)),(_.isNullOrUndefined(e)?t:e).characterFormat},a.prototype.checkCursorIsInSelection=function(e,t){if(_.isNullOrUndefined(this.start)||this.isEmpty||_.isNullOrUndefined(e))return!1;var i=!1;do{if(this.selectedWidgets.containsKey(e)){var n=void 0,r=(e instanceof uh?(n=this.owner.selectionModule.getTop(e),this.owner.selectionModule.getLeft(e)):(n=e.y,e.x),this.selectedWidgets.get(e));if(r instanceof Cg)i=r.left<=t.x&&n<=t.y&&n+e.height>=t.y&&r.left+r.width>=t.x;else for(var o=r,s=0;s<o.length&&!(o[s]instanceof Cg&&(i=o[s].left<=t.x&&n<=t.y&&n+e.height>=t.y&&o[s].left+o[s].width>=t.x));s++);}}while(e=e instanceof uh?e.paragraph:e.containerWidget,!_.isNullOrUndefined(e)&&!i);return i},a.prototype.copySelectionParagraphFormat=function(){var e=new Xa;return this.paragraphFormat.copyToFormat(e),e},a.prototype.getHyperlinkDisplayText=function(e,t,i,n,r){var o=e;if(o!==i.line.paragraph)return{displayText:"<<Selection in Document>>",isNestedField:n=!0,format:r};for(var s="",a=o.childWidgets.indexOf(t.line),l=o.childWidgets[a].children.indexOf(t),d=a;d<o.childWidgets.length;d++)for(var h=o.childWidgets[d],c=(l=d!==a?-1:l)+1;c<h.children.length;c++){var p=h.children[c];if(p===i)return{displayText:s,isNestedField:n,format:r};if(p instanceof X)s+=p.text,r=p.characterFormat;else{if(!(p instanceof Z))return{displayText:"<<Selection in Document>>",isNestedField:n=!0,format:r};p instanceof Z&&0===p.fieldType&&!_.isNullOrUndefined(p.fieldEnd)&&(l=_.isNullOrUndefined(p.fieldSeparator)?h.children.indexOf(p.fieldEnd):h.children.indexOf(p.fieldSeparator))}}return{displayText:s,isNestedField:n,format:r}},a.prototype.navigateHyperLinkOnEvent=function(e,t){var i=this,n=this.documentHelper.getLineWidget(e);_.isNullOrUndefined(n)||(n=this.getHyperLinkFieldInCurrentSelection(n,e),_.isNullOrUndefined(n))||(this.documentHelper.updateTextPositionForSelection(e,1),this.fireRequestNavigate(n),setTimeout(function(){i.viewer&&(i.documentHelper.isTouchInput=t,i.documentHelper.updateFocus(),i.documentHelper.isTouchInput=!1)}))},a.prototype.getLinkText=function(e,t){var e=new kg(e,this),i=e.navigationLink,n=e.screenTip;return t?(0<e.localReference.length&&("_"!==e.localReference[0]||!_.isNullOrUndefined(i)&&0!==i.length?e.isCrossRef?i+=e.localReference:i+="#"+e.localReference:i="Current Document"),e.destroy(),i):(e.destroy(),n)},a.prototype.setHyperlinkContentToToolTip=function(e,t,i,n){if(e){if(!this.owner.contextMenuModule||"block"!==this.owner.contextMenuModule.contextMenuInstance.element.style.display){this.toolTipElement||(this.toolTipElement=_.createElement("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement),this.screenTipElement=_.createElement("p"),this.toolTipElement.appendChild(this.screenTipElement),this.toolTipTextElement=_.createElement("p",{styles:"font-weight:bold"}),this.toolTipElement.appendChild(this.toolTipTextElement)),this.toolTipElement.style.display="block";var r=new _.L10n("documenteditor",this.owner.defaultLocale),r=(r.setLocale(this.owner.locale),r.getConstant("Click to follow link")),o=(this.owner.useCtrlClickToFollowHyperlink&&(r=this.documentHelper.isIosDevice?"Command+"+r:"Ctrl+"+r),this.getScreenTipText(e));if(n){n=e.formFieldData.helpText;if(_.isNullOrUndefined(n)||""===n)return;this.screenTipElement.innerText=n}else this.screenTipElement.innerText=o,this.toolTipTextElement.innerText=r;n=this.getTooltipPosition(e.line,i,this.toolTipElement,!1);this.showToolTip(n.x,n.y),_.isNullOrUndefined(this.toolTipField)||e===this.toolTipField||(this.toolTipObject.position={X:n.x,Y:n.y}),this.toolTipObject.show(),this.toolTipField=e}}else this.hideToolTip()},a.prototype.getScreenTipText=function(e){e=new kg(e,this);return e.screenTip||e.localReference?e.screenTip||e.localReference:e.navigationLink},a.prototype.setFootnoteContentToToolTip=function(e,t,i){var n,r;e?"block"===this.owner.contextMenuModule.contextMenuInstance.element.style.display&&this.owner.contextMenuModule||(this.toolTipElement||(this.toolTipElement=_.createElement("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement)),this.toolTipElement.style.display="block",n=void(r=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.owner.locale),"Endnote"===e.footnoteType?n=r.getConstant("Click to View/Edit Endnote"):"Footnote"===e.footnoteType&&(n=r.getConstant("Click to View/Edit Footnote")),this.toolTipElement.innerHTML="<b>"+n+"</b>",r=this.getTooltipPosition(e.line,i,this.toolTipElement,!1),this.showToolTip(r.x,r.y),_.isNullOrUndefined(this.toolTipField)||(this.toolTipObject.position={X:r.x,Y:r.y}),this.toolTipObject.show()):this.hideToolTip()},a.prototype.setLockInfoTooptip=function(e,t,i){var n,r;e?this.owner.contextMenuModule&&"block"===this.owner.contextMenuModule.contextMenuInstance.element.style.display||(n=this.toolTipElement,this.toolTipElement||(n=_.createElement("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(n),this.toolTipElement=n),n.style.display="block",(r=new _.L10n("documenteditor",this.owner.defaultLocale)).setLocale(this.owner.locale),r=r.getConstant("This region is locked by"),n.innerHTML=r+" <b>"+i+"</b>",r=this.getTooltipPosition(e,t,n,!1),this.showToolTip(r.x,r.y),_.isNullOrUndefined(this.toolTipField)||i===this.toolTipField||(this.toolTipObject.position={X:r.x,Y:r.y}),this.toolTipObject.show(),this.toolTipField=i):this.hideToolTip()},a.prototype.getTooltipPosition=function(e,t,i,n){var r=this.getTop(e)*this.documentHelper.zoomFactor,o=this.getPage(e.paragraph),s=this.documentHelper.viewerContainer.getBoundingClientRect().width+this.documentHelper.viewerContainer.scrollLeft,t=o.boundingRectangle.x+t*this.documentHelper.zoomFactor,s=(t+i.clientWidth+10>s&&(t-=i.clientWidth-(s-t)+15),n?0:i.offsetHeight),n=(n=this.getPageTop(o)+(r-s))>this.documentHelper.viewerContainer.scrollTop?n:n+e.height+s;return new nl(t,n)},a.prototype.updateSelectionInfo=function(e){var t,i=this.selectedWidgets.keys;return i[0]instanceof N&&i[i.length-1]instanceof N&&0<i.length&&(t=i[0],i=i[i.length-1],t=t.ownerRow,i=i.ownerRow,t=t.getCell(t.rowIndex,void 0,0),t=this.owner.documentHelper.getFirstParagraphInCell(t),e.start=this.owner.documentHelper.selection.getHierarchicalIndex(t,"0"),t=i.getCell(i.rowIndex,void 0,i.childWidgets.length-1),i=this.getLastParagraph(t),t=this.getParagraphLength(i),e.end=this.owner.documentHelper.selection.getHierarchicalIndex(i,t.toString())),e},a.prototype.createPasteElement=function(e,t){var i,n=new _.L10n("documenteditor",this.owner.defaultLocale);switch(n.setLocale(this.owner.locale),this.currentPasteAction){case"DefaultPaste":o=[{text:n.getConstant("Keep source formatting"),iconCss:"e-icons e-de-paste-source"},{text:n.getConstant("Match destination formatting"),iconCss:"e-icons e-de-paste-merge"},{text:n.getConstant("Text only"),iconCss:"e-icons e-de-paste-text"}];break;case"TextOnly":o=[{text:n.getConstant("Text only"),iconCss:"e-icons e-de-paste-text"}];break;case"InsertAsColumns":case"OverwriteCells":case"InsertAsRows":var r,o=[{text:n.getConstant("NestTable"),iconCss:"e-icons e-de-paste-nested-table"},{text:n.getConstant("InsertAsRows"),iconCss:"e-icons e-de-paste-row"}];"InsertAsColumns"===this.currentPasteAction?(r={text:n.getConstant("InsertAsColumns"),iconCss:"e-icons e-de-paste-column"},o.unshift(r)):"OverwriteCells"===this.currentPasteAction&&(r={text:n.getConstant("OverwriteCells"),iconCss:"e-icons e-de-paste-overwrite-cells"},o.splice(2,0,r))}this.pasteElement?this.pasteDropDwn.items=o:(this.pasteElement=_.createElement("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.pasteElement),i=_.createElement("button",{id:this.owner.containerId+"_iconsplitbtn"}),this.pasteElement.appendChild(i),this.pasteDropDwn=new w.DropDownButton({items:o,iconCss:"e-icons e-de-paste",select:this.pasteOptions}),this.pasteDropDwn.appendTo(i)),this.pasteElement.style.display="block",this.pasteElement.style.position="absolute",this.pasteElement.style.left=t,this.pasteElement.style.top=e,this.pasteDropDwn.dataBind()},a.prototype.getContextBasedPasteOptions=function(e){var e=j.getSfdtDocument(e),t=(!_.isNullOrUndefined(e.optimizeSfdt)&&e.optimizeSfdt?this.owner.editorModule.keywordIndex=1:this.owner.editorModule.keywordIndex=0,[]),e=(this.owner.editorModule.getBlocks(e,!0,t,[],[],!0),this.documentHelper.selection);if(e.start.paragraph.isInsideTable&&e.end.paragraph.isInsideTable){var i=!1;if(i=1===t.length&&(n=t[0].childWidgets).length<3&&(1===n.length&&n[0]instanceof K||2===n.length&&n[0]instanceof K&&n[1].isEmpty())?!0:i){var n=e.start.paragraph.associatedCell,i=e.end.paragraph.associatedCell;t[0].childWidgets[0];if(n.ownerTable.equals(i.ownerTable))return 0===e.start.paragraph.associatedCell.rowIndex&&0===e.end.paragraph.associatedCell.rowIndex&&n.equals(i)&&!this.isCellSelected(n,e.start,e.end)?["NewColumn","NestTable","NewRow"]:["NestTable","NewRow","OverwriteCells"]}}return["KeepSourceFormatting","MergeWithExistingFormatting","KeepTextOnly"]},a.prototype.showToolTip=function(e,t){this.toolTipObject||(this.toolTipObject=new C.Popup(this.toolTipElement,{height:"auto",width:"auto",relateTo:this.documentHelper.viewerContainer.parentElement,position:{X:e,Y:t}}))},a.prototype.hideToolTip=function(){this.toolTipField=void 0,this.toolTipObject&&(this.toolTipElement.style.display="none",this.toolTipObject.hide(),this.toolTipObject.destroy(),this.toolTipObject=void 0)},a.prototype.getHyperLinkFieldInCurrentSelection=function(e,t,i){var n=this.getTop(e),r=this.getLineStartLeft(e),o=j.convertPointToPixel(e.paragraph.paragraphFormat.leftIndent),s=j.convertPointToPixel(e.paragraph.paragraphFormat.rightIndent);if(!(t.y<n||t.y>n+e.height||t.x<r||t.x>r+e.paragraph.width+o+s)){var a=e.paragraph.x,n=this.getFirstElement(e,a),a=n.left,l=n.element;if(_.isNullOrUndefined(l)){var d=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(t.x<=r+d||t.x>=r+d)return p=this.getHyperLinkFields(e.paragraph,[],!1,i),p}else{var h=e.renderedElements;if(t.x>a+l.margin.left)for(var c=h.indexOf(l);c<h.length&&(l=h[c],!(t.x<a+l.margin.left+l.width||c===h.length-1));c++)a+=l.margin.left+l.width;var p,o=l,d=l.margin.left+l.width;if(_.isNullOrUndefined(o.nextNode)&&(d+=this.documentHelper.textHelper.getParagraphMarkWidth(o.line.paragraph.characterFormat)),t.x<=a+d)return p=this.getHyperLinkFieldInternal(o.line.paragraph,o,[],!1,i),p}}},a.prototype.getFootNoteElementInCurrentSelection=function(e,t){var i=void 0,n=this.getTop(e),r=this.getLineStartLeft(e);if(!(t.y<n||t.y>n+e.height||t.x<r||t.x>r+e.paragraph.width)){var o=e.paragraph.x,n=this.getFirstElement(e,o),o=n.left,s=n.element;if(_.isNullOrUndefined(s)){var a=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(t.x<=r+a||t.x>=r+a)return(n=this.documentHelper.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,0).element)instanceof Bh?n:void 0}else{if(t.x>o+s.margin.left)for(var l=e.children.indexOf(s);l<e.children.length&&(s=e.children[l],!(t.x<o+s.margin.left+s.width||l===e.children.length-1));l++)o+=s.margin.left+s.width;s instanceof Bh&&(i=s);a=s.margin.left+s.width;if(_.isNullOrUndefined(s.nextNode)&&(a+=this.documentHelper.textHelper.getParagraphMarkWidth(s.line.paragraph.characterFormat)),t.x<=o+a)return i}}},a.prototype.getHyperlinkField=function(e){var t,i,n,r;if(!_.isNullOrUndefined(this.end))return(i=this.documentHelper.selection).start,t=i.end,i.isForward||(i.end,t=i.start),(i=this.end.currentWidget.getInline(t.offset,0)).index,t=i.element,i=[],r=void 0,r=_.isNullOrUndefined(t)?this.getHyperLinkFields(this.end.paragraph,i,e):this.documentHelper.isFormFillProtectedMode&&t instanceof J&&t.previousNode instanceof Z&&1===t.previousNode.fieldType?void 0:(n=t.line.paragraph,this.getHyperLinkFieldInternal(n,t,i,e,!1)),i=[],r},a.prototype.getHyperLinkFields=function(e,t,i,n){for(var r=0;r<this.documentHelper.fields.length;r++)if(-1===t.indexOf(this.documentHelper.fields[r])&&!_.isNullOrUndefined(this.documentHelper.fields[r].fieldSeparator)){t.push(this.documentHelper.fields[r]);var o=(o=this.getFieldCode(this.documentHelper.fields[r])).trim().toLowerCase(),s=this.paragraphIsInFieldResult(this.documentHelper.fields[r],e);if((i||!i&&o.match("hyperlink "))&&s)return this.documentHelper.fields[r];if(s&&n&&this.documentHelper.fields[r].formFieldData)return this.documentHelper.fields[r];if((i||!i&&o.match("ref "))&&s)return this.documentHelper.fields[r]}},a.prototype.getHyperLinkFieldInternal=function(e,t,i,n,r){for(var o=0;o<this.documentHelper.fields.length;o++)if(-1===i.indexOf(this.documentHelper.fields[o])&&!_.isNullOrUndefined(this.documentHelper.fields[o].fieldSeparator)){i.push(this.documentHelper.fields[o]);var s=(s=this.getFieldCode(this.documentHelper.fields[o])).trim().toLowerCase(),a=this.documentHelper.fields[o],l=a.fieldEnd,l=(n&&a.nextNode instanceof J&&a.nextNode.reference&&(l=a.nextNode.reference),this.inlineIsInFieldResult(a,l,a.fieldSeparator,t,n)||this.isImageField());if((n||!n&&s.match("hyperlink "))&&l)return this.documentHelper.fields[o];if(l&&r&&this.documentHelper.fields[o].formFieldData)return this.documentHelper.fields[o];if((n||!n&&s.match("ref "))&&l)return this.documentHelper.fields[o]}if(e.containerWidget instanceof z&&!(e instanceof Xd))return this.getHyperLinkFieldInternal(e.containerWidget,t,i,n,r)},a.prototype.getBlock=function(e){var t,i,n;if(""!==e&&!_.isNullOrUndefined(e))return t=this.start.getPage(e={index:e}),n=e.index.indexOf(";"),i=e.index.substring(0,n),e.index=e.index.substring(n).replace(";",""),n=t.bodyWidgets[parseInt(i,10)],this.getBlockInternal(n,e.index)},a.prototype.getBlockInternal=function(e,t){var i,n,r;if(""!==t&&!_.isNullOrUndefined(t))return n=t.indexOf(";"),r=t.substring(0,n),t=t.substring(n).replace(";",""),i=e,0<=(n=parseInt(r,10))&&n<e.childWidgets.length?(r=e.childWidgets[n],0<=t.indexOf(";")?r instanceof G?(0<=t.indexOf(";")&&(t="0"),r):r instanceof Qd?this.getBlockInternal(r,t):i:r):i},a.prototype.inlineIsInFieldResult=function(e,t,i,n,r){return!(_.isNullOrUndefined(t)||_.isNullOrUndefined(i)||!this.isExistBeforeInline(i,n))&&this.isExistAfterInline(t,n,r)},a.prototype.paragraphIsInFieldResult=function(e,t){if(!_.isNullOrUndefined(e.fieldEnd)&&!_.isNullOrUndefined(e.fieldSeparator)){var i=e.fieldSeparator.line.paragraph;if(e.fieldSeparator.line.paragraph===t||this.isExistBefore(i,t))return e.fieldEnd.line.paragraph!==t&&this.isExistAfter(i,t)}return!1},a.prototype.isImageField=function(){if(!this.start.paragraph.isEmpty()&&!this.end.paragraph.isEmpty()){var e=this.start,t=this.end,e=(this.isForward||(e=this.end,t=this.start),e.paragraph.getInline(e.offset,0)),i=e.element;(n=e.index)===i.length&&(i=this.getNextRenderedElementBox(i,n));t=(e=t.paragraph.getInline(t.offset,n)).element;if(e.index,i instanceof Z&&0===i.fieldType&&t instanceof Z&&1===t.fieldType&&i.fieldSeparator){var n=i.fieldSeparator.nextNode;if(n instanceof Ic&&n.nextNode===t)return!0}}return!1},a.prototype.isFormField=function(){var e=this.currentFormField;return!!(e instanceof Z&&e.formFieldData)},a.prototype.isReferenceField=function(e){if(e=_.isNullOrUndefined(e)?this.getHyperlinkField(!0):e){var t=(t=this.getFieldCode(e)).toLowerCase();if(e instanceof Z&&t.match("ref "))return!0}return!1},a.prototype.isInlineFormFillMode=function(e){return!!(this.documentHelper.isInlineFormFillProtectedMode&&(e=_.isNullOrUndefined(e)?this.currentFormField:e,e=_.isNullOrUndefined(e)?this.getCurrentFormField():e)&&e.formFieldData instanceof Ch&&"Text"===e.formFieldData.type)},a.prototype.getFormFieldType=function(e){if((e=_.isNullOrUndefined(e)?this.currentFormField:e)instanceof Z){if(e.formFieldData instanceof Ch)return"Text";if(e.formFieldData instanceof Fh)return"CheckBox";if(e.formFieldData instanceof Sh)return"DropDown"}},a.prototype.getCurrentFormField=function(e){var t;if(e||this.documentHelper.isFormFillProtectedMode&&this.owner.documentEditorSettings.formFieldSettings&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode)for(var i=0;i<this.documentHelper.formFields.length;i++){var n=this.documentHelper.formFields[i],r=this.start,o=this.end;if(this.isForward||(r=this.end,o=this.start),j.isLinkedFieldCharacter(n)){var s=n.fieldSeparator.line.getOffset(n.fieldSeparator,1),a=new y(this.owner),l=(a.setPositionParagraph(n.fieldSeparator.line,s),n.fieldEnd),s=l.line.getOffset(l,0),d=new y(this.owner);if(d.setPositionParagraph(l.line,s),(r.isExistAfter(a)||r.isAtSamePosition(a))&&(o.isExistBefore(d)||o.isAtSamePosition(d))){t=n;break}}}else t=this.getHyperlinkField(!0);if(t instanceof Z&&0===t.fieldType&&!_.isNullOrUndefined(t.formFieldData))return t},a.prototype.getCurrentTextFrame=function(){var e=this.start.paragraph.containerWidget;do{if(e instanceof fc)return e}while(e=e&&e.containerWidget);return null},a.prototype.isTableSelected=function(e){var t=this.start,i=this.end;if(this.isForward||(t=this.end,i=this.start),_.isNullOrUndefined(t.paragraph.associatedCell)||_.isNullOrUndefined(i.paragraph.associatedCell))return!1;var n=t.paragraph.associatedCell.ownerTable.getSplitWidgets(),r=this.getFirstBlockInFirstCell(n[0]),n=this.getLastBlockInLastCell(n[n.length-1]);if(e){for(var o=n.associatedCell.ownerTable;o.containerWidget instanceof N;)o=o.containerWidget.ownerTable;n=this.getLastBlockInLastCell(o)}return t.paragraph.associatedCell.equals(r.associatedCell)&&i.paragraph.associatedCell.equals(n.associatedCell)&&(!r.associatedCell.equals(n.associatedCell)||0===t.offset&&i.offset===this.getLineLength(n.lastChild)+1)},a.prototype.selectListText=function(){var e=this.documentHelper.selectionLineWidget.getHierarchicalIndex("0"),t=this.getTextPosition(e),e=this.getTextPosition(e);this.isSelectList=!0,this.selectRange(t,e),this.isSelectList=!1,this.highlightListText(this.documentHelper.selectionLineWidget),this.contextTypeInternal="List"},a.prototype.highlightListText=function(e){var t=e.children[0].width,i=this.documentHelper.getLeftValue(e),n=e.paragraph.y;this.createHighlightBorder(e,t,i,n,!1),this.documentHelper.isListTextSelected=!0},a.prototype.updateImageSize=function(e){this.owner.isShiftingEnabled=!0;var t,i=this.start,n=this.end,r=(this.isForward||(i=this.end,n=this.start),null),o=i.paragraph;o===n.paragraph&&i.offset+1===n.offset&&(r=(i=o.getInline(n.offset,0)).element,i.index),(r instanceof Ic||r instanceof uc)&&(n=r.width,i=r.height,t=r.alternateText,r.width=e.width,r.height=e.height,r.alternateText=e.alternatetext,e.width=n,e.height=i,e.alternatetext=t,null!==o)&&null!==o.containerWidget&&this.owner.editorModule&&(n=o.childWidgets.indexOf(r.line),i=r.line.children.indexOf(r),this.documentHelper.layout.reLayoutParagraph(o,n,i),this.highlightSelection(!1))},a.prototype.getSelectedCellsInTable=function(e,t,i){for(var n=t.columnIndex,r=i.columnIndex+i.cellFormat.columnSpan-1,o=t.ownerRow.index,s=i.ownerRow.index,a=[],l=0;l<e.childWidgets.length;l++){var d=e.childWidgets[l];if(d.index>=o&&d.index<=s)for(var h=0;h<d.childWidgets.length;h++){var c=d.childWidgets[h];c.columnIndex>=n&&c.columnIndex<=r&&a.push(c)}if(d.index>s)break}return a},a.prototype.copy=function(){this.isEmpty||this.copySelectedContent(!1)},a.prototype.copySelectedContent=function(e){_.isNullOrUndefined(this.owner.sfdtExportModule)||(this.htmlContent=this.getHtmlContent(),this.documentHelper.isCopying=!0,this.copyToClipboard(),this.documentHelper.isCopying=!1,e&&this.owner.editorModule&&this.owner.editorModule.handleCut(this),this.owner.enableAutoFocus&&this.documentHelper.updateFocus())},a.prototype.writeSfdt=function(){var e=this.start,t=this.end;return this.isForward||(e=this.end,t=this.start),this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,e.currentWidget,e.offset,t.currentWidget,t.offset,!0)},a.prototype.getHtmlContent=function(){var e=this.writeSfdt(),t=(this.sfdtContent=JSON.stringify(e),this.owner.editorModule&&(this.owner.editorModule.copiedData=JSON.stringify(e)),this.owner.documentEditorSettings.optimizeSfdt);return this.htmlWriter.writeHtml(e,t)},a.prototype.copyToClipboard=function(e){window.getSelection().removeAllRanges();var t,i=navigator.vendor&&-1<navigator.vendor.indexOf("Apple")&&navigator.userAgent&&-1<navigator.userAgent.indexOf("Macintosh")&&-1<navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome"),n=/Android|Windows Phone|iPhone|Trident|webOS/i.test(navigator.userAgent)||i,r=document.createElement("div"),i=(r.style.left="-10000px",r.style.top="-10000px",r.style.position="relative",_.isNullOrUndefined(e)?i&&(r.innerText="copy"):r.innerHTML=e,n?document.body.appendChild(r):((t=document.createElement("div")).attachShadow({mode:"open"}).appendChild(r),document.body.appendChild(t)),void 0!==navigator&&-1!==navigator.userAgent.indexOf("Firefox")&&(r.contentEditable="true"),document.createRange()),e=(i.selectNodeContents(r),window.getSelection().addRange(i),!1);try{e=document.execCommand("copy")}catch(e){}finally{window.getSelection().removeAllRanges(),r.parentNode.removeChild(r),n||t.parentNode.removeChild(t)}return e},a.prototype.onCopy=function(e){e.clipboardData&&!_.isNullOrUndefined(this.htmlContent)&&(e.clipboardData.clearData(),e.clipboardData.setData("text/html",this.htmlContent),e.clipboardData.setData("text/plain",this.text),e.clipboardData.setData("application/json",JSON.stringify(this.sfdtContent)),this.htmlContent=void 0,this.sfdtContent=void 0)},a.prototype.showCaret=function(){var e,t,i,n,r=_.isNullOrUndefined(this.documentHelper.currentPage)?this.documentHelper.currentRenderingPage:this.documentHelper.currentPage;_.isNullOrUndefined(r)||this.documentHelper.isRowOrCellResizing||this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||(e=r.boundingRectangle.x,r=this.viewer instanceof Sd?r.boundingRectangle.width*this.documentHelper.zoomFactor+e:r.boundingRectangle.width-this.owner.viewer.padding.right-this.documentHelper.scrollbarWidth,this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||(this.isHideSelection(this.start.paragraph)?this.caret.style.display="none":this.isEmpty&&(!this.owner.isReadOnly||this.owner.enableCursorOnReadOnly||this.isInlineFormFillMode())?(t=parseInt(this.caret.style.left.replace("px",""),10),this.caret.style.display=t<e||r<t?"none":"block"):this.isImageSelected&&!this.owner.enableImageResizerMode?this.caret.style.display="block":"block"!==this.caret.style.display&&!_.isNullOrUndefined(this)||this.documentHelper.isComposingIME||(this.caret.style.display="none")),_.isNullOrUndefined(this)||!this.documentHelper.isTouchInput||this.owner.isReadOnlyMode?(this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none"):(t=parseInt(this.documentHelper.touchStart.style.left.replace("px",""),10)+14,i=parseInt(this.documentHelper.touchEnd.style.left.replace("px",""),10)+14,(n=this.getSelectionPage(this.start))&&(this.documentHelper.touchEnd.style.display=i<e||r<i?"none":"block",this.isEmpty||(e=n.boundingRectangle.x,r=n.boundingRectangle.width*this.documentHelper.zoomFactor+e),this.documentHelper.touchStart.style.display=t<e||r<t?"none":"block")))},a.prototype.setEditableDivCaretPosition=function(e){this.documentHelper.editableDiv.focus();var t,i=this.documentHelper.editableDiv.childNodes[this.documentHelper.editableDiv.childNodes.length-1];i&&((t=document.createRange()).setStart(i,e),t.collapse(!0),window.getSelection().removeAllRanges(),window.getSelection().addRange(t))},a.prototype.initCaret=function(){this.caret=_.createElement("div",{styles:"position:absolute",className:"e-de-blink-cursor e-de-cursor-animation"}),this.caret.style.display="none",this.owner.documentHelper.viewerContainer.appendChild(this.caret)},a.prototype.updateCaretPosition=function(){var e,t,i,n=this.end.location,r=this.getSelectionPage(this.end);r&&!_.isNullOrUndefined(this.caret)&&(this.caret.style.left=r.boundingRectangle.x+Math.round(n.x)*this.documentHelper.zoomFactor+"px",t=(e=this.updateCaretSize(this.owner.selectionModule.end)).topMargin,i=this.viewer,i=(r.boundingRectangle.y-i.pageGap*(this.documentHelper.pages.indexOf(r)+1))*this.documentHelper.zoomFactor+i.pageGap*(this.documentHelper.pages.indexOf(r)+1),this.caret.style.top=i+Math.round(n.y+t)*this.documentHelper.zoomFactor+"px","Subscript"===this.owner.selectionModule.characterFormat.baselineAlignment&&(this.caret.style.top=parseFloat(this.caret.style.top)+parseFloat(this.caret.style.height)/2+"px"),!this.documentHelper.isTouchInput&&"none"===this.documentHelper.touchStart.style.display||(this.documentHelper.touchStart.style.left=r.boundingRectangle.x+(Math.round(n.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchStart.style.top=i+(n.y+e.height)*this.documentHelper.zoomFactor+"px",this.documentHelper.touchEnd.style.left=r.boundingRectangle.x+(Math.round(n.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchEnd.style.top=i+(n.y+e.height)*this.documentHelper.zoomFactor+"px")),this.showHidePasteOptions(this.caret.style.top,this.caret.style.left)},a.prototype.showHidePasteOptions=function(e,t){_.Browser.isIE||(this.isViewPasteOptions?this.pasteElement&&"block"===this.pasteElement.style.display||this.createPasteElement(e,t):this.pasteElement&&(this.pasteElement.style.display="none",_.isNullOrUndefined(this.owner.editorModule)||(this.owner.editorModule.isHtmlPaste=!1)))},a.prototype.getRect=function(e){var t,i,n,r=e.location,e=this.getSelectionPage(e);return e?(t=this.owner.documentHelper,i=e.boundingRectangle.x+Math.round(r.x)*t.zoomFactor,n=this.viewer.pageGap,n=(e.boundingRectangle.y-n*(e.index+1))*t.zoomFactor+n*(e.index+1)+Math.round(r.y)*t.zoomFactor,new nl(i,n)):new nl(0,0)},a.prototype.getSelectionPage=function(e){e=this.getLineWidgetInternal(e.currentWidget,e.offset,!0);if(e)return this.getPage(e.paragraph)},a.prototype.updateCaretSize=function(e,t){var i,n,r,o=0,s=!1,a=0,l=0;return this.characterFormat.italic&&(s=this.characterFormat.italic),e.paragraph.isEmpty()?(r=e.paragraph,o=(r=this.getParagraphMarkSize(r,o,0)).topMargin,r.bottomMargin,i=r=r.height,l=(o="Normal"!==(n=this.characterFormat.baselineAlignment)&&(i/=1.5,"Subscript"===n)?r-i:o)<0?o+i:i,t||(this.caret.style.height=l*this.documentHelper.zoomFactor+"px"),o=0):(a=(n=e.currentWidget.getInline(e.offset,0)).index,r=n.element,_.isNullOrUndefined(r)||(l=(i=this.getCaretHeight(r,a,r.characterFormat,!0,o,s)).height,t)||(this.caret.style.height=i.height*this.documentHelper.zoomFactor+"px")),t||(this.caret.style.transform=s?"rotate(13deg)":""),{topMargin:o,height:l}},a.prototype.updateCaretToPage=function(e,t){_.isNullOrUndefined(t)||(this.documentHelper.selectionEndPage=t,this.owner.selectionModule.isEmpty?this.documentHelper.selectionStartPage=t:(t=this.getLineWidgetParagraph(e.offset,e.paragraph.childWidgets[0]),e=this.getPage(t.paragraph),_.isNullOrUndefined(e)||(this.documentHelper.selectionStartPage=e))),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},a.prototype.getCaretBottom=function(e,t){var i,n,r,o,s=e.location.y;return e.paragraph.isEmpty()?(r=e.paragraph,r=(n=this.getParagraphMarkSize(r,r=0,o=0)).topMargin,o=n.bottomMargin,s=s+n.height+r,t||(s+=o)):(i=(o=e.paragraph.getInline(e.offset,n=0)).element,n=o.index,r=(o=this.getCaretHeight(i,n,i.characterFormat,!1,r=0,!1)).topMargin,o.isItalic,s+=o.height,t&&(s-=j.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(e.paragraph)))),s},a.prototype.checkForCursorVisibility=function(){this.showCaret()},a.prototype.onKeyDownInternal=function(e,t,i,n){var r,o,s=e.which||e.keyCode;if(this.owner.focusIn(),!t||i||n)if(!i||t||n)if(i&&t&&!n)switch(s){case 32:this.owner.editorModule.insertText(String.fromCharCode(160));break;case 35:this.handleControlShiftEndKey();break;case 36:this.handleControlShiftHomeKey();break;case 37:this.handleControlShiftLeftKey();break;case 38:this.handleControlShiftUpKey();break;case 39:this.handleControlShiftRightKey();break;case 40:this.handleControlShiftDownKey();break;case 56:this.owner.toggleShowHiddenMarksInternal()}else switch(s){case 33:e.preventDefault(),this.handlePageUpPageDownKey(!1,i);break;case 34:e.preventDefault(),this.handlePageUpPageDownKey(!0,i);break;case 35:this.handleEndKey(),e.preventDefault();break;case 36:this.handleHomeKey(),e.preventDefault();break;case 37:this.handleLeftKey(),e.preventDefault();break;case 38:this.handleUpKey(),e.preventDefault();break;case 39:this.handleRightKey(),e.preventDefault();break;case 40:this.handleDownKey(),e.preventDefault()}else switch(this.documentHelper.isCompleted=!1,s){case 33:e.preventDefault(),this.handlePageUpPageDownKey(!1,i);break;case 34:e.preventDefault(),this.handlePageUpPageDownKey(!0,i);break;case 35:this.handleShiftEndKey(),e.preventDefault();break;case 36:this.handleShiftHomeKey(),e.preventDefault();break;case 37:this.handleShiftLeftKey(),e.preventDefault();break;case 38:this.handleShiftUpKey(),e.preventDefault();break;case 39:this.handleShiftRightKey(),e.preventDefault();break;case 40:this.handleShiftDownKey(),e.preventDefault()}else switch(this.documentHelper.isControlPressed=!0,s){case 35:this.handleControlEndKey();break;case 36:this.handleControlHomeKey();break;case 37:this.handleControlLeftKey();break;case 38:this.handleControlUpKey();break;case 39:this.handleControlRightKey();break;case 40:this.handleControlDownKey();break;case 65:this.owner.selectionModule.selectAll();break;case 67:e.preventDefault(),this.copy();break;case 70:e.preventDefault(),_.isNullOrUndefined(this.owner.optionsPaneModule)||(this.owner.documentEditorSettings.showNavigationPane=!0,this.owner.optionsPaneModule.showHideOptionsPane(!0))}this.isFormField()&&!this.documentHelper.isDocumentProtected&&(s=this.getCurrentFormField(!0))&&s.formFieldData instanceof Sh&&(s=37===e.keyCode||38===e.keyCode||40===e.keyCode?s:s.nextElement instanceof J?s.nextElement.reference:s.fieldEnd,r=39===e.keyCode?1:0,o=s.line.getOffset(s,r),o=this.getPhysicalPositionInternal(s.line,o,!1),this.selectInternal(s.line,s,r,o)),(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode||this.isInlineFormFillMode()||this.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.owner.editor.canEditContentControl&&!_.isNullOrUndefined(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked()||this.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.documentHelper.protectionType&&(9===e.keyCode||32===e.keyCode))&&this.owner.editorModule.onKeyDownInternal(e,t,i,n),this.owner.searchModule&&!_.isNullOrUndefined(this.owner.searchModule.searchHighlighters)&&0<this.owner.searchModule.searchHighlighters.length&&this.owner.searchModule.searchResults.clear(),27!==e.keyCode&&27!==e.which||(_.isNullOrUndefined(this.owner.optionsPaneModule)||(this.owner.optionsPaneModule.showHideOptionsPane(!1),this.documentHelper.updateFocus()),this.owner.enableHeaderAndFooter&&this.disableHeaderFooter())},a.prototype.checkAndEnableHeaderFooter=function(e,t){var i=this.documentHelper.currentPage;if(this.isCursorInsidePageRect(e,i)){if(this.isCursorInHeaderRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.headerWidget,i);if(this.isCursorInFooterRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.footerWidget,i)}return!!this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1,this.documentHelper.updateTextPositionForSelection(t,1),!0)},a.prototype.isCursorInsidePageRect=function(e,t){return this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width*this.documentHelper.zoomFactor&&this.viewer instanceof Sd||this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width},a.prototype.isCursorInHeaderRegion=function(e,t){if(this.viewer instanceof Sd){var i=this.getPageTop(t),n=0,r=t.headerWidget,r=(r&&(n=r.y+r.height),r.isEmpty&&!this.owner.enableHeaderAndFooter),o=j.convertPointToPixel(t.bodyWidgets[0].sectionFormat.topMargin),t=j.convertPointToPixel(t.bodyWidgets[0].sectionFormat.pageHeight),r=r?o:Math.min(Math.max(n,o),t/100*40);if(r*=this.documentHelper.zoomFactor,this.viewer.containerTop+e.y>=i&&this.viewer.containerTop+e.y<=i+r)return!0}return!1},a.prototype.isCursorInFooterRegion=function(e,t){if(this.viewer instanceof Sd){var i=t.boundingRectangle,n=this.getPageTop(t),r=n+i.height*this.documentHelper.zoomFactor,o=j.convertPointToPixel(t.bodyWidgets[0].sectionFormat.footerDistance),s=0,a=(t.footerWidget&&(s=t.footerWidget.height),j.convertPointToPixel(t.bodyWidgets[0].sectionFormat.bottomMargin)),t=t.footerWidget.isEmpty&&!this.owner.enableHeaderAndFooter,l=i.height,l=t?(l-a)*this.documentHelper.zoomFactor:(l-Math.min(i.height/100*40,Math.max(s+o,a)))*this.documentHelper.zoomFactor;if(this.viewer.containerTop+e.y<=r&&this.viewer.containerTop+e.y>=n+l)return!0}return!1},a.prototype.enableHeadersFootersRegion=function(e,t){return this.viewer instanceof Sd&&(this.owner.enableHeaderAndFooter=!0,e.page=t,this.comparePageWidthAndMargins(e,t),this.updateTextPositionForBlockContainer(e),this.shiftBlockOnHeaderFooterEnableDisable(),!0)},a.prototype.disableXml=function(){var e=this.getPage(this.start.paragraph);this.updateTextPositionForBlockContainer(e.bodyWidgets[0]),this.owner.enableHeaderAndFooter=!1,this.shiftBlockOnHeaderFooterEnableDisable()},a.prototype.comparePageWidthAndMargins=function(e,t){var i,n,r=-1!=e.headerFooterType.indexOf("Header"),o=!1,t=r?t.headerWidgetIn:t.footerWidgetIn;_.isNullOrUndefined(t)||(i=e.sectionFormat,n=t.sectionFormat,_.isNullOrUndefined(i)||_.isNullOrUndefined(n)||(r?e.width==t.width&&i.headerDistance==n.headerDistance||(o=!0):e.width==t.width&&i.footerDistance==n.footerDistance||(o=!0)),o&&(this.owner.viewer.updateHFClientArea(e.sectionFormat,r),this.documentHelper.layout.layoutHeaderFooterItems(this.owner.viewer,e)))},a.prototype.shiftBlockOnHeaderFooterEnableDisable=function(){for(var e=0;e<this.documentHelper.headersFooters.length;e++){var t=this.documentHelper.headersFooters[e],i=this.getBodyWidgetInternal(e,0);if(!_.isNullOrUndefined(i))for(var n=i.sectionFormat,r=0,o=Object.keys(t);r<o.length;r++){var s=t[o[r]];s.isEmpty&&this.owner.editorModule.shiftPageContent(s.headerFooterType,n)}}},a.prototype.updateTextPositionForBlockContainer=function(e){e=e.firstChild;e instanceof K&&(e=this.getFirstBlockInFirstCell(e))instanceof K&&(e=this.getFirstBlockInFirstCell(e)),this.selectParagraphInternal(e,!0)},a.prototype.disableHeaderFooter=function(){var e=this.getPage(this.start.paragraph);this.updateTextPositionForBlockContainer(e.bodyWidgets[0]),this.owner.enableHeaderAndFooter=!1,this.shiftBlockOnHeaderFooterEnableDisable()},a.prototype.clear=function(){this.editRegionHighlighters&&this.editRegionHighlighters.clear(),this.editRangeCollection=[],this.selectedWidgets&&this.selectedWidgets.clear()},a.prototype.destroy=function(){_.isNullOrUndefined(this.contextTypeInternal)||(this.contextTypeInternal=void 0),this.pasteDropDwn&&(this.pasteDropDwn.destroy(),this.pasteDropDwn=void 0),this.caret=void 0,this.contextTypeInternal=void 0,this.upDownSelectionLength=void 0,this.owner=void 0,this.upDownSelectionLength=void 0,this.isSkipLayouting=void 0,this.isImageSelected=void 0,_.isNullOrUndefined(this.documentHelper)||(this.documentHelper=void 0),this.contextTypeInternal=void 0,this.isRetrieveFormatting=void 0,this.characterFormatIn&&this.characterFormatIn.destroy(),this.characterFormatIn=void 0,this.paragraphFormatIn&&this.paragraphFormatIn.destroy(),this.paragraphFormatIn=void 0,this.sectionFormatIn&&this.sectionFormatIn.destroy(),this.sectionFormatIn=void 0,this.tableFormatIn&&this.tableFormatIn.destroy(),this.tableFormatIn=void 0,this.cellFormatIn&&this.cellFormatIn.destroy(),this.cellFormatIn=void 0,this.rowFormatIn&&this.rowFormatIn.destroy(),this.rowFormatIn=void 0,this.imageFormatInternal=void 0,this.skipFormatRetrieval=void 0,this.startInternal=void 0,this.endInternal=void 0,this.htmlWriterIn=void 0,this.toolTipElement=void 0,_.isNullOrUndefined(this.toolTipObject)||this.toolTipObject.destroy(),this.toolTipField=void 0,this.isMoveDownOrMoveUp=void 0,this.pasteElement=void 0,this.currentPasteAction=void 0,this.isViewPasteOptions=void 0,this.skipEditRangeRetrieval=void 0,this.editPosition=void 0,_.isNullOrUndefined(this.selectedWidgets)||this.selectedWidgets.destroy(),this.isHighlightEditRegionIn=void 0,this.isHighlightFormFields=void 0,this.editRangeCollection=[],this.editRangeCollection=void 0,this.isHightlightEditRegionInternal=void 0,this.isCurrentUser=void 0,this.isHighlightNext=void 0,this.hightLightNextParagraph=void 0,this.isWebLayout=void 0,_.isNullOrUndefined(this.editRegionHighlighters)||this.editRegionHighlighters.destroy(),_.isNullOrUndefined(this.formFieldHighlighters)||this.formFieldHighlighters.destroy(),this.isCellPrevSelected=void 0,this.currentFormField=void 0},a.prototype.getCellsToSelect=function(e,t,i,n){var r=e.childWidgets;if(!(_.isNullOrUndefined(n.paragraph.associatedCell)||!_.isNullOrUndefined(n.reference)&&_.isNullOrUndefined(n.reference.paragraph.associatedCell))){for(var e=n.paragraph.associatedCell.ownerRow.rowIndex,o=n.reference.paragraph.associatedCell.ownerRow.rowIndex,s=[],a=e;a<=o;a++)for(var l=r[a],d=t;d<=i;d++){var h=l.childWidgets[d];_.isNullOrUndefined(h)||s.push(h)}return s}},a.prototype.selectBookmarkInTable=function(e){this.documentHelper.clearSelectionHighlight();var t=parseInt(e.properties.columnFirst),i=parseInt(e.properties.columnLast),n=e.paragraph.associatedCell.ownerTable,r=this.getCellsToSelect(n,t,i,e);if(!_.isNullOrUndefined(r))for(var o=0;o<r.length;o++)this.highlightCellWidget(r[o])},a.prototype.navigateBookmark=function(e,t,i){var n,r=this.documentHelper.bookmarks;r.containsKey(e)&&(r=r.get(e),_.isNullOrUndefined(r.properties)?(e=r.line.getOffset(r,0),i&&e++,(n=new y(this.owner)).setPositionParagraph(r.line,e),t?this.documentHelper.selection.selectRange(n,n,!0):(e=r.reference,t=(e=r.reference&&null==r.reference.line.paragraph.bodyWidget?r:e).line.getOffset(e,1),e instanceof J&&!i&&(_.isNullOrUndefined(e.properties)||e.properties.isAfterParagraphMark&&(t=e.line.getOffset(e,1))),i&&t--,(i=new y(this.owner)).setPositionParagraph(e.line,t),this.documentHelper.selection.selectRange(n,i,!0))):this.selectBookmarkInTable(r))},a.prototype.selectBookmark=function(e,t){this.isSelectBookmark=!0,this.isExcludeBookmarkStartEnd=t,this.navigateBookmark(e,void 0,t),this.isSelectBookmark=!1},a.prototype.getTocField=function(){for(var e=this.start.paragraph,t=void 0;void 0!==e&&this.isTocStyle(e);)e=(t=e).previousRenderedWidget;if(void 0!==t){var i=t.childWidgets[0];if(void 0!==i)return i.children[0]}},a.prototype.isTocStyle=function(e){e=e.paragraphFormat.baseStyle;return void 0!==e&&-1!==e.name.toLowerCase().indexOf("toc")},a.prototype.isTOC=function(){for(var e=this.getParagraphInfo(this.start).paragraph,t=0;t<e.childWidgets[0].children.length;t++){var i=e.childWidgets[0].children[t];if(i instanceof Z){i=this.owner.selectionModule.getFieldCode(i);if(i.match("TOC ")||i.match("Toc"))return!0}}return!1},a.prototype.getElementsForward=function(e,t,i,n){if(!_.isNullOrUndefined(t)){for(var r=[],o=e.children.indexOf(t);0<=o;){for(var s=o;s<e.children.length;s++){var a=e.children[s];if(a.line!==e){o=-1;break}if(a===i){r.push(a),o=-1;break}r.push(a)}o=-1}return 0===r.length?void 0:r}},a.prototype.getElementsBackward=function(e,t,i,n){for(var r=[];n&&t&&t.previousElement&&(!t.isRightToLeft||t instanceof X&&this.documentHelper.textHelper.isRTLText(t.text));)t=t.previousElement;for(var o=e.children.indexOf(t);0<=o;){for(var s=o;-1<s&&s<e.children.length;n?s++:s--){var a=e.children[s];if(a.line!==e){o=-1;break}if(r.push(a),a===i){o=-1;break}}o=-1}return r},a.prototype.navigatePreviousComment=function(){this.commentNavigateInternal(!1)},a.prototype.navigateNextComment=function(){this.commentNavigateInternal(!0)},a.prototype.commentNavigateInternal=function(e){if(!this.documentHelper.currentSelectedComment){if(0===this.documentHelper.comments.length)return;this.documentHelper.currentSelectedComment=this.documentHelper.comments[0]}var t,i,n;this.documentHelper.currentSelectedComment&&(t=this.documentHelper.comments,n=this.documentHelper.currentSelectedComment,i=t.indexOf(n),n=e?i===t.length-1?t[0]:t[i+1]:0===i?t[t.length-1]:t[i-1],this.documentHelper.currentSelectedComment=n,this.selectComment(n))},a.prototype.navigatePreviousRevision=function(){this.revisionNavigateInternal(!1)},a.prototype.navigateNextRevision=function(){this.revisionNavigateInternal(!0)},a.prototype.revisionNavigateInternal=function(e){if(!this.documentHelper.currentSelectedRevisionInternal){if(0===this.documentHelper.owner.revisions.length)return;this.documentHelper.currentSelectedRevision=this.documentHelper.owner.revisions.get(0)}var t,i,n;this.documentHelper.currentSelectedRevision&&(t=this.documentHelper.owner.revisions.changes,n=this.documentHelper.currentSelectedRevision,i=t.indexOf(n),n=e?i===t.length-1?t[0]:t[i+1]:0===i?t[t.length-1]:t[i-1],this.documentHelper.currentSelectedRevision=n,this.selectRevision(n)),this.owner.trackChangesPane.currentSelectedRevision=this.documentHelper.currentSelectedRevision},a.prototype.selectComment=function(e){var t,i;_.isNullOrUndefined(e)||(t=this.getElementPosition(e.commentStart,!0).startPosition,i=this.getElementPosition(e.commentEnd,!1).startPosition,this.owner.commentReviewPane&&this.owner.commentReviewPane.selectComment(e),this.selectPosition(t,i))},a.prototype.selectRevision=function(e,t,i){var n=!1;if(_.isNullOrUndefined(t)&&_.isNullOrUndefined(i)&&(n=!0),!_.isNullOrUndefined(e)&&0<e.range.length){var r=e.range[0],e=e.range[e.range.length-1],o=void 0;if(r instanceof B?o=r.ownerBase:r instanceof Ya||(o=r.line.paragraph),_.isNullOrUndefined(o)||_.isNullOrUndefined(o.bodyWidget)||!(o.bodyWidget instanceof Xd)||!_.isNullOrUndefined(o.bodyWidget.page)&&(_.isNullOrUndefined(o.bodyWidget.page)||-1!==o.bodyWidget.page.index))if(r instanceof Ya){var o=r.ownerBase,s=o.childWidgets[0],o=o.childWidgets[o.childWidgets.length-1],s=this.getFirstParagraph(s),o=this.getLastParagraph(o);this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(o.lastChild,o.lastChild.getEndOffset()+1),this.selectPosition(this.start,this.end)}else if(r&&e){_.isNullOrUndefined(t)&&(t=new y(this.owner));var a=0;if(r instanceof B){var l,a=1<(l=r.ownerBase).childWidgets.length?this.getParagraphLength(l)-this.getParagraphLength(l,l.lastChild):this.isEmptyWidget(l)?0:l.getLength();t.setPositionParagraph(l.lastChild,a)}else{a=r.line.getOffset(r,0);var d=r.line;if(d.isFirstLine())for(var h=0;h<d.children.length;h++){if(r===d.children[h]&&d.children[h]instanceof X&&!(d.children[h]instanceof Bh)){a=0;break}if(d.children[h]instanceof X)break}t.setPositionForLineWidget(r.line,a)}_.isNullOrUndefined(i)&&(i=new y(this.owner)),e instanceof B?(((l=(s=(l=e.ownerBase).getSplitWidgets())[s.length-1]).isEndsWithPageBreak||l.isEndsWithColumnBreak)&&(this.owner.trackChangesPane.isTrackingPageBreak=!0),a=1<l.childWidgets.length?this.getParagraphLength(l)-this.getParagraphLength(l,l.lastChild):l.getLength(),i.setPositionParagraph(l.lastChild,a+1)):(a=e.line.getOffset(e,0)+e.length,this.isTOC()&&(a+=1),i.setPositionForLineWidget(e.line,a));o=t.clone();t.isExistBefore(i)||(t=i,i=o),n&&this.selectPosition(t,i)}}},a.prototype.isEmptyWidget=function(e){if(e instanceof K)return!1;if(!e.isEmpty())for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++)if(i.children[n]instanceof X)return!1;return!0},a.prototype.selectTableRevision=function(e){var t;!_.isNullOrUndefined(e)&&0<e[0].range.length&&(t=e[0].range[0],e=e[e.length-1].range[0],t instanceof Ya)&&(t=t.ownerBase.childWidgets[0],e=(e=e.ownerBase).childWidgets[e.childWidgets.length-1],t=this.getFirstParagraph(t),e=this.getLastParagraph(e),this.start.setPosition(t.firstChild,!0),this.end.setPositionParagraph(e.lastChild,e.lastChild.getEndOffset()+1),this.selectPosition(this.start,this.end))},a.prototype.updateEditRangeCollection=function(){if(0<this.editRangeCollection.length&&(this.editRangeCollection=[]),this.documentHelper.isDocumentProtected){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser)){r=this.documentHelper.editRanges.get(this.owner.currentUser);for(i=0;i<r.length;i++)this.editRangeCollection.push(r[i])}if(this.documentHelper.editRanges.containsKey("Everyone"))for(var e="Everyone",t=this.documentHelper.editRanges.get(e),i=0;i<t.length;i++)this.editRangeCollection.push(t[i])}else for(var n=0;n<this.documentHelper.editRanges.length;n++)for(var e=this.documentHelper.editRanges.keys[n],r=this.documentHelper.editRanges.get(e),i=0;i<r.length;i++)this.editRangeCollection.push(r[i])},a.prototype.onHighlight=function(){this.isHighlightEditRegion?this.highlightEditRegion():this.unHighlightEditRegion(),this.viewer.renderVisiblePages()},a.prototype.onHighlightContentControl=function(){if(this.isHighlightContentControlEditRegionIn&&0<this.documentHelper.contentControlCollection.length)for(var e=0;e<this.documentHelper.contentControlCollection.length;e++)this.documentHelper.contentControlCollection[e].paragraph.isInHeaderFooter&&"Continuous"===this.documentHelper.owner.layoutType||this.highlightContentControlEditRegionInternal(this.documentHelper.contentControlCollection[e])},a.prototype.highlightContentControlEditRegionInternal=function(e){for(var t=this.getPosition(e),i=t.startPosition,n=t.endPosition,r=(this.highlight(e.line.paragraph,i,n,e),e.line.paragraph);r!==n.paragraph;){if(!(r.nextRenderedWidget instanceof G))return;r=r.nextRenderedWidget,this.highlight(r,i,n,e)}},a.prototype.selectPlaceHolderText=function(e){e.contentControlProperties&&e.contentControlProperties.hasPlaceHolderText&&("RichText"===e.contentControlProperties.type||"Text"===e.contentControlProperties.type)&&this.selectContentControlInternal(e)},a.prototype.isPlainContentControl=function(){var e=this.owner.editorModule.getContentControl();return!(!e||!e.contentControlProperties||"Text"!==e.contentControlProperties.type)},a.prototype.highlightEditRegion=function(){if(this.updateEditRangeCollection(),this.owner.enableLockAndEdit)this.viewer.updateScrollBars();else if(this.isHighlightEditRegion){this.isHightlightEditRegionInternal=!0,_.isNullOrUndefined(this.editRegionHighlighters)&&(this.editRegionHighlighters=new T),this.editRegionHighlighters.clear();for(var e=0;e<this.editRangeCollection.length;e++)this.highlightEditRegionInternal(this.editRangeCollection[e]);this.isHightlightEditRegionInternal=!1,this.viewer.updateScrollBars()}else this.unHighlightEditRegion()},a.prototype.highlightFormFields=function(){_.isNullOrUndefined(this.formFieldHighlighters)&&(this.formFieldHighlighters=new T),this.formFieldHighlighters.clear();var e=this.documentHelper.formFields;if(!_.isNullOrUndefined(e)&&0<e.length){for(var t=0;t<e.length;t++){var i,n,r,o=e[t];j.isLinkedFieldCharacter(o)&&(n=o.line.getOffset(o,0),(i=new y(this.owner)).setPositionParagraph(o.line,n),n=(o=o.fieldEnd).line.getOffset(o,1),(r=new y(this.owner)).setPositionParagraph(o.line,n),this.isHighlightFormFields=!0,this.highlight(i.paragraph,i,r),this.isHighlightNext)&&(this.highlightNextBlock(this.hightLightNextParagraph,i,r),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)}this.isHighlightFormFields=!1,this.viewer.updateScrollBars()}},a.prototype.unHighlightEditRegion=function(){_.isNullOrUndefined(this.editRegionHighlighters)||(this.editRegionHighlighters.clear(),this.editRegionHighlighters=void 0),this.isHightlightEditRegionInternal=!1},a.prototype.highlightEditRegionInternal=function(e){var t=this.getPosition(e),i=t.startPosition,t=t.endPosition;this.isCurrentUser=!0,this.highlightEditRegions(e,i,t),this.isCurrentUser=!1},a.prototype.showAllEditingRegion=function(){0===this.editRangeCollection.length&&this.updateEditRangeCollection(),this.documentHelper.clearSelectionHighlight();for(var e=0;e<this.editRangeCollection.length;e++){var t=this.editRangeCollection[e],i=this.getPosition(t),n=i.startPosition,i=i.endPosition;this.highlightEditRegions(t,n,i)}},a.prototype.highlightEditRegions=function(e,t,i){if(!e.line.paragraph.isInsideTable||e.line.paragraph.isInsideTable&&!e.editRangeEnd.line.paragraph.isInsideTable||-1===e.columnFirst)this.highlight(e.line.paragraph,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0);else{var n=e.line.paragraph.associatedCell.ownerRow.childWidgets[e.columnFirst];if(n)for(var r=0;r<n.childWidgets.length;r++)n.childWidgets[r]instanceof G&&(this.highlight(n.childWidgets[r],t,i),this.isHighlightNext)&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)}},a.prototype.navigateToNextEditingRegion=function(){var e,t,i=this.getEditRangeStartElement(!0);0<this.editRangeCollection.length&&(this.sortEditRangeCollection(),t=e=this.editRangeCollection.length,i=(t=_.isNullOrUndefined(i)?t:this.editRangeCollection.indexOf(i))<e-1?this.editRangeCollection[t+1]:this.editRangeCollection[0],t=(e=this.getPosition(i,!0)).startPosition,i=e.endPosition,this.selectRange(t,i))},a.prototype.sortEditRangeCollection=function(){for(var e=this.editRangeCollection.length-1;0<=e;e--)for(var t=1;t<=e;t++){var i=this.getPosition(this.editRangeCollection[t-1]).startPosition,n=this.getPosition(this.editRangeCollection[t]).startPosition;i.isExistAfter(n)&&(i=this.editRangeCollection[t-1],this.editRangeCollection[t-1]=this.editRangeCollection[t],this.editRangeCollection[t]=i)}},a.prototype.toggleEditingRegionHighlight=function(){this.isHighlightEditRegion=!this.isHighlightEditRegion},a.prototype.getEditRangeStartElement=function(e){for(var t=0;t<this.editRangeCollection.length;t++){var i=this.editRangeCollection[t],n=this.getPosition(i,e),r=n.startPosition,n=n.endPosition;if((this.start.isExistAfter(r)||this.start.isAtSamePosition(r))&&(this.end.isExistBefore(n)||this.end.isAtSamePosition(n)))return i}},a.prototype.isSelectionInEditRegion=function(){return!!this.documentHelper.isDocumentProtected&&this.checkSelectionIsAtEditRegion()},a.prototype.checkSelectionIsAtEditRegion=function(e,t){_.isNullOrUndefined(e)&&_.isNullOrUndefined(t)&&(e=this.start,t=this.end,this.isForward||(e=this.end,t=this.start)),0<this.editRangeCollection.length&&this.isFootEndNoteParagraph(e.paragraph)&&this.isFootEndNoteParagraph(t.paragraph)&&e.paragraph.containerWidget==t.paragraph.containerWidget&&(t=e=this.getElementPosition(e.paragraph.containerWidget.footNoteReference,!0).startPosition);for(var i=0;i<this.editRangeCollection.length;i++){var n=this.editRangeCollection[i];if(!n.line.paragraph.isInsideTable||n.line.paragraph.isInsideTable&&!n.editRangeEnd.line.paragraph.isInsideTable||-1===n.columnFirst){if(this.isSelectionInsideEditRange(n,e,t))return!0}else if(n.paragraph.isInsideTable&&n.editRangeEnd&&n.editRangeEnd.line.paragraph.isInsideTable){var r=n.paragraph.associatedCell.ownerRow,o=e.paragraph.associatedCell,s=t.paragraph.associatedCell;if(!_.isNullOrUndefined(o)&&!_.isNullOrUndefined(s)&&r.equals(o.ownerRow)&&r.equals(s.ownerRow)&&o.index>=n.columnFirst&&o.index<=n.columnLast)if(this.isEmpty&&o.index===n.line.paragraph.associatedCell.index){if(this.isSelectionInsideEditRange(n,e,t))return!0}else if(!this.isCellSelected(o,e,t))return!0}}return!1},a.prototype.isEditRangeCellSelected=function(e,t){_.isNullOrUndefined(e)&&_.isNullOrUndefined(t)&&(e=this.start,t=this.end,this.isForward||(e=this.end,t=this.start));for(var i=0;i<this.editRangeCollection.length;i++){var n=this.editRangeCollection[i];if(n.paragraph.isInsideTable&&n.editRangeEnd&&n.editRangeEnd.line.paragraph.isInsideTable){var r=e.paragraph.associatedCell,o=t.paragraph.associatedCell,s=n.paragraph.associatedCell;if(!_.isNullOrUndefined(r)&&!_.isNullOrUndefined(o)&&r.index>=n.columnFirst&&r.index<=n.columnLast&&this.isCellSelected(s,e,t))return!0}}return!1},a.prototype.isSelectionInsideEditRange=function(e,t,i){var e=this.getPosition(e),n=e.startPosition,e=e.endPosition;return!(!t.isExistAfter(n)&&!t.isAtSamePosition(n)||!i.isExistBefore(e)&&!i.isAtSamePosition(e))},a.prototype.getPosition=function(e,t){var i,n,r=e.line.getOffset(e,1),o=new y(this.owner);return o.setPositionParagraph(e.line,r),e instanceof Wc?i=e.editRangeEnd:e instanceof E||e instanceof J?i=e.reference:e instanceof up&&(i=e.comment.commentEnd),i&&(e=i.line,_.isNullOrUndefined(i.line)||_.isNullOrUndefined(e.children)?n=o.clone():(r=i.line.getOffset(i,t?0:1),(n=new y(this.owner)).setPositionParagraph(i.line,r))),{startPosition:o,endPosition:n}},a.prototype.checkContentControlLocked=function(e){this.owner.editorModule.isXmlMapped=!1;for(var t=0;t<this.documentHelper.contentControlCollection.length;t++){var i=this.documentHelper.contentControlCollection[t];if(!_.isNullOrUndefined(i.reference)&&-1!==i.reference.indexInOwner){var n=this.getPosition(i),r=n.startPosition,n=n.endPosition,o=this.start,s=this.end;if(this.isForward||(o=this.end,s=this.start),_.isNullOrUndefined(e)){var a=(r.isExistAfter(o)||r.isAtSamePosition(o))&&(r.isExistBefore(s)||r.isAtSamePosition(s)),l=(n.isExistAfter(o)||n.isAtSamePosition(o))&&(n.isExistBefore(s)||n.isAtSamePosition(s));if(a&&l)return!!i.contentControlProperties.lockContentControl&&(this.owner.trigger(pe),!0);if((a||l)&&!r.isAtSamePosition(o)&&!n.isAtSamePosition(o)&&(i.contentControlProperties.lockContentControl||i.contentControlProperties.lockContents))return!0}if((o.isExistAfter(r)||o.isAtSamePosition(r))&&(s.isExistBefore(n)||s.isAtSamePosition(n))){if(i.contentControlProperties.xmlMapping&&i.contentControlProperties.xmlMapping.isMapped&&(this.owner.editorModule.isXmlMapped=!0),i.contentControlProperties.lockContents)return this.owner.trigger(pe),!0;if(_.isNullOrUndefined(e)&&("CheckBox"===i.contentControlProperties.type||"ComboBox"===i.contentControlProperties.type||"DropDownList"===i.contentControlProperties.type||"Date"===i.contentControlProperties.type||"Picture"===i.contentControlProperties.type||"Text"===i.contentControlProperties.type||"RichText"===i.contentControlProperties.type))return this.owner.trigger(pe),!0}}}return!1},a.prototype.getElementPosition=function(e,t){var t=e.line.getOffset(e,t?0:1),i=new y(this.owner);return i.setPositionParagraph(e.line,t),{startPosition:i,endPosition:void 0}},a.prototype.updateRefField=function(e){var t,i,n,r,o;_.isNullOrUndefined(e)&&(e=this.getHyperlinkField(!0)),_.isNullOrUndefined(e)||this.isReferenceField(e)&&0===(o=(o=this.getFieldCode(e).replace(/\s+/g," ")).trim()).toLowerCase().indexOf("ref")&&1<(o=o.split(" ")).length&&(o=o[1],this.documentHelper.bookmarks.containsKey(o))&&(t=this.start,i=this.end,this.isForward||(t=this.end,i=this.start),r=(o=this.documentHelper.bookmarks.get(o)).reference,n=o.previousNode,!_.isNullOrUndefined(n)&&n instanceof Z||!r||!(r.previousNode instanceof Z)||1!==r.previousNode.fieldType||_.isNullOrUndefined(r.previousNode.fieldBegin)||_.isNullOrUndefined(r.previousNode.fieldBegin.formFieldData)?n instanceof Z&&0===n.fieldType&&!_.isNullOrUndefined(n.formFieldData)&&(o=n.fieldSeparator,r=n.fieldEnd):(o=r.previousNode.fieldBegin.fieldSeparator,r=r.previousNode.fieldBegin.fieldEnd),n=o.line.getOffset(o,1),t.setPositionParagraph(o.line,n),i.setPositionParagraph(r.line,r.line.getOffset(r,0)),o=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,t.currentWidget,t.offset,i.currentWidget,i.offset,!1,!0),n=e.fieldSeparator,r=e.fieldEnd,t.setPositionParagraph(n.line,n.line.getOffset(n,1)),i.setPositionParagraph(r.line,r.line.getOffset(r,0)),this.owner.editorModule.pasteContents(o))},a.prototype.footnoteReferenceElement=function(e,t,i){var n=0;if(this.getContainerWidget(e.paragraph)instanceof q)for(var r=this.start.paragraph.bodyWidget.footNoteReference,o=0;o<this.documentHelper.pages.length;o++)for(var s=this.documentHelper.pages[o],a=n=0;a<s.bodyWidgets.length;a++)for(var l=s.bodyWidgets[a],d=0;d<l.childWidgets.length;d++){var h=l.childWidgets[d];if(h instanceof K)for(var c=0;c<h.childWidgets.length;c++)for(var p=h.childWidgets[c],u=0;u<p.childWidgets.length;u++)for(var g=p.childWidgets[u],m=0;m<g.childWidgets.length;m++)for(var f=g.childWidgets[m],y=0;y<f.childWidgets.length;y++){var v=f.childWidgets[y],n=0;if(!_.isNullOrUndefined(v.children))for(var w=0;w<v.children.length;w++)n+=(x=v.children[w]).length,x instanceof Bh&&x===r&&(e.setPositionParagraph(v,n-1),t.setPositionParagraph(v,n),this.selectRange(e,t))}else for(var b=0;b<h.childWidgets.length;b++){v=h.childWidgets[b];if(n=0,!_.isNullOrUndefined(v.children))for(var x,w=0;w<v.children.length;w++)n+=(x=v.children[w]).length,x instanceof Bh&&x===r&&(e.setPositionParagraph(v,n-1),t.setPositionParagraph(v,n),this.selectRange(e,t))}}},a.prototype.getAbsolutePositionFromRelativePosition=function(e){var e="string"==typeof e?this.getTextPosBasedOnLogicalIndex(e):e,e=this.getParagraphInfo(e),t={position:0,done:!1};return this.getPositionInfoForHeaderFooter(e,t),t.position},a.prototype.getPositionInfoForBodyContent=function(e,t,i,n){i=_.isNullOrUndefined(i)?this.documentHelper.pages[0].bodyWidgets[0].childWidgets[0]:i;return t.position+=this.getBlockIndex(i,e,t,n),t},a.prototype.getPositionInfoForHeaderFooter=function(e,t,i){return(t=this.getPositionInfoForBodyContent(e,t,void 0,i)).done||this.getBlockIndexFromHeaderFooter(e,t,i),t},a.prototype.getBlockIndexFromHeaderFooter=function(e,t,i){for(var n=0,r=this.documentHelper.headersFooters;n<r.length;n++)for(var o=r[n],s=0;s<6;s++){var a=o[s];if(a){if(t.position+=this.getBlockIndex(a.childWidgets[0],e,t,i),t.done)return t}else t.position+=1}return t},a.prototype.getBlockIndex=function(e,t,i,n){var r=0,o={length:0};do{if(e instanceof G&&!_.isNullOrUndefined(t)&&!_.isNullOrUndefined(t.paragraph)&&t.paragraph.equals(e)){r+=1;var s=e.getInline(t.offset,0);r+=this.getBlockOffsetByElement(t,e,s.element,s.index,o),i.done=!0;break}if(r=this.getBlockLength(t,e,r,i,!0,n,o),i.done)break;if(!_.isNullOrUndefined(e))if(e.containerWidget instanceof z&&e.containerWidget.containerWidget instanceof q){s=e.getSplitWidgets().pop().nextRenderedWidget;if(!_.isNullOrUndefined(s)&&e.containerWidget!==s.containerWidget)break;e=s}else e=e.getSplitWidgets().pop().nextRenderedWidget}while(e);return r},a.prototype.getBlockTotalLength=function(e,t,i,n,r){for(var o=0,s=!1,a=e.getSplitWidgets(),l=0;l<a.length;l++)for(var d=0;d<a[l].childWidgets.length;d++)for(var h=a[l].childWidgets[d],c=0;c<h.children.length;c++){var p=h.children[c];if(!(p instanceof Y)){if((p instanceof uc||p instanceof Bh)&&(p instanceof uc?0<p.textFrame.childWidgets.length&&(o+=this.getBlockIndex(p.textFrame.childWidgets[0],t,i,void 0)):o+=this.getBlockIndex(p.bodyWidget.childWidgets[0],t,i,void 0),i.done))return o;(s=p instanceof Z&&0==p.fieldType&&p.formFieldData instanceof Sh?!0:s)&&p instanceof Z&&1==p.fieldType&&p.previousNode instanceof X&&(r.length+=p.previousNode.length,s=!1),p.skipformFieldLength||(o+=p.length)}}return o},a.prototype.getBlockLength=function(e,t,i,n,r,o,s){var a;if(e&&t instanceof G&&!_.isNullOrUndefined(e.paragraph)&&e.paragraph.equals(t))i+=1,a=t.getInline(e.offset,0),i+=this.getBlockOffsetByElement(e,t,a.element,a.index,s),this.isEndOffset&&t.isInsideTable&&t.associatedCell.lastChild.equals(t)&&e.offset===this.getParagraphLength(t)+1&&(i+=1),n.done=!0;else if(t instanceof G)i=(i+=1)+(r?this.getBlockTotalLength(t,e,n,o,s):t.getTotalLength());else if(t instanceof K){if(i+=1,!_.isNullOrUndefined(o)&&o instanceof K&&o.equals(t))return n.done=!0,i;for(var l=t.firstChild;l;){if(i+=1,!_.isNullOrUndefined(o)&&o instanceof dh&&o.equals(l))return n.done=!0,i;for(var d=l.firstChild;d;){if(i+=1,!_.isNullOrUndefined(o)&&o instanceof N&&o.equals(d))return n.done=!0,i;for(var h=d.firstChild;h;){if(i=this.getBlockLength(e,h,i,n,r,o,s),n.done)return i;h=h.getSplitWidgets().pop().nextRenderedWidget}d=d.nextWidget}var c=l.ownerTable.index;(l=l.getSplitWidgets().pop().nextRenderedWidget)&&l.ownerTable.index!==c&&(l=void 0)}}return i},a.prototype.calculateCellLength=function(e){for(var t=e.firstChild,i=0,n={done:!1},r={paragraph:null,offset:0};t;)i=this.getBlockLength(r,t,i,n,!0,void 0,void 0),t=t.getSplitWidgets().pop().nextRenderedWidget;return i},a.prototype.getBlockOffsetByElement=function(e,t,i,n,r){for(var o=0,s=!1,a=t.getSplitWidgets(),l=0;l<a.length;l++)for(var d=0;d<a[l].childWidgets.length;d++)for(var h=a[l].childWidgets[d],c=0;c<h.children.length;c++){var p=h.children[c];if(!(p instanceof Y)){if((s=p instanceof Z&&0==p.fieldType&&p.formFieldData instanceof Sh?!0:s)&&p instanceof Z&&1==p.fieldType&&p.previousNode instanceof X&&(r.length+=p.previousNode.length,s=!1),p===i)return o+n;if(p instanceof uc||p instanceof Bh)if(p instanceof uc){if(0<p.textFrame.childWidgets.length)for(var u=0;u<p.textFrame.childWidgets.length;u++)o=this.getBlockLength(e,p.textFrame.childWidgets[u],o,{done:!1},!1,void 0,void 0)}else if(0<p.bodyWidget.childWidgets.length)for(u=0;u<p.bodyWidget.childWidgets.length;u++)o=this.getBlockLength(e,p.bodyWidget.childWidgets[u],o,{done:!1},!1,void 0,void 0);p.skipformFieldLength||(o+=p.length)}}return o},a.prototype.getTableRelativeValue=function(e,t){if(e.currentWidget.paragraph.isInsideTable){if(this.isTableSelected())return 3;if(this.isRowSelect()&&t.paragraph.isInsideTable&&e.paragraph.associatedCell.ownerTable.equals(t.paragraph.associatedCell.ownerTable))return 2;var i=e.paragraph.associatedCell.ownerTable.getSplitWidgets(),i=this.getFirstBlockInFirstCell(i[0]);if(e.paragraph.associatedCell.equals(i.associatedCell)){if(t.paragraph.isInsideTable){if(e.paragraph.associatedCell.ownerTable.equals(t.paragraph.associatedCell.ownerTable))return 0;for(var n=this.isRowSelect()?2:3,r=e.paragraph.associatedCell.ownerTable;r.containerWidget instanceof N&&(n+=3,!(r=r.containerWidget.ownerTable).equals(t.paragraph.associatedCell.ownerTable)););return n}return 3}return t.currentWidget.paragraph.isInsideTable&&e.paragraph.associatedCell.ownerTable.equals(t.paragraph.associatedCell.ownerTable)?0:2}return 0},a.prototype.isRowSelect=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),_.isNullOrUndefined(e.paragraph.associatedCell)||_.isNullOrUndefined(t.paragraph.associatedCell)||e.paragraph.associatedCell.equals(t.paragraph.associatedCell)||this.isTableSelected(!0))return!1;var i=!1;if((n=t.paragraph.associatedCell.ownerTable).containerWidget instanceof N)for(;n.containerWidget instanceof N;)for(var n=n.containerWidget.ownerTable,r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];o.childWidgets[o.childWidgets.length-1].equals(n.containerWidget)&&(i=!0)}else for(r=0;r<n.childWidgets.length;r++){var s=n.childWidgets[r];s.childWidgets[s.childWidgets.length-1].equals(t.paragraph.associatedCell)&&(i=!0)}var a,l=e.paragraph.associatedCell.ownerRow.getSplitWidgets();return 0<l[0].childWidgets.length&&(a=l[0].childWidgets[0]),e.paragraph.associatedCell.equals(a)&&i};var _m=a;function a(e){var i=this;this.upDownSelectionLength=0,this.isSkipLayouting=!1,this.isImageSelected=!1,this.isExcludeBookmarkStartEnd=!1,this.contextTypeInternal=void 0,this.caret=void 0,this.isRetrieveFormatting=!1,this.skipFormatRetrieval=!1,this.isModifyingSelectionInternally=!1,this.isMoveDownOrMoveUp=!1,this.isSelectBookmark=!1,this.htmlContent=void 0,this.sfdtContent=void 0,this.isEndOffset=!1,this.isViewPasteOptions=!1,this.skipEditRangeRetrieval=!1,this.selectedWidgets=void 0,this.isHighlightEditRegionIn=!1,this.isHighlightContentControlEditRegionIn=!1,this.isHighlightFormFields=!1,this.isHightlightEditRegionInternal=!1,this.isCurrentUser=!1,this.isHighlightNext=!1,this.isWebLayout=!1,this.contentControlHighlighters=void 0,this.editRegionHighlighters=void 0,this.contentControleditRegionHighlighters=void 0,this.formFieldHighlighters=void 0,this.isSelectList=!1,this.previousSelectedFormField=void 0,this.isFormatUpdated=!1,this.isCellPrevSelected=!1,this.currentFormField=void 0,this.pasteOptions=function(e){var t=new _.L10n("documenteditor",i.owner.defaultLocale);t.setLocale(i.owner.locale),e.item.text===t.getConstant("Keep source formatting")?i.owner.editorModule.applyPasteOptions("KeepSourceFormatting"):e.item.text===t.getConstant("Match destination formatting")?i.owner.editorModule.applyPasteOptions("MergeWithExistingFormatting"):e.item.text===t.getConstant("NestTable")?i.owner.editorModule.applyTablePasteOptions("NestTable"):e.item.text===t.getConstant("InsertAsRows")?i.owner.editorModule.applyTablePasteOptions("InsertAsRows"):e.item.text===t.getConstant("InsertAsColumns")?i.owner.editorModule.applyTablePasteOptions("InsertAsColumns"):e.item.text===t.getConstant("OverwriteCells")?i.owner.editorModule.applyTablePasteOptions("OverwriteCells"):i.owner.editorModule.applyPasteOptions("KeepTextOnly")},this.hideCaret=function(){_.isNullOrUndefined(i.caret)||(i.caret.style.display="none")},this.owner=e,this.documentHelper=this.owner.documentHelper,this.start=new y(this.owner),this.end=new y(this.owner),this.selectedWidgets=new T,this.characterFormatIn=new bm(this),this.paragraphFormatIn=new Pm(this,this.documentHelper),this.sectionFormatIn=new Nm(this),this.rowFormatIn=new Rm(this),this.cellFormatIn=new Lm(this),this.tableFormatIn=new Om(this),this.imageFormatInternal=new Am(this),this.editRangeCollection=[],this.editRegionHighlighters=new T,this.contentControleditRegionHighlighters=new T,this.formFieldHighlighters=new T,this.contentControleditRegionHighlighters=new T}Gm.prototype.getModuleName=function(){return"SpellChecker"},Object.defineProperty(Gm.prototype,"enableOptimizedSpellCheck",{get:function(){return this.performOptimizedCheck},set:function(e){this.performOptimizedCheck=e},enumerable:!0,configurable:!0}),Object.defineProperty(Gm.prototype,"uniqueWordsCount",{get:function(){return _.isNullOrUndefined(this.uniqueWordsCountInternal)?0:this.uniqueWordsCountInternal},set:function(e){this.uniqueWordsCountInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(Gm.prototype,"languageID",{get:function(){return _.isNullOrUndefined(this.langIDInternal)?0:this.langIDInternal},set:function(e){this.langIDInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(Gm.prototype,"allowSpellCheckAndSuggestion",{get:function(){return this.spellSuggestionInternal},set:function(e){this.spellSuggestionInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(Gm.prototype,"removeUnderline",{get:function(){return this.removeUnderlineInternal},set:function(e){this.removeUnderlineInternal=e,this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(Gm.prototype,"enableSpellCheck",{get:function(){return this.enableSpellCheckInternal},set:function(e){this.enableSpellCheckInternal=e,this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(Gm.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Gm.prototype.manageReplace=function(e,t){this.documentHelper.triggerSpellCheck=!0;if(!_.isNullOrUndefined(t)&&t instanceof Ah){var i=t.text;if(this.documentHelper.selection.start=t.start.clone(),this.documentHelper.selection.end=t.end.clone(),"Ignore Once"!==e)return e=this.manageSpecialCharacters(i,e),this.documentHelper.owner.editorModule.insertTextInternal(e,!0),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),void this.documentHelper.clearSelectionHighlight();this.currentContextInfo={text:i,element:t}}!_.isNullOrUndefined(this.currentContextInfo)&&this.currentContextInfo.element&&"Ignore Once"!==e?(i=this.currentContextInfo.element,this.currentContextInfo.element.text,this.documentHelper.selection.start=i.start.clone(),this.documentHelper.selection.end=i.end.clone()):this.handleReplace(e),"Ignore Once"!==e&&(this.documentHelper.owner.editorModule.insertTextInternal(e,!0),_.isNullOrUndefined(this.currentContextInfo)||this.removeErrorsFromCollection(this.currentContextInfo),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),this.documentHelper.clearSelectionHighlight()),this.documentHelper.triggerSpellCheck=!1},Gm.prototype.handleReplace=function(e){for(var t,i=this.documentHelper.selection.start,n=i.offset,r=i.currentWidget.getInline(n,0,!1,!0),o=(r.element.line.getOffset(r.element,0)+r.element.length===n&&this.retrieveExactElementInfo(r),r.element.text),s=new RegExp("^[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\`\\s]+","g"),a=[];!_.isNullOrUndefined(t=s.exec(o));)a.push(t);if("Ignore Once"===e)this.handleIgnoreOnce(r);else{i.offset=n-r.index,!_.isNullOrUndefined(a)&&0<a.length&&(i.offset+=a[0].toString().length),i.location=this.documentHelper.owner.selectionModule.getPhysicalPositionInternal(i.currentWidget,i.offset,!0),(i=this.documentHelper.owner.searchModule.textSearch.getTextPosition(i.currentWidget,i.offset.toString())).setPositionParagraph(i.currentWidget,i.offset);for(var e=i.offset+r.element.length-i.offset,n=i.currentWidget.getOffset(r.element,e),e=i.currentWidget,l=new RegExp("[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\s\\`]+$","g"),a=[];!_.isNullOrUndefined(t=l.exec(o));)a.push(t);!_.isNullOrUndefined(a)&&0<a.length&&(n-=a[0].toString().length),this.documentHelper.selection.end=this.documentHelper.owner.searchModule.textSearch.getTextPosition(e,n.toString()),this.documentHelper.selection.end.location=this.documentHelper.owner.selectionModule.getPhysicalPositionInternal(i.currentWidget,n,!0),this.documentHelper.selection.end.setPositionParagraph(e,n),this.currentContextInfo={element:r.element,text:r.element.text}}},Gm.prototype.retrieveExactElementInfo=function(e){var t=e.element.nextElement;!_.isNullOrUndefined(t)&&t instanceof X&&""!=t.text.trim()&&(e.element=t)},Gm.prototype.handleIgnoreOnce=function(e){var e=e.element,t="",t=(!_.isNullOrUndefined(this.currentContextInfo)&&this.currentContextInfo.element?this.currentContextInfo.element:e).text;t=this.manageSpecialCharacters(t,void 0,!0),-1===e.ignoreOnceItems.indexOf(t)&&e.ignoreOnceItems.push(t),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection)},Gm.prototype.handleIgnoreAllItems=function(e){var e=_.isNullOrUndefined(e)?this.retriveText():e,t=this.manageSpecialCharacters(e.text,void 0,!0);-1===this.ignoreAllItems.indexOf(t)&&(this.ignoreAllItems.push(t),this.removeErrorsFromCollection(e),this.documentHelper.triggerSpellCheck=!0,this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection),this.documentHelper.triggerSpellCheck=!1,this.documentHelper.clearSelectionHighlight())},Gm.prototype.handleAddToDictionary=function(e){var t=this,i=_.isNullOrUndefined(e)?this.retriveText():e,n=this.manageSpecialCharacters(i.text,void 0,!0);this.callSpellChecker(this.languageID,n,!1,!1,!0).then(function(e){_.isNullOrUndefined(t.documentHelper)||(t.documentHelper.triggerSpellCheck=!0,t.removeErrorsFromCollection(i),t.ignoreAllItems.push(n),t.documentHelper.owner.editorModule.reLayout(t.documentHelper.selection,!0),t.documentHelper.triggerSpellCheck=!1)})},Gm.prototype.manageSpecialCharacters=function(e,t,i){if(!_.isNullOrUndefined(e)){_.isNullOrUndefined(t)&&(t=e);for(var n=new RegExp("^[#\\@\\!\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\”'\\,\\<\\.\\>\\/\\?\\`\\s\\’]+","g"),r=[],o=void 0;!_.isNullOrUndefined(o=n.exec(e));)r.push(o);if(0<r.length)for(var s=0;s<r.length;s++){var a=r[s];t=i?t.replace(a[0],""):a[0]+t}var l=new RegExp("[#\\@\\!\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\”'\\,\\<\\.\\>\\/\\?\\s\\`\\’]+$","g"),r=[],d=t;for(i||(d=e);!_.isNullOrUndefined(o=l.exec(d));)r.push(o);if(0<r.length)for(s=0;s<r.length;s++){a=r[s];t=i?t.slice(0,a.index):t+a[0]}}return t},Gm.prototype.removeErrorsFromCollection=function(e){var t;!_.isNullOrUndefined(e.text)&&this.errorWordCollection.containsKey(e.text)&&(0<=(t=this.errorWordCollection.get(e.text)).indexOf(e.element)&&t.splice(0,1),0===t.length)&&this.errorWordCollection.remove(e.text)},Gm.prototype.retriveText=function(){var e,t,i,n;return!_.isNullOrUndefined(this.currentContextInfo)&&this.currentContextInfo.element?(i=this.currentContextInfo.element,n=this.currentContextInfo.element.text,this.documentHelper.selection.start=i.start.clone(),this.documentHelper.selection.end=i.end.clone()):(e=(t=this.documentHelper.selection.start).offset,i=(t=t.currentWidget.getInline(e,0)).element,n=t.element.text),{text:n,element:i}},Gm.prototype.handleSuggestions=function(e){this.spellCheckSuggestion=[],0!==e.length&&(e=3<e.length?this.constructInlineMenu(e):e),this.spellCheckSuggestion.push(this.documentHelper.owner.contextMenuModule.locale.getConstant("Add to Dictionary"));var t=[];if(0<this.spellCheckSuggestion.length)for(var i=0,n=this.spellCheckSuggestion;i<n.length;i++){var r=n[i];t.push({text:r,id:this.documentHelper.owner.element.id+"_contextmenu_otherSuggestions_spellcheck_"+(r===this.documentHelper.owner.contextMenuModule.locale.getConstant("Add to Dictionary")?"Add to Dictionary":r),iconCss:""})}return t},Gm.prototype.checktextElementHasErrors=function(e,t,i){var n=!1,r=[];if(e=e.replace(/[\s]+/g,""),!_.isNullOrUndefined(t.errorCollection)&&0<t.errorCollection.length){if(!this.documentHelper.isScrollHandler&&(t.ischangeDetected||t.paragraph.isChangeDetected))return this.updateStatusForGlobalErrors(t.errorCollection,t),t.errorCollection=[],t.ischangeDetected=!0,{errorFound:n,elements:r};for(var o=0;o<t.errorCollection.length;o++)this.handleErrorCollection(t.errorCollection[o])&&(n=!0,r.push(t.errorCollection[o]))}else!this.documentHelper.isScrollHandler&&t.paragraph.isChangeDetected?t.ischangeDetected=!0:!t.ischangeDetected&&this.handleErrorCollection(t)&&(n=!0,r.push(t));return{errorFound:n,elements:r}},Gm.prototype.updateStatusForGlobalErrors=function(e,t){if(0<e.length)for(var i=0;i<e.length;i++){var n=this.manageSpecialCharacters(e[i].text,void 0,!0);if(this.errorWordCollection.containsKey(n))for(var r=this.errorWordCollection.get(n),o=0;o<r.length;o++)if(r[o]instanceof Ah&&r[o]===e[i]){r[o].ischangeDetected=!0,r[o].start.offset=t.line.getOffset(t.istextCombined?this.getCombinedElement(t):t,0),r[o].line=t.line;break}}},Gm.prototype.handleErrorCollection=function(e){var t=this.errorWordCollection,i=this.manageSpecialCharacters(e.text,void 0,!0);return!(!(t.containsKey(i)&&1<e.length)||-1<this.ignoreAllItems.indexOf(i)&&(t.containsKey(i)&&t.remove(i),1))},Gm.prototype.constructInlineMenu=function(e){for(var t=e.length-1;0<t;t--)3<e.length&&(this.spellCheckSuggestion.push(e[t]),e.pop());return e},Gm.prototype.findCurretText=function(){var e,t,i=this.documentHelper.selection.start,n=i.currentWidget.getInline(this.documentHelper.selection.start.offset,0);if(!_.isNullOrUndefined(n.element)){if(!_.isNullOrUndefined(n.element.errorCollection)&&0<n.element.errorCollection.length)for(var r=0;r<n.element.errorCollection.length;r++){var o=n.element.errorCollection[r];if(o.start.location.x<=i.location.x&&o.end.location.x>=i.location.x){t=o.text,e=o;break}}else t=n.element.text;" "===t&&(t=(n=i.currentWidget.getInline(this.documentHelper.selection.start.offset+1,0)).element.text)}return{text:t,element:e}},Gm.prototype.addErrorCollection=function(e,t,i){var n;e=this.manageSpecialCharacters(e,void 0,!0),this.errorWordCollection.containsKey(e)?(n=this.errorWordCollection.get(e),t instanceof Ah?this.compareErrorTextElement(t,n)||n.push(t):t instanceof X&&(this.compareTextElement(t,n)||n.push(t))):(!_.isNullOrUndefined(i)&&0<i.length&&this.errorSuggestions.add(e,i),this.errorWordCollection.add(e,[t]),this.uniqueWordsCollection.containsKey(e)||this.uniqueWordsCollection.add(e,!0))},Gm.prototype.addCorrectWordCollection=function(e){e=this.manageSpecialCharacters(e,void 0,!0),this.uniqueWordsCollection.containsKey(e)||this.uniqueWordsCollection.add(e,!1)},Gm.prototype.isInUniqueWords=function(e){return e=e.replace(/[\s]+/g,""),this.uniqueWordsCollection.containsKey(e)},Gm.prototype.isErrorWord=function(e){return e=e.replace(/[\s]+/g,""),this.uniqueWordsCollection.get(e)},Gm.prototype.isCorrectWord=function(e){return e=e.replace(/[\s]+/g,""),!this.uniqueWordsCollection.get(e)},Gm.prototype.compareErrorTextElement=function(e,t){for(var i=[],n=!1,r=0;r<t.length;r++)i.push(t[r]);for(var o=t.length,r=0;r<o;r++)if(i[r]instanceof Ah)if(i[r].ischangeDetected){var s=this.manageSpecialCharacters(i[r].text,void 0,!0),n=!0;this.removeErrorsFromCollection({element:i[r],text:s})}else{s=i[r];if(e.start.offset===s.start.offset&&e.end.offset===s.end.offset)return!0}return n&&this.errorWordCollection.add(this.manageSpecialCharacters(e.text,void 0,!0),[e]),!1},Gm.prototype.compareTextElement=function(e,t){for(var i=0;i<t.length;i++)if(t[i]instanceof X)if(t[i]===e)return!0;return!1},Gm.prototype.handleWordByWordSpellCheck=function(e,t,i,n,r,o,s){e.HasSpellingError&&s?(this.addErrorCollection(t.text,t,e.Suggestions),s=(t.line.paragraph.containerWidget instanceof N?t.line.paragraph.containerWidget.cellFormat.shading:this.documentHelper).backgroundColor,this.documentHelper.render.renderWavyLine(t,i,n,r,"#FF0000","Single",o,s)):this.addCorrectWordCollection(t.text),t.isSpellChecked=!0},Gm.prototype.checkElementCanBeCombined=function(e,t,i,n,r,o,s,a){var l=_.isNullOrUndefined(r)?"":r,d=!_.isNullOrUndefined(a)&&a,a=!!_.isNullOrUndefined(s)||s,o=!!_.isNullOrUndefined(o)||o,h=[],c=this.documentHelper.selection.getLineWidget(e,0),p=c.children.indexOf(e),u=e.text;h.push(e);var g=!1,m=!1;if("\v"!==e.text){if(a){for(var f=void 0,y=p-(s?0:1);0<=y;y--)if((f=c.children[y])instanceof X&&!m){if(0!==u.indexOf(" ")&&f.text.lastIndexOf(" ")!==f.text.length-1)g=!_.isNullOrUndefined(r),l=f.text+l,u=f.text,m=!1,h.push(f),d=!0;else if(!_.isNullOrUndefined(f)){f=f.nextElement;break}}else f instanceof Z&&1!==f.fieldType&&(m=!0);var v=d?f:e;if(this.lookThroughPreviousLine(l,u,v,t,i))return!0}s?l=g?l:e.text+l:l+=e.text;var m=!1,w=e.text;if(o){for(var b=!1,x=void 0,y=p+1;y<c.children.length;y++)if((x=c.children[y])instanceof X&&!m){if(w.lastIndexOf(" ")!==w.length-1&&0!==x.text.indexOf(" "))l+=x.text,w=x.text,m=!1,h.push(x),d=b=!0;else if(!_.isNullOrUndefined(x)){x=x.previousElement;break}}else x instanceof Z&&2!==x.fieldType&&(m=!0);if("\f"!==(v=b?x:e).text&&v.text!==String.fromCharCode(14)&&this.lookThroughNextLine(l,u,v,t,i))return!0}}return d&&n&&!this.checkCombinedElementsBeIgnored(h,l)&&this.handleCombinedElements(e,l,t,i),d},Gm.prototype.lookThroughPreviousLine=function(e,t,i,n,r){if(!_.isNullOrUndefined(i)&&0===i.indexInOwner&&!_.isNullOrUndefined(i.line.previousLine)){var o=i.line.previousLine,s=o.children.length-1;if(!_.isNullOrUndefined(o.children[s])&&o.children[s]instanceof X){o=o.children[s];if(!_.isNullOrUndefined(i.text)&&0!==i.text.indexOf(" ")&&o.text.lastIndexOf(" ")!==o.text.length-1)return e=0<e.length?e:t,this.checkElementCanBeCombined(o,n,r,!0,e,!1,!0,!0),!0}}return!1},Gm.prototype.lookThroughNextLine=function(e,t,i,n,r){if(i instanceof X&&!_.isNullOrUndefined(i)&&i.indexInOwner===i.line.children.length-1&&!_.isNullOrUndefined(i.line.nextLine)){var o=i.line.nextLine;if(!_.isNullOrUndefined(o.children[0])&&o.children[0]instanceof X){o=o.children[0];if(i.text.lastIndexOf(" ")!==i.text.length-1&&0!==o.text.indexOf(" "))return e=0<e.length?e:t,this.checkElementCanBeCombined(o,n,r,!0,e,!0,!1,!0),!0}}return!1},Gm.prototype.handleCombinedElements=function(e,t,i,n){e.istextCombined=!0;var r=t.split(/[\s]+/);if(-1===this.ignoreAllItems.indexOf(t)&&e instanceof X&&-1===e.ignoreOnceItems.indexOf(t))if(1<r.length)for(var o=0;o<r.length;o++){var s=r[o],s=this.manageSpecialCharacters(s,void 0,!0);this.documentHelper.render.handleUnorderedElements(s,e,i,o,0,o===r.length-1,n)}else t=this.manageSpecialCharacters(t,void 0,!0),this.documentHelper.render.handleUnorderedElements(t,e,i,0,0,!0,n)},Gm.prototype.checkArrayHasSameElement=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.start.location.x===t.start.location.x&&n.start.location.y===t.start.location.y)return!0}return!1},Gm.prototype.handleSplitWordSpellCheck=function(e,t,i,n,r,o,s,a){e.HasSpellingError&&" "!==i.text&&n?(n=this.getMatchedResultsFromElement(i,t),s=i.istextCombined?i.line.getOffset(this.getCombinedElement(i),0):s,this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(n.matches,n.textResults,n.elementInfo,0,i,!1,null,s),this.handleMatchedResults(n.textResults,i,r,o,e.Suggestions,a)):(this.addCorrectWordCollection(t),a&&(i.isSpellChecked=!0)),this.updateUniqueWords([{Text:t,HasSpellError:e.HasSpellingError}])},Gm.prototype.handleMatchedResults=function(e,t,i,n,r,o){if(0===e.length&&o)t.isSpellChecked=!0;else for(var s=0;s<e.length;s++){for(var a=this.createErrorElementWithInfo(e.innerList[s],t),l=(_.isNullOrUndefined(t.errorCollection)||this.checkArrayHasSameElement(t.errorCollection,a)||t.errorCollection.splice(n,0,a),this.addErrorCollection(a.text,a,r),this.errorWordCollection.get(a.text)),l=(_.isNullOrUndefined(l)||-1===l.indexOf(t)||l.indexOf(t)===l.indexOf(a)||l.splice(l.indexOf(t),1),(t.line.paragraph.containerWidget instanceof N?t.paragraph.containerWidget.cellFormat.shading:this.documentHelper).backgroundColor),d=t.line.paragraph,h=d.y,c=0;c<d.childWidgets.length&&d.childWidgets[c]!=t.line;c++)h+=d.childWidgets[c].height;t.isRightToLeft?this.documentHelper.render.renderWavyLine(a,a.end.location.x,h,i,"#FF0000","Single",t.characterFormat.baselineAlignment,l):this.documentHelper.render.renderWavyLine(a,a.start.location.x,h,i,"#FF0000","Single",t.characterFormat.baselineAlignment,l),o&&(t.isSpellChecked=!0)}},Gm.prototype.callSpellChecker=function(s,a,l,d,h,c){var p=this,u=this;return new Promise(function(t,i){var n,r,e,o;_.isNullOrUndefined(p)||(n=new XMLHttpRequest,r=p.documentHelper.owner.serviceUrl,r=c?r+p.documentHelper.owner.serverActionSettings.spellCheckByPage:r+p.documentHelper.owner.serverActionSettings.spellCheck,n.open("POST",r,!0),n.setRequestHeader("Content-Type","application/json"),p.setCustomHeaders(n),o={serverActionType:"SpellCheck",headers:p.documentHelper.owner.headers,timeout:0,cancel:!(e={LanguageID:s,TexttoCheck:a,CheckSpelling:l,CheckSuggestion:d,AddWord:h}),withCredentials:!1},p.documentHelper.owner.trigger(Te,o),o.cancel||n.send(JSON.stringify(e)),n.onreadystatechange=function(){var e;4===n.readyState&&(200===n.status||304===n.status?t:(e={status:n.status.toString(),statusText:n.responseText,url:r,name:"onFailure"},_.isNullOrUndefined(u.documentHelper)||u.documentHelper.owner.fireServiceFailure(e),i))(n.response)})})},Gm.prototype.setCustomHeaders=function(e){for(var t=0;t<this.documentHelper.owner.headers.length;t++)for(var i=this.documentHelper.owner.headers[t],n=0,r=Object.keys(i);n<r.length;n++){var o=r[n];e.setRequestHeader(o,i[o])}},Gm.prototype.checkForNextError=function(){if(!_.isNullOrUndefined(this.viewer)){var e=this.errorWordCollection;if(0<e.length)for(var t=0;t<e.length;t++){for(var i=e.get(e.keys[t]),n=0;n<i.length;n++){if(i[n]instanceof Ah&&!i[n].ischangeDetected)this.updateErrorElementTextBox(e.keys[t],i[n]);else if(i[n]instanceof X){var r=this.getMatchedResultsFromElement(i[n]),o=r.textResults,s=i[n].ischangeDetected?i[n].start.offset:i[n].line.getOffset(i[n],0);this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(r.matches,o,r.elementInfo,0,i[n],!1,null,s);for(var a=0;a<o.length;a++){var l=this.createErrorElementWithInfo(o.innerList[a],i[n]);this.updateErrorElementTextBox(l.text,l);break}}break}break}else this.documentHelper.clearSelectionHighlight()}},Gm.prototype.createErrorElementWithInfo=function(e,t){var i=new Ah,n=!1;if(t instanceof Ah&&(_.isNullOrUndefined(e.start)||_.isNullOrUndefined(e.end)||_.isNullOrUndefined(e.text))){i.text=t.text;for(var r=t.line,o=0;o<r.children.length;o++)if(r.children[o]instanceof X){var s=r.children[o].text,a=t.text;if(-1!==s.indexOf(a)){t.start.offset=s.indexOf(a),t.end.offset=t.start.offset+a.length,i.start=t.start,i.end=t.end,i.start.currentWidget=t.line,i.end.currentWidget=t.line,n=!0;break}}n||(i.text=t.text,i.start=t.start,i.end=t.end,n=!0)}return n||(i.text=e.text,i.start=e.start,i.end=e.end),i.height=t.height,i.canTrigger=t.canTrigger,i.characterFormat.copyFormat(t.characterFormat),i.width=Math.abs(i.start.location.x-i.end.location.x),i},Gm.prototype.getMatchedResultsFromElement=function(e,t){for(var i,n=e.line,r=this.documentHelper.owner.searchModule.textSearch.stringToRegex(_.isNullOrUndefined(t)?e.text:t,"CaseSensitive"),t=(this.textSearchResults.clearResults(),this.textSearchResults),n=this.documentHelper.owner.searchModule.textSearch.getElementInfo(n.children[0],0,!1,r,void 0,void 0,void 0,void 0,!0),o=n.fullText,s=[],a=n.elementsWithOffset;!_.isNullOrUndefined(i=r.exec(o));)this.isChangeAll&&(i.index=a.get(e)),s.push(i);return{matches:s,elementInfo:a,textResults:t}},Gm.prototype.updateErrorElementTextBox=function(e,t){var i=t;this.documentHelper.clearSelectionHighlight(),this.documentHelper.selection.start=i.start.clone(),this.documentHelper.selection.end=i.end.clone(),this.documentHelper.selection.highlight(t.start.paragraph,t.start,t.end),this.documentHelper.owner.spellCheckDialogModule.updateSuggestionDialog(e,i)},Gm.prototype.getWhiteSpaceCharacterInfo=function(e){var t=e.text,i=e.characterFormat,n=0,r=0,o=t.match(/[\s]+/);if(!_.isNullOrUndefined(o)&&0<o.length)for(var s=0;s<o.length;s++)n+=this.documentHelper.textHelper.getWidth(o[s],i,e.scriptType),r+=o[s].length;return{width:n,wordLength:r,isBeginning:!_.isNullOrUndefined(o)&&0===o.index}},Gm.prototype.getSpecialCharactersInfo=function(e){for(var t=e.text,i=e.characterFormat,n=[],r=0,o=0,s=0,n=t.match(/^[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*/),a=0;a<n.length;a++)!_.isNullOrUndefined(n[a])&&0<n[a].length&&(r=this.documentHelper.textHelper.getWidth(n[a],i,e.scriptType)),s=n.length;n=t.match(/[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*$/);for(a=0;a<n.length;a++)!_.isNullOrUndefined(n[a])&&0<n[a].length&&(o=this.documentHelper.textHelper.getWidth(n[a],i,e.scriptType)),s=n.length;return{beginningWidth:r,endWidth:o,wordLength:s}},Gm.prototype.getCombinedElement=function(e){for(var t=e;!_.isNullOrUndefined(e)&&e instanceof X&&e.istextCombined;)e=(t=e).previousElement;return t},Gm.prototype.checkCombinedElementsBeIgnored=function(e,t){t=this.manageSpecialCharacters(t,void 0,!0);for(var i=0;i<e.length;i++)if(-1!==e[i].ignoreOnceItems.indexOf(t))return!0;return!1},Gm.prototype.updateSplittedElementError=function(e,t){var i=e.errorCollection.length;if(0<i){for(var n=[],r=0;r<i;r++)n.push(e.errorCollection[r]);for(r=0;r<i;r++)-1===e.text.indexOf(n[r].text)&&(t.ischangeDetected=!0,e.errorCollection.splice(0,1))}},Gm.prototype.getPageContent=function(e){var t,i,n="";return this.documentHelper.owner.sfdtExportModule&&(t=(i=this.documentHelper.owner.sfdtExportModule).keywordIndex,i.keywordIndex=0,i.Initialize(),e=i.writePage(e),i.keywordIndex=t,this.documentHelper.owner.textExportModule)&&((i=this.documentHelper.owner.textExportModule).pageContent="",i.setDocument(e),i.writeInternal(),n=i.pageContent),n},Gm.prototype.updateUniqueWords=function(e){if(_.isNullOrUndefined(localStorage.getItem(this.uniqueKey))||(this.uniqueSpelledWords=JSON.parse(localStorage.getItem(this.uniqueKey))),this.uniqueSpelledWords=this.uniqueSpelledWords||{},e.length+Object.keys(this.uniqueSpelledWords).length<=this.uniqueWordsCount)for(var t=0;t<e.length;t++)this.checkForUniqueWords(e[t]);this.addUniqueWordsToLocalStorage(this.uniqueKey,JSON.stringify(this.uniqueSpelledWords)),this.uniqueSpelledWords={}},Gm.prototype.addUniqueWordsToLocalStorage=function(t,i){try{localStorage.setItem(t,i)}catch(e){"QuotaExceededError"===e.name&&(this.clearCache(),localStorage.setItem(t,i))}},Gm.prototype.checkForUniqueWords=function(e){this.uniqueSpelledWords[e.Text]||(this.uniqueSpelledWords[e.Text]=e.HasSpellError)},Gm.prototype.clearCache=function(){_.isNullOrUndefined(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey)},Gm.prototype.createGuid=function(){var i=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(i+16*Math.random())%16|0;return i=Math.floor(i/16),("x"===e?t:3&t|8).toString(16)})},Gm.prototype.checkSpellingInPageInfo=function(e){var t=JSON.parse(localStorage.getItem(this.uniqueKey));return _.isNullOrUndefined(t)||_.isNullOrUndefined(t[e])?{hasSpellError:!1,isElementPresent:!1}:{hasSpellError:t[e],isElementPresent:!0}},Gm.prototype.destroy=function(){this.errorWordCollection=void 0,this.ignoreAllItems=void 0,this.errorSuggestions=void 0,this.uniqueWordsCollection=void 0,this.uniqueSpelledWords={},this.textSearchResults=void 0,_.isNullOrUndefined(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey),this.documentHelper=void 0};var jm=Gm;function Gm(e){this.langIDInternal=0,this.enableSpellCheckInternal=!0,this.uniqueSpelledWords={},this.spellSuggestionInternal=!0,this.uniqueKey="",this.removeUnderlineInternal=!1,this.uniqueWordsCountInternal=15e3,this.performOptimizedCheck=!0,this.isChangeAll=!1,this.documentHelper=e,this.errorWordCollection=new T,this.uniqueWordsCollection=new T,this.errorSuggestions=new T,this.ignoreAllItems=[],this.uniqueSpelledWords={},this.textSearchResults=new pm(this.documentHelper.owner),this.uniqueKey=this.documentHelper.owner.element.id+"_"+this.createGuid()}Zm.prototype.getModuleName=function(){return"Optimized"},Zm.prototype.getkeyFromCharFormat=function(e){var t=e.fontFamily.toLocaleLowerCase();return e.bold&&(t+=";bold"),e.italic&&(t+=";italic"),t},Zm.prototype.getFontInfo=function(e){var t=_.createElement("iframe"),i=(document.body.appendChild(t),_.isNullOrUndefined(t.contentDocument)||(t.contentDocument.open(),t.contentDocument.write("<!DOCTYPE html><html><head></head><body></body></html>"),t.contentDocument.close()),document.createElement("div")),n=(i.setAttribute("style","position:absolute;top:-1000px;left:-1000px;opacity:0;font-size:0px;line-height:normal;"),1/window.devicePixelRatio),n=(i.style.transform="scale("+n.toString()+","+n.toString()+")",i.innerHTML='<span class="e-de-font-info" style="font-size:0; font-family: '+e.fontFamily+'; display: inline-block;">m</span><span class="e-de-font-info" style="font-size:288pt; font-family: '+e.fontFamily+";"+(e.bold?"font-weight:bold;":"")+(e.italic?"font-style:italic;":"")+' display: inline-block;">m</span>',t.contentDocument.body.appendChild(i),i.firstChild.offsetTop/i.lastChild.offsetHeight),e=parseFloat((i.lastChild.offsetHeight/288).toFixed(2));return document.body.removeChild(t),{HeightFactor:e,BaselineFactor:n}},Zm.prototype.getHeightInternal=function(e){var t,i,n=this.getkeyFromCharFormat(e);return _.isNullOrUndefined(this.optimizedHeightCollection[""+n])?(t=this.getFontInfo(e),{Height:i=(this.optimizedHeightCollection[""+n]=t).HeightFactor*e.fontSize,BaselineOffset:t.BaselineFactor*i}):{Height:i=(t=this.optimizedHeightCollection[""+n]).HeightFactor*e.fontSize,BaselineOffset:t.BaselineFactor*i}},Zm.prototype.destroy=function(){this.documentHelper=void 0,this.optimizedHeightCollection=void 0};var Km=Zm;function Zm(e){this.documentHelper=e,this.optimizedHeightCollection={}}Jm.prototype.getModuleName=function(){return"Regular"},Jm.prototype.getHeightInternal=function(e,t){var i=document.createElement("span"),n=(i.innerText="m",_.createElement("iframe")),e=(document.body.appendChild(n),_.isNullOrUndefined(n.contentDocument)||(n.contentDocument.open(),n.contentDocument.write("<!DOCTYPE html><html><head></head><body></body></html>"),n.contentDocument.close()),this.applyStyle(i,e,t),document.createElement("div")),t=(e.setAttribute("style","display:inline-block;position:absolute;"),document.createElement("div")),i=(t.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),e.appendChild(i),e.appendChild(t),n.contentDocument.body.appendChild(e),e=i.offsetHeight,i.offsetTop),t=t.offsetTop-i;return document.body.removeChild(n),{Height:e,BaselineOffset:t}},Jm.prototype.applyStyle=function(e,t,i){var n;_.isNullOrUndefined(e)||_.isNullOrUndefined(t)||(n="white-space:nowrap;",_.isNullOrUndefined(i)||""===i?n+="font-family:"+t.fontFamily+";":n+="font-family:"+i+";",n+="font-size:"+(i=(i=t.fontSize)<=.5?.5:i).toString()+"pt;",t.bold&&(n+="font-weight:bold;"),t.italic&&(n+="font-style:italic;"),e.setAttribute("style",n))},Jm.prototype.destroy=function(){this.documentHelper=void 0};var Xm=Jm;function Jm(e){this.documentHelper=e}Object.defineProperty(l.prototype,"isPasting",{get:function(){return this.viewer&&this.viewer.owner.isPastingContent},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),l.prototype.convertJsonToDocument=function(e,t){this.commentStarts=new T,this.commentEnds=new T,this.commentsCollection=new T,this.revisionCollection=new T,this.fontInfoCollection=new T,this.referedRevisions=[],this.keywordIndex=0,this.footnotes=new Oh,this.endnotes=new Oh;var i=[],e=j.getSfdtDocument(e);return!_.isNullOrUndefined(e.optimizeSfdt)&&e.optimizeSfdt&&(this.keywordIndex=1),_.isNullOrUndefined(e[Me[this.keywordIndex]])||this.parseFontSubstitutionTable(e[Me[this.keywordIndex]]),_.isNullOrUndefined(e[Ae[this.keywordIndex]])?this.parseCharacterFormat(0,this.viewer.owner.characterFormat,this.documentHelper.characterFormat):(this.documentHelper.characterFormat.clearFormat(),this.parseCharacterFormat(this.keywordIndex,e[Ae[this.keywordIndex]],this.documentHelper.characterFormat)),_.isNullOrUndefined(e[De[this.keywordIndex]])?this.parseParagraphFormat(0,this.viewer.owner.paragraphFormat,this.documentHelper.paragraphFormat):this.parseParagraphFormat(this.keywordIndex,e[De[this.keywordIndex]],this.documentHelper.paragraphFormat),_.isNullOrUndefined(e[at[this.keywordIndex]])||this.parseCharacterFormat(this.keywordIndex,e[at[this.keywordIndex]],this.documentHelper.themeFontLanguage),this.parseDocumentProtection(e),_.isNullOrUndefined(e[Ke[this.keywordIndex]])||(this.documentHelper.defaultTabWidth=e[Ke[this.keywordIndex]]),_.isNullOrUndefined(e[Xe[this.keywordIndex]])||(this.documentHelper.owner.enableTrackChanges!==j.parseBoolValue(e[Xe[this.keywordIndex]])&&(this.documentHelper.owner.skipSettingsOps=!0),this.documentHelper.owner.enableTrackChanges=j.parseBoolValue(e[Xe[this.keywordIndex]])),_.isNullOrUndefined(e[et[this.keywordIndex]])||(this.documentHelper.dontUseHtmlParagraphAutoSpacing=j.parseBoolValue(e[et[this.keywordIndex]])),_.isNullOrUndefined(e[ba[this.keywordIndex]])||(this.documentHelper.allowSpaceOfSameStyleInTable=j.parseBoolValue(e[ba[this.keywordIndex]])),_.isNullOrUndefined(e[tt[this.keywordIndex]])||(this.documentHelper.alignTablesRowByRow=j.parseBoolValue(e[tt[this.keywordIndex]])),_.isNullOrUndefined(e[ze[this.keywordIndex]])||(this.documentHelper.backgroundColor=this.getColor(e[ze[this.keywordIndex]][Or[this.keywordIndex]])),_.isNullOrUndefined(e[st[this.keywordIndex]])||(this.documentHelper.compatibilityMode=this.getCompatibilityMode(e[st[this.keywordIndex]]),_.isNullOrUndefined(this.documentHelper.owner.documentSettings))||(this.documentHelper.owner.documentSettings.compatibilityMode=this.getCompatibilityMode(e[st[this.keywordIndex]])),_.isNullOrUndefined(e[Ve[this.keywordIndex]])||this.parseAbstractList(e,this.documentHelper.abstractLists),_.isNullOrUndefined(e[Ue[this.keywordIndex]])||this.parseList(e,this.documentHelper.lists),_.isNullOrUndefined(e[qe[this.keywordIndex]])||this.parseStyles(e,this.documentHelper.styles),_.isNullOrUndefined(e[_e[this.keywordIndex]])||this.parseComments(e,this.documentHelper.comments),_.isNullOrUndefined(e[je[this.keywordIndex]])||this.parseRevisions(e,this.viewer.owner.revisionsInternal.changes),_.isNullOrUndefined(e[Pa[this.keywordIndex]])||this.parseImages(e[Pa[this.keywordIndex]]),_.isNullOrUndefined(e[Re[this.keywordIndex]])||this.parseSections(e[Re[this.keywordIndex]],i),_.isNullOrUndefined(e[Ge[this.keywordIndex]])||this.parseCustomXml(e),_.isNullOrUndefined(e[it[this.keywordIndex]])||(this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading=j.parseBoolValue(e[it[this.keywordIndex]])),_.isNullOrUndefined(e[rt[this.keywordIndex]])||this.parseFootnotes(e[rt[this.keywordIndex]],this.documentHelper.footnotes),_.isNullOrUndefined(e[ot[this.keywordIndex]])||this.parseEndtnotes(e[ot[this.keywordIndex]],this.documentHelper.endnotes),_.isNullOrUndefined(e[lt[this.keywordIndex]])||this.parseThemes(e[lt[this.keywordIndex]],this.documentHelper.themes),this.generalizeRevisions(),this.removeUnmappedBookmark(),_.isNullOrUndefined(e[Ea[0]])||(t[Ea[0]]=e[Ea[0]]),this.documentHelper.fieldStacks&&0<this.documentHelper.fieldStacks.length&&(this.documentHelper.fieldStacks=[]),i},l.prototype.parseFontSubstitutionTable=function(e){if(!_.isNullOrUndefined(this.documentHelper)&&!_.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)&&0<Object.keys(e).length)for(var t=0,i=Object.keys(e);t<i.length;t++){var n=i[t];this.documentHelper.fontSubstitutionTable.add(n,e[n])}},l.prototype.removeUnmappedBookmark=function(){for(var e,t=this.documentHelper.bookmarks.keys,i=this.documentHelper.endBookmarksUpdated,n=0;n<t.length;n++)-1===i.indexOf(t[n])&&((e=this.documentHelper.bookmarks.get(t[n]))&&e.line.children.splice(e.line.children.indexOf(e),1),this.documentHelper.bookmarks.remove(t[n]));this.documentHelper.endBookmarksUpdated=[]},l.prototype.generalizeRevisions=function(){var i=this,n=new T,r=[];this.referedRevisions.forEach(function(e){var t=i.documentHelper.revisionsInternal.get(e);-1===r.indexOf(t)&&(r.push(t),n.add(e,t))}),this.viewer.owner.revisionsInternal.changes=r,this.documentHelper.revisionsInternal=n},l.prototype.parseFootnotes=function(e,t){_.isNullOrUndefined(e[Ms[this.keywordIndex]])||this.parseBody(e[Ms[this.keywordIndex]],t.separator),_.isNullOrUndefined(e[Ds[this.keywordIndex]])||this.parseBody(e[Ds[this.keywordIndex]],t.continuationNotice),_.isNullOrUndefined(e[As[this.keywordIndex]])||this.parseBody(e[As[this.keywordIndex]],t.continuationSeparator)},l.prototype.parseImages=function(e){for(var t in e){var i;Array.isArray(e[""+t])?this.documentHelper.images.add(parseInt(t),e[""+t]):((i=[]).push(e[""+t]),this.documentHelper.images.add(parseInt(t),i))}},l.prototype.parseEndtnotes=function(e,t){_.isNullOrUndefined(e[Ms[this.keywordIndex]])||this.parseBody(e[Ms[this.keywordIndex]],t.separator),_.isNullOrUndefined(e[Ds[this.keywordIndex]])||this.parseBody(e[Ds[this.keywordIndex]],t.continuationNotice),_.isNullOrUndefined(e[As[this.keywordIndex]])||this.parseBody(e[As[this.keywordIndex]],t.continuationSeparator)},l.prototype.parseCustomXml=function(e){for(var t=0;t<e[Ge[this.keywordIndex]].length;t++){var i=e[Ge[this.keywordIndex]][t];this.revisionCollection.containsKey(i[vo[this.keywordIndex]])||this.documentHelper.customXmlData.add(i[vo[this.keywordIndex]],i[wo[this.keywordIndex]])}},l.prototype.parseDocumentProtection=function(e){_.isNullOrUndefined(e[Ze[this.keywordIndex]])||(this.documentHelper.restrictFormatting=j.parseBoolValue(e[Ze[this.keywordIndex]])),_.isNullOrUndefined(e[Ye[this.keywordIndex]])||(this.documentHelper.isDocumentProtected=j.parseBoolValue(e[Ye[this.keywordIndex]])),_.isNullOrUndefined(e[Je[this.keywordIndex]])||(this.documentHelper.protectionType=this.getProtectionType(e[Je[this.keywordIndex]])),_.isNullOrUndefined(e[Qe[this.keywordIndex]])||(this.documentHelper.hashValue=e[Qe[this.keywordIndex]]),_.isNullOrUndefined(e[$e[this.keywordIndex]])||(this.documentHelper.saltValue=e[$e[this.keywordIndex]])},l.prototype.parseStyles=function(e,t){for(var i=0;i<e[qe[this.keywordIndex]].length;i++){var n=this.documentHelper.owner.editorModule;(!_.isNullOrUndefined(n)&&n.isRemoteAction||_.isNullOrUndefined(this.documentHelper.styles.findByName(e[qe[this.keywordIndex]][i][dt[this.keywordIndex]])))&&this.parseStyle(e,e[qe[this.keywordIndex]][i],t)}},l.prototype.parseRevisions=function(e,t){for(var i=0;i<e[je[this.keywordIndex]].length;i++){var n=e[je[this.keywordIndex]][i];if(!_.isNullOrUndefined(n[yo[this.keywordIndex]])&&!_.isNullOrUndefined(n[fo[this.keywordIndex]])){var r=this.parseRevision(n),o=!0;if(!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange&&this.isPaste){if("Insertion"===this.getRevisionType(n[fo[this.keywordIndex]])&&this.isPaste&&this.documentHelper.owner.enableTrackChanges)continue;this.revisionCollection.containsKey(n[yo[this.keywordIndex]])||this.revisionCollection.add(n[yo[this.keywordIndex]],r)}else this.revisionCollection.add(n[yo[this.keywordIndex]],r);for(var s=0;s<t.length;s++)t[s].revisionID===r.revisionID&&(o=!1);o&&!this.documentHelper.owner.editorModule.isRemoteAction&&t.push(r)}}this.documentHelper.revisionsInternal=this.revisionCollection,this.documentHelper.owner.sfdtExportModule&&(this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1)},l.prototype.parseRevision=function(e){var t;if(!_.isNullOrUndefined(e))return(t=new $a(this.viewer.owner,e[co[this.keywordIndex]],e[uo[this.keywordIndex]])).revisionID=e[yo[this.keywordIndex]],t.revisionType=this.getRevisionType(e[fo[this.keywordIndex]]),t},l.prototype.checkAndApplyRevision=function(e,t,i){if(!_.isNullOrUndefined(t[Dt[e]])&&0<t[Dt[e]].length)for(var n=0;n<t[Dt[e]].length;n++){var r=t[Dt[e]][n];this.revisionCollection.containsKey(r)&&(this.referedRevisions.push(r),r=this.revisionCollection.get(r),i instanceof Xa||r.range.push(i),i.revisions.push(r),this.isPaste)&&this.documentHelper.owner.editorModule.isRemoteAction&&i instanceof Ya&&this.documentHelper.owner.editorModule.remotePasteRevision.push(r)}},l.prototype.parseComments=function(e,t){for(var i=0,n=0;n<e[_e[this.keywordIndex]].length;n++){for(var r=e[_e[this.keywordIndex]][n],o=void 0,o=this.parseComment(r,void 0);i<r[mo[this.keywordIndex]].length;){var s=void 0;(s=this.parseComment(r[mo[this.keywordIndex]][i],void 0)).ownerComment=o,s.isReply=!0,o.replyComments.push(s),this.commentsCollection.add(s.commentId,s),i++}this.commentsCollection.add(o.commentId,o),t.push(o),i=0}},l.prototype.parseComment=function(e,t){return(t=new fp(e[uo[this.keywordIndex]])).author=e[co[this.keywordIndex]],t.initial=e[po[this.keywordIndex]],t.commentId=e[lo[this.keywordIndex]],t.isResolved=j.parseBoolValue(e[go[this.keywordIndex]]),t.text=this.parseCommentText(e[S[this.keywordIndex]]),t.mentions=this.parseCommentMentions(e[S[this.keywordIndex]]),t},l.prototype.parseCommentText=function(e){for(var t="",i=!1,n=0;n<e.length;n++){if(0!==n&&(t+="<div>"),0<e[n][ko[this.keywordIndex]].length)for(var r=e[n][ko[this.keywordIndex]],o=0;o<r.length;o++){var s=r[o];0===s[Kr[this.keywordIndex]]||1===s[Kr[this.keywordIndex]]||2===s[Kr[this.keywordIndex]]?0===s[Kr[this.keywordIndex]]?o++:2===s[Kr[this.keywordIndex]]&&(i=!0):(s=s[dr[this.keywordIndex]],i?(t=t+'<span contenteditable="false" class="e-mention-chip">'+s+"</span>",i=!1):t+=s)}else t+=0===n?"<div><br></div>":"<br>";0!==n&&(t+="</div>")}return t},l.prototype.parseCommentMentions=function(e){for(var t=[],i=!1,n=!1,r=0;r<e.length;r++)for(var o=e[r][ko[this.keywordIndex]],s={},a=0;a<o.length;a++){var l,d=o[a];0===d[Kr[this.keywordIndex]]||1===d[Kr[this.keywordIndex]]||2===d[Kr[this.keywordIndex]]?0===d[Kr[this.keywordIndex]]?i=!0:2===d[Kr[this.keywordIndex]]&&(n=!0):(d=d[dr[this.keywordIndex]],i?(l=(l=d.replace(/.*"(.*)".*/,"$1")).replace("mailto:",""),s.value=l,i=!1):n&&(s.text=d,n=!1,t.push(s),s={}))}return t},l.prototype.parseStyle=function(e,t,i,n){var r,o,s,a,l,d=0,h=this.documentHelper.owner.editorModule;!_.isNullOrUndefined(n)&&n&&(d=this.keywordIndex,this.keywordIndex=0),_.isNullOrUndefined(t[aa[this.keywordIndex]])||("Paragraph"===this.getStyleType(t[aa[this.keywordIndex]])&&((r=new ul).type="Paragraph"),"Character"===this.getStyleType(t[aa[this.keywordIndex]])&&((r=new fl).type="Character"),"Table"===this.getStyleType(t[aa[this.keywordIndex]])&&((r=new wl).type="Table"),_.isNullOrUndefined(t[dt[this.keywordIndex]])||(r.name=t[dt[this.keywordIndex]]),i.push(r),_.isNullOrUndefined(t[ht[this.keywordIndex]])||(o=void 0,o=(!_.isNullOrUndefined(h)&&h.isRemoteAction?this.documentHelper.styles:i).findByName(t[ht[this.keywordIndex]]),_.isNullOrUndefined(o)?(a=this.getStyle(t[ht[this.keywordIndex]],e),s=void 0,_.isNullOrUndefined(a)||this.getStyleType(a[aa[this.keywordIndex]])!==r.type?"Paragraph"===r.type?s=JSON.parse('{"type":"Paragraph","name":"Normal","next":"Normal"}'):"Character"===r.type&&(s=JSON.parse('{"type": "Character","name": "Default Paragraph Font"}')):s=a,this.parseStyle(e,s,i),!_.isNullOrUndefined(h)&&h.isRemoteAction?r.basedOn=this.documentHelper.styles.findByName(s[dt[this.keywordIndex]]):r.basedOn=i.findByName(s[dt[this.keywordIndex]])):o.type===r.type&&o.name!==r.name&&(r.basedOn=o,a=this.getStyle(t[ht[this.keywordIndex]],e),this.isPaste)&&!_.isNullOrUndefined(a)&&"Paragraph"===r.type&&"Paragraph"===this.getStyleType(a[aa[this.keywordIndex]])&&this.updateParagraphFormatFromBaseStyle(t,a)),_.isNullOrUndefined(t[pt[this.keywordIndex]])||(o=i.findByName(t[pt[this.keywordIndex]]),a=this.getStyle(t[pt[this.keywordIndex]],e),s=void(!_.isNullOrUndefined(h)&&h.isRemoteAction&&(o=this.documentHelper.styles.findByName(t[pt[this.keywordIndex]]))),_.isNullOrUndefined(o)?(s=_.isNullOrUndefined(a)?((l={}).characterFormat=t[Ae[this.keywordIndex]],l.name=t[dt[this.keywordIndex]]+" Char",l.type="Character",l.basedOn="Normal"===t[ht[this.keywordIndex]]?"Default Paragraph Font":t[ht[this.keywordIndex]]+" Char",l):a,this.parseStyle(e,s,i),!_.isNullOrUndefined(h)&&h.isRemoteAction?r.link=_.isNullOrUndefined(this.documentHelper.styles.findByName(s.name))?t[pt[this.keywordIndex]]:this.documentHelper.styles.findByName(s.name):r.link=_.isNullOrUndefined(i.findByName(s.name))?t[pt[this.keywordIndex]]:i.findByName(s.name)):r.link=o),_.isNullOrUndefined(t[Ae[this.keywordIndex]])||this.parseCharacterFormat(this.keywordIndex,t[Ae[this.keywordIndex]],r.characterFormat),_.isNullOrUndefined(t[De[this.keywordIndex]])||this.parseParagraphFormat(this.keywordIndex,t[De[this.keywordIndex]],r.paragraphFormat),_.isNullOrUndefined(t[ct[this.keywordIndex]]))||(t[ct[this.keywordIndex]]===t[dt[this.keywordIndex]]?r.next=r:(l=void 0,l=(!_.isNullOrUndefined(h)&&h.isRemoteAction?this.documentHelper.styles:i).findByName(t[ct[this.keywordIndex]]),_.isNullOrUndefined(l)||l.type!==r.type?(a=this.getStyle(t[ct[this.keywordIndex]],e),_.isNullOrUndefined(a)?r.next=r:(this.parseStyle(e,a,i),!_.isNullOrUndefined(h)&&h.isRemoteAction?r.next=this.documentHelper.styles.findByName(a.name):r.next=i.findByName(a.name))):r.next=l)),!_.isNullOrUndefined(n)&&n&&(this.keywordIndex=d),_.isNullOrUndefined(r)||"Table"===r.type||this.documentHelper.addToStylesMap(r)},l.prototype.updateParagraphFormatFromBaseStyle=function(e,t){_.isNullOrUndefined(e[De[this.keywordIndex]])||_.isNullOrUndefined(t[De[this.keywordIndex]])||(e=e[De[this.keywordIndex]],t=t[De[this.keywordIndex]],!e.hasOwnProperty(_t[this.keywordIndex])&&t.hasOwnProperty(_t[this.keywordIndex])&&(e[_t[this.keywordIndex]]=t[_t[this.keywordIndex]]),!e.hasOwnProperty(jt[this.keywordIndex])&&t.hasOwnProperty(jt[this.keywordIndex])&&(e[jt[this.keywordIndex]]=t[jt[this.keywordIndex]]),!e.hasOwnProperty(Xt[this.keywordIndex])&&t.hasOwnProperty(Xt[this.keywordIndex])&&(e[Xt[this.keywordIndex]]=t[Xt[this.keywordIndex]]),!e.hasOwnProperty(Zt[this.keywordIndex])&&t.hasOwnProperty(Zt[this.keywordIndex])&&(e[Zt[this.keywordIndex]]=t[Zt[this.keywordIndex]]),!e.hasOwnProperty(Qt[this.keywordIndex])&&t.hasOwnProperty(Qt[this.keywordIndex])&&(e[Qt[this.keywordIndex]]=t[Qt[this.keywordIndex]]),!e.hasOwnProperty($t[this.keywordIndex])&&t.hasOwnProperty($t[this.keywordIndex])&&(e[$t[this.keywordIndex]]=t[$t[this.keywordIndex]]),!e.hasOwnProperty(Kt[this.keywordIndex])&&t.hasOwnProperty(Kt[this.keywordIndex])&&(e[Kt[this.keywordIndex]]=t[Kt[this.keywordIndex]]),!e.hasOwnProperty(ri[this.keywordIndex])&&t.hasOwnProperty(ri[this.keywordIndex])&&(e[ri[this.keywordIndex]]=t[ri[this.keywordIndex]]),!e.hasOwnProperty(oi[this.keywordIndex])&&t.hasOwnProperty(oi[this.keywordIndex])&&(e[oi[this.keywordIndex]]=t[oi[this.keywordIndex]]),!e.hasOwnProperty(ti[this.keywordIndex])&&t.hasOwnProperty(ti[this.keywordIndex])&&(e[ti[this.keywordIndex]]=t[ti[this.keywordIndex]]),!e.hasOwnProperty(ni[this.keywordIndex])&&t.hasOwnProperty(ni[this.keywordIndex])&&(e[ni[this.keywordIndex]]=t[ni[this.keywordIndex]]),!e.hasOwnProperty(ii[this.keywordIndex])&&t.hasOwnProperty(ii[this.keywordIndex])&&(e[ii[this.keywordIndex]]=t[ii[this.keywordIndex]]))},l.prototype.getStyle=function(e,t){for(var i=0;i<t[qe[this.keywordIndex]].length;i++)if(t[qe[this.keywordIndex]][i][dt[this.keywordIndex]]===e)return t[qe[this.keywordIndex]][i]},l.prototype.parseAbstractList=function(e,t){for(var i=0;i<e[Ve[this.keywordIndex]].length;i++){var n=new Hl,r=e[Ve[this.keywordIndex]][i];if(!_.isNullOrUndefined(r)&&(_.isNullOrUndefined(r[Os[this.keywordIndex]])||(n.abstractListId=r[Os[this.keywordIndex]]),_.isNullOrUndefined(r[Es])||(n.nsid=r[Es]),!_.isNullOrUndefined(r[Ls[this.keywordIndex]])))for(var o=0;o<r[Ls[this.keywordIndex]].length;o++){var s=r[Ls[this.keywordIndex]][o];_.isNullOrUndefined(s)||(s=this.parseListLevel(s,n),n.levels.push(s))}t.push(n)}},l.prototype.parseListLevel=function(e,t){t=new El(t);return"Bullet"===this.getListLevelPattern(e[Fs[this.keywordIndex]])?(t.listLevelPattern="Bullet",t.numberFormat=_.isNullOrUndefined(e[Ns[this.keywordIndex]])?"":e[Ns[this.keywordIndex]]):(t.listLevelPattern=this.getListLevelPattern(e[Fs[this.keywordIndex]]),t.startAt=e[Ts[this.keywordIndex]],t.numberFormat=_.isNullOrUndefined(e[Ns[this.keywordIndex]])?"":e[Ns[this.keywordIndex]],0<=e[Ss[this.keywordIndex]]?t.restartLevel=e[Ss[this.keywordIndex]]:t.restartLevel=e[Hs[this.keywordIndex]]),t.paraStyleName=_.isNullOrUndefined(e[Ws[this.keywordIndex]])?"":e[Ws[this.keywordIndex]],t.isLegalStyleNumbering=!_.isNullOrUndefined(e[rs[this.keywordIndex]])&&j.parseBoolValue(e[rs[this.keywordIndex]]),t.followCharacter=this.getFollowCharacterType(e[Ps[this.keywordIndex]]),this.parseCharacterFormat(this.keywordIndex,e[Ae[this.keywordIndex]],t.characterFormat),this.parseParagraphFormat(this.keywordIndex,e[De[this.keywordIndex]],t.paragraphFormat),t},l.prototype.parseList=function(e,t){for(var i=0;i<e[Ue[this.keywordIndex]].length;i++){var n=new Vu,r=e[Ue[this.keywordIndex]][i];_.isNullOrUndefined(r[Os[this.keywordIndex]])||(n.abstractListId=r[Os[this.keywordIndex]],n.abstractList=this.documentHelper.getAbstractListById(r[Os[this.keywordIndex]])),t.push(n),_.isNullOrUndefined(r[Ut[this.keywordIndex]])||(n.listId=r[Ut[this.keywordIndex]]),_.isNullOrUndefined(r[Es])?n.nsid=n.abstractList.nsid:n.nsid=r[Es],r.hasOwnProperty(Rs[this.keywordIndex])&&this.parseLevelOverride(r[Rs[this.keywordIndex]],n)}},l.prototype.parseLevelOverride=function(e,t){if(!_.isNullOrUndefined(e))for(var i=0;i<e.length;i++){var n=new Wl,r=e[i];n.startAt=r[Ts[this.keywordIndex]],n.levelNumber=r[Hs[this.keywordIndex]],_.isNullOrUndefined(r[Bs[this.keywordIndex]])||(n.overrideListLevel=this.parseListLevel(r[Bs[this.keywordIndex]],n)),t.levelOverrides.push(n)}},l.prototype.parseSections=function(e,t){for(var i=0;i<e.length;i++){var n=new z,r=(n.sectionFormat=new Ma(n),e[n.index=i]),o=e[i+1],o=o&&o[ks[this.keywordIndex]]?o[ks[this.keywordIndex]]:void 0,o=o&&o[Wi[this.keywordIndex]]?o[Wi[this.keywordIndex]]:"NewPage";_.isNullOrUndefined(r[ks[this.keywordIndex]])||this.parseSectionFormat(this.keywordIndex,r[ks[this.keywordIndex]],n.sectionFormat),_.isNullOrUndefined(r[Is[this.keywordIndex]])&&(r[Is[this.keywordIndex]]={}),this.documentHelper.headersFooters.push(this.parseHeaderFooter(r[Is[this.keywordIndex]],this.documentHelper.headersFooters)),this.isParseHeader=!1,this.parseTextBody(r[S[this.keywordIndex]],n,i+1<e.length,o);for(var s=0;s<n.childWidgets.length;s++)n.childWidgets[s].containerWidget=n;t.push(n)}},l.prototype.parseHeaderFooter=function(e,t){this.isParseHeader=!0;var i,n={};return _.isNullOrUndefined(e[ys[this.keywordIndex]])||(i=new Xd("OddHeader"),this.parseTextBody(e[ys[this.keywordIndex]][S[this.keywordIndex]],n[0]=i)),_.isNullOrUndefined(e[vs[this.keywordIndex]])||(i=new Xd("OddFooter"),this.parseTextBody(e[vs[this.keywordIndex]][S[this.keywordIndex]],n[1]=i)),_.isNullOrUndefined(e[ws[this.keywordIndex]])||(i=new Xd("EvenHeader"),this.parseTextBody(e[ws[this.keywordIndex]][S[this.keywordIndex]],n[2]=i)),_.isNullOrUndefined(e[bs[this.keywordIndex]])||(i=new Xd("EvenFooter"),this.parseTextBody(e[bs[this.keywordIndex]][S[this.keywordIndex]],n[3]=i)),_.isNullOrUndefined(e[xs[this.keywordIndex]])||(i=new Xd("FirstPageHeader"),this.parseTextBody(e[xs[this.keywordIndex]][S[this.keywordIndex]],n[4]=i)),_.isNullOrUndefined(e[Cs[this.keywordIndex]])||(i=new Xd("FirstPageFooter"),this.parseTextBody(e[Cs[this.keywordIndex]][S[this.keywordIndex]],n[5]=i)),n},l.prototype.parseTextBody=function(e,t,i,n){this.parseBody(e,t.childWidgets,t,i,void 0,void 0,n)},l.prototype.addCustomStyles=function(e){if(!_.isNullOrUndefined(e[qe[this.keywordIndex]]))for(var t=0;t<e[qe[this.keywordIndex]].length;t++)void 0===this.documentHelper.styles.findByName(e[qe[this.keywordIndex]][t][dt[this.keywordIndex]])&&this.parseStyle(e,e[qe[this.keywordIndex]][t],this.documentHelper.styles)},l.prototype.parseBody=function(e,t,i,n,r,o,s,a){if(!_.isNullOrUndefined(e))for(var l=0;l<e.length;l++){var d=e[l],h=!1;if(d.hasOwnProperty(ko[this.keywordIndex])){var c,p,u=new G;u.characterFormat=new B(u),u.paragraphFormat=new Xa(u),0<d[ko[this.keywordIndex]].length&&(h=this.parseParagraph(d[ko[this.keywordIndex]],u,!1,void 0,a&&0===l)),!n||d!==e[e.length-1]||0!==d[ko[this.keywordIndex]].length||h?(this.parseCharacterFormat(this.keywordIndex,d[Ae[this.keywordIndex]],u.characterFormat),this.parseParagraphFormat(this.keywordIndex,d[De[this.keywordIndex]],u.paragraphFormat),p=void 0,c="Normal",_.isNullOrUndefined(d[De[this.keywordIndex]])||_.isNullOrUndefined(d[De[this.keywordIndex]][Pt[this.keywordIndex]])||(c=d[De[this.keywordIndex]][Pt[this.keywordIndex]]),p=this.documentHelper.styles.findByName(c,"Paragraph"),_.isNullOrUndefined(p)||u.paragraphFormat.applyStyle(p),t.push(u)):n&&1===e.length?t.push(u):n&&d===e[e.length-1]&&0===d[ko[this.keywordIndex]].length&&!h&&"NoBreak"!=s&&(c=e.indexOf(d),p=e[c-1],!_.isNullOrUndefined(p))&&p.hasOwnProperty(ts[this.keywordIndex])&&(t.push(u),u.isSectionBreak=!0),u.index=t.length-1,u.containerWidget=i}else if(d.hasOwnProperty(ts[this.keywordIndex]))this.parseTable(d,t,t.length,i);else if(d.hasOwnProperty(Fo[this.keywordIndex])){var g=new E("Block"),m=new E("Block");this.parseContentControlProperties(d[Fo[this.keywordIndex]],g.contentControlProperties),m.contentControlProperties=g.contentControlProperties,g.type=0,m.type=1,this.parseBody(d[S[this.keywordIndex]],t,i,n,g.contentControlProperties);for(var f=0;f<2;f++){var y=t.length<d[S[this.keywordIndex]].length?t[0]:0===f?t[t.length-d[S[this.keywordIndex]].length]:t[t.length-1],v=void 0;y instanceof G?v=y:y instanceof K&&(v=0===f?y.firstChild.firstChild.firstChild:y.lastChild.lastChild.lastChild),_.isNullOrUndefined(v)||0!==v.childWidgets.length||(y=new uh(v),v.childWidgets.push(y)),0===f?(v.firstChild.children.splice(0,0,g),g.line=v.firstChild):(v.lastChild.children.push(m),m.line=v.lastChild)}}_.isNullOrUndefined(r)||(t[t.length-1].contentControlProperties=r)}},l.prototype.parseTable=function(e,t,i,n){var r=new K;r.index=i,_.isNullOrUndefined(e[ss[this.keywordIndex]])||this.parseTableFormat(e[ss[this.keywordIndex]],r.tableFormat,this.keywordIndex),r.tableFormat.title=e[Ho[this.keywordIndex]],r.tableFormat.description=e[is[this.keywordIndex]],this.parseTablePositioning(e,r);for(var o=0;o<e[ts[this.keywordIndex]].length;o++){var s=new dh,a=(s.rowFormat=new Ya(s),e[ts[this.keywordIndex]][o]);if(_.isNullOrUndefined(a[Fo[this.keywordIndex]])||(s.contentControlProperties=new Jh("Row"),this.parseContentControlProperties(a[Fo[this.keywordIndex]],s.contentControlProperties)),a.hasOwnProperty($o[this.keywordIndex])){this.parseRowFormat(a[$o[this.keywordIndex]],s.rowFormat,this.keywordIndex),s.index=o;for(var l=0;l<a[es[this.keywordIndex]].length;l++){for(var d,h,c=new N,p=(c.cellFormat=new Tl(c),a[es[this.keywordIndex]][l]),u=(_.isNullOrUndefined(p[Fo[this.keywordIndex]])||(c.contentControlProperties=new Jh("Cell"),this.parseContentControlProperties(p[Fo[this.keywordIndex]],c.contentControlProperties)),s.childWidgets.push(c),c.containerWidget=s,c.index=l,c.rowIndex=o,c.columnIndex=l,p.hasOwnProperty(Qo[this.keywordIndex])&&this.parseCellFormat(p[Qo[this.keywordIndex]],c.cellFormat,this.keywordIndex),p[S[this.keywordIndex]]),g=0;g<u.length;g++)u[g].hasOwnProperty([ts[this.keywordIndex]])&&(r.isContainInsideTable=!0);this.isPageBreakInsideTable=!0,this.parseTextBody(p[S[this.keywordIndex]],c,!1),_.isNullOrUndefined(c.contentControlProperties)||(p=new E("Cell"),d=new E("Cell"),p.contentControlProperties=c.contentControlProperties,d.contentControlProperties=c.contentControlProperties,p.type=0,d.type=1,0===c.firstChild.childWidgets.length&&(h=new uh(c.firstChild),c.firstChild.childWidgets.push(h)),p.line=c.firstChild.firstChild,c.firstChild.firstChild.children.splice(0,0,p),0===c.lastChild.childWidgets.length&&(h=new uh(c.lastChild),c.lastChild.childWidgets.push(h)),d.line=c.lastChild.lastChild,c.lastChild.lastChild.children.push(d)),_.isNullOrUndefined(s.contentControlProperties)||(s.firstChild===c?((p=new E("Row")).contentControlProperties=s.contentControlProperties,(p.type=0)===c.firstChild.childWidgets.length&&(h=new uh(c.firstChild),c.firstChild.childWidgets.push(h)),p.line=c.firstChild.firstChild,c.firstChild.firstChild.children.splice(0,0,p)):s.lastChild===c&&((d=new E("Row")).contentControlProperties=s.contentControlProperties,d.type=1,0===c.lastChild.childWidgets.length&&(h=new uh(c.lastChild),c.lastChild.childWidgets.push(h)),d.line=c.lastChild.lastChild,c.lastChild.lastChild.children.push(d))),this.isPageBreakInsideTable=!1}}r.childWidgets.push(s),s.containerWidget=r}r.containerWidget=n,t.push(r),r.isGridUpdated=!1},l.prototype.parseTablePositioning=function(e,t){t.wrapTextAround=!_.isNullOrUndefined(e[ns[this.keywordIndex]])&&j.parseBoolValue(e[ns[this.keywordIndex]]),t.wrapTextAround&&(t.positioning=new rh,t.positioning.allowOverlap=j.parseBoolValue(e[os[this.keywordIndex]][as[this.keywordIndex]]),_.isNullOrUndefined(e[os[this.keywordIndex]][cs[this.keywordIndex]])||(t.positioning.distanceBottom=j.convertPointToPixel(e[os[this.keywordIndex]][cs[this.keywordIndex]])),_.isNullOrUndefined(e[os[this.keywordIndex]][hs[this.keywordIndex]])||(t.positioning.distanceLeft=j.convertPointToPixel(e[os[this.keywordIndex]][hs[this.keywordIndex]])),_.isNullOrUndefined(e[os[this.keywordIndex]][ds[this.keywordIndex]])||(t.positioning.distanceRight=j.convertPointToPixel(e[os[this.keywordIndex]][ds[this.keywordIndex]])),_.isNullOrUndefined(e[os[this.keywordIndex]][ls[this.keywordIndex]])||(t.positioning.distanceTop=j.convertPointToPixel(e[os[this.keywordIndex]][ls[this.keywordIndex]])),_.isNullOrUndefined(e[os[this.keywordIndex]][Bi[this.keywordIndex]])||(t.positioning.verticalAlignment=this.getTableVerticalPosition(e[os[this.keywordIndex]][Bi[this.keywordIndex]])),_.isNullOrUndefined(e[os[this.keywordIndex]][ps[this.keywordIndex]])||(t.positioning.verticalOrigin=this.getTableVerticalRelation(e[os[this.keywordIndex]][ps[this.keywordIndex]])),t.positioning.verticalPosition=e[os[this.keywordIndex]][us[this.keywordIndex]],_.isNullOrUndefined(e[os[this.keywordIndex]][ms[this.keywordIndex]])||(t.positioning.horizontalAlignment=this.getTableHorizontalPosition(e[os[this.keywordIndex]][ms[this.keywordIndex]])),_.isNullOrUndefined(e[os[this.keywordIndex]][gs[this.keywordIndex]])||(t.positioning.horizontalOrigin=this.getTableHorizontalRelation(e[os[this.keywordIndex]][gs[this.keywordIndex]])),t.positioning.horizontalPosition=e[os[this.keywordIndex]][fs[this.keywordIndex]])},l.prototype.parseRowGridValues=function(e,t,i){_.isNullOrUndefined(e[Di[i]])||(t.gridBefore=e[Di[i]]),_.isNullOrUndefined(e[Ui[i]])||(t.gridBeforeWidth=e[Ui[i]]),_.isNullOrUndefined(e[Vi[i]])||(t.gridBeforeWidthType=this.getWidthType(e[Vi[i]])),_.isNullOrUndefined(e[zi[i]])||(t.gridAfter=e[zi[i]]),_.isNullOrUndefined(e[qi[i]])||(t.gridAfterWidth=e[qi[i]]),_.isNullOrUndefined(e[_i[i]])||(t.gridAfterWidthType=this.getWidthType(e[_i[i]]))},l.prototype.parseContentControlProperties=function(e,t){if(_.isNullOrUndefined(e[Po[this.keywordIndex]])||(t.lockContentControl=j.parseBoolValue(e[Po[this.keywordIndex]])),_.isNullOrUndefined(e[To[this.keywordIndex]])||(t.lockContents=j.parseBoolValue(e[To[this.keywordIndex]])),_.isNullOrUndefined(e[So[this.keywordIndex]])||(t.tag=e[So[this.keywordIndex]]),_.isNullOrUndefined(e[Or[this.keywordIndex]])||(t.color=e[Or[this.keywordIndex]]),_.isNullOrUndefined(e[Ho[this.keywordIndex]])||(t.title=e[Ho[this.keywordIndex]]),_.isNullOrUndefined(e[va[this.keywordIndex]])||(t.appearance=this.getContentControlAppearance(e[va[this.keywordIndex]])),_.isNullOrUndefined(e[aa[this.keywordIndex]])||(t.type=this.getContentControlType(e[aa[this.keywordIndex]])),_.isNullOrUndefined(e[No[this.keywordIndex]])||(t.hasPlaceHolderText=j.parseBoolValue(e[No[this.keywordIndex]])),_.isNullOrUndefined(e[Wo[this.keywordIndex]])||(t.multiline=j.parseBoolValue(e[Wo[this.keywordIndex]])),_.isNullOrUndefined(e[Oo[this.keywordIndex]])||(t.isTemporary=j.parseBoolValue(e[Oo[this.keywordIndex]])),_.isNullOrUndefined(e[Ae[this.keywordIndex]])||this.parseCharacterFormat(this.keywordIndex,e[Ae[this.keywordIndex]],t.characterFormat),"CheckBox"===t.type)_.isNullOrUndefined(e[Mo[this.keywordIndex]])||(t.isChecked=j.parseBoolValue(e[Mo[this.keywordIndex]])),_.isNullOrUndefined(e[Ao[this.keywordIndex]])||(t.uncheckedState=new ec,t.uncheckedState.font=e[Ao[this.keywordIndex]][zo[this.keywordIndex]],t.uncheckedState.value=e[Ao[this.keywordIndex]][qo[this.keywordIndex]]),_.isNullOrUndefined(e[Do[this.keywordIndex]])||(t.checkedState=new ec,t.checkedState.font=e[Do[this.keywordIndex]][zo[this.keywordIndex]],t.checkedState.value=e[Do[this.keywordIndex]][qo[this.keywordIndex]]);else if("Date"===t.type)_.isNullOrUndefined(e[Eo[this.keywordIndex]])||(t.dateCalendarType=this.getDateCalendarType(e[Eo[this.keywordIndex]])),_.isNullOrUndefined(e[Lo[this.keywordIndex]])||(t.dateStorageFormat=this.getDateStorageFormat(e[Lo[this.keywordIndex]])),_.isNullOrUndefined(e[Bo[this.keywordIndex]])||(t.dateDisplayLocale=e[Bo[this.keywordIndex]]),_.isNullOrUndefined(e[Ro[this.keywordIndex]])||(t.dateDisplayFormat=e[Ro[this.keywordIndex]]);else if(("ComboBox"===t.type||"DropDownList"===t.type)&&!_.isNullOrUndefined(e[Uo[this.keywordIndex]]))for(var i=0;i<e[Uo[this.keywordIndex]].length;i++){var n=new Qh;n.displayText=e[Uo[this.keywordIndex]][i][_o[this.keywordIndex]],n.value=e[Uo[this.keywordIndex]][i][qo[this.keywordIndex]],t.contentControlListItems.push(n)}_.isNullOrUndefined(e[Vo[this.keywordIndex]])||(t.xmlMapping=new ic,t.xmlMapping.isMapped=j.parseBoolValue(e[Vo[this.keywordIndex]][jo[this.keywordIndex]]),t.xmlMapping.isWordMl=j.parseBoolValue(e[Vo[this.keywordIndex]][Go[this.keywordIndex]]),_.isNullOrUndefined(e[Vo[this.keywordIndex]][Ko[this.keywordIndex]])||(t.xmlMapping.prefixMapping=e[Vo[this.keywordIndex]][Ko[this.keywordIndex]]),t.xmlMapping.xPath=e[Vo[this.keywordIndex]][Zo[this.keywordIndex]],t.xmlMapping.storeItemId=e[Vo[this.keywordIndex]][Xo[this.keywordIndex]],_.isNullOrUndefined(e[Vo[this.keywordIndex]][Jo[this.keywordIndex]]))||(t.xmlMapping.customXmlPart=new rc,t.xmlMapping.customXmlPart.id=e[Vo[this.keywordIndex]][Jo[this.keywordIndex]][Yo[this.keywordIndex]],t.xmlMapping.customXmlPart.xml=e[Vo[this.keywordIndex]][Jo[this.keywordIndex]][wo[this.keywordIndex]])},l.prototype.parseSymbol=function(e,t){var i=e.split(" "),e=i.indexOf("SYMBOL");if(-1!==e){var e=i[e+1],n=new X,e=(n.characterFormat=new B(n),n.text=String.fromCharCode(parseInt(e)),i.indexOf("\\f"));if(-1!==e){for(var r="",o=e+1;o<i.length&&"\\s"!==i[o];o++)r+=i[o]+" ";null!==r&&(r=(r=r.replace(/"/g,"")).trim(),n.characterFormat.fontFamily=r)}e=i.indexOf("\\s");-1!==e&&(n.characterFormat.fontSize=parseInt(i[e+1])),(n.line=t).children.push(n)}},l.prototype.parseParagraph=function(p,u,g,m,f){for(var y,v,w=this,e=!1,b=(_.isNullOrUndefined(m)?m=new uh(u):e=!0,!1),x=this.viewer.owner.enableTrackChanges,C=0,I=!1,k=!1,F=void 0,P=this,t=0;t<p.length;t++)!function(e){var t=p[e];if(I=!1,t.hasOwnProperty([Kr[P.keywordIndex]])&&(2===t[Kr[P.keywordIndex]]&&(C=e),1===t[Kr[P.keywordIndex]])&&C+1===e&&(I=!0,C=0),I&&P.documentHelper.isPageField)return(i=new Vh).characterFormat=new B(i),i.text="",(i.line=m).children.push(i),b=!0,v=--e;if(I&&!_.isNullOrUndefined(F)&&-1!==F.indexOf("SYMBOL")&&(P.parseSymbol(F,m),F=void 0,I=!1),t.hasOwnProperty(dr[P.keywordIndex])||t.hasOwnProperty(Ht[P.keywordIndex])){var i=void 0;if(P.documentHelper.isPageField)(i=new Vh).fieldBegin=P.documentHelper.fieldStacks[P.documentHelper.fieldStacks.length-1];else if("\t"===t[dr[P.keywordIndex]])i=new _h;else{if("\f"===t[dr[P.keywordIndex]]&&P.isPageBreakInsideTable)return v=e;if(t.hasOwnProperty(Ht[P.keywordIndex]))(i=new Sp).breakClearType=P.getBreakClearType(t[Ht[P.keywordIndex]]);else if(""===t[dr[P.keywordIndex]]||j.checkTextFormat(t[dr[P.keywordIndex]])&&0===m.children.length&&0===e&&f)i=new Op;else if(i=new X,0===t[dr[P.keywordIndex]].length&&!_.isNullOrUndefined(t[Dt[P.keywordIndex]]))return v=e}if(i.characterFormat=new B(i),P.parseCharacterFormat(P.keywordIndex,t[Ae[P.keywordIndex]],i.characterFormat,g),P.applyCharacterStyle(t,i),i.text=i instanceof Sp?"\v":t[dr[P.keywordIndex]],F=i.text,P.isHtmlPaste&&(i instanceof X||i instanceof Sp)&&(s=void 0,0<m.children.length&&(s=m.children[m.children.length-1]),P.documentHelper.textHelper.isRTLText(i.text)?(i.characterFormat.bidi=!0,s instanceof X&&" "===s.text&&(s.characterFormat.bidi=!0)):" "===i.text&&s&&s.characterFormat.bidi&&(i.characterFormat.bidi=!0)),P.documentHelper.owner.parser.isPaste&&!P.isCutPerformed){if(!_.isNullOrUndefined(t[Dt[P.keywordIndex]]))for(var n=0;n<t[Dt[P.keywordIndex]].length;n++)P.revisionCollection.containsKey(t[Dt[P.keywordIndex]][n])&&(x&&(y=P.revisionCollection.get(t[Dt[P.keywordIndex]][n])),_.isNullOrUndefined(y)||!(0<m.children.length)||_.isNullOrUndefined(m.children[e-1].revisions[n])||x&&"Deletion"!==y.revisionType||y.revisionID!==t[Dt[P.keywordIndex]][n]?(x||(y=P.documentHelper.revisionsInternal.get(t[Dt[P.keywordIndex]][n])),P.documentHelper.owner.editorModule.isRemoteAction?P.documentHelper.owner.editorModule.insertRevision(i,y.revisionType,y.author,void 0,void 0,!1,y.revisionID):P.documentHelper.owner.editorModule.insertRevision(i,y.revisionType,y.author,void 0,void 0,!1),t[Dt[P.keywordIndex]][n]=i.revisions[n].revisionID):(t[Dt[P.keywordIndex]][n]=m.children[e-1].revisions[n].revisionID,P.checkAndApplyRevision(P.keywordIndex,t,i)))}else P.checkAndApplyRevision(P.keywordIndex,t,i);for(var r=(i.line=m).children,o=r.length-1;0<r.length&&r[o]instanceof J&&!_.isNullOrUndefined(r[o].properties)&&!0===r[o].properties.isAfterParagraphMark;)o--;o!==r.length-1?r.splice(o+1,0,i):r.push(i),i instanceof X&&90<i.text.length&&j.splitWordByMaxLength(i,m,!0),b=!0}else if(t.hasOwnProperty(bo[P.keywordIndex])){var s=new Bh;s.line=m,s.footnoteType=P.getFootnoteType(t[bo[P.keywordIndex]]),("Footnote"===s.footnoteType?P.documentHelper.footnoteCollection:P.documentHelper.endnoteCollection).push(s),s.symbolCode=t[xo[P.keywordIndex]],s.symbolFontName=t[Co[P.keywordIndex]],s.customMarker=t[Io[P.keywordIndex]],s.characterFormat=new B(s),P.parseCharacterFormat(P.keywordIndex,t[Ae[P.keywordIndex]],s.characterFormat,g),P.applyCharacterStyle(t,s),P.checkAndApplyRevision(P.keywordIndex,t,s),P.parseBody(t[S[P.keywordIndex]],s.bodyWidget.childWidgets,s.bodyWidget,!1,void 0,void 0,void 0,!0),m.children.push(s),b=!0}else if(t.hasOwnProperty(or[P.keywordIndex])){P.documentHelper.owner.editorModule&&(P.documentHelper.owner.editorModule.chartType=!0);var s=new Lc,a=(s.title=t[rr[P.keywordIndex]],s.type=t[or[P.keywordIndex]],s.chartGapWidth=t[sr[P.keywordIndex]],s.chartOverlap=t[ar[P.keywordIndex]],P.parseChartTitleArea(t[$n[P.keywordIndex]],s.chartTitleArea),P.parseChartArea(t[Qn[P.keywordIndex]],s.chartArea),P.parseChartArea(t[er[P.keywordIndex]],s.chartPlotArea),P.parseChartLegend(t[tr[P.keywordIndex]],s.chartLegend),P.parseChartData(t,s),P.parseChartCategoryAxis(t[ir[P.keywordIndex]],s.chartPrimaryCategoryAxis),P.parseChartCategoryAxis(t[nr[P.keywordIndex]],s.chartPrimaryValueAxis),null!=t[lr[P.keywordIndex]]&&P.parseChartDataTable(t[lr[P.keywordIndex]],s.chartDataTable),(s.line=m).children.push(s),s.height=j.convertPointToPixel(t[fr[P.keywordIndex]]),s.width=j.convertPointToPixel(t[mr[P.keywordIndex]]),new W.ChartComponent);a.chartRender(t,P.keywordIndex),(s.officeChart=a).chart.appendTo(s.targetElement),b=!0}else if(t.hasOwnProperty(Br[P.keywordIndex])){var l=new Ic(j.parseBoolValue(t[Mr[P.keywordIndex]])),a=(l.isMetaFile=j.parseBoolValue(t[Ar[P.keywordIndex]]),l.isCompressed=t[ka[P.keywordIndex]],l.metaFileImageString=t[Rr[P.keywordIndex]],l.characterFormat=new B(l),l.line=m,P.checkAndApplyRevision(P.keywordIndex,t,l),m.children.push(l),j.formatClippedString(t[Br[P.keywordIndex]]).formatClippedString);P.validateImageUrl(a)?P.isPaste&&!_.isNullOrUndefined(P.documentHelper.owner.editorModule.pasteImageIndex)?l.imageString=P.documentHelper.owner.editorModule.pasteImageIndex.get(t[Br[P.keywordIndex]]):l.imageString=t[Br[P.keywordIndex]]:l.imageString="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC","NaN"===parseInt(t[Br[P.keywordIndex]]).toString()&&P.documentHelper.addBase64StringInCollection(l),l.width=j.convertPointToPixel(t[mr[P.keywordIndex]]),l.height=j.convertPointToPixel(t[fr[P.keywordIndex]]),P.isContextBasedPaste||(s=P.documentHelper.getImageString(l),_.isNullOrUndefined(s)||!j.startsWith(s,"http://")&&!j.startsWith(s,"https://")||(l.element.crossOrigin="Anonymous",P.viewer.documentHelper.getBase64(s,l.width,l.height).then(function(e){w.viewer.documentHelper.images.get(parseInt(l.imageString))[1]=e}),0<new URL(s).search.length?s+="&t="+(new Date).getTime():s+="?t="+(new Date).getTime()),l.element.src=s),l.top=t[Dr[P.keywordIndex]],l.left=t[zr[P.keywordIndex]],l.bottom=t[Ur[P.keywordIndex]],l.right=t[Vr[P.keywordIndex]],l.cropHeightScale=t[qr[P.keywordIndex]],l.cropWidthScale=t[_r[P.keywordIndex]],l.name=t[dt[P.keywordIndex]],l.alternateText=t[cr[P.keywordIndex]],l.title=t[Ho[P.keywordIndex]],l.visible=j.parseBoolValue(t[pr[P.keywordIndex]]),l.widthScale=t[yr[P.keywordIndex]],l.heightScale=t[vr[P.keywordIndex]],l.verticalPosition=j.convertPointToPixel(t[us[P.keywordIndex]]),l.verticalOrigin=P.getVerticalOrigin(t[ps[P.keywordIndex]]),l.verticalAlignment=P.getShapeVerticalAlignment(t[Bi[P.keywordIndex]]),l.horizontalPosition=j.convertPointToPixel(t[fs[P.keywordIndex]]),l.horizontalOrigin=P.getHorizontalOrigin(t[gs[P.keywordIndex]]),l.horizontalAlignment=P.getShapeHorizontalAlignment(t[ms[P.keywordIndex]]),l.allowOverlap=j.parseBoolValue(t[as[P.keywordIndex]]),_.isNullOrUndefined(t[xr[P.keywordIndex]])||(l.textWrappingStyle=P.getTextWrappingStyle(t[xr[P.keywordIndex]])),_.isNullOrUndefined(t[Cr[P.keywordIndex]])||(l.textWrappingType=P.getTextWrappingType(t[Cr[P.keywordIndex]])),l.isBelowText=j.parseBoolValue(t[ur[P.keywordIndex]]),_.isNullOrUndefined(t[cs[P.keywordIndex]])||(l.distanceBottom=j.convertPointToPixel(t[cs[P.keywordIndex]])),_.isNullOrUndefined(t[hs[P.keywordIndex]])||(l.distanceLeft=j.convertPointToPixel(t[hs[P.keywordIndex]])),_.isNullOrUndefined(t[ds[P.keywordIndex]])||(l.distanceRight=j.convertPointToPixel(t[ds[P.keywordIndex]])),_.isNullOrUndefined(t[ls[P.keywordIndex]])||(l.distanceTop=j.convertPointToPixel(t[ls[P.keywordIndex]])),l.zOrderPosition=t[Tr[P.keywordIndex]],l.layoutInCell=j.parseBoolValue(t[Sr[P.keywordIndex]]),(!_.isNullOrUndefined(t[Dr[P.keywordIndex]])&&0!==t[Dr[P.keywordIndex]]||!_.isNullOrUndefined(t[Ur[P.keywordIndex]])&&0!==t[Ur[P.keywordIndex]]||!_.isNullOrUndefined(t[zr[P.keywordIndex]])&&0!==t[zr[P.keywordIndex]]||!_.isNullOrUndefined(t[Vr[P.keywordIndex]])&&0!==t[Vr[P.keywordIndex]])&&(l.isCrop=!0),"Inline"!==P.getTextWrappingStyle(l.textWrappingStyle)&&u.floatingElements.push(l),P.parseCharacterFormat(P.keywordIndex,t[Ae[P.keywordIndex]],l.characterFormat),b=!0}else if(t.hasOwnProperty(jr[P.keywordIndex])||t.hasOwnProperty(Kr[P.keywordIndex])&&0===t[Kr[P.keywordIndex]]){k=!0;a=new Z(0);P.parseCharacterFormat(P.keywordIndex,t[Ae[P.keywordIndex]],a.characterFormat,g),P.applyCharacterStyle(t,a),a.fieldCodeType=t.fieldCodeType,a.hasFieldEnd=t[jr[P.keywordIndex]],t.hasOwnProperty(Gr[P.keywordIndex])&&(s=P.parseFormFieldData(P.keywordIndex,t,s=void 0),a.formFieldData=s,P.isContextBasedPaste||P.documentHelper.formFields.push(a)),P.documentHelper.fieldStacks.push(a),P.checkAndApplyRevision(P.keywordIndex,t,a),a.line=m,P.isContextBasedPaste||P.documentHelper.fields.push(a),m.children.push(a)}else if(t.hasOwnProperty([Kr[P.keywordIndex]])){s=void 0;2===t[Kr[P.keywordIndex]]||1===t[Kr[P.keywordIndex]]&&k?(s=new Z(2),P.parseCharacterFormat(P.keywordIndex,t[Ae[P.keywordIndex]],s.characterFormat,g),P.checkAndApplyRevision(P.keywordIndex,t,s),P.fieldSeparator=s,0<P.documentHelper.fieldStacks.length&&(s.fieldBegin=P.documentHelper.fieldStacks[P.documentHelper.fieldStacks.length-1],s.fieldBegin.fieldSeparator=s,2<=m.children.length)&&(a=P.containsFieldBegin(m),!_.isNullOrUndefined(a))&&a instanceof X&&(a.text.match("PAGE")||a.text.match("page"))&&(a.text.replace(/^\s+/g,"").startsWith("HYPERLINK")||(P.documentHelper.isPageField=!0)),1===t[Kr[P.keywordIndex]]&&k&&(C=--e),k=!1):1===t[Kr[P.keywordIndex]]&&(s=new Z(1),P.parseCharacterFormat(P.keywordIndex,t[Ae[P.keywordIndex]],s.characterFormat,g),P.applyCharacterStyle(t,s),P.checkAndApplyRevision(P.keywordIndex,t,s),0<P.documentHelper.fieldStacks.length&&(s.fieldBegin=P.documentHelper.fieldStacks[P.documentHelper.fieldStacks.length-1],s.fieldBegin.fieldEnd=s),!_.isNullOrUndefined(s.fieldBegin)&&s.fieldBegin.fieldSeparator&&(s.fieldSeparator=s.fieldBegin.fieldSeparator,s.fieldBegin.fieldSeparator.fieldEnd=s,b=!0),P.documentHelper.fieldStacks.splice(P.documentHelper.fieldStacks.length-1,1),P.fieldSeparator=void 0,P.documentHelper.isPageField=!1,P.isContextBasedPaste||P.documentHelper.fieldCollection.push(s.fieldBegin),F=void 0),(s.line=m).children.push(s)}else if(t.hasOwnProperty([Us[P.keywordIndex]])){a=void 0;(a=new J(t[Us[P.keywordIndex]])).name=t[dt[P.keywordIndex]],a.properties=t[Vs[P.keywordIndex]],_.isNullOrUndefined(t[Vs[P.keywordIndex]])||(_.isNullOrUndefined(t[Vs[P.keywordIndex]][Ta[P.keywordIndex]])||(a.properties.isAfterParagraphMark=j.parseBoolValue(t[Vs[P.keywordIndex]][Ta[P.keywordIndex]])),_.isNullOrUndefined(t[Vs[P.keywordIndex]][Oa[P.keywordIndex]])||(a.properties.isAfterTableMark=j.parseBoolValue(t[Vs[P.keywordIndex]][Oa[P.keywordIndex]])),_.isNullOrUndefined(t[Vs[P.keywordIndex]][Ha[P.keywordIndex]])||(a.properties.isAfterRowMark=j.parseBoolValue(t[Vs[P.keywordIndex]][Ha[P.keywordIndex]])),_.isNullOrUndefined(t[Vs[P.keywordIndex]][Sa[P.keywordIndex]])||(a.properties.isAfterCellMark=j.parseBoolValue(t[Vs[P.keywordIndex]][Sa[P.keywordIndex]])),_.isNullOrUndefined(t[Vs[P.keywordIndex]][Ks[P.keywordIndex]])||(a.properties.columnFirst=t[Vs[P.keywordIndex]][Ks[P.keywordIndex]]),_.isNullOrUndefined(t[Vs[P.keywordIndex]][Zs[P.keywordIndex]]))||(a.properties.columnLast=t[Vs[P.keywordIndex]][Zs[P.keywordIndex]]),P.checkAndApplyRevision(P.keywordIndex,t,a),m.children.push(a),a.line=m,P.isParseHeader&&!P.isPaste||(0===t[Us[P.keywordIndex]]?(s=P.isPaste&&!P.documentHelper.bookmarks.containsKey(a.name),!P.isPaste||s&&!P.isContextBasedPaste?P.documentHelper.bookmarks.add(a.name,a):s||m.children.splice(m.children.indexOf(a),1)):1===t[Us[P.keywordIndex]]&&P.documentHelper.bookmarks.containsKey(a.name)&&(s=P.documentHelper.bookmarks.get(a.name),d=P.isPaste&&_.isNullOrUndefined(s.reference),!P.isPaste||d&&!P.isContextBasedPaste?((s.reference=a).reference=s,P.documentHelper.endBookmarksUpdated.push(a.name)):d||m.children.splice(m.children.indexOf(a),1))),0!==a.name.indexOf("_")&&(b=!0)}else if(t.hasOwnProperty([Gs[P.keywordIndex]]))t.hasOwnProperty(Ys[P.keywordIndex])?(s=new Sc,P.editableRanges.containsKey(t[Gs[P.keywordIndex]])&&(d=P.editableRanges.get(t[Gs[P.keywordIndex]]),(s.editRangeStart=d).editRangeEnd=s,_.isNullOrUndefined(t[Gs[P.keywordIndex]])||(s.editRangeId=t[Gs[P.keywordIndex]]),P.editableRanges.remove(t[Gs[P.keywordIndex]])),m.children.push(s),s.line=m):(a=P.parseEditableRangeStart(t),m.children.push(a),a.line=m,P.editableRanges.containsKey(t[Gs[P.keywordIndex]])||P.editableRanges.add(t[Gs[P.keywordIndex]],a)),b=!0;else if(t.hasOwnProperty([lo[P.keywordIndex]])){var d=t[lo[P.keywordIndex]],s=void 0;P.commentStarts.containsKey(d)&&P.commentStarts.get(d);P.commentEnds.containsKey(d)&&P.commentEnds.get(d),t.hasOwnProperty([ho[P.keywordIndex]])&&(0===t[ho[P.keywordIndex]]?((a=new up(0)).commentId=d,P.commentStarts.containsKey(d)||P.commentStarts.add(d,a),(a.line=m).children.push(a),s=P.commentsCollection.get(d),_.isNullOrUndefined(s)||((s.commentStart=a).comment=s)):((a=new up(1)).commentId=d,P.commentEnds.containsKey(d)||P.commentEnds.add(d,a),(a.line=m).children.push(a),s=P.commentsCollection.get(d),_.isNullOrUndefined(s)||((s.commentEnd=a).comment=s)),!_.isNullOrUndefined(s))&&s.isReply&&(_.isNullOrUndefined(s.ownerComment.commentStart)&&(s.ownerComment.commentStart=s.commentStart),_.isNullOrUndefined(s.ownerComment.commentEnd))&&(s.ownerComment.commentEnd=s.commentEnd)}else if(t.hasOwnProperty([hr[P.keywordIndex]])){d=new uc;d.shapeId=t[hr[P.keywordIndex]],d.name=t[dt[P.keywordIndex]],d.alternateText=t[cr[P.keywordIndex]],d.title=t[Ho[P.keywordIndex]],d.visible=j.parseBoolValue(t[pr[P.keywordIndex]]),d.width=j.convertPointToPixel(t[mr[P.keywordIndex]]),d.height=j.convertPointToPixel(t[fr[P.keywordIndex]]),0===d.height&&(d.isZeroHeight=!0),d.widthScale=t[yr[P.keywordIndex]],d.heightScale=t[vr[P.keywordIndex]],d.verticalPosition=j.convertPointToPixel(t[us[P.keywordIndex]]),d.verticalOrigin=P.getVerticalOrigin(t[ps[P.keywordIndex]]),d.verticalAlignment=P.getShapeVerticalAlignment(t[Bi[P.keywordIndex]]),d.verticalRelativePercent=t[Ir[P.keywordIndex]],d.horizontalPosition=j.convertPointToPixel(t[fs[P.keywordIndex]]),d.horizontalOrigin=P.getHorizontalOrigin(t[gs[P.keywordIndex]]),d.horizontalAlignment=P.getShapeHorizontalAlignment(t[ms[P.keywordIndex]]),d.horizontalRelativePercent=t[kr[P.keywordIndex]],d.heightRelativePercent=t[Fr[P.keywordIndex]],d.widthRelativePercent=t[Pr[P.keywordIndex]],d.zOrderPosition=t[Tr[P.keywordIndex]],d.allowOverlap=j.parseBoolValue(t[as[P.keywordIndex]]),d.textWrappingStyle=P.getTextWrappingStyle(t[xr[P.keywordIndex]]),d.textWrappingType=P.getTextWrappingType(t[Cr[P.keywordIndex]]),d.isBelowText=j.parseBoolValue(t[ur[P.keywordIndex]]),d.isHorizontalRule=j.parseBoolValue(t[gr[P.keywordIndex]]),_.isNullOrUndefined(t[cs[P.keywordIndex]])||(d.distanceBottom=j.convertPointToPixel(t[cs[P.keywordIndex]])),_.isNullOrUndefined(t[hs[P.keywordIndex]])||(d.distanceLeft=j.convertPointToPixel(t[hs[P.keywordIndex]])),_.isNullOrUndefined(t[ds[P.keywordIndex]])||(d.distanceRight=j.convertPointToPixel(t[ds[P.keywordIndex]])),_.isNullOrUndefined(t[ls[P.keywordIndex]])||(d.distanceTop=j.convertPointToPixel(t[ls[P.keywordIndex]])),d.layoutInCell=j.parseBoolValue(t[Sr[P.keywordIndex]]),d.lockAnchor=j.parseBoolValue(t[Hr[P.keywordIndex]]),d.autoShapeType=P.getAutoShapeType(t[Nr[P.keywordIndex]]),d.editingPoints=t[La[P.keywordIndex]],t.hasOwnProperty(wr[P.keywordIndex])&&((a=new vc).line=j.parseBoolValue(t[wr[P.keywordIndex]][mn[P.keywordIndex]]),a.lineFormatType=P.getLineFormatType(t[wr[P.keywordIndex]][wa[P.keywordIndex]]),a.color=t[wr[P.keywordIndex]][Or[P.keywordIndex]],a.weight=t[wr[P.keywordIndex]][xa[P.keywordIndex]],a.dashStyle=P.getLineDashStyle(t[wr[P.keywordIndex]][ln[P.keywordIndex]]),d.lineFormat=a),t.hasOwnProperty(br[P.keywordIndex])&&((s=new bc).color=t[br[P.keywordIndex]][Or[P.keywordIndex]],s.fill=j.parseBoolValue(t[br[P.keywordIndex]][Er[P.keywordIndex]]),d.fillFormat=s),t.hasOwnProperty(Wr[P.keywordIndex])&&((a=new fc).textVerticalAlignment=P.getTextVerticalAlignment(t[Wr[P.keywordIndex]][Lr[P.keywordIndex]]),a.marginLeft=j.convertPointToPixel(t[Wr[P.keywordIndex]][gi[P.keywordIndex]]),a.marginRight=j.convertPointToPixel(t[Wr[P.keywordIndex]][mi[P.keywordIndex]]),a.marginTop=j.convertPointToPixel(t[Wr[P.keywordIndex]][fi[P.keywordIndex]]),a.marginBottom=j.convertPointToPixel(t[Wr[P.keywordIndex]][yi[P.keywordIndex]]),0==t[Wr[P.keywordIndex]][S[P.keywordIndex]].length&&t[Wr[P.keywordIndex]][S[P.keywordIndex]].push({i:[]}),P.parseBody(t[Wr[P.keywordIndex]][S[P.keywordIndex]],a.childWidgets,a),(d.textFrame=a).containerShape=d),d.line=m,P.checkAndApplyRevision(P.keywordIndex,t,d),m.children.push(d),u.floatingElements.push(d)}else if(t.hasOwnProperty(Fo[P.keywordIndex])){for(var h=new E("Inline"),s=new E("Inline"),c=(P.parseContentControlProperties(t[Fo[P.keywordIndex]],h.contentControlProperties),s.contentControlProperties=h.contentControlProperties,h.line=m,s.line=m,h.type=0,s.type=1,m.children.push(h),P.parseParagraph(t[ko[P.keywordIndex]],u,g,m),m.children[m.children.length-1]);!(c instanceof E);)c.contentControlProperties=h.contentControlProperties,c=c.previousElement;m.children.push(s),b=!0}v=e}(t),t=v;return this.isCutPerformed=!1,e||u.childWidgets.push(m),b},l.prototype.parseFormFieldData=function(e,t,i){return i instanceof Ch||i instanceof Fh||i instanceof Sh?(i instanceof Fh?(i.sizeType=t.sizeType,i.size=t.size,i.defaultValue=t.defaultValue,i.checked=t.checked):i instanceof Ch?(i.type=t.type,i.maxLength=t.maxLength,i.defaultValue=t.defaultValue,i.format=t.format):(i.dropdownItems=t.dropdownItems,i.selectedIndex=t.selectedIndex),i.name=t.name,i.enabled=t.enabled,i.helpText=t.helpText,i.statusText=t.statusText):(t[Gr[e]].hasOwnProperty(Yr[e])?((i=new Ch).type=this.getTextFormFieldType(t[Gr[e]][Yr[e]][aa[e]]),i.maxLength=t[Gr[e]][Yr[e]][eo[e]],i.defaultValue=t[Gr[e]][Yr[e]][to[e]],i.format=this.getTextFormFieldFormat(t[Gr[e]][Yr[e]][io[e]])):t[Gr[e]].hasOwnProperty(Qr[e])?((i=new Fh).sizeType=this.getCheckBoxSizeType(t[Gr[e]][Qr[e]][no[e]]),i.size=t[Gr[e]][Qr[e]][ro[e]],i.defaultValue=j.parseBoolValue(t[Gr[e]][Qr[e]][to[e]]),i.checked=j.parseBoolValue(t[Gr[e]][Qr[e]][oo[e]])):((i=new Sh).dropdownItems=t[Gr[e]][$r[e]][so[e]],i.selectedIndex=t[Gr[e]][$r[e]][ao[e]]),i.name=t[Gr[e]][dt[e]],i.enabled=j.parseBoolValue(t[Gr[e]][Zr[e]]),i.helpText=t[Gr[e]][Xr[e]],i.statusText=t[Gr[e]][Jr[e]]),i},l.prototype.applyCharacterStyle=function(e,t){_.isNullOrUndefined(e[Ae[this.keywordIndex]])||_.isNullOrUndefined(e[Ae[this.keywordIndex]][Pt[this.keywordIndex]])||(e=this.documentHelper.styles.findByName(e[Ae[this.keywordIndex]][Pt[this.keywordIndex]],"Character"),t.characterFormat.applyStyle(e))},l.prototype.parseEditableRangeStart=function(e){var t=new Wc;return _.isNullOrUndefined(e[Ks[this.keywordIndex]])||(t.columnFirst=e[Ks[this.keywordIndex]]),_.isNullOrUndefined(e[Zs[this.keywordIndex]])||(t.columnLast=e[Zs[this.keywordIndex]]),_.isNullOrUndefined(e[Gs[this.keywordIndex]])||(t.editRangeId=e[Gs[this.keywordIndex]]),_.isNullOrUndefined(e[Xs[this.keywordIndex]])||(t.user=e[Xs[this.keywordIndex]],-1===this.documentHelper.userCollection.indexOf(t.user)&&this.documentHelper.userCollection.push(t.user),this.addEditRangeCollection(t.user,t)),_.isNullOrUndefined(e[Js[this.keywordIndex]])||""===e[Js[this.keywordIndex]]||(t.group=e[Js[this.keywordIndex]],t.group="everyone"===t.group?"Everyone":t.group,-1===this.documentHelper.userCollection.indexOf(t.group)&&this.documentHelper.userCollection.push(t.group),this.addEditRangeCollection(t.group,t)),t},l.prototype.addEditRangeCollection=function(e,t){var i;this.documentHelper.editRanges.containsKey(e)?this.documentHelper.editRanges.get(e).push(t):((i=[]).push(t),this.documentHelper.editRanges.add(e,i))},l.prototype.parseChartTitleArea=function(e,t){t.chartfontName=e[Ia[this.keywordIndex]],t.chartFontSize=e[It[this.keywordIndex]],this.parseChartDataFormat(e[cn[this.keywordIndex]],t.dataFormat),this.parseChartLayout(e[hn[this.keywordIndex]],t.layout)},l.prototype.parseChartDataFormat=function(e,t){t.fill.color=e[Er[this.keywordIndex]][fn[this.keywordIndex]],t.fill.rgb=e[Er[this.keywordIndex]][ya[this.keywordIndex]],t.line.color=e[mn[this.keywordIndex]][Or[this.keywordIndex]],t.line.rgb=e[mn[this.keywordIndex]][ya[this.keywordIndex]]},l.prototype.parseChartLayout=function(e,t){t.chartLayoutLeft=e[yn[this.keywordIndex]],t.chartLayoutTop=e[vn[this.keywordIndex]]},l.prototype.parseChartLegend=function(e,t){t.chartLegendPostion=e[qs[this.keywordIndex]],this.parseChartTitleArea(e[$n[this.keywordIndex]],t.chartTitleArea)},l.prototype.parseChartCategoryAxis=function(e,t){t.categoryAxisType=e[Xn[this.keywordIndex]],t.categoryNumberFormat=e[Ns[this.keywordIndex]],e.hasOwnProperty(da[this.keywordIndex])&&(t.isAutoInternal=j.parseBoolValue(e[da[this.keywordIndex]])),t.interval=e[la[this.keywordIndex]],t.axisFontSize=e[It[this.keywordIndex]],t.axisFontName=e[Ia[this.keywordIndex]],t.max=e[ha[this.keywordIndex]],t.min=e[ca[this.keywordIndex]],t.majorGridLines=j.parseBoolValue(e[pa[this.keywordIndex]]),t.minorGridLines=j.parseBoolValue(e[ua[this.keywordIndex]]),t.majorTick=e[ga[this.keywordIndex]],t.minorTick=e[ma[this.keywordIndex]],t.tickPosition=e[fa[this.keywordIndex]],t.categoryAxisTitle=e[rr[this.keywordIndex]],null!=e[rr[this.keywordIndex]]&&this.parseChartTitleArea(e[$n[this.keywordIndex]],t.chartTitleArea)},l.prototype.parseChartDataTable=function(e,t){t.showSeriesKeys=j.parseBoolValue(e[jn[this.keywordIndex]]),t.hasHorzBorder=j.parseBoolValue(e[Gn[this.keywordIndex]]),t.hasVertBorder=j.parseBoolValue(e[Kn[this.keywordIndex]]),t.hasBorders=j.parseBoolValue(e[Zn[this.keywordIndex]])},l.prototype.parseChartArea=function(e,t){t.chartForeColor=e[fn[this.keywordIndex]]},l.prototype.parseChartData=function(e,t){for(var i=0;i<e[Jn[this.keywordIndex]].length;i++){var n=new Ac,r=e[Jn[this.keywordIndex]][i];r.hasOwnProperty(gn[this.keywordIndex])&&(n.xName=r[gn[this.keywordIndex]]);for(var o=0;o<r[un[this.keywordIndex]].length;o++){var s=new Uc,a=r[un[this.keywordIndex]][o];s.yAxisValue=a[pn[this.keywordIndex]],"Bubble"===e[or[this.keywordIndex]]&&(s.bubbleSize=a[ro[this.keywordIndex]]),n.chartData.push(s)}t.chartCategory.push(n)}this.parseChartSeries(e,t)},l.prototype.parseChartSeries=function(e,t){for(var i=e[or[this.keywordIndex]],n="Pie"===i||"Doughnut"===i,r=0;r<e[Yn[this.keywordIndex]].length;r++){var o,s,a=new _c,l=e[Yn[this.keywordIndex]][r];l.hasOwnProperty(Nn[this.keywordIndex])&&(a.seriesName=l[Nn[this.keywordIndex]],n&&(l.hasOwnProperty(Rn[this.keywordIndex])&&(a.firstSliceAngle=l[Rn[this.keywordIndex]]),"Doughnut"===i)&&(a.doughnutHoleSize=l[Mn[this.keywordIndex]]),l.hasOwnProperty(Wn[this.keywordIndex])&&this.parseChartDataLabels(l[Wn[this.keywordIndex]],a),l.hasOwnProperty(En[this.keywordIndex])&&(o=new Zc,s=l[En[this.keywordIndex]],o.markerStyle=s[Cn[this.keywordIndex]],o.markerColor=s[In[this.keywordIndex]],o.numberValue=s[kn[this.keywordIndex]],a.seriesFormat=o),l.hasOwnProperty(On[this.keywordIndex])&&((s=a.errorBar).errorType=l[On[this.keywordIndex]][aa[this.keywordIndex]],s.errorDirection=l[On[this.keywordIndex]][wn[this.keywordIndex]],s.errorEndStyle=l[On[this.keywordIndex]][bn[this.keywordIndex]],s.numberValue=l[On[this.keywordIndex]][xn[this.keywordIndex]]),l.hasOwnProperty(Ln[this.keywordIndex])&&this.parseChartTrendLines(l[Ln[this.keywordIndex]],a),this.parseChartSeriesDataPoints(l[Bn[this.keywordIndex]],a)),t.chartSeries.push(a)}},l.prototype.parseChartDataLabels=function(e,t){var i=new Jc;i.labelPosition=e[qs[this.keywordIndex]],i.fontName=e[Ia[this.keywordIndex]],i.fontColor=e[kt[this.keywordIndex]],i.fontSize=e[It[this.keywordIndex]],i.isLegendKey=j.parseBoolValue(e[An[this.keywordIndex]]),i.isBubbleSize=j.parseBoolValue(e[Dn[this.keywordIndex]]),i.isCategoryName=j.parseBoolValue(e[Un[this.keywordIndex]]),i.isSeriesName=j.parseBoolValue(e[Vn[this.keywordIndex]]),i.isValue=j.parseBoolValue(e[zn[this.keywordIndex]]),i.isPercentage=j.parseBoolValue(e[qn[this.keywordIndex]]),i.isLeaderLines=j.parseBoolValue(e[_n[this.keywordIndex]]),t.dataLabels=i},l.prototype.parseChartSeriesDataPoints=function(e,t){for(var i=0;i<e.length;i++){var n=new ip;this.parseChartDataFormat(e[i],n),t.chartDataFormat.push(n)}},l.prototype.parseChartTrendLines=function(e,t){for(var i=0;i<e.length;i++){var n=e[i],r=new Qc;r.trendLineName=n[dt[this.keywordIndex]],r.trendLineType=n[aa[this.keywordIndex]],r.forwardValue=n[Fn[this.keywordIndex]],r.backwardValue=n[Pn[this.keywordIndex]],r.interceptValue=n[Tn[this.keywordIndex]],r.isDisplayEquation=j.parseBoolValue(n[Hn[this.keywordIndex]]),r.isDisplayRSquared=j.parseBoolValue(n[Sn[this.keywordIndex]]),t.trendLines.push(r)}},l.prototype.parseTableFormat=function(e,t,i){this.parseBorders(i,e[si[i]],t.borders),_.isNullOrUndefined(e[ji[i]])||(t.allowAutoFit=j.parseBoolValue(e[ji[i]])),_.isNullOrUndefined(e[Gi[i]])||(t.cellSpacing=e[Gi[i]]),_.isNullOrUndefined(e[gi[i]])||(t.leftMargin=e[gi[i]]),_.isNullOrUndefined(e[fi[i]])||(t.topMargin=e[fi[i]]),_.isNullOrUndefined(e[mi[i]])||(t.rightMargin=e[mi[i]]),_.isNullOrUndefined(e[yi[i]])||(t.bottomMargin=e[yi[i]]),_.isNullOrUndefined(e[_t[i]])||(t.leftIndent=e[_t[i]]),this.parseShading(e[Ki[i]],t.shading,i),_.isNullOrUndefined(e[Zi[i]])||(t.tableAlignment=this.getTableAlignment(e[Zi[i]])),_.isNullOrUndefined(e[Xi[i]])||(t.preferredWidth=e[Xi[i]]),_.isNullOrUndefined(e[Ji[i]])||(t.preferredWidthType=this.getWidthType(e[Ji[i]])),_.isNullOrUndefined(e[Tt[i]])||(t.bidi=j.parseBoolValue(e[Tt[i]])),_.isNullOrUndefined(e[Yi[i]])||(t.horizontalPositionAbs=this.getHorizontalPositionAbs(e[Yi[i]])),_.isNullOrUndefined(e[fs[i]])||(t.horizontalPosition=e[fs[i]]),_.isNullOrUndefined(e[Pt[i]])||(t.styleName=e[Pt[i]]),this.documentHelper.owner.enableCollaborativeEditing&&!_.isNullOrUndefined(e[Ho[i]])&&(t.title=e[Ho[i]]),this.documentHelper.owner.enableCollaborativeEditing&&!_.isNullOrUndefined(e[is[i]])&&(t.description=e[is[i]])},l.prototype.parseCellFormat=function(e,t,i){_.isNullOrUndefined(e)||(this.parseBorders(i,e[si[i]],t.borders),e.isSamePaddingAsTable||this.parseCellMargin(e,t,i),_.isNullOrUndefined(e[Oi[i]])||(t.cellWidth=e[Oi[i]]),_.isNullOrUndefined(e[Ei[i]])||(t.columnSpan=e[Ei[i]]),_.isNullOrUndefined(e[Li[i]])||(t.rowSpan=e[Li[i]]),this.parseShading(e[Ki[i]],t.shading,i),_.isNullOrUndefined(e[Bi[i]])||(t.verticalAlignment=this.getCellVerticalAlignment(e[Bi[i]])),_.isNullOrUndefined(e[Ji[i]])||(t.preferredWidthType=this.getWidthType(e[Ji[i]])),_.isNullOrUndefined(e[Xi[i]]))||(t.preferredWidth=e[Xi[i]])},l.prototype.parseCellMargin=function(e,t,i){_.isNullOrUndefined(e[gi[i]])||(t.leftMargin=e[gi[i]]),_.isNullOrUndefined(e[mi[i]])||(t.rightMargin=e[mi[i]]),_.isNullOrUndefined(e[fi[i]])||(t.topMargin=e[fi[i]]),_.isNullOrUndefined(e[yi[i]])||(t.bottomMargin=e[yi[i]])},l.prototype.parseRowFormat=function(e,t,i){_.isNullOrUndefined(e)||(_.isNullOrUndefined(e[Ri[i]])||(t.allowBreakAcrossPages=j.parseBoolValue(e[Ri[this.keywordIndex]])),_.isNullOrUndefined(e[Mi[i]])||(t.isHeader=j.parseBoolValue(e[Mi[i]])),_.isNullOrUndefined(e[Ai[i]])||(t.heightType=this.getHeightType(e[Ai[i]])),_.isNullOrUndefined(e[fr[i]])||(t.height=e[fr[i]]),_.isNullOrUndefined(e[gi[i]])||(t.leftMargin=e[gi[i]]),_.isNullOrUndefined(e[fi[i]])||(t.topMargin=e[fi[i]]),_.isNullOrUndefined(e[mi[i]])||(t.rightMargin=e[mi[i]]),_.isNullOrUndefined(e[yi[i]])||(t.bottomMargin=e[yi[i]]),_.isNullOrUndefined(e[_t[i]])||(t.leftIndent=e[_t[i]]),!_.isNullOrUndefined(e[Dt[i]])&&0<e[Dt[i]].length&&this.checkAndApplyRevision(i,e,t),this.parseRowGridValues(e,t,i),this.parseBorders(i,e[si[i]],t.borders))},l.prototype.parseBorders=function(e,t,i){_.isNullOrUndefined(t)||(i.isParsing=!0,this.parseBorder(e,t[zr[e]],i.left),this.parseBorder(e,t[Vr[e]],i.right),this.parseBorder(e,t[Dr[e]],i.top),this.parseBorder(e,t[Ur[e]],i.bottom),this.parseBorder(e,t[rn[e]],i.vertical),this.parseBorder(e,t[on[e]],i.horizontal),this.parseBorder(e,t[an[e]],i.diagonalDown),this.parseBorder(e,t[sn[e]],i.diagonalUp),i.isParsing=!1)},l.prototype.parseBorder=function(e,t,i){_.isNullOrUndefined(t)||(_.isNullOrUndefined(t[Or[e]])||(i.color=this.getColor(t[Or[e]])),_.isNullOrUndefined(t[ln[e]])||(i.lineStyle=this.getLineStyle(t[ln[e]])),_.isNullOrUndefined(t[dn[e]])||(i.lineWidth=t[dn[e]]),_.isNullOrUndefined(t[nn[e]])||(i.hasNoneStyle=j.parseBoolValue(t[nn[e]])),_.isNullOrUndefined(t[Qs[e]])||(i.space=t[Qs[e]]),_.isNullOrUndefined(t[tn[e]]))||(i.shadow=j.parseBoolValue(t[tn[e]]))},l.prototype.parseShading=function(e,t,i){_.isNullOrUndefined(e)||(_.isNullOrUndefined(e[$i[i]])||(t.backgroundColor=this.getColor(e[$i[i]])),_.isNullOrUndefined(e[en[i]])||(t.foregroundColor=this.getColor(e[en[i]])),_.isNullOrUndefined(e[Qi[i]])&&_.isNullOrUndefined(e.textureStyle))||(t.textureStyle=_.isNullOrUndefined(e[Qi[i]])?this.getTextureStyle(e.textureStyle):this.getTextureStyle(e[Qi[i]]))},l.prototype.parseCharacterFormat=function(e,t,i,n){_.isNullOrUndefined(t)||(n&&t.hasOwnProperty(Ca[e])?this.parseCharacterFormat(e,t.inlineFormat,i):(_.isNullOrUndefined(t[bt[e]])||(i.baselineAlignment=this.getBaseAlignment(t[bt[e]])),_.isNullOrUndefined(t[vt[e]])||(i.underline=this.getUnderline(t[vt[e]])),_.isNullOrUndefined(t[wt[e]])||(i.underlineColor=this.getColor(t[wt[e]])),_.isNullOrUndefined(t[xt[e]])||(i.strikethrough=this.getStrikethrough(t[xt[e]])),_.isNullOrUndefined(t[It[e]])||(t[It[e]]=parseFloat(t[It[e]]),10*t[It[e]]%10!=0&&(n=10*t[It[e]].toFixed(1),t[It[e]]=n%5==0?t[It[e]].toFixed(1):Math.round(t[It[e]])),n=parseFloat(t[It[e]]),i.fontSize=n<0?0:n),_.isNullOrUndefined(t[Ft[e]])||(-1!==t[Ft[e]].indexOf('"')&&(t[Ft[e]]=t[Ft[e]].replace('"',"")),n=t[Ft[e]],_.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(n)||this.isFontInstalled(n)||(n=this.documentHelper.fontSubstitutionTable.get(n)),i.fontFamily=n,_.isNullOrUndefined(t[Mt[e]])&&(i.fontFamilyFarEast=n),_.isNullOrUndefined(t[Rt[e]])&&(i.fontFamilyAscii=n),_.isNullOrUndefined(t[At[e]])&&(i.fontFamilyNonFarEast=n)),_.isNullOrUndefined(t[ft[e]])||(i.bold=j.parseBoolValue(t[ft[e]])),_.isNullOrUndefined(t[yt[e]])||(i.italic=j.parseBoolValue(t[yt[e]])),_.isNullOrUndefined(t[Ct[e]])||(i.highlightColor=this.getHighlightColor(t[Ct[e]])),_.isNullOrUndefined(t[kt[e]])||(i.fontColor=this.getColor(t[kt[e]])),_.isNullOrUndefined(t[Tt[e]])||(i.bidi=j.parseBoolValue(t[Tt[e]])),_.isNullOrUndefined(t[St[e]])||(i.bdo=this.getBiDirectionalOverride(t[St[e]])),_.isNullOrUndefined(t[Nt[e]])||(i.fontSizeBidi=t[Nt[e]]<0?0:t[Nt[e]]),_.isNullOrUndefined(t[Wt[e]])||(-1!==t[Wt[e]].indexOf('"')&&(t[Wt[e]]=t[Wt[e]].replace('"',"")),n=t[Wt[e]],_.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(n)||this.isFontInstalled(n)||(n=this.documentHelper.fontSubstitutionTable.get(n)),i.fontFamilyBidi=n),_.isNullOrUndefined(t[Ot[e]])||(i.boldBidi=j.parseBoolValue(t[Ot[e]])),_.isNullOrUndefined(t[Et[e]])||(i.italicBidi=j.parseBoolValue(t[Et[e]])),!_.isNullOrUndefined(t[Dt[e]])&&0<t[Dt[e]].length&&this.checkAndApplyRevision(e,t,i),_.isNullOrUndefined(t[Lt[e]])||(i.allCaps=j.parseBoolValue(t[Lt[e]])),_.isNullOrUndefined(t[mt[e]])||(i.localeIdBidi=t[mt[e]]),_.isNullOrUndefined(t[ut[e]])||(i.localeIdAscii=t[ut[e]]),_.isNullOrUndefined(t[gt[e]])||(i.localeIdFarEast=t[gt[e]]),_.isNullOrUndefined(t[Bt[e]])||(i.complexScript=j.parseBoolValue(t[Bt[e]])),_.isNullOrUndefined(t[Mt[e]])||(-1!==t[Mt[e]].indexOf('"')&&(t[Mt[e]]=t[Mt[e]].replace('"',"")),n=t[Mt[e]],_.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(n)||this.isFontInstalled(n)||(n=this.documentHelper.fontSubstitutionTable.get(n)),i.fontFamilyFarEast=n),_.isNullOrUndefined(t[Rt[e]])||(-1!==t[Rt[e]].indexOf('"')&&(t[Rt[e]]=t[Rt[e]].replace('"',"")),n=t[Rt[e]],_.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(n)||this.isFontInstalled(n)||(n=this.documentHelper.fontSubstitutionTable.get(n)),i.fontFamilyAscii=n),_.isNullOrUndefined(t[At[e]])||(-1!==t[At[e]].indexOf('"')&&(t[At[e]]=t[At[e]].replace('"',"")),n=t[At[e]],_.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(n)||this.isFontInstalled(n)||(n=this.documentHelper.fontSubstitutionTable.get(n)),i.fontFamilyNonFarEast=n),_.isNullOrUndefined(t[Vt[e]])||(i.characterSpacing=t[Vt[e]]),_.isNullOrUndefined(t[zt[e]])||(i.scaling=t[zt[e]])))},l.prototype.isFontInstalled=function(e){var t,i,n;return this.fontInfoCollection.containsKey(e)?this.fontInfoCollection.get(e):(n=this.getWidth("monospace"),t=this.getWidth("sans-serif"),i=this.getWidth("serif"),n=n!==this.getWidth(e+", monospace",n)||t!==this.getWidth(e+", sans-serif",t)||i!==this.getWidth(e+", serif",i),this.fontInfoCollection.add(e,n),n)},l.prototype.getWidth=function(e,t){var i=document.createElement("span");return i.innerHTML=Array(100).join("wi"),i.style.cssText=["position:absolute","width:auto","font-size:128px","left:-99999px"].join(" !important;"),i.style.fontFamily=e,document.body.appendChild(i),e=i.clientWidth,""!==i.style.fontFamily||_.isNullOrUndefined(t)||(e=t),document.body.removeChild(i),e},l.prototype.getColor=function(e){return e||"#ffffff"},l.prototype.parseThemes=function(e,t){this.parseFontScheme(e[$s[this.keywordIndex]],t)},l.prototype.parseFontScheme=function(e,t){_.isNullOrUndefined(e[ea[this.keywordIndex]])||(t.fontScheme.fontSchemeName=e[ea[this.keywordIndex]]),_.isNullOrUndefined(e[ta[this.keywordIndex]])||this.parseMajorMinorFontScheme(e[ta[this.keywordIndex]],t.fontScheme.majorFontScheme),_.isNullOrUndefined(e[ia[this.keywordIndex]])||this.parseMajorMinorFontScheme(e[ia[this.keywordIndex]],t.fontScheme.minorFontScheme)},l.prototype.parseMajorMinorFontScheme=function(e,t){if(!_.isNullOrUndefined(e[ra[this.keywordIndex]])&&0<Object.keys(e[ra[this.keywordIndex]]).length){for(var i=0,n=Object.keys(e[ra[this.keywordIndex]]);i<n.length;i++){var r=n[i];t.fontTypeface.add(r,e[ra[this.keywordIndex]][r])}this.documentHelper.hasThemes=!0}if(!_.isNullOrUndefined(e[na[this.keywordIndex]])&&0<e[na[this.keywordIndex]].length){for(var o=0;o<e[na[this.keywordIndex]].length;o++){var s=e[na[this.keywordIndex]][o],a=new yd;a.name=_.isNullOrUndefined(s.fontName)?s[dt[this.keywordIndex]]:s[Ia[this.keywordIndex]],a.typeface=_.isNullOrUndefined(s.fontTypeface)?s[oa[this.keywordIndex]]:s.fontTypeface,a.panose=_.isNullOrUndefined(s.pnose)?s[sa[this.keywordIndex]]:s.pnose,t.fontSchemeList.push(a)}this.documentHelper.hasThemes=!0}},l.prototype.parseParagraphFormat=function(e,t,i){_.isNullOrUndefined(t)||(_.isNullOrUndefined(t[si[e]])||this.parseBorders(e,t[si[e]],i.borders),_.isNullOrUndefined(t[Tt[e]])||(i.bidi=j.parseBoolValue(t[Tt[e]])),_.isNullOrUndefined(t[_t[e]])||(i.leftIndent=t[_t[e]]),_.isNullOrUndefined(t[jt[e]])||(i.rightIndent=t[jt[e]]),_.isNullOrUndefined(t[Gt[e]])||(i.firstLineIndent=t[Gt[e]]),_.isNullOrUndefined(t[Zt[e]])||(i.afterSpacing=t[Zt[e]]),_.isNullOrUndefined(t[Xt[e]])||(i.beforeSpacing=t[Xt[e]]),_.isNullOrUndefined(t[Yt[e]])||(i.spaceBeforeAuto=j.parseBoolValue(t[Yt[e]])),_.isNullOrUndefined(t[Jt[e]])||(i.spaceAfterAuto=j.parseBoolValue(t[Jt[e]])),_.isNullOrUndefined(t[Qt[e]])||(i.lineSpacing=t[Qt[e]]),_.isNullOrUndefined(t[$t[e]])?_.isNullOrUndefined(t[Qt[e]])||(i.lineSpacingType="Multiple"):i.lineSpacingType=this.getLineSpacingType(t[$t[e]]),_.isNullOrUndefined(t[Kt[e]])||(i.textAlignment=this.getTextAlignment(t[Kt[e]])),_.isNullOrUndefined(t[ri[e]])||(i.outlineLevel=this.getOutlineLevel(t[ri[e]])),_.isNullOrUndefined(t[oi[e]])||(i.contextualSpacing=j.parseBoolValue(t[oi[e]])),_.isNullOrUndefined(t[ti[e]])||(i.keepWithNext=j.parseBoolValue(t[ti[e]])),_.isNullOrUndefined(t[ni[e]])||(i.keepLinesTogether=j.parseBoolValue(t[ni[e]])),_.isNullOrUndefined(t[ii[e]])||(i.widowControl=j.parseBoolValue(t[ii[e]])),i.listFormat=new ja(i),t.hasOwnProperty(ei[e])&&this.parseListFormat(e,t,i.listFormat),t.hasOwnProperty(ai[e])&&this.parseTabStop(e,t[ai[e]],i.tabs))},l.prototype.parseListFormat=function(e,t,i){_.isNullOrUndefined(t[ei[e]])||(_.isNullOrUndefined(t[ei[e]][Ut[e]])||(i.listId=t[ei[e]][Ut[e]],i.list=this.documentHelper.getListById(t[ei[e]][Ut[e]])),_.isNullOrUndefined(t[ei[e]][Es])?_.isNullOrUndefined(i.list)||(i.nsid=i.list.nsid):i.nsid=t[ei[e]][Es],_.isNullOrUndefined(t[ei[e]][qt[e]]))||(i.listLevelNumber=t[ei[e]][qt[e]])},l.prototype.parseSectionFormat=function(e,t,i){if(_.isNullOrUndefined(t[pi[e]])||(i.pageWidth=t[pi[e]]),_.isNullOrUndefined(t[ui[e]])||(i.pageHeight=t[ui[e]]),_.isNullOrUndefined(t[gi[e]])||(i.leftMargin=t[gi[e]]),_.isNullOrUndefined(t[fi[e]])||(i.topMargin=t[fi[e]]),_.isNullOrUndefined(t[mi[e]])||(i.rightMargin=t[mi[e]]),_.isNullOrUndefined(t[yi[e]])||(i.bottomMargin=t[yi[e]]),_.isNullOrUndefined(t[li[e]])||(i.headerDistance=t[li[e]]),_.isNullOrUndefined(t[di[e]])||(i.footerDistance=t[di[e]]),_.isNullOrUndefined(t[hi[e]])||(i.differentFirstPage=j.parseBoolValue(t[hi[e]])),_.isNullOrUndefined(t[ci[e]])||(i.differentOddAndEvenPages=j.parseBoolValue(t[ci[e]])),_.isNullOrUndefined(t[Tt[e]])||(i.bidi=j.parseBoolValue(t[Tt[e]])),_.isNullOrUndefined(t[vi[e]])||(i.restartPageNumbering=j.parseBoolValue(t[vi[e]])),_.isNullOrUndefined(t[wi[e]])||(i.pageStartingNumber=t[wi[e]]),_.isNullOrUndefined(t[bi[e]])||(i.endnoteNumberFormat=this.getFootEndNoteNumberFormat(t[bi[e]])),_.isNullOrUndefined(t[xi[e]])||(i.footNoteNumberFormat=this.getFootEndNoteNumberFormat(t[xi[e]])),_.isNullOrUndefined(t[Ci[e]])||(i.restartIndexForFootnotes=this.getFootnoteRestartIndex(t[Ci[e]])),_.isNullOrUndefined(t[Ii[e]])||(i.restartIndexForEndnotes=this.getFootnoteRestartIndex(t[Ii[e]])),_.isNullOrUndefined(t[ki[e]])||(i.initialFootNoteNumber=t[ki[e]]),_.isNullOrUndefined(t[Fi[e]])||(i.initialEndNoteNumber=t[Fi[e]]),_.isNullOrUndefined(t[Pi[e]])||(i.pageNumberStyle=t[Pi[e]]),!_.isNullOrUndefined(t[Ti[e]])&&!_.isNullOrUndefined(t[Si[e]])&&1<t[Si[e]]&&(i.numberOfColumns=t[Si[e]],i.equalWidth=j.parseBoolValue(t[Hi[e]]),i.lineBetweenColumns=j.parseBoolValue(t[Ni[e]]),t[Ti[e]]))for(var n=0;n<t[Ti[e]].length;n++){var r=new Da;r.width=j.convertPointToPixel(t[Ti[e]][n][mr[e]]),r.space=j.convertPointToPixel(t[Ti[e]][n][Qs[e]]),r.index=n,i.columns.push(r)}_.isNullOrUndefined(t[Wi[e]])||(i.breakCode=t[Wi[e]])},l.prototype.parseColumns=function(e,t){if(t=[],e)for(var i=0;i<e.length;i++){var n=new Da;n.width=j.convertPointToPixel(e[i][mr[this.keywordIndex]]),n.space=j.convertPointToPixel(e[i][Qs[this.keywordIndex]]),n.index=i,t.push(n)}},l.prototype.parseTabStop=function(e,t,i){if(t)for(var n=0;n<t.length;n++){var r,o=t[n];0<Object.keys(o).length&&((r=new Ka).position=o[qs[e]],r.tabLeader=this.getTabLeader(o[js[e]]),r.deletePosition=o[_s[e]],r.tabJustification=this.getTabJustification(o[zs[e]]),i.push(r))}},l.prototype.validateImageUrl=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;return e.charAt(e.length-1)===t.charAt(64)&&i--,e.charAt(e.length-2)===t.charAt(64)&&i--,i%1==0},l.prototype.containsFieldBegin=function(e){for(var t=void 0,i=e.children.length-1;0<=i;i--){if((t=e.children[i])instanceof Z&&t.hasFieldEnd&&t.nextElement instanceof X)return t.nextElement;if(t instanceof Z)return}return t},l.prototype.getBaseAlignment=function(e){switch(e){case 0:return"Normal";case 1:return"Superscript";case 2:return"Subscript";default:return e}},l.prototype.getUnderline=function(e){switch(e){case 0:return"None";case 1:return"Single";case 2:return"Words";case 3:return"Double";case 4:return"Dotted";case 5:return"Thick";case 6:return"Dash";case 7:return"DashLong";case 8:return"DotDash";case 9:return"DotDotDash";case 10:return"Wavy";case 11:return"DottedHeavy";case 12:return"DashHeavy";case 13:return"DashLongHeavy";case 14:return"DotDashHeavy";case 15:return"DotDotDashHeavy";case 16:return"WavyHeavy";case 17:return"WavyDouble";default:return e}},l.prototype.getStrikethrough=function(e){switch(e){case 0:return"None";case 1:return"SingleStrike";case 2:return"DoubleStrike";default:return e}},l.prototype.getHighlightColor=function(e){switch(e){case 0:return"NoColor";case 1:return"Yellow";case 2:return"BrightGreen";case 3:return"Turquoise";case 4:return"Pink";case 5:return"Blue";case 6:return"Red";case 7:return"DarkBlue";case 8:return"Teal";case 9:return"Green";case 10:return"Violet";case 11:return"DarkRed";case 12:return"DarkYellow";case 13:return"Gray50";case 14:return"Gray25";case 15:return"Black";default:return e}},l.prototype.getLineSpacingType=function(e){switch(e){case 0:return"Multiple";case 1:return"AtLeast";case 2:return"Exactly";default:return e}},l.prototype.getOutlineLevel=function(e){switch(e){case 0:return"BodyText";case 1:return"Level1";case 2:return"Level2";case 3:return"Level3";case 4:return"Level4";case 5:return"Level5";case 6:return"Level6";case 7:return"Level7";case 8:return"Level8";case 9:return"Level9";default:return e}},l.prototype.getTextAlignment=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Right";case 3:return"Justify";default:return e}},l.prototype.getWidthType=function(e){switch(e){case 0:return"Auto";case 1:return"Percent";case 2:return"Point";default:return e}},l.prototype.getTableAlignment=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Right";default:return e}},l.prototype.getLineStyle=function(e){switch(e){case 0:return"Single";case 1:return"None";case 2:return"Dot";case 3:return"DashSmallGap";case 4:return"DashLargeGap";case 5:return"DashDot";case 6:return"DashDotDot";case 7:return"Double";case 8:return"Triple";case 9:return"ThinThickSmallGap";case 10:return"ThickThinSmallGap";case 11:return"ThinThickThinSmallGap";case 12:return"ThinThickMediumGap";case 13:return"ThickThinMediumGap";case 14:return"ThinThickThinMediumGap";case 15:return"ThinThickLargeGap";case 16:return"ThickThinLargeGap";case 17:return"ThinThickThinLargeGap";case 18:return"SingleWavy";case 19:return"DoubleWavy";case 20:return"DashDotStroked";case 21:return"Emboss3D";case 22:return"Engrave3D";case 23:return"Outset";case 24:return"Inset";case 25:return"Thick";case 26:return"Cleared";default:return e}},l.prototype.getTextureStyle=function(e){switch(e){case 0:return"TextureNone";case 1:return"Texture2Pt5Percent";case 2:return"Texture5Percent";case 3:return"Texture7Pt5Percent";case 4:return"Texture10Percent";case 5:return"Texture12Pt5Percent";case 6:return"Texture15Percent";case 7:return"Texture17Pt5Percent";case 8:return"Texture20Percent";case 9:return"Texture22Pt5Percent";case 10:return"Texture25Percent";case 11:return"Texture27Pt5Percent";case 12:return"Texture30Percent";case 13:return"Texture32Pt5Percent";case 14:return"Texture35Percent";case 15:return"Texture37Pt5Percent";case 16:return"Texture40Percent";case 17:return"Texture42Pt5Percent";case 18:return"Texture45Percent";case 19:return"Texture47Pt5Percent";case 20:return"Texture50Percent";case 21:return"Texture52Pt5Percent";case 22:return"Texture55Percent";case 23:return"Texture57Pt5Percent";case 24:return"Texture60Percent";case 25:return"Texture62Pt5Percent";case 26:return"Texture65Percent";case 27:return"Texture67Pt5Percent";case 28:return"Texture70Percent";case 29:return"Texture72Pt5Percent";case 30:return"Texture75Percent";case 31:return"Texture77Pt5Percent";case 32:return"Texture80Percent";case 33:return"Texture82Pt5Percent";case 34:return"Texture85Percent";case 35:return"Texture87Pt5Percent";case 36:return"Texture90Percent";case 37:return"Texture92Pt5Percent";case 38:return"Texture95Percent";case 39:return"Texture97Pt5Percent";case 40:return"TextureSolid";case 41:return"TextureDarkHorizontal";case 42:return"TextureDarkVertical";case 43:return"TextureDarkDiagonalDown";case 44:return"TextureDarkDiagonalUp";case 45:return"TextureDarkCross";case 46:return"TextureDarkDiagonalCross";case 47:return"TextureHorizontal";case 48:return"TextureVertical";case 49:return"TextureDiagonalDown";case 50:return"TextureDiagonalUp";case 51:return"TextureCross";case 52:return"TextureDiagonalCross";default:return e}},l.prototype.getHeightType=function(e){switch(e){case 0:return"AtLeast";case 1:return"Exactly";default:return e}},l.prototype.getCellVerticalAlignment=function(e){switch(e){case 0:return"Top";case 1:return"Center";case 2:return"Bottom";default:return e}},l.prototype.getListLevelPattern=function(e){switch(e){case 0:return"None";case 1:case 13:case"KanjiDigit":return"Arabic";case 2:return"UpRoman";case 3:return"LowRoman";case 4:return"UpLetter";case 5:return"LowLetter";case 6:return"Ordinal";case 7:return"Number";case 8:return"OrdinalText";case 9:return"LeadingZero";case 10:return"Bullet";case 11:return"FarEast";case 12:return"Special";default:return e}},l.prototype.getFollowCharacterType=function(e){switch(e){case 0:return"Tab";case 1:return"Space";case 2:return"None";default:return e}},l.prototype.getStyleType=function(e){switch(e){case 0:return"Paragraph";case 1:return"Character";case 2:return"Table";default:return e}},l.prototype.getProtectionType=function(e){switch(e){case 0:return"NoProtection";case 1:return"ReadOnly";case 2:return"FormFieldsOnly";case 3:return"CommentsOnly";case 4:return"RevisionsOnly";default:return e}},l.prototype.getRevisionType=function(e){switch(e){case 1:return"Insertion";case 2:return"Deletion";case 3:return"MoveTo";case 4:return"MoveFrom";default:return e}},l.prototype.getFootnoteType=function(e){switch(e){case 0:return"Footnote";case 1:return"Endnote";default:return e}},l.prototype.getFootnoteRestartIndex=function(e){switch(e){case 0:return"DoNotRestart";case 1:return"RestartForEachSection";case 2:return"RestartForEachPage";default:return e}},l.prototype.getFootEndNoteNumberFormat=function(e){switch(e){case 0:return"Arabic";case 1:return"UpperCaseRoman";case 2:return"LowerCaseRoman";case 3:return"UpperCaseLetter";case 4:return"LowerCaseLetter";default:return e}},l.prototype.getBiDirectionalOverride=function(e){switch(e){case 0:return"None";case 1:return"LTR";case 2:return"RTL";default:return e}},l.prototype.getBreakClearType=function(e){switch(e){case 0:return"None";case 1:return"Left";case 2:return"Right";case 3:return"All";default:return e}},l.prototype.getTextVerticalAlignment=function(e){switch(e){case 0:return"Top";case 1:return"Center";case 2:return"Bottom";default:return e}},l.prototype.getShapeVerticalAlignment=function(e){switch(e){case 0:return"None";case 1:return"Top";case 2:return"Center";case 3:return"Bottom";case 4:return"Inline";case 5:return"Inside";case 6:return"Outside";default:return e}},l.prototype.getShapeHorizontalAlignment=function(e){switch(e){case 0:return"None";case 1:return"Center";case 2:return"Inside";case 3:return"Left";case 4:return"Outside";case 5:return"Right";default:return e}},l.prototype.getVerticalOrigin=function(e){switch(e){case 0:return"Paragraph";case 1:return"BottomMargin";case 2:return"InsideMargin";case 3:return"Line";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"TopMargin";default:return e}},l.prototype.getHorizontalOrigin=function(e){switch(e){case 0:return"Column";case 1:return"Character";case 2:return"InsideMargin";case 3:return"LeftMargin";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"RightMargin";default:return e}},l.prototype.getTableVerticalRelation=function(e){switch(e){case 0:return"Paragraph";case 1:return"Margin";case 2:return"Page";default:return e}},l.prototype.getTableHorizontalRelation=function(e){switch(e){case 0:return"Column";case 1:return"Margin";case 2:return"Page";default:return e}},l.prototype.getTableVerticalPosition=function(e){switch(e){case 0:return"None";case 1:return"Top";case 2:return"Center";case 3:return"Bottom";case 4:return"Inside";case 5:return"Outside";default:return e}},l.prototype.getTableHorizontalPosition=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Inside";case 3:return"Outside";case 4:return"Right";default:return e}},l.prototype.getLineDashStyle=function(e){switch(e){case 0:return"Solid";case 1:return"Dash";case 2:return"DashDot";case 3:return"DashDotDot";case 4:return"DashDotGEL";case 5:return"DashGEL";case 6:return"Dot";case 7:return"DotGEL";case 8:return"LongDashDotDotGEL";case 9:return"LongDashDotGEL";case 10:return"LongDashGEL";default:return e}},l.prototype.getHorizontalPositionAbs=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Right";case 3:return"Inside";case 4:return"Outside";default:return e}},l.prototype.getTabJustification=function(e){switch(e){case 0:return"Left";case 1:return"Bar";case 2:return"Center";case 3:return"Decimal";case 4:return"List";case 5:return"Right";default:return e}},l.prototype.getTabLeader=function(e){switch(e){case 0:return"None";case 1:return"Single";case 2:return"Dot";case 3:return"Hyphen";case 4:return"Underscore";default:return e}},l.prototype.getTextFormFieldType=function(e){switch(e){case 0:return"Text";case 1:return"Number";case 2:return"Date";case 3:return"Calculation";default:return e}},l.prototype.getTextFormFieldFormat=function(e){switch(e){case 0:return"None";case 1:return"FirstCapital";case 2:return"Lowercase";case 3:return"Uppercase";case 4:return"Titlecase";default:return e}},l.prototype.getCheckBoxSizeType=function(e){switch(e){case 0:return"Auto";case 1:return"Exactly";default:return e}},l.prototype.getContentControlAppearance=function(e){switch(e){case 1:return"BoundingBox";case 2:return"Hidden";case 3:return"Tags";default:return e}},l.prototype.getContentControlType=function(e){switch(e){case 0:return"RichText";case 1:return"BuildingBlockGallery";case 2:return"CheckBox";case 3:return"ComboBox";case 4:return"Date";case 5:return"DropDownList";case 6:return"Group";case 7:return"Picture";case 8:return"RepeatingSection";case 9:return"Text";default:return e}},l.prototype.getDateCalendarType=function(e){switch(e){case 0:return"Gregorian";case 1:return"GregorianArabic";case 2:return"GregorianEnglish";case 3:return"GregorianMiddleEastFrench";case 4:return"GregorianTransliteratedEnglish";case 5:return"GregorianTransliteratedFrench";case 6:return"Hebrew";case 7:return"Hijri";case 8:return"Japan";case 9:return"Korean";case 10:return"Saka";case 11:return"Taiwan";case 12:return"Thai";default:return e}},l.prototype.getDateStorageFormat=function(e){switch(e){case 1:return"DateStorageDate";case 2:return"DateStorageDateTime";case 3:return"DateStorageText";default:return e}},l.prototype.getTextWrappingStyle=function(e){switch(e){case 0:return"Inline";case 1:return"InFrontOfText";case 2:return"Square";case 3:return"TopAndBottom";case 4:return"Behind";default:return e}},l.prototype.getTextWrappingType=function(e){switch(e){case 0:return"Both";case 1:return"Left";case 2:return"Right";case 3:return"Largest";default:return e}},l.prototype.getCompatibilityMode=function(e){switch(e){case 0:return"Word2013";case 1:return"Word2003";case 2:return"Word2007";case 3:return"Word2010";default:return e}},l.prototype.getLineFormatType=function(e){switch(e){case 0:return"Solid";case 1:return"Patterned";case 2:return"Gradient";case 3:return"None";default:return e}},l.prototype.getAutoShapeType=function(e){switch(e){case 1:return"Rectangle";case 2:return"RoundedRectangle";case 3:return"StraightConnector";case 4:return"Oval";case 5:return"IsoscelesTriangle";case 6:return"RightTriangle";case 7:return"Parallelogram";case 8:return"Trapezoid";case 9:return"Diamond";case 10:return"RegularPentagon";case 11:return"Hexagon";case 12:return"Heptagon";case 13:return"Octagon";case 14:return"Decagon";case 15:return"Dodecagon";case 16:return"Chord";case 17:return"Teardrop";case 18:return"Frame";case 19:return"HalfFrame";case 20:return"L_Shape";case 21:return"Pie";case 22:return"DiagonalStripe";case 23:return"Cross";case 24:return"Plaque";case 25:return"Can";case 26:return"Cube";case 27:return"Bevel";case 28:return"Donut";case 29:return"NoSymbol";case 30:return"BlockArc";case 31:return"FoldedCorner";case 32:return"SmileyFace";case 33:return"Heart";case 34:return"LightningBolt";case 35:return"Sun";case 36:return"Moon";case 37:return"Cloud";case 38:return"Arc";case 39:return"DoubleBracket";case 40:return"DoubleBrace";case 41:return"LeftBracket";case 42:return"RightBracket";case 43:return"LeftBrace";case 44:return"RightBrace";case 45:return"FlowChartProcess";case 46:return"FlowChartAlternateProcess";case 47:return"FlowChartDecision";case 48:return"FlowChartData";case 49:return"FlowChartPredefinedProcess";case 50:return"FlowChartInternalStorage";case 51:return"FlowChartDocument";case 52:return"FlowChartMultiDocument";case 53:return"FlowChartTerminator";case 54:return"FlowChartPreparation";case 55:return"FlowChartManualInput";case 56:return"FlowChartManualOperation";case 57:return"FlowChartConnector";case 58:return"FlowChartOffPageConnector";case 59:return"FlowChartCard";case 60:return"FlowChartPunchedTape";case 61:return"FlowChartSummingJunction";case 62:return"FlowChartOr";case 63:return"FlowChartCollate";case 64:return"FlowChartSort";case 65:return"FlowChartExtract";case 66:return"FlowChartMerge";case 67:return"FlowChartStoredData";case 68:return"FlowChartDelay";case 69:return"FlowChartSequentialAccessStorage";case 70:return"FlowChartMagneticDisk";case 71:return"FlowChartDirectAccessStorage";case 72:return"FlowChartDisplay";case 73:return"RightArrow";case 74:return"LeftArrow";case 75:return"UpArrow";case 76:return"DownArrow";case 77:return"LeftRightArrow";case 78:return"UpDownArrow";case 79:return"QuadArrow";case 80:return"LeftRightUpArrow";case 81:return"BentArrow";case 82:return"UTurnArrow";case 83:return"LeftUpArrow";case 84:return"BentUpArrow";case 85:return"CurvedRightArrow";case 86:return"CurvedLeftArrow";case 87:return"CurvedUpArrow";case 88:return"CurvedDownArrow";case 89:return"StripedRightArrow";case 90:return"NotchedRightArrow";case 91:return"Pentagon";case 92:return"Chevron";case 93:return"RightArrowCallout";case 94:return"DownArrowCallout";case 95:return"LeftArrowCallout";case 96:return"UpArrowCallout";case 97:return"LeftRightArrowCallout";case 98:return"QuadArrowCallout";case 99:return"CircularArrow";case 100:return"MathPlus";case 101:return"MathMinus";case 102:return"MathMultiply";case 103:return"MathDivision";case 104:return"MathEqual";case 105:return"MathNotEqual";case 106:return"Explosion1";case 107:return"Explosion2";case 108:return"Star4Point";case 109:return"Star5Point";case 110:return"Star6Point";case 111:return"Star7Point";case 112:return"Star8Point";case 113:return"Star10Point";case 114:return"Star12Point";case 115:return"Star16Point";case 116:return"Star24Point";case 117:return"Star32Point";case 118:return"UpRibbon";case 119:return"DownRibbon";case 120:return"CurvedUpRibbon";case 121:return"CurvedDownRibbon";case 122:return"VerticalScroll";case 123:return"HorizontalScroll";case 124:return"Wave";case 125:return"DoubleWave";case 126:return"SnipSingleCornerRectangle";case 127:return"SnipSameSideCornerRectangle";case 128:return"SnipDiagonalCornerRectangle";case 129:return"SnipAndRoundSingleCornerRectangle";case 130:return"RoundSingleCornerRectangle";case 131:return"RoundSameSideCornerRectangle";case 132:return"RoundDiagonalCornerRectangle";case 133:return"Unknown";case 134:return"ElbowConnector";case 135:return"CurvedConnector";default:return e}},l.prototype.destroy=function(){this.footnotes&&this.footnotes.destroy(),this.footnotes=void 0,this.endnotes&&this.endnotes.destroy(),this.endnotes=void 0,this.editableRanges&&this.editableRanges.destroy(),this.editableRanges=void 0,this.commentEnds&&this.commentEnds.destroy(),this.commentEnds=void 0,this.commentStarts&&this.commentStarts.destroy(),this.commentStarts=void 0,this.commentsCollection&&this.commentsCollection.destroy(),this.commentsCollection=void 0,this.revisionCollection&&this.revisionCollection.destroy(),this.revisionCollection=void 0,this.fontInfoCollection&&this.fontInfoCollection.destroy(),this.fontInfoCollection=void 0,this.documentHelper=void 0,this.keywordIndex=void 0};var Ym=l;function l(e){this.documentHelper=void 0,this.commentStarts=void 0,this.commentEnds=void 0,this.commentsCollection=void 0,this.revisionCollection=void 0,this.isPageBreakInsideTable=!1,this.referedRevisions=[],this.isParseHeader=!1,this.footnotes=void 0,this.endnotes=void 0,this.keywordIndex=void 0,this.themes=void 0,this.isCutPerformed=!1,this.isPaste=!1,this.isContextBasedPaste=!1,this.isHtmlPaste=!1,this.documentHelper=e,this.editableRanges=new T}d.prototype.getModuleName=function(){return"WordExport"},Object.defineProperty(d.prototype,"bookmarks",{get:function(){return _.isNullOrUndefined(this.mBookmarks)&&(this.mBookmarks=[]),this.mBookmarks},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"documentImages",{get:function(){return void 0===this.mDocumentImages&&(this.mDocumentImages=new T),this.mDocumentImages},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"svgImages",{get:function(){return void 0===this.mSvgImages&&(this.mSvgImages=new T),this.mSvgImages},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"externalImages",{get:function(){return void 0===this.mExternalLinkImages&&(this.mExternalLinkImages=new T),this.mExternalLinkImages},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"headerFooterImages",{get:function(){return void 0===this.mHeaderFooterImages&&(this.mHeaderFooterImages=new T),this.mHeaderFooterImages},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"headerFooterSvgImages",{get:function(){return void 0===this.mHeaderFooterSvgImages&&(this.mHeaderFooterSvgImages=new T),this.mHeaderFooterSvgImages},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"documentCharts",{get:function(){return void 0===this.mDocumentCharts&&(this.mDocumentCharts=new T),this.mDocumentCharts},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"headersFooters",{get:function(){return void 0===this.mHeaderFooterColl&&(this.mHeaderFooterColl=new T),this.mHeaderFooterColl},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"endnotesFootnotes",{get:function(){return void 0===this.mFootEndnotesColl&&(this.mFootEndnotesColl=new T),this.mFootEndnotesColl},enumerable:!0,configurable:!0}),d.prototype.save=function(e,t,i){var n=this,e=(this.fileName=t,this.serialize(e,i),this.serializeExcelFiles());e&&0<e.length?Promise.all(e).then(function(){n.saveInternal(t,i)}):this.saveInternal(t,i),this.close()},d.prototype.saveInternal=function(e,t){"Docx"===t?this.mArchive.save(e+".docx").then(function(e){e.destroy()}):"Dotx"===t&&this.mArchive.save(e+".dotx").then(function(e){e.destroy()})},d.prototype.saveAsBlob=function(e,t){var i=this,n=(this.serialize(e,t),this.serializeExcelFiles());return new Promise(function(t,e){0<n.length?Promise.all(n).then(function(){i.mArchive.saveAsBlob().then(function(e){i.mArchive.destroy(),e=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),t(e)})}):i.mArchive.saveAsBlob().then(function(e){i.mArchive.destroy(),e=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),t(e)})})},d.prototype.serializeExcelFiles=function(){var i=this,n=this.excelFiles,r=[];if(n&&0<n.length){for(var e=0;e<n.length;e++)!function(e){var t=n.keys[parseInt(e.toString(),10)],e=n.get(t).saveAsBlob();r.push(e),e.then(function(e){e=new f.ZipArchiveItem(e,t);i.mArchive.addItem(e)})}(e);this.excelFiles.clear()}return r},d.prototype.saveExcel=function(){var e=this.defaultEmbeddingPath+"Microsoft_Excel_Worksheet"+this.chartCount+".xlsx";this.excelFiles.add(e,this.mArchiveExcel),this.mArchiveExcel=void 0},d.prototype.destroy=function(){this.clearDocument(),this.mRelationShipID=void 0,this.mDocPrID=void 0,this.mDifferentFirstPage=void 0,this.fileName=void 0,this.imageRelationIds=void 0,this.svgImageRelationIds=void 0,this.mArchive&&(this.mArchive.destroy(),this.mArchive=void 0),this.mArchiveExcel&&(this.mArchiveExcel.destroy(),this.mArchiveExcel=void 0)},d.prototype.serialize=function(e,t){this.keywordIndex=e.owner.documentEditorSettings.optimizeSfdt?1:0;var i=e.owner.sfdtExportModule.write(this.keywordIndex);this.setDocument(i),this.mComments=e.comments,this.mCustomXML=e.customXmlData,this.mImages=e.images,this.revisions=e.owner.revisions.changes,this.mArchive=new f.ZipArchive,this.mArchive.compressionLevel="Normal",this.commentParaIDInfo={},this.commentParaID=0,this.currentCommentId=0,this.commentId={},this.mVerticalMerge=new T,this.mGridSpans=new T,this.imageRelationIds=new T,this.svgImageRelationIds=new T,this.serializeDocument(),this.serializeStyles(),this.serializeNumberings(),this.serializeComments(),this.serializeCommentsExtended(),this.serializeThemes(),this.serializeSettings(),this.serializeCoreProperties(),this.serializeAppProperties(),this.serializeFontTable(void 0),this.serializeSettingsRelation(),this.serializeHeaderFooters(),this.serializeFootnotes(),this.serializeEndnotes(),this.serializeDocumentRelations(),this.serializeGeneralRelations(),this.serializeContentTypes(void 0,t),this.clearDocument()},d.prototype.setDocument=function(e,t){_.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=t),this.document=e,this.mSections=e[Re[this.keywordIndex]],this.mLists=e[Ue[this.keywordIndex]],this.mAbstractLists=e[Ve[this.keywordIndex]],this.defCharacterFormat=e[Ae[this.keywordIndex]],this.defParagraphFormat=e[De[this.keywordIndex]],this.defaultTabWidthValue=e[Ke[this.keywordIndex]],this.themeFontLang=e[at[this.keywordIndex]],this.dontUseHtmlParagraphAutoSpacing=j.parseBoolValue(e[et[this.keywordIndex]]),this.mStyles=e[qe[this.keywordIndex]],this.mThemes=e[lt[this.keywordIndex]],this.formatting=j.parseBoolValue(e[Ze[this.keywordIndex]]),this.enforcement=j.parseBoolValue(e[Ye[this.keywordIndex]]),this.hashValue=e[Qe[this.keywordIndex]],this.saltValue=e[$e[this.keywordIndex]],this.protectionType=e[Je[this.keywordIndex]],this.formFieldShading=j.parseBoolValue(e[it[this.keywordIndex]]),this.trackChanges=j.parseBoolValue(e[Xe[this.keywordIndex]]),this.compatibilityMode=e[st[this.keywordIndex]],this.allowSpaceOfSameStyleInTable=j.parseBoolValue(e[ba[this.keywordIndex]])},d.prototype.clearDocument=function(){this.section=void 0,this.lastSection=void 0,this.blockOwner=void 0,this.paragraph=void 0,this.table=void 0,this.row=void 0,this.headerFooter=void 0,this.commentParaIDInfo={},this.commentParaID=0,this.currentCommentId=0,this.commentId={},this.document=void 0,this.mSections=void 0,this.mLists=void 0,this.mAbstractLists=void 0,this.defCharacterFormat=void 0,this.defParagraphFormat=void 0,this.defaultTabWidthValue=void 0,this.trackChanges=void 0,this.customXMLProps=[],this.mRelationShipID=0,this.eRelationShipId=0,this.cRelationShipId=0,this.efRelationShipId=0,this.mDocPrID=1,this.chartCount=0,this.keywordIndex=void 0,this.mDifferentFirstPage=!1,this.mHeaderFooterColl&&(this.mHeaderFooterColl.destroy(),this.mHeaderFooterColl=void 0),this.mVerticalMerge&&(this.mVerticalMerge.destroy(),this.mVerticalMerge=void 0),this.mGridSpans&&(this.mGridSpans.destroy(),this.mGridSpans=void 0),this.mDocumentImages&&(this.mDocumentImages.destroy(),this.mDocumentImages=void 0),this.mSvgImages&&(this.mSvgImages.destroy(),this.mSvgImages=void 0),this.mExternalLinkImages&&(this.mExternalLinkImages.destroy(),this.mExternalLinkImages=void 0),this.mHeaderFooterImages&&(this.mHeaderFooterImages.destroy(),this.mHeaderFooterImages=void 0),this.mHeaderFooterSvgImages&&(this.mHeaderFooterSvgImages.destroy(),this.mHeaderFooterSvgImages=void 0),this.mDocumentCharts&&(this.mDocumentCharts.destroy(),this.mDocumentCharts=void 0),this.mFootEndnotesColl&&(this.mFootEndnotesColl.destroy(),this.mFootEndnotesColl=void 0)},d.prototype.serializeDocument=function(){var e=new x.XmlWriter,e=(e.writeStartElement("w","document",this.wNamespace),this.writeCommonAttributeStrings(e),e.writeStartElement("w","background",this.wNamespace),e.writeAttributeString("w","color",void 0,this.getColor(this.document[ze[this.keywordIndex]][Or[this.keywordIndex]])),e.writeEndElement(),this.serializeDocumentBody(e),e.writeEndElement(),new f.ZipArchiveItem(e.buffer,this.documentPath));this.mArchive.addItem(e)},d.prototype.writeCommonAttributeStrings=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15 wp14")},d.prototype.writeDup=function(e){e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","wpg",void 0,this.wpGroupNamespace),e.writeAttributeString("xmlns","wpi",void 0,this.wpInkNamespace)},d.prototype.writeCustom=function(e){e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace)},d.prototype.serializeDocumentBody=function(e){e.writeStartElement(void 0,"body",this.wNamespace);for(var t=this.document[Re[this.keywordIndex]].length,i=0;i<t;i++)this.section=this.document[Re[this.keywordIndex]][parseInt(i.toString(),10)],this.lastSection=i===t-1,this.containerWidth=this.section[ks[this.keywordIndex]][pi[this.keywordIndex]]-(this.section[ks[this.keywordIndex]][gi[this.keywordIndex]]+this.section[ks[this.keywordIndex]][mi[this.keywordIndex]]),this.serializeSection(e,this.section,i===t-1),this.section=void 0;e.writeEndElement()},d.prototype.serializeSection=function(e,t,i){this.blockOwner=t,_.isNullOrUndefined(t[S[this.keywordIndex]])||this.serializeBodyItems(e,t[S[this.keywordIndex]],i),i&&this.serializeSectionProperties(e,t),this.blockOwner=void 0},d.prototype.serializeComments=function(){var e;0===this.mComments.length||1===this.mComments.length&&""===this.mComments[0].text||((e=new x.XmlWriter).writeStartElement("w","comments",this.wNamespace),this.serializeCommentCommonAttribute(e),this.serializeCommentInternal(e,this.mComments),e.writeEndElement(),e=new f.ZipArchiveItem(e.buffer,this.commentsPath),this.mArchive.addItem(e))},d.prototype.serializeThemes=function(){if(!_.isNullOrUndefined(this.mThemes)){var e=new x.XmlWriter;e.writeStartElement("a","theme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,"Office Theme"),e.writeStartElement(void 0,"themeElements",this.aNamespace),e.writeRaw('<a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000" /></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF" /></a:lt1><a:dk2><a:srgbClr val="44546A" /></a:dk2><a:lt2><a:srgbClr val="E7E6E6" /></a:lt2><a:accent1><a:srgbClr val="4472C4" /></a:accent1><a:accent2><a:srgbClr val="ED7D31" /></a:accent2><a:accent3><a:srgbClr val="A5A5A5" /></a:accent3><a:accent4><a:srgbClr val="FFC000" /></a:accent4><a:accent5><a:srgbClr val="5B9BD5" /></a:accent5><a:accent6><a:srgbClr val="70AD47" /></a:accent6><a:hlink><a:srgbClr val="0563C1" /></a:hlink><a:folHlink><a:srgbClr val="954F72" /></a:folHlink></a:clrScheme>'),e.writeStartElement(void 0,"fontScheme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,this.mThemes[ea[this.keywordIndex]]),e.writeStartElement(void 0,"majorFont",this.aNamespace);for(var t=0;t<this.mThemes[$s[this.keywordIndex]][ta[this.keywordIndex]][na[this.keywordIndex]].length;t++){var i=this.mThemes[$s[this.keywordIndex]][ta[this.keywordIndex]][na[this.keywordIndex]][parseInt(t.toString(),10)];this.themeFont(e,i)}for(var n=0,r=Object.keys(this.mThemes[$s[this.keywordIndex]][ta[this.keywordIndex]][ra[this.keywordIndex]]);n<r.length;n++){var o=r[n];this.themeType(e,o,this.mThemes[$s[this.keywordIndex]][ta[this.keywordIndex]][ra[this.keywordIndex]][""+o])}e.writeEndElement(),e.writeStartElement(void 0,"minorFont",this.aNamespace);for(t=0;t<this.mThemes[$s[this.keywordIndex]][ia[this.keywordIndex]][na[this.keywordIndex]].length;t++){i=this.mThemes[$s[this.keywordIndex]][ia[this.keywordIndex]][na[this.keywordIndex]][parseInt(t.toString(),10)];this.themeFont(e,i)}for(var s=0,a=Object.keys(this.mThemes[$s[this.keywordIndex]][ia[this.keywordIndex]][ra[this.keywordIndex]]);s<a.length;s++){o=a[s];this.themeType(e,o,this.mThemes[$s[this.keywordIndex]][ia[this.keywordIndex]][ra[this.keywordIndex]][""+o])}e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"fmtScheme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,"Office"),e.writeRaw('<a:fillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:lumMod val="110000" /><a:satMod val="105000" /><a:tint val="67000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:lumMod val="105000" /><a:satMod val="103000" /><a:tint val="73000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:lumMod val="105000" /><a:satMod val="109000" /><a:tint val="81000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:satMod val="103000" /><a:lumMod val="102000" /><a:tint val="94000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:satMod val="110000" /><a:lumMod val="100000" /><a:shade val="100000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:lumMod val="99000" /><a:satMod val="120000" /><a:shade val="78000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="6350" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln><a:ln w="12700" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln><a:ln w="19050" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst /></a:effectStyle><a:effectStyle><a:effectLst /></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="57150" dist="19050" dir="5400000" algn="ctr" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="63000" /></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:solidFill><a:schemeClr val="phClr"><a:tint val="95000" /><a:satMod val="170000" /></a:schemeClr></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="93000" /><a:satMod val="150000" /><a:shade val="98000" /><a:lumMod val="102000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:tint val="98000" /><a:satMod val="130000" /><a:shade val="90000" /><a:lumMod val="103000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="63000" /><a:satMod val="120000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill></a:bgFillStyleLst>'),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();var l=new f.ZipArchiveItem(e.buffer,this.themePath);this.mArchive.addItem(l)}},d.prototype.themeFont=function(e,t){"latin"!==t[dt[this.keywordIndex]]&&"ea"!==t[dt[this.keywordIndex]]&&"cs"!==t[dt[this.keywordIndex]]||(e.writeStartElement(void 0,t[dt[this.keywordIndex]],this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t[oa[this.keywordIndex]]),e.writeAttributeString(void 0,"panose",void 0,t[sa[this.keywordIndex]]),e.writeEndElement())},d.prototype.themeType=function(e,t,i){e.writeStartElement(void 0,"font",this.aNamespace),e.writeAttributeString(void 0,"script",void 0,t),e.writeAttributeString(void 0,"typeface",void 0,i),e.writeEndElement()},d.prototype.serializeCommentCommonAttribute=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","cx",void 0,this.cxNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},d.prototype.serializeCommentInternal=function(e,t){for(var i=0;i<t.length;i++){for(var n=t[parseInt(i.toString(),10)],r=(e.writeStartElement("w","comment",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,this.commentId[n.commentId].toString()),n.author&&" "!==n.author&&e.writeAttributeString("w","author",this.wNamespace,n.author),n.date&&e.writeAttributeString("w","date",this.wNamespace,n.date),n.initial&&""!==n.initial&&e.writeAttributeString("w","initials",this.wNamespace,n.initial),j.commentInlines(n.text,n.mentions,this.keywordIndex)),o=0;o<r.length;o++)this.isInsideComment=!0,this.commentParaID++,this.serializeBodyItem(e,r[parseInt(o.toString(),10)],!0),this.isInsideComment=!1;0===r.length&&(this.isInsideComment=!0,this.commentParaID++),this.commentParaIDInfo[n.commentId]=this.commentParaID,this.isInsideComment=!1,e.writeEndElement(),0<n.replyComments.length&&this.serializeCommentInternal(e,n.replyComments)}},d.prototype.serializeCommentsExtended=function(){var e;0===this.mComments.length||1===this.mComments.length&&""===this.mComments[0].text||((e=new x.XmlWriter).writeStartElement("w15","commentsEx",this.wNamespace),this.serializeCommentCommonAttribute(e),this.serializeCommentsExInternal(e,this.mComments,!1),e.writeEndElement(),e=new f.ZipArchiveItem(e.buffer,this.commentsExtendedPath),this.mArchive.addItem(e))},d.prototype.serializeCommentsExInternal=function(e,t,i){for(var n=0;n<t.length;n++){var r=t[parseInt(n.toString(),10)],o=(e.writeStartElement("w15","commentEx",this.wNamespace),this.commentParaIDInfo[r.commentId]),s=(i&&(s=this.commentParaIDInfo[r.ownerComment.commentId],e.writeAttributeString("w15","paraIdParent",this.wNamespace,s.toString())),e.writeAttributeString("w15","paraId",this.wNamespace,o.toString()),r.done?1:0);e.writeAttributeString("w15","done",this.wNamespace,s.toString()),e.writeEndElement(),0<r.replyComments.length&&this.serializeCommentsExInternal(e,r.replyComments,!0)}},d.prototype.serializeSectionProperties=function(e,t){var i;_.isNullOrUndefined(this.document.optimizeSfdt)||(this.keywordIndex=this.document.optimizeSfdt?1:0),e.writeStartElement("w","sectPr",this.wNamespace),t[Is[this.keywordIndex]]&&this.serializeHFReference(e,t[Is[this.keywordIndex]]),_.isNullOrUndefined(t[ks[this.keywordIndex]][Wi[this.keywordIndex]])||(i=this.getSectionBreakCode(t[ks[this.keywordIndex]][Wi[this.keywordIndex]]),this.serializeSectionType(e,i)),this.serializePageSetup(e,t[ks[this.keywordIndex]]),this.serializeColumns(e,t[ks[this.keywordIndex]]),this.serializeFootNotesPr(e,t[ks[this.keywordIndex]]),this.serializeEndNotesPr(e,t[ks[this.keywordIndex]]),void 0!==t[ks[this.keywordIndex]]&&j.parseBoolValue(t[ks[this.keywordIndex]][hi[this.keywordIndex]])&&(e.writeStartElement(void 0,"titlePg",this.wNamespace),e.writeEndElement()),!_.isNullOrUndefined(t[ks[this.keywordIndex]])&&j.parseBoolValue(t[ks[this.keywordIndex]][Tt[this.keywordIndex]])&&(e.writeStartElement(void 0,"bidi",this.wNamespace),e.writeEndElement()),e.writeEndElement()},d.prototype.getSectionBreakCode=function(e){switch(e){case"NoBreak":return"continuous";case"NewColumn":return"nextColumn";case"EvenPage":return"evenPage";case"Oddpage":return"oddPage";default:return"nextPage"}},d.prototype.serializeFootNotesPr=function(e,t){(t[xi[this.keywordIndex]]||t[Ci[this.keywordIndex]])&&(e.writeStartElement(void 0,"footnotePr",this.wNamespace),e.writeStartElement(void 0,"pos",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"pageBottom"),e.writeEndElement(),void 0!==t[xi[this.keywordIndex]]&&(e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t[xi[this.keywordIndex]])),e.writeEndElement()),void 0!==t[Ci[this.keywordIndex]]&&(e.writeStartElement(void 0,"numRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t[Ci[this.keywordIndex]])),e.writeEndElement()),void 0!==t[ki[this.keywordIndex]]&&(e.writeStartElement(void 0,"numStart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[ki[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement())},d.prototype.getFootNoteNumberFormat=function(e){var t;switch(e){case"UpperCaseRoman":case 1:t="upperRoman";break;case"LowerCaseRoman":case 2:t="lowerRoman";break;case"UpperCaseLetter":case 3:t="upperLetter";break;case"LowerCaseLetter":case 4:t="lowerLetter";break;default:t="decimal"}return t},d.prototype.getFootNoteNumberRestart=function(e){switch(e){case"RestartForEachSection ":case 1:return"eachSect";case"RestartForEachPage":case 2:return"eachPage";default:return"continuous"}},d.prototype.getPageNumberFormat=function(e){var t;switch(e){case"RomanUpper":t="upperRoman";break;case"RomanLower":t="lowerRoman";break;case"LetterUpper":t="upperLetter";break;case"LetterLower":t="lowerLetter";break;default:t="Arabic"}return t},d.prototype.serializeEndNotesPr=function(e,t){(t[bi[this.keywordIndex]]||t[Ii[this.keywordIndex]])&&(e.writeStartElement(void 0,"endnotePr",this.wNamespace),e.writeStartElement(void 0,"pos",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"docEnd"),e.writeEndElement(),void 0!==t[bi[this.keywordIndex]]&&(e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t[bi[this.keywordIndex]])),e.writeEndElement()),void 0!==t[Ii[this.keywordIndex]]&&(e.writeStartElement(void 0,"numRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t[Ii[this.keywordIndex]])),e.writeEndElement()),void 0!==t[Fi[this.keywordIndex]]&&(e.writeStartElement(void 0,"numStart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Fi[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement())},d.prototype.serializeColumns=function(e,t){if(void 0!==t[Si[this.keywordIndex]]&&1<t[Si[this.keywordIndex]]){if(e.writeStartElement(void 0,"cols",this.wNamespace),e.writeAttributeString(void 0,"num",this.wNamespace,t[Si[this.keywordIndex]].toString()),j.parseBoolValue(t[Ni[this.keywordIndex]])&&e.writeAttributeString(void 0,"sep",this.wNamespace,"1"),j.parseBoolValue(t[Hi[this.keywordIndex]]))e.writeAttributeString(void 0,"equalWidth",this.wNamespace,"1");else if(e.writeAttributeString(void 0,"equalWidth",this.wNamespace,"0"),void 0!==t[Ti[this.keywordIndex]]&&0<t[Ti[this.keywordIndex]].length)for(var i=0;i<t[Ti[this.keywordIndex]].length;i++)e.writeStartElement(void 0,"col",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[Ti[this.keywordIndex]][parseInt(i.toString(),10)][mr[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"space",this.wNamespace,this.roundToTwoDecimal(t[Ti[this.keywordIndex]][parseInt(i.toString(),10)][Qs[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeEndElement();e.writeEndElement()}},d.prototype.serializePageSetup=function(e,t){void 0!==t&&(this.serializePageSize(e,t),this.serializePageMargins(e,t),this.serializePageNumberType(e,t)),j.parseBoolValue(t[vi[this.keywordIndex]])&&(e.writeStartElement(void 0,"pgNumType",this.wNamespace),e.writeAttributeString(void 0,"start",this.wNamespace,t[wi[this.keywordIndex]].toString()),e.writeEndElement()),e.writeStartElement(void 0,"pgBorders",this.wNamespace),e.writeEndElement()},d.prototype.serializePageSize=function(e,t){e.writeStartElement(void 0,"pgSz",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[pi[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"h",this.wNamespace,this.roundToTwoDecimal(t[ui[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeEndElement()},d.prototype.serializePageMargins=function(e,t){e.writeStartElement(void 0,"pgMar",this.wNamespace);var i=Math.round(t[fi[this.keywordIndex]]*this.twentiethOfPoint);e.writeAttributeString(void 0,"top",this.wNamespace,i.toString()),i=Math.round(t[mi[this.keywordIndex]]*this.twentiethOfPoint),e.writeAttributeString(void 0,"right",this.wNamespace,i.toString()),i=Math.round(t[yi[this.keywordIndex]]*this.twentiethOfPoint),e.writeAttributeString(void 0,"bottom",this.wNamespace,i.toString()),i=Math.round(t[gi[this.keywordIndex]]*this.twentiethOfPoint),e.writeAttributeString(void 0,"left",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"header",this.wNamespace,this.roundToTwoDecimal(t[li[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"footer",this.wNamespace,this.roundToTwoDecimal(t[di[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"gutter",this.wNamespace,"0"),e.writeEndElement()},d.prototype.serializePageNumberType=function(e,t){void 0!==t[Pi[this.keywordIndex]]&&(e.writeStartElement(void 0,"pgNumType",this.wNamespace),e.writeAttributeString(void 0,"fmt",this.wNamespace,this.getPageNumberFormat(t[Pi[this.keywordIndex]])),e.writeEndElement())},d.prototype.serializeSectionType=function(e,t){e.writeStartElement("w","type",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t),e.writeEndElement()},d.prototype.serializeHFReference=function(e,t){var i,n="";void 0!==t&&(this.mDifferentFirstPage=j.parseBoolValue(this.section[ks[this.keywordIndex]][ci[this.keywordIndex]]),(i=t[xs[this.keywordIndex]])&&i[S[this.keywordIndex]]&&0<i[S[this.keywordIndex]].length&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),n=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,n),this.addHeaderFooter(i,"FirstPageHeader",n),e.writeEndElement()),(i=t[Cs[this.keywordIndex]])&&i[S[this.keywordIndex]]&&0<i[S[this.keywordIndex]].length&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),n=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,n),this.addHeaderFooter(i,"FirstPageFooter",n),e.writeEndElement()),(i=t[ws[this.keywordIndex]])&&i[S[this.keywordIndex]]&&0<i[S[this.keywordIndex]].length&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),n=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,n),this.addHeaderFooter(i,"EvenHeader",n),e.writeEndElement()),(i=t[bs[this.keywordIndex]])&&i[S[this.keywordIndex]]&&0<i[S[this.keywordIndex]].length&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),n=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,n),this.addHeaderFooter(i,"EvenFooter",n),e.writeEndElement()),(i=t[ys[this.keywordIndex]])&&i[S[this.keywordIndex]]&&0<i[S[this.keywordIndex]].length&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),n=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,n),this.addHeaderFooter(i,"OddHeader",n),e.writeEndElement()),i=t[vs[this.keywordIndex]])&&i[S[this.keywordIndex]]&&0<i[S[this.keywordIndex]].length&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),n=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,n),this.addHeaderFooter(i,"OddFooter",n),e.writeEndElement())},d.prototype.addHeaderFooter=function(e,t,i){var n=new T;this.headersFooters.add(t,n),this.headersFooters.get(t).add(i,e)},d.prototype.serializeBodyItems=function(e,t,i){for(var n=0;n<t.length;n++)this.serializeBodyItem(e,t[parseInt(n.toString(),10)],i)},d.prototype.serializeContentControl=function(e,t,i,n,r){if(_.isNullOrUndefined(t))throw new Error("contentCOntrol should not be undefined");e.writeStartElement("w","sdt",this.wNamespace),e.writeStartElement(void 0,"sdtPr",this.wNamespace),_.isNullOrUndefined(t)||this.serializeContentProperties(e,t,i,n,r)},d.prototype.serializeContentProperties=function(e,t,i,n,r){var o;if(_.isNullOrUndefined(t[Ho[this.keywordIndex]])||(e.writeStartElement(void 0,"alias",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[Ho[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement(void 0,"tag",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[So[this.keywordIndex]]),e.writeEndElement()),_.isNullOrUndefined(t[Ae[this.keywordIndex]])||this.serializeCharacterFormat(e,i[Fo[this.keywordIndex]][Ae[this.keywordIndex]]),(j.parseBoolValue(t[To[this.keywordIndex]])||j.parseBoolValue(t[Po[this.keywordIndex]]))&&(e.writeStartElement(void 0,"lock",this.wNamespace),j.parseBoolValue(t[Po[this.keywordIndex]])&&j.parseBoolValue(t[To[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,"sdtContentLocked"):j.parseBoolValue(t[Po[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,"sdtLocked"):j.parseBoolValue(t[To[this.keywordIndex]])&&e.writeAttributeString("w","val",this.wNamespace,"contentLocked"),e.writeEndElement()),j.parseBoolValue(t[No[this.keywordIndex]])&&_.isNullOrUndefined(void 0)&&(e.writeStartElement("w","placeholder",void 0),e.writeAttributeString("w","docPart",this.wNamespace,void 0),e.writeEndElement(),e.writeStartElement("w","showingPlcHdr",void 0),e.writeEndElement()),j.parseBoolValue(t[Oo[this.keywordIndex]])&&(e.writeStartElement("w","temporary",void 0),e.writeEndElement()),_.isNullOrUndefined(t[va[this.keywordIndex]])||(e.writeStartElement("w15","appearance",void 0),e.writeAttributeString("w15","val",void 0,(1===this.keywordIndex?this.getContentControlAppearance(t[va[this.keywordIndex]]):t[va[this.keywordIndex]]).toLowerCase()),e.writeEndElement()),_.isNullOrUndefined(t[Or[this.keywordIndex]])||(e.writeStartElement("w15","color",void 0),"empty"===t[Or[this.keywordIndex]]||"#00000000"===t[Or[this.keywordIndex]]?e.writeAttributeString("w","val",void 0,"auto"):e.writeAttributeString("w","val",void 0,this.getColor(t[Or[this.keywordIndex]])),e.writeEndElement()),_.isNullOrUndefined(t[aa[this.keywordIndex]])||t[aa[this.keywordIndex]]!==(1===this.keywordIndex?9:"Text")||(e.writeStartElement(void 0,"text",this.wNamespace),e.writeEndElement()),j.parseBoolValue(t[Wo[this.keywordIndex]])&&(e.writeStartElement(void 0,"text",this.wNamespace),e.writeAttributeString("w","multiLine",this.wNamespace,"1"),e.writeEndElement()),_.isNullOrUndefined(t[Vo[this.keywordIndex]])||j.parseBoolValue(t[Vo[this.keywordIndex]][jo[this.keywordIndex]])&&(e.writeStartElement("w","dataBinding",this.wNamespace),o=t[Vo[this.keywordIndex]][Ko[this.keywordIndex]],e.writeAttributeString("w","prefixMappings",void 0,o),o=t[Vo[this.keywordIndex]][Zo[this.keywordIndex]],e.writeAttributeString("w","xpath",void 0,o),o=t[Vo[this.keywordIndex]][Xo[this.keywordIndex]],e.writeAttributeString("w","storeItemID",void 0,o),e.writeEndElement()),t.picture&&(e.writeStartElement("w","picture",this.wNamespace),e.writeEndElement()),_.isNullOrUndefined(t[Ao[this.keywordIndex]]||t[Do[this.keywordIndex]])||(e.writeStartElement("w14","checkbox",void 0),j.parseBoolValue(t[Mo[this.keywordIndex]])?(e.writeStartElement("w14","checked",void 0),e.writeAttributeString("w14","val",void 0,"1")):(e.writeStartElement("w14","checked",void 0),e.writeAttributeString("w14","val",void 0,"0")),e.writeEndElement(),t[Ao[this.keywordIndex]]&&(e.writeStartElement("w14","uncheckedState",void 0),e.writeAttributeString("w14","val",void 0,this.toUnicode(t[Ao[this.keywordIndex]][qo[this.keywordIndex]])),e.writeAttributeString("w14","font",void 0,t[Ao[this.keywordIndex]][zo[this.keywordIndex]]),e.writeEndElement()),t[Do[this.keywordIndex]]&&(e.writeStartElement("w14","checkedState",void 0),e.writeAttributeString("w14","val",void 0,this.toUnicode(t[Do[this.keywordIndex]][qo[this.keywordIndex]])),e.writeAttributeString("w14","font",void 0,t[Do[this.keywordIndex]][zo[this.keywordIndex]]),e.writeEndElement()),e.writeEndElement()),_.isNullOrUndefined(t[Uo[this.keywordIndex]])||t[aa[this.keywordIndex]]!==(1===this.keywordIndex?5:"DropDownList")||(o=t[Uo[this.keywordIndex]],e.writeStartElement(void 0,"dropDownList",this.wNamespace),this.serializeContentControlList(e,o),e.writeEndElement()),_.isNullOrUndefined(t[Uo[this.keywordIndex]])||t[aa[this.keywordIndex]]!==(1===this.keywordIndex?3:"ComboBox")||(o=t[Uo[this.keywordIndex]],e.writeStartElement(void 0,"comboBox",this.wNamespace),this.serializeContentControlList(e,o),e.writeEndElement()),this.serializeContentControlDate(e,t),_.isNullOrUndefined(t[aa[this.keywordIndex]])||t[aa[this.keywordIndex]]===(1===this.keywordIndex?7:"Picture")&&(e.writeStartElement(void 0,"picture",this.wNamespace),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("w","sdtContent",this.wNamespace),!r){if(i.hasOwnProperty(S[this.keywordIndex])&&_.isNullOrUndefined(i[Qo[this.keywordIndex]]))for(var s=0;s<i[S[this.keywordIndex]].length;s++){var a,l=i[S[this.keywordIndex]][s];l.hasOwnProperty(ko[this.keywordIndex])?(this.paragraph=l,this.serializeParagraph(e,l,n),this.paragraph=void 0):l.hasOwnProperty($o[this.keywordIndex])?(a=new T,this.serializeRow(e,l,a)):l.hasOwnProperty(Fo[this.keywordIndex])?this.serializeContentControl(e,l[Fo[this.keywordIndex]],l,n):this.serializeTable(e,l)}else i.hasOwnProperty($o[this.keywordIndex])?0<i[es[this.keywordIndex]].length&&(a=new T,this.serializeRow(e,i,a)):i.hasOwnProperty(Qo[this.keywordIndex])&&(a=new T,this.serializeCell(e,i,a));e.writeEndElement(),e.writeEndElement()}},d.prototype.toUnicode=function(e){return e.charCodeAt(0).toString(16)},d.prototype.serializeContentControlList=function(e,t){for(var i=0;i<t.length;i++)e.writeStartElement(void 0,"listItem",this.wNamespace),_.isNullOrUndefined(t[i][_o[this.keywordIndex]])||e.writeAttributeString("w","displayText",this.wNamespace,t[i][_o[this.keywordIndex]]),e.writeAttributeString("w","value",this.wNamespace,t[i][qo[this.keywordIndex]]),e.writeEndElement()},d.prototype.serializeContentParagraph=function(e,t){for(var i=0;i<t[S[this.keywordIndex]].length;i++){var n=t[S[this.keywordIndex]][i];if(n.hasOwnProperty(ko[this.keywordIndex]))for(var r=0;r<n[ko[this.keywordIndex]].length;r++){var o=n[ko[this.keywordIndex]][r];_.isNullOrUndefined(o[Ae[this.keywordIndex]])||this.serializeCharacterFormat(e,o[Ae[this.keywordIndex]])}}},d.prototype.serializeContentControlDate=function(e,t){t[aa[this.keywordIndex]]===(1==this.keywordIndex?4:"Date")&&(e.writeStartElement("w","date",this.wNamespace),_.isNullOrUndefined(t[Eo[this.keywordIndex]])||(e.writeStartElement("w","calender",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex?this.getDateCalendarType(t[Eo[this.keywordIndex]]):t[Eo[this.keywordIndex]]),e.writeEndElement()),_.isNullOrUndefined(t[Bo[this.keywordIndex]])||(e.writeStartElement("w","lid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Bo[this.keywordIndex]]),e.writeEndElement()),_.isNullOrUndefined(t[Lo[this.keywordIndex]])||(e.writeStartElement("w","storeMappedDataAs",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex?this.getDateStorageFormat(t[Lo[this.keywordIndex]]):t[Lo[this.keywordIndex]]),e.writeEndElement()),_.isNullOrUndefined(t[Ro[this.keywordIndex]])||(e.writeStartElement("w","dateFormat",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Ro[this.keywordIndex]]),e.writeEndElement()),e.writeEndElement())},d.prototype.serializeBodyItem=function(e,t,i){if(_.isNullOrUndefined(t))throw new Error("BodyItem should not be undefined");if(t.hasOwnProperty(Fo[this.keywordIndex]))this.serializeContentControl(e,t[Fo[this.keywordIndex]],t,i);else if(t.hasOwnProperty(ko[this.keywordIndex]))this.paragraph=t,this.serializeParagraph(e,t,i),this.paragraph=void 0;else{for(var n=t,r=0;r<n[ts[this.keywordIndex]].length;r++)if(0<n[ts[this.keywordIndex]][r][es[this.keywordIndex]].length){this.serializeTable(e,n);break}t=this.blockOwner;!i&&t.hasOwnProperty(ks[this.keywordIndex])&&t[S[this.keywordIndex]].indexOf(n)===t[S[this.keywordIndex]].length-1&&(e.writeStartElement("w","p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeSectionProperties(e,t),e.writeEndElement(),e.writeEndElement())}},d.prototype.serializeParagraph=function(e,t,i){if(_.isNullOrUndefined(t))throw new Error("Paragraph should not be undefined");_.isNullOrUndefined(this.document.optimizeSfdt)||(this.keywordIndex=this.document.optimizeSfdt?1:0),e.writeStartElement("w","p",this.wNamespace),this.isInsideComment&&e.writeAttributeString("w14","paraId",void 0,this.commentParaID.toString()),e.writeStartElement(void 0,"pPr",this.wNamespace),_.isNullOrUndefined(t[De[this.keywordIndex]])||this.serializeParagraphFormat(e,t[De[this.keywordIndex]],t),_.isNullOrUndefined(t[Ae[this.keywordIndex]])||this.serializeCharacterFormat(e,t[Ae[this.keywordIndex]]);var n=this.blockOwner;!i&&n.hasOwnProperty(ks[this.keywordIndex])&&n[S[this.keywordIndex]].indexOf(t)===n[S[this.keywordIndex]].length-1&&this.serializeSectionProperties(e,n),e.writeEndElement(),this.prevRevisionIds=[],this.serializeParagraphItems(e,t[ko[this.keywordIndex]]),this.isBookmarkAtEnd||this.isBookmarkAtRowEnd||e.writeEndElement(),this.isBookmarkAtEnd=!1},d.prototype.serializeRevisionStart=function(e,t,i){if(t.hasOwnProperty(Dt[this.keywordIndex])&&(_.isNullOrUndefined(i)||!i.hasOwnProperty(Us[this.keywordIndex])||0!==i[Us[this.keywordIndex]]||0<=i[dt[this.keywordIndex]].indexOf("_Toc")||!_.isNullOrUndefined(t[Dt[this.keywordIndex]])))for(var n=t[Dt[this.keywordIndex]],r=0;r<n.length;r++){var o=this.retrieveRevision(n[r]);"Insertion"===o.revisionType&&this.serializeTrackChanges(e,"ins",o.author,o.date),"Deletion"===o.revisionType&&this.serializeTrackChanges(e,"del",o.author,o.date)}},d.prototype.serializeTrackChanges=function(e,t,i,n){e.writeStartElement("w",t,this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,(this.trackChangesId++).toString()),"Unknown"!=i&&e.writeAttributeString("w","author",this.wNamespace,i),e.writeAttributeString("w","date",this.wNamespace,n)},d.prototype.retrieveRevision=function(e){for(var t=0;t<this.revisions.length;t++)if(this.revisions[t].revisionID===e)return this.revisions[t]},d.prototype.serializeParagraphItems=function(e,t,i){if(_.isNullOrUndefined(t))throw new Error("Paragraph should not be undefined");var n,r=void 0,o=!1;_.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=i);for(var s=0;s<t.length;s++){var a=t[s],l=(a.hasOwnProperty(Fo[this.keywordIndex])&&(this.serializeContentControl(e,a[Fo[this.keywordIndex]],a,void 0,n=!0),this.serializeParagraphItems(e,a[ko[this.keywordIndex]])),a.hasOwnProperty(ko[this.keywordIndex])&&this.serializeParagraphItems(e,a),this.serializeRevisionStart(e,a,r),!1);a[Ae[this.keywordIndex]]&&(l=!_.isNullOrUndefined(a[Ae[this.keywordIndex]][St[this.keywordIndex]])&&0!==a[Ae[this.keywordIndex]][St[this.keywordIndex]])&&!o&&(this.serializeBiDirectionalOverride(e,a[Ae[this.keywordIndex]]),o=!0),o&&!l&&(e.writeEndElement(),o=!1),a.hasOwnProperty(Kr[this.keywordIndex])?this.serializeFieldCharacter(e,a):a.hasOwnProperty(Br[this.keywordIndex])?this.serializePicture(e,a):a.hasOwnProperty(hr[this.keywordIndex])?(l=this.paragraph,this.serializeShape(e,a),this.paragraph=l):a.hasOwnProperty(Us[this.keywordIndex])?this.serializeBookMark(e,a):a.hasOwnProperty(Gs[this.keywordIndex])?this.serializeEditRange(e,a):a.hasOwnProperty(or[this.keywordIndex])?(this.chart=a,this.serializeChart(e,a),this.serializeChartStructure()):a.hasOwnProperty(ho[this.keywordIndex])?this.serializeComment(e,a):a.hasOwnProperty(bo[this.keywordIndex])?this.serializeEFReference(e,a):this.serializeTextRange(e,a,r),this.serializeRevisionEnd(e,a,r),r=a,n&&(e.writeEndElement(),e.writeEndElement(),n=!1)}o&&e.writeEndElement()},d.prototype.serializeEFReference=function(e,t){var i="",n=t[S[this.keywordIndex]];t[bo[this.keywordIndex]]===(1==this.keywordIndex?0:"Footnote")?(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[Ae[this.keywordIndex]]),e.writeStartElement(void 0,"footnoteReference",this.wNamespace),this.document[rt[this.keywordIndex]][Ds[this.keywordIndex]]&&0===this.efRelationShipId&&(this.efRelationShipId=1),i=this.getEFNextRelationShipID(),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(n,"footnote",i)):(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[Ae[this.keywordIndex]]),e.writeStartElement(void 0,"endnoteReference",this.wNamespace),i=this.getEFNextRelationShipID(),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(n,"endnote",i)),e.writeEndElement(),e.writeEndElement()},d.prototype.addFootnotesEndnotes=function(e,t,i){var n=new T;this.endnotesFootnotes.add(t,n),this.endnotesFootnotes.get(t).add(i,e)},d.prototype.serializeEndnotesFootnote=function(e,t){if(0!==this.endnotesFootnotes.length&&this.endnotesFootnotes.containsKey(t))for(var i=this.endnotesFootnotes.get(t),n=0;n<i.keys.length;n++){var r=i.keys[n],o=i.get(r);"endnote"===t?(this.endnotesPath,this.endnotesRelationPath,this.serializeInlineEndnotes(e,o,r)):(this.footnotesPath,this.footnotesRelationPath,this.serializeInlineFootnotes(e,o,r))}},d.prototype.serializeInlineEndnotes=function(e,t,i){this.isSerializeFootEndNote="Endnote",this.endNoteFootnote=t;var n=this.blockOwner;this.blockOwner=t,e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.serializeBodyItems(e,t,!0),e.writeEndElement(),this.blockOwner=n,this.endNoteFootnote=void 0,this.isSerializeFootEndNote=void 0},d.prototype.serializeInlineFootnotes=function(e,t,i){this.isSerializeFootEndNote="Footnote",this.endNoteFootnote=t;var n=this.blockOwner;this.blockOwner=t,e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.serializeBodyItems(e,t,!0),e.writeEndElement(),this.blockOwner=n,this.endNoteFootnote=void 0,this.isSerializeFootEndNote=void 0},d.prototype.writeEFCommonAttributes=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","cx",void 0,this.cxNamespace),e.writeAttributeString("xmlns","aink",void 0,"http://schemas.microsoft.com/office/drawing/2016/ink"),e.writeAttributeString("xmlns","am3d",void 0,"http://schemas.microsoft.com/office/drawing/2017/,odel3d"),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},d.prototype.serializeFootnotes=function(){var e;_.isNullOrUndefined(this.document[rt[this.keywordIndex]])||((e=new x.XmlWriter).writeStartElement("w","footnotes",this.wNamespace),this.writeEFCommonAttributes(e),e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"separator"),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(e,this.document[rt[this.keywordIndex]][Ms[this.keywordIndex]],!0),e.writeEndElement(),e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(e,this.document[rt[this.keywordIndex]][As[this.keywordIndex]],!0),e.writeEndElement(),this.document[rt[this.keywordIndex]][Ds[this.keywordIndex]]&&(e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),e.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(e,this.document[rt[this.keywordIndex]][Ds[this.keywordIndex]],!0),e.writeEndElement()),this.serializeEndnotesFootnote(e,"footnote"),e.writeEndElement(),e=new f.ZipArchiveItem(e.buffer,this.footnotesPath),this.mArchive.addItem(e))},d.prototype.serializeEndnotes=function(){var e;_.isNullOrUndefined(this.document[ot[this.keywordIndex]])||((e=new x.XmlWriter).writeStartElement("w","endnotes",this.wNamespace),this.writeEFCommonAttributes(e),e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"separator"),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(e,this.document[ot[this.keywordIndex]][Ms[this.keywordIndex]],!0),e.writeEndElement(),e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(e,this.document[ot[this.keywordIndex]][As[this.keywordIndex]],!0),e.writeEndElement(),this.document[ot[this.keywordIndex]][Ds[this.keywordIndex]]&&(e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),e.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(e,this.document[ot[this.keywordIndex]][Ds[this.keywordIndex]],!0),e.writeEndElement()),this.serializeEndnotesFootnote(e,"endnote"),e.writeEndElement(),e=new f.ZipArchiveItem(e.buffer,this.endnotesPath),this.mArchive.addItem(e))},d.prototype.serializeRevisionEnd=function(e,t,i){if(t.hasOwnProperty(Dt[this.keywordIndex]))for(var n=0;n<t[Dt[this.keywordIndex]].length;n++){var r=this.retrieveRevision(t[Dt[this.keywordIndex]][n]);"Insertion"!==r.revisionType&&"Deletion"!==r.revisionType||e.writeEndElement()}},d.prototype.serializeComment=function(e,t){var i;1===this.mComments.length&&""===this.mComments[0].text||(0===t[ho[this.keywordIndex]]?e.writeStartElement("w","commentRangeStart",this.wNamespace):1===t[ho[this.keywordIndex]]&&e.writeStartElement("w","commentRangeEnd",this.wNamespace),i=this.commentId[t[lo[this.keywordIndex]]],_.isNullOrUndefined(i)&&(i=this.commentId[t[lo[this.keywordIndex]]]=this.currentCommentId++),e.writeAttributeString("w","id",this.wNamespace,i.toString()),e.writeEndElement(),1===t[ho[this.keywordIndex]]&&this.serializeCommentItems(e,i))},d.prototype.serializeCommentItems=function(e,t){e.writeStartElement("w","r",this.wNamespace),e.writeStartElement("w","commentReference",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,t.toString()),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeBiDirectionalOverride=function(e,t){e.writeStartElement(void 0,"bdo",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,(1==this.keywordIndex?this.getBiDirectionalOverride(t[St[this.keywordIndex]]):t[St[this.keywordIndex]]).toLowerCase())},d.prototype.serializeEditRange=function(e,t){t.hasOwnProperty(Ys[this.keywordIndex])?e.writeStartElement("w","permEnd",this.wNamespace):(e.writeStartElement("w","permStart",this.wNamespace),t[Xs[this.keywordIndex]]&&""!==t[Xs[this.keywordIndex]]&&e.writeAttributeString("w","ed",this.wNamespace,t[Xs[this.keywordIndex]]),t[Js[this.keywordIndex]]&&""!==t[Js[this.keywordIndex]]&&e.writeAttributeString("w","edGrp",this.wNamespace,t[Js[this.keywordIndex]].toLowerCase()),t[Ks[this.keywordIndex]]&&-1!==t[Ks[this.keywordIndex]]&&e.writeAttributeString("w","colFirst",this.wNamespace,t[Ks[this.keywordIndex]].toString()),t[Zs[this.keywordIndex]]&&-1!==t[Zs[this.keywordIndex]]&&e.writeAttributeString("w","colLast",this.wNamespace,t[Zs[this.keywordIndex]].toString())),e.writeAttributeString("w","id",this.wNamespace,t[Gs[this.keywordIndex]]),e.writeEndElement()},d.prototype.serializeBookMark=function(e,t){var i=this.getBookmarkId(t[dt[this.keywordIndex]]),n=t[dt[this.keywordIndex]];0===t[Us[this.keywordIndex]]?(e.writeStartElement("w","bookmarkStart",this.wNamespace),e.writeAttributeString("w","name",this.wNamespace,n),_.isNullOrUndefined(t[Vs[this.keywordIndex]])||(e.writeAttributeString("w","colFirst",this.wNamespace,t[Vs[this.keywordIndex]][Ks[this.keywordIndex]].toString()),e.writeAttributeString("w","colLast",this.wNamespace,t[Vs[this.keywordIndex]][Zs[this.keywordIndex]].toString()))):1===t[Us[this.keywordIndex]]&&(_.isNullOrUndefined(t[Vs[this.keywordIndex]])||this.isBookmarkAtEnd||this.isBookmarkAtRowEnd||(j.parseBoolValue(t[Vs[this.keywordIndex]][Ta[this.keywordIndex]])?(e.writeEndElement(),this.isBookmarkAtEnd=!0):j.parseBoolValue(t[Vs[this.keywordIndex]][Ha[this.keywordIndex]])&&(e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),this.isBookmarkAtRowEnd=!0)),e.writeStartElement("w","bookmarkEnd",this.wNamespace)),e.writeAttributeString("w","id",this.wNamespace,i.toString()),e.writeEndElement()},d.prototype.getBookmarkId=function(e){var t=this.bookmarks.indexOf(e);return t<0&&(t=this.bookmarks.length,this.bookmarks.push(e)),t},d.prototype.serializePicture=function(e,t){0<=t[mr[this.keywordIndex]]&&0<=t[fr[this.keywordIndex]]&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[Ae[this.keywordIndex]]),this.serializeDrawing(e,t),e.writeEndElement())},d.prototype.serializeShape=function(e,t){0<=t[mr[this.keywordIndex]]&&0<=t[fr[this.keywordIndex]]&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[Ae[this.keywordIndex]]),0<t[gr[this.keywordIndex]]?this.serializeHorizontalRule(e,t):this.serializeDrawing(e,t),e.writeEndElement())},d.prototype.serializeHorizontalRule=function(e,t){e.writeStartElement(void 0,"pict",this.wNamespace),e.writeStartElement("v","rect",void 0);var i=Math.round(t[mr[this.keywordIndex]]),n=Math.round(t[fr[this.keywordIndex]]);e.writeAttributeString(void 0,"style",void 0,"width:"+i.toString()+";height:"+n.toString()),0<t[ms[this.keywordIndex]]&&(i=1==this.keywordIndex?this.getShapeHorizontalAlignment(t[ms[this.keywordIndex]]):t[ms[this.keywordIndex]].toString(),e.writeAttributeString("o","hralign",void 0,i.toLowerCase())),e.writeAttributeString("o","hrstd",void 0,"t"),e.writeAttributeString("o","hr",void 0,"t"),e.writeAttributeString(void 0,"fillcolor",void 0,this.getColor(t[br[this.keywordIndex]][Or[this.keywordIndex]])),e.writeAttributeString(void 0,"stroked",void 0,"f"),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeDrawing=function(e,t){e.writeStartElement(void 0,"drawing",this.wNamespace),t.hasOwnProperty(or[this.keywordIndex])?this.serializeInlineCharts(e,t):t[xr[this.keywordIndex]]===(1==this.keywordIndex?0:"Inline")?this.serializeInlinePictureAndShape(e,t):this.serializeWrappingPictureAndShape(e,t),e.writeEndElement()},d.prototype.serializeWrappingPictureAndShape=function(e,t){_.isNullOrUndefined(this.document.optimizeSfdt)||(this.keywordIndex=this.document.optimizeSfdt?1:0),e.writeStartElement("wp","anchor",this.wpNamespace),this.serializePictureAndShapeDistance(e,t),e.writeAttributeString(void 0,"simplePos",void 0,"0"),e.writeAttributeString(void 0,"relativeHeight",void 0,t[Tr[this.keywordIndex]]?Math.abs(t[Tr[this.keywordIndex]]).toString():"0");var i=t[xr[this.keywordIndex]]&&t[xr[this.keywordIndex]]===(1==this.keywordIndex?4:"Behind"),i=(e.writeAttributeString(void 0,"behindDoc",void 0,i?"1":"0"),1==this.keywordIndex?_.isNullOrUndefined(t[Hr[this.keywordIndex]])?"0":t[Hr[this.keywordIndex]].toString():t[Hr[this.keywordIndex]]?"1":"0"),i=(e.writeAttributeString(void 0,"locked",void 0,i),1==this.keywordIndex?_.isNullOrUndefined(t[Sr[this.keywordIndex]])?"0":t[Sr[this.keywordIndex]].toString():t[Sr[this.keywordIndex]]?"1":"0"),i=(e.writeAttributeString(void 0,"layoutInCell",void 0,i),1==this.keywordIndex?_.isNullOrUndefined(t[as[this.keywordIndex]])?"0":t[as[this.keywordIndex]].toString():t[as[this.keywordIndex]]?"1":"0"),i=(e.writeAttributeString(void 0,"allowOverlap",void 0,i),e.writeStartElement("wp","simplePos",this.wpNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("wp","positionH",this.wpNamespace),1==this.keywordIndex?this.getHorizontalOrigin(t[gs[this.keywordIndex]]):t[gs[this.keywordIndex]].toString()),i=(e.writeAttributeString(void 0,"relativeFrom",void 0,j.formatText("firstlower",i)),t[ms[this.keywordIndex]]===(1==this.keywordIndex?0:"None")?(e.writeStartElement("wp","posOffset",this.wpNamespace),i=Math.round(t[fs[this.keywordIndex]]*this.emusPerPoint),e.writeString(i.toString())):(e.writeStartElement("wp","align",this.wpNamespace),i=1==this.keywordIndex?this.getShapeHorizontalAlignment(t[ms[this.keywordIndex]]):t[ms[this.keywordIndex]].toString(),e.writeString(i.toLowerCase())),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("wp","positionV",this.wpNamespace),1==this.keywordIndex?this.getVerticalOrigin(t[ps[this.keywordIndex]]):t[ps[this.keywordIndex]].toString()),i=(e.writeAttributeString(void 0,"relativeFrom",void 0,j.formatText("firstlower",i)),t[Bi[this.keywordIndex]]===(1==this.keywordIndex?0:"None")?(e.writeStartElement("wp","posOffset",this.wpNamespace),i=Math.round(t[us[this.keywordIndex]]*this.emusPerPoint),e.writeString(i.toString())):(e.writeStartElement("wp","align",this.wpNamespace),i=1==this.keywordIndex?this.getShapeVerticalAlignment(t[Bi[this.keywordIndex]]):t[Bi[this.keywordIndex]],e.writeString(i.toLowerCase())),e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"extent",this.wpNamespace),Math.round(t[mr[this.keywordIndex]]*this.emusPerPoint)),i=(e.writeAttributeString(void 0,"cx",void 0,i.toString()),Math.round(t[fr[this.keywordIndex]]*this.emusPerPoint));e.writeAttributeString(void 0,"cy",void 0,i.toString()),e.writeEndElement(),_.isNullOrUndefined(t[Br[this.keywordIndex]])?this.serializeShapeDrawingGraphics(e,t):(this.serializeShapeWrapStyle(e,t),this.serializeDrawingGraphics(e,t)),e.writeEndElement()},d.prototype.serializeInlinePictureAndShape=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),this.writeDefaultDistAttribute(e),e.writeStartElement(void 0,"extent",this.wpNamespace);var i=Math.round(t[mr[this.keywordIndex]]*this.emusPerPoint),i=(e.writeAttributeString(void 0,"cx",void 0,i.toString()),Math.round(t[fr[this.keywordIndex]]*this.emusPerPoint));e.writeAttributeString(void 0,"cy",void 0,i.toString()),e.writeEndElement(),_.isNullOrUndefined(t[Br[this.keywordIndex]])?this.serializeShapeDrawingGraphics(e,t):(this.serializeShapeWrapStyle(e,t),this.serializeDrawingGraphics(e,t)),e.writeEndElement()},d.prototype.serializePictureAndShapeDistance=function(e,t){var i=t[ls[this.keywordIndex]]?Math.round(t[ls[this.keywordIndex]]*this.emusPerPoint).toString():"0",i=(e.writeAttributeString(void 0,"distT",void 0,i),t[cs[this.keywordIndex]]?Math.round(t[cs[this.keywordIndex]]*this.emusPerPoint).toString():"0"),i=(e.writeAttributeString(void 0,"distB",void 0,i),t[hs[this.keywordIndex]]?Math.round(t[hs[this.keywordIndex]]*this.emusPerPoint).toString():"114300"),i=(e.writeAttributeString(void 0,"distL",void 0,i),t[ds[this.keywordIndex]]?Math.round(t[ds[this.keywordIndex]]*this.emusPerPoint).toString():"114300");e.writeAttributeString(void 0,"distR",void 0,i)},d.prototype.writeDefaultDistAttribute=function(e){e.writeAttributeString(void 0,"distT",void 0,"0"),e.writeAttributeString(void 0,"distB",void 0,"0"),e.writeAttributeString(void 0,"distL",void 0,"0"),e.writeAttributeString(void 0,"distR",void 0,"0")},d.prototype.serializeInlineCharts=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),this.writeDefaultDistAttribute(e),e.writeStartElement(void 0,"extent",this.wpNamespace);var i=Math.round(t[mr[this.keywordIndex]]*this.emusPerPoint),i=(e.writeAttributeString(void 0,"cx",void 0,i.toString()),Math.round(t[fr[this.keywordIndex]]*this.emusPerPoint));e.writeAttributeString(void 0,"cy",void 0,i.toString()),e.writeEndElement(),e.writeStartElement(void 0,"effectExtent",this.wpNamespace),e.writeAttributeString(void 0,"l",void 0,"0"),e.writeAttributeString(void 0,"t",void 0,"0"),e.writeAttributeString(void 0,"r",void 0,"0"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeEndElement(),this.serializeDrawingGraphicsChart(e,t),e.writeEndElement()},d.prototype.serializeDrawingGraphicsChart=function(e,t){t=this.updatechartId(t);e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,this.getNextChartName()),e.writeEndElement(),e.writeStartElement("wp","cNvGraphicFramePr",this.wpNamespace),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.chartNamespace),e.writeStartElement("c","chart",this.chartNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("r","id",void 0,t),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},d.prototype.getBase64ImageString=function(e){var t=_.isNullOrUndefined(e[Rr[this.keywordIndex]])?this.mImages.get(parseInt(e[Br[this.keywordIndex]])):this.mImages.get(parseInt(e[Rr[this.keywordIndex]])),e=t[j.parseBoolValue(e[Ar[this.keywordIndex]])?1:0];return{imageString:e,metaFileImageString:t[this.startsWith(e,"https://")||this.startsWith(e,"http://")||this.startsWith(e,"file://")?1:0]}},d.prototype.getNextChartName=function(){return"Chart"+ ++this.chartCount},d.prototype.serializeChart=function(e,t){e.writeStartElement("w","r",this.wNamespace),this.serializeCharacterFormat(e,t[Ae[this.keywordIndex]]),this.serializeDrawing(e,t),e.writeEndElement()},d.prototype.serializeChartStructure=function(){this.serializeChartXML(),this.serializeChartColors(),this.serializeChartExcelData(),this.serializeChartRelations(),this.chart=void 0,this.saveExcel()},d.prototype.serializeChartXML=function(){var e,t=new x.XmlWriter,t=(t.writeStartElement("c","chartSpace",this.chartNamespace),t.writeAttributeString("xmlns","a",void 0,this.aNamespace),t.writeAttributeString("xmlns","r",void 0,this.rNamespace),t.writeAttributeString("xmlns","c16r2",void 0,this.c15Namespace),this.serializeChartData(t,this.chart),t.writeStartElement("c","externalData",this.chartNamespace),t.writeAttributeString("r","id",void 0,"rId1"),t.writeStartElement("c","autoUpdate",this.chartNamespace),t.writeAttributeString(void 0,"val",void 0,"0"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),e=this.chartPath+"/chart"+this.chartCount+".xml",new f.ZipArchiveItem(t.buffer,e));this.mArchive.addItem(t)},d.prototype.serializeChartColors=function(){var e=new x.XmlWriter,t="",e=(e.writeStartElement("cs","colorStyle",this.csNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString(void 0,"meth",void 0,"cycle"),e.writeAttributeString(void 0,"id",void 0,"10"),this.serializeChartColor(e),t=this.chartPath+"/colors"+this.chartCount+".xml",e.writeEndElement(),new f.ZipArchiveItem(e.buffer,t));this.mArchive.addItem(e)},d.prototype.serializeChartColor=function(e){for(var t=1;t<=6;t++)e.writeStartElement("a","schemeClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"accent"+t),e.writeEndElement();e.writeStartElement("cs","variation",this.csNamespace),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"60000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"80000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"20000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"80000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"60000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"40000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"70000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"30000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"70000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeChartExcelData=function(){_.isNullOrUndefined(this.excelFiles)&&(this.excelFiles=new T),this.mArchiveExcel=new f.ZipArchive,this.mArchiveExcel.compressionLevel="Normal";var e=this.chart[or[this.keywordIndex]],e="Scatter_Markers"===e||"Bubble"===e;this.serializeWorkBook(),this.serializeSharedString(e),this.serializeExcelContentTypes(),this.serializeExcelData(e),this.serializeExcelStyles(),this.serializeExcelRelation(),this.serializeExcelGeneralRelations(),this.chartStringCount=0},d.prototype.serializeWorkBook=function(){var e=new x.XmlWriter,e=(this.resetExcelRelationShipId(),e.writeStartElement(void 0,"workbook",void 0),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),e.writeStartElement(void 0,"sheets",void 0),e.writeStartElement(void 0,"sheet",void 0),e.writeAttributeString(void 0,"name",void 0,"Sheet1"),e.writeAttributeString(void 0,"sheetId",void 0,"1"),e.writeAttributeString("r","id",void 0,this.getNextExcelRelationShipID()),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),new f.ZipArchiveItem(e.buffer,"xl/workbook.xml"));this.mArchiveExcel.addItem(e)},d.prototype.serializeExcelStyles=function(){var e=new x.XmlWriter,e=(e.writeStartElement(void 0,"styleSheet",void 0),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("mc","Ignorable",void 0,"x14ac"),e.writeAttributeString("xmlns","x14ac",void 0,"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"),e.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),e.writeEndElement(),new f.ZipArchiveItem(e.buffer,"xl/styles.xml"));this.mArchiveExcel.addItem(e)},d.prototype.serializeExcelData=function(e){var t=new x.XmlWriter,e=(t.writeStartElement(void 0,"worksheet",void 0),t.writeAttributeString("xmlns","r",void 0,this.rNamespace),t.writeAttributeString("xmlns","x14",void 0,this.spreadSheet9),t.writeAttributeString("xmlns","mc",void 0,this.veNamespace),t.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),this.serializeExcelSheet(t,e),t.writeEndElement(),new f.ZipArchiveItem(t.buffer,"xl/worksheets/sheet1.xml"));this.mArchiveExcel.addItem(e)},d.prototype.serializeSharedString=function(e){for(var t=this.chart,i=new x.XmlWriter,n=[],r=this.chart[or[this.keywordIndex]],o=t[Yn[this.keywordIndex]].length,s=0;s<o;s++){var a=t[Yn[this.keywordIndex]][s],l=a[Nn[this.keywordIndex]].match(/[a-z]/i);e&&0===s&&n.push("X-Values"),l&&(n.push(a[Nn[this.keywordIndex]]),this.chartStringCount++)}"Bubble"===r&&n.push("Size");for(var d=0;d<t[Jn[this.keywordIndex]].length;d++){var h=t[Jn[this.keywordIndex]][d],c=t[ir[this.keywordIndex]][Ns[this.keywordIndex]];!(l=h[gn[this.keywordIndex]].match(/[a-z]/i))&&"m/d/yyyy"!==c||(n.push(h[gn[this.keywordIndex]]),this.chartStringCount++)}r=this.chartStringCount+1;i.writeStartElement(void 0,"sst",void 0),i.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),i.writeAttributeString(void 0,"count",void 0,r.toString()),i.writeAttributeString(void 0,"uniqueCount",void 0,r.toString());for(var p=0;p<=n.length;p++)i.writeStartElement(void 0,"si",void 0),i.writeStartElement(void 0,"t",void 0),p!==n.length?i.writeString(n[p]):e||(i.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),i.writeString(" ")),i.writeEndElement(),i.writeEndElement();i.writeEndElement();r=new f.ZipArchiveItem(i.buffer,"xl/sharedStrings.xml");this.mArchiveExcel.addItem(r)},d.prototype.serializeExcelSheet=function(e,t){var i,n=this.chart,r="s",o="Bubble"===n[or[this.keywordIndex]],s=n[Jn[this.keywordIndex]].length+1,a=n[ir[this.keywordIndex]][Ns[this.keywordIndex]],l=n[Yn[this.keywordIndex]].length+1,d=(o&&(i=l,l+=1),void 0),h=void 0,c=0;e.writeStartElement(void 0,"sheetData",void 0);for(var p=0;p<s;p++){e.writeStartElement(void 0,"row",void 0),e.writeAttributeString(void 0,"r",void 0,(p+1).toString());for(var u=0;u<l;u++){var g,m,f=String.fromCharCode("A".charCodeAt(0)+u)+(p+1).toString();e.writeStartElement(void 0,"c",void 0),e.writeAttributeString(void 0,"r",void 0,f),r=0!==p&&0===u?(g=(d=n[Jn[this.keywordIndex]][p-1])[gn[this.keywordIndex]].match(/[a-z]/i),(!_.isNullOrUndefined(g)||"m/d/yyyy"!==a)&&(!g||t)?"n":"s"):0===p&&0!==u&&u!==i?(g=(h=n[Yn[this.keywordIndex]][u-1])[Nn[this.keywordIndex]].match(/[a-z]/i))?"s":"n":0===p&&o&&u===i||0===p&&0===u?"s":"n",e.writeAttributeString(void 0,"t",void 0,r),e.writeStartElement(void 0,"v",void 0),0!==p||0!==u||t?"s"===r&&c<this.chartStringCount?(e.writeString(c.toString()),c++):0!==p&&"s"!==r&&0===u&&u!==i?e.writeString(d[gn[this.keywordIndex]]):0!==u&&"s"!==r&&0===p&&u!==i?e.writeString(h[Nn[this.keywordIndex]]):0!==p&&0!==u&&u!==i?(m=d[un[this.keywordIndex]][u-1],_.isNullOrUndefined(m)||(f=m[pn[this.keywordIndex]],e.writeString(f.toString()))):0!==p&&o&&u===i&&(m=d[un[this.keywordIndex]][u-2],_.isNullOrUndefined(m)||(f=m[ro[this.keywordIndex]],e.writeString(f.toString()))):e.writeString(this.chartStringCount.toString()),e.writeEndElement(),e.writeEndElement(),r=""}e.writeEndElement()}e.writeEndElement()},d.prototype.serializeExcelContentTypes=function(){var e=new x.XmlWriter,e=(e.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(e,"xml",this.xmlContentType),this.serializeDefaultContentType(e,"rels",this.relationContentType),this.serializeOverrideContentType(e,"xl/styles.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"),this.serializeOverrideContentType(e,"xl/workbook.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"),this.serializeOverrideContentType(e,"xl/sharedStrings.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"),this.serializeOverrideContentType(e,"xl/worksheets/sheet1.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"),e.writeEndElement(),new f.ZipArchiveItem(e.buffer,this.contentTypesPath));this.mArchiveExcel.addItem(e)},d.prototype.serializeExcelRelation=function(){var e=new x.XmlWriter,e=(this.resetExcelRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","worksheets/sheet1.xml"),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedStrings.xml"),e.writeEndElement(),new f.ZipArchiveItem(e.buffer,this.excelRelationPath));this.mArchiveExcel.addItem(e)},d.prototype.serializeExcelGeneralRelations=function(){var e=new x.XmlWriter,e=(this.resetExcelRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),this.documentRelType,"xl/workbook.xml"),e.writeEndElement(),new f.ZipArchiveItem(e.buffer,this.generalRelationPath));this.mArchiveExcel.addItem(e)},d.prototype.getNextExcelRelationShipID=function(){return"rId"+ ++this.eRelationShipId},d.prototype.getNextChartRelationShipID=function(){return"rId"+ ++this.cRelationShipId},d.prototype.serializeChartData=function(e,t){e.writeStartElement("c","date1904",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","lang",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"en-US"),e.writeEndElement(),e.writeStartElement("c","roundedCorners",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("mc","AlternateContent",this.veNamespace),e.writeStartElement("mc","Choice",this.veNamespace),e.writeAttributeString("xmlns","c14",void 0,this.c7Namespace),e.writeAttributeString(void 0,"Requires",void 0,"c14"),e.writeStartElement("c14","style",void 0),e.writeAttributeString(void 0,"val",void 0,"102"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("mc","Fallback",this.veNamespace),e.writeStartElement("c","style",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"2"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","chart",this.chartNamespace),_.isNullOrUndefined(this.chart[rr[this.keywordIndex]])||(e.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(e,this.chart[$n[this.keywordIndex]],this.chart[rr[this.keywordIndex]]),e.writeEndElement()),this.serializeChartPlotArea(e,t),e.writeEndElement(),this.serializeShapeProperties(e,"D9D9D9",!0),e.writeStartElement("c","txPr",this.chartNamespace),e.writeAttributeString("xmlns","c",void 0,this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeStartElement("a","pPr",this.aNamespace),e.writeStartElement("a","defRPr",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","endParaRPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeChartPlotArea=function(e,t){e.writeStartElement("c","autoTitleDeleted",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","plotArea",this.chartNamespace),e.writeStartElement("c","layout",this.chartNamespace),e.writeEndElement();for(var i=this.chartType(t),n="pieChart"===i||"doughnutChart"===i,r="scatterChart"===i||"bubbleChart"===i,o=(e.writeStartElement("c",i,this.chartNamespace),"barChart"===i&&(u="",u="Column_Clustered"===t[or[this.keywordIndex]]||"Column_Stacked"===t[or[this.keywordIndex]]||"Column_Stacked_100"===t[or[this.keywordIndex]]?"col":"bar",e.writeStartElement("c","barDir",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,u),e.writeEndElement()),n||r||(u=this.chartGrouping(t[or[this.keywordIndex]]),e.writeStartElement("c","grouping",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,u),e.writeEndElement()),"scatterChart"===i&&(e.writeStartElement("c","scatterStyle",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"marker"),e.writeEndElement()),e.writeStartElement("c","varyColors",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),0);o<t[Yn[this.keywordIndex]].length;o++){var s,a=t[Yn[this.keywordIndex]][o],l=(this.seriesCount=o,e.writeStartElement("c","ser",this.chartNamespace),e.writeStartElement("c","idx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","order",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","tx",this.chartNamespace),e.writeStartElement("c","strRef",this.chartNamespace),e.writeStartElement("c","f",this.chartNamespace),String.fromCharCode("B".charCodeAt(0)+o)),l=(e.writeString((s="Sheet1!$"+l)+"$1"),s=s+"$2:$"+l+"$",e.writeEndElement(),e.writeStartElement("c","strCache",this.chartNamespace),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,"0"),e.writeStartElement("c","v",this.chartNamespace),e.writeString(a[Nn[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),"Pie"===t[or[this.keywordIndex]]||"Doughnut"===t[or[this.keywordIndex]]?(this.parseChartDataPoint(e,a),e.writeStartElement("c","explosion",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()):r||this.parseChartSeriesColor(e,a[Bn[this.keywordIndex]],i),"scatterChart"===i&&(l=a[Bn[this.keywordIndex]][0][Er[this.keywordIndex]][fn[this.keywordIndex]],e.writeStartElement("c","marker",this.chartNamespace),e.writeStartElement("c","symbol",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"circle"),e.writeEndElement(),e.writeStartElement("c","size",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"5"),e.writeEndElement(),this.serializeShapeProperties(e,l,!1),e.writeEndElement()),a[Wn[this.keywordIndex]]&&this.parseChartDataLabels(e,a[Wn[this.keywordIndex]]),a[Ln[this.keywordIndex]]&&this.parseChartTrendLines(e,a),a[On[this.keywordIndex]]&&this.serializeChartErrorBar(e,a),"scatterChart"===i?this.serializeDefaultShapeProperties(e):"bubbleChart"===i&&this.serializeShapeProperties(e,a[Bn[this.keywordIndex]][0][Er[this.keywordIndex]][fn[this.keywordIndex]],!1),"cat"),d="strRef",h="strCache";"scatterChart"===i&&(l="xVal",d="numRef",h="numCache"),e.writeStartElement("c",l,this.chartNamespace),e.writeStartElement("c",d,this.chartNamespace),this.serializeChartCategory(e,t,h),e.writeEndElement(),e.writeEndElement(),this.serializeChartValue(e,s,i),e.writeEndElement()}e.writeStartElement("c","dLbls",this.chartNamespace),n&&(e.writeStartElement("c","dLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"bestFit"),e.writeEndElement()),e.writeStartElement("c","showLegendKey",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showVal",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showCatName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showSerName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showPercent",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showBubbleSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showLeaderLines",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeEndElement(),n&&((a=this.chart[Yn[this.keywordIndex]][g=u=0]).hasOwnProperty(Rn[this.keywordIndex])&&(u=a[Rn[this.keywordIndex]]),e.writeStartElement("c","firstSliceAng",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,u.toString()),e.writeEndElement(),"Doughnut"===t[or[this.keywordIndex]])&&(g=a[Mn[this.keywordIndex]],e.writeStartElement("c","holeSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,g.toString()),e.writeEndElement()),"lineChart"===i||r?"bubbleChart"!==i&&(e.writeStartElement("c","smooth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()):(e.writeStartElement("c","gapWidth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,this.chart[sr[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement("c","overlap",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,this.chart[ar[this.keywordIndex]].toString()),e.writeEndElement()),"bubbleChart"===i&&(e.writeStartElement("c","sizeRepresents",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"area"),e.writeEndElement());var c,p,u=this.chart[or[this.keywordIndex]],g=(n||(e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"),e.writeEndElement(),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335263360"),e.writeEndElement()),e.writeEndElement(),"Column_Stacked_100"===u||"Area_Stacked_100"===u||"Bar_Stacked_100"===u||"Line_Stacked_100"===u||"Line_Markers_Stacked_100"===u),u=this.chart[ir[this.keywordIndex]][or[this.keywordIndex]];n||(this.serializeCategoryAxis(e,u,g),this.serializeValueAxis(e,u,g)),this.chart.hasOwnProperty(lr[this.keywordIndex])&&(n=this.chart[lr[this.keywordIndex]],p=c=g=u=0,j.parseBoolValue(n[jn[this.keywordIndex]])&&(p=1),j.parseBoolValue(n[Gn[this.keywordIndex]])&&(u=1),j.parseBoolValue(n[Kn[this.keywordIndex]])&&(g=1),j.parseBoolValue(n[Zn[this.keywordIndex]])&&(c=1),e.writeStartElement("c","dTable",this.chartNamespace),e.writeStartElement("c","showHorzBorder",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,u.toString()),e.writeEndElement(),e.writeStartElement("c","showVertBorder",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,g.toString()),e.writeEndElement(),e.writeStartElement("c","showOutline",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,c.toString()),e.writeEndElement(),e.writeStartElement("c","showKeys",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,p.toString()),e.writeEndElement(),e.writeEndElement()),this.serializeDefaultShapeProperties(e),e.writeEndElement(),_.isNullOrUndefined(this.chart[tr[this.keywordIndex]][qs[this.keywordIndex]])||this.serializeChartLegend(e),e.writeStartElement("c","plotVisOnly",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","dispBlanksAs",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"gap"),e.writeEndElement()},d.prototype.serializeChartLegend=function(e){var t=this.chartLegendPosition(this.chart[tr[this.keywordIndex]]),i=this.chart[tr[this.keywordIndex]][$n[this.keywordIndex]],n=i[cn[this.keywordIndex]][Er[this.keywordIndex]][fn[this.keywordIndex]];e.writeStartElement("c","legend",this.chartNamespace),e.writeStartElement("c","legendPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),e.writeStartElement("c","overlay",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,i[It[this.keywordIndex]],n,i[Ia[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeChartErrorBar=function(e,t){var t=t[On[this.keywordIndex]],i=this.errorBarValueType(t[aa[this.keywordIndex]]),n=0;"Cap"!==t[bn[this.keywordIndex]]&&(n=1),e.writeStartElement("c","errBars",this.chartNamespace),e.writeStartElement("c","errBarType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t[wn[this.keywordIndex]].toLowerCase()),e.writeEndElement(),e.writeStartElement("c","errValType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i),e.writeEndElement(),e.writeStartElement("c","noEndCap",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement(),e.writeStartElement("c","val",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t[xn[this.keywordIndex]].toString()),e.writeEndElement(),this.serializeShapeProperties(e,"595959",!0),e.writeEndElement()},d.prototype.errorBarValueType=function(e){var t="";switch(e){case"StandardError":t="stdErr";break;case"StandardDeviation":t="stdDev";break;case"Percentage":t="percentage";break;case"Fixed":t="fixedVal";break;default:t="stdErr"}return t},d.prototype.serializeCategoryAxis=function(e,t,i){var n="catAx",r=this.chart[ir[this.keywordIndex]][Ns[this.keywordIndex]],o=this.chart[or[this.keywordIndex]],o="Scatter_Markers"===o||"Bubble"===o;"Time"===t&&(n="dateAx"),e.writeStartElement("c",n=o?"valAx":n,this.chartNamespace),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"),e.writeEndElement(),this.serializeAxis(e,"335263360",this.chart[ir[this.keywordIndex]],r,i),o||(e.writeStartElement("c","auto",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","lblAlgn",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"ctr"),e.writeEndElement(),e.writeStartElement("c","lblOffset",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"100"),e.writeEndElement()),"Time"===t?(e.writeStartElement("c","baseTimeUnit",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"days"),e.writeEndElement()):"Bubble"!==this.chart[or[this.keywordIndex]]&&(e.writeStartElement("c","noMultiLvlLbl",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()),e.writeEndElement()},d.prototype.serializeValueAxis=function(e,t,i){var n=this.chart[nr[this.keywordIndex]],t="Time"===t?"midCat":"between";e.writeStartElement("c","valAx",this.chartNamespace),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335263360"),e.writeEndElement(),this.serializeAxis(e,"335265000",n,"General",i),e.writeStartElement("c","crossBetween",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),0===n[la[this.keywordIndex]]||i||(e.writeStartElement("c","majorUnit",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n[la[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement()},d.prototype.serializeAxis=function(e,t,i,n,r){e.writeStartElement("c","scaling",this.chartNamespace),e.writeStartElement("c","orientation",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"minMax"),e.writeEndElement(),0===i[ha[this.keywordIndex]]||r||(e.writeStartElement("c","max",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[ha[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement("c","min",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[ca[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("c","delete",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","axPos",this.chartNamespace),"335265000"===t?e.writeAttributeString(void 0,"val",void 0,"l"):e.writeAttributeString(void 0,"val",void 0,"b"),e.writeEndElement(),j.parseBoolValue(i[pa[this.keywordIndex]])&&(e.writeStartElement("c","majorGridlines",this.chartNamespace),this.serializeShapeProperties(e,"D9D9D9",!0),e.writeEndElement()),j.parseBoolValue(i[ua[this.keywordIndex]])&&(e.writeStartElement("c","minorGridlines",this.chartNamespace),this.serializeShapeProperties(e,"F2F2F2",!0),e.writeEndElement()),i[rr[this.keywordIndex]]&&(e.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(e,i[$n[this.keywordIndex]],i[rr[this.keywordIndex]]),e.writeEndElement()),e.writeStartElement("c","numFmt",this.chartNamespace),e.writeAttributeString(void 0,"formatCode",void 0,n),e.writeAttributeString(void 0,"sourceLinked",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","majorTickMark",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"none"),e.writeEndElement(),e.writeStartElement("c","minorTickMark",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"none"),e.writeEndElement(),e.writeStartElement("c","tickLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"nextTo"),e.writeEndElement(),"Bubble"===this.chart[or[this.keywordIndex]]?this.serializeShapeProperties(e,"BFBFBF",!0):this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,i[It[this.keywordIndex]],"595959",i[Ia[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","crossAx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),e.writeStartElement("c","crosses",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"autoZero"),e.writeEndElement()},d.prototype.parseChartTrendLines=function(e,t){for(var i=0;i<t[Ln[this.keywordIndex]].length;i++){var n=t[Ln[this.keywordIndex]][i],r=this.chartTrendLineType(n[aa[this.keywordIndex]]),o=0,s=0,a=(j.parseBoolValue(n[Hn[this.keywordIndex]])?s=1:j.parseBoolValue(n[Sn[this.keywordIndex]])&&(o=1),t[Bn[this.keywordIndex]][i]);e.writeStartElement("c","trendline",this.chartNamespace),e.writeStartElement("c","spPr",this.chartNamespace),e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"19050"),this.serializeChartSolidFill(e,a[Er[this.keywordIndex]][fn[this.keywordIndex]],!1),e.writeStartElement("a","prstDash",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"sysDot"),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","trendlineType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r),e.writeEndElement(),e.writeStartElement("c","forward",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n[Fn[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement("c","backward",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n[Pn[this.keywordIndex]].toString()),e.writeEndElement(),"NaN"!==n[Tn[this.keywordIndex]]&&(e.writeStartElement("c","intercept",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n[Tn[this.keywordIndex]].toString()),e.writeEndElement()),e.writeStartElement("c","dispRSqr",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","dispEq",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s.toString()),e.writeEndElement(),e.writeEndElement()}},d.prototype.chartTrendLineType=function(e){var t="";switch(e){case"Linear":t="linear";break;case"Exponential":t="exp"}return t},d.prototype.parseChartDataLabels=function(e,t){var i="",n=0,r=0,o=0,s=0,a=0,l=0,d=0;switch(t[qs[this.keywordIndex]]){case"Center":i="ctr";break;case"Left":i="l";break;case"Right":i="r";break;case"Outside":i="outEnd";break;case"BestFit":i="bestFit";break;case"Bottom":case"OutsideBase":i="inBase";break;case"Inside":i="inEnd";break;case"Above":i="t";break;case"Below":i="b";break;default:i="Automatic"}e.writeStartElement("c","dLbls",this.chartNamespace),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,t[It[this.keywordIndex]],t[kt[this.keywordIndex]],t[Ia[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),j.parseBoolValue(t[An[this.keywordIndex]])?n=1:j.parseBoolValue(t[Dn[this.keywordIndex]])?r=1:j.parseBoolValue(t[Un[this.keywordIndex]])?o=1:j.parseBoolValue(t[Vn[this.keywordIndex]])?s=1:j.parseBoolValue(t[zn[this.keywordIndex]])?a=1:j.parseBoolValue(t[qn[this.keywordIndex]])?l=1:j.parseBoolValue(t[_n[this.keywordIndex]])&&(d=1),"Automatic"!==i&&(e.writeStartElement("c","dLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i),e.writeEndElement()),e.writeStartElement("c","showLegendKey",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement(),e.writeStartElement("c","showVal",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,a.toString()),e.writeEndElement(),e.writeStartElement("c","showCatName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","showSerName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s.toString()),e.writeEndElement(),e.writeStartElement("c","showPercent",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement(),e.writeStartElement("c","showBubbleSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","showLeaderLines",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,d.toString()),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeShapeProperties=function(e,t,i){var n=this.chart[or[this.keywordIndex]],r="Scatter_Markers"===n||"Bubble"===n;e.writeStartElement("c","spPr",this.chartNamespace),!r||i?(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"9525"),this.serializeChartSolidFill(e,t,!1),e.writeStartElement("a","prstDash",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"solid"),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement()):"Scatter_Markers"===n?(this.serializeChartSolidFill(e,t,!1),this.serializeDefaultLineProperties(e)):"Bubble"===n&&(this.serializeChartSolidFill(e,t,!0),this.serializeDefaultLineProperties(e)),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeDefaultShapeProperties=function(e){e.writeStartElement("c","spPr",this.chartNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),this.serializeDefaultLineProperties(e),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeDefaultLineProperties=function(e){e.writeStartElement("a","ln",this.aNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeTextProperties=function(e,t,i){var n=t[cn[this.keywordIndex]][Er[this.keywordIndex]][fn[this.keywordIndex]],r=100*t[It[this.keywordIndex]];e.writeStartElement("c","tx",this.chartNamespace),e.writeStartElement("c","rich",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeAttributeString(void 0,"rot",void 0,"0"),e.writeAttributeString(void 0,"vert",void 0,"horz"),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,t[It[this.keywordIndex]],n,t[Ia[this.keywordIndex]]),e.writeStartElement("a","r",this.aNamespace),e.writeStartElement("a","rPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeAttributeString(void 0,"sz",void 0,r.toString()),e.writeAttributeString(void 0,"baseline",void 0,"0"),this.serializeChartSolidFill(e,n,!1),this.serializeFont(e,t[Ia[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement("a","t",this.aNamespace),e.writeString(i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","layout",this.chartNamespace),e.writeEndElement(),e.writeStartElement("c","overlay",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),e.writeEndElement(),this.serializeChartTitleFont(e,t[It[this.keywordIndex]],n,t[Ia[this.keywordIndex]]),e.writeEndElement()},d.prototype.serializeChartTitleFont=function(e,t,i,n){t*=100;e.writeStartElement("a","pPr",this.aNamespace),e.writeStartElement("a","defRPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeAttributeString(void 0,"sz",void 0,t.toString()),e.writeAttributeString(void 0,"baseline",void 0,"0"),this.serializeChartSolidFill(e,i,!1),this.serializeFont(e,n),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeChartSolidFill=function(e,t,i){e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),"000000"!==t?e.writeAttributeString(void 0,"val",void 0,t):e.writeAttributeString(void 0,"val",void 0,"595959"),"Bubble"===this.chart[or[this.keywordIndex]]&&i&&(e.writeStartElement("a","alpha",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"75000"),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeFont=function(e,t){e.writeStartElement("a","latin",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement(),e.writeStartElement("a","ea",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement(),e.writeStartElement("a","cs",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement()},d.prototype.parseChartSeriesColor=function(e,t,i){for(var n=0;n<t.length;n++){var r,o=t[n];e.writeStartElement("c","spPr",this.chartNamespace),"lineChart"===i&&(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"28575"),e.writeAttributeString(void 0,"cap",void 0,"rnd")),"lineChart"!==i?this.serializeChartSolidFill(e,this.getColor(o[Er[this.keywordIndex]][ya[this.keywordIndex]]),!0):this.serializeChartSolidFill(e,o[mn[this.keywordIndex]][Or[this.keywordIndex]],!0),"lineChart"!==i&&(e.writeStartElement("a","ln",this.aNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement()),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),"lineChart"===i&&(o="none",r=0,this.chart[Yn[this.keywordIndex]][n].hasOwnProperty(En[this.keywordIndex])&&(o=this.chart[Yn[this.keywordIndex]][n][En[this.keywordIndex]][Cn[this.keywordIndex]],r=this.chart[Yn[this.keywordIndex]][n][En[this.keywordIndex]][kn[this.keywordIndex]]),e.writeStartElement("c","marker",this.chartNamespace),e.writeStartElement("c","symbol",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toLowerCase()),e.writeEndElement(),this.chart[Yn[this.keywordIndex]][n].hasOwnProperty(En[this.keywordIndex])&&(e.writeStartElement("c","size",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement()),e.writeEndElement())}},d.prototype.parseChartDataPoint=function(e,t){for(var i=t[Bn[this.keywordIndex]],n=[],r=0;r<i.length;r++)n.push(i[r]),e.writeStartElement("c","dPt",this.chartNamespace),e.writeStartElement("c","idx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","bubble3D",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.parseChartSeriesColor(e,n,this.chart[or[this.keywordIndex]]),e.writeEndElement(),n=[]},d.prototype.serializeChartCategory=function(e,t,i){var n=t[Jn[this.keywordIndex]],t=n.length;e.writeStartElement("c","f",this.chartNamespace),e.writeString("Sheet1!$A$2:$A$"+(t+1).toString()),e.writeEndElement(),e.writeStartElement("c",i,this.chartNamespace),"numCache"===i&&(e.writeStartElement("c","formatCode",this.chartNamespace),e.writeString("General"),e.writeEndElement()),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t.toString()),e.writeEndElement();for(var r=0;r<n.length;r++){var o=n[r];e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,r.toString()),e.writeStartElement("c","v",this.chartNamespace),""!==o[gn[this.keywordIndex]]&&e.writeString(o[gn[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement()}e.writeEndElement()},d.prototype.serializeChartValue=function(e,t,i){var n="scatterChart"===i||"bubbleChart"===i?"yVal":"val";this.serializeChartYValue(e,n,t),"bubbleChart"===i&&this.serializeChartYValue(e,n="bubbleSize",t="Sheet1!$C$2:$C$"),"lineChart"!==i&&"scatterChart"!==i||(e.writeStartElement("c","smooth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement())},d.prototype.serializeChartYValue=function(e,t,i){var n=this.chart[Jn[this.keywordIndex]],r=n.length;e.writeStartElement("c",t,this.chartNamespace),e.writeStartElement("c","numRef",this.chartNamespace),e.writeStartElement("c","f",this.chartNamespace),e.writeString(i+(r+1).toString()),e.writeEndElement(),e.writeStartElement("c","numCache",this.chartNamespace),e.writeStartElement("c","formatCode",this.chartNamespace),e.writeString("General"),e.writeEndElement(),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement();for(var o=0;o<r;o++)for(var s,a=n[o],l=0;l<a[un[this.keywordIndex]].length;l++)l===this.seriesCount&&(s=a[un[this.keywordIndex]][this.seriesCount],e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,o.toString()),e.writeStartElement("c","v",this.chartNamespace),"bubbleSize"!==t?e.writeString(s[pn[this.keywordIndex]].toString()):e.writeString(s[ro[this.keywordIndex]].toString()),e.writeEndElement(),e.writeEndElement());e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},d.prototype.chartType=function(e){var t=e[or[this.keywordIndex]];switch(t){case"Pie":t="pieChart";break;case"Doughnut":t="doughnutChart";break;case"Scatter_Markers":t="scatterChart";break;case"Bubble":t="bubbleChart"}return t="Line"!==(t="Bar_Stacked_100"!==(t="Area"!==t&&"Area_Stacked"!==t&&"Area_Stacked_100"!==t?t:"areaChart")&&"Bar_Stacked"!==t&&"Bar_Clustered"!==t&&"Column_Clustered"!==t&&"Column_Stacked"!==t&&"Column_Stacked_100"!==t?t:"barChart")&&"Line_Markers"!==t&&"Line_Markers_Stacked"!==t&&"Line_Stacked"!==t&&"Line_Markers_Stacked_100"!==t&&"Line_Stacked_100"!==t?t:"lineChart"},d.prototype.chartGrouping=function(e){var t="standard";return"Bar_Stacked"===e||"Column_Stacked"===e||"Area_Stacked"===e||"Line_Stacked"===e||"Line_Markers_Stacked"===e?t="stacked":"Bar_Stacked_100"===e||"Column_Stacked_100"===e||"Area_Stacked_100"===e||"Line_Stacked_100"===e||"Line_Markers_Stacked_100"===e?t="percentStacked":"Bar_Clustered"!==e&&"Column_Clustered"!==e||(t="clustered"),t},d.prototype.chartLegendPosition=function(e){var t=e[qs[this.keywordIndex]];switch(t){case"Top":t="t";break;case"Bottom":t="b";break;case"Left":t="l";break;case"Right":t="r";break;case"Corner":t="tr";break;default:t="b"}return t},d.prototype.updatechartId=function(e){var t="";return t=""===t?this.addChartRelation(this.documentCharts,e):t},d.prototype.addChartRelation=function(e,t){var i=this.getNextRelationShipID();return e.add(i,t),i},d.prototype.startsWith=function(e,t){return 0<t.length&&e.substring(0,t.length)===t},d.prototype.serializeShapeDrawingGraphics=function(e,t){var i=t[Nr[this.keywordIndex]],n=(t[hr[this.keywordIndex]],this.serializeShapeWrapStyle(e,t),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,t[dt[this.keywordIndex]]),e.writeAttributeString(void 0,"title",void 0,t[Ho[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.wpShapeNamespace),e.writeStartElement("wps","wsp",this.wpShapeNamespace),e.writeStartElement("wps","cNvCnPr",this.wpShapeNamespace),e.writeStartElement("a","cxnSpLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeShapeType",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("wps","spPr",this.wpShapeNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace),Math.round(t[mr[this.keywordIndex]]*this.emusPerPoint)),n=(e.writeAttributeString(void 0,"cx",void 0,n.toString()),Math.round(t[fr[this.keywordIndex]]*this.emusPerPoint)),n=(e.writeAttributeString(void 0,"cy",void 0,n.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),i===(1==this.keywordIndex?3:"StraightConnector")?e.writeAttributeString(void 0,"prst",void 0,"straightConnector1"):i===(1==this.keywordIndex?2:"RoundedRectangle")?e.writeAttributeString(void 0,"prst",void 0,"roundRect"):"number"!=typeof i?e.writeAttributeString(void 0,"prst",void 0,this.getExportAutoShapeType(this.getAutoShapeTypeEnumValue(i))):e.writeAttributeString(void 0,"prst",void 0,this.getExportAutoShapeType(i)),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),t[br[this.keywordIndex]]&&t[br[this.keywordIndex]][Or[this.keywordIndex]]&&j.parseBoolValue(t[br[this.keywordIndex]][Er[this.keywordIndex]])?(e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,this.getColor(t[br[this.keywordIndex]][Or[this.keywordIndex]])),e.writeEndElement()):e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),t[wr[this.keywordIndex]][xa[this.keywordIndex]]?t[wr[this.keywordIndex]][xa[this.keywordIndex]]*this.emusPerPoint:this.emusPerPoint);e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,Math.round(n).toString()),!_.isNullOrUndefined(t[wr[this.keywordIndex]][wa[this.keywordIndex]])&&t[wr[this.keywordIndex]][wa[this.keywordIndex]]!==(1==this.keywordIndex?3:"None")&&j.parseBoolValue(t[wr[this.keywordIndex]][mn[this.keywordIndex]])?(e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,this.getColor(t[wr[this.keywordIndex]][Or[this.keywordIndex]])),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","headEnd",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","tailEnd",this.aNamespace)):e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),i!==(1==this.keywordIndex?1:"Rectangle")&&i!==(1==this.keywordIndex?2:"RoundedRectangle")||(e.writeStartElement("wps","txbx",this.wpShapeNamespace),e.writeStartElement(void 0,"txbxContent",this.wNamespace),this.serializeBodyItems(e,t[Wr[this.keywordIndex]][S[this.keywordIndex]],!0),e.writeEndElement(),e.writeEndElement()),e.writeStartElement("wps","bodyPr",this.wpShapeNamespace),_.isNullOrUndefined(t[Wr[this.keywordIndex]])||(n=void 0,0<=t[Wr[this.keywordIndex]][gi[this.keywordIndex]]&&(n=Math.round(t[Wr[this.keywordIndex]][gi[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"lIns",void 0,n)),0<=t[Wr[this.keywordIndex]][fi[this.keywordIndex]]&&(n=Math.round(t[Wr[this.keywordIndex]][fi[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"tIns",void 0,n)),0<=t[Wr[this.keywordIndex]][mi[this.keywordIndex]]&&(n=Math.round(t[Wr[this.keywordIndex]][mi[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"rIns",void 0,n)),0<=t[Wr[this.keywordIndex]][yi[this.keywordIndex]]&&(n=Math.round(t[Wr[this.keywordIndex]][yi[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"bIns",void 0,n)),t[Wr[this.keywordIndex]][Lr[this.keywordIndex]]&&(i=void 0,i=(1==this.keywordIndex?j.getTextVerticalAlignment(t[Wr[this.keywordIndex]][Lr[this.keywordIndex]]):t[Wr[this.keywordIndex]][Lr[this.keywordIndex]]).toString().toLowerCase(),e.writeAttributeString(void 0,"anchor",void 0,this.getTextVerticalAlignmentProperty(i))),e.writeAttributeString(void 0,"anchorCtr",void 0,"0")),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},d.prototype.getTextVerticalAlignmentProperty=function(e){switch(e){case"top":return"t";case"middle":case"center":return"ctr";case"bottom":return"b";default:return e}},d.prototype.serializeShapeWrapStyle=function(e,t){var i,n=1==this.keywordIndex?this.getTextWrappingStyle(t[xr[this.keywordIndex]]):t[xr[this.keywordIndex]];"Inline"!==n&&(i="wrapNone",n&&"InFrontOfText"!==n&&"Behind"!==n&&(i="wrap"+n,"Tight"===n)&&(i="wrapSquare"),e.writeStartElement("wp",i,this.wpNamespace),n&&"InFrontOfText"!==n&&"Behind"!==n&&!_.isNullOrUndefined(t[Cr[this.keywordIndex]])&&(i=1==this.keywordIndex?this.getTextWrappingType(t[Cr[this.keywordIndex]]):"Both"===t[Cr[this.keywordIndex]]?"bothSides":t[Cr[this.keywordIndex]].toLowerCase(),e.writeAttributeString(void 0,"wrapText",void 0,i)),e.writeEndElement())},d.prototype.serializeDrawingGraphics=function(e,t){var i,n,r=this.getBase64ImageString(t),o=r.imageString,o=(j.parseBoolValue(t[Ar[this.keywordIndex]])&&".svg"!==(n=j.formatClippedString(r.metaFileImageString).extension)&&(o=r.metaFileImageString),i=this.updateShapeId(t,!1),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),_.isNullOrUndefined(t[cr[this.keywordIndex]])||e.writeAttributeString(void 0,"descr",void 0,t[cr[this.keywordIndex]]),e.writeAttributeString(void 0,"name",void 0,_.isNullOrUndefined(t[dt[this.keywordIndex]])?"":t[dt[this.keywordIndex]]),_.isNullOrUndefined(t[Ho[this.keywordIndex]])||e.writeAttributeString(void 0,"title",void 0,t[Ho[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.pictureNamespace),e.writeStartElement("pic","pic",this.pictureNamespace),e.writeStartElement("pic","nvPicPr",this.pictureNamespace),e.writeStartElement("pic","cNvPr",this.pictureNamespace),e.writeAttributeString(void 0,"id",void 0,"0"),e.writeAttributeString(void 0,"name",void 0,""),e.writeAttributeString(void 0,"descr",void 0,""),e.writeEndElement(),e.writeStartElement("pic","cNvPicPr",this.pictureNamespace),e.writeStartElement("a","picLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeAspect",void 0,"1"),e.writeAttributeString(void 0,"noChangeArrowheads",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","blipFill",this.pictureNamespace),e.writeStartElement("a","blip",this.aNamespace),this.startsWith(o,"data:image")?e.writeAttributeString("r","embed",this.rNamespace,i):this.documentImages.containsKey(i)&&(this.documentImages.remove(i),this.externalImages.add(i,o),e.writeAttributeString(void 0,"link",this.rNamespace,i),!_.isNullOrUndefined(r.metaFileImageString))&&(this.startsWith(o,"https://")||this.startsWith(o,"http://")||this.startsWith(o,"file://"))&&(i=this.getNextRelationShipID(),this.documentImages.add(i,r.metaFileImageString),e.writeAttributeString("r","embed",this.rNamespace,i)),".svg"===n&&this.serializeBlipExtensions(e,t),e.writeEndElement(),(!_.isNullOrUndefined(t[Dr[this.keywordIndex]])&&0!==t[Dr[this.keywordIndex]]||!_.isNullOrUndefined(t[Ur[this.keywordIndex]])&&0!==t[Ur[this.keywordIndex]]||!_.isNullOrUndefined(t[zr[this.keywordIndex]])&&0!==t[zr[this.keywordIndex]]||!_.isNullOrUndefined(t[Vr[this.keywordIndex]])&&0!==t[Vr[this.keywordIndex]])&&(e.writeStartElement("a","srcRect",this.aNamespace),o=Math.round(1e3*t[zr[this.keywordIndex]]),e.writeAttributeString(void 0,"l",void 0,o.toString()),r=Math.round(1e3*t[Dr[this.keywordIndex]]),e.writeAttributeString(void 0,"t",void 0,r.toString()),i=Math.round(1e3*t[Vr[this.keywordIndex]]),e.writeAttributeString(void 0,"r",void 0,i.toString()),n=Math.round(1e3*t[Ur[this.keywordIndex]]),e.writeAttributeString(void 0,"b",void 0,n.toString()),e.writeEndElement()),e.writeStartElement("a","stretch",this.aNamespace),e.writeStartElement("a","fillRect",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","spPr",this.pictureNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace),Math.round(t[mr[this.keywordIndex]]*this.emusPerPoint)),r=(e.writeAttributeString(void 0,"cx",void 0,o.toString()),Math.round(t[fr[this.keywordIndex]]*this.emusPerPoint));e.writeAttributeString(void 0,"cy",void 0,r.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),e.writeAttributeString(void 0,"prst",void 0,"rect"),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeBlipExtensions=function(e,t){e.writeStartElement("a","extLst",this.aNamespace),e.writeStartElement("a","ext",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"),e.writeStartElement("asvg","svgBlip",this.svgNamespace);t=this.updateShapeId(t,!0);e.writeAttributeString("r","embed",void 0,t),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},d.prototype.updateShapeId=function(e,t){var i="",n=this.paragraph;return this.headerFooter?i=this.updateHFImageRels(this.headerFooter,e,t):""===i&&(n.hasOwnProperty(ks[this.keywordIndex])||n.hasOwnProperty(ko[this.keywordIndex]))&&(i=this.addImageRelation(t?this.svgImages:this.documentImages,e,t)),i},d.prototype.addImageRelation=function(e,t,i){var n="";return(i?this.svgImageRelationIds:this.imageRelationIds).keys.indexOf(parseInt(t[Br[this.keywordIndex]]))<0||this.isHeaderFooter?(n=this.getNextRelationShipID(),(i?this.svgImageRelationIds:this.imageRelationIds).add(parseInt(t[Br[this.keywordIndex]]),n)):n=(i?this.svgImageRelationIds:this.imageRelationIds).get(parseInt(t[Br[this.keywordIndex]])),e.add(n,t),n},d.prototype.updateHFImageRels=function(e,t,i){for(var n="",r="",o=this.headersFooters.keys,s=0;s<o.length;s++)for(var a,l=this.headersFooters.get(o[s]),d=l.keys,h=0;h<d.length;h++)l.get(d[h])===e&&(r=d[h],a=void 0,i?this.headerFooterSvgImages.containsKey(r)?(a=this.headerFooterSvgImages.get(r),n=this.addImageRelation(a,t,!0)):(a=new T,n=this.addImageRelation(a,t,!0),this.headerFooterSvgImages.add(r,a)):this.headerFooterImages.containsKey(r)?(a=this.headerFooterImages.get(r),n=this.addImageRelation(a,t,!1)):(a=new T,n=this.addImageRelation(a,t,!1),this.headerFooterImages.add(r,a)));return n},d.prototype.serializeTable=function(e,t){if(_.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=0),!(t[ts[this.keywordIndex]].length<=0)){var i=this.table,n=(this.table=t,e.writeStartElement(void 0,"tbl",this.wNamespace),t[ts[this.keywordIndex]][0][$o[this.keywordIndex]]),r=(this.serializeTableFormat(e,n,t),this.serializeTableGrid(e,t),new T),o=new T,s=new T,a=t[ts[this.keywordIndex]];if(0<a.length)for(var l=0;l<a.length;l++){var d=a[l];if(0<d[es[this.keywordIndex]].length)if(d.hasOwnProperty(Fo[this.keywordIndex]))this.serializeContentControl(e,d[Fo[this.keywordIndex]],d);else{for(var h=this.row,c=(this.row=d,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,d),d[es[this.keywordIndex]]),p=c.length,u=0,g=0;g<p;g++){var m=c[g],f=m[Fa[this.keywordIndex]];if(m.hasOwnProperty(Fo[this.keywordIndex]))this.serializeContentControl(e,m[Fo[this.keywordIndex]],m);else{var y=m[Qo[this.keywordIndex]];if(0<f-u)for(var v,w=0===g?0:u+1;w<f;w++)r.containsKey(w)&&(v=this.getMergeCellFormat(y,s.get(w),w<m[Fa[this.keywordIndex]]),this.serializeTableCell(e,m,v,!1),r.set(w,r.get(w)-1),1===r.get(w)&&(r.remove(w),s.remove(w),o.containsKey(w))&&o.remove(w),o.containsKey(w))&&(u+=o.get(w)-1,0<(w+=o.get(w)))&&w--;u=f,1<y[Li[this.keywordIndex]]&&(r.add(f,y[Li[this.keywordIndex]]),s.add(f,y)),this.serializeTableCell(e,m,y,!0),1<y[Ei[this.keywordIndex]]&&1<y[Li[this.keywordIndex]]&&o.add(f,y[Ei[this.keywordIndex]]);for(var b=f+1;;b++)if(r.containsKey(b)){var x=this.getMergeCellFormat(y,s.get(b),b<m[Fa[this.keywordIndex]]);this.serializeTableCell(e,m,x,!1),r.set(b,r.get(b)-1),u++,1===r.get(b)&&(r.remove(b),s.remove(b),o.containsKey(b))&&o.remove(b),o.containsKey(b)&&(u+=o.get(b)-1,b+=o.get(b))}else if(!(g===p-1&&b<t[Wa[this.keywordIndex]]))break}}this.isBookmarkAtRowEnd||e.writeEndElement(),this.isBookmarkAtRowEnd=!1,this.row=h}}e.writeEndElement(),this.table=i}},d.prototype.getMergeCellFormat=function(e,t,i){return i?t[si[this.keywordIndex]][Vr[this.keywordIndex]]=e[si[this.keywordIndex]][zr[this.keywordIndex]]:t[si[this.keywordIndex]][zr[this.keywordIndex]]=e[si[this.keywordIndex]][Vr[this.keywordIndex]],t},d.prototype.serializeTableCell=function(e,t,i,n){var r,o=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i),this.serializeCellMargins(e,i),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,i[si[this.keywordIndex]],8,!1),e.writeEndElement(),this.serializeShading(e,t[Qo[this.keywordIndex]][Ki[this.keywordIndex]]),this.serializeTableCellDirection(e,i),this.serializeCellVerticalAlign(e,i[Bi[this.keywordIndex]]),1<i[Ei[this.keywordIndex]]&&(r=i[Ei[this.keywordIndex]],e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,r.toString()),e.writeEndElement()),1<i[Li[this.keywordIndex]]&&(e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,n?"restart":"continue"),e.writeEndElement()),e.writeEndElement(),t&&0<t[S[this.keywordIndex]].length)for(var s,a=0;a<t[S[this.keywordIndex]].length;)s=t[S[this.keywordIndex]][a],this.serializeBodyItem(e,s,!1),a+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();this.isBookmarkAtRowEnd||e.writeEndElement(),this.blockOwner=o},d.prototype.serializeTableGrid=function(e,t){e.writeStartElement(void 0,"tblGrid",this.wNamespace),0!==t[Na[this.keywordIndex]].length&&this.serializeGridColumns(e,t[Na[this.keywordIndex]]),e.writeEndElement()},d.prototype.serializeTableRows=function(e,t){var i=new T;if(0<t.length)for(var n=0;n<t.length;n++){var r=t[n];0<r[es[this.keywordIndex]].length&&(r.hasOwnProperty(Fo[this.keywordIndex])?this.serializeContentControl(e,r[Fo[this.keywordIndex]],r):this.serializeRow(e,r,i))}},d.prototype.serializeRow=function(e,t,i){var n=this.row;this.row=t,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,t),this.serializeCells(e,t[es[this.keywordIndex]],i),e.writeEndElement(),this.row=n},d.prototype.serializeRowFormat=function(e,t){this.serializeRowMargins(e,t[$o[this.keywordIndex]]),e.writeStartElement(void 0,"trPr",this.wNamespace),0<t[$o[this.keywordIndex]][fr[this.keywordIndex]]&&(e.writeStartElement(void 0,"trHeight",this.wNamespace),t[$o[this.keywordIndex]][Ai[this.keywordIndex]]===(1==this.keywordIndex?1:"Exactly")?e.writeAttributeString("w","hRule",this.wNamespace,"exact"):t[$o[this.keywordIndex]][Ai[this.keywordIndex]]===(1==this.keywordIndex?0:"AtLeast")&&e.writeAttributeString("w","hRule",this.wNamespace,"atLeast"),n=this.roundToTwoDecimal(t[$o[this.keywordIndex]][fr[this.keywordIndex]]*this.twentiethOfPoint).toString(),e.writeAttributeString("w","val",this.wNamespace,n),e.writeEndElement());var i=t[$o[this.keywordIndex]],n=i[Di[this.keywordIndex]],t=(0<n&&(e.writeStartElement(void 0,"gridBefore",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,n.toString()),e.writeEndElement()),i[zi[this.keywordIndex]]);if(0<t&&(e.writeStartElement(void 0,"gridAfter",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.toString()),e.writeEndElement()),0<n){switch(e.writeStartElement(void 0,"wBefore",this.wNamespace),i[Vi[this.keywordIndex]]){case"Percent":case 1:var r=this.roundToTwoDecimal(i[Ui[this.keywordIndex]]*this.percentageFactor).toString();e.writeAttributeString("w","w",this.wNamespace,r),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":case 2:var o=this.roundToTwoDecimal(i[Ui[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","w",this.wNamespace,o),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}if(0<t){switch(e.writeStartElement(void 0,"wAfter",this.wNamespace),i[_i[this.keywordIndex]]){case"Percent":case 1:r=this.roundToTwoDecimal(i[qi[this.keywordIndex]]*this.percentageFactor).toString();e.writeAttributeString("w","val",this.wNamespace,r),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":case 2:o=this.roundToTwoDecimal(i[qi[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","val",this.wNamespace,o),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}_.isNullOrUndefined(i[Ri[this.keywordIndex]])||j.parseBoolValue(i[Ri[this.keywordIndex]])||(e.writeStartElement(void 0,"cantSplit",this.wNamespace),e.writeEndElement()),j.parseBoolValue(i[Mi[this.keywordIndex]])&&(e.writeStartElement(void 0,"tblHeader",this.wNamespace),e.writeEndElement()),!_.isNullOrUndefined(i[Dt[this.keywordIndex]])&&0<i[Dt[this.keywordIndex]].length&&(this.serializeRevisionStart(e,i,void 0),this.serializeRevisionEnd(e,i,void 0)),e.writeEndElement()},d.prototype.serializeCells=function(e,t,i){for(var n=0;n<t.length;n++)t[n].hasOwnProperty(Fo[this.keywordIndex])?this.serializeContentControl(e,t[n][Fo[this.keywordIndex]],t[n]):this.serializeCell(e,t[n],i)},d.prototype.serializeCell=function(e,t,i){var n=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),i=this.serializeCellFormat(e,t[Qo[this.keywordIndex]],!0,!0,i),0<t[S[this.keywordIndex]].length)for(var r,o=0;o<t[S[this.keywordIndex]].length;)r=t[S[this.keywordIndex]][o],this.serializeBodyItem(e,r,!1),o+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();e.writeEndElement();var s=1;if(i.containsKey(t[Fa[this.keywordIndex]]+t[Qo[this.keywordIndex]][Ei[this.keywordIndex]]-1+s)&&1===this.row[es[this.keywordIndex]].length)for(var a=i.keys[i.keys.length-1];s<=a;)s=this.createCellForMerge(e,t,i,s),s++;else this.createCellForMerge(e,t,i,s);this.blockOwner=n},d.prototype.createCellForMerge=function(e,t,i,n){for(;i.containsKey(t[Fa[this.keywordIndex]]+t[Qo[this.keywordIndex]][Ei[this.keywordIndex]]-1+n)&&(this.row[es[this.keywordIndex]].indexOf(t)===this.row[es[this.keywordIndex]].length-1||this.row[es[this.keywordIndex]].indexOf(t)===t[Fa[this.keywordIndex]])&&void 0===t.nextNode;){var r=t[Fa[this.keywordIndex]]+t[Qo[this.keywordIndex]][Ei[this.keywordIndex]]-1+n,o=(e.writeStartElement(void 0,"tc",this.wNamespace),!0);_.isNullOrUndefined(this.spanCellFormat)?(e.writeStartElement(void 0,"tcPr",this.wNamespace),o=!1):i=this.serializeCellFormat(e,this.spanCellFormat,o=!1,o,i),this.serializeColumnSpan(r,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),_.isNullOrUndefined(this.spanCellFormat)&&(e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t[Qo[this.keywordIndex]][si[this.keywordIndex]],8,!1),e.writeEndElement()),o||e.writeEndElement(),i=this.checkMergeCell(r,i),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),n++}return n},d.prototype.serializeCellFormat=function(e,t,i,n,r){var o=this.blockOwner;this.table[ss[this.keywordIndex]],this.row[$o[this.keywordIndex]];return e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,t),this.serializeCellMargins(e,t),i&&(r=this.serializeCellMerge(e,t,r),this.serializeGridSpan(e,o)),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t[si[this.keywordIndex]],8,!1),e.writeEndElement(),this.serializeShading(e,o[Qo[this.keywordIndex]][Ki[this.keywordIndex]]),this.serializeTableCellDirection(e,t),this.serializeCellVerticalAlign(e,t[Bi[this.keywordIndex]]),n&&e.writeEndElement(),r},d.prototype.serializeCellWidth=function(e,t){e.writeStartElement(void 0,"tcW",this.wNamespace),t[Ji[this.keywordIndex]]===(1==this.keywordIndex?1:"Percent")?(e.writeAttributeString(void 0,"type",this.wNamespace,"pct"),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[Xi[this.keywordIndex]]*this.percentageFactor).toString())):t[Ji[this.keywordIndex]]===(1==this.keywordIndex?0:"Auto")?(e.writeAttributeString(void 0,"type",this.wNamespace,"auto"),e.writeAttributeString(void 0,"w",this.wNamespace,"0")):(e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[Xi[this.keywordIndex]]*this.twipsInOnePoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")),e.writeEndElement()},d.prototype.serializeCellMerge=function(e,t,i){var n,r=this.blockOwner,o=!1,s=r[Fa[this.keywordIndex]],a=this.row[es[this.keywordIndex]].indexOf(r),l=(0<a?this.row[es[this.keywordIndex]][a-1]:r)[Fa[this.keywordIndex]];if(!(o=r[Fa[this.keywordIndex]]===a&&(n=r[Fa[this.keywordIndex]],!0))){0===a&&(s=r[Fa[this.keywordIndex]],l=-1);for(var d=l;d<s;d++)n=l+1,l+=1,0===n&&i.containsKey(n)&&(i=this.createMerge(e,n,r,i))}return 1<t[Li[this.keywordIndex]]?(e.writeStartElement(void 0,"vMerge",this.wNamespace),this.spanCellFormat=t,i.add(n,t[Li[this.keywordIndex]]-1),1<t[Ei[this.keywordIndex]]&&this.mGridSpans.add(n,t[Ei[this.keywordIndex]]),e.writeAttributeString("w","val",this.wNamespace,"restart"),e.writeEndElement()):i.containsKey(n)&&o&&(i=this.createMerge(e,n,r,i)),i},d.prototype.createMerge=function(e,t,i,n){return this.serializeColumnSpan(t,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,i[Qo[this.keywordIndex]][si[this.keywordIndex]],8,!1),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i[Qo[this.keywordIndex]]),n=this.checkMergeCell(t,n)},d.prototype.serializeColumnSpan=function(e,t){0<this.mGridSpans.keys.length&&this.mGridSpans.containsKey(e)&&(t.writeStartElement(void 0,"gridSpan",this.wNamespace),t.writeAttributeString("w","val",this.wNamespace,this.mGridSpans.get(e).toString()),t.writeEndElement())},d.prototype.checkMergeCell=function(e,t){return t.get(e)-1==0?(t.remove(e),this.spanCellFormat=void 0,0<this.mGridSpans.keys.length&&this.mGridSpans.containsKey(e)&&this.mGridSpans.remove(e)):t.set(e,t.get(e)-1),t},d.prototype.serializeGridSpan=function(e,t){1<t[Qo[this.keywordIndex]][Ei[this.keywordIndex]]&&(t=t[Qo[this.keywordIndex]][Ei[this.keywordIndex]],e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t.toString()),e.writeEndElement())},d.prototype.serializeTableCellDirection=function(e,t){},d.prototype.serializeCellVerticalAlign=function(e,t){switch(e.writeStartElement(void 0,"vAlign",this.wNamespace),t){case"Center":case 1:e.writeAttributeString("w","val",this.wNamespace,"center");break;case"Bottom":case 2:e.writeAttributeString("w","val",this.wNamespace,"bottom");break;default:e.writeAttributeString("w","val",this.wNamespace,"top")}e.writeEndElement()},d.prototype.serializeGridColumns=function(e,t){for(var i=0,n=t.length;i<n;i++){var r=Math.round(20*t[i]);e.writeStartElement(void 0,"gridCol",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,r.toString()),e.writeEndElement()}},d.prototype.serializeTableFormat=function(e,t,i){e.writeStartElement(void 0,"tblPr",this.wNamespace),_.isNullOrUndefined(i[ss[this.keywordIndex]][Pt[this.keywordIndex]])||(e.writeStartElement(void 0,"tblStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i[ss[this.keywordIndex]][Pt[this.keywordIndex]]),e.writeEndElement()),this.serializeTablePositioning(e,i),this.serializeTableWidth(e,i),this.serializeTableAlignment(e,i[ss[this.keywordIndex]]),this.serializeCellSpacing(e,i[ss[this.keywordIndex]]),this.serializeTableIndentation(e,i[ss[this.keywordIndex]]),this.serializeTableMargins(e,i[ss[this.keywordIndex]]),this.serializeTableBorders(e,i[ss[this.keywordIndex]]),this.serializeShading(e,i[ss[this.keywordIndex]][Ki[this.keywordIndex]]),j.parseBoolValue(i[ss[this.keywordIndex]][Tt[this.keywordIndex]])&&(e.writeStartElement(void 0,"bidiVisual",this.wNamespace),e.writeEndElement()),this.serializeTblLayout(e,i[ss[this.keywordIndex]]),_.isNullOrUndefined(i)||e.writeEndElement()},d.prototype.serializeTablePositioning=function(e,t){var i;j.parseBoolValue(t[ns[this.keywordIndex]])&&(e.writeStartElement("w","tblpPr",this.wNamespace),0<t[os[this.keywordIndex]][hs[this.keywordIndex]]&&(i=Math.round(t[os[this.keywordIndex]][hs[this.keywordIndex]]*this.twipsInOnePoint).toString(),e.writeAttributeString("w","leftFromText",this.wNamespace,i)),0<t[os[this.keywordIndex]][ds[this.keywordIndex]]&&(i=Math.round(t[os[this.keywordIndex]][ds[this.keywordIndex]]*this.twipsInOnePoint).toString(),e.writeAttributeString("w","rightFromText",this.wNamespace,i)),0<t[os[this.keywordIndex]][ls[this.keywordIndex]]&&(i=Math.round(t[os[this.keywordIndex]][ls[this.keywordIndex]]*this.twipsInOnePoint).toString(),e.writeAttributeString("w","topFromText",this.wNamespace,i)),0<t[os[this.keywordIndex]][cs[this.keywordIndex]]&&(i=Math.round(t[os[this.keywordIndex]][cs[this.keywordIndex]]*this.twipsInOnePoint).toString(),e.writeAttributeString("w","bottomFromText",this.wNamespace,i)),_.isNullOrUndefined(t[os[this.keywordIndex]][ps[this.keywordIndex]])||(i=t[os[this.keywordIndex]][ps[this.keywordIndex]]===(1==this.keywordIndex?0:"Paragraph")?"text":(1==this.keywordIndex?this.getTableVerticalRelation(t[os[this.keywordIndex]][ps[this.keywordIndex]]):this.getTableVerticalRelation(this.getTableVerticalRelationEnumValue(t[os[this.keywordIndex]][ps[this.keywordIndex]]))).toLowerCase(),e.writeAttributeString("w","vertAnchor",this.wNamespace,i)),_.isNullOrUndefined(t[os[this.keywordIndex]][gs[this.keywordIndex]])||t[os[this.keywordIndex]][gs[this.keywordIndex]]===(1==this.keywordIndex?0:"Column")||(i=(1==this.keywordIndex?this.getTableHorizontalRelation(t[os[this.keywordIndex]][gs[this.keywordIndex]]):t[os[this.keywordIndex]][gs[this.keywordIndex]]).toLowerCase(),e.writeAttributeString("w","horzAnchor",this.wNamespace,i)),_.isNullOrUndefined(t[os[this.keywordIndex]][ms[this.keywordIndex]])||t[os[this.keywordIndex]][ms[this.keywordIndex]]===(1==this.keywordIndex?0:"Left")||(i=1==this.keywordIndex?this.getTableHorizontalAlignment(t[os[this.keywordIndex]][ms[this.keywordIndex]]):t[os[this.keywordIndex]][ms[this.keywordIndex]].toLowerCase(),e.writeAttributeString("w","tblpXSpec",this.wNamespace,i)),_.isNullOrUndefined(t[os[this.keywordIndex]][Bi[this.keywordIndex]])||t[os[this.keywordIndex]][Bi[this.keywordIndex]]===(1==this.keywordIndex?0:"None")||(i=1==this.keywordIndex?this.getTableVerticalAlignment(t[os[this.keywordIndex]][Bi[this.keywordIndex]]):t[os[this.keywordIndex]][Bi[this.keywordIndex]].toLowerCase(),e.writeAttributeString("w","tblpYSpec",this.wNamespace,i)),(!_.isNullOrUndefined(t[os[this.keywordIndex]][ms[this.keywordIndex]])&&t[os[this.keywordIndex]][ms[this.keywordIndex]]===(1==this.keywordIndex?0:"Left")||!t[os[this.keywordIndex]][ms[this.keywordIndex]])&&0<t[os[this.keywordIndex]][fs[this.keywordIndex]]&&(i=Math.round(t[os[this.keywordIndex]][fs[this.keywordIndex]]*this.twipsInOnePoint).toString(),e.writeAttributeString("w","tblpX",this.wNamespace,i)),_.isNullOrUndefined(t[os[this.keywordIndex]][Bi[this.keywordIndex]])||t[os[this.keywordIndex]][Bi[this.keywordIndex]]!==(1==this.keywordIndex?0:"None")||(i=Math.round(t[os[this.keywordIndex]][us[this.keywordIndex]]*this.twipsInOnePoint).toString(),e.writeAttributeString("w","tblpY",this.wNamespace,i)),e.writeEndElement(),j.parseBoolValue(t[os[this.keywordIndex]][as[this.keywordIndex]])||(e.writeStartElement("w","tblOverlap",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"never"),e.writeEndElement())),_.isNullOrUndefined(t[is[this.keywordIndex]])||(e.writeStartElement("w","tblDescription",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[is[this.keywordIndex]]),e.writeEndElement()),_.isNullOrUndefined(t[Ho[this.keywordIndex]])||(e.writeStartElement("w","tblCaption",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[Ho[this.keywordIndex]]),e.writeEndElement())},d.prototype.serializeTableMargins=function(e,t){this.serializeMargins(e,t,"tblCellMar")},d.prototype.serializeRowMargins=function(e,t){e.writeStartElement(void 0,"tblPrEx",this.wNamespace),e.writeStartElement(void 0,"tblBorders",this.wNamespace),this.serializeBorders(e,t[si[this.keywordIndex]],8,!1),e.writeEndElement(),this.serializeMargins(e,t,"tblCellMar"),e.writeEndElement()},d.prototype.serializeCellMargins=function(e,t){this.serializeMargins(e,t,"tcMar")},d.prototype.serializeMargins=function(e,t,i){e.writeStartElement(void 0,i,this.wNamespace),_.isNullOrUndefined(t[fi[this.keywordIndex]])||(i=Math.round(20*t[fi[this.keywordIndex]]),e.writeStartElement(void 0,"top",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()),_.isNullOrUndefined(t[gi[this.keywordIndex]])||(i=Math.round(20*t[gi[this.keywordIndex]]),e.writeStartElement(void 0,"left",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()),_.isNullOrUndefined(t[yi[this.keywordIndex]])||(i=Math.round(20*t[yi[this.keywordIndex]]),e.writeStartElement(void 0,"bottom",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()),_.isNullOrUndefined(t[mi[this.keywordIndex]])||(i=Math.round(20*t[mi[this.keywordIndex]]),e.writeStartElement(void 0,"right",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()),e.writeEndElement()},d.prototype.serializeShading=function(e,t){e.writeStartElement(void 0,"shd",this.wNamespace),t[$i[this.keywordIndex]]&&"empty"!==t[$i[this.keywordIndex]]?e.writeAttributeString(void 0,"fill",this.wNamespace,this.getColor(t[$i[this.keywordIndex]])):e.writeAttributeString(void 0,"fill",this.wNamespace,"auto"),"empty"===t[en[this.keywordIndex]]||_.isNullOrUndefined(t[en[this.keywordIndex]])?e.writeAttributeString(void 0,"color",this.wNamespace,"auto"):e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t[en[this.keywordIndex]])),_.isNullOrUndefined(t[Qi[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,this.getTextureStyle(t[Qi[this.keywordIndex]])),e.writeEndElement()},d.prototype.getTextureStyle=function(e){switch(e){case"Texture5Percent":case"Texture2Pt5Percent":case"Texture7Pt5Percent":case 1:case 2:case 3:return"pct5";case"Texture10Percent":case 4:return"pct10";case"Texture12Pt5Percent":case 5:return"pct12";case"Texture15Percent":case"Texture17Pt5Percent":case 6:case 7:return"pct15";case"Texture20Percent":case"Texture22Pt5Percent":case 8:case 9:return"pct20";case"Texture25Percent":case"Texture27Pt5Percent":case 10:case 11:return"pct25";case"Texture30Percent":case"Texture32Pt5Percent":case 12:case 13:return"pct30";case"Texture35Percent":case 14:return"pct35";case"Texture37Pt5Percent":case 15:return"pct37";case"Texture40Percent":case"Texture42Pt5Percent":case 16:case 17:return"pct40";case"Texture45Percent":case"Texture47Pt5Percent":case 18:case 19:return"pct45";case"Texture50Percent":case"Texture52Pt5Percent":case 20:case 21:return"pct50";case"Texture55Percent":case"Texture57Pt5Percent":case 22:case 23:return"pct55";case"Texture60Percent":case 24:return"pct60";case"Texture62Pt5Percent":case 25:return"pct62";case"Texture65Percent":case"Texture67Pt5Percent":case 26:case 27:return"pct65";case"Texture70Percent":case"Texture72Pt5Percent":case 28:case 29:return"pct70";case"Texture75Percent":case"Texture77Pt5Percent":case 30:case 31:return"pct75";case"Texture80Percent":case"Texture82Pt5Percent":case 32:case 33:return"pct80";case"Texture85Percent":case 34:return"pct85";case"Texture87Pt5Percent":case 35:return"pct87";case"Texture90Percent":case"Texture92Pt5Percent":case 36:case 37:return"pct90";case"Texture95Percent":case"Texture97Pt5Percent":case 38:case 39:return"pct95";case 40:return"solid";case"TextureCross":return"thinHorzCross";case"TextureDarkCross":return"horzCross";case"TextureDarkDiagonalCross":return"diagCross";case"TextureDarkDiagonalDown":return"reverseDiagStripe";case"TextureDarkDiagonalUp":return"diagStripe";case"TextureDarkHorizontal":case 41:return"horzStripe";case"TextureDarkVertical":case 42:return"vertStripe";case 43:return"reverseDiagStripe";case 44:return"diagStripe";case 45:return"horzCross";case 46:return"diagCross";case"TextureDiagonalCross":return"thinDiagCross";case"TextureDiagonalDown":return"thinReverseDiagStripe";case"TextureDiagonalUp":return"thinDiagStripe";case"TextureHorizontal":case 47:return"thinHorzStripe";case"TextureSolid":return"solid";case"TextureVertical":case 48:return"thinVertStripe";case 49:return"thinReverseDiagStripe";case 50:return"thinDiagStripe";case 51:return"thinHorzCross";case 52:return"thinDiagCross";default:return"clear"}},d.prototype.serializeParagraphBorders=function(e,t){var i=t[si[this.keywordIndex]];_.isNullOrUndefined(i)||(e.writeStartElement(void 0,"pBdr",this.wNamespace),this.serializeBorders(e,t[si[this.keywordIndex]],8,!0),e.writeEndElement())},d.prototype.serializeTableBorders=function(e,t){var i=t[si[this.keywordIndex]];_.isNullOrUndefined(i)||(e.writeStartElement(void 0,"tblBorders",this.wNamespace),this.serializeBorders(e,t[si[this.keywordIndex]],8,!1),e.writeEndElement())},d.prototype.serializeBorders=function(e,t,i,n){this.serializeBorder(e,t[Dr[this.keywordIndex]],"top",i),this.serializeBorder(e,t[zr[this.keywordIndex]],"left",i),this.serializeBorder(e,t[Ur[this.keywordIndex]],"bottom",i),this.serializeBorder(e,t[Vr[this.keywordIndex]],"right",i),n?(this.serializeBorder(e,t[on[this.keywordIndex]],"between",i),this.serializeBorder(e,t[rn[this.keywordIndex]],"bar",i)):(this.serializeBorder(e,t[on[this.keywordIndex]],"insideH",i),this.serializeBorder(e,t[rn[this.keywordIndex]],"insideV",i),this.serializeBorder(e,t[an[this.keywordIndex]],"tl2br",i),this.serializeBorder(e,t[sn[this.keywordIndex]],"tr2bl",i))},d.prototype.serializeTblLayout=function(e,t){(!j.parseBoolValue(t[ji[this.keywordIndex]])||t[Xi[this.keywordIndex]]>this.containerWidth)&&(e.writeStartElement(void 0,"tblLayout",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"fixed"),e.writeEndElement())},d.prototype.serializeBorder=function(e,t,i,n){var r=t[ln[this.keywordIndex]],n=(t[dn[this.keywordIndex]]||0)*n,o=t[Qs[this.keywordIndex]]||0;r===(1==this.keywordIndex?26:"Cleared")?(e.writeStartElement(void 0,i,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"nil"),e.writeEndElement()):(r===(1==this.keywordIndex?1:"None")||_.isNullOrUndefined(r))&&!j.parseBoolValue(t[nn[this.keywordIndex]])||n<0&&!j.parseBoolValue(t[nn[this.keywordIndex]])||(e.writeStartElement(void 0,i,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getBorderStyle(r)),t[Or[this.keywordIndex]]&&e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t[Or[this.keywordIndex]])),e.writeAttributeString(void 0,"sz",this.wNamespace,this.roundToTwoDecimal(n).toString()),e.writeAttributeString(void 0,"space",this.wNamespace,o.toString()),j.parseBoolValue(t[tn[this.keywordIndex]])&&e.writeAttributeString(void 0,"shadow",this.wNamespace,"on"),e.writeEndElement())},d.prototype.getBorderStyle=function(e){switch(e){case"Cleared":return"cleared";case"None":case 1:return"None";case"DashSmallGap":return"dashSmallGap";case"Triple":return"triple";case"Dot":case 2:return"dotted";case 3:return"dashSmallGap";case"DashDot":return"dotDash";case"DashLargeGap":case 4:return"dashed";case 5:return"dotDash";case"DashDotDot":case 6:return"dotDotDash";case"Double":case 7:return"double";case 8:return"triple";case"ThinThickSmallGap":case 9:return"thinThickSmallGap";case"ThickThinSmallGap":case 10:return"thickThinSmallGap";case"ThinThickThinSmallGap":case 11:return"thinThickThinSmallGap";case"ThickThinMediumGap":case 12:return"thickThinMediumGap";case"ThinThickMediumGap":case 13:return"thinThickMediumGap";case"ThinThickThinMediumGap":case 14:return"thinThickThinMediumGap";case"ThickThinLargeGap":return"thickThinLargeGap";case"ThinThickLargeGap":case 15:return"thinThickLargeGap";case 16:return"thickThinLargeGap";case"ThinThickThinLargeGap":case 17:return"thinThickThinLargeGap";case"Thick":return"thick";case"SingleWavy":case 18:return"wave";case"DoubleWavy":case 19:return"doubleWave";case"DashDotStroked":case 20:return"dashDotStroked";case"Engrave3D":return"threeDEngrave";case"Emboss3D":case 21:return"threeDEmboss";case 22:return"threeDEngrave";case"Outset":case 23:return"outset";case"Inset":case 24:return"inset";case 25:return"thick";case 26:return"cleared";default:return"single"}},d.prototype.serializeTableIndentation=function(e,t){_.isNullOrUndefined(t[_t[this.keywordIndex]])||(e.writeStartElement(void 0,"tblInd",this.wNamespace),t=Math.round(t[_t[this.keywordIndex]]*this.twipsInOnePoint),e.writeAttributeString(void 0,"w",this.wNamespace,t.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement())},d.prototype.serializeCellSpacing=function(e,t){!_.isNullOrUndefined(t[Gi[this.keywordIndex]])&&0<t[Gi[this.keywordIndex]]&&(e.writeStartElement(void 0,"tblCellSpacing",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[Gi[this.keywordIndex]]/2*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement())},d.prototype.serializeTableWidth=function(e,t){var i;e.writeStartElement(void 0,"tblW",this.wNamespace),t[ss[this.keywordIndex]][Ji[this.keywordIndex]]===(1==this.keywordIndex?1:"Percent")?(i=Math.round(t[ss[this.keywordIndex]][Xi[this.keywordIndex]]*this.percentageFactor),e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"pct")):t[ss[this.keywordIndex]][Ji[this.keywordIndex]]===(1==this.keywordIndex?2:"Point")?(i=Math.round(t[ss[this.keywordIndex]][Xi[this.keywordIndex]]*this.twipsInOnePoint),e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")):(e.writeAttributeString(void 0,"w",this.wNamespace,"0"),e.writeAttributeString(void 0,"type",this.wNamespace,"auto")),e.writeEndElement()},d.prototype.serializeTableAlignment=function(e,t){switch(e.writeStartElement(void 0,"jc",this.wNamespace),t[Zi[this.keywordIndex]]){case"Right":e.writeAttributeString("w","val",this.wNamespace,"right");break;case"Center":case 1:e.writeAttributeString("w","val",this.wNamespace,"center");break;case 2:e.writeAttributeString("w","val",this.wNamespace,"right");break;default:e.writeAttributeString("w","val",this.wNamespace,"left")}e.writeEndElement()},d.prototype.serializeFieldCharacter=function(e,t){e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[Ae[this.keywordIndex]]),e.writeStartElement(void 0,"fldChar",this.wNamespace);var i=0===t[Kr[this.keywordIndex]]?"begin":1===t[Kr[this.keywordIndex]]?"end":"separate";if(e.writeAttributeString(void 0,"fldCharType",this.wNamespace,i),"begin"==i&&!_.isNullOrUndefined(t[Gr[this.keywordIndex]])){var n=t[Gr[this.keywordIndex]];if(e.writeStartElement(void 0,"ffData",this.wNamespace),e.writeStartElement(void 0,"name",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[dt[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement(void 0,"enabled",this.wNamespace),e.writeEndElement(),n.hasOwnProperty(Yr[this.keywordIndex])){e.writeStartElement(void 0,"textInput",this.wNamespace);i=1==this.keywordIndex?this.getTextFormFieldType(n[Yr[this.keywordIndex]][aa[this.keywordIndex]]):n[Yr[this.keywordIndex]][aa[this.keywordIndex]].toString();e.writeStartElement(void 0,"type",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"Calculation"==i?"calculated":i.toLowerCase()),e.writeEndElement(),e.writeStartElement(void 0,"default",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[Yr[this.keywordIndex]][to[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement(void 0,"format",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex&&"Text"===i?this.getTextFormFieldFormat(n[Yr[this.keywordIndex]][io[this.keywordIndex]]):n[Yr[this.keywordIndex]][io[this.keywordIndex]]),e.writeEndElement()}else if(n.hasOwnProperty(Qr[this.keywordIndex]))e.writeStartElement(void 0,"checkBox",this.wNamespace),n[Qr[this.keywordIndex]][no[this.keywordIndex]]===(1==this.keywordIndex?0:"Auto")?e.writeStartElement(void 0,"sizeAuto",this.wNamespace):(e.writeStartElement(void 0,"size",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.roundToTwoDecimal(2*n[Qr[this.keywordIndex]][ro[this.keywordIndex]]).toString())),e.writeEndElement(),e.writeStartElement(void 0,"defalut",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[Qr[this.keywordIndex]][to[this.keywordIndex]]?"1":"0"),e.writeEndElement(),n[Qr[this.keywordIndex]][oo[this.keywordIndex]]&&(e.writeStartElement(void 0,"checked",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[Qr[this.keywordIndex]][oo[this.keywordIndex]]?"1":"0"),e.writeEndElement());else{e.writeStartElement(void 0,"ddList",this.wNamespace),0!==n[$r[this.keywordIndex]][ao[this.keywordIndex]]&&(e.writeStartElement(void 0,"result",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[$r[this.keywordIndex]][ao[this.keywordIndex]].toString()),e.writeEndElement());for(var r=0;r<n[$r[this.keywordIndex]][so[this.keywordIndex]].length;r++)e.writeStartElement(void 0,"listEntry",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[$r[this.keywordIndex]][so[this.keywordIndex]][r].toString()),e.writeEndElement()}e.writeEndElement(),e.writeEndElement()}e.writeEndElement(),e.writeEndElement(),0===t[Kr[this.keywordIndex]]&&"FieldFormTextInput"===t[Kr[this.keywordIndex]]&&(e.writeStartElement("w","r",this.wNamespace),e.writeStartElement(void 0,"instrText",this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString("FORMTEXT"),e.writeEndElement(),e.writeEndElement())},d.prototype.serializeTextRange=function(e,t,i,n){e.writeStartElement("w","r",this.wNamespace),_.isNullOrUndefined(t[Ae[this.keywordIndex]])||this.serializeCharacterFormat(e,t[Ae[this.keywordIndex]]),"\t"===t[dr[this.keywordIndex]]?e.writeElementString(void 0,"tab",this.wNamespace,void 0):"\v"===t[dr[this.keywordIndex]]?e.writeElementString(void 0,"br",this.wNamespace,void 0):(_.isNullOrUndefined(t[Ht[this.keywordIndex]])?"\f"===t[dr[this.keywordIndex]]?(e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"page")):"\r"===t[dr[this.keywordIndex]]?e.writeStartElement("w","cr",this.wNamespace):t[dr[this.keywordIndex]]===String.fromCharCode(14)?(e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"column")):"%02"===encodeURI(t[dr[this.keywordIndex]])?e.writeStartElement(void 0,"footnoteRef",this.wNamespace):"%02"===encodeURI(t[dr[this.keywordIndex]])&&"endnote"===n?e.writeStartElement(void 0,"endnoteRef",this.wNamespace):"%03"===encodeURI(t[dr[this.keywordIndex]])?e.writeStartElement(void 0,"separator",this.wNamespace):"%04"===encodeURI(t[dr[this.keywordIndex]])?e.writeStartElement(void 0,"continuationSeparator",this.wNamespace):(n=this.retrieveDeleteRevision(t),i=!_.isNullOrUndefined(i)&&i.hasOwnProperty(Kr[this.keywordIndex])&&2!==i[Kr[this.keywordIndex]],e.writeStartElement(void 0,i?n?"delInstrText":"instrText":n?"delText":"t",this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString(t[dr[this.keywordIndex]])):(e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"textWrapping"),e.writeAttributeString("w","clear",this.wNamespace,this.getBreakClearType(t[Ht[this.keywordIndex]]).toString().toLowerCase())),e.writeEndElement()),e.writeEndElement()},d.prototype.retrieveDeleteRevision=function(e){if(e.hasOwnProperty(Dt[this.keywordIndex])&&0<e[Dt[this.keywordIndex]].length)for(var t=0;t<e[Dt[this.keywordIndex]].length;t++)if("Deletion"===this.retrieveRevision(e[Dt[this.keywordIndex]][t]).revisionType)return!0;return!1},d.prototype.serializeParagraphFormat=function(e,t,i,n){_.isNullOrUndefined(t)||(_.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=n),this.serializeParagraphBorders(e,t),_.isNullOrUndefined(t[Pt[this.keywordIndex]])||(e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[Pt[this.keywordIndex]]),e.writeEndElement()),_.isNullOrUndefined(i)?this.serializeListFormat(e,t[ei[this.keywordIndex]]):this.serializeListFormat(e,i[De[this.keywordIndex]][ei[this.keywordIndex]]),j.parseBoolValue(t[Tt[this.keywordIndex]])&&(e.writeStartElement(void 0,"bidi",this.wNamespace),e.writeEndElement()),_.isNullOrUndefined(t[ti[this.keywordIndex]])||(e.writeStartElement(void 0,"keepNext",this.wNamespace),j.parseBoolValue(t[ti[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),_.isNullOrUndefined(t[ni[this.keywordIndex]])||(e.writeStartElement(void 0,"keepLines",this.wNamespace),j.parseBoolValue(t[ni[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),_.isNullOrUndefined(t[ri[this.keywordIndex]])||(e.writeStartElement(void 0,"outlineLvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getOutlineLevelValue(t[ri[this.keywordIndex]]).toString()),e.writeEndElement()),this.serializeParagraphSpacing(e,t),_.isNullOrUndefined(t[oi[this.keywordIndex]])||(e.writeStartElement("w","contextualSpacing",this.wNamespace),j.parseBoolValue(t[oi[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),_.isNullOrUndefined(t[ii[this.keywordIndex]])||(e.writeStartElement("w","widowControl",this.wNamespace),j.parseBoolValue(t[ii[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,"1"):e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),this.serializeIndentation(e,t),this.serializeParagraphAlignment(e,t[Kt[this.keywordIndex]],j.parseBoolValue(t[Tt[this.keywordIndex]])),!_.isNullOrUndefined(t[ai[this.keywordIndex]])&&0<t[ai[this.keywordIndex]].length&&this.serializeTabs(e,t[ai[this.keywordIndex]]))},d.prototype.getOutlineLevelValue=function(e){if(1==this.keywordIndex){if(0<e)return e-1}else if(-1!==e.toString().indexOf("Level")){e=parseInt(e.toString().substring(5),10);if(0<e)return e-1}return 9},d.prototype.serializeTabs=function(e,t){e.writeStartElement("w","tabs",this.wNamespace);for(var i=0;i<t.length;i++)this.serializeTab(e,t[i]);e.writeEndElement()},d.prototype.serializeTab=function(e,t){var i=0;e.writeStartElement("w","tab",this.wNamespace),0===t[qs[this.keywordIndex]]&&0!==t[_s[this.keywordIndex]]?(i=t[_s[this.keywordIndex]]*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,"clear")):(i=t[qs[this.keywordIndex]]*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,this.getTabJustification(t[zs[this.keywordIndex]]))),_.isNullOrUndefined(t[js[this.keywordIndex]])||t[js[this.keywordIndex]]===(1==this.keywordIndex?0:"None")||e.writeAttributeString("w","leader",this.wNamespace,this.getTabLeader(t[js[this.keywordIndex]])),isNaN(i)||e.writeAttributeString("w","pos",this.wNamespace,i.toString()+""),e.writeEndElement()},d.prototype.getTextWrappingType=function(e){switch(e){case 0:return"bothSides";case 1:return"left";case 2:return"right";case 3:return"largest";default:return"bothSides"}},d.prototype.getTextWrappingStyle=function(e){switch(e){case 1:return"InFrontOfText";case 2:return"Square";case 3:return"TopAndBottom";case 4:return"Behind";default:return"Inline"}},d.prototype.getDateStorageFormat=function(e){switch(e){case 2:return"DateStorageDateTime";case 3:return"DateStorageText";default:return"DateStorageDate"}},d.prototype.getDateCalendarType=function(e){switch(e){case 1:return"GregorianArabic";case 2:return"GregorianEnglish";case 3:return"GregorianMiddleEastFrench";case 4:return"GregorianTransliteratedEnglish";case 5:return"GregorianTransliteratedFrench";case 6:return"Hebrew";case 7:return"Hijri";case 8:return"Japan";case 9:return"Korean";case 10:return"Saka";case 11:return"Taiwan";case 12:return"Thai";default:return"Gregorian"}},d.prototype.getContentControlAppearance=function(e){switch(e){case 2:return"Hidden";case 3:return"Tags";default:return"BoundingBox"}},d.prototype.getTextFormFieldFormat=function(e){switch(e){case 1:return"FirstCapital";case 2:return"Lowercase";case 3:return"Uppercase";case 4:return"Titlecase";default:return"None"}},d.prototype.getTextFormFieldType=function(e){switch(e){case 1:return"Number";case 2:return"Date";case 3:return"Calculation";default:return"Text"}},d.prototype.getTabLeader=function(e){switch(e){case"Dot":case 2:return"dot";case"Hyphen":case 3:return"hyphen";case"Underscore":case 4:return"underscore";default:return"none"}},d.prototype.getTabJustification=function(e){switch(e){case"Bar":case 0:return"left";case 1:return"bar";case"Center":case 2:return"center";case"Decimal":case 3:return"decimal";case"Left":return"left";case"List":case 4:return"num";case"Right":case 5:return"right";default:return"clear"}},d.prototype.getTableVerticalAlignment=function(e){switch(e){case 1:return"top";case 2:return"center";case 3:return"bottom";case 4:return"inside";case 5:return"outside";default:return"none"}},d.prototype.getTableHorizontalAlignment=function(e){switch(e){case 1:return"center";case 2:return"inside";case 3:return"outside";case 4:return"right";default:return"left"}},d.prototype.getTableVerticalRelationEnumValue=function(e){switch(e){case"Paragraph":return 0;case"Margin":return 1;case"Page":return 2;default:return 0}},d.prototype.getTableVerticalRelation=function(e){switch(e){case 1:return"Margin";case 2:return"Page";default:return"Paragraph"}},d.prototype.getTableHorizontalRelation=function(e){switch(e){case 1:return"Margin";case 2:return"Page";default:return"Column"}},d.prototype.getVerticalOrigin=function(e){switch(e){case 1:return"BottomMargin";case 2:return"InsideMargin";case 3:return"Line";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"TopMargin";default:return"Paragraph"}},d.prototype.getHorizontalOrigin=function(e){switch(e){case 1:return"Character";case 2:return"InsideMargin";case 3:return"LeftMargin";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"RightMargin";default:return"Column"}},d.prototype.getShapeVerticalAlignment=function(e){switch(e){case 1:return"Top";case 2:return"Center";case 3:return"Bottom";case 4:return"Inline";case 5:return"Inside";case 6:return"Outside";default:return"None"}},d.prototype.getShapeHorizontalAlignment=function(e){switch(e){case 1:return"Center";case 2:return"Inside";case 3:return"Left";case 4:return"Outside";case 5:return"Right";default:return"None"}},d.prototype.getBiDirectionalOverride=function(e){switch(e){case 1:return"LTR";case 2:return"RTL";default:return"None"}},d.prototype.getBreakClearType=function(e){switch(e){case 0:return"None";case 1:return"Left";case 2:return"Right";case 3:return"All";default:return e}},d.prototype.serializeListFormat=function(e,t){_.isNullOrUndefined(t[Ut[this.keywordIndex]])&&_.isNullOrUndefined(t[qt[this.keywordIndex]])||(e.writeStartElement(void 0,"numPr",this.wNamespace),_.isNullOrUndefined(t[qt[this.keywordIndex]])||-1===t[qt[this.keywordIndex]]||(e.writeStartElement(void 0,"ilvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[qt[this.keywordIndex]].toString()),e.writeEndElement()),_.isNullOrUndefined(t[Ut[this.keywordIndex]])||(e.writeStartElement(void 0,"numId",this.wNamespace),t=(t[Ut[this.keywordIndex]]+1).toString(),e.writeAttributeString("w","val",this.wNamespace,t),e.writeEndElement()),e.writeEndElement())},d.prototype.serializeParagraphAlignment=function(e,t,i){if(!_.isNullOrUndefined(t)){e.writeStartElement(void 0,"jc",this.wNamespace);var n=void 0;switch(t){case"Center":case 1:n="center";break;case"Right":case 2:n="right";break;case"Justify":case 3:n="both";break;default:n="left"}e.writeAttributeString("w","val",this.wNamespace,n),e.writeEndElement()}},d.prototype.serializeParagraphSpacing=function(e,t){var i;e.writeStartElement(void 0,"spacing",this.wNamespace),_.isNullOrUndefined(t[Xt[this.keywordIndex]])||e.writeAttributeString(void 0,"before",this.wNamespace,this.roundToTwoDecimal(t[Xt[this.keywordIndex]]*this.twentiethOfPoint).toString()),_.isNullOrUndefined(t[Yt[this.keywordIndex]])||(i=1==this.keywordIndex?t[Yt[this.keywordIndex]].toString():t[Yt[this.keywordIndex]]?"1":"0",e.writeAttributeString(void 0,"beforeAutospacing",this.wNamespace,i)),_.isNullOrUndefined(t[Zt[this.keywordIndex]])||e.writeAttributeString(void 0,"after",this.wNamespace,this.roundToTwoDecimal(t[Zt[this.keywordIndex]]*this.twentiethOfPoint).toString()),_.isNullOrUndefined(t[Jt[this.keywordIndex]])||(i=1==this.keywordIndex?t[Jt[this.keywordIndex]].toString():t[Jt[this.keywordIndex]]?"1":"0",e.writeAttributeString(void 0,"afterAutospacing",this.wNamespace,i)),_.isNullOrUndefined(t[Qt[this.keywordIndex]])||(i=t[$t[this.keywordIndex]]===(1==this.keywordIndex?1:"AtLeast")||t[$t[this.keywordIndex]]===(1==this.keywordIndex?2:"Exactly")?this.roundToTwoDecimal(t[Qt[this.keywordIndex]]*this.twentiethOfPoint):this.roundToTwoDecimal(240*t[Qt[this.keywordIndex]]),e.writeAttributeString(void 0,"line",this.wNamespace,i.toString())),_.isNullOrUndefined(t[$t[this.keywordIndex]])||(i="auto",t[$t[this.keywordIndex]]===(1==this.keywordIndex?1:"AtLeast")?i="atLeast":t[$t[this.keywordIndex]]===(1==this.keywordIndex?2:"Exactly")&&(i="exact"),e.writeAttributeString(void 0,"lineRule",this.wNamespace,i)),e.writeEndElement()},d.prototype.serializeIndentation=function(e,t){e.writeStartElement(void 0,"ind",this.wNamespace),_.isNullOrUndefined(t[_t[this.keywordIndex]])||e.writeAttributeString(void 0,"left",this.wNamespace,this.roundToTwoDecimal(t[_t[this.keywordIndex]]*this.twipsInOnePoint).toString()),_.isNullOrUndefined(t[jt[this.keywordIndex]])||e.writeAttributeString(void 0,"right",this.wNamespace,this.roundToTwoDecimal(t[jt[this.keywordIndex]]*this.twipsInOnePoint).toString()),_.isNullOrUndefined(t[Gt[this.keywordIndex]])||(t[Gt[this.keywordIndex]]<0?e.writeAttributeString(void 0,"hanging",this.wNamespace,this.roundToTwoDecimal(-1*t[Gt[this.keywordIndex]]*this.twipsInOnePoint).toString()):e.writeAttributeString(void 0,"firstLine",this.wNamespace,this.roundToTwoDecimal(t[Gt[this.keywordIndex]]*this.twipsInOnePoint).toString())),e.writeEndElement()},d.prototype.serializeCustomXMLMapping=function(e,t){if(0<e.length)for(var i=e.keys,n=0;n<i.length;n++){var r=new x.XmlWriter,o=(r.writeStartElement(void 0,"Relationships",this.rpNamespace),this.mCustomXML.get(i[n])),s=i[n],a=this.getNextRelationShipID(),l=n+1,o=this.createXMLItem(o,a,l),s=this.createXMLItemProps(s,l),a=(this.serializeRelationShip(t,a,this.customXmlRelType,"../"+o),this.customXMLRelation(r,l,s),r.writeEndElement(),new f.ZipArchiveItem(r.buffer,this.customXMLRelPath+l+".xml.rels"));this.mArchive.addItem(a)}},d.prototype.customXMLRelation=function(e,t,i){this.serializeRelationShip(e,"rId1",this.wordMLCustomXmlPropsRelType,i)},d.prototype.createXMLItem=function(e,t,i){e=new Blob([e],{type:"text/plain"}),i=this.customXMLItemsPath+i+".xml",e=new f.ZipArchiveItem(e,i);return this.mArchive.addItem(e),i},d.prototype.createXMLItemProps=function(e,t){var i=new x.XmlWriter,n=this.customXMLItemsPropspath+t+".xml",t=this.itemPropsPath+t+".xml",e=(i.writeStartElement("ds","datastoreItem",this.wNamespace),i.writeAttributeString("ds","itemID",void 0,e),i.writeAttributeString("xmlns","ds",void 0,this.dsNamespace),i.writeEndElement(),this.customXMLProps.push(n),new f.ZipArchiveItem(i.buffer,n));return this.mArchive.addItem(e),t},d.prototype.serializeStyles=function(){var e=new x.XmlWriter,e=(e.writeStartElement("w","styles",this.wNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDefaultStyles(e),this.serializeDocumentStyles(e),e.writeEndElement(),new f.ZipArchiveItem(e.buffer,this.stylePath));this.mArchive.addItem(e)},d.prototype.serializeDefaultStyles=function(e){e.writeStartElement(void 0,"docDefaults",this.wNamespace),e.writeStartElement(void 0,"rPrDefault",this.wNamespace),this.serializeCharacterFormat(e,this.defCharacterFormat),e.writeEndElement(),e.writeStartElement(void 0,"pPrDefault",this.wNamespace),_.isNullOrUndefined(this.defParagraphFormat)||(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,this.defParagraphFormat,void 0),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},d.prototype.serializeDocumentStyles=function(e){for(var t=0;t<this.mStyles.length;t++){var i=this.mStyles[t],n=(e.writeStartElement(void 0,"style",this.wNamespace),this.getStyleType(i[aa[this.keywordIndex]]));e.writeAttributeString("w","type",this.wNamespace,n),e.writeAttributeString("w","styleId",this.wNamespace,i[dt[this.keywordIndex]]),e.writeStartElement(void 0,"name",this.wNamespace);-1!=["TOC 1","TOC 2","TOC 3","TOC 4","TOC 5","TOC 6","TOC 7","TOC 8","TOC 9"].indexOf(i[dt[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,i[dt[this.keywordIndex]].toLowerCase()):e.writeAttributeString("w","val",this.wNamespace,i[dt[this.keywordIndex]]),e.writeEndElement(),_.isNullOrUndefined(i[ht[this.keywordIndex]])||(e.writeStartElement(void 0,"basedOn",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i[ht[this.keywordIndex]]),e.writeEndElement()),_.isNullOrUndefined(i[ct[this.keywordIndex]])||(e.writeStartElement(void 0,"next",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i[ct[this.keywordIndex]]),e.writeEndElement()),_.isNullOrUndefined(i[pt[this.keywordIndex]])||(e.writeStartElement(void 0,"link",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i[pt[this.keywordIndex]]),e.writeEndElement()),i[aa[this.keywordIndex]]===(1==this.keywordIndex?0:"Paragraph")&&(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,i[De[this.keywordIndex]],void 0),e.writeEndElement()),i[aa[this.keywordIndex]]!==(1==this.keywordIndex?2:"Table")&&this.serializeCharacterFormat(e,i[Ae[this.keywordIndex]]),e.writeEndElement()}},d.prototype.serializeCharacterFormat=function(e,t){var i;if(_.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=0),e.writeStartElement(void 0,"rPr",this.wNamespace),_.isNullOrUndefined(t[Pt[this.keywordIndex]])||(e.writeStartElement(void 0,"rStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[Pt[this.keywordIndex]]),e.writeEndElement()),_.isNullOrUndefined(t[Ft[this.keywordIndex]])&&_.isNullOrUndefined(t[Wt[this.keywordIndex]])||(e.writeStartElement(void 0,"rFonts",this.wNamespace),_.isNullOrUndefined(t[Rt[this.keywordIndex]])||(i=j.isThemeFont(t[Rt[this.keywordIndex]])?"asciiTheme":"ascii",e.writeAttributeString(void 0,i,this.wNamespace,t[Rt[this.keywordIndex]])),_.isNullOrUndefined(t[Mt[this.keywordIndex]])||(i=j.isThemeFont(t[Mt[this.keywordIndex]])?"eastAsiaTheme":"eastAsia",e.writeAttributeString(void 0,i,this.wNamespace,t[Mt[this.keywordIndex]])),_.isNullOrUndefined(t[At[this.keywordIndex]])||(i=j.isThemeFont(t[At[this.keywordIndex]])?"hAnsiTheme":"hAnsi",e.writeAttributeString(void 0,i,this.wNamespace,t[At[this.keywordIndex]])),_.isNullOrUndefined(t[Wt[this.keywordIndex]])||(i=j.isThemeFont(t[Wt[this.keywordIndex]])?"cstheme":"cs",e.writeAttributeString(void 0,i,this.wNamespace,t[Wt[this.keywordIndex]])),e.writeEndElement()),_.isNullOrUndefined(t[ft[this.keywordIndex]])||this.serializeBoolProperty(e,"b",j.parseBoolValue(t[ft[this.keywordIndex]])),j.parseBoolValue(t[Ot[this.keywordIndex]])&&this.serializeBoolProperty(e,"bCs",j.parseBoolValue(t[Ot[this.keywordIndex]])),_.isNullOrUndefined(t[yt[this.keywordIndex]])||this.serializeBoolProperty(e,"i",j.parseBoolValue(t[yt[this.keywordIndex]])),_.isNullOrUndefined(t[Et[this.keywordIndex]])||this.serializeBoolProperty(e,"iCs",j.parseBoolValue(t[Et[this.keywordIndex]])),j.parseBoolValue(t[Tt[this.keywordIndex]])&&(e.writeStartElement(void 0,"rtl",this.wNamespace),e.writeEndElement()),_.isNullOrUndefined(t[Lt[this.keywordIndex]])||this.serializeBoolProperty(e,"caps",j.parseBoolValue(t[Lt[this.keywordIndex]])),j.parseBoolValue(t[Bt[this.keywordIndex]])&&this.serializeBoolProperty(e,"cs",j.parseBoolValue(t[Bt[this.keywordIndex]])),!_.isNullOrUndefined(t[xt[this.keywordIndex]]))switch(t[xt[this.keywordIndex]]){case"SingleStrike":case 1:this.serializeBoolProperty(e,"strike",!0);break;case"DoubleStrike":case 2:this.serializeBoolProperty(e,"dstrike",!0);break;default:this.serializeBoolProperty(e,"strike",!1),this.serializeBoolProperty(e,"dstrike",!1)}if(_.isNullOrUndefined(t[kt[this.keywordIndex]])||(e.writeStartElement(void 0,"color",this.wNamespace),"empty"===t[kt[this.keywordIndex]]||"#00000000"===t[kt[this.keywordIndex]]?e.writeAttributeString("w","val",this.wNamespace,"auto"):e.writeAttributeString("w","val",this.wNamespace,this.getColor(t[kt[this.keywordIndex]])),e.writeEndElement()),_.isNullOrUndefined(t[It[this.keywordIndex]])||(e.writeStartElement(void 0,"sz",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t[It[this.keywordIndex]]).toString()),e.writeEndElement()),_.isNullOrUndefined(t[Vt[this.keywordIndex]])||(e.writeStartElement(void 0,"spacing",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,(20*t[Vt[this.keywordIndex]]).toString()),e.writeEndElement()),_.isNullOrUndefined(t[zt[this.keywordIndex]])||(e.writeStartElement(void 0,"w",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[zt[this.keywordIndex]].toString()),e.writeEndElement()),_.isNullOrUndefined(t[Nt[this.keywordIndex]])||(e.writeStartElement(void 0,"szCs",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t[Nt[this.keywordIndex]]).toString()),e.writeEndElement()),_.isNullOrUndefined(t[Ct[this.keywordIndex]])||t[Ct[this.keywordIndex]]===(1==this.keywordIndex?0:"NoColor")||(e.writeStartElement(void 0,"highlight",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getHighlightColor(t[Ct[this.keywordIndex]])),e.writeEndElement()),!_.isNullOrUndefined(t[Dt[this.keywordIndex]])&&0<t[Dt[this.keywordIndex]].length&&(this.serializeRevisionStart(e,t,void 0),this.serializeRevisionEnd(e,t,void 0)),_.isNullOrUndefined(t[vt[this.keywordIndex]])||(e.writeStartElement(void 0,"u",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getUnderlineStyle(t[vt[this.keywordIndex]])),_.isNullOrUndefined(t[wt[this.keywordIndex]])||e.writeAttributeString("w","color",this.wNamespace,this.getColor(t[wt[this.keywordIndex]])),e.writeEndElement()),!_.isNullOrUndefined(t[bt[this.keywordIndex]])){switch(e.writeStartElement(void 0,"vertAlign",this.wNamespace),t[bt[this.keywordIndex]]){case"Superscript":case 1:e.writeAttributeString("w","val",this.wNamespace,"superscript");break;case"Subscript":case 2:e.writeAttributeString("w","val",this.wNamespace,"subscript");break;default:e.writeAttributeString("w","val",this.wNamespace,"baseline")}e.writeEndElement()}e.writeEndElement()},d.prototype.getColor=function(e){return e=0<e.length&&6<(e="#"===e[0]?e.substr(1):e).length?e.substr(0,6):e},d.prototype.getStyleType=function(e){switch(e){case"Character":case 1:return"character";case"Table":case 2:return"table";default:return"paragraph"}},d.prototype.getUnderlineStyle=function(e){switch(e){case"None":case 0:return"none";case"Single":case 1:return"single";case"Words":case 2:return"words";case"Double":case 3:return"double";case"Dotted":case 4:return"dotted";case"Thick":case 5:return"thick";case 6:return"dash";case"DashLong":case 7:return"dashLong";case"DotDash":case 8:return"dotDash";case"DotDotDash":case 9:return"dotDotDash";case"Wavy":case 10:return"wave";case"DottedHeavy":case 11:return"dottedHeavy";case"DashHeavy":case 12:return"dashedHeavy";case"DashLongHeavy":case 13:return"dashLongHeavy";case"DotDashHeavy":case 14:return"dashDotHeavy";case"DotDotDashHeavy":case 15:return"dashDotDotHeavy";case"WavyHeavy":case 16:return"wavyHeavy";case"WavyDouble":case 17:return"wavyDouble";default:return"dash"}},d.prototype.getHighlightColor=function(e){switch(e){case"BrightGreen":case 2:return"green";case"Turquoise":case 3:return"cyan";case"Pink":case 4:return"magenta";case"Blue":case 5:return"blue";case"Red":case 6:return"red";case"DarkBlue":case 7:return"darkBlue";case"Teal":case 8:return"darkCyan";case"Green":case 9:return"darkGreen";case"Violet":case 10:return"darkMagenta";case"DarkRed":case 11:return"darkRed";case"DarkYellow":case 12:return"darkYellow";case"Gray50":case 13:return"darkGray";case"Gray25":case 14:return"lightGray";case"Black":case 15:return"black";default:return"yellow"}},d.prototype.serializeBoolProperty=function(e,t,i){e.writeStartElement(void 0,t,this.wNamespace),i||e.writeAttributeString(void 0,"val",this.wNamespace,"0"),e.writeEndElement()},d.prototype.serializeNumberings=function(){var e;0!==this.document[Ue[this.keywordIndex]].length&&((e=new x.XmlWriter).writeStartElement("w","numbering",this.wNamespace),this.writeCommonAttributeStrings(e),this.serializeAbstractListStyles(e,this.document[Ve[this.keywordIndex]]),this.serializeListInstances(e,this.document[Ue[this.keywordIndex]]),e.writeEndElement(),e=new f.ZipArchiveItem(e.buffer,this.numberingPath),this.mArchive.addItem(e))},d.prototype.serializeAbstractListStyles=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.writeStartElement(void 0,"abstractNum",this.wNamespace),e.writeAttributeString(void 0,"abstractNumId",this.wNamespace,n[Os[this.keywordIndex]].toString()),e.writeStartElement(void 0,"nsid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,j.numberToHexDecimal(n[Es])),e.writeEndElement();for(var r=0,o=n[Ls[this.keywordIndex]].length;r<o;r++)this.serializeListLevel(e,n[Ls[this.keywordIndex]][r],r);e.writeEndElement()}},d.prototype.serializeListInstances=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.writeStartElement(void 0,"num",this.wNamespace),e.writeAttributeString(void 0,"numId",this.wNamespace,(n[Ut[this.keywordIndex]]+1).toString()),e.writeStartElement(void 0,"abstractNumId",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[Os[this.keywordIndex]].toString()),e.writeEndElement();for(var r=0,o=n[Rs[this.keywordIndex]].length;r<o;r++)this.serializeLevelOverrides(e,n[Rs[this.keywordIndex]][r],n[Rs[this.keywordIndex]][r][Hs[this.keywordIndex]]);e.writeEndElement()}},d.prototype.roundToTwoDecimal=function(e){return Math.round(e)},d.prototype.serializeListLevel=function(e,t,i){e.writeStartElement(void 0,"lvl",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,i.toString()),!_.isNullOrUndefined(t[rs[this.keywordIndex]])&&t[rs[this.keywordIndex]]&&e.writeElementString(void 0,"isLgl",this.wNamespace,void 0),e.writeStartElement(void 0,"start",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Ts[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getLevelPattern(t[Fs[this.keywordIndex]])),e.writeEndElement(),_.isNullOrUndefined(t[Ws[this.keywordIndex]])||""===t[Ws[this.keywordIndex]].toString()||(e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Ws[this.keywordIndex]].toString()),e.writeEndElement()),this.serializeLevelFollow(e,t),this.serializeLevelText(e,t,i+1),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,t[De[this.keywordIndex]],void 0),e.writeEndElement(),this.serializeCharacterFormat(e,t[Ae[this.keywordIndex]]),e.writeEndElement()},d.prototype.serializeLevelOverrides=function(e,t,i){e.writeStartElement(void 0,"lvlOverride",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,i.toString()),_.isNullOrUndefined(t[Bs[this.keywordIndex]])||this.serializeListLevel(e,t[Bs[this.keywordIndex]],i),_.isNullOrUndefined(t[Ts[this.keywordIndex]])||(e.writeStartElement(void 0,"startOverride",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Ts[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement()},d.prototype.getLevelPattern=function(e){var t;switch(e){case"None":case 0:t="none";break;case"Arabic":case 1:t="decimal";break;case"UpRoman":case 2:t="upperRoman";break;case"LowRoman":case 3:t="lowerRoman";break;case"UpLetter":case 4:t="upperLetter";break;case"LowLetter":case 5:t="lowerLetter";break;case"Ordinal":case 6:t="ordinal";break;case"Number":case 7:t="cardinalText";break;case"OrdinalText":case 8:t="ordinalText";break;case"LeadingZero":case 9:t="decimalZero";break;case"FarEast":case 11:t="aiueoFullWidth";break;case"Special":case 12:t="russianLower";break;default:t="bullet"}return t},d.prototype.serializeLevelText=function(e,t,i){e.writeStartElement(void 0,"lvlText",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Ns[this.keywordIndex]]),e.writeEndElement()},d.prototype.serializeLevelFollow=function(e,t){t=t[Ps[this.keywordIndex]]===(1==this.keywordIndex?0:"Tab")?"tab":t[Ps[this.keywordIndex]]===(1==this.keywordIndex?1:"Space")?"space":"nothing";e.writeStartElement(void 0,"suff",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t),e.writeEndElement()},d.prototype.serializeThemeFontLang=function(e){var t=0<this.themeFontLang[mt[this.keywordIndex]],i=0<this.themeFontLang[ut[this.keywordIndex]],n=0<this.themeFontLang[gt[this.keywordIndex]];(i||n||t)&&(e.writeStartElement("w","themeFontLang",void 0),i&&(i=V.LocaleId[this.themeFontLang[ut[this.keywordIndex]]],e.writeAttributeString("w","val",void 0,i.replace("_","-"))),t&&(i=V.LocaleId[this.themeFontLang[mt[this.keywordIndex]]],e.writeAttributeString("w","bidi",void 0,i.replace("_","-"))),n&&(t=V.LocaleId[this.themeFontLang[gt[this.keywordIndex]]],e.writeAttributeString("w","eastAsia",void 0,t.replace("_","-"))),e.writeEndElement())},d.prototype.serializeDocumentProtectionSettings=function(e){if(e.writeStartElement("w","documentProtection",this.wNamespace),this.formatting&&e.writeAttributeString("w","formatting",this.wNamespace,"1"),this.protectionType&&0!==this.protectionType){var t=void 0;switch(this.protectionType){case"ReadOnly":case 1:t="readOnly";break;case"FormFieldsOnly":case 2:t="forms";break;case"CommentsOnly":case 3:t="comments";break;case"RevisionsOnly":case 4:t="trackedChanges"}e.writeAttributeString("w","edit",this.wNamespace,t)}e.writeAttributeString("w","cryptProviderType",this.wNamespace,"rsaAES"),e.writeAttributeString("w","cryptAlgorithmClass",this.wNamespace,"hash"),e.writeAttributeString("w","cryptAlgorithmType",this.wNamespace,"typeAny"),e.writeAttributeString("w","cryptAlgorithmSid",this.wNamespace,"14"),e.writeAttributeString("w","cryptSpinCount",this.wNamespace,"100000"),this.enforcement&&e.writeAttributeString("w","enforcement",this.wNamespace,"1"),this.hashValue&&e.writeAttributeString("w","hash",this.wNamespace,this.hashValue),this.saltValue&&e.writeAttributeString("w","salt",this.wNamespace,this.saltValue),e.writeEndElement()},d.prototype.serializeSettings=function(){var e=new x.XmlWriter,t=(e.writeStartElement("w","settings",this.wNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","sl",void 0,this.slNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDocumentProtectionSettings(e),e.writeStartElement("w","zoom",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"none"),e.writeAttributeString("w","percent",this.wNamespace,"100"),e.writeEndElement(),this.serializeThemeFontLang(e),e.writeStartElement(void 0,"displayBackgroundShape",this.wNamespace),e.writeEndElement(),e.writeStartElement(void 0,"defaultTabStop",this.wNamespace),Math.round(this.defaultTabWidthValue*this.twipsInOnePoint)),t=(e.writeAttributeString(void 0,"val",this.wNamespace,t.toString()),e.writeEndElement(),this.trackChanges&&(e.writeStartElement(void 0,"trackRevisions",this.wNamespace),e.writeEndElement()),this.mDifferentFirstPage&&(e.writeStartElement(void 0,"evenAndOddHeaders",this.wNamespace),e.writeEndElement()),this.formFieldShading||(e.writeStartElement(void 0,"doNotShadeFormData",this.wNamespace),e.writeEndElement()),e.writeStartElement(void 0,"compat",this.wNamespace),this.dontUseHtmlParagraphAutoSpacing&&this.serializeBoolProperty(e,"doNotUseHTMLParagraphAutoSpacing",this.dontUseHtmlParagraphAutoSpacing),this.allowSpaceOfSameStyleInTable&&this.serializeBoolProperty(e,"allowSpaceOfSameStyleInTable",this.allowSpaceOfSameStyleInTable),e.writeStartElement(void 0,"compatSetting",this.wNamespace),e.writeAttributeString(void 0,"name",this.wNamespace,"compatibilityMode"),e.writeAttributeString(void 0,"uri",this.wNamespace,"http://schemas.microsoft.com/office/word"),1===this.keywordIndex?j.getCompatibilityModeValue(this.compatibilityMode):j.getCompatibilityModeValue(this.getCompatibilityModeEnumValue(this.compatibilityMode.toString()))),t=(e.writeAttributeString(void 0,"val",this.wNamespace,t),e.writeEndElement(),e.writeEndElement(),this.document[rt[this.keywordIndex]]&&(e.writeStartElement(void 0,"footnotePr",this.wNamespace),e.writeStartElement(void 0,"footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),e.writeEndElement(),e.writeStartElement(void 0,"footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),e.writeEndElement(),e.writeEndElement()),this.document[ot[this.keywordIndex]]&&(e.writeStartElement(void 0,"endnotePr",this.wNamespace),e.writeStartElement(void 0,"endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),e.writeEndElement(),e.writeStartElement(void 0,"endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),e.writeEndElement(),e.writeEndElement()),e.writeEndElement(),new f.ZipArchiveItem(e.buffer,this.settingsPath));this.mArchive.addItem(t)},d.prototype.serializeCoreProperties=function(){},d.prototype.serializeAppProperties=function(){},d.prototype.serializeFontTable=function(e){},d.prototype.serializeSettingsRelation=function(){},d.prototype.getCompatibilityModeEnumValue=function(e){switch(e){case"Word2013":return 0;case"Word2003":return 1;case"Word2007":return 2;case"Word2010":return 3}},d.prototype.serializeHeaderFooters=function(){this.isHeaderFooter=!0,this.serializeHeaderFooter("EvenFooter"),this.serializeHeaderFooter("EvenHeader"),this.serializeHeaderFooter("FirstPageFooter"),this.serializeHeaderFooter("FirstPageHeader"),this.serializeHeaderFooter("OddFooter"),this.serializeHeaderFooter("OddHeader"),this.isHeaderFooter=!1},d.prototype.serializeHeaderFooter=function(e){var t,i;if(0!==this.headersFooters.length&&this.headersFooters.containsKey(e))for(var n=this.headersFooters.get(e),r=0;r<n.keys.length;r++){var o=n.keys[r],s=n.get(o);"EvenHeader"===e||"FirstPageHeader"===e||"OddHeader"===e?(t=this.headerPath+o.replace("rId","")+".xml",i=this.headerRelationPath+o.replace("rId","")+".xml.rels",this.serializeHeader(s,o,t,i)):(t=this.footerPath+o.replace("rId","")+".xml",i=this.footerRelationPath+o.replace("rId","")+".xml.rels",this.serializeFooter(s,o,t,i))}},d.prototype.serializeHeader=function(e,t,i,n){this.headerFooter=e;var r=new x.XmlWriter,o=(r.writeStartElement("w","hdr",this.wNamespace),this.writeHFCommonAttributes(r),this.blockOwner),e=(this.blockOwner=e,this.serializeBodyItems(r,e[S[this.keywordIndex]],!0),this.blockOwner=o,r.writeEndElement(),new f.ZipArchiveItem(r.buffer,i));this.mArchive.addItem(e),this.serializeHFRelations(t,n),this.headerFooter=void 0},d.prototype.serializeHFRelations=function(e,t){var i;this.headerFooterImages.containsKey(e)&&((i=new x.XmlWriter).writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeImagesRelations(this.headerFooterImages.get(e),i,!1),this.headerFooterSvgImages.containsKey(e)&&this.serializeSvgImageRelation(this.headerFooterSvgImages.get(e),i),i.writeEndElement(),e=new f.ZipArchiveItem(i.buffer,t),this.mArchive.addItem(e))},d.prototype.writeHFCommonAttributes=function(e){e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","ve",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString("xmlns","pic",void 0,this.pictureNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("ve","Ignorable",void 0,"w14 w15 wp14")},d.prototype.serializeFooter=function(e,t,i,n){this.headerFooter=e;var r=new x.XmlWriter,e=(r.writeStartElement("w","ftr",this.wNamespace),this.writeHFCommonAttributes(r),this.serializeBodyItems(r,e[S[this.keywordIndex]],!0),r.writeEndElement(),new f.ZipArchiveItem(r.buffer,i));this.mArchive.addItem(e),this.serializeHFRelations(t,n)},d.prototype.serializeDocumentRelations=function(){var e=new x.XmlWriter,e=(e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.settingsRelType,"settings.xml"),this.document[ot[this.keywordIndex]]&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.endnoteRelType,"endnotes.xml"),this.document[rt[this.keywordIndex]]&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.footnoteRelType,"footnotes.xml"),0<this.mComments.length&&(1===this.mComments.length&&""===this.mComments[0].text||(this.serializeRelationShip(e,this.getNextRelationShipID(),this.commentsRelType,"comments.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.commentsExRelType,"commentsExtended.xml"))),_.isNullOrUndefined(this.mThemes)||this.serializeRelationShip(e,this.getNextRelationShipID(),this.ThemeRelType,"theme/theme1.xml"),0<this.document[Ue[this.keywordIndex]].length&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.numberingRelType,"numbering.xml"),this.serializeHeaderFooterRelations(e),this.serializeImagesRelations(this.documentImages,e,!1),this.serializeSvgImageRelation(this.svgImages,e),this.serializeCustomXMLMapping(this.mCustomXML,e),this.serializeChartDocumentRelations(this.documentCharts,e),this.serializeExternalLinkImages(e),e.writeEndElement(),new f.ZipArchiveItem(e.buffer,this.wordRelationPath));this.mArchive.addItem(e),this.headerFooter=void 0},d.prototype.serializeChartDocumentRelations=function(e,t){if(0<e.length)for(var i=e.keys,n=1;n<=i.length;n++)this.serializeRelationShip(t,i[n-1],this.chartRelType,"charts/chart"+n+".xml")},d.prototype.serializeChartRelations=function(){var e=new x.XmlWriter,t=(this.resetChartRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),"colors"+this.chartCount+".xml"),i=this.chartPath+"/_rels/chart"+this.chartCount+".xml.rels",n="../embeddings/Microsoft_Excel_Worksheet"+this.chartCount+".xlsx",n=(this.serializeRelationShip(e,this.getNextChartRelationShipID(),this.packageRelType,n),this.serializeRelationShip(e,this.getNextChartRelationShipID(),this.chartColorStyleRelType,t),e.writeEndElement(),new f.ZipArchiveItem(e.buffer,i));this.mArchive.addItem(n)},d.prototype.serializeImagesRelations=function(e,t,i){if(0<e.length)for(var n="",r=void 0,o=e.keys,s=0;s<o.length;s++){var a,l,d=e.get(o[s]);"string"==typeof d&&this.startsWith(d,"data")?r=d:(r=(a=this.getBase64ImageString(d)).imageString,j.parseBoolValue(d[Ar[this.keywordIndex]])&&(".svg"!==j.formatClippedString(a.metaFileImageString).extension||i)&&(r=a.metaFileImageString)),_.isNullOrUndefined(r)?(n=this.imagePath+"/0.jpeg",this.serializeRelationShip(t,o[s],this.imageRelType,n.replace("word/",""))):(a=(d=j.formatClippedString(r)).extension,d=d.formatClippedString,n=this.imagePath+o[s]+a,l=void this.serializeRelationShip(t,o[s],this.imageRelType,n.replace("word/","")),l=this.startsWith(r,"data:image/svg+xml;utf8,")?new Blob([d]):new Blob([this.encodedString(d)]),d=new f.ZipArchiveItem(l,n),this.mArchive.addItem(d))}},d.prototype.serializeSvgImageRelation=function(e,t){this.serializeImagesRelations(e,t,!0)},d.prototype.encodedString=function(e){var t,i,n,r,o,s,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,d=0,h=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&h--,e.charAt(e.length-2)===a.charAt(64)&&h--,h%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var c=new Uint8Array(0|h);l<e.length;)n=a.indexOf(e.charAt(l++)),t=(15&(r=a.indexOf(e.charAt(l++))))<<4|(o=a.indexOf(e.charAt(l++)))>>2,i=(3&o)<<6|(s=a.indexOf(e.charAt(l++))),c[d++]=n<<2|r>>4,64!==o&&(c[d++]=t),64!==s&&(c[d++]=i);return c},d.prototype.serializeExternalLinkImages=function(e){for(var t=this.externalImages.keys,i=0;i<this.externalImages.keys.length;i++)this.serializeRelationShip(e,t[i],this.imageRelType,this.externalImages.get(t[i]))},d.prototype.serializeHeaderFooterRelations=function(e){this.serializeHFRelation(e,"EvenFooter"),this.serializeHFRelation(e,"EvenHeader"),this.serializeHFRelation(e,"FirstPageFooter"),this.serializeHFRelation(e,"FirstPageHeader"),this.serializeHFRelation(e,"OddFooter"),this.serializeHFRelation(e,"OddHeader")},d.prototype.serializeHFRelation=function(e,t){var i="";if(this.headersFooters.containsKey(t))for(var n=this.headersFooters.get(t),r=0;r<n.keys.length;r++){var o=n.keys[r],s="EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(i="header"+o.replace("rId","")+".xml",this.headerRelType):(i="footer"+o.replace("rId","")+".xml",this.footerRelType);this.serializeRelationShip(e,o,s,i)}},d.prototype.serializeRelationShip=function(e,t,i,n){e.writeStartElement(void 0,"Relationship",void 0),e.writeAttributeString(void 0,"Id",void 0,t),e.writeAttributeString(void 0,"Type",void 0,i),e.writeAttributeString(void 0,"Target",void 0,n.replace("\\","/").replace("\v","")),(i===this.hyperlinkRelType||this.startsWith(n,"http://")||this.startsWith(n,"https://")||this.startsWith(n,"file:///"))&&e.writeAttributeString(void 0,"TargetMode",void 0,"External"),e.writeEndElement()},d.prototype.getNextRelationShipID=function(){return"rId"+ ++this.mRelationShipID},d.prototype.getEFNextRelationShipID=function(){return(++this.efRelationShipId).toString()},d.prototype.serializeGeneralRelations=function(){var e=new x.XmlWriter,e=(this.resetRelationShipID(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.documentRelType,this.documentPath),e.writeEndElement(),new f.ZipArchiveItem(e.buffer,this.generalRelationPath));this.mArchive.addItem(e)},d.prototype.serializeContentTypes=function(e,t){var i=new x.XmlWriter;if(i.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(i,"rels",this.relationContentType),this.serializeDefaultContentType(i,"xml",this.xmlContentType),(0<this.documentImages.length||0<this.externalImages.length||0<this.headerFooterImages.length)&&(this.serializeDefaultContentType(i,"png","image/png"),this.serializeDefaultContentType(i,"bmp","image/bmp"),this.serializeDefaultContentType(i,"emf","image/x-emf"),this.serializeDefaultContentType(i,"wmf","image/x-wmf"),this.serializeDefaultContentType(i,"gif","image/gif"),this.serializeDefaultContentType(i,"ico","image/x-icon"),this.serializeDefaultContentType(i,"tif","image/tiff"),this.serializeDefaultContentType(i,"tiff","image/tiff"),this.serializeDefaultContentType(i,"jpeg","image/jpeg"),this.serializeDefaultContentType(i,"jpg","image/jpeg"),this.serializeDefaultContentType(i,"svg","image/svg+xml")),"Docx"==t?this.serializeOverrideContentType(i,this.documentPath,this.documentContentType):"Dotx"==t&&this.serializeOverrideContentType(i,this.documentPath,this.TemplateContentType),this.serializeOverrideContentType(i,this.numberingPath,this.numberingContentType),this.serializeOverrideContentType(i,this.stylePath,this.stylesContentType),this.serializeOverrideContentType(i,this.settingsPath,this.settingsContentType),this.serializeOverrideContentType(i,this.commentsPath,this.commentsContentType),this.serializeOverrideContentType(i,this.themePath,this.themeContentType),this.serializeOverrideContentType(i,this.commentsExtendedPath,this.commentsExContentType),0<this.chartCount){var n=1;for(this.serializeDefaultContentType(i,"xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");n<=this.chartCount;)this.serializeOverrideContentType(i,"word/charts/chart"+n+".xml",this.chartsContentType),this.serializeOverrideContentType(i,"word/charts/colors"+n+".xml",this.chartColorStyleContentType),n++}if(0<this.customXMLProps.length)for(var r=0;r<this.customXMLProps.length;r++)this.serializeOverrideContentType(i,this.customXMLProps[r],this.customXmlContentType);this.serializeHFContentTypes(i),this.SerializeEFContentTypes(i),i.writeEndElement();t=new f.ZipArchiveItem(i.buffer,this.contentTypesPath);this.mArchive.addItem(t)},d.prototype.serializeHFContentTypes=function(e){this.serializeHeaderFootersContentType(e,"EvenFooter"),this.serializeHeaderFootersContentType(e,"EvenHeader"),this.serializeHeaderFootersContentType(e,"FirstPageFooter"),this.serializeHeaderFootersContentType(e,"FirstPageHeader"),this.serializeHeaderFootersContentType(e,"OddFooter"),this.serializeHeaderFootersContentType(e,"OddHeader")},d.prototype.serializeHeaderFootersContentType=function(e,t){var i;if(this.headersFooters.containsKey(t))for(var n=this.headersFooters.get(t),r=0;r<n.keys.length;r++){var o=n.keys[r],o="EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(i=this.headerPath+o.replace("rId","")+".xml",this.headerContentType):(i=this.footerPath+o.replace("rId","")+".xml",this.footerContentType);this.serializeOverrideContentType(e,i,o)}},d.prototype.SerializeEFContentTypes=function(e){this.serializeEFContentType(e)},d.prototype.serializeEFContentType=function(e){var t=this.endnotesPath,i=this.endnoteContentType;this.serializeOverrideContentType(e,t,i),t=this.footnotesPath,i=this.footnoteContentType,this.serializeOverrideContentType(e,t,i)},d.prototype.serializeOverrideContentType=function(e,t,i){e.writeStartElement(void 0,"Override",void 0),e.writeAttributeString(void 0,"PartName",void 0,"/"+t.replace("\\","/")),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},d.prototype.serializeDefaultContentType=function(e,t,i){e.writeStartElement(void 0,"Default",void 0),e.writeAttributeString(void 0,"Extension",void 0,t),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},d.prototype.resetRelationShipID=function(){this.mRelationShipID=0},d.prototype.resetExcelRelationShipId=function(){this.eRelationShipId=0},d.prototype.resetChartRelationShipId=function(){this.cRelationShipId=0},d.prototype.close=function(){},d.prototype.getExportAutoShapeType=function(e){switch(e){case 1:return"rect";case 2:return"roundRect";case 3:return"straightConnector1";case 4:return"ellipse";case 5:return"triangle";case 6:return"rtTriangle";case 7:return"parallelogram";case 8:return"trapezoid";case 9:return"diamond";case 10:return"pentagon";case 11:return"hexagon";case 12:return"heptagon";case 13:return"octagon";case 14:return"decagon";case 15:return"dodecagon";case 16:return"chord";case 17:return"teardrop";case 18:return"frame";case 19:return"halfFrame";case 20:return"corner";case 21:return"pie";case 22:return"diagStripe";case 23:return"plus";case 24:return"plaque";case 25:return"can";case 26:return"cube";case 27:return"bevel";case 28:return"donut";case 29:return"noSmoking";case 30:return"blockArc";case 31:return"foldedCorner";case 32:return"smileyFace";case 33:return"heart";case 34:return"lightningBolt";case 35:return"sun";case 36:return"moon";case 37:return"cloud";case 38:return"arc";case 39:return"bracketPair";case 40:return"bracePair";case 41:return"leftBracket";case 42:return"rightBracket";case 43:return"leftBrace";case 44:return"rightBrace";case 45:return"flowChartProcess";case 46:return"flowChartAlternateProcess";case 47:return"flowChartDecision";case 48:return"flowChartInputOutput";case 49:return"flowChartPredefinedProcess";case 50:return"flowChartInternalStorage";case 51:return"flowChartDocument";case 52:return"flowChartMultidocument";case 53:return"flowChartTerminator";case 54:return"flowChartPreparation";case 55:return"flowChartManualInput";case 56:return"flowChartManualOperation";case 57:return"flowChartConnector";case 58:return"flowChartOffpageConnector";case 59:return"flowChartPunchedCard";case 60:return"flowChartPunchedTape";case 61:return"flowChartSummingJunction";case 62:return"flowChartOr";case 63:return"flowChartCollate";case 64:return"flowChartSort";case 65:return"flowChartExtract";case 66:return"flowChartMerge";case 67:return"flowChartOnlineStorage";case 68:return"flowChartDelay";case 69:return"flowChartMagneticTape";case 70:return"flowChartMagneticDisk";case 71:return"flowChartMagneticDrum";case 72:return"flowChartDisplay";case 73:return"rightArrow";case 74:return"leftArrow";case 75:return"upArrow";case 76:return"downArrow";case 77:return"leftRightArrow";case 78:return"upDownArrow";case 79:return"quadArrow";case 80:return"leftRightUpArrow";case 81:return"bentArrow";case 82:return"uturnArrow";case 83:return"leftUpArrow";case 84:return"bentUpArrow";case 85:return"curvedRightArrow";case 86:return"curvedLeftArrow";case 87:return"curvedUpArrow";case 88:return"curvedDownArrow";case 89:return"stripedRightArrow";case 90:return"notchedRightArrow";case 91:return"homePlate";case 92:return"chevron";case 93:return"rightArrowCallout";case 94:return"downArrowCallout";case 95:return"leftArrowCallout";case 96:return"upArrowCallout";case 97:return"leftRightArrowCallout";case 98:return"quadArrowCallout";case 99:return"circularArrow";case 100:return"mathPlus";case 101:return"mathMinus";case 102:return"mathMultiply";case 103:return"mathDivide";case 104:return"mathEqual";case 105:return"mathNotEqual";case 106:return"irregularSeal1";case 107:return"irregularSeal2";case 108:return"star4";case 109:return"star5";case 110:return"star6";case 111:return"star7";case 112:return"star8";case 113:return"star10";case 114:return"star12";case 115:return"star16";case 116:return"star24";case 117:return"star32";case 118:return"ribbon2";case 119:return"ribbon";case 120:return"ellipseRibbon2";case 121:return"ellipseRibbon";case 122:return"verticalScroll";case 123:return"horizontalScroll";case 124:return"wave";case 125:return"doubleWave";case 126:return"snip1Rect";case 127:return"snip2SameRect";case 128:return"snip2DiagRect";case 129:return"snipRoundRect";case 130:return"round1Rect";case 131:return"round2SameRect";case 132:return"round2DiagRect";case 133:return"textNoShape";case 134:return"bentConnector3";case 135:return"curvedConnector3";default:return e}},d.prototype.getAutoShapeTypeEnumValue=function(e){switch(e){case"Rectangle":return 1;case"RoundedRectangle":return 2;case"StraightConnector":return 3;case"Oval":return 4;case"IsoscelesTriangle":return 5;case"RightTriangle":return 6;case"Parallelogram":return 7;case"Trapezoid":return 8;case"Diamond":return 9;case"RegularPentagon":return 10;case"Hexagon":return 11;case"Heptagon":return 12;case"Octagon":return 13;case"Decagon":return 14;case"Dodecagon":return 15;case"Chord":return 16;case"Teardrop":return 17;case"Frame":return 18;case"HalfFrame":return 19;case"L_Shape":return 20;case"Pie":return 21;case"DiagonalStripe":return 22;case"Cross":return 23;case"Plaque":return 24;case"Can":return 25;case"Cube":return 26;case"Bevel":return 27;case"Donut":return 28;case"NoSymbol":return 29;case"BlockArc":return 30;case"FoldedCorner":return 31;case"SmileyFace":return 32;case"Heart":return 33;case"LightningBolt":return 34;case"Sun":return 35;case"Moon":return 36;case"Cloud":return 37;case"Arc":return 38;case"DoubleBracket":return 39;case"DoubleBrace":return 40;case"LeftBracket":return 41;case"RightBracket":return 42;case"LeftBrace":return 43;case"RightBrace":return 44;case"FlowChartProcess":return 45;case"FlowChartAlternateProcess":return 46;case"FlowChartDecision":return 47;case"FlowChartData":return 48;case"FlowChartPredefinedProcess":return 49;case"FlowChartInternalStorage":return 50;case"FlowChartDocument":return 51;case"FlowChartMultiDocument":return 52;case"FlowChartTerminator":return 53;case"FlowChartPreparation":return 54;case"FlowChartManualInput":return 55;case"FlowChartManualOperation":return 56;case"FlowChartConnector":return 57;case"FlowChartOffPageConnector":return 58;case"FlowChartCard":return 59;case"FlowChartPunchedTape":return 60;case"FlowChartSummingJunction":return 61;case"FlowChartOr":return 62;case"FlowChartCollate":return 63;case"FlowChartSort":return 64;case"FlowChartExtract":return 65;case"FlowChartMerge":return 66;case"FlowChartStoredData":return 67;case"FlowChartDelay":return 68;case"FlowChartSequentialAccessStorage":return 69;case"FlowChartMagneticDisk":return 70;case"FlowChartDirectAccessStorage":return 71;case"FlowChartDisplay":return 72;case"RightArrow":return 73;case"LeftArrow":return 74;case"UpArrow":return 75;case"DownArrow":return 76;case"LeftRightArrow":return 77;case"UpDownArrow":return 78;case"QuadArrow":return 79;case"LeftRightUpArrow":return 80;case"BentArrow":return 81;case"UTurnArrow":return 82;case"LeftUpArrow":return 83;case"BentUpArrow":return 84;case"CurvedRightArrow":return 85;case"CurvedLeftArrow":return 86;case"CurvedUpArrow":return 87;case"CurvedDownArrow":return 88;case"StripedRightArrow":return 89;case"NotchedRightArrow":return 90;case"Pentagon":return 91;case"Chevron":return 92;case"RightArrowCallout":return 93;case"DownArrowCallout":return 94;case"LeftArrowCallout":return 95;case"UpArrowCallout":return 96;case"LeftRightArrowCallout":return 97;case"QuadArrowCallout":return 98;case"CircularArrow":return 99;case"MathPlus":return 100;case"MathMinus":return 101;case"MathMultiply":return 102;case"MathDivision":return 103;case"MathEqual":return 104;case"MathNotEqual":return 105;case"Explosion1":return 106;case"Explosion2":return 107;case"Star4Point":return 108;case"Star5Point":return 109;case"Star6Point":return 110;case"Star7Point":return 111;case"Star8Point":return 112;case"Star10Point":return 113;case"Star12Point":return 114;case"Star16Point":return 115;case"Star24Point":return 116;case"Star32Point":return 117;case"UpRibbon":return 118;case"DownRibbon":return 119;case"CurvedUpRibbon":return 120;case"CurvedDownRibbon":return 121;case"VerticalScroll":return 122;case"HorizontalScroll":return 123;case"Wave":return 124;case"DoubleWave":return 125;case"SnipSingleCornerRectangle":return 126;case"SnipSameSideCornerRectangle":return 127;case"SnipDiagonalCornerRectangle":return 128;case"SnipAndRoundSingleCornerRectangle":return 129;case"RoundSingleCornerRectangle":return 130;case"RoundSameSideCornerRectangle":return 131;case"RoundDiagonalCornerRectangle":return 132;case"Unknown":return 133;case"ElbowConnector":return 134;case"CurvedConnector":return 135;default:return 0}};var Qm=d;function d(){this.customXMLItemsPath="customXml/item",this.customXMLItemsPropspath="customXml/itemProps",this.itemPropsPath="itemProps",this.documentPath="word/document.xml",this.stylePath="word/styles.xml",this.chartPath="word/charts",this.numberingPath="word/numbering.xml",this.settingsPath="word/settings.xml",this.headerPath="word/header",this.footerPath="word/footer",this.imagePath="word/media/image",this.footnotesPath="word/footnotes.xml",this.endnotesPath="word/endnotes.xml",this.appPath="docProps/app.xml",this.corePath="docProps/core.xml",this.contentTypesPath="[Content_Types].xml",this.defaultEmbeddingPath="word/embeddings/",this.commentsPath="word/comments.xml",this.commentsExtendedPath="word/commentsExtended.xml",this.themePath="word/theme/theme1.xml",this.generalRelationPath="_rels/.rels",this.wordRelationPath="word/_rels/document.xml.rels",this.customXMLRelPath="customXml/_rels/item",this.excelRelationPath="xl/_rels/workbook.xml.rels",this.footnotesRelationPath="word/_rels/footnotes.xml.rels",this.endnotesRelationPath="word/_rels/endnotes.xml.rels",this.headerRelationPath="word/_rels/header",this.footerRelationPath="word/_rels/footer",this.xmlContentType="application/xml",this.fontContentType="application/vnd.openxmlformats-officedocument.obfuscatedFont",this.documentContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml",this.TemplateContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml",this.settingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",this.commentsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml",this.commentsExContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.commentsExtended+xml",this.endnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml",this.footerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",this.footnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml",this.headerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",this.numberingContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml",this.stylesContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml",this.webSettingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml",this.appContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml",this.coreContentType="application/vnd.openxmlformats-package.core-properties+xml",this.customContentType="application/vnd.openxmlformats-officedocument.custom-properties+xml",this.customXmlContentType="application/vnd.openxmlformats-officedocument.customXmlProperties+xml",this.relationContentType="application/vnd.openxmlformats-package.relationships+xml",this.chartsContentType="application/vnd.openxmlformats-officedocument.drawingml.chart+xml",this.themeContentType="application/vnd.openxmlformats-officedocument.theme+xml",this.tableStyleContentType="application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml",this.chartColorStyleContentType="application/vnd.ms-office.chartcolorstyle+xml",this.commentsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",this.commentsExRelType="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",this.settingsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",this.endnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",this.footerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",this.footnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",this.headerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",this.documentRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",this.numberingRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",this.stylesRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",this.chartRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",this.ThemeRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",this.fontRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",this.tableStyleRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles",this.coreRelType="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",this.appRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",this.customRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",this.imageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",this.hyperlinkRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",this.controlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/control",this.packageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/package",this.customXmlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",this.customUIRelType="http://schemas.microsoft.com/office/2006/relationships/ui/extensibility",this.attachedTemplateRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate",this.chartColorStyleRelType="http://schemas.microsoft.com/office/2011/relationships/chartColorStyle",this.wNamespace="http://schemas.openxmlformats.org/wordprocessingml/2006/main",this.wpNamespace="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",this.pictureNamespace="http://schemas.openxmlformats.org/drawingml/2006/picture",this.aNamespace="http://schemas.openxmlformats.org/drawingml/2006/main",this.a14Namespace="http://schemas.microsoft.com/office/drawing/2010/main",this.svgNamespace="http://schemas.microsoft.com/office/drawing/2016/SVG/main",this.rNamespace="http://schemas.openxmlformats.org/officeDocument/2006/relationships",this.rpNamespace="http://schemas.openxmlformats.org/package/2006/relationships",this.vNamespace="urn:schemas-microsoft-com:vml",this.oNamespace="urn:schemas-microsoft-com:office:office",this.xmlNamespace="http://www.w3.org/XML/1998/namespace",this.w10Namespace="urn:schemas-microsoft-com:office:word",this.cpNamespace="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",this.dcNamespace="http://purl.org/dc/elements/1.1/",this.docPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",this.veNamespace="http://schemas.openxmlformats.org/markup-compatibility/2006",this.mNamespace="http://schemas.openxmlformats.org/officeDocument/2006/math",this.wneNamespace="http://schemas.microsoft.com/office/word/2006/wordml",this.customPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",this.vtNamespace="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",this.chartNamespace="http://schemas.openxmlformats.org/drawingml/2006/chart",this.slNamespace="http://schemas.openxmlformats.org/schemaLibrary/2006/main",this.dtNamespace="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",this.wmlNamespace="http://schemas.microsoft.com/office/word/2003/wordml",this.w14Namespace="http://schemas.microsoft.com/office/word/2010/wordml",this.wpCanvasNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",this.wpDrawingNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",this.wpGroupNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",this.wpInkNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingInk",this.wpShapeNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingShape",this.w15Namespace="http://schemas.microsoft.com/office/word/2012/wordml",this.diagramNamespace="http://schemas.openxmlformats.org/drawingml/2006/diagram",this.eNamespace="http://schemas.microsoft.com/office/2006/encryption",this.pNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/password",this.certNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/certificate",this.cxNamespace="http://schemas.microsoft.com/office/drawing/2014/chartex",this.c15Namespace="http://schemas.microsoft.com/office/drawing/2015/06/chart",this.c7Namespace="http://schemas.microsoft.com/office/drawing/2007/8/2/chart",this.csNamespace="http://schemas.microsoft.com/office/drawing/2012/chartStyle",this.spreadSheetNamespace="http://schemas.openxmlformats.org/spreadsheetml/2006/main",this.spreadSheet9="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",this.cRelationshipsTag="Relationships",this.cRelationshipTag="Relationship",this.cIdTag="Id",this.cTypeTag="Type",this.cTargetTag="Target",this.cUserShapesTag="userShapes",this.cExternalData="externalData",this.twipsInOnePoint=20,this.twentiethOfPoint=20,this.borderMultiplier=8,this.percentageFactor=50,this.emusPerPoint=12700,this.cConditionalTableStyleTag="tblStylePr",this.cTableFormatTag="tblPr",this.cTowFormatTag="trPr",this.cCellFormatTag="tcPr",this.cParagraphFormatTag="pPr",this.cCharacterFormatTag="rPr",this.packageType="http://schemas.microsoft.com/office/2006/xmlPackage",this.relsPartPath="/_rels/.rels",this.documentRelsPartPath="/word/_rels/document.xml.rels",this.webSettingsPath="/word/webSettings.xml",this.wordMLDocumentPath="/word/document.xml",this.wordMLStylePath="/word/styles.xml",this.wordMLNumberingPath="/word/numbering.xml",this.wordMLSettingsPath="/word/settings.xml",this.wordMLHeaderPath="/word/header",this.wordMLFooterPath="/word/footer",this.wordMLCommentsPath="/word/comments.xml",this.wordMLImagePath="/word/media/image",this.wordMLFootnotesPath="/word/footnotes.xml",this.wordMLEndnotesPath="/word/endnotes.xml",this.wordMLAppPath="/docProps/app.xml",this.wordMLCorePath="/docProps/core.xml",this.wordMLCustomPath="/docProps/custom.xml",this.wordMLFontTablePath="/word/fontTable.xml",this.wordMLChartsPath="/word/charts/",this.wordMLDefaultEmbeddingPath="/word/embeddings/",this.wordMLEmbeddingPath="/word/embeddings/",this.wordMLDrawingPath="/word/drawings/",this.wordMLThemePath="/word/theme/theme1.xml",this.wordMLFontsPath="/word/fonts/",this.wordMLDiagramPath="/word/diagrams/",this.wordMLControlPath="/word/activeX/",this.wordMLVbaProject="/vbaProject.bin",this.wordMLVbaData="/vbaData.xml",this.wordMLVbaProjectPath="/word/vbaProject.bin",this.wordMLVbaDataPath="/word/vbaData.xml",this.wordMLWebSettingsPath="/word/webSettings.xml",this.wordMLCustomItemProp1Path="/customXml/itemProps1.xml",this.wordMLFootnoteRelPath="/word/_rels/footnotes.xml.rels",this.wordMLEndnoteRelPath="/word/_rels/endnotes.xml.rels",this.wordMLSettingsRelPath="/word/_rels/settings.xml.rels",this.wordMLNumberingRelPath="/word/_rels/numbering.xml.rels",this.wordMLFontTableRelPath="/word/_rels/fontTable.xml.rels",this.wordMLCustomXmlPropsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",this.wordMLControlRelType="http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary",this.wordMLDiagramContentType="application/vnd.ms-office.drawingml.diagramDrawing+xml",this.dsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/customXml",this.excelFiles=void 0,this.lastSection=!1,this.mRelationShipID=0,this.cRelationShipId=0,this.eRelationShipId=0,this.efRelationShipId=0,this.mDocPrID=1,this.chartCount=0,this.seriesCount=0,this.chartStringCount=0,this.mDifferentFirstPage=!1,this.mBookmarks=void 0,this.mComments=[],this.revisions=[],this.customXMLProps=[],this.paraID=0,this.commentParaID=0,this.commentParaIDInfo={},this.isInsideComment=!1,this.commentId={},this.currentCommentId=0,this.trackChangesId=0,this.prevRevisionIds=[],this.isRevisionContinuous=!1,this.isBookmarkAtEnd=!1,this.isBookmarkAtRowEnd=!1,this.keywordIndex=void 0,this.isHeaderFooter=!1,this.isSerializeFootEndNote=void 0,this.containerWidth=0}ef.prototype.getModuleName=function(){return"TextExport"},ef.prototype.save=function(e,t){this.serialize(e);e=new x.StreamWriter;this.writeInternal(e),e.save(t+".txt")},ef.prototype.saveAsBlob=function(e){this.serialize(e);var e=new x.StreamWriter,i=(this.writeInternal(e),e.buffer);return e.destroy(),new Promise(function(e,t){e(i)})},ef.prototype.serialize=function(e){e=e.owner.sfdtExportModule.write(0);this.setDocument(e)},ef.prototype.setDocument=function(e){this.document=e,this.mSections=e.sections},ef.prototype.writeInternal=function(e){var t,i=void 0,n=this.document.sections.length-1;this.updateLastParagraph();for(var r=0;r<=n;r++)i=this.document.sections[r],t=r===n,this.writeBody(e,i.blocks,!1),this.writeNewLine(e),this.writeSectionEnd(i,t);for(var o=0;o<=n;o++)i=this.document.sections[o],this.writeHeadersFooters(e,i)},ef.prototype.writeBody=function(e,t,i){for(var n,r=t.length-1,o=void 0,s=0;s<=r;s++)(o=t[s]).hasOwnProperty("inlines")?(n=o===this.lastPara,this.writeParagraph(e,o,n,i)):o.blocks?this.writeBody(e,o.blocks,i):this.writeTable(e,o)},ef.prototype.writeParagraph=function(e,t,i,n){for(var r=0;r<t.inlines.length;r++){var o=t.inlines[r];o.hasOwnProperty("fieldType")?this.inField=0===o.fieldType:o.hasOwnProperty("text")&&!this.inField&&this.writeText(e,o.text)}n&&!(0<t.inlines.length)||i||this.writeNewLine(e)},ef.prototype.writeTable=function(e,t){for(var i=0;i<t.rows.length;i++)for(var n=t.rows[i],r=0;r<n.cells.length;r++){var o=n.cells[r];this.writeBody(e,o.blocks,!1)}},ef.prototype.writeHeadersFooters=function(e,t){var i=t.headersFooters;_.isNullOrUndefined(i)||(this.writeHeaderFooter(e,t.headersFooters.header),this.writeHeaderFooter(e,t.headersFooters.footer),this.writeHeaderFooter(e,t.headersFooters.evenFooter),this.writeHeaderFooter(e,t.headersFooters.evenHeader),this.writeHeaderFooter(e,t.headersFooters.firstPageHeader),this.writeHeaderFooter(e,t.headersFooters.firstPageFooter))},ef.prototype.writeHeaderFooter=function(e,t){t&&t.blocks&&this.writeBody(e,t.blocks,!0)},ef.prototype.writeSectionEnd=function(e,t){this.curSectionIndex++},ef.prototype.writeNewLine=function(e){_.isNullOrUndefined(e)?this.pageContent=this.pageContent+" ":e.writeLine("")},ef.prototype.writeText=function(e,t){_.isNullOrUndefined(e)?this.pageContent+=t:e.write(t)},ef.prototype.updateLastParagraph=function(){var e,t=this.document.sections.length;if(0<t&&(e=this.document.sections[t-1]),!_.isNullOrUndefined(e)){for(var i=[],n=0;n<e.blocks.length;n++)e.blocks[n].hasOwnProperty("inlines")&&i.push(e.blocks[n]);t=i.length;0<t&&(this.lastPara=i[t-1])}},ef.prototype.destroy=function(){this.document=void 0,this.lastPara=void 0,this.mSections=void 0,this.sections=[],this.sections=void 0,this.pageContent=void 0};var $m=ef;function ef(){this.pageContent="",this.curSectionIndex=0,this.inField=!1}Object.defineProperty(c.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"owner",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),c.prototype.getModuleName=function(){return"SfdtExport"},c.prototype.clear=function(){this.writeInlineStyles=void 0,this.startLine=void 0,this.endLine=void 0,this.lists=void 0,this.images=void 0,this.document=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.selectedCommentsId=[],this.selectedRevisionId=[],this.startBlock=void 0,this.endBlock=void 0,this.isPartialExport=!1,this.keywordIndex=void 0},c.prototype.serialize=function(){return this.seralizeInternal(this.owner.documentEditorSettings.optimizeSfdt?1:0)},c.prototype.seralizeInternal=function(e){return JSON.stringify(this.write(e))},c.prototype.saveAsBlobNonOptimized=function(e){var i=new Blob([this.serialize()],{type:"text/plain"});return new Promise(function(e,t){e(i)})},c.prototype.saveAsBlob=function(e){var t=this.serialize(),t=new Blob([t],{type:"application/json"}),t=new f.ZipArchiveItem(t,"sfdt"),i=new f.ZipArchive;return i.addItem(t),i.saveAsBlob()},c.prototype.updateEditRangeId=function(){for(var e=-1,t=0;t<this.documentHelper.editRanges.keys.length;t++)for(var i=this.documentHelper.editRanges.keys,n=0;n<i[t].length;n++)for(var r=this.documentHelper.editRanges.get(i[t]),o=0;o<r.length;o++)r[o].editRangeId=++e,r[o].editRangeEnd.editRangeId=e},c.prototype.write=function(e,t,i,n,r,o,s){if(o&&(this.writeInlineStyles=!0),_.isNullOrUndefined(e)?this.keywordIndex=this.owner.documentEditorSettings.optimizeSfdt?1:0:this.keywordIndex=e,this.Initialize(),this.updateEditRangeId(),t instanceof uh&&n instanceof uh){this.isExport=!1,_.isNullOrUndefined(s)||(this.isExport=s);var o=t.paragraph,e=n.paragraph,a=(this.isPartialExport&&(this.startBlock=this.getParentBlock(o),this.endBlock=this.getParentBlock(e)),o.associatedCell),s=e.associatedCell,l=(o.bodyWidget,this.createSection(t.paragraph.bodyWidget)),e=(this.document[Re[this.keywordIndex]].push(l),a),o=s,e=(a instanceof N&&(e=this.getParentCell(e)),s instanceof N&&(o=this.getParentCell(o)),e instanceof N&&o instanceof N&&e.equals(o)),d=(e||_.isNullOrUndefined(s)?(this.startLine=t,this.endLine=n,this.endOffset=r):a instanceof N?(u=a.getContainerTable(),o=s.getContainerTable(),u.tableFormat===o.tableFormat&&(this.endCell=s,this.endCell.ownerTable!==a.ownerTable&&a.ownerTable.associatedCell&&a.ownerTable.associatedCell.ownerTable===this.endCell.ownerTable&&0===a.ownerTable.associatedCell.childWidgets.indexOf(a.ownerTable)&&(a=a.ownerTable.associatedCell),this.endColumnIndex=this.endCell.columnIndex+this.endCell.cellFormat.columnSpan,this.startColumnIndex=a.columnIndex)):this.endCell=s,void 0);if(e&&!this.isPartialExport||_.isNullOrUndefined(a)){var h,c=this.createParagraph(t.paragraph),p=(l[S[this.keywordIndex]].push(c),t.paragraph),d=this.writeParagraph(t.paragraph,c,l[S[this.keywordIndex]],t.indexInOwner,i);for(this.isPartialExport&&(d=this.getNextBlock(d,p),l=this.document[Re[this.keywordIndex]][this.document[Re[this.keywordIndex]].length-1]);d;)d.containerWidget instanceof z&&p.containerWidget instanceof z&&d.containerWidget.sectionIndex!==p.containerWidget.sectionIndex?(l=this.createSection(d.containerWidget),this.document[Re[this.keywordIndex]].push(l),h=this.createParagraph(d),l[S[this.keywordIndex]].push(h),p=d,d=this.writeParagraph(p,h,l[S[this.keywordIndex]],t.indexInOwner,i)):(p=d,d=this.writeBlock(d,0,l[S[this.keywordIndex]]),this.isPartialExport&&_.isNullOrUndefined(d)&&(d=this.getNextBlock(d,p),l=this.document[Re[this.keywordIndex]][this.document[Re[this.keywordIndex]].length-1]))}else{if(_.isNullOrUndefined(s)&&a.ownerTable.associatedCell){var u,n=(u=a.getContainerTable()).childWidgets[u.childWidgets.length-1],g=n.childWidgets[n.childWidgets.length-1];if(g.ownerTable!==a.ownerTable&&a.ownerTable.associatedCell&&0===a.ownerTable.associatedCell.childWidgets.indexOf(a.ownerTable))for(;a.ownerTable!==g.ownerTable;)a=a.ownerTable.associatedCell;this.endColumnIndex=g.columnIndex+g.cellFormat.columnSpan,this.startColumnIndex=a.columnIndex}r=this.createTable(a.ownerTable),p=(l[S[this.keywordIndex]].push(r),a.ownerTable);for(d=this.writeTable(a.ownerTable,r,a.ownerRow.indexInOwner,l[S[this.keywordIndex]]),this.isPartialExport&&(d=this.getNextBlock(d,p),l=this.document[Re[this.keywordIndex]][this.document[Re[this.keywordIndex]].length-1]);d;)d.containerWidget instanceof z&&p.containerWidget instanceof z&&d.containerWidget.sectionIndex!==p.containerWidget.sectionIndex?(l=this.createSection(d.containerWidget),this.document[Re[this.keywordIndex]].push(l),c=this.createParagraph(d),l[S[this.keywordIndex]].push(c),p=d,d=this.writeParagraph(p,c,l[S[this.keywordIndex]],t.indexInOwner,i)):(p=d,d=this.writeBlock(d,0,l[S[this.keywordIndex]]),this.isPartialExport&&(d=this.getNextBlock(d,p),l=this.document[Re[this.keywordIndex]][this.document[Re[this.keywordIndex]].length-1]))}}else this.isExport=!0,0<this.documentHelper.pages.length&&(o=this.documentHelper.pages[0],this.writePage(o));this.document[ze[this.keywordIndex]]=((e={})[Or[this.keywordIndex]]=this.documentHelper.backgroundColor,e),this.writeStyles(this.documentHelper),this.writeLists(this.documentHelper),this.writeComments(this.documentHelper),this.writeRevisions(this.documentHelper),this.writeCustomXml(this.documentHelper),this.writeImages(this.documentHelper),this.footnotes(this.documentHelper),this.endnotes(this.documentHelper);s=this.document;return this.clear(),s},c.prototype.getNextBlock=function(e,t){return _.isNullOrUndefined(e)&&this.isPartialExport&&this.endBlock&&!this.endBlock.equals(t)&&((e=t.getSplitWidgets().pop().nextRenderedWidget)&&t.bodyWidget.index!==e.bodyWidget.index?(t=this.createSection(e.bodyWidget),this.document[Re[this.keywordIndex]].push(t)):e=void 0),e},c.prototype.Initialize=function(){this.lists=[],this.images=[],this.document={},this.document.optimizeSfdt=this.owner.documentEditorSettings.optimizeSfdt,this.document[Re[this.keywordIndex]]=[],this.document[Ae[this.keywordIndex]]=this.writeCharacterFormat(this.documentHelper.characterFormat,this.keywordIndex),this.document[De[this.keywordIndex]]=this.writeParagraphFormat(this.documentHelper.paragraphFormat,this.keywordIndex),_.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)||(this.document[Me[this.keywordIndex]]=this.writeFontSubsitutionTable(this.documentHelper)),this.document[at[this.keywordIndex]]=this.writeCharacterFormat(this.documentHelper.themeFontLanguage,this.keywordIndex),this.document[Ke[this.keywordIndex]]=this.documentHelper.defaultTabWidth,this.document[Xe[this.keywordIndex]]=j.getBoolInfo(this.owner.enableTrackChanges,this.keywordIndex),this.document[Ye[this.keywordIndex]]=j.getBoolInfo(this.documentHelper.isDocumentProtected,this.keywordIndex),this.document[Qe[this.keywordIndex]]=this.documentHelper.hashValue,this.document[$e[this.keywordIndex]]=this.documentHelper.saltValue,this.document[Ze[this.keywordIndex]]=j.getBoolInfo(this.documentHelper.restrictFormatting,this.keywordIndex),this.document[Je[this.keywordIndex]]=1==this.keywordIndex?this.getProtectionTypeEnumValue(this.documentHelper.protectionType):this.documentHelper.protectionType,this.document[et[this.keywordIndex]]=j.getBoolInfo(this.documentHelper.dontUseHtmlParagraphAutoSpacing,this.keywordIndex),this.document[it[this.keywordIndex]]=j.getBoolInfo(this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading,this.keywordIndex),this.document[st[this.keywordIndex]]=1==this.keywordIndex?this.getCompatibilityModeEnumValue(this.documentHelper.compatibilityMode):this.documentHelper.compatibilityMode,this.document[ba[this.keywordIndex]]=j.getBoolInfo(this.documentHelper.allowSpaceOfSameStyleInTable,this.keywordIndex),this.documentHelper.hasThemes&&(this.document[lt[this.keywordIndex]]=this.writeThemes(this.documentHelper.themes))},c.prototype.writeFontSubsitutionTable=function(e){for(var t={},i=0;i<e.fontSubstitutionTable.length;i++){var n=e.fontSubstitutionTable.keys[i];t[n]=this.documentHelper.fontSubstitutionTable.get(n)}return t},c.prototype.writePage=function(e){if(0<e.bodyWidgets.length)for(var t=e.bodyWidgets[0];t=this.writeBodyWidget(t,0),!_.isNullOrUndefined(t););return this.document},c.prototype.writeBodyWidget=function(e,t){if(e instanceof z){var i=this.createSection(e),n=(this.document[Re[this.keywordIndex]].push(i),this.writeHeaderFooters(this.documentHelper.headersFooters[e.index],i),e.childWidgets[t]);for(_.isNullOrUndefined(n)&&e.nextRenderedWidget&&(n=e.nextRenderedWidget.childWidgets[t]);n=this.writeBlock(n,0,i[S[this.keywordIndex]]););for(var r,o=e;o=(e=o).nextRenderedWidget,(o=!_.isNullOrUndefined(o)||_.isNullOrUndefined(e.page.nextPage)||_.isNullOrUndefined(e.page.nextPage)?o:e.page.nextPage.bodyWidgets[0])instanceof z&&o.index===e.index;);return!_.isNullOrUndefined(e.lastChild)&&e.lastChild instanceof G&&(r=e.lastChild.isEmpty(),e.lastChild.isSectionBreak)&&!_.isNullOrUndefined(e.lastChild.previousRenderedWidget)&&e.lastChild.previousRenderedWidget instanceof K&&(r=!1),!_.isNullOrUndefined(o)&&o instanceof z&&e.sectionIndex!==o.sectionIndex&&r&&!this.isWordExport&&((t={})[ko[this.keywordIndex]]=[],i[S[this.keywordIndex]].push(t)),o}},c.prototype.writeHeaderFooters=function(e,t){_.isNullOrUndefined(e)||(t=t[Is[this.keywordIndex]],_.isNullOrUndefined(e[0])||e[0].isEmpty||(t[ys[this.keywordIndex]]=this.writeHeaderFooter(e[0]),"{}"==JSON.stringify(t[ys[this.keywordIndex]])&&delete t[ys[this.keywordIndex]]),_.isNullOrUndefined(e[1])||e[1].isEmpty||(t[vs[this.keywordIndex]]=this.writeHeaderFooter(e[1]),"{}"==JSON.stringify(t[vs[this.keywordIndex]])&&delete t[vs[this.keywordIndex]]),_.isNullOrUndefined(e[2])||e[2].isEmpty||(t[ws[this.keywordIndex]]=this.writeHeaderFooter(e[2]),"{}"==JSON.stringify(t[ws[this.keywordIndex]])&&delete t[ws[this.keywordIndex]]),_.isNullOrUndefined(e[3])||e[3].isEmpty||(t[bs[this.keywordIndex]]=this.writeHeaderFooter(e[3]),"{}"==JSON.stringify(t[bs[this.keywordIndex]])&&delete t[bs[this.keywordIndex]]),_.isNullOrUndefined(e[4])||e[4].isEmpty||(t[xs[this.keywordIndex]]=this.writeHeaderFooter(e[4]),"{}"==JSON.stringify(t[xs[this.keywordIndex]])&&delete t[xs[this.keywordIndex]]),_.isNullOrUndefined(e[5]))||e[5].isEmpty||(t[Cs[this.keywordIndex]]=this.writeHeaderFooter(e[5]),"{}"==JSON.stringify(t[Cs[this.keywordIndex]])&&delete t[Cs[this.keywordIndex]])},c.prototype.writeHeaderFooter=function(e){if(!_.isNullOrUndefined(e)&&!e.isEmpty){var t={};if(e&&e.childWidgets&&0<e.childWidgets.length){t[S[this.keywordIndex]]=[];for(var i=e.firstChild;i=this.writeBlock(i,0,t[S[this.keywordIndex]]););}return t}},c.prototype.createSection=function(e){var t={};return t[ks[this.keywordIndex]]={},t[ks[this.keywordIndex]]=this.writeSectionFormat(e.sectionFormat,t[ks[this.keywordIndex]],this.keywordIndex),t[S[this.keywordIndex]]=[],t[Is[this.keywordIndex]]={},t},c.prototype.writeSectionFormat=function(e,t,i){if(t[pi[i]]=e.pageWidth,t[ui[i]]=e.pageHeight,t[gi[i]]=e.leftMargin,t[mi[i]]=e.rightMargin,t[fi[i]]=e.topMargin,t[yi[i]]=e.bottomMargin,t[li[i]]=e.headerDistance,t[di[i]]=e.footerDistance,t[hi[i]]=j.getBoolInfo(e.differentFirstPage,i),t[ci[i]]=j.getBoolInfo(e.differentOddAndEvenPages,i),t[Tt[i]]=j.getBoolInfo(e.bidi,i),_.isNullOrUndefined(e.breakCode)||(t[Wi[i]]=e.breakCode),e.restartPageNumbering&&(t[vi[i]]=j.getBoolInfo(e.restartPageNumbering,i),t[wi[i]]=e.pageStartingNumber),t[bi[i]]=1==i?this.getFootEndNoteNumberFormatEnumValue(e.endnoteNumberFormat):e.endnoteNumberFormat,t[xi[i]]=1==i?this.getFootEndNoteNumberFormatEnumValue(e.footNoteNumberFormat):e.footNoteNumberFormat,t[Ci[i]]=1==i?this.getFootnoteRestartIndexEnumValue(e.restartIndexForFootnotes):e.restartIndexForFootnotes,t[Ii[i]]=1==i?this.getFootnoteRestartIndexEnumValue(e.restartIndexForEndnotes):e.restartIndexForEndnotes,t[ki[i]]=e.initialFootNoteNumber,t[Fi[i]]=e.initialEndNoteNumber,_.isNullOrUndefined(e.pageNumberStyle)||(t[Pi[i]]=e.pageNumberStyle),!_.isNullOrUndefined(e.columns)&&!_.isNullOrUndefined(e.numberOfColumns&&1<e.numberOfColumns)){var n=e.columns;t[Si[i]]=e.numberOfColumns,t[Hi[i]]=j.getBoolInfo(e.equalWidth,i),t[Ni[i]]=j.getBoolInfo(e.lineBetweenColumns,i),t[Ti[i]]=[];for(var r=0;r<n.length;r++){var o={};o[mr[i]]=j.convertPixelToPoint(n[r].width),o[Qs[i]]=j.convertPixelToPoint(n[r].space),t[Ti[i]].push(o)}}return t},c.prototype.writeBlock=function(e,t,i){var n,r;if(e instanceof Qd)return e instanceof G?e.hasOwnProperty("contentControlProperties")&&e.contentControlProperties&&"BuildingBlockGallery"!==e.contentControlProperties.type?(r=this.blockContentControl(e),this.blockContent=!1,_.isNullOrUndefined(r)||!this.isBlockClosed&&this.nestedBlockContent||(this.nestedBlockEnabled=!1,i.push(r),this.blocks=[]),this.nextBlock):(n=this.createParagraph(e),i.push(n),this.writeParagraph(e,n,i)):(n=e).hasOwnProperty("contentControlProperties")&&n.contentControlProperties&&"BuildingBlockGallery"!==n.contentControlProperties.type?(r=this.tableContentControl(n),!_.isNullOrUndefined(r)&&this.isBlockClosed&&i.push(r),this.nextBlock):(e=this.createTable(n),i.push(e),this.writeTable(n,e,0,i))},c.prototype.writeParagraphs=function(e){var t=this.blocks,i=e.childWidgets[0],n=i.children[0],r=i.children[1];return(n instanceof Y||r instanceof Y)&&(n=i.children[2],r=i.children[3]),!_.isNullOrUndefined(e.contentControlProperties)&&e.containerWidget instanceof N&&!_.isNullOrUndefined(e.containerWidget.containerWidget)&&!_.isNullOrUndefined(e.containerWidget.containerWidget.containerWidget.contentControlProperties)&&(t=[]),this.nestedBlockEnabled&&(t=[]),(n instanceof E&&r instanceof E&&!this.nestedBlockContent||this.blockContent&&n instanceof E&&!this.nestedBlockContent)&&(i=!1,(i=r instanceof E&&"Block"===r.contentControlWidgetType?!0:i)||this.blockContent&&n instanceof E&&!this.nestedBlockContent&&0===n.type&&r instanceof E&&"Block"===n.contentControlWidgetType)?(this.nestedBlockContent=!0,this.nestedBlockEnabled=!0,i=this.blockContentControl(e),_.isNullOrUndefined(i)||this.blocks.push(i)):(r=this.createParagraph(e),t.push(r),this.nextBlock=this.writeParagraph(e,r,t)),!this.nestedBlockContent&&this.nestedBlockEnabled&&(this.nestedBlockEnabled=!1),t},c.prototype.contentControlProperty=function(e){var t,i,n={},r=[];if(n[Po[this.keywordIndex]]=j.getBoolInfo(e.lockContentControl,this.keywordIndex),n[To[this.keywordIndex]]=j.getBoolInfo(e.lockContents,this.keywordIndex),n[So[this.keywordIndex]]=e.tag,n[Or[this.keywordIndex]]=e.color,n[Ho[this.keywordIndex]]=e.title,_.isNullOrUndefined(e.appearance)||(n[va[this.keywordIndex]]=1==this.keywordIndex?this.getContentControlAppearanceEnumValue(e.appearance):e.appearance),n[aa[this.keywordIndex]]=1==this.keywordIndex?this.getContentControlTypeEnumValue(e.type):e.type,n[No[this.keywordIndex]]=j.getBoolInfo(e.hasPlaceHolderText,this.keywordIndex),n[Wo[this.keywordIndex]]=j.getBoolInfo(e.multiline,this.keywordIndex),n[Oo[this.keywordIndex]]=j.getBoolInfo(e.isTemporary,this.keywordIndex),_.isNullOrUndefined(e.isChecked)||(n[Mo[this.keywordIndex]]=j.getBoolInfo(e.isChecked,this.keywordIndex)),_.isNullOrUndefined(e.uncheckedState)||(n[Ao[this.keywordIndex]]=this.tounCheckedState(e.uncheckedState)),_.isNullOrUndefined(e.checkedState)||(n[Do[this.keywordIndex]]=this.toCheckedState(e.checkedState)),_.isNullOrUndefined(e.dateCalendarType)||(n[Eo[this.keywordIndex]]=1==this.keywordIndex?this.getDateCalendarTypeEnumValue(e.dateCalendarType):e.dateCalendarType),_.isNullOrUndefined(e.dateStorageFormat)||(n[Lo[this.keywordIndex]]=1==this.keywordIndex?this.getDateStorageFormatEnumValue(e.dateStorageFormat):e.dateStorageFormat),_.isNullOrUndefined(e.dateDisplayLocale)||(n[Bo[this.keywordIndex]]=e.dateDisplayLocale),_.isNullOrUndefined(e.dateDisplayFormat)||(n[Ro[this.keywordIndex]]=e.dateDisplayFormat),_.isNullOrUndefined(e.xmlMapping)||(i={},(t={})[jo[this.keywordIndex]]=j.getBoolInfo(e.xmlMapping.isMapped,this.keywordIndex),t[Go[this.keywordIndex]]=j.getBoolInfo(e.xmlMapping.isWordMl,this.keywordIndex),_.isNullOrUndefined(e.xmlMapping.prefixMapping)||(t[Ko[this.keywordIndex]]=e.xmlMapping.prefixMapping),t[Zo[this.keywordIndex]]=e.xmlMapping.xPath,t[Xo[this.keywordIndex]]=e.xmlMapping.storeItemId,_.isNullOrUndefined(e.xmlMapping.customXmlPart)||(i[Yo[this.keywordIndex]]=e.xmlMapping.customXmlPart.id,i[wo[this.keywordIndex]]=e.xmlMapping.customXmlPart.xml,t[Jo[this.keywordIndex]]=i),n[Vo[this.keywordIndex]]=t),_.isNullOrUndefined(e.characterFormat)||(n[Ae[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat,this.keywordIndex)),!_.isNullOrUndefined(e.contentControlListItems))for(var o=0;o<e.contentControlListItems.length;o++){var s={};s[_o[this.keywordIndex]]=e.contentControlListItems[o].displayText,s[qo[this.keywordIndex]]=e.contentControlListItems[o].value,r.push(s)}return n[Uo[this.keywordIndex]]=r,n},c.prototype.tounCheckedState=function(e){var t={};return t[zo[this.keywordIndex]]=e.font,t[qo[this.keywordIndex]]=e.value,t},c.prototype.toCheckedState=function(e){var t={};return t[zo[this.keywordIndex]]=e.font,t[qo[this.keywordIndex]]=e.value,t},c.prototype.blockContentControl=function(e){var t={};if(0===e.childWidgets.length)this.nextBlock=e.nextWidget;else{if(t[S[this.keywordIndex]]=this.writeParagraphs(e),!_.isNullOrUndefined(this.nextBlock)&&e.contentControlProperties===this.nextBlock.contentControlProperties)return this.isBlockClosed=!1,this.nestedBlockContent=!0,this.blocks=t[S[this.keywordIndex]];if(this.isBlockClosed=!0,!_.isNullOrUndefined(t[S[this.keywordIndex]])){var i=e.childWidgets[0],n=i.children[0],r=i.children[1];if((n instanceof Y||r instanceof Y)&&(n=i.children[2],r=i.children[3]),n instanceof E&&r instanceof E&&!this.nestedBlockContent||this.blockContent&&n instanceof E&&!this.nestedBlockContent){if(!(r instanceof E))return t[Fo[this.keywordIndex]]=this.contentControlProperty(n.contentControlProperties),t;"Block"===r.contentControlWidgetType?t[Fo[this.keywordIndex]]=this.contentControlProperty(r.contentControlProperties):t[Fo[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties)}else t[Fo[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties);return t}}},c.prototype.tableContentControl=function(e){var t={};if(t[S[this.keywordIndex]]=this.tableContentControls(e),!_.isNullOrUndefined(this.nextBlock)){if(e.contentControlProperties===this.nextBlock.contentControlProperties)return this.isBlockClosed=!1,this.blocks=t[S[this.keywordIndex]];this.isBlockClosed=!0}return t[Fo[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties),t},c.prototype.tableContentControls=function(e){var t=[],i=(this.isBlockClosed||(t=this.blocks),this.createTable(e));return t.push(i),this.nextBlock=this.writeTable(e,i,0,t),t},c.prototype.writeParagraph=function(e,t,i,n,r){_.isNullOrUndefined(n)&&(n=0),_.isNullOrUndefined(r)&&(r=0);for(var o=e;o instanceof G;){if(this.writeLines(o,n,r,t[ko[this.keywordIndex]]))return void(this.endLine===o.lastChild&&this.endOffset===this.owner.selection.getLineLength(o.lastChild)+1&&-1===o.paragraphFormat.listFormat.listId&&i.push(this.createParagraph(o)));r=n=0,o=(e=o).nextSplitWidget}return o=e.nextRenderedWidget,"Continuous"!==this.documentHelper.owner.layoutType&&_.isNullOrUndefined(o)&&e.containerWidget instanceof z&&!_.isNullOrUndefined(e.containerWidget.page)&&!_.isNullOrUndefined(e.containerWidget.page.nextPage)&&!_.isNullOrUndefined(e.containerWidget.page.nextPage.bodyWidgets)&&(o=e.containerWidget.page.nextPage.bodyWidgets[0].childWidgets[0]),!this.isExport||o instanceof Qd&&e.containerWidget.index===o.containerWidget.index?o:void 0},c.prototype.writeInlines=function(e,t,i){for(var n=t,r=!(this.contentInline=[]),o=0;o<n.children.length;o++){var s,a=n.children[o];if(this.isExport&&this.checkboxOrDropdown){if(r&&a instanceof X)continue;a instanceof Z&&2===a.fieldType&&(r=!0)}a instanceof Y||(a instanceof Bh?i.push(this.writeInlinesFootNote(a)):(a instanceof E||this.startContent&&!this.blockContent?this.writeInlinesContentControl(a,t,i,o):(s=this.writeInline(a),_.isNullOrUndefined(s)||i.push(s)),this.isExport&&a instanceof Z&&1===a.fieldType&&(this.checkboxOrDropdown=r=!1)))}},c.prototype.inlineContentControl=function(e,t,i){var n,r={},o=[];if(_.isNullOrUndefined(i)?this.nestedContent?(r[ko[this.keywordIndex]]=this.inlineContentControls(e,void 0,o),n=this.nestedContentProperty(t,r),_.isNullOrUndefined(n)&&!this.multipleLineContent||(this.contentInline.push(r),o=[])):r[ko[this.keywordIndex]]=this.inlineContentControls(e,this.contentInline):this.nestedContent?(null==(i=i[i.length-1][ko[this.keywordIndex]])[i.length-1][ko[this.keywordIndex]]&&(i[i.length-1][ko[this.keywordIndex]]=[]),r=this.inlineContentControls(e,i[i.length-1][ko[this.keywordIndex]]),n=this.nestedContentProperty(t,i[i.length-1]),_.isNullOrUndefined(n)||(this.contentInline.push(r),o=[])):this.inlineContentControls(e,i[i.length-1][ko[this.keywordIndex]]),t instanceof E&&1===t.type&&!this.nestedContent){if(!this.multipleLineContent||_.isNullOrUndefined(i))return r[Fo[this.keywordIndex]]=this.contentControlProperty(t.contentControlProperties),r;i[i.length-1][Fo[this.keywordIndex]]=this.contentControlProperty(t.contentControlProperties),this.multipleLineContent=!1}else if(this.startContent)return this.multipleLineContent=!0,r},c.prototype.nestedContentProperty=function(e,t,i){return!_.isNullOrUndefined(e)&&1===e.type?(t[Fo[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties),t):this.startContent?(this.multipleLineContent=!0,t):void 0},c.prototype.inlineContentControls=function(e,t,i){e=this.writeInline(e);return _.isNullOrUndefined(i)?(t.push(e),t):(i.push(e),i)},c.prototype.writeInline=function(e){var t,i={};if(0<e.removedIds.length)for(var n=0;n<e.removedIds.length;n++)e.revisions[n]=this.documentHelper.revisionsInternal.get(e.removedIds[n]);if(i[Ae[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat,this.keywordIndex),e instanceof Z)i[Kr[this.keywordIndex]]=e.fieldType,0===e.fieldType&&(i[jr[this.keywordIndex]]=e.hasFieldEnd,e.formFieldData)&&(i[Gr[this.keywordIndex]]={},i[Gr[this.keywordIndex]][dt[this.keywordIndex]]=e.formFieldData.name,i[Gr[this.keywordIndex]][Zr[this.keywordIndex]]=j.getBoolInfo(e.formFieldData.enabled,this.keywordIndex),i[Gr[this.keywordIndex]][Xr[this.keywordIndex]]=e.formFieldData.helpText,i[Gr[this.keywordIndex]][Jr[this.keywordIndex]]=e.formFieldData.statusText,e.formFieldData instanceof Ch?(i[Gr[this.keywordIndex]][Yr[this.keywordIndex]]={},i[Gr[this.keywordIndex]][Yr[this.keywordIndex]][aa[this.keywordIndex]]=1==this.keywordIndex?this.getTextFormFieldTypeEnumValue(e.formFieldData.type):e.formFieldData.type,i[Gr[this.keywordIndex]][Yr[this.keywordIndex]][eo[this.keywordIndex]]=e.formFieldData.maxLength,i[Gr[this.keywordIndex]][Yr[this.keywordIndex]][to[this.keywordIndex]]=e.formFieldData.defaultValue,i[Gr[this.keywordIndex]][Yr[this.keywordIndex]][io[this.keywordIndex]]=1==this.keywordIndex&&"Text"===e.formFieldData.type?this.getTextFormFieldFormatEnumValue(e.formFieldData.format):e.formFieldData.format):e.formFieldData instanceof Fh?(i[Gr[this.keywordIndex]][Qr[this.keywordIndex]]={},this.checkboxOrDropdown=!0,i[Gr[this.keywordIndex]][Qr[this.keywordIndex]][no[this.keywordIndex]]=1==this.keywordIndex?this.getCheckBoxSizeTypeEnumValue(e.formFieldData.sizeType):e.formFieldData.sizeType,i[Gr[this.keywordIndex]][Qr[this.keywordIndex]][ro[this.keywordIndex]]=e.formFieldData.size,i[Gr[this.keywordIndex]][Qr[this.keywordIndex]][to[this.keywordIndex]]=j.getBoolInfo(e.formFieldData.defaultValue,this.keywordIndex),i[Gr[this.keywordIndex]][Qr[this.keywordIndex]][oo[this.keywordIndex]]=j.getBoolInfo(e.formFieldData.checked,this.keywordIndex)):(i[Gr[this.keywordIndex]][$r[this.keywordIndex]]={},this.checkboxOrDropdown=!0,i[Gr[this.keywordIndex]][$r[this.keywordIndex]][so[this.keywordIndex]]=e.formFieldData.dropdownItems,i[Gr[this.keywordIndex]][$r[this.keywordIndex]][ao[this.keywordIndex]]=e.formFieldData.selectedIndex)),e.fieldCodeType&&""!==e.fieldCodeType&&(i.fieldCodeType=e.fieldCodeType);else if(e instanceof Lc)this.writeChart(e,i);else if(e instanceof Ic)i[Br[this.keywordIndex]]=e.imageString,this.images.push(parseInt(e.imageString,10)),i[Rr[this.keywordIndex]]=e.metaFileImageString,i[Ar[this.keywordIndex]]=j.getBoolInfo(e.isMetaFile,this.keywordIndex),i[ka[this.keywordIndex]]=e.isCompressed,i[mr[this.keywordIndex]]=j.convertPixelToPoint(e.width),i[fr[this.keywordIndex]]=j.convertPixelToPoint(e.height),e.isCrop&&(i[Ur[this.keywordIndex]]=e.bottom,i[Vr[this.keywordIndex]]=e.right,i[zr[this.keywordIndex]]=e.left,i[Dr[this.keywordIndex]]=e.top,i[_r[this.keywordIndex]]=e.cropWidthScale,i[qr[this.keywordIndex]]=e.cropHeightScale),i[dt[this.keywordIndex]]=e.name,i[cr[this.keywordIndex]]=e.alternateText,i[Ho[this.keywordIndex]]=e.title,i[pr[this.keywordIndex]]=j.getBoolInfo(e.visible,this.keywordIndex),i[yr[this.keywordIndex]]=e.widthScale,i[vr[this.keywordIndex]]=e.heightScale,i[us[this.keywordIndex]]=j.convertPixelToPoint(e.verticalPosition),i[ps[this.keywordIndex]]=1==this.keywordIndex?this.getVerticalOriginEnumValue(e.verticalOrigin):e.verticalOrigin,i[Bi[this.keywordIndex]]=1==this.keywordIndex?this.getShapeVerticalAlignmentEnumValue(e.verticalAlignment):e.verticalAlignment,i[fs[this.keywordIndex]]=j.convertPixelToPoint(e.horizontalPosition),i[gs[this.keywordIndex]]=1==this.keywordIndex?this.getHorizontalOriginEnumValue(e.horizontalOrigin):e.horizontalOrigin,i[ms[this.keywordIndex]]=1==this.keywordIndex?this.getShapeHorizontalAlignmentEnumValue(e.horizontalAlignment):e.horizontalAlignment,i[as[this.keywordIndex]]=j.getBoolInfo(e.allowOverlap,this.keywordIndex),i[xr[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingStyleEnumValue(e.textWrappingStyle):e.textWrappingStyle,i[Cr[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingTypeEnumValue(e.textWrappingType):e.textWrappingType,i[ur[this.keywordIndex]]=j.getBoolInfo(e.isBelowText,this.keywordIndex),_.isNullOrUndefined(e.distanceBottom)||(i[cs[this.keywordIndex]]=j.convertPixelToPoint(e.distanceBottom)),_.isNullOrUndefined(e.distanceLeft)||(i[hs[this.keywordIndex]]=j.convertPixelToPoint(e.distanceLeft)),_.isNullOrUndefined(e.distanceRight)||(i[ds[this.keywordIndex]]=j.convertPixelToPoint(e.distanceRight)),_.isNullOrUndefined(e.distanceTop)||(i[ls[this.keywordIndex]]=j.convertPixelToPoint(e.distanceTop)),i[Sr[this.keywordIndex]]=j.getBoolInfo(e.layoutInCell,this.keywordIndex),i[Tr[this.keywordIndex]]=e.zOrderPosition;else if(e instanceof J)i[Us[this.keywordIndex]]=e.bookmarkType,i[dt[this.keywordIndex]]=e.name,_.isNullOrUndefined(e.properties)||(t={},_.isNullOrUndefined(e.properties.isAfterParagraphMark)||(t[Ta[this.keywordIndex]]=j.getBoolInfo(e.properties.isAfterParagraphMark,this.keywordIndex)),_.isNullOrUndefined(e.properties.isAfterTableMark)||(t[Oa[this.keywordIndex]]=j.getBoolInfo(e.properties.isAfterTableMark,this.keywordIndex)),_.isNullOrUndefined(e.properties.isAfterRowMark)||(t[Ha[this.keywordIndex]]=j.getBoolInfo(e.properties.isAfterRowMark,this.keywordIndex)),_.isNullOrUndefined(e.properties.isAfterCellMark)||(t[Sa[this.keywordIndex]]=j.getBoolInfo(e.properties.isAfterCellMark,this.keywordIndex)),_.isNullOrUndefined(e.properties.columnFirst)||(t[Ks[this.keywordIndex]]=e.properties.columnFirst),_.isNullOrUndefined(e.properties.columnLast)||(t[Zs[this.keywordIndex]]=e.properties.columnLast),i[Vs[this.keywordIndex]]=t);else if(e instanceof Sp)i[Ht[this.keywordIndex]]=1==this.keywordIndex?j.getBreakClearType(e.breakClearType):e.breakClearType;else if(e instanceof Bh)i=this.writeInlinesFootNote(e);else if(e instanceof X){var r=e.text;if(this.isWriteEndFootNote||!_.isNullOrUndefined(this.owner.editorModule)&&this.owner.editorModule.isPaste||(r=j.removeInvalidXmlChars(r)),-1!==(r=this.isWriteInlinesFootNote&&0===e.indexInOwner&&0===e.line.indexInOwner&&0==e.paragraph.indexInOwner&&j.checkTextFormat(r)?"":r).indexOf(String.fromCharCode(30)))i[dr[this.keywordIndex]]=r.replace(/\u001e/g,"-");else if(-1!==r.indexOf(String.fromCharCode(31)))i[dr[this.keywordIndex]]=r.replace(/\u001f/g,"");else if(e instanceof Op)i[dr[this.keywordIndex]]="";else if(0!==e.revisions.length)if(this.isExport||!this.owner.enableTrackChanges||this.isPartialExport)i[dr[this.keywordIndex]]=r;else{this.copyWithTrackChange=!0;for(var o=0;o<e.revisions.length;o++){var s=e.revisions[o];-1===this.selectedRevisionId.indexOf(s.revisionID)&&this.selectedRevisionId.push(s.revisionID),"Deletion"!==e.revisions[o].revisionType&&(i[dr[this.keywordIndex]]=r)}}else i[dr[this.keywordIndex]]=r}else if(e instanceof Wc)""!==e.user&&(i[Xs[this.keywordIndex]]=e.user),i[Js[this.keywordIndex]]=e.group,i[Ks[this.keywordIndex]]=e.columnFirst,i[Zs[this.keywordIndex]]=e.columnLast,i[Gs[this.keywordIndex]]=e.editRangeId.toString();else if(e instanceof Sc)i[Ys[this.keywordIndex]]={},i[Ys[this.keywordIndex]][Xs[this.keywordIndex]]=e.editRangeStart.user,i[Ys[this.keywordIndex]][Js[this.keywordIndex]]=e.editRangeStart.group,i[Ys[this.keywordIndex]][Ks[this.keywordIndex]]=e.editRangeStart.columnFirst,i[Ys[this.keywordIndex]][Zs[this.keywordIndex]]=e.editRangeStart.columnLast,i[Gs[this.keywordIndex]]=e.editRangeId.toString();else if(e instanceof up){if(!this.iscontentInsert)return;this.isExport||0!==e.commentType||this.selectedCommentsId.push(e.commentId),i[ho[this.keywordIndex]]=e.commentType,i[lo[this.keywordIndex]]=e.commentId}else e instanceof uc?this.writeShape(e,i):i=void 0;return this.writeInlineRevisions(i,e),i},c.prototype.writeInlineRevisions=function(e,t){if(0<t.revisions.length&&(this.isExport||!this.isExport&&!this.owner.enableTrackChanges)){e[Dt[this.keywordIndex]]=[];for(var i=0;i<t.revisions.length;i++)-1===this.selectedRevisionId.indexOf(t.revisions[i].revisionID)&&this.selectedRevisionId.push(t.revisions[i].revisionID),e[Dt[this.keywordIndex]].push(t.revisions[i].revisionID)}},c.prototype.writeShape=function(e,t){if(t[hr[this.keywordIndex]]=e.shapeId,t[dt[this.keywordIndex]]=e.name,t[cr[this.keywordIndex]]=e.alternateText,t[Ho[this.keywordIndex]]=e.title,t[pr[this.keywordIndex]]=j.getBoolInfo(e.visible,this.keywordIndex),t[mr[this.keywordIndex]]=j.convertPixelToPoint(e.width),t[fr[this.keywordIndex]]=j.convertPixelToPoint(e.height),e.isZeroHeight?t[fr[this.keywordIndex]]=0:t[fr[this.keywordIndex]]=j.convertPixelToPoint(e.height),t[yr[this.keywordIndex]]=e.widthScale,t[vr[this.keywordIndex]]=e.heightScale,t[us[this.keywordIndex]]=j.convertPixelToPoint(e.verticalPosition),t[ps[this.keywordIndex]]=1==this.keywordIndex?this.getVerticalOriginEnumValue(e.verticalOrigin):e.verticalOrigin,t[Bi[this.keywordIndex]]=1==this.keywordIndex?this.getShapeVerticalAlignmentEnumValue(e.verticalAlignment):e.verticalAlignment,t[Ir[this.keywordIndex]]=e.verticalRelativePercent,t[fs[this.keywordIndex]]=j.convertPixelToPoint(e.horizontalPosition),t[gs[this.keywordIndex]]=1==this.keywordIndex?this.getHorizontalOriginEnumValue(e.horizontalOrigin):e.horizontalOrigin,t[ms[this.keywordIndex]]=1==this.keywordIndex?this.getShapeHorizontalAlignmentEnumValue(e.horizontalAlignment):e.horizontalAlignment,t[kr[this.keywordIndex]]=e.horizontalRelativePercent,t[Fr[this.keywordIndex]]=e.heightRelativePercent,t[Pr[this.keywordIndex]]=e.widthRelativePercent,t[Tr[this.keywordIndex]]=e.zOrderPosition,t[as[this.keywordIndex]]=j.getBoolInfo(e.allowOverlap,this.keywordIndex),t[xr[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingStyleEnumValue(e.textWrappingStyle):e.textWrappingStyle,t[Cr[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingTypeEnumValue(e.textWrappingType):e.textWrappingType,t[ur[this.keywordIndex]]=j.getBoolInfo(e.isBelowText,this.keywordIndex),t[gr[this.keywordIndex]]=j.getBoolInfo(e.isHorizontalRule,this.keywordIndex),_.isNullOrUndefined(e.distanceBottom)||(t[cs[this.keywordIndex]]=j.convertPixelToPoint(e.distanceBottom)),_.isNullOrUndefined(e.distanceLeft)||(t[hs[this.keywordIndex]]=j.convertPixelToPoint(e.distanceLeft)),_.isNullOrUndefined(e.distanceRight)||(t[ds[this.keywordIndex]]=j.convertPixelToPoint(e.distanceRight)),_.isNullOrUndefined(e.distanceTop)||(t[ls[this.keywordIndex]]=j.convertPixelToPoint(e.distanceTop)),t[Sr[this.keywordIndex]]=j.getBoolInfo(e.layoutInCell,this.keywordIndex),t[Hr[this.keywordIndex]]=j.getBoolInfo(e.lockAnchor,this.keywordIndex),t[Nr[this.keywordIndex]]=1==this.keywordIndex?this.getAutoShapeTypeEnumValue(e.autoShapeType):e.autoShapeType,e.fillFormat&&(t[br[this.keywordIndex]]={},t[br[this.keywordIndex]][Or[this.keywordIndex]]=e.fillFormat.color,t[br[this.keywordIndex]][Er[this.keywordIndex]]=j.getBoolInfo(e.fillFormat.fill,this.keywordIndex)),e.lineFormat&&(t[wr[this.keywordIndex]]={},t[wr[this.keywordIndex]][wa[this.keywordIndex]]=1==this.keywordIndex?this.getLineFormatTypeEnumValue(e.lineFormat.lineFormatType):e.lineFormat.lineFormatType,t[wr[this.keywordIndex]][Or[this.keywordIndex]]=e.lineFormat.color,t[wr[this.keywordIndex]][xa[this.keywordIndex]]=e.lineFormat.weight,t[wr[this.keywordIndex]][ln[this.keywordIndex]]=1==this.keywordIndex?this.getLineDashStyleEnumValue(e.lineFormat.dashStyle):e.lineFormat.dashStyle,t[wr[this.keywordIndex]][mn[this.keywordIndex]]=j.getBoolInfo(e.lineFormat.line,this.keywordIndex)),e.textFrame){t[Wr[this.keywordIndex]]={},t[Wr[this.keywordIndex]][Lr[this.keywordIndex]]=1==this.keywordIndex?this.getTextVerticalAlignmentEnumValue(e.textFrame.textVerticalAlignment):e.textFrame.textVerticalAlignment,t[Wr[this.keywordIndex]][gi[this.keywordIndex]]=j.convertPixelToPoint(e.textFrame.marginLeft),t[Wr[this.keywordIndex]][mi[this.keywordIndex]]=j.convertPixelToPoint(e.textFrame.marginRight),t[Wr[this.keywordIndex]][fi[this.keywordIndex]]=j.convertPixelToPoint(e.textFrame.marginTop),t[Wr[this.keywordIndex]][yi[this.keywordIndex]]=j.convertPixelToPoint(e.textFrame.marginBottom),t[Wr[this.keywordIndex]][S[this.keywordIndex]]=[];for(var i=0;i<e.textFrame.childWidgets.length;i++){var n=e.textFrame.childWidgets[i];n.hasOwnProperty("contentControlProperties")&&!_.isNullOrUndefined(e.paragraph)&&e.paragraph.hasOwnProperty("contentControlProperties")&&(this.blocks=[]),this.writeBlock(n,0,t[Wr[this.keywordIndex]][S[this.keywordIndex]])}}},c.prototype.writeChart=function(e,t){t[tr[this.keywordIndex]]={},t[$n[this.keywordIndex]]={},t[Qn[this.keywordIndex]]={},t[er[this.keywordIndex]]={},t[Jn[this.keywordIndex]]=[],t[Yn[this.keywordIndex]]=[],t[ir[this.keywordIndex]]={},t[nr[this.keywordIndex]]={},this.writeChartTitleArea(e.chartTitleArea,t[$n[this.keywordIndex]]),this.writeChartArea(e.chartArea,t[Qn[this.keywordIndex]]),this.writeChartArea(e.chartPlotArea,t[er[this.keywordIndex]]),this.writeChartCategory(e,t[Jn[this.keywordIndex]]),this.createChartSeries(e,t[Yn[this.keywordIndex]]),this.writeChartLegend(e.chartLegend,t[tr[this.keywordIndex]]),this.writeChartCategoryAxis(e.chartPrimaryCategoryAxis,t[ir[this.keywordIndex]]),this.writeChartCategoryAxis(e.chartPrimaryValueAxis,t[nr[this.keywordIndex]]),void 0!==e.chartDataTable.showSeriesKeys&&(t[lr[this.keywordIndex]]={},this.writeChartDataTable(e.chartDataTable,t[lr[this.keywordIndex]])),t[rr[this.keywordIndex]]=e.title,t[or[this.keywordIndex]]=e.type,t[sr[this.keywordIndex]]=e.chartGapWidth,t[ar[this.keywordIndex]]=e.chartOverlap,t[fr[this.keywordIndex]]=j.convertPixelToPoint(e.height),t[mr[this.keywordIndex]]=j.convertPixelToPoint(e.width)},c.prototype.writeChartTitleArea=function(e,t){t[Ia[this.keywordIndex]]=e.chartfontName,t[It[this.keywordIndex]]=e.chartFontSize,t[hn[this.keywordIndex]]={},t[cn[this.keywordIndex]]=this.writeChartDataFormat(e.dataFormat),this.writeChartLayout(e.layout,t[hn[this.keywordIndex]])},c.prototype.writeChartDataFormat=function(e){var t={};return t[Er[this.keywordIndex]]={},t[mn[this.keywordIndex]]={},_.isNullOrUndefined(e.fill.color)||(6<e.fill.color.length?t[Er[this.keywordIndex]][fn[this.keywordIndex]]=e.fill.color.substring(2):t[Er[this.keywordIndex]][fn[this.keywordIndex]]=e.fill.color),t[Er[this.keywordIndex]][ya[this.keywordIndex]]=e.fill.rgb,t[mn[this.keywordIndex]][Or[this.keywordIndex]]=e.line.color,t[mn[this.keywordIndex]][ya[this.keywordIndex]]=e.line.rgb,t},c.prototype.writeChartLayout=function(e,t){t[yn[this.keywordIndex]]=e.chartLayoutLeft,t[vn[this.keywordIndex]]=e.chartLayoutTop},c.prototype.writeChartArea=function(e,t){t[fn[this.keywordIndex]]=e.chartForeColor},c.prototype.writeChartLegend=function(e,t){t[qs[this.keywordIndex]]=e.chartLegendPostion,t[$n[this.keywordIndex]]={},this.writeChartTitleArea(e.chartTitleArea,t[$n[this.keywordIndex]])},c.prototype.writeChartCategoryAxis=function(e,t){t[rr[this.keywordIndex]]=e.categoryAxisTitle,t[$n[this.keywordIndex]]={},this.writeChartTitleArea(e.chartTitleArea,t[$n[this.keywordIndex]]),t[Xn[this.keywordIndex]]=e.categoryAxisType,t[It[this.keywordIndex]]=e.axisFontSize,t[Ia[this.keywordIndex]]=e.axisFontName,t[Ns[this.keywordIndex]]=e.categoryNumberFormat,t[ha[this.keywordIndex]]=e.max,t[ca[this.keywordIndex]]=e.min,t[da[this.keywordIndex]]=j.getBoolInfo(e.isAutoInternal,this.keywordIndex),t[la[this.keywordIndex]]=e.interval,t[pa[this.keywordIndex]]=j.getBoolInfo(e.majorGridLines,this.keywordIndex),t[ua[this.keywordIndex]]=j.getBoolInfo(e.minorGridLines,this.keywordIndex),t[ga[this.keywordIndex]]=e.majorTick,t[ma[this.keywordIndex]]=e.minorTick,t[fa[this.keywordIndex]]=e.tickPosition},c.prototype.writeChartDataTable=function(e,t){t[jn[this.keywordIndex]]=j.getBoolInfo(e.showSeriesKeys,this.keywordIndex),t[Gn[this.keywordIndex]]=j.getBoolInfo(e.hasHorzBorder,this.keywordIndex),t[Kn[this.keywordIndex]]=j.getBoolInfo(e.hasVertBorder,this.keywordIndex),t[Zn[this.keywordIndex]]=j.getBoolInfo(e.hasBorders,this.keywordIndex)},c.prototype.writeChartCategory=function(e,t){var i=e.chartCategory;t[un[this.keywordIndex]]=[];for(var n=0;n<i.length;n++){var r=i[n],r=this.createChartCategory(r,e.chartType);t.push(r)}},c.prototype.createChartCategory=function(e,t){var i={};return i[un[this.keywordIndex]]=[],this.writeChartData(e,i[un[this.keywordIndex]],t),i[gn[this.keywordIndex]]=e.categoryXName,i},c.prototype.writeChartData=function(e,t,i){for(var n=e.chartData,r=0;r<n.length;r++){var o=n[r],o=this.createChartData(o,i);t.push(o)}},c.prototype.createChartData=function(e,t){var i={};return i[pn[this.keywordIndex]]=e.yValue,"Bubble"===t&&(i[ro[this.keywordIndex]]=e.size),i},c.prototype.createChartSeries=function(e,t){for(var i=e.chartSeries,n=e.chartType,r=0;r<i.length;r++){var o=i[r],o=this.writeChartSeries(o,n);t.push(o)}},c.prototype.writeChartSeries=function(e,t){var i="Pie"===t||"Doughnut"===t,n={},r={},o=e.errorBar;if(n[Bn[this.keywordIndex]]=[],n[Nn[this.keywordIndex]]=e.seriesName,i&&(_.isNullOrUndefined(e.firstSliceAngle)||(n[Rn[this.keywordIndex]]=e.firstSliceAngle),"Doughnut"===t)&&(n[Mn[this.keywordIndex]]=e.doughnutHoleSize),_.isNullOrUndefined(e.dataLabels.labelPosition)||(i=this.writeChartDataLabels(e.dataLabels),n[Wn[this.keywordIndex]]=i),_.isNullOrUndefined(e.seriesFormat.markerStyle)||(l=e.seriesFormat,(t={})[Cn[this.keywordIndex]]=l.markerStyle,t[kn[this.keywordIndex]]=l.numberValue,t[In[this.keywordIndex]]=l.markerColor,n[En[this.keywordIndex]]=t),_.isNullOrUndefined(o.type)||(r[aa[this.keywordIndex]]=o.type,r[wn[this.keywordIndex]]=o.direction,r[bn[this.keywordIndex]]=o.endStyle,r[xn[this.keywordIndex]]=o.numberValue,n[On[this.keywordIndex]]=r),0<e.trendLines.length){n[Ln[this.keywordIndex]]=[];for(var s=0;s<e.trendLines.length;s++){var a=this.writeChartTrendLines(e.trendLines[s]);n[Ln[this.keywordIndex]].push(a)}}for(s=0;s<e.chartDataFormat.length;s++){var l=this.writeChartDataFormat(e.chartDataFormat[s]);n[Bn[this.keywordIndex]].push(l)}return n},c.prototype.writeChartDataLabels=function(e){var t={};return t[qs[this.keywordIndex]]=e.position,t[Ia[this.keywordIndex]]=e.fontName,t[kt[this.keywordIndex]]=j.convertArgbToRgb(e.fontColor),t[It[this.keywordIndex]]=e.fontSize,t[An[this.keywordIndex]]=j.getBoolInfo(e.isLegendKey,this.keywordIndex),t[Dn[this.keywordIndex]]=j.getBoolInfo(e.isBubbleSize,this.keywordIndex),t[Un[this.keywordIndex]]=j.getBoolInfo(e.isCategoryName,this.keywordIndex),t[Vn[this.keywordIndex]]=j.getBoolInfo(e.isSeriesName,this.keywordIndex),t[zn[this.keywordIndex]]=j.getBoolInfo(e.isValue,this.keywordIndex),t[qn[this.keywordIndex]]=j.getBoolInfo(e.isPercentage,this.keywordIndex),t[_n[this.keywordIndex]]=j.getBoolInfo(e.isLeaderLines,this.keywordIndex),t},c.prototype.writeChartTrendLines=function(e){var t={};return t[dt[this.keywordIndex]]=e.trendLineName,t[aa[this.keywordIndex]]=e.trendLineType,t[Fn[this.keywordIndex]]=e.forwardValue,t[Pn[this.keywordIndex]]=e.backwardValue,t[Tn[this.keywordIndex]]=e.interceptValue,t[Hn[this.keywordIndex]]=j.getBoolInfo(e.isDisplayEquation,this.keywordIndex),t[Sn[this.keywordIndex]]=j.getBoolInfo(e.isDisplayRSquared,this.keywordIndex),t},c.prototype.writeLines=function(e,t,i,n){for(var r=t,o=this.endLine instanceof uh&&this.endLine.paragraph===e,s=o?this.endLine.indexInOwner:e.childWidgets.length-1,a=r;a<=s;a++){var l=e.childWidgets[a];this.endLine===l||t===a&&0!==i?(this.endLine===l&&e.paragraphFormat.bidi&&this.startLine!==this.endLine&&(this.endOffset=l.getEndOffset()),this.writeLine(l,this.startLine!==this.endLine&&l!==this.startLine?0:i,n)):this.writeInlines(e,l,n)}return o},c.prototype.writeLine=function(e,t,i){for(var n,r=!(this.contentInline=[]),o=!1,s=e===this.endLine,a=e,l=0,d=0;d<a.children.length;d++){var h=a.children[d];if(!(h instanceof Y)){var c=void 0,p=t<(l+=h.length);if(h instanceof E&&(p||(r=0===h.type),o=!0),h instanceof X&&h.hasOwnProperty("contentControlProperties")&&p&&!o&&(r=!0),h instanceof E&&(r&&1===h.type&&(r=!1),o)&&1===h.type&&(o=!1),n=s&&l>=this.endOffset,p&&!r)if(h instanceof E||this.startContent||this.blockContent){if(n){this.startContent=!1;break}this.writeInlinesContentControl(h,e,i,d)}else{c=this.writeInline(h);if(!_.isNullOrUndefined(c)&&(i[i.length]=c,t<l||n)&&(c.hasOwnProperty(dr[this.keywordIndex])&&(p=l-h.length,h=n?this.endOffset-p:h.length,c[dr[this.keywordIndex]]=c[dr[this.keywordIndex]].substring(t-p,h)),t=-1),n)break}}}},c.prototype.writeInlinesFootNote=function(e){this.isWriteInlinesFootNote=!0;var t={};t[bo[this.keywordIndex]]=1==this.keywordIndex?this.getFootnoteTypeEnumValue(e.footnoteType):e.footnoteType,t[Ae[this.keywordIndex]]={},t[Ae[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat,this.keywordIndex),t[S[this.keywordIndex]]=[];for(var i=0;i<e.bodyWidget.childWidgets.length;i++)this.writeBlock(e.bodyWidget.childWidgets[i],0,t[S[this.keywordIndex]]);return t[xo[this.keywordIndex]]=e.symbolCode,t[Co[this.keywordIndex]]=e.symbolFontName,t[Io[this.keywordIndex]]=e.customMarker,this.writeInlineRevisions(t,e),this.isWriteInlinesFootNote=!1,t},c.prototype.writeInlinesContentControl=function(e,t,i,n){if(e instanceof E&&"Block"===e.contentControlWidgetType)return this.isBlockClosed=!1,this.blockContent&&0===e.type?this.nestedBlockContent=!0:this.nestedBlockContent&&1===e.type?!(this.nestedBlockContent=!1):(this.blockContent=0===e.type,t.children[n-1]instanceof E&&"Block"===t.children[n-1].contentControlWidgetType&&(this.blockContent=!0),this.blockContent||(this.isBlockClosed=!0),!0);if(e instanceof E)return this.startContent&&0===e.type?this.nestedContent=!0:this.startContent&&this.nestedContent?((o={})[ko[this.keywordIndex]]=this.contentInline,0<this.contentInline.length&&(r=this.nestedContentProperty(t.children[n+1],o),i.push(r),this.contentInline=[]),this.multipleLineContent&&(o=i[i.length-1],this.nestedContentProperty(t.children[n+1],o),this.multipleLineContent=!1),!(this.nestedContent=!1)):(this.contentType=e.contentControlWidgetType,this.startContent=0===e.type,!0);if(this.startContent&&"Inline"===this.contentType)if(this.multipleLineContent)this.inlineContentControl(e,e.nextNode,i),this.contentInline=[];else{var r=this.inlineContentControl(e,e.nextNode);if(!_.isNullOrUndefined(r)){if(!this.nestedContent||!this.multipleLineContent)return i.push(r),!(this.contentInline=[]);(o={})[ko[this.keywordIndex]]=this.contentInline,i.push(o),this.contentInline=[]}}else{var o=this.writeInline(e);_.isNullOrUndefined(o)||i.push(o)}},c.prototype.createParagraph=function(e){var t,i,n={},r=!1,o=!1;return r=!(this.documentHelper.selection&&!this.documentHelper.selection.isEmpty&&!this.isExport)||(t=this.documentHelper.selection.end,i=(t=this.documentHelper.selection.isForward?t:this.documentHelper.selection.start).paragraph.childWidgets[t.paragraph.childWidgets.length-1],o=!_.isNullOrUndefined(e.paragraphFormat.listFormat.list),this.documentHelper.selection.isParagraphLastLine(i)&&t.currentWidget===i&&(t.offset===this.documentHelper.selection.getLineLength(i)+1||!(e.indexInOwner==t.paragraph.indexInOwner)&&o)),n[De[this.keywordIndex]]=this.writeParagraphFormat(r?e.paragraphFormat:new Xa(e),this.keywordIndex),n[Ae[this.keywordIndex]]=this.writeCharacterFormat(r?e.characterFormat:new B(e),this.keywordIndex),n[ko[this.keywordIndex]]=[],n},c.prototype.writeCharacterFormat=function(e,t,i){var n={};if(j.writeCharacterFormat(n,i,e,t),n[Ot[t]]=i?j.getBoolInfo(e.boldBidi,t):e.getValue("boldBidi"),n[Et[t]]=i?j.getBoolInfo(e.italicBidi,t):e.getValue("italicBidi"),0<e.revisions.length){n[Dt[t]]=[];for(var r=0;r<e.revisions.length;r++)n[Dt[t]].push(e.revisions[r].revisionID)}return this.writeInlineStyles&&!i&&(n[Ca[t]]=this.writeCharacterFormat(e,t,!0)),n},c.prototype.writeParagraphFormat=function(e,t,i){var n={};return this.keywordIndex=_.isNullOrUndefined(this.keywordIndex)?0:this.keywordIndex,j.writeParagraphFormat(n,i,e,t),n[ei[t]]=this.writeListFormat(e.listFormat,i),n[ai[t]]=this.writeTabs(e.tabs),this.writeInlineStyles&&!i&&(n[Ca[t]]=this.writeParagraphFormat(e,t,!0)),n},c.prototype.writeThemes=function(e){var t={};return t[$s[this.keywordIndex]]={},t[$s[this.keywordIndex]][ea[this.keywordIndex]]=e.fontScheme.fontSchemeName,t[$s[this.keywordIndex]][ta[this.keywordIndex]]=this.writeMajorMinorFontScheme(e.fontScheme.majorFontScheme),t[$s[this.keywordIndex]][ia[this.keywordIndex]]=this.writeMajorMinorFontScheme(e.fontScheme.minorFontScheme),t},c.prototype.writeMajorMinorFontScheme=function(e){var t={};t[na[this.keywordIndex]]=this.writeFontSchemeList(e.fontSchemeList);for(var i={},n=0,r=e.fontTypeface.keys;n<r.length;n++){var o=r[n];i[o]=e.fontTypeface.get(o)}return t[ra[this.keywordIndex]]=i,t},c.prototype.writeFontSchemeList=function(e){var i=this,n=[];return e.forEach(function(e){var t={};t[dt[i.keywordIndex]]=e.name,t[oa[i.keywordIndex]]=e.typeface,t[sa[i.keywordIndex]]=e.panose,n.push(t)}),n},c.prototype.writeTabs=function(e){if(!(_.isNullOrUndefined(e)||e.length<1)){for(var t=[],i=0;i<e.length;i++){var n=e[i],r={};r[qs[this.keywordIndex]]=n.position,r[_s[this.keywordIndex]]=n.deletePosition,r[zs[this.keywordIndex]]=1==this.keywordIndex?this.getTabJustificationEnumValue(n.tabJustification):n.tabJustification,r[js[this.keywordIndex]]=1==this.keywordIndex?this.getTabLeaderEnumValue(n.tabLeader):n.tabLeader,t.push(r)}return t}},c.prototype.writeListFormat=function(e,t){var i={},n=e.getValue("listId"),n=(_.isNullOrUndefined(n)||(i[Ut[this.keywordIndex]]=n,_.isNullOrUndefined(this.lists)&&(this.lists=[]),this.lists.indexOf(e.listId)<0&&this.lists.push(e.listId)),e.getValue("listLevelNumber")),n=(_.isNullOrUndefined(n)||(i[qt[this.keywordIndex]]=n),e.getValue("nsid"));return _.isNullOrUndefined(n)||(i[Es]=n),i},c.prototype.writeTable=function(e,t,i,n){i=e.childWidgets[i];if(!(i instanceof dh&&this.writeRow(i,t[ts[this.keywordIndex]]))){for(var r=e;(r=(e=r).nextSplitWidget)instanceof Qd;);return(r=e.nextRenderedWidget)instanceof Qd&&r.containerWidget.index===e.containerWidget.index?r:void 0}},c.prototype.writeRow=function(e,t){var i=e;do{if((e=i)===(i=this.writeRowInternal(i,t)))return!0}while(i instanceof dh);return!1},c.prototype.writeRowInternal=function(e,t){if(!(e instanceof dh))return e;e.isCellsHaveSameWidthUnit()||e.updateUniformWidthUnitForCells();var i=this.createRow(e);t.push(i);for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r instanceof N&&e.index===r.rowIndex&&(_.isNullOrUndefined(this.startColumnIndex)||r.columnIndex>=this.startColumnIndex)&&(_.isNullOrUndefined(this.endColumnIndex)||r.columnIndex<this.endColumnIndex)&&this.writeCell(r,i[es[this.keywordIndex]]))return e}for(var o,s=e;s=(e=s).nextRenderedWidget,!_.isNullOrUndefined(e.ownerTable.bodyWidget)&&s&&(e.ownerTable.index!==s.ownerTable.index&&e.ownerTable.bodyWidget.sectionIndex===s.ownerTable.bodyWidget.sectionIndex||e.ownerTable.bodyWidget.sectionIndex!==s.ownerTable.bodyWidget.sectionIndex)&&(s=void 0),o=!_.isNullOrUndefined(e.nextSplitWidget)&&e.childWidgets.length!==s.childWidgets.length,s instanceof dh&&s.index===e.index&&!o;);return s},c.prototype.writeCell=function(e,t){for(var i=this.createCell(e),n=(t.push(i),e.firstChild);n=this.writeBlock(n,0,i[S[this.keywordIndex]]););return this.endCell instanceof N&&this.endCell.cellFormat===e.cellFormat},c.prototype.createTable=function(e){var t={};_.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=0),t[ts[this.keywordIndex]]=[],t[Na[this.keywordIndex]]=[];for(var i=0;i<e.tableHolder.columns.length;i++)t[Na[this.keywordIndex]][i]=e.tableHolder.columns[i].preferredWidth;return t[ss[this.keywordIndex]]=this.writeTableFormat(e.tableFormat,this.keywordIndex),t[is[this.keywordIndex]]=e.tableFormat.description,t[Ho[this.keywordIndex]]=e.tableFormat.title,t[Wa[this.keywordIndex]]=e.tableHolder.columns.length,this.writeTablePositioning(t,e),t},c.prototype.writeTablePositioning=function(e,t){t.wrapTextAround&&(e[ns[this.keywordIndex]]=j.getBoolInfo(t.wrapTextAround,this.keywordIndex),e[os[this.keywordIndex]]={},e[os[this.keywordIndex]][as[this.keywordIndex]]=j.getBoolInfo(t.positioning.allowOverlap,this.keywordIndex),_.isNullOrUndefined(t.positioning.distanceBottom)||(e[os[this.keywordIndex]][cs[this.keywordIndex]]=j.convertPixelToPoint(t.positioning.distanceBottom)),_.isNullOrUndefined(t.positioning.distanceLeft)||(e[os[this.keywordIndex]][hs[this.keywordIndex]]=j.convertPixelToPoint(t.positioning.distanceLeft)),_.isNullOrUndefined(t.positioning.distanceRight)||(e[os[this.keywordIndex]][ds[this.keywordIndex]]=j.convertPixelToPoint(t.positioning.distanceRight)),_.isNullOrUndefined(t.positioning.distanceTop)||(e[os[this.keywordIndex]][ls[this.keywordIndex]]=j.convertPixelToPoint(t.positioning.distanceTop)),_.isNullOrUndefined(t.positioning.verticalAlignment)||(e[os[this.keywordIndex]][Bi[this.keywordIndex]]=1==this.keywordIndex?this.getTableVerticalPositionEnumValue(t.positioning.verticalAlignment):t.positioning.verticalAlignment),_.isNullOrUndefined(t.positioning.verticalOrigin)||(e[os[this.keywordIndex]][ps[this.keywordIndex]]=1==this.keywordIndex?this.getTableVerticalRelationEnumValue(t.positioning.verticalOrigin):t.positioning.verticalOrigin),e[os[this.keywordIndex]][us[this.keywordIndex]]=t.positioning.verticalPosition,_.isNullOrUndefined(t.positioning.horizontalAlignment)||(e[os[this.keywordIndex]][ms[this.keywordIndex]]=1==this.keywordIndex?this.getTableHorizontalPositionEnumValue(t.positioning.horizontalAlignment):t.positioning.horizontalAlignment),_.isNullOrUndefined(t.positioning.horizontalOrigin)||(e[os[this.keywordIndex]][gs[this.keywordIndex]]=1==this.keywordIndex?this.getTableHorizontalRelationEnumValue(t.positioning.horizontalOrigin):t.positioning.horizontalOrigin),e[os[this.keywordIndex]][fs[this.keywordIndex]]=t.positioning.horizontalPosition)},c.prototype.createRow=function(e){var t={};return t[es[this.keywordIndex]]=[],t[$o[this.keywordIndex]]=this.writeRowFormat(e.rowFormat,this.keywordIndex),e.hasOwnProperty("contentControlProperties")&&(t[Fo[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties)),t},c.prototype.createCell=function(e){var t={};return t[S[this.keywordIndex]]=[],t[Qo[this.keywordIndex]]=this.writeCellFormat(e.cellFormat,this.keywordIndex),t[Fa[this.keywordIndex]]=e.columnIndex,e.hasOwnProperty("contentControlProperties")&&(t[Fo[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties)),t},c.prototype.writeShading=function(e,t){var i={};return i[$i[t]]=e.hasValue("backgroundColor")?e.backgroundColor:void 0,i[en[t]]=e.hasValue("foregroundColor")?e.foregroundColor:void 0,i[Qi[t]]=e.hasValue("textureStyle")?1==t?this.getTextureStyleEnumValue(e.textureStyle):e.textureStyle:void 0,i},c.prototype.writeBorders=function(e,t){var i={};return i[Dr[t]]=j.writeBorder(e.top,t),i[zr[t]]=j.writeBorder(e.left,t),i[Vr[t]]=j.writeBorder(e.right,t),i[Ur[t]]=j.writeBorder(e.bottom,t),i[an[t]]=j.writeBorder(e.diagonalDown,t),i[sn[t]]=j.writeBorder(e.diagonalUp,t),i[on[t]]=j.writeBorder(e.horizontal,t),i[rn[t]]=j.writeBorder(e.vertical,t),i},c.prototype.writeCellFormat=function(e,t){var i={};return i[si[t]]=this.writeBorders(e.borders,t),i[Ki[t]]=this.writeShading(e.shading,t),i[fi[t]]=e.hasValue("topMargin")?e.topMargin:void 0,i[mi[t]]=e.hasValue("rightMargin")?e.rightMargin:void 0,i[gi[t]]=e.hasValue("leftMargin")?e.leftMargin:void 0,i[yi[t]]=e.hasValue("bottomMargin")?e.bottomMargin:void 0,i[Xi[t]]=e.hasValue("preferredWidth")?e.preferredWidth:void 0,i[Ji[t]]=e.hasValue("preferredWidthType")?1==t?this.getWidthTypeEnumValue(e.preferredWidthType):e.preferredWidthType:void 0,i[Oi[t]]=e.hasValue("cellWidth")?e.cellWidth:void 0,i[Ei[t]]=e.columnSpan,i[Li[t]]=e.rowSpan,i[Bi[t]]=e.hasValue("verticalAlignment")?1==t?this.getCellVerticalAlignmentEnumValue(e.verticalAlignment):e.verticalAlignment:void 0,i},c.prototype.writeRowFormat=function(e,t){var i={},n=[];this.assignRowFormat(i,e,t);for(var r=0;r<e.revisions.length;r++)i[Dt[t]]=this.writeRowRevisions(e.revisions[r],n);return i},c.prototype.assignRowFormat=function(e,t,i){e[fr[i]]=t.hasValue("height")?t.height:void 0,e[Ri[i]]=t.hasValue("allowBreakAcrossPages")?j.getBoolInfo(t.allowBreakAcrossPages,this.keywordIndex):void 0,e[Ai[i]]=t.hasValue("heightType")?1==this.keywordIndex?this.getHeighTypeEnumValue(t.heightType):t.heightType:void 0,e[Mi[i]]=t.hasValue("isHeader")?j.getBoolInfo(t.isHeader,this.keywordIndex):void 0,e[si[i]]=this.writeBorders(t.borders,i),e[Di[i]]=t.gridBefore,e[Ui[i]]=t.hasValue("gridBeforeWidth")?t.gridBeforeWidth:void 0,e[Vi[i]]=t.hasValue("gridBeforeWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(t.gridBeforeWidthType):t.gridBeforeWidthType:void 0,e[zi[i]]=t.gridAfter,e[qi[i]]=t.hasValue("gridAfterWidth")?t.gridAfterWidth:void 0,e[_i[i]]=t.hasValue("gridAfterWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(t.gridAfterWidthType):t.gridAfterWidthType:void 0,e[gi[i]]=t.hasValue("leftMargin")?t.leftMargin:void 0,e[fi[i]]=t.hasValue("topMargin")?t.topMargin:void 0,e[mi[i]]=t.hasValue("rightMargin")?t.rightMargin:void 0,e[yi[i]]=t.hasValue("bottomMargin")?t.bottomMargin:void 0,e[_t[i]]=t.hasValue("leftIndent")?t.leftIndent:void 0},c.prototype.writeRowRevisions=function(e,t){return-1===this.selectedRevisionId.indexOf(e.revisionID)&&this.selectedRevisionId.push(e.revisionID),t.push(e.revisionID),t},c.prototype.writeTableFormat=function(e,t){var i={};return i[si[t]]=this.writeBorders(e.borders,t),i[Ki[t]]=this.writeShading(e.shading,t),i[Gi[t]]=e.hasValue("cellSpacing")?e.cellSpacing:void 0,i[_t[t]]=e.hasValue("leftIndent")?e.leftIndent:void 0,i[Zi[t]]=e.hasValue("tableAlignment")?1==this.keywordIndex?this.getTableAlignmentEnumValue(e.tableAlignment):e.tableAlignment:void 0,i[fi[t]]=e.hasValue("topMargin")?e.topMargin:void 0,i[mi[t]]=e.hasValue("rightMargin")?e.rightMargin:void 0,i[gi[t]]=e.hasValue("leftMargin")?e.leftMargin:void 0,i[yi[t]]=e.hasValue("bottomMargin")?e.bottomMargin:void 0,i[Xi[t]]=e.hasValue("preferredWidth")?e.preferredWidth:void 0,i[Ji[t]]=e.hasValue("preferredWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(e.preferredWidthType):e.preferredWidthType:void 0,i[Tt[t]]=e.hasValue("bidi")?j.getBoolInfo(e.bidi,this.keywordIndex):void 0,i[ji[t]]=e.hasValue("allowAutoFit")?j.getBoolInfo(e.allowAutoFit,this.keywordIndex):void 0,i[Pt[t]]=_.isNullOrUndefined(e.styleName)?void 0:e.styleName,i},c.prototype.footnotes=function(e){this.isWriteEndFootNote=!0;for(var t=0;t<e.footnotes.separator.length;t++)this.seprators(e);this.isWriteEndFootNote=!1},c.prototype.seprators=function(e){if(0<e.footnotes.separator.length){this.document[rt[this.keywordIndex]]={},this.document[rt[this.keywordIndex]][Ms[this.keywordIndex]]=[];for(var t=0;t<e.footnotes.separator.length;t++)this.writeBlock(e.footnotes.separator[t],0,this.document[rt[this.keywordIndex]][Ms[this.keywordIndex]])}if(0<e.footnotes.continuationSeparator.length){this.document[rt[this.keywordIndex]][As[this.keywordIndex]]=[];for(t=0;t<e.footnotes.continuationSeparator.length;t++)this.writeBlock(e.footnotes.continuationSeparator[t],0,this.document[rt[this.keywordIndex]][As[this.keywordIndex]])}if(0<e.footnotes.continuationNotice.length){this.document[rt[this.keywordIndex]][Ds[this.keywordIndex]]=[];for(t=0;t<e.footnotes.continuationNotice.length;t++)this.writeBlock(e.footnotes.continuationNotice[t],0,this.document[rt[this.keywordIndex]][Ds[this.keywordIndex]])}},c.prototype.endnotes=function(e){this.isWriteEndFootNote=!0;for(var t=0;t<this.documentHelper.endnotes.separator.length;t++)this.endnoteSeparator(e);this.isWriteEndFootNote=!1},c.prototype.endnoteSeparator=function(e){if(0<e.endnotes.separator.length){this.document[ot[this.keywordIndex]]={},this.document[ot[this.keywordIndex]][Ms[this.keywordIndex]]=[];for(var t=0;t<e.endnotes.separator.length;t++)this.writeBlock(e.endnotes.separator[t],0,this.document[ot[this.keywordIndex]][Ms[this.keywordIndex]])}if(0<e.endnotes.continuationSeparator.length){this.document[ot[this.keywordIndex]][As[this.keywordIndex]]=[];for(t=0;t<e.endnotes.continuationSeparator.length;t++)this.writeBlock(e.endnotes.continuationSeparator[t],0,this.document[ot[this.keywordIndex]][As[this.keywordIndex]])}if(0<e.endnotes.continuationNotice.length){this.document[ot[this.keywordIndex]][Ds[this.keywordIndex]]=[];for(t=0;t<e.endnotes.continuationNotice.length;t++)this.writeBlock(e.endnotes.continuationNotice[t],0,this.document[ot[this.keywordIndex]][Ds[this.keywordIndex]])}},c.prototype.writeStyles=function(e){this.document[qe[this.keywordIndex]]=[];for(var t=0;t<e.styles.length;t++)this.document[qe[this.keywordIndex]].push(this.writeStyle(e.styles.getItem(t)))},c.prototype.writeStyle=function(e){var t={};return t[dt[this.keywordIndex]]=e.name,"Paragraph"===e.type&&(t[aa[this.keywordIndex]]=1==this.keywordIndex?this.getStyleTypeEnumValue(e.type):e.type,t[De[this.keywordIndex]]=this.writeParagraphFormat(e.paragraphFormat,this.keywordIndex),t[Ae[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat,this.keywordIndex)),"Character"===e.type&&(t[aa[this.keywordIndex]]=1==this.keywordIndex?this.getStyleTypeEnumValue(e.type):e.type,t[Ae[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat,this.keywordIndex)),"Table"===e.type&&(t[aa[this.keywordIndex]]=1==this.keywordIndex?this.getStyleTypeEnumValue(e.type):e.type),_.isNullOrUndefined(e.basedOn)||(t[ht[this.keywordIndex]]=e.basedOn.name),_.isNullOrUndefined(e.link)||(t[pt[this.keywordIndex]]=e.link.name),_.isNullOrUndefined(e.next)||(t[ct[this.keywordIndex]]=e.next.name),t},c.prototype.writeRevisions=function(e){this.document[je[this.keywordIndex]]=[];for(var t=0;t<e.owner.revisions.changes.length;t++)!this.isExport&&(this.isExport||this.owner.enableTrackChanges||-1===this.selectedRevisionId.indexOf(e.owner.revisions.changes[t].revisionID))||this.document[je[this.keywordIndex]].push(this.writeRevision(e.owner.revisions.changes[t]))},c.prototype.writeRevision=function(e){var t={};return t[co[this.keywordIndex]]=e.author,t[uo[this.keywordIndex]]=e.date,t[fo[this.keywordIndex]]=1==this.keywordIndex?this.getRevisionTypeEnumValue(e.revisionType):e.revisionType,t[yo[this.keywordIndex]]=e.revisionID,t},c.prototype.writeComments=function(e){this.document[_e[this.keywordIndex]]=[];for(var t=0;t<e.comments.length;t++)(this.isExport||!this.isExport&&-1!==this.selectedCommentsId.indexOf(this.documentHelper.comments[t].commentId))&&this.document[_e[this.keywordIndex]].push(this.writeComment(this.documentHelper.comments[t]))},c.prototype.writeCustomXml=function(e){this.document[Ge[this.keywordIndex]]=[];for(var t=0;t<e.customXmlData.length;t++){var i={},n=e.customXmlData.keys[t],n=(i[vo[this.keywordIndex]]=n,this.documentHelper.customXmlData.get(n));i[wo[this.keywordIndex]]=n,this.document[Ge[this.keywordIndex]].push(i)}},c.prototype.writeImages=function(e){this.document[Pa[this.keywordIndex]]={};for(var t=0;t<this.images.length;t++){var i=this.images[t],n=e.images.get(i);this.document[Pa[this.keywordIndex]][i]=n}},c.prototype.writeComment=function(e){var t={};t[lo[this.keywordIndex]]=e.commentId,t[co[this.keywordIndex]]=e.author,t[uo[this.keywordIndex]]=e.date,t[S[this.keywordIndex]]=j.commentInlines(e.text,e.mentions,this.keywordIndex),t[go[this.keywordIndex]]=j.getBoolInfo(e.isResolved,this.keywordIndex),t[mo[this.keywordIndex]]=[];for(var i=0;i<e.replyComments.length;i++)t[mo[this.keywordIndex]].push(this.writeComment(e.replyComments[i]));return t},c.prototype.writeLists=function(e){var t=[];this.document[Ue[this.keywordIndex]]=[];for(var i=0;i<e.lists.length;i++){var n=e.lists[i];-1<this.lists.indexOf(n.listId)&&(this.document[Ue[this.keywordIndex]].push(this.writeList(n)),t.indexOf(n.abstractListId)<0)&&t.push(n.abstractListId)}this.document[Ve[this.keywordIndex]]=[];for(i=0;i<e.abstractLists.length;i++){var r=e.abstractLists[i];-1<t.indexOf(r.abstractListId)&&this.document[Ve[this.keywordIndex]].push(this.writeAbstractList(r))}},c.prototype.writeAbstractList=function(e){var t={};t[Os[this.keywordIndex]]=e.abstractListId,t[Es]=e.nsid,t[Ls[this.keywordIndex]]=[];for(var i=0;i<e.levels.length;i++)t[Ls[this.keywordIndex]][i]=this.writeListLevel(e.levels[i]);return t},c.prototype.writeList=function(e){var t={};if(!_.isNullOrUndefined(e)){t[Os[this.keywordIndex]]=e.abstractListId,t[Rs[this.keywordIndex]]=[];for(var i=0;i<e.levelOverrides.length;i++)t[Rs[this.keywordIndex]].push(this.writeLevelOverrides(e.levelOverrides[i]));t[Ut[this.keywordIndex]]=e.listId,t[Es]=e.nsid}return t},c.prototype.writeLevelOverrides=function(e){var t={};return t[Hs[this.keywordIndex]]=e.levelNumber,e.overrideListLevel&&(t[Bs[this.keywordIndex]]=this.writeListLevel(e.overrideListLevel)),t[Ts[this.keywordIndex]]=e.startAt,t},c.prototype.writeListLevel=function(e){var t={};return t[Ae[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat,this.keywordIndex),t[De[this.keywordIndex]]=this.writeParagraphFormat(e.paragraphFormat,this.keywordIndex),t[rs[this.keywordIndex]]=j.getBoolInfo(e.isLegalStyleNumbering,this.keywordIndex),t[Ps[this.keywordIndex]]=1==this.keywordIndex?this.getFollowCharacterType(e.followCharacter):e.followCharacter,t[Fs[this.keywordIndex]]=1==this.keywordIndex?this.getListLevelPatternEnumValue(e.listLevelPattern):e.listLevelPattern,t[Ns[this.keywordIndex]]=e.numberFormat,t[Ws[this.keywordIndex]]=e.paraStyleName,t[Ss[this.keywordIndex]]=e.restartLevel,t[Ts[this.keywordIndex]]=e.startAt,t},c.prototype.getParentBlock=function(e){return e=e.isInsideTable?this.owner.documentHelper.layout.getParentTable(e):e},c.prototype.getParentCell=function(e){for(;e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},c.prototype.getWidthTypeEnumValue=function(e){switch(e){case"Auto":return 0;case"Percent":return 1;case"Point":return 2}},c.prototype.getTableAlignmentEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Right":return 2}},c.prototype.getTextureStyleEnumValue=function(e){switch(e){case"TextureNone":return 0;case"Texture2Pt5Percent":return 1;case"Texture5Percent":return 2;case"Texture7Pt5Percent":return 3;case"Texture10Percent":return 4;case"Texture12Pt5Percent":return 5;case"Texture15Percent":return 6;case"Texture17Pt5Percent":return 7;case"Texture20Percent":return 8;case"Texture22Pt5Percent":return 9;case"Texture25Percent":return 10;case"Texture27Pt5Percent":return 11;case"Texture30Percent":return 12;case"Texture32Pt5Percent":return 13;case"Texture35Percent":return 14;case"Texture37Pt5Percent":return 15;case"Texture40Percent":return 16;case"Texture42Pt5Percent":return 17;case"Texture45Percent":return 18;case"Texture47Pt5Percent":return 19;case"Texture50Percent":return 20;case"Texture52Pt5Percent":return 21;case"Texture55Percent":return 22;case"Texture57Pt5Percent":return 23;case"Texture60Percent":return 24;case"Texture62Pt5Percent":return 25;case"Texture65Percent":return 26;case"Texture67Pt5Percent":return 27;case"Texture70Percent":return 28;case"Texture72Pt5Percent":return 29;case"Texture75Percent":return 30;case"Texture77Pt5Percent":return 31;case"Texture80Percent":return 32;case"Texture82Pt5Percent":return 33;case"Texture85Percent":return 34;case"Texture87Pt5Percent":return 35;case"Texture90Percent":return 36;case"Texture92Pt5Percent":return 37;case"Texture95Percent":return 38;case"Texture97Pt5Percent":return 39;case"TextureSolid":return 40;case"TextureDarkHorizontal":return 41;case"TextureDarkVertical":return 42;case"TextureDarkDiagonalDown":return 43;case"TextureDarkDiagonalUp":return 44;case"TextureDarkCross":return 45;case"TextureDarkDiagonalCross":return 46;case"TextureHorizontal":return 47;case"TextureVertical":return 48;case"TextureDiagonalDown":return 49;case"TextureDiagonalUp":return 50;case"TextureCross":return 51;case"TextureDiagonalCross":return 52}},c.prototype.getHeighTypeEnumValue=function(e){switch(e){case"AtLeast":return 0;case"Exactly":return 1;default:return 0}},c.prototype.getCellVerticalAlignmentEnumValue=function(e){switch(e){case"Top":return 0;case"Center":return 1;case"Bottom":return 2}},c.prototype.getListLevelPatternEnumValue=function(e){switch(e){case"None":return 0;case"KanjiDigit":case"Arabic":return 1;case"UpRoman":return 2;case"LowRoman":return 3;case"UpLetter":return 4;case"LowLetter":return 5;case"Ordinal":return 6;case"Number":return 7;case"OrdinalText":return 8;case"LeadingZero":return 9;case"Bullet":return 10;case"FarEast":return 11;case"Special":return 12}},c.prototype.getStyleTypeEnumValue=function(e){switch(e){case"Paragraph":return 0;case"Character":return 1;case"Table":return 2}},c.prototype.getProtectionTypeEnumValue=function(e){switch(e){case"NoProtection":return 0;case"ReadOnly":return 1;case"FormFieldsOnly":return 2;case"CommentsOnly":return 3;case"RevisionsOnly":return 4}},c.prototype.getRevisionTypeEnumValue=function(e){switch(e){case"Insertion":return 1;case"Deletion":return 2;case"MoveTo":return 3;case"MoveFrom":return 4}},c.prototype.getFootnoteTypeEnumValue=function(e){switch(e){case"Footnote":return 0;case"Endnote":return 1}},c.prototype.getFootnoteRestartIndexEnumValue=function(e){switch(e){case"DoNotRestart":return 0;case"RestartForEachSection":return 1;case"RestartForEachPage":return 2}},c.prototype.getFootEndNoteNumberFormatEnumValue=function(e){switch(e){case"Arabic":return 0;case"UpperCaseRoman":return 1;case"LowerCaseRoman":return 2;case"UpperCaseLetter":return 3;case"LowerCaseLetter":return 4}},c.prototype.getTextVerticalAlignmentEnumValue=function(e){switch(e){case"Top":return 0;case"Middle":case"Center":return 1;case"Bottom":return 2;default:return 0}},c.prototype.getShapeVerticalAlignmentEnumValue=function(e){switch(e){case"None":return 0;case"Top":return 1;case"Center":return 2;case"Bottom":return 3;case"Inline":return 4;case"Inside":return 5;case"Outside":return 6;default:return 0}},c.prototype.getShapeHorizontalAlignmentEnumValue=function(e){switch(e){case"None":return 0;case"Center":return 1;case"Inside":return 2;case"Left":return 3;case"Outside":return 4;case"Right":return 5}},c.prototype.getVerticalOriginEnumValue=function(e){switch(e){case"Paragraph":return 0;case"BottomMargin":return 1;case"InsideMargin":return 2;case"Line":return 3;case"Margin":return 4;case"OutsideMargin":return 5;case"Page":return 6;case"TopMargin":return 7}},c.prototype.getHorizontalOriginEnumValue=function(e){switch(e){case"Column":return 0;case"Character":return 1;case"InsideMargin":return 2;case"LeftMargin":return 3;case"Margin":return 4;case"OutsideMargin":return 5;case"Page":return 6;case"RightMargin":return 7}},c.prototype.getTableVerticalRelationEnumValue=function(e){switch(e){case"Paragraph":return 0;case"Margin":return 1;case"Page":return 2;default:return 0}},c.prototype.getTableHorizontalRelationEnumValue=function(e){switch(e){case"Column":return 0;case"Margin":return 1;case"Page":return 2;default:return 0}},c.prototype.getTableVerticalPositionEnumValue=function(e){switch(e){case"None":return 0;case"Top":return 1;case"Center":return 2;case"Bottom":return 3;case"Inside":return 4;case"Outside":return 5;default:return 0}},c.prototype.getTableHorizontalPositionEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Inside":return 2;case"Outside":return 3;case"Right":return 4;default:return 0}},c.prototype.getLineDashStyleEnumValue=function(e){switch(e){case"Solid":return 0;case"Dash":return 1;case"DashDot":return 2;case"DashDotDot":return 3;case"DashDotGEL":return 4;case"DashGEL":return 5;case"Dot":return 6;case"DotGEL":return 7;case"LongDashDotDotGEL":return 8;case"LongDashDotGEL":return 9;case"LongDashGEL":return 10}},c.prototype.getHorizontalPositionAbsEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Right":return 2;case"Inside":return 3;case"Outside":return 4;default:return 0}},c.prototype.getTabJustificationEnumValue=function(e){switch(e){case"Left":return 0;case"Bar":return 1;case"Center":return 2;case"Decimal":return 3;case"List":return 4;case"Right":return 5}},c.prototype.getTabLeaderEnumValue=function(e){switch(e){case"None":return 0;case"Single":return 1;case"Dot":return 2;case"Hyphen":return 3;case"Underscore":return 4}},c.prototype.getTextFormFieldTypeEnumValue=function(e){switch(e){case"Text":return 0;case"Number":return 1;case"Date":return 2;case"Calculation":return 3}},c.prototype.getTextFormFieldFormatEnumValue=function(e){switch(e){case"None":return 0;case"FirstCapital":return 1;case"Lowercase":return 2;case"Uppercase":return 3;case"Titlecase":return 4;default:return 0}},c.prototype.getCheckBoxSizeTypeEnumValue=function(e){switch(e){case"Auto":return 0;case"Exactly":return 1}},c.prototype.getContentControlAppearanceEnumValue=function(e){switch(e){case"BoundingBox":return 1;case"Hidden":return 2;case"Tags":return 3;default:return 1}},c.prototype.getContentControlTypeEnumValue=function(e){switch(e){case"RichText":return 0;case"BuildingBlockGallery":return 1;case"CheckBox":return 2;case"ComboBox":return 3;case"Date":return 4;case"DropDownList":return 5;case"Group":return 6;case"Picture":return 7;case"RepeatingSection":return 8;case"Text":return 9}},c.prototype.getDateCalendarTypeEnumValue=function(e){switch(e){case"Gregorian":return 0;case"GregorianArabic":return 1;case"GregorianEnglish":return 2;case"GregorianMiddleEastFrench":return 3;case"GregorianTransliteratedEnglish":return 4;case"GregorianTransliteratedFrench":return 5;case"Hebrew":return 6;case"Hijri":return 7;case"Japan":return 8;case"Korean":return 9;case"Saka":return 10;case"Taiwan":return 11;case"Thai":return 12;default:return 0}},c.prototype.getDateStorageFormatEnumValue=function(e){switch(e){case"DateStorageDate":return 1;case"DateStorageDateTime":return 2;case"DateStorageText":return 3;default:return 0}},c.prototype.getTextWrappingStyleEnumValue=function(e){switch(e){case"Inline":return 0;case"InFrontOfText":return 1;case"Square":return 2;case"TopAndBottom":return 3;case"Behind":return 4;default:return 0}},c.prototype.getTextWrappingTypeEnumValue=function(e){switch(e){case"Both":return 0;case"Left":return 1;case"Right":return 2;case"Largest":return 3}},c.prototype.getCompatibilityModeEnumValue=function(e){switch(e){case"Word2013":return 0;case"Word2003":return 1;case"Word2007":return 2;case"Word2010":return 3}},c.prototype.getLineFormatTypeEnumValue=function(e){switch(e){case"Solid":return 0;case"Patterned":return 1;case"Gradient":return 2;case"None":return 3}},c.prototype.getAutoShapeTypeEnumValue=function(e){switch(e){case"Rectangle":return 1;case"RoundedRectangle":return 2;case"StraightConnector":return 3;case"Oval":return 4;case"IsoscelesTriangle":return 5;case"RightTriangle":return 6;case"Parallelogram":return 7;case"Trapezoid":return 8;case"Diamond":return 9;case"RegularPentagon":return 10;case"Hexagon":return 11;case"Heptagon":return 12;case"Octagon":return 13;case"Decagon":return 14;case"Dodecagon":return 15;case"Chord":return 16;case"Teardrop":return 17;case"Frame":return 18;case"HalfFrame":return 19;case"L_Shape":return 20;case"Pie":return 21;case"DiagonalStripe":return 22;case"Cross":return 23;case"Plaque":return 24;case"Can":return 25;case"Cube":return 26;case"Bevel":return 27;case"Donut":return 28;case"NoSymbol":return 29;case"BlockArc":return 30;case"FoldedCorner":return 31;case"SmileyFace":return 32;case"Heart":return 33;case"LightningBolt":return 34;case"Sun":return 35;case"Moon":return 36;case"Cloud":return 37;case"Arc":return 38;case"DoubleBracket":return 39;case"DoubleBrace":return 40;case"LeftBracket":return 41;case"RightBracket":return 42;case"LeftBrace":return 43;case"RightBrace":return 44;case"FlowChartProcess":return 45;case"FlowChartAlternateProcess":return 46;case"FlowChartDecision":return 47;case"FlowChartData":return 48;case"FlowChartPredefinedProcess":return 49;case"FlowChartInternalStorage":return 50;case"FlowChartDocument":return 51;case"FlowChartMultiDocument":return 52;case"FlowChartTerminator":return 53;case"FlowChartPreparation":return 54;case"FlowChartManualInput":return 55;case"FlowChartManualOperation":return 56;case"FlowChartConnector":return 57;case"FlowChartOffPageConnector":return 58;case"FlowChartCard":return 59;case"FlowChartPunchedTape":return 60;case"FlowChartSummingJunction":return 61;case"FlowChartOr":return 62;case"FlowChartCollate":return 63;case"FlowChartSort":return 64;case"FlowChartExtract":return 65;case"FlowChartMerge":return 66;case"FlowChartStoredData":return 67;case"FlowChartDelay":return 68;case"FlowChartSequentialAccessStorage":return 69;case"FlowChartMagneticDisk":return 70;case"FlowChartDirectAccessStorage":return 71;case"FlowChartDisplay":return 72;case"RightArrow":return 73;case"LeftArrow":return 74;case"UpArrow":return 75;case"DownArrow":return 76;case"LeftRightArrow":return 77;case"UpDownArrow":return 78;case"QuadArrow":return 79;case"LeftRightUpArrow":return 80;case"BentArrow":return 81;case"UTurnArrow":return 82;case"LeftUpArrow":return 83;case"BentUpArrow":return 84;case"CurvedRightArrow":return 85;case"CurvedLeftArrow":return 86;case"CurvedUpArrow":return 87;case"CurvedDownArrow":return 88;case"StripedRightArrow":return 89;case"NotchedRightArrow":return 90;case"Pentagon":return 91;case"Chevron":return 92;case"RightArrowCallout":return 93;case"DownArrowCallout":return 94;case"LeftArrowCallout":return 95;case"UpArrowCallout":return 96;case"LeftRightArrowCallout":return 97;case"QuadArrowCallout":return 98;case"CircularArrow":return 99;case"MathPlus":return 100;case"MathMinus":return 101;case"MathMultiply":return 102;case"MathDivision":return 103;case"MathEqual":return 104;case"MathNotEqual":return 105;case"Explosion1":return 106;case"Explosion2":return 107;case"Star4Point":return 108;case"Star5Point":return 109;case"Star6Point":return 110;case"Star7Point":return 111;case"Star8Point":return 112;case"Star10Point":return 113;case"Star12Point":return 114;case"Star16Point":return 115;case"Star24Point":return 116;case"Star32Point":return 117;case"UpRibbon":return 118;case"DownRibbon":return 119;case"CurvedUpRibbon":return 120;case"CurvedDownRibbon":return 121;case"VerticalScroll":return 122;case"HorizontalScroll":return 123;case"Wave":return 124;case"DoubleWave":return 125;case"SnipSingleCornerRectangle":return 126;case"SnipSameSideCornerRectangle":return 127;case"SnipDiagonalCornerRectangle":return 128;case"SnipAndRoundSingleCornerRectangle":return 129;case"RoundSingleCornerRectangle":return 130;case"RoundSameSideCornerRectangle":return 131;case"RoundDiagonalCornerRectangle":return 132;case"Unknown":return 133;case"ElbowConnector":return 134;case"CurvedConnector":return 135;default:return 0}},c.prototype.getFollowCharacterType=function(e){switch(e){case"Tab":return 0;case"Space":return 1;case"None":return 2}},c.prototype.destroy=function(){this.lists=void 0,this.images=void 0,this.endLine=void 0,this.startLine=void 0,this.endOffset=void 0,this.documentHelper=void 0};var tf=c;function c(e){this.startLine=void 0,this.endLine=void 0,this.endOffset=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.lists=void 0,this.images=void 0,this.document=void 0,this.writeInlineStyles=void 0,this.blockContent=!1,this.startContent=!1,this.multipleLineContent=!1,this.nestedContent=!1,this.editRangeId=-1,this.selectedCommentsId=[],this.selectedRevisionId=[],this.nestedBlockContent=!1,this.nestedBlockEnabled=!1,this.blocks=[],this.contentInline=[],this.isContentControl=!1,this.isBlockClosed=!0,this.isWriteInlinesFootNote=!1,this.isWriteEndFootNote=!1,this.iscontentInsert=!0,this.keywordIndex=void 0,this.isExport=!0,this.isWordExport=!1,this.isPartialExport=!1,this.checkboxOrDropdown=!1,this.copyWithTrackChange=!1,this.documentHelper=e}rf.prototype.getModuleName=function(){return"CollaborativeEditingHandler"},rf.prototype.updateRoomInfo=function(e,t,i){this.roomName=e,this.serviceUrl=i,this.version=t},rf.prototype.sendActionToServer=function(e){var t;!_.isNullOrUndefined(e)&&0===e.length||((t=this.pendingOps[this.pendingOps.length-1])&&this.checkAndCombineOperation(t,e)||this.pendingOps.push(e),this.isAcknowledgePending()||this.sendLocalOperation(),this.transformRemoteCursor(this.connectionId,e[0],e[0].offset))},rf.prototype.checkAndCombineOperation=function(e,t){if(1===e.length&&1===t.length){e=e[0],t=t[0];if(this.isSameOperation(e,t)&&this.canCombineOperation(e,t)){if("Insert"===e.action&&e.offset+e.length===t.offset||"Delete"===e.action&&e.offset===t.offset)return e.length+=t.length,e.text+=t.text,!0;if("Delete"===e.action&&t.offset+t.length===e.offset)return e.text=t.text+e.text,e.offset=t.offset,e.length+=t.length,!0}}return!1},rf.prototype.canCombineOperation=function(e,t){return e.format===t.format&&!this.isControlCharacter(e.text)&&!this.isControlCharacter(t.text)&&_.isNullOrUndefined(e.markerData)&&_.isNullOrUndefined(t.markerData)},rf.prototype.isSameOperation=function(e,t){return e.action===t.action},rf.prototype.isControlCharacter=function(e){return-1!==[L.Table,L.Row,L.Cell,L.Image,L.PageBreak,L.ColumnBreak,L.Section_Break,L.Table,L.Field_Separator,L.Marker_Start,L.Marker_End,L.Tab,L.LineBreak].indexOf(e)},rf.prototype.applyRemoteAction=function(e,t){switch(e){case"connectionId":this.connectionId=t;break;case"removeUser":this.removeCarets(t);break;case"action":this.dataReceived(t)}},rf.prototype.isAcknowledgePending=function(){return!_.isNullOrUndefined(this.acknowledgmentPending)},rf.prototype.handleAcknowledgementReceived=function(e){var t=this.getVersionDifference(e);1<t?this.checkAndRetriveChangesFromServer():(this.logMessage("Ack received: "+e.version),this.logMessage("Ack version diff: "+t),e.version>this.version&&(this.updateVersion(e.version),this.acknowledgementReceived(),this.sendLocalOperation()))},rf.prototype.updateVersion=function(e){e>this.version&&(this.version=e)},rf.prototype.acknowledgementReceived=function(){this.acknowledgmentPending=void 0},rf.prototype.sendLocalOperation=function(){var e,t,i,n=this;0<this.pendingOps.length&&(e=this.pendingOps.shift(),(t={}).currentUser=this.documentEditor.currentUser,t.roomName=this.roomName,t.connectionId=this.connectionId,t.version=this.version,this.acknowledgmentPending=t.operations=e,(i=new XMLHttpRequest).open("Post",this.serviceUrl+"UpdateAction",!0),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),this.setCustomAjaxHeaders(i),i.onreadystatechange=function(){var e;4===i.readyState&&(200===i.status||304===i.status?(e=JSON.parse(i.responseText),n.isSyncServerChanges||n.handleAcknowledgementReceived(e)):alert("Failed to save the changes"))},this.logMessage("Sent: "+JSON.stringify(t)),i.send(JSON.stringify(t)))},rf.prototype.dataReceived=function(e){var t;e.connectionId===this.connectionId&&!this.documentEditor.editor.isIncrementalSave||this.isSyncServerChanges?this.logMessage(this.isSyncServerChanges?"SignalR Server sync"+e.version:"SignalR Same user sync:"+e.version):(t=this.getVersionDifference(e))<=0&&!this.documentEditor.editor.isIncrementalSave?this.logMessage("SignalR return diff:<=0"+e.version):1<t&&!this.documentEditor.editor.isIncrementalSave?(this.logMessage("SignalR return diff:>=1"+e.version),this.checkAndRetriveChangesFromServer()):(this.logMessage("SignalR ack: "+e.version),this.logMessage("Received: "+JSON.stringify(e)),this.handleRemoteOperation(e))},rf.prototype.getVersionDifference=function(e){return e.version-this.version},rf.prototype.handleRemoteOperation=function(e){this.documentEditor.editorModule.isRemoteAction=!0;var t=this.documentEditor.selectionModule.getAbsolutePositionFromRelativePosition(this.documentEditor.selectionModule.start),i=this.documentEditor.selectionModule.getAbsolutePositionFromRelativePosition(this.documentEditor.selectionModule.end)-t;_.isNullOrUndefined(this.acknowledgmentPending)||(this.logMessage("Acknowledge transform:"+this.acknowledgmentPending[0].text+"version:"+e.version),this.transform([this.acknowledgmentPending],e.operations)),0<this.pendingOps.length&&this.logMessage("Pending transform:"+this.pendingOps.length+"version:"+e.version),this.transform(this.pendingOps,e.operations),this.applyRemoteOperation(e,t,i),this.updateVersion(e.version),this.documentEditor.editorModule.isRemoteAction=!1,this.documentEditor.editorHistoryModule.canUndo()&&(this.documentEditor.editorHistoryModule.undoStack.length=0),this.documentEditor.editorHistoryModule.canRedo()&&(this.documentEditor.editorHistoryModule.redoStack.length=0)},rf.prototype.transform=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];if(0<e.length)for(var r=0;r<e.length;r++)for(var o=0;o<e[r].length;o++){var s=e[r][o],a=(this.transformSelectionOperation(s,n),n.offset);this.transformOperation(s,n,t),this.logMessage("Transformed offset:"+(n.offset-a))}}},rf.prototype.skipAction=function(e){for(var t=0;t<e.length;t++){var i=e[t];i.length=0,i.skipOperation=!0}},rf.prototype.applyRemoteOperation=function(e,t,i){var n,r=this.documentEditor.currentUser,o=this.documentEditor.commentReviewPane.commentPane.isEditMode,s=this.documentEditor.editorHistoryModule.lastOperation;_.isNullOrUndefined(this.documentEditor.commentReviewPane.commentPane.currentEditingComment)||(n=this.documentEditor.commentReviewPane.commentPane.currentEditingComment.textArea);for(var a,l=0;l<e.operations.length;l++){var d=e.operations[l].markerData,h=void 0,c=this.documentEditor.enableTrackChanges;if(_.isNullOrUndefined(d)||_.isNullOrUndefined(d.author)||(this.documentEditor.currentUser=d.author),!_.isNullOrUndefined(d)&&!_.isNullOrUndefined(d.isSkipTracking)&&d.isSkipTracking&&this.documentEditor.enableTrackChanges&&(this.documentEditor.skipSettingsOps=!0,this.documentEditor.enableTrackChanges=!1),!(e.operations[l].skipOperation||!_.isNullOrUndefined(e.operations[l].markerData)&&e.operations[l].markerData.skipOperation))if("Update"===e.operations[l].action)_.isNullOrUndefined(e.operations[l].styleData)||(v=JSON.parse(e.operations[l].styleData),this.documentEditor.editor.updateStyleObject(v));else{var p,u,g,m,f,y,v=this.getRelativePositionFromAbsolutePosition(e.operations[l].offset,!1,!1,!1),w=e.operations[l],b=v;if(_.isNullOrUndefined(e.operations[l].action))this.documentSettings(e.operations[l]);else if("Delete"!==e.operations[l].action&&"Format"!==e.operations[l].action||("Format"===w.action&&0===w.length||(this.documentEditor.selectionModule.isEndOffset=!0),b=this.getRelativePositionFromAbsolutePosition(e.operations[l].offset+e.operations[l].length,!1,!1,!1),this.documentEditor.selectionModule.isEndOffset=!1),("Insert"===w.action&&w.text!==L.Row&&w.text!==L.Cell&&(_.isNullOrUndefined(w.markerData)||_.isNullOrUndefined(w.markerData.isAcceptOrReject))||"Delete"===w.action&&w.text!==L.Cell&&(_.isNullOrUndefined(w.markerData)||_.isNullOrUndefined(w.markerData.isAcceptOrReject))||"Format"===w.action&&(_.isNullOrUndefined(w.markerData)||_.isNullOrUndefined(w.markerData.isAcceptOrReject)))&&this.documentEditor.selectionModule.select(v,b),_.isNullOrUndefined(w.markerData)||(_.isNullOrUndefined(w.markerData.revisionForFootnoteEndnoteContent)&&_.isNullOrUndefined(w.markerData.revisionId)||(this.documentEditor.editorModule.revisionData=[]),_.isNullOrUndefined(w.markerData.revisionForFootnoteEndnoteContent)||this.documentEditor.editorModule.revisionData.push(w.markerData.revisionForFootnoteEndnoteContent),_.isNullOrUndefined(w.markerData.revisionId)||this.documentEditor.editorModule.revisionData.push(w.markerData),!_.isNullOrUndefined(w.markerData.splittedRevisions)&&0<w.markerData.splittedRevisions.length&&(this.documentEditor.editorModule.revisionData=this.documentEditor.editorModule.revisionData.concat(w.markerData.splittedRevisions))),_.isNullOrUndefined(w.markerData)||_.isNullOrUndefined(w.markerData.isAcceptOrReject)||""===w.markerData.isAcceptOrReject){if("Insert"===w.action)if("Paste"===w.type)this.documentEditor.editorModule.isPasteListUpdated=!1,this.documentEditor.editorModule.pasteContents(j.getSfdtDocument(w.pasteContent));else if("PasteToc"===w.type)this.documentEditor.editorModule.isInsertingTOC=!0,this.documentEditor.editorModule.pasteContents(j.getSfdtDocument(w.pasteContent)),this.documentEditor.editorModule.isInsertingTOC=!1;else if(w.text===L.Image.toString())this.insertImage(w.imageData);else if(w.text===L.Section_Break.toString()&&"NewPage"===w.type)this.documentEditor.editorModule.insertSectionBreak();else if(w.text===L.Section_Break.toString()&&"Continuous"===w.type)this.documentEditor.editorModule.insertSectionBreak(V.SectionBreakType.Continuous);else if(!d||w.text!==L.Marker_Start&&w.text!==L.Marker_End&&w.text!==L.Field_Separator)d&&!_.isNullOrUndefined(d.dropDownIndex)&&"DropDown"===w.type?(I=this.documentEditor.selectionModule.start.currentWidget.getInline(this.documentEditor.selectionModule.start.offset,0).element)instanceof Z&&this.documentEditor.editorModule.updateFormField(I,d.dropDownIndex,!1):w.text===L.Section_Break.toString()&&"NewPage"===w.type?this.documentEditor.editorModule.insertSectionBreak():w.text===L.Section_Break.toString()&&"Continuous"===w.type?this.documentEditor.editorModule.insertSectionBreak(V.SectionBreakType.Continuous):w.text===L.Table?(l=e.operations.length,this.buildTable(e.operations),h=this.getOperationLength(e.operations)):w.text===L.Row?(l=e.operations.length,_.isNullOrUndefined(w.format)&&e.operations.reverse(),this.buildRow(e.operations),h=this.getOperationLength(e.operations)):w.text===L.Cell?(x=b=void 0,"CellFormat"===w.type&&(0<w.length&&(b=e.operations[l-1].format,x=e.operations[l-2].format),this.buildCell(w,b,x))):w.text===L.PageBreak.toString()?this.documentEditor.editorModule.insertPageBreak():w.text===L.ColumnBreak.toString()?this.documentEditor.editorModule.insertColumnBreak():(w.format&&(C=new B,b=JSON.parse(w.format),this.documentEditor.parser.parseCharacterFormat(0,b,C),this.documentEditor.selectionModule.characterFormat.copyFormat(C)),this.documentEditor.editorModule.insertText(w.text));else{var x,C,I,k,F,P,T,S=void 0;if(d.type&&"Bookmark"===d.type)w.text===L.Marker_Start?(S=this.documentEditor.editorModule.createBookmarkElements(d.bookmarkName)[0],this.documentEditor.documentHelper.isBookmarkInserted=!1,this.documentEditor.editorModule.insertElementsInternal(this.documentEditor.selectionModule.start,[S])):this.documentEditor.documentHelper.bookmarks.containsKey(d.bookmarkName)&&(x=this.documentEditor.documentHelper.bookmarks.get(d.bookmarkName))&&(S=x.reference,this.documentEditor.documentHelper.isBookmarkInserted=!0,this.documentEditor.editorModule.insertElementsInternal(this.documentEditor.selectionModule.start,[S]),this.documentEditor.selectionModule.selectBookmark(d.bookmarkName),x.properties=this.documentEditor.selectionModule.getBookmarkProperties(x),S.properties=this.documentEditor.selectionModule.getBookmarkProperties(S));else if(d.type&&"EditRange"===d.type){var b=d.user,H=d.editRangeId;if(w.text===L.Marker_Start)this.documentEditor.documentHelper.restrictEditingPane&&this.documentEditor.documentHelper.restrictEditingPane.addUserDialog.bindListData(b),(S=this.documentEditor.editorModule.addEditElement(b,H)).columnFirst=parseInt(d.columnFirst),S.columnLast=parseInt(d.columnLast),S.line=this.documentEditor.selectionModule.start.currentWidget;else for(var N=0,W=this.documentEditor.documentHelper.editRanges.get(b);N<W.length;N++){var O=W[N];if(O.editRangeId===H){(S=O.editRangeEnd).line=this.documentEditor.selectionModule.start.currentWidget;break}}this.documentEditor.editorModule.insertElementsInternal(this.documentEditor.selectionModule.start,[S]),this.documentEditor.editorModule.fireContentChange()}else d.type&&"Field"===d.type?(this.documentEditor.editor.isFieldOperation=!0,b=w.text===L.Marker_Start?0:w.text===L.Marker_End?1:w.text===L.Field_Separator?2:void 0,!_.isNullOrUndefined(b)&&_.isNullOrUndefined(d.checkBoxValue)?(T=new Z(b),0!==b||_.isNullOrUndefined(d.formFieldData)||(b=this.documentEditor.editor.getFormFieldData(w.type),this.documentEditor.parser.parseFormFieldData(0,JSON.parse(d.formFieldData),b),T.formFieldData=b),C=new B,w.format&&(b=JSON.parse(w.format),this.documentEditor.parser.parseCharacterFormat(0,b,C)),T.characterFormat.copyFormat(C),this.documentEditor.editorModule.initInsertInline(T)):(I=this.documentEditor.selectionModule.start.currentWidget.getInline(this.documentEditor.selectionModule.start.offset,0).element)instanceof Z&&this.documentEditor.editorModule.toggleCheckBoxFormField(I,!0,d.checkBoxValue)):_.isNullOrUndefined(d)||_.isNullOrUndefined(d.commentId)?_.isNullOrUndefined(w.markerData.type)||"Footnote"!==w.markerData.type&&"Endnote"!==w.markerData.type||("Footnote"===w.markerData.type?this.documentEditor.editorModule.insertFootnote():"Endnote"===w.markerData.type&&this.documentEditor.editorModule.insertEndnote()):(k=w.text===L.Marker_Start?0:1,F=this.documentEditor.documentHelper.layout.getCommentById(this.deletedComments,d.commentId),b=void 0,_.isNullOrUndefined(F)&&(F=this.documentEditor.documentHelper.layout.getCommentById(this.documentEditor.documentHelper.comments,d.commentId),_.isNullOrUndefined(F))&&!_.isNullOrUndefined(d.ownerCommentId)&&(b=this.documentEditor.documentHelper.layout.getCommentById(this.documentEditor.documentHelper.comments,d.ownerCommentId),F=this.documentEditor.documentHelper.layout.getCommentById(b.replyComments,d.commentId)),_.isNullOrUndefined(F)?((P=new up(k)).commentId=d.commentId,this.documentEditor.editorModule.insertElementsInternal(this.documentEditor.selectionModule.start,[P]),(0===k?this.commentsStart:this.commentsEnd).push(P)):((P=new up(k)).commentId=d.commentId,this.documentEditor.editorModule.insertElementsInternal(this.documentEditor.selectionModule.start,[P]),P.comment=F,T=this.documentEditor.selectionModule.start.currentWidget.children.indexOf(P),F.commentStart=this.documentEditor.selectionModule.start.currentWidget.children[T]))}else if("Delete"===w.action)w.text===L.Marker_Start||w.text===L.Marker_End?_.isNullOrUndefined(d)||_.isNullOrUndefined(d.commentId)?(b=(p=this.documentEditor.selectionModule).start.offset-1,this.documentEditor.editorModule.removeAtOffset(p.start.currentWidget,this.documentEditor.selectionModule,b)):(p=this.documentEditor.selectionModule,k=w.text===L.Marker_Start?0:1,F=void 0,this.documentEditor.selection.getElementInfo(this.documentEditor.selection.end.currentWidget,this.documentEditor.selection.end.offset).element instanceof up&&(F=this.documentEditor.selection.getElementInfo(this.documentEditor.selection.end.currentWidget,this.documentEditor.selection.end.offset).element),1===k?-1!==F.indexInOwner&&this.documentEditor.editorModule.removeAtOffset(p.start.currentWidget,this.documentEditor.selectionModule,p.start.offset):(-1!==(d=F).indexInOwner&&this.documentEditor.editorModule.removeAtOffset(p.start.currentWidget,this.documentEditor.selectionModule,p.start.offset),d.removeCommentMark())):w.text===L.Cell?this.buildDeleteCells(w):this.documentEditor.editorModule.onBackSpace();else if("Format"===w.action)if(w.text===L.Marker_Start.toString()+L.Marker_End.toString())this.updateOperation(w);else if(_.isNullOrUndefined(w.markerData)||_.isNullOrUndefined(w.markerData.revisionId))w.text===L.Row?(b=this.getRelativePositionFromAbsolutePosition(w.offset,!1,!0,!1),_.isNullOrUndefined(b.rowWidget)||(u=b.rowWidget.ownerTable,g=JSON.parse(w.format),this.documentEditor.documentHelper.owner.parser.parseRowFormat(g,b.rowWidget.rowFormat,0),u.calculateGrid(!1),this.documentEditor.documentHelper.layout.reLayoutTable(u))):w.text===L.Cell?("TableFormat"===w.type&&(d=this.getRelativePositionFromAbsolutePosition(w.offset,!0,!1,!1),u=JSON.parse(w.format),this.documentEditor.documentHelper.owner.parser.parseTableFormat(u,d.tableWidget.tableFormat,0),d.tableWidget.calculateGrid(!1),this.documentEditor.documentHelper.layout.reLayoutTable(d.tableWidget)),"RowFormat"===w.type&&(g=this.getRelativePositionFromAbsolutePosition(w.offset,!1,!0,!1),E=JSON.parse(w.format),this.documentEditor.documentHelper.owner.parser.parseRowFormat(E,g.rowWidget.rowFormat,0)),"CellFormat"===w.type&&(b=this.getRelativePositionFromAbsolutePosition(w.offset,!1,!1,!0),d=JSON.parse(w.format),this.documentEditor.documentHelper.owner.parser.parseCellFormat(d,b.cellWidget.cellFormat,0))):w.text===L.Image?(I=this.documentEditor.selectionModule.end.currentWidget.getInline(this.documentEditor.selectionModule.end.offset,0).element)instanceof Ic&&this.documentEditor.editorModule.onImageFormat(I,j.convertPointToPixel(w.imageData.width),j.convertPointToPixel(w.imageData.height),w.imageData.alternativeText):"ListFormat"===w.type?(m=JSON.parse(w.format),f=new Xa(void 0),this.documentEditor.parser.parseParagraphFormat(0,m,f),this.updateList(w,f),y=this.documentEditor.documentHelper.getListById(m.listFormat.nsid,!0),_.isNullOrUndefined(y)||(f.listFormat.listId=y.listId,f.listFormat.list=y),this.documentEditor.editorModule.onApplyParagraphFormat(w.text,f.listFormat,!1,!1)):"RestartNumbering"===w.type?(d=this.updateList(w),y=this.documentEditor.documentHelper.getListById(d,!0),this.documentEditor.editorModule.restartListAtInternal(this.documentEditor.selectionModule,y.listId,y.nsid)):"ContinueNumbering"===w.type?(m=JSON.parse(w.format),f=new Xa(void 0),this.documentEditor.parser.parseParagraphFormat(0,m,f),y=this.documentEditor.documentHelper.getListById(f.listFormat.nsid,!0),_.isNullOrUndefined(y)||(f.listFormat.listId=y.listId,f.listFormat.list=y),this.documentEditor.editorModule.applyContinueNumberingInternal(this.documentEditor.selectionModule,f)):"CharacterFormat"===w.type?this.insertCharaterFormat(w.type,w.format):"ParagraphFormat"===w.type?this.insertParagraphFormat(w,w.format):"TableFormat"===w.type?this.insertTableFormat(w.text,w.format,w.offset):"SectionFormat"===w.type?this.insertSectionFormat(w.text,w.format):"RowFormat"===w.type?this.insertRowFormat(w.text,w.format):"CellFormat"===w.type&&this.insertCellFormat(w.format);else if(!_.isNullOrUndefined(w.markerData.revisionType)&&"Deletion"===w.markerData.revisionType){if(w.text===L.Row){b=this.getRelativePositionFromAbsolutePosition(w.offset,!1,!0,!1);if(!_.isNullOrUndefined(b.rowWidget)){var E=b.rowWidget;this.documentEditor.editorModule.trackRowDeletion(E),this.documentEditor.trackChangesPane.updateTrackChanges();continue}}this.documentEditor.editorModule.onBackSpace()}this.documentEditor.editor.revisionData=void 0,this.documentEditor.enableTrackChanges!=c&&(this.documentEditor.skipSettingsOps=!0,this.documentEditor.enableTrackChanges=c),this.documentEditor.currentUser=r;d=this.documentEditor.selectionModule.startOffset,c=(this.updateRemoteSelection(e,this.documentEditor.selectionModule.getAbsolutePositionFromRelativePosition(d)),_.isNullOrUndefined(h)||(b=w.length,w.length=h,h=b),this.transformSection(w.action,w,t)[1]),d=this.transformSection(w.action,w,t+i)[1];this.documentEditor.selectionModule.select(this.getRelativePositionFromAbsolutePosition(t=c,!1,!1,!1),this.getRelativePositionFromAbsolutePosition(d,!1,!1,!1)),_.isNullOrUndefined(h)||(w.length=h),this.transformRemoteCursor(e.connectionId,w,w.offset),!_.isNullOrUndefined(this.documentEditor.searchModule)&&!_.isNullOrUndefined(this.documentEditor.optionsPaneModule)&&0<this.documentEditor.searchModule.searchResults.length&&this.documentEditor.optionsPaneModule.isOptionsPaneShow&&this.documentEditor.optionsPaneModule.searchIconClickInternal()}else{b=this.documentEditor.editorModule.getRevision(w.markerData.revisionId);b&&("Accept"===w.markerData.isAcceptOrReject?b.accept():"Reject"===w.markerData.isAcceptOrReject&&b.reject())}}}this.documentEditor.editor.isFieldOperation&&(this.documentEditor.editorModule.layoutWholeDocument(),this.documentEditor.editor.isFieldOperation=!1),_.isNullOrUndefined(this.rowWidget)||((a=this.rowWidget.ownerTable.combineWidget(this.documentEditor.viewer)).updateRowIndex(0),a.calculateGrid(!0),this.documentEditor.documentHelper.layout.reLayoutTable(a),this.documentEditor.editorModule.reLayout(this.documentEditor.selectionModule),this.rowWidget=void 0),_.isNullOrUndefined(this.table)||(this.table.calculateGrid(),this.documentEditor.editorModule.updateTable(this.table),this.documentEditor.editorModule.reLayout(this.documentEditor.selectionModule,!0),this.table=void 0),this.documentEditor.currentUser=r,this.documentEditor.commentReviewPane.commentPane.isEditMode=o,this.documentEditor.editorHistoryModule.lastOperation=s,_.isNullOrUndefined(this.documentEditor.commentReviewPane.commentPane.currentEditingComment)||(this.documentEditor.commentReviewPane.commentPane.currentEditingComment.textArea=n)},rf.prototype.updateOperation=function(e){var t=e.markerData;if(e.text===L.Marker_Start.toString()+L.Marker_End.toString()){var i,n,r,o,s=void 0;if(this.documentEditor.selection.getElementInfo(this.documentEditor.selection.end.currentWidget,this.documentEditor.selection.end.offset).element instanceof up&&0<e.offset&&(e=this.documentEditor.selection.getElementInfo(this.documentEditor.selection.end.currentWidget,this.documentEditor.selection.end.offset).element.commentId,s=this.getComment(e)),!_.isNullOrUndefined(s)&&(_.isNullOrUndefined(t.done)||!_.isNullOrUndefined(t.date))&&_.isNullOrUndefined(t.isReply))if(s.text!==t.text)return(i=this.documentEditor.commentReviewPane.commentPane.comments.get(s)).commentText.innerText=t.text,void(s.text=t.text);_.isNullOrUndefined(s)?((n=new fp(t.date)).commentId=t.commentId,r=this.getObjectByCommentId(this.commentsStart,n.commentId),o=this.getObjectByCommentId(this.commentsEnd,n.commentId),_.isNullOrUndefined(r)||_.isNullOrUndefined(o)||(this.documentEditor.editorModule.updateCommentElement(n,r,o,t),this.documentEditor.editorModule.addCommentWidget(n,!0,!0,!1),this.commentsStart.splice(this.commentsStart.indexOf(r),1),this.commentsEnd.splice(this.commentsEnd.indexOf(o),1),this.documentEditor.commentReviewPane.commentPane.comments.get(n).postComment())):!_.isNullOrUndefined(t.done)&&_.isNullOrUndefined(t.commentAction)?t.done?this.documentEditor.editorModule.resolveComment(s):this.documentEditor.editorModule.reopenComment(s):"remove"===t.commentAction?((i=this.documentEditor.commentReviewPane.commentPane.comments.get(_.isNullOrUndefined(void 0)?s:void 0)).showDrawer(),this.documentEditor.editorModule.deleteCommentWidget(s),this.deletedComments.push(s),i.hideDrawer()):((n=new fp(t.date)).commentId=t.commentId,r=this.getObjectByCommentId(this.commentsStart,n.commentId),o=this.getObjectByCommentId(this.commentsEnd,n.commentId),_.isNullOrUndefined(r)||_.isNullOrUndefined(o)||(this.documentEditor.editorModule.updateCommentElement(n,r,o,t),(n.ownerComment=s).replyComments.splice(t.commentIndex,0,n),this.documentEditor.commentReviewPane.addReply(n,!1,!1)))}},rf.prototype.getComment=function(e){for(var t=this.documentEditor.documentHelper.comments,i=0;i<t.length;i++){var n=this.documentEditor.documentHelper.layout.getCommentById(t,e);if(!_.isNullOrUndefined(n))return n;for(var r=0;r<t[i].replyComments.length;r++){var o=this.documentEditor.documentHelper.layout.getCommentById(t[i].replyComments,e);if(!_.isNullOrUndefined(o))return o}}return null},rf.prototype.updateList=function(e,t){var i=-1;if(e.listData){e=JSON.parse(e.listData);if(e.hasOwnProperty("optimizeSfdt")&&(this.documentEditor.parser.keywordIndex=e.optimizeSfdt?1:0),_.isNullOrUndefined(t))e.hasOwnProperty(Es)&&(i=e[Es]),this.updateListCollection(e,this.documentEditor.parser.keywordIndex);else{var n=this.documentEditor.documentHelper.getListById(t.listFormat.nsid,!0);if(_.isNullOrUndefined(n))this.updateListCollection(e,this.documentEditor.parser.keywordIndex);else{var r=[];if(this.documentEditor.parser.parseAbstractList(e,r),!_.isNullOrUndefined(n.abstractList)&&n.abstractList.levels.length<t.listFormat.listLevelNumber){n.abstractList.levels=[];for(var o=0;o<r[0].levels.length;o++)n.abstractList.levels.push(r[0].levels[o])}}}}return i},rf.prototype.getOperationLength=function(e){for(var t=0,i=0;i<e.length;i++)e[parseInt(i.toString(),10)].text!==L.Table&&e[parseInt(i.toString(),10)].text!==L.Row&&e[parseInt(i.toString(),10)].text!==L.Cell||(t+=e[parseInt(i.toString(),10)].length);return t},rf.prototype.updateListCollection=function(i,n){for(var r=this.documentEditor.editorModule.getUniqueListOrAbstractListId(!0),o=this.documentEditor.editorModule.getUniqueListOrAbstractListId(!1),e=0;e<i[Ue[n]].length;e++)!function(e){var t=i[Ue[n]][e],e=i[Ve[n]].filter(function(e){return e[Os[n]]===t[Os[n]]})[0];_.isNullOrUndefined(e)||(e[Os[n]]=o,t[Ut[n]]=r,t[Os[n]]=o,r++,o++)}(e);this.documentEditor.parser.parseAbstractList(i,this.documentEditor.documentHelper.abstractLists),this.documentEditor.parser.parseList(i,this.documentEditor.documentHelper.lists)},rf.prototype.getObjectByCommentId=function(e,t){for(var i=0,n=e;i<n.length;i++){var r=n[i];if(r.commentId===t)return r}},rf.prototype.transformOperation=function(e,t,i){if("Insert"!==e.action||"Insert"!==t.action&&"Format"!==t.action)if("Delete"!==e.action||"Delete"!==t.action&&"Format"!==t.action)if("Insert"!==e.action||"Delete"!==t.action&&"Format"!==t.action){if("Delete"===e.action&&("Insert"===t.action||"Format"===t.action))if(e.offset<=t.offset&&e.offset+e.length<=t.offset)t.offset=t.offset-e.length;else if(e.offset<t.offset&&e.offset+e.length>=t.offset+t.length)if(_.isNullOrUndefined(t.markerData)||_.isNullOrUndefined(t.markerData.type)||"Field"===t.markerData.type||t.text!==L.Marker_End&&t.text!==L.Marker_Start)t.length=0,t.skipOperation=!0,_.isNullOrUndefined(t.markerData)||_.isNullOrUndefined(t.markerData.type)||"Field"!==t.markerData.type||t.text!==L.Marker_Start&&t.text!==L.Marker_End||this.skipAction(i);else{if(!_.isNullOrUndefined(t.markerData.commentId)&&t.text===L.Marker_End)return this.skipAction(i),[e,t];var n=t.offset-e.offset;t.offset-=n}else e.offset<=t.offset&&"Insert"==t.action&&e.offset+e.length>=t.offset?this.skipAction(i):e.offset>t.offset&&"Format"!==t.action&&(e.offset=e.offset+t.length)}else{if(e.offset<=t.offset)return t.offset=t.offset+e.length,[e,t];if(e.offset>=t.offset+t.length&&"Format"!==t.action)return e.offset=e.offset-t.length,[e,t];e.offset>t.offset&&e.offset<t.offset+t.length&&(t.length+=e.length)}else{if(e.offset<t.offset)return t.offset=t.offset-e.length,[e,t];if(e.offset>t.offset&&"Format"!==t.action)e.offset=e.offset-t.length}else{if(e.offset<t.offset)return t.offset=t.offset+e.length,[e,t];if(e.offset>=t.offset&&"Format"!==t.action)e.offset=e.offset+t.length}return[e,t]},rf.prototype.transformSection=function(e,t,i){if("Insert"===e){if(t.offset<i)return[t.offset,i+t.length]}else if("Delete"===e&&t.offset<=i)return[t.offset,i-t.length];return[t.offset,i]},rf.prototype.transformRemoteCursor=function(e,t,i){this.documentEditor.editorModule.isIncrementalSave||this.updateCaretPosition(e,t)},rf.prototype.updateCaretPosition=function(e,t){for(var i=Object.keys(this.userMap),n=0;n<i.length;n++){var r,o,s=i[n];s!==e&&(_.isNullOrUndefined(t)?o=this.userMap[s].offset:(r=this.userMap[s].offset,o=this.transformSection(t.action,t,r)[1],this.userMap[s].offset=o),this.updateCaretPositionInteral(this.userMap[s].caret,o))}},rf.prototype.updateRemoteSelection=function(e,t){var i,n;this.documentEditor.editorModule.isIncrementalSave||e.connectionId&&(i="",(n=void 0)!==this.userMap[e.connectionId]?(i=this.userMap[e.connectionId].color,n=this.userMap[e.connectionId].caret):(i=this.getColorForMember(100*Math.random()),n=_.createElement("div",{className:"e-de-blink-cursor",styles:"position:absolute;border-left: 2px solid "+i}),this.userMap[e.connectionId]=new of(i,n,t,e.currentUser)),this.userMap[e.connectionId].offset=t,this.updateCaretPositionInteral(n,t))},rf.prototype.removeCarets=function(e){void 0!==this.userMap[e]&&(this.userMap[e].caret.remove(),delete this.userMap[e])},rf.prototype.getColorForMember=function(e){return"hsl("+360*(e%20)/7%360+", 100%, 35%)"},rf.prototype.updateCaretPositionInteral=function(e,t){var i,n=this.documentEditor.zoomFactor,r=this.documentEditor.selectionModule,t=r.getTextPosBasedOnLogicalIndex(this.getRelativePositionFromAbsolutePosition(t,!1,!1,!1)),o=t.location,s=(e.style.display="block",e.parentElement||this.documentEditor.documentHelper.viewerContainer.appendChild(e),r.getSelectionPage(t));s&&(e.style.left=s.boundingRectangle.x+Math.round(o.x)*n+"px",i=(t=r.updateCaretSize(t)).topMargin,e.style.height=t.height*n+"px",t=r.getPageTop(s),e.style.top=t+Math.round(o.y+i)*n+"px","Subscript"===r.characterFormat.baselineAlignment)&&(e.style.top=parseFloat(e.style.top)+parseFloat(e.style.height)/2+"px")},rf.prototype.getBlockPosition=function(e,t,i,n,r,o,s){var a;if(i instanceof G){var l=this.getBlockTotalLength(e,t,i,n,r,o,s);if(n.done)return n.done=!0,l;t=l.currentLength,e=l.offset,a=l.paragraph}else if(i instanceof K){if(--e===t&&(r||this.documentEditor.selectionModule.isEndOffset))return n.done=!0,{offset:e,currentLength:t,paragraph:a,tableWidget:i};for(var d=i.firstChild;d;){if(--e===t){if(o||this.documentEditor.selectionModule.isEndOffset)return n.done=!0,{offset:e,currentLength:t,paragraph:a,rowOrCellIndex:d.index,rowWidget:d};if(s)return n.done=!0,{offset:e,currentLength:t,paragraph:a,rowOrCellIndex:(u=a.associatedCell).cellIndex+1,cellWidget:u}}for(var h=d.firstChild;h;){if(--e===t)if(s)return n.done=!0,{offset:e,currentLength:t,paragraph:a,rowOrCellIndex:h.cellIndex,cellWidget:h};for(var c=h.firstChild;c;){var p,u,g=this.getBlockPosition(e,t,c,n,r,o,s);if(n.done)return o&&_.isNullOrUndefined(g.rowWidget)?(n.done=!0,{offset:e,currentLength:t,paragraph:a,rowOrCellIndex:(p=h.ownerRow).index+1,rowWidget:p}):s&&_.isNullOrUndefined(g.cellWidget)?(n.done=!0,{offset:e,currentLength:t,paragraph:a,rowOrCellIndex:(u=h).cellIndex+1,cellWidget:u}):g;e=g.offset,t=g.currentLength,a=g.paragraph,c=c.getSplitWidgets().pop().nextRenderedWidget}h=h.nextWidget}var m=d.ownerTable.index;(d=d.getSplitWidgets().pop().nextRenderedWidget)&&d.ownerTable.index!==m&&(d=void 0)}}return{offset:e,currentLength:t,paragraph:a}},rf.prototype.getBlockTotalLength=function(e,t,i,n,r,o,s){var a=i.getSplitWidgets(),l=0;if(e<=t+1)return n.done=!0,{offset:e-1,currentLength:t,paragraph:i};for(var d=0,h=0;h<a.length;h++)for(var c=0;c<a[h].childWidgets.length;c++)for(var p=a[h].childWidgets[c],u=0;u<p.children.length;u++){var g=p.children[u];if(!(g instanceof Y)){if(g instanceof uc&&!_.isNullOrUndefined(g.textFrame)&&0<g.textFrame.childWidgets.length||g instanceof Bh){var m=void 0;if(g instanceof uc)for(var f=t+d+l+1,y=0;y<g.textFrame.childWidgets.length;y++)f=(m=this.getBlockPosition(e,f,g.textFrame.childWidgets[y],n,r,o,s)).currentLength,e=m.offset;else for(var f=t+d+l+1,v=0;v<g.bodyWidget.childWidgets.length&&!n.done;v++)f=(m=this.getBlockPosition(e,f,g.bodyWidget.childWidgets[v],n,r,o,s)).currentLength,e=m.offset;if(e=m.offset,d+=m.currentLength-(t+l+1+d),n.done)return t=m.currentLength,m}if(l+=g.length,(e+=g.skipformFieldLength?g.length:0)<=t+d+l+1)return n.done=!0,{offset:e-1,currentLength:t+d,paragraph:i}}}return t+d+l+1+1==e&&this.documentEditor.selection.isEndOffset&&!this.documentEditor.selection.isFootEndNoteParagraph(i)?(n.done=!0,{offset:e-1,currentLength:t+d,paragraph:i}):{offset:e,currentLength:t+=l+d+1,paragraph:i}},rf.prototype.getRelativePositionFromAbsolutePosition=function(e,t,i,n){var r,o,s=this.documentEditor,a=this.documentEditor.documentHelper.pages[0].bodyWidgets[0].childWidgets[0],l=0,d={done:!1},a=this.getBlockByIndex(a,e,0,d,t,i,n);return d.done?(r=a.offset-a.currentLength,o={paragraph:a.paragraph,offset:r=r<0?0:r},t||i||n?a:s.selectionModule.getHierarchicalIndex(o.paragraph,o.offset.toString())):a.offset===a.currentLength+1&&this.documentEditor.selection.isEndOffset?(e=this.documentEditor.selection.getParagraphLength(a.paragraph),l=a.currentLength-e,s.selection.getHierarchicalIndex(a.paragraph,(a.offset-l).toString())):(e=this.getBlockIndexFromHeaderFooter(a.offset,a.currentLength,d,t,i,n),d.done?(r=e.offset-e.currentLength,o={paragraph:e.paragraph,offset:r=r<0?0:r},t||i||n?e:s.selectionModule.getHierarchicalIndex(o.paragraph,o.offset.toString())):"")},rf.prototype.getBlockIndexFromHeaderFooter=function(e,t,i,n,r,o){for(var s,a=0,l=this.documentEditor.documentHelper.headersFooters;a<l.length;a++)for(var d=l[a],h=0;h<6;h++){var c=d[h];if(c){if(t=(s=this.getBlockByIndex(c.childWidgets[0],e,t,i,n,r,o)).currentLength,e=s.offset,i.done)return s}else{if(e<=t+1)return i.done=!0,s;t++,s.currentLength=t}}return s},rf.prototype.getBlockByIndex=function(e,t,i,n,r,o,s){var a;do{if(i=(a=this.getBlockPosition(t,i,e,n,r,o,s)).currentLength,t=a.offset,n.done)return a}while(e=e.getSplitWidgets().pop().nextRenderedWidget);return a},rf.prototype.insertImage=function(e){_.isNullOrUndefined(e.metaString)?this.documentEditor.editorModule.insertImageInternal(e.imageString,!0,j.convertPointToPixel(e.width),j.convertPointToPixel(e.height),e.alternativeText):(this.documentEditor.editorModule.isImageInsert=!0,this.documentEditor.editorModule.insertImageInternal(e.metaString,!0,j.convertPointToPixel(e.width),j.convertPointToPixel(e.height),e.alternativeText))},rf.prototype.buildTable=function(e){for(var t=0,i=0,n=0;n<e.length;n++)e[n].text===L.Row&&(_.isNullOrUndefined(e[n].markerData)||(_.isNullOrUndefined(this.documentEditor.editorModule.revisionData)&&(this.documentEditor.editorModule.revisionData=[]),this.documentEditor.editorModule.revisionData.push(e[n].markerData)),t++);for(n=0;n<e.length&&(e[n].text===L.Cell&&(n+=2,i++),e[n].text===L.Table||!_.isNullOrUndefined(e[n+1])&&e[n+1].text!==L.Row);n++);this.documentEditor.editorModule.insertTable(t,i),this.documentEditor.editorModule.revisionData=void 0},rf.prototype.buildRow=function(e){var t,i=[],n=[],r=[],o=0,s=0,a=this.getRelativePositionFromAbsolutePosition(e[0].offset,!1,!0,!1),l=a.rowWidget.ownerTable.combineWidget(this.documentEditor.viewer);if(!_.isNullOrUndefined(e[0].markerData)&&_.isNullOrUndefined(e[0].format)){var d=a.rowWidget;if(0<d.rowFormat.revisions.length)return void d.rowFormat.revisions[0].accept()}for(var h=0;h<e.length;h++){var c=e[h];if(c.text===L.Cell&&(o++,i.push(JSON.parse(c.format)),n.push(JSON.parse(e[h+1].format)),r.push(JSON.parse(e[h+2].format)),h+=2),_.isNullOrUndefined(e[h+1])||e[h+1].text===L.Row)break}for(h=0;h<e.length;h++)e[h].text===L.Row&&(_.isNullOrUndefined(e[h].markerData)||(_.isNullOrUndefined(this.documentEditor.editorModule.revisionData)&&(this.documentEditor.editorModule.revisionData=[]),this.documentEditor.editorModule.revisionData.push(e[h].markerData)),s++,t=JSON.parse(e[h].format));this.documentEditor.editorModule.rowInsertionForCE(a.rowOrCellIndex,o,s,l,t,i,n,r),i=[],n=[],r=[],this.documentEditor.editorModule.revisionData=void 0},rf.prototype.buildCell=function(e,t,i){var n=this.getRelativePositionFromAbsolutePosition(e.offset,!1,!1,!0);0<e.length?(this.rowWidget=n.cellWidget.ownerRow,this.documentEditor.editorModule.cellInsertionForCE(n.rowOrCellIndex,this.rowWidget,JSON.parse(e.format),JSON.parse(t),JSON.parse(i))):this.documentEditor.documentHelper.owner.parser.parseCellFormat(JSON.parse(e.format),n.cellWidget.cellFormat,0)},rf.prototype.buildDeleteCells=function(e){var t,i,n=this.getRelativePositionFromAbsolutePosition(e.offset,!1,!1,!0);_.isNullOrUndefined(n.cellWidget)||(t=this.documentEditor.selectionModule.getFirstParagraph(n.cellWidget),i=this.documentEditor.selectionModule.getLastParagraph(n.cellWidget),_.isNullOrUndefined(t)||_.isNullOrUndefined(i)||(this.documentEditor.selectionModule.start.setPosition(t.firstChild,!0),this.documentEditor.selectionModule.end.setPositionParagraph(i.lastChild,i.lastChild.getEndOffset()+1)),this.documentEditor.editorModule.checkAndRemoveComments(),t=void(this.table=n.cellWidget.ownerTable.combineWidget(this.documentEditor.viewer)),n.cellWidget.nextWidget?(i=n.cellWidget.nextWidget,t=this.documentEditor.selectionModule.getFirstParagraph(i)):n.cellWidget.previousWidget&&(i=n.cellWidget.previousWidget,t=this.documentEditor.selectionModule.getFirstParagraph(i)),_.isNullOrUndefined(t)&&(t=this.documentEditor.editorModule.getParagraphForSelection(this.table)),e.length+=this.documentEditor.editorModule.onDeleteColumn(this.table,[n.cellWidget]),this.table.updateRowIndex(0),this.documentEditor.selectionModule.selectParagraphInternal(t,!0))},rf.prototype.transformSelectionOperation=function(e,t){var i,n;"Delete"!==e.action||"Delete"!==t.action&&"Format"!=t.action||(i=t.offset,e.offset+e.length<=(n=t).offset)||e.offset>=n.offset+n.length||(e.offset>=n.offset&&e.offset+e.length<=n.offset+n.length?(t.offset=t.offset,t.length-=e.length,t.length<=0&&(t.skipOperation=!0)):e.offset<n.offset&&e.offset+e.length<=n.offset+n.length?(t.offset=e.offset+e.length,t.length-=t.offset-i):e.offset>=n.offset&&e.offset+e.length>n.offset+n.length?t.length-=t.offset+t.length-e.offset:e.offset<n.offset&&e.offset+e.length>n.offset+n.length&&(n.offset=e.offset,n.length=0,t.skipOperation=!0))},rf.prototype.documentSettings=function(e){switch(this.documentEditor.skipSettingsOps=!0,e.text){case"enableTrackChanges":this.documentEditor.enableTrackChanges=e.enableTrackChanges;break;case"protection":this.documentEditor.documentHelper.restrictEditingPane.showHideRestrictPane(!0),_.isNullOrUndefined(e.protectionData.saltValue)?_.isNullOrUndefined(e.protectionData.hashValue)?this.documentEditor.editorModule.unProtectDocument():this.documentEditor.editorModule.validateHashValue(e.protectionData.hashValue):""===e.protectionData.hashValue&&""===e.protectionData.saltValue?this.documentEditor.editorModule.protectDocument(e.protectionData.protectionType):this.documentEditor.editorModule.enforceProtectionAssign(e.protectionData.saltValue,e.protectionData.hashValue,e.protectionData.protectionType)}},rf.prototype.checkAndRetriveChangesFromServer=function(){var e,t,i=this;this.isSyncServerChanges||(e={version:this.version,connectionId:this.connectionId,roomName:this.roomName},(t=new XMLHttpRequest).open("Post",this.serviceUrl+"GetActionsFromServer",!0),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),this.setCustomAjaxHeaders(t),t.onreadystatechange=function(){4===t.readyState&&(200===t.status||304===t.status?i.applyChangesFromServer(t.responseText):alert("Fail to load the document"))},t.send(JSON.stringify(e)),this.isSyncServerChanges=!0)},rf.prototype.applyChangesFromServer=function(e){var t=JSON.parse(e);if(0<t.length){for(var i=0;i<t.length;i++){var n=t[i];n.connectionId===this.connectionId?(this.acknowledgementReceived(),this.logMessage(this.isSyncServerChanges?"SignalR Server sync"+n.version:"SignalR Same user sync:"+n.version)):(this.handleRemoteOperation(n),this.logMessage("Received: "+JSON.stringify(JSON.stringify(n)))),this.updateVersion(n.version),this.logMessage("Server sync ack:"+n.version)}this.updateVersion(t[t.length-1].version)}this.isSyncServerChanges=!1,this.isAcknowledgePending()||this.acknowledgementReceived(),this.sendLocalOperation()},rf.prototype.insertCharaterFormat=function(e,t){var i=new B(void 0),t=JSON.parse(t),n=Object.keys(t);this.documentEditor.documentHelper.owner.parser.parseCharacterFormat(0,t,i),1<n.length?(this.documentEditor.documentHelper.owner.fontDialogModule.onCharacterFormat(this.documentEditor.selectionModule,i),this.documentEditor.editorModule.onApplyCharacterFormat("CharacterFormat",i)):1===n.length?-1!==n.indexOf("styleName")?_.isNullOrUndefined(t.styleName)?this.documentEditor.editorModule.onApplyCharacterFormat("styleName",null,!1,!0):this.documentEditor.editorModule.applyStyle(t.styleName):-1!==n.indexOf("Uppercase")||-1!==n.indexOf("Lowercase")||-1!==n.indexOf("SentenceCase")||-1!==n.indexOf("ToggleCase")||-1!==n.indexOf("CapitalizeEachWord")?this.documentEditor.editorModule.changeCase(n[0]):"increment"===e||"decrement"===e?this.documentEditor.editorModule.onApplyCharacterFormat(n[0],e,!0):this.documentEditor.editorModule.onApplyCharacterFormat(n[0],t[n[0]]):this.documentEditor.editorModule.clearFormatting()},rf.prototype.insertParagraphFormat=function(e,t){var i=new Xa(void 0),t=JSON.parse(t),n=!1,r=(_.isNullOrUndefined(t.isFirstParaForList)||(delete t.isFirstParaForList,n=!0),Object.keys(t));this.documentEditor.documentHelper.owner.parser.parseParagraphFormat(0,t,i),1===r.length?-1!==r.indexOf("styleName")?this.documentEditor.editorModule.applyStyle(t.styleName):"borders"===r[0]?this.documentEditor.editorModule.onApplyParagraphFormat(r[0],i.borders,!1,!1):"listFormat"===r[0]?(this.updateList(e,i),e=this.documentEditor.documentHelper.getListById(t.listFormat.nsid,!0),_.isNullOrUndefined(e)||(i.listFormat.listId=e.listId,i.listFormat.list=e),this.documentEditor.editorModule.onApplyParagraphFormat("listFormat",i.listFormat,!1,!1)):this.documentEditor.editorModule.onApplyParagraphFormat(r[0],t[r[0]],n,!1):this.documentEditor.documentHelper.owner.paragraphDialogModule.onParagraphFormat(i)},rf.prototype.insertTableFormat=function(e,t,i){var n=new Fl(void 0),t=JSON.parse(t),r=Object.keys(t);this.documentEditor.documentHelper.owner.parser.parseTableFormat(t,n,0);i=this.getRelativePositionFromAbsolutePosition(i,!0,!1,!1).tableWidget;_.isNullOrUndefined(e)?1===r.length?this.documentEditor.editorModule.onApplyTableFormat(r[0],t[r[0]],i):-1!==r.indexOf("borders")||-1!==r.indexOf("shading")?(this.documentEditor.editorModule.isBordersAndShadingDialog=!0,this.documentEditor.editorModule.onTableFormat(n,!0,i),this.documentEditor.editorModule.isBordersAndShadingDialog=!1):-1!==r.indexOf("cellSpacing")||-1!==r.indexOf("leftMargin")||-1!==r.indexOf("topMargin")||-1!==r.indexOf("rightMargin")||-1!==r.indexOf("bottomMargin")?this.documentEditor.documentHelper.owner.tableOptionsDialogModule.applySubTableOptions(n,i):this.documentEditor.editorModule.onTableFormat(n,!1,i):this.documentEditor.editorModule.insertAutoFitTable("TableAutoFitToContents"===e?"FitToContents":"TableAutoFitToWindow"===e?"FitToWindow":"FixedColumnWidth",i)},rf.prototype.insertRowFormat=function(e,t){var i=new Ya(void 0),t=JSON.parse(t),n=Object.keys(t);this.documentEditor.documentHelper.owner.parser.parseRowFormat(t,i,0),1===n.length?this.documentEditor.editorModule.onApplyTableRowFormat(n[0],t[n[0]]):this.documentEditor.editorModule.onRowFormat(i)},rf.prototype.insertCellFormat=function(e){var t,i,n;this.documentEditor.selectionModule.start.paragraph.isInsideTable&&(t=new Tl(void 0),e=JSON.parse(e),i=Object.keys(e),this.documentEditor.documentHelper.owner.parser.parseCellFormat(e,t,0),n=this.documentEditor.selectionModule.start.paragraph.associatedCell.cellFormat,1===i.length?("shading"===i[0]?this.documentEditor.editorModule.applyCellPropertyValue(this.documentEditor.selectionModule,i[0],t.shading,n):"borders"===i[0]?this.documentEditor.editorModule.applyCellPropertyValue(this.documentEditor.selectionModule,i[0],t.borders,n):this.documentEditor.editorModule.applyCellPropertyValue(this.documentEditor.selectionModule,i[0],e[i[0]],n),this.rowWidget=this.documentEditor.selectionModule.start.paragraph.associatedCell.ownerRow):-1!==i.indexOf("preferredWidth")||-1!==i.indexOf("preferredWidthType")||-1!==i.indexOf("verticalAlignment")||-1!==i.indexOf("borders")||-1!==i.indexOf("shading")?(-1===i.indexOf("borders")&&-1===i.indexOf("shading")||(this.documentEditor.editorModule.isBordersAndShadingDialog=!0),this.documentEditor.editorModule.applyCellPropertyValue(this.documentEditor.selectionModule,void 0,t,n),this.rowWidget=this.documentEditor.selectionModule.start.paragraph.associatedCell.ownerRow,this.documentEditor.editorModule.isBordersAndShadingDialog=!1):this.documentEditor.documentHelper.owner.cellOptionsDialogModule.applySubCellOptions(t))},rf.prototype.insertSectionFormat=function(e,t){var i,n,t=JSON.parse(t),r=Object.keys(t);"linkToPrevious"===r[0]?(n=(i=this.documentEditor.selectionModule.start.paragraph.bodyWidget).sectionIndex,i=i.headerFooterType,this.documentEditor.editorModule.removeInlineHeaderFooterWidget(n,i,e,t.linkToPrevious)):1<r.length?(n=new Ma,this.documentEditor.documentHelper.owner.parser.parseSectionFormat(0,t,n),this.documentEditor.editorModule.onApplySectionFormat(void 0,n)):this.documentEditor.editorModule.onApplySectionFormat(Object.keys(t)[0],t[Object.keys(t)[0]])},rf.prototype.logMessage=function(e){this.logEventEnabled&&(this.message+=e+" \n")},rf.prototype.setCustomAjaxHeaders=function(e){for(var t=0;t<this.documentEditor.headers.length;t++)for(var i=this.documentEditor.headers[t],n=0,r=Object.keys(i);n<r.length;n++){var o=r[n];e.setRequestHeader(o,i[o])}},rf.prototype.destroy=function(){this.version=void 0,this.documentEditor=void 0,this.roomName=void 0,this.userMap=void 0,this.connectionId=void 0,this.acknowledgmentPending=void 0,this.pendingOps=void 0,this.serviceUrl=void 0,this.isSyncServerChanges=void 0,this.message=void 0,this.rowWidget=void 0};var nf=rf;function rf(e){this.version=0,this.userMap={},this.connectionId="",this.pendingOps=[],this.commentsStart=[],this.commentsEnd=[],this.deletedComments=[],this.serviceUrl="",this.isSyncServerChanges=!1,this.logEventEnabled=!0,this.message="",this.documentEditor=e}sf.prototype.initializeElement=function(){this.hoverDiv=_.createElement("div",{className:"e-de-user-info e-de-user-name-collapse",styles:"z-index: 1; visibility: hidden;left:-4px;position:absolute;width:20px;height:20px;pointer-events:all;"}),this.userViewContainer=_.createElement("div"),this.spanViewContainer=_.createElement("div",{styles:"background-color:"+this.color+";left: 0px; top: 15px; visibility: visible;"}),this.spanView=_.createElement("span",{styles:"background-color:"+this.color+"; left: 0px;top:-4px;pointer:default"}),this.spanViewContainer.appendChild(this.spanView),this.userViewContainer.appendChild(this.spanViewContainer),this.hoverDiv.appendChild(this.userViewContainer),this.caret.appendChild(this.hoverDiv),this.hoverDiv.addEventListener("mouseenter",this.onMouseEnter.bind(this)),this.hoverDiv.addEventListener("mouseleave",this.onMouseLeave.bind(this))},sf.prototype.onMouseEnter=function(){this.hoverDiv.classList.remove("e-de-user-name-collapse"),this.hoverDiv.classList.add("e-de-user-name-expended"),this.spanView.innerText=this.userName},sf.prototype.onMouseLeave=function(){this.hoverDiv.classList.add("e-de-user-name-collapse"),this.hoverDiv.classList.remove("e-de-user-name-expended"),this.spanView.innerText=""};var of=sf;function sf(e,t,i,n){this.color=e,this.caret=t,this.offset=i,this.userName=n,this.initializeElement()}lf.prototype.getModuleName=function(){return"FootNotesDialog"},lf.prototype.notesDialog=function(e,t){var i=this.documentHelper.owner.containerId+"_insert_Footnote",i=(this.target=_.createElement("div",{id:i,className:"e-de-insert-footnote"}),_.createElement("div")),n=_.createElement("div"),r=(this.footCount=_.createElement("input",{attrs:{type:"text"},id:this.documentHelper.owner.containerId+"row"}),n.appendChild(this.footCount),_.createElement("div",{className:"e-de-container-row"})),o=_.createElement("select",{id:this.target.id+"_papersize",styles:"padding-bottom: 20px;",innerHTML:'<option value="1, 2, 3, ...">'+e.getConstant("1, 2, 3, ...")+'</option><option value="a, b, c, ...">'+e.getConstant("a, b, c, ...")+'</option><option value="A, B, C, ...">'+e.getConstant("A, B, C, ...")+'</option><option value="I, II, III, ...">'+e.getConstant("I, II, III, ...")+'</option><option value="i, ii, iii, ...">'+e.getConstant("i, ii, iii, ...")+"</option>"});r.appendChild(o),this.notesList=new U.DropDownList({enableRtl:t,placeholder:e.getConstant("Number format"),floatLabelType:"Always",htmlAttributes:{"aria-labelledby":e.getConstant("Number format")}}),this.notesList.appendTo(o),i.appendChild(r),i.appendChild(n),this.target.appendChild(i),this.startValueTextBox=new D.NumericTextBox({format:"#",min:1,max:99999,enablePersistence:!1,placeholder:e.getConstant("Start at"),floatLabelType:"Always"}),this.startValueTextBox.appendTo(this.footCount),this.footCount.setAttribute("aria-labelledby",e.getConstant("Start at"))},lf.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.notesDialog(e),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.selection.isinFootnote?this.documentHelper.dialog.header=e.getConstant("Footnote"):this.documentHelper.dialog.header=e.getConstant("Endnote"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadFontDialog,this.documentHelper.dialog.buttons=[{click:this.onInsertFootnoteClick,buttonModel:{content:e.getConstant("Apply"),cssClass:"e-flat e-table-ok",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cancel"}}],this.startValueTextBox.value=1,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),this.documentHelper.selection.isinEndnote&&(e=this.endnoteListValue(this.list),this.notesList.index=e)},lf.prototype.types=function(e){switch(e){case"1, 2, 3, ...":return"Arabic";case"A, B, C, ...":return"UpperCaseLetter";case"a, b, c, ...":return"LowerCaseLetter";case"I, II, III, ...":return"LowerCaseRoman";case"i, ii, iii, ...":return"UpperCaseRoman";default:return"Arabic"}},lf.prototype.reversetype=function(e){switch(e){case"Arabic":return"1, 2, 3, ...";case"UpperCaseLetter":return"A, B, C, ...";case"LowerCaseLetter":return"a, b, c, ...";case"UpperCaseRoman":return"I, II, III, ...";case"LowerCaseRoman":return"i, ii, iii, ...";default:return"1, 2, 3, ..."}},lf.prototype.endnoteListValue=function(e){e="A, B, C, ..."===e?0:"1, 2, 3, ..."===e?1:"a, b, c, ..."===e?2:3;return e},lf.prototype.destroy=function(){this.footCount&&(this.footCount.parentElement&&this.footCount.parentElement.removeChild(this.footCount),this.footCount=void 0),this.startValueTextBox&&(this.startValueTextBox.destroy(),this.startValueTextBox=void 0),this.notesList&&(this.notesList.destroy(),this.notesList=void 0),this.footCount=void 0,this.documentHelper=void 0};var af=lf;function lf(e){var r=this;this.list=void 0,this.noteNumberFormat=void 0,this.sectionFormat=void 0,this.onCancelButtonClick=function(){r.documentHelper.dialog.hide(),r.documentHelper.updateFocus(),r.unWireEventsAndBindings()},this.loadFontDialog=function(){var e,t,i,n;r.documentHelper.updateFocus(),e=r.sectionFormat||r.documentHelper.owner.selectionModule.sectionFormat,r.documentHelper.selection.isinFootnote?(t=e.footNoteNumberFormat,n=e.initialFootNoteNumber,t=r.reversetype(t)):(i=e.endnoteNumberFormat,t=r.reversetype(i),n=e.initialEndNoteNumber),r.notesList.value=t,r.startValueTextBox.value=n},this.onInsertFootnoteClick=function(){var e,t,i=new Ma(void 0);_.isNullOrUndefined(r.notesList)||(e=r.notesList.value.toString(),e=r.types(e),t=r.startValueTextBox.value,_.isNullOrUndefined(r.notesList))||(r.documentHelper.selection.isinFootnote?(i.footNoteNumberFormat=e,i.initialFootNoteNumber=t):(i.endnoteNumberFormat=e,i.initialEndNoteNumber=t),r.documentHelper.owner.editorModule.onApplySectionFormat(void 0,i)),r.documentHelper.hideDialog()},this.unWireEventsAndBindings=function(){r.notesList.value=void 0},this.documentHelper=e}hf.prototype.isEmpty=function(){return 0===this.height&&0===this.width},hf.prototype.clone=function(){return new hf(this.width,this.height)};var df=hf;function hf(e,t){this.width=e,this.height=t}pf.prototype.appendTo=function(){this.preRender(),this.render()},pf.prototype.preRender=function(){this.unWireEvents(),this.wireEvents()},pf.prototype.render=function(){this.updateRulerGeometry()},pf.prototype.getModuleName=function(){return"Ruler"},pf.prototype.destroy=function(){this.unWireEvents(),this.element.classList.remove("e-ruler")},pf.prototype.showHideRuler=function(e){this.element.style.display=e?"block":"none"},pf.prototype.updateRulerGeometry=function(){this.element.style.textAlign="left",this.renderRulerSpace(),this.updateRuler()},pf.prototype.renderRulerSpace=function(){var e=this.getRulerGeometry(),t=document.getElementById(this.element.id+"_ruler_space");return t||(t=this.rulerHelper.createHtmlElement("div",{id:this.element.id+"_ruler_space",style:"height:"+e.height+"px;width:"+e.width+"px;cssFloat:left;"}),this.element.appendChild(t)),t},pf.prototype.updateRuler=function(){var e=this.getRulerSize(),t=this.getRulerGeometry(),i=0,n=new df,t=this.getRulerSVG(t);t&&(i=this.length,n.height=e,n=this.offset,i)&&i!==1/0&&this.updateSegments(n,i+Math.abs(n),t,e)},pf.prototype.updateSegments=function(e,t,i,n){var r=e,o={trans:0};for(this.rulerStartValue=j.convertPixelToPoint(this.zeroPosition);r<t;){var s=this.getNewSegment(r,i);s&&(i.appendChild(s.segment),r=this.updateSegment(e,t,s,r,o,n))}this.addSegmentWidth=!1},pf.prototype.updateSegment=function(e,t,i,n,r,o){var s=this.updateSegmentWidth(this.scale),e=(n===e?(this.startValue=Math.floor(e/s)*s/this.scale,this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,i.label.textContent=this.rulerStartValue.toString(),this.defStartValue=n=this.startValue*this.scale,"Horizontal"===this.orientation?this.hRulerOffset=e-n:this.vRulerOffset=e-n):(this.startValue=j.convertPixelToPoint(n),this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,e=void 0,0===this.rulerStartValue&&(this.addSegmentWidth=!0),e=this.addSegmentWidth?Math.abs(this.rulerStartValue+36):Math.abs(this.rulerStartValue-36),i.label.textContent=e.toString(),this.rulerStartValue=e),this.updateTickLabel(i,o),"Horizontal"===this.orientation?r.trans+.5+",0.5":"0.5,"+(r.trans+.5));return i.segment.setAttribute("transform","translate("+e+") scale(1,1)"),r.trans+=s*this.scale,n+=s},pf.prototype.updateTickLabel=function(e,t){var i=e.segment.lastChild.getBBox(),n="Horizontal"===this.orientation,r="RightOrBottom"===this.tickAlignment,o=n?-4:0,s=n?r?t/2+5.5-5.5:t/2+5.5:i.height,r=(n&&(s+=2),n||(o+=10,s+=2),r?-(i.width+2)+","+(t/2-i.height):-(i.width+2)+","+(t/2-i.height/2));this.rulerHelper.setAttributeSvg(e.segment.lastChild,n?{x:o,y:s}:{x:o,y:s,transform:"rotate(270)translate("+r+")"})},pf.prototype.getNewSegment=function(e,t){e=this.createNewTicks(e,t);return{segment:e,label:this.createTickLabel(t,e)}},pf.prototype.createNewTicks=function(e,t){var i,n=this.updateSegmentWidth(this.scale),r=this.rulerHelper.createSvgElement("g",{class:"e-de-ruler-segment"}),o=this.rulerHelper.createSvgElement("rect",{class:"e-de-ruler-segment1"}),s="Horizontal"===this.orientation?n*this.scale:15,a="Horizontal"===this.orientation?15:n;o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("width",s.toString()),o.setAttribute("height",a.toString()),o.setAttribute("fill","lightgrey");for(var l=0;l<this.interval;l++)i=n/this.interval,(i=this.createTick(t,i,l+1,e))&&r.appendChild(i);return r},pf.prototype.getLinePoint=function(e,t,i){var n=this.updateSegmentWidth(this.scale),r=this.getRulerSize();return i=(t*=i-1)%n==0?r:.3*r},pf.prototype.createTick=function(e,t,i,n){var r,e=this.getLinePoint(e,t,i),o=this.getRulerSize(),s="Horizontal"===this.orientation,a="RightOrBottom"===this.tickAlignment,t=t*(i-1)*this.scale,i=s?t:a?o:0,l=s?t:a?o-e:o-(o-e),d=s?a?o:o-(o-e):t,a=s?a?o-e:0:t;return 0!=a&&(s||(i-=6,l-=6),(r=this.rulerHelper.createSvgElement("line",{x1:i,y1:d-=6,x2:l,y2:a-=6,"stroke-width":"0.25",stroke:"black"})).setAttribute("class","e-de-ruler-tick")),r},pf.prototype.createTickLabel=function(e,t){var i;return t&&(i=this.rulerHelper.createSvgElement("text",{class:"e-de-ruler-tick-label",style:"font-weight: 400"}),t.appendChild(i)),i},pf.prototype.updateSegmentWidth=function(e){if(100!==this.segmentWidth)return this.segmentWidth;var t=1,i=100;for(i=100/Math.pow(2,Math.round(Math.log(e)/Math.log(2)));100<i;)t/=10,i/=10;for(;i<25;)t*=10,i*=10;return(i=25<=i&&i%25!=0?25*Math.round(i/25):i)*e/t},pf.prototype.createMarkerLine=function(e,t,i){var n;return t&&((n=e.getElementById(t.id+"_marker"))&&n.parentNode.removeChild(n),n=this.rulerHelper.createSvgElement("line",i)),n},pf.prototype.drawRulerMarker=function(e,t,i){for(var n,r,o,s="Horizontal"===this.orientation,a=e.getElementsByTagName("svg"),l=0;l<a.length;l++){a[parseInt(l.toString(),10)]&&(n=a[parseInt(l.toString(),10)]);break}n&&(r=this.getRulerSize(),r={id:e.id+"_marker",x1:0,y1:0,x2:s?0:r,y2:s?r:0,stroke:this.markerColor,"stroke-width":1.5,class:"e-d-ruler-marker"},e=this.createMarkerLine(n,e,r),r=this.scale,o=this.offset-this.defStartValue,t=(s?t.x:t.y)*r+i+o,e.setAttribute("transform","translate("+(s?t+.5+" 0.5":"0.5 "+(t+.5))+")"),n.appendChild(e))},pf.prototype.getRulerGeometry=function(){return"Horizontal"===this.orientation?new df(this.length,this.element?this.element.getBoundingClientRect().height:0):new df(this.element?this.element.getBoundingClientRect().width:0,this.length)},pf.prototype.getRulerSize=function(){return this.thickness},pf.prototype.getRulerSVG=function(e){var t,i=this.getRulerSize();if(this.element&&(t=document.getElementById(this.element.id+"_ruler_space"))){var i={id:this.element.id+"_Ruler_svg",width:"Horizontal"===this.orientation?this.length:i+"px",height:"Horizontal"===this.orientation?i:e.height+"px",style:"position:inherit;"},n=this.rulerHelper.createSvgElement("svg",i);if(0<t.childNodes.length)for(var r=t.childNodes.length-1;0<=r;r--)t.childNodes[parseInt(r.toString(),10)].parentNode.removeChild(t.childNodes[parseInt(r.toString(),10)]);t.appendChild(n)}return n},pf.prototype.wireEvents=function(){},pf.prototype.unWireEvents=function(){};var cf=pf;function pf(e,t){this.interval=4,this.segmentWidth=47.9988,this.orientation="Horizontal",this.tickAlignment="RightOrBottom",this.markerColor="red",this.thickness=15,this.arrangeTick=null,this.length=400,this.offset=0,this.scale=1,this.rulerStartValue=1584,this.zeroPosition=j.convertPointToPixel(1584),this.addSegmentWidth=!1,this.element=e,this.rulerHelper=t}gf.prototype.hideTabStopSwitch=function(e){this.tabStopStwitch&&this.showHideElement(e,this.tabStopStwitch)},gf.prototype.hideRulerBottom=function(e){this.hRulerBottom&&this.showHideElement(e,this.hRulerBottom),this.vRulerBottom&&this.showHideElement(e,this.vRulerBottom)},gf.prototype.showHideElement=function(e,t){t.style.display=e?"block":"none"},gf.prototype.createHtmlElement=function(e,t){e=_.createElement(e,t);return this.setAttributeHtml(e,t),e},gf.prototype.createSvgElement=function(e,t){e=document.createElementNS("http://www.w3.org/2000/svg",e);return this.setAttributeSvg(e,t),e},gf.prototype.applyStyleAgainstCsp=function(e,t){for(var i=t.split(";"),n=0;n<i.length;n++){var r=i[parseInt(n.toString(),10)].split(":");2===r.length&&(e.style[r[0].trim()]=r[1].trim())}},gf.prototype.setAttributeSvg=function(e,t){for(var i=Object.keys(t),n=0;n<i.length;n++)e&&"style"!==i[parseInt(n.toString(),10)]?e.setAttribute(i[parseInt(n.toString(),10)],t[i[parseInt(n.toString(),10)]]):this.applyStyleAgainstCsp(e,t[i[parseInt(n.toString(),10)]])},gf.prototype.setAttributeHtml=function(e,t){for(var i=Object.keys(t),n=0;n<i.length;n++)"style"!==i[parseInt(n.toString(),10)]?e.setAttribute(i[parseInt(n.toString(),10)],t[i[parseInt(n.toString(),10)]]):this.applyStyleAgainstCsp(e,t[i[parseInt(n.toString(),10)]])},gf.prototype.renderOverlapElement=function(e){var t=this.getRulerSize(e),t={id:e.element.id+"_overlapRuler",style:"height:"+t.height+"px;width:"+t.width+"px;position:absolute;margin-left:0;margin-top:0;diplay:none",class:"e-ruler-overlap"},t=this.createHtmlElement("div",t),e=document.getElementById(e.element.id+"_viewerContainer");return e.insertBefore(t,e.firstChild),t},gf.prototype.renderRulerMarkerIndicatorElement=function(e){if(e.enableSelection){var t=this.getRulerSize(e),i={id:e.element.id+"_markIndicator",style:"height:"+t.height+"px;width:"+t.width+"px;position:absolute;margin-left:0;margin-top:0;z-index:5;border:1px solid #ccc;display:"+("Pages"===e.layoutType?"block;":"none;"),class:"e-de-ruler-markIndicator"},n=this.createHtmlElement("div",i),i=(this.tabStopStwitch=n,document.getElementById(e.element.id+"_viewerContainer")),i=(i.insertBefore(n,i.firstChild),e.element.id),r=document.getElementById(i+"_firstLineIndent").cloneNode(!0),o=document.getElementById(i+"_hangingIndent").cloneNode(!0),s=(r.style.left="1px",r.style.top=t.height/2-3+"px",r.style.display="none",r.classList.add("e-de-ruler-marker"),r.setAttribute("id",i+"_firstLineIndent_-1"),o.style.left="1px",o.style.top=t.height/2-3+"px",o.style.display="none",o.classList.add("e-de-ruler-marker"),o.setAttribute("id",i+"_hangingIndent_-1"),n.appendChild(o),n.appendChild(r),["Left","Center","Right","Decimal","Bar"]),a=new _.L10n("documenteditor",e.defaultLocale);a.setLocale(e.locale);for(var l=0;l<5;l++){this.renderTab(e,t,void 0,s[parseInt(l.toString(),10)],-1,a);var d=document.getElementById(e.element.id+"_"+s[parseInt(l.toString(),10)]+"Tab_-1");_.isNullOrUndefined(d)||(d.classList.remove("e-de-ruler-tab"),d.classList.add("e-de-ruler-marker"),d.style.display=0===l?"block":"none",d.style.position="absolute",d.style.margin="4px 3px",n.appendChild(d))}n.addEventListener("click",function(e){for(var t=document.querySelector(".e-de-ruler-markIndicator"),i=0;i<t.childNodes.length;i++){var n=t.childNodes[parseInt(i.toString(),10)];if("block"===n.style.display){n.style.display="none";n=(i+1)%t.childNodes.length;t.childNodes[parseInt(n.toString(),10)].style.display="block";break}}})}},gf.prototype.renderRuler=function(v,e){var t,l,i,n,r,w,b,x,C,I,k,F,d,P,T,S,H,o,s,h,c,p,u,N=this;v.enableSelection&&(i=document.getElementById(v.element.id+(e?"_hRuler":"_vRuler")),t=this.getRulerSize(v),l=this.getRulerGeometry(v),r=e?v.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.x:v.selectionModule.getPageTop(v.selectionModule.end.paragraph.bodyWidget.page),r=e?"margin-left:"+r+"px;":"margin-top:"+r+"px;",v.selectionModule.isForward?this.position=v.selectionModule.start:this.position=v.selectionModule.end,i||(r="height:"+(e?t:l).height+"px;overflow:hidden;width:"+(e?l:t).width+"px;position:absolute;font-size:9px;text-align: left;z-index: 4;user-select:none;"+r,r={id:v.element.id+(e?"_hRuler":"_vRuler"),style:r,class:e?"e-de-hRuler":"e-de-vRuler"},i=this.createHtmlElement("div",r)),i.addEventListener("dblclick",function(){v.showDialog("PageSetup")}),r=document.getElementById(v.element.id+"_pageContainer"),r="height:"+(e?t:r.getBoundingClientRect()).height+"px;overflow:hidden;width:"+(e?r.getBoundingClientRect():t).width+"px;position:absolute;z-index: 3;",r={id:v.element.id+(e?"_hRulerBottom":"_vRulerBottom"),style:r,class:e?"e-de-hRuler":"e-de-vRuler"},r=this.createHtmlElement("div",r),e?this.hRulerBottom=r:this.vRulerBottom=r,(n=document.getElementById(v.element.id+"_viewerContainer")).insertBefore(r,n.firstChild),(r=e?document.getElementById(v.element.id+"_hRulerBottom"):document.getElementById(v.element.id+"_vRulerBottom")).insertBefore(i,r.firstChild),this.renderRulerMargins(v,e,i),(n=new cf(i,this)).orientation=e?"Horizontal":"Vertical",this.updateMargin(n,v,e),n.length=2*n.zeroPosition,n.appendTo(),e?v.hRuler=n:v.vRuler=n,this.updateRulerPosition(v,e),r=document.getElementById(v.element.id+(e?"_hRuler":"_vRuler")),e?v.hRuler.element=r:v.vRuler.element=r,r&&(e?r.scrollLeft=n.zeroPosition-j.convertPointToPixel(v.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin):r.scrollTop=n.zeroPosition-j.convertPointToPixel(v.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin)),this.locale=new _.L10n("documenteditor",v.defaultLocale),e&&this.renderIndents(v,e,t,l,this.locale),x=void 0,I=C=b=w=!1,F=document.getElementById(v.element.id+"_hRuler"),e&&(document.addEventListener("mousemove",function(e){if(!v.isDestroyed&&v.documentEditorSettings.showRuler){var t,i,n,r,o,s,a,l=F.getBoundingClientRect(),d=v.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin*v.zoomFactor,h=j.convertPixelToPoint(l.width)-v.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin*v.zoomFactor,c=Math.round(e.clientX-l.left),p=j.convertPixelToPoint(c);if(!b)if(v.isOnIndent)F.style.cursor="default",F.hasAttribute("title")&&F.removeAttribute("title"),w=!1;else if(d-3<=p&&p<=3+d)"Pages"===v.layoutType&&(F.style.cursor="e-resize",F.setAttribute("title",N.locale.getConstant("Left Margin")),x=w=!0);else if(h-3<=p&&p<=3+h)"Pages"===v.layoutType&&(F.style.cursor="e-resize",F.setAttribute("title",N.locale.getConstant("Right Margin")),x=!(w=!0));else if(0<v.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns.length){var u=v.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns;if("Pages"===v.layoutType)for(var g=1;g<=u.length;g++){var m=document.getElementById(v.element.id+"_hRuler_Margin"+g),f=m.getBoundingClientRect().left,y=m.getBoundingClientRect().width;if(f-3<=e.clientX&&f+3>=e.clientX){F.style.cursor="e-resize",k=m,F.setAttribute("title",N.locale.getConstant("Left Margin")),w=C=!0;break}if(f+y-3<=e.clientX&&f+y+3>=e.clientX){F.style.cursor="e-resize",k=m,F.setAttribute("title",N.locale.getConstant("Right Margin")),w=I=!0;break}F.style.cursor="default",F.hasAttribute("title")&&F.removeAttribute("title"),w=I=C=!1}}else F.style.cursor="default",F.hasAttribute("title")&&F.removeAttribute("title"),w=!1;b&&(d=j.convertPointToPixel(1584-v.selectionModule.sectionFormat.leftMargin)*v.zoomFactor,h=v.selectionModule.sectionFormat.pageWidth,i=v.selectionModule.sectionFormat.rightMargin,t=0<(t=v.selectionModule.paragraphFormat.rightIndent)?t:0,a=v.selectionModule.paragraphFormat.firstLineIndent,r=v.selectionModule.sectionFormat.leftMargin,a=0<=a?a:0,o=v.selectionModule.paragraphFormat.leftIndent,x?(i=d+j.convertPointToPixel(h-i-t-42-a-o)*v.zoomFactor)<c+(n=d)?p=j.convertPixelToPoint(c=i-d):c+d<n&&(p=j.convertPixelToPoint(c=n-d)):(i=d+j.convertPointToPixel(r+o+a+42+t)*v.zoomFactor,(n=d+j.convertPointToPixel(h)*v.zoomFactor)<c+d?p=j.convertPixelToPoint(c=n-d):c+d<i&&(p=j.convertPixelToPoint(c=i-d))),H=p,r=j.convertPixelToPoint(l.width)-v.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin*v.zoomFactor,v.selectionModule.end.paragraph.bodyWidget.sectionFormat.numberOfColumns<=1&&N.resizeRulerMargins(x,P,T,r,F,p,!0,v),o=document.getElementById(v.element.id+"_rightIndent"),x?(s=p-P,o.style.left=S-j.convertPointToPixel(s)+"px"):(s=p-P,o.style.left=S+j.convertPointToPixel(s)+"px"),a=v.documentHelper.currentPage.boundingRectangle.x+c,document.getElementById(v.element.id+"_hRuler_indicator_svg").style.left=a+"px")}}),F.addEventListener("mouseenter",function(e){_.isNullOrUndefined(N.currentTabStopElement)||(N.currentTabStopElement.style.display="block")}),F.addEventListener("mouseleave",function(e){_.isNullOrUndefined(N.currentTabStopElement)||(N.currentTabStopElement.style.display="none")}),F.addEventListener("mousedown",function(e){w&&!v.isTableMarkerDragging&&(b=!0,0<v.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns.length&&(C?d=k.getBoundingClientRect().left:I&&(d=k.getBoundingClientRect().left+k.getBoundingClientRect().width)),n=F.getBoundingClientRect(),P=j.convertPixelToPoint(Math.round(e.clientX-n.left)),T=F.scrollLeft,t=document.getElementById(v.element.id+"_rightIndent"),S=j.getNumberFromString(t.style.left),t=Math.round(e.clientX-n.left),n=v.documentHelper.currentPage.boundingRectangle.x+t,(t=document.getElementById(v.element.id+"_hRuler_indicator_svg")).style.left=n+"px",t.style.display="block");var t,i,n=F.getBoundingClientRect();n.y+n.height/2<=e.clientY&&(o=e.clientX-F.getBoundingClientRect().left,"Pages"===v.layoutType?(o=j.convertPixelToPoint(o-j.convertPointToPixel(v.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)*v.zoomFactor),N.position.paragraph.paragraphFormat.bidi&&(i=_.isNullOrUndefined(N.position.paragraph.absoluteXPosition)?N.position.paragraph.width:parseFloat(N.position.paragraph.absoluteXPosition.width.toString()),i=j.convertPixelToPoint(i*v.zoomFactor),o=i-o)):"Continuous"===v.layoutType&&(o=N.position.paragraph.paragraphFormat.bidi?(o=j.convertPixelToPoint(o-20),i=_.isNullOrUndefined(N.position.paragraph.absoluteXPosition)?N.position.paragraph.width:parseFloat(N.position.paragraph.absoluteXPosition.width.toString()),(i=j.convertPixelToPoint(i*v.zoomFactor))-o):j.convertPixelToPoint(o-20)))}),F.addEventListener("mouseup",function(e){var t,i=document.getElementById(v.element.id+"_markIndicator"),n=F.getBoundingClientRect();n.y+n.height/2<=e.clientY&&(s=e.clientX-F.getBoundingClientRect().left,"Pages"===v.layoutType?(s=j.convertPixelToPoint(s-j.convertPointToPixel(v.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)*v.zoomFactor),N.position.paragraph.paragraphFormat.bidi&&(t=_.isNullOrUndefined(N.position.paragraph.absoluteXPosition)?N.position.paragraph.width:parseFloat(N.position.paragraph.absoluteXPosition.width.toString()),t=j.convertPixelToPoint(t*v.zoomFactor),s=t-s)):"Continuous"===v.layoutType&&(s=N.position.paragraph.paragraphFormat.bidi?(s=j.convertPixelToPoint(s-20),t=_.isNullOrUndefined(N.position.paragraph.absoluteXPosition)?N.position.paragraph.width:parseFloat(N.position.paragraph.absoluteXPosition.width.toString()),(t=j.convertPixelToPoint(t*v.zoomFactor))-s):j.convertPixelToPoint(s-20)),n=document.getElementById(v.element.id+"_rightIndent"),e=j.getNumberFromString(n.style.left),0<s)&&s<e&&o===s&&(_.isNullOrUndefined(i)||(t=i.querySelector('.e-de-ruler-marker[style*="display: block;"]'),_.isNullOrUndefined(t))||(s/=v.zoomFactor,"LeftTab"===(n=t.getAttribute("data-name"))||"CenterTab"===n||"RightTab"===n||"DecimalTab"===n||"BarTab"===n?((e=new Ka).position=s,e.tabJustification=N.getTabJustification(n),e.deletePosition=0,e.tabLeader="None",v.editorModule.onApplyParagraphFormat("tabStop",[e],!1,!1)):"FirstLineIndent"!==n&&"HangingIndent"!==n||("HangingIndent"===n?(i=v.selectionModule.paragraphFormat.firstLineIndent,t=s+i,e=v.selectionModule.start.paragraph.paragraphFormat.firstLineIndent,v.editorModule.onApplyParagraphFormat("firstLineIndent",e-t,!1,!1),n=v.selectionModule.start.paragraph.paragraphFormat.leftIndent+e,v.editorModule.onApplyParagraphFormat("leftIndent",n-(e-=t),!1,!1,!0)):v.editorModule.onApplyParagraphFormat("firstLineIndent",o,!1,!1))))}),document.addEventListener("mouseup",function(e){if(b&&!v.isTableMarkerDragging){F.getBoundingClientRect();var t=H;if(C||I){for(var e=e.clientX-d,i=v.selectionModule.end.paragraph.bodyWidget.sectionFormat.cloneFormat(),n=v.selectionModule.sectionFormat.pageWidth-v.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin-v.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin,r=C?i.columns[0].space+j.convertPixelToPoint(e):i.columns[0].space-j.convertPixelToPoint(e),o=0;o<i.columns.length;o++){var s,a=i.columns[parseInt(o.toString(),10)];0<=r&&36<=a.width?(s=j.convertPointToPixel((n-j.convertPixelToPoint(r)*(i.numberOfColumns-1))/i.numberOfColumns),a.width=s,o<i.columns.length-1&&(a.space=r)):a[0].space=a[1].space}v.editorModule.onApplySectionFormat(void 0,i),I=C=!1}else x?(v.hRuler.startMargin=t/v.zoomFactor,v.selectionModule.sectionFormat.leftMargin=t/v.zoomFactor):(e=j.convertPixelToPoint(l.width)-t/v.zoomFactor,v.selectionModule.sectionFormat.rightMargin=e);b=w=!1,x=void 0,document.getElementById(v.element.id+"_hRuler_indicator_svg").style.display="none"}})),h=document.getElementById(v.element.id+"_vRuler"),c=!1,e||(document.addEventListener("mousemove",function(e){var t,i,n,r,o,s,a;!v.isDestroyed&&v.documentEditorSettings.showRuler&&(t=h.getBoundingClientRect(),n=v.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin*v.zoomFactor,a=j.convertPixelToPoint(t.height)-v.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin*v.zoomFactor,r=j.convertPixelToPoint(Math.round(e.clientY-t.top)),i=Math.round(e.clientY-t.top),b||(n-3<=r&&r<=3+n?(h.style.cursor="n-resize",h.setAttribute("title",N.locale.getConstant("Top Margin")),c=w=!0):a-3<=r&&r<=3+a?(h.style.cursor="n-resize",h.setAttribute("title",N.locale.getConstant("Bottom Margin")),c=!(w=!0)):(h.style.cursor="default",h.hasAttribute("title")&&h.removeAttribute("title"),w=!1)),b)&&(n=j.convertPixelToPoint(Math.round(e.clientY-t.top)),r=j.convertPointToPixel(1584-v.selectionModule.sectionFormat.topMargin)*v.zoomFactor,a=v.selectionModule.sectionFormat.pageHeight,e=v.selectionModule.sectionFormat.bottomMargin,s=v.selectionModule.sectionFormat.topMargin,c?(e=(o=r)+j.convertPointToPixel(a-e-12)*v.zoomFactor)<i+r?n=j.convertPixelToPoint(i=e-r):i+r<o&&(n=j.convertPixelToPoint(i=o-r)):(e=r+j.convertPointToPixel(s+12)*v.zoomFactor,(o=r+j.convertPointToPixel(a)*v.zoomFactor)<i+r?n=j.convertPixelToPoint(i=o-r):i+r<e&&(n=j.convertPixelToPoint(i=e-r))),s=j.convertPixelToPoint(t.height)-v.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin*v.zoomFactor,N.resizeVRulerMargins(c,p,u,s,h,n,v),a=v.documentHelper.currentPage.boundingRectangle.y*v.zoomFactor+i,document.getElementById(v.element.id+"_vRuler_indicator_svg").style.top=a+"px")}),h.addEventListener("mousedown",function(e){var t,i;w&&(b=!0,t=h.getBoundingClientRect(),p=j.convertPixelToPoint(Math.round(e.clientY-t.top)),u=h.scrollTop,e=Math.round(e.clientY-t.top),t=document.getElementById(v.element.id+"_vRuler_indicator_svg"),i=v.documentHelper.currentPage.boundingRectangle.y*v.zoomFactor,t.style.top=i+e+"px",t.style.display="block")}),document.addEventListener("mouseup",function(e){var t;b&&(t=h.getBoundingClientRect(),e=j.convertPixelToPoint(Math.round(e.clientY-t.top)),c?(v.vRuler.startMargin=e/v.zoomFactor,v.selectionModule.sectionFormat.topMargin=e/v.zoomFactor):(t=j.convertPixelToPoint(l.height)-e/v.zoomFactor,v.vRuler.endMargin=t,v.selectionModule.sectionFormat.bottomMargin=t),b=w=!1,document.getElementById(v.element.id+"_vRuler_indicator_svg").style.display="none",c=void 0)})))},gf.prototype.updateRulerPosition=function(e,t){var i=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler"));t?e.hRuler.element=i:e.vRuler.element=i,i&&(i.scrollLeft=2112-j.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin))},gf.prototype.updateIndicatorLines=function(e){var t=document.getElementById(e.element.id+"_hRuler_indicator_svg"),i=document.getElementById(e.element.id+"_hRuler_indicator"),n=document.getElementById(e.element.id+"_vRuler_indicator_svg"),r=document.getElementById(e.element.id+"_vRuler_indicator"),e=document.getElementById(e.element.id+"_pageContainer").getBoundingClientRect(),o=e.height,e=e.width;t.style.height=o+"px",i.setAttribute("y2",""+o),n.style.width=e+"px",r.setAttribute("x2",""+e)},gf.prototype.createIndicatorLines=function(e){var t,i,n,r,o;e.enableSelection&&(t=document.getElementById(e.element.id+"_viewerContainer"),i=document.getElementById(e.element.id+"_pageContainer"),t.getBoundingClientRect(),r=(i=i.getBoundingClientRect()).height,i=i.width,o=document.getElementById(e.element.id+"_hRuler"),n={id:e.element.id+"_hRuler_indicator_svg",width:"0.5px",height:r+"px",style:"position:absolute;z-index:1;display:none;"},n=this.createSvgElement("svg",n),o={x1:0,y1:o.getBoundingClientRect().height+5,x2:0,y2:r,"stroke-width":.5,stroke:"black"},(r=this.createSvgElement("line",o)).setAttribute("id",e.element.id+"_hRuler_indicator"),n.appendChild(r),t.insertBefore(n,t.firstChild),o=document.getElementById(e.element.id+"_vRuler"),r={id:e.element.id+"_vRuler_indicator_svg",width:i+"px",height:"0.5px",style:"position:absolute;z-index:1;display:none;"},n=this.createSvgElement("svg",r),r={x1:o.getBoundingClientRect().width+5,y1:0,x2:i,y2:0,"stroke-width":.5,stroke:"black"},(o=this.createSvgElement("line",r)).setAttribute("id",e.element.id+"_vRuler_indicator"),n.appendChild(o),t.insertBefore(n,t.firstChild))},gf.prototype.updateIndentMarkers=function(e){var t,i,n,r,o,s,a;_.isNullOrUndefined(e)||_.isNullOrUndefined(e.element)||_.isNullOrUndefined(e.element.id)||_.isNullOrUndefined(e.hRuler)||_.isNullOrUndefined(e.hRuler.zeroPosition)||(a=void 0,t=e.element.id,i=j.convertPointToPixel(1584-e.selectionModule.sectionFormat.leftMargin),n=this.getRulerGeometry(e),(this.position.paragraph.paragraphFormat.bidi||this.position.paragraph.isInsideTable&&this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi)&&(i-=n.width/e.zoomFactor-j.convertPointToPixel(this.position.paragraph.bodyWidget.sectionFormat.rightMargin+this.position.paragraph.bodyWidget.sectionFormat.leftMargin)),n=_.isNullOrUndefined(this.position.paragraph.absoluteXPosition)?this.position.paragraph.x:parseFloat(this.position.paragraph.absoluteXPosition.x.toString()),r=_.isNullOrUndefined(this.position.paragraph.absoluteXPosition)?this.position.paragraph.width:parseFloat(this.position.paragraph.absoluteXPosition.width.toString()),this.position.paragraph.paragraphFormat.bidi&&(i=j.convertPointToPixel(1584-e.selectionModule.sectionFormat.leftMargin-(e.selectionModule.sectionFormat.pageWidth-e.selectionModule.sectionFormat.leftMargin-e.selectionModule.sectionFormat.rightMargin))),o=document.getElementById(e.element.id+"_leftIndent"),s=document.getElementById(e.element.id+"_rightIndent"),o=this.position.paragraph.paragraphFormat.bidi?(o.setAttribute("title",this.locale.getConstant("Right Indent")),s.setAttribute("title",this.locale.getConstant("Left Indent")),i+n+r):(o.setAttribute("title",this.locale.getConstant("Left Indent")),s.setAttribute("title",this.locale.getConstant("Right Indent")),i+n),s=this.position.paragraph.paragraphFormat.firstLineIndent,a=document.getElementById(t+"_leftIndent"),_.isNullOrUndefined(a)||("Pages"===e.layoutType?a.style.left=o*e.zoomFactor-6+"px":"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width,a.style.left=(o=i+n+r)+"px"):(o=(i=e.hRuler.zeroPosition*e.zoomFactor-20)+n*e.zoomFactor,a.style.left=o+"px"))),a=document.getElementById(t+"_hangingIndent"),_.isNullOrUndefined(a)||("Pages"===e.layoutType?a.style.left=o*e.zoomFactor-6+"px":"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width,a.style.left=(o=i+n+r)+"px"):(o=(i=e.hRuler.zeroPosition*e.zoomFactor-20)+n*e.zoomFactor,a.style.left=o+"px"))),a=document.getElementById(t+"_firstLineIndent"),"Pages"===e.layoutType?_.isNullOrUndefined(a)||(this.position.paragraph.paragraphFormat.bidi?a.style.left=(o-j.convertPointToPixel(s))*e.zoomFactor-6+"px":a.style.left=(o+j.convertPointToPixel(s))*e.zoomFactor-6+"px"):"Continuous"===e.layoutType&&(o=this.position.paragraph.paragraphFormat.bidi?(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width)+n+r-j.convertPointToPixel(s)*e.zoomFactor:(i=e.hRuler.zeroPosition*e.zoomFactor-20)+(n+j.convertPointToPixel(s))*e.zoomFactor,a.style.left=o+"px"),a=document.getElementById(t+"_rightIndent"),"Pages"===e.layoutType?(o=this.position.paragraph.paragraphFormat.bidi?i+n:i+n+r,_.isNullOrUndefined(a)||(a.style.left=o*e.zoomFactor-6+"px")):"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor,a.style.left=(o=i+n)+"px"):(o=(i=e.hRuler.zeroPosition*e.zoomFactor-20)+(n+r)*e.zoomFactor,a.style.left=o+"px")))},gf.prototype.updateTabStopMarkers=function(e){if(!(_.isNullOrUndefined(e)||_.isNullOrUndefined(e.element)||_.isNullOrUndefined(e.element.id)||_.isNullOrUndefined(e.hRuler)||_.isNullOrUndefined(e.hRuler.zeroPosition))){var t=new _.L10n("documenteditor",e.defaultLocale),i=(t.setLocale(e.locale),e.element.id);document.getElementById(i+"_markIndicator").style.display="Pages"===e.layoutType?"block":"none";for(var n=this.position.paragraph.paragraphFormat.tabs,r=e.zoomFactor,o=this.getRulerSize(e),s=j.convertNodeListToArray(document.querySelectorAll(".e-de-ruler-tab")),a=0;a<n.length;a++){var l=n[parseInt(a.toString(),10)],d=l.tabJustification,h=e.element.id+"_"+d+"Tab_"+a.toString(),h=document.getElementById(h);_.isNullOrUndefined(h)?"List"!==d&&this.renderTab(e,o,l,d,a,t):(!_.isNullOrUndefined(s)&&0<s.length&&s.splice(s.indexOf(h),1),l=this.position.paragraph.paragraphFormat.bidi?j.convertPointToPixel(1584-l.position):j.convertPointToPixel(1584+l.position),h.style.left="Center"===d||"Decimal"===d?l*r-4+"px":"Right"===d?l*r-5.5+"px":l*r-1.5+"px")}if(!_.isNullOrUndefined(s))for(a=0;a<s.length;a++){var c=s[parseInt(a.toString(),10)];_.isNullOrUndefined(c)||c.parentNode.removeChild(c)}}},gf.prototype.renderRulerMargins=function(e,t,i){var n=this.getRulerSize(e),r=this.getRulerGeometry(e),o=(t?e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.x:(e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.y,n.height),2112*e.zoomFactor),s=t?"margin-left:"+o+"px;":"margin-top:"+o+"px;",a=t?n.height:r.height-j.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin+e.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin)*e.zoomFactor;if(t)for(var l,d,h,c=1;c<=13;c++)(h=document.getElementById(e.element.id+"_hRuler_Margin"+c))||(l="height:"+a+"px;overflow:hidden;width:"+(r.width-j.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin+e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)*e.zoomFactor)+"px;position:absolute;font-size:9px;text-align: left;z-index: -1;display: block"+s,d={id:e.element.id+"_hRuler_Margin"+c,style:l,class:"e-de-ruler-margin"},h=this.createHtmlElement("div",d)),i.appendChild(h);else h||(h=document.getElementById(e.element.id+"_vRuler_Margin"),l="height:"+a+"px;overflow:hidden;width:"+n.width+"px;position:absolute;font-size:9px;text-align: left;z-index: -1;"+s,d={id:e.element.id+"_vRuler_Margin",style:l,class:"e-de-ruler-margin"},h=this.createHtmlElement("div",d)),i.appendChild(h)},gf.prototype.updateRulerMargins=function(e){var t=this.getRulerGeometry(e),i=e.hRuler.zeroPosition*e.zoomFactor,n=(this.updateHorizontalRulerMargin(e),document.getElementById(e.element.id+"_vRuler_Margin")),t=t.height-j.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin*e.zoomFactor+e.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin*e.zoomFactor);n.style.marginTop=i+"px",n.style.height=t+"px"},gf.prototype.updateHorizontalRulerMargin=function(e){var t=e.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns,i=e.hRuler.zeroPosition*e.zoomFactor,n=!1,r=this.position.paragraph.paragraphFormat.bidi,o=!1,s=j.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin-72),a=j.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin-72),l=(this.position.paragraph.isInsideTable&&(o=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi),this.getRulerGeometry(e).width-j.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor+e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin*e.zoomFactor));(r||o)&&(i=e.hRuler.zeroPosition*e.zoomFactor-l);for(var d=0;d<13;d++){var h,c=document.getElementById(e.element.id+"_hRuler_Margin"+(d+1));c&&(0===t.length&&!n||"Continuous"===e.layoutType&&!n?(r||o?(h=e.hRuler.zeroPosition*e.zoomFactor-l,c.style.marginLeft=h+"px"):c.style.marginLeft=i+"px",c.style.display="block","Continuous"===e.layoutType?(h=_.isNullOrUndefined(this.position.paragraph.absoluteXPosition)?this.position.paragraph.width:parseFloat(this.position.paragraph.absoluteXPosition.width.toString()),c.style.width=h*e.zoomFactor+"px"):c.style.width=l+"px",n=!0):t.length>=d+1&&"Pages"===e.layoutType?(i=(c.style.marginLeft=i+"px",(i-=(s+a)/t.length*e.zoomFactor)+(t[parseInt(d.toString(),10)].width+t[parseInt(d.toString(),10)].space)*e.zoomFactor),c.style.display="block",c.style.width=(t[parseInt(d.toString(),10)].width-(s+a)/t.length)*e.zoomFactor+"px"):c.style.display="none")}},gf.prototype.resizeVRulerMargins=function(e,t,i,n,r,o,s){var a=document.getElementById(s.element.id+"_vRuler_Margin"),l=this.getRulerGeometry(s);e?(a.style.height=(l.height-j.convertPointToPixel(s.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin*s.zoomFactor+o)).toString()+"px",r.scrollTop=t<o?i-j.convertPointToPixel(o-t):i+j.convertPointToPixel(t-o)):(e=j.convertPixelToPoint(l.height)-o,a.style.height=(l.height-j.convertPointToPixel(s.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin*s.zoomFactor+e)).toString()+"px")},gf.prototype.resizeRulerMargins=function(e,t,i,n,r,o,s,a){var s=document.getElementById(a.element.id+(s?"_hRuler_Margin1":"_vRuler_Margin")),l=this.getRulerGeometry(a);!_.isNullOrUndefined(e)&&e?(s.style.width=(l.width-j.convertPointToPixel(a.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin*a.zoomFactor+o)).toString()+"px",r.scrollLeft=t<o?i-j.convertPointToPixel(o-t):i+j.convertPointToPixel(t-o)):(e=j.convertPixelToPoint(l.width)-o,s.style.width=(l.width-j.convertPointToPixel(a.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin*a.zoomFactor+e)).toString()+"px")},gf.prototype.getRulerOrigin=function(){j.convertPointToPixel(1584)},gf.prototype.renderIndents=function(d,B,e,R,t){var o,s,r,a,l,h,c,p,u,g,m,f,y,v,w,b,x,i,n,C,I,k,F,P,T,S,H=this,N=document.getElementById(d.element.id+"_hRuler"),W=document.getElementById(d.element.id+"_firstLineIndent"),O=(W||(i="left:"+(j.convertPointToPixel(d.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)-6)*d.zoomFactor+"px;",n="height:"+(e.height-3)/2+"px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;"+i,C={id:d.element.id+"_firstLineIndent",style:n,"data-name":"FirstLineIndent",class:"e-de-ruler-indent"},(W=this.createHtmlElement("div",C)).setAttribute("title",t.getConstant("First Line Indent")),I={id:d.element.id+"_firstLineIndent_svg",width:e.width+"px",height:(e.height-3)/2+"px",style:"position:inherit;left:0px"},(k=this.createSvgElement("svg",I)).setAttribute("fill","none"),(F=this.createSvgElement("path",{style:"position:inherit;left:0px"})).setAttribute("class","e-de-ruler-indent-svg"),F.setAttribute("d","M 0.5 0.5 H 11.5 V 2.7128 L 6 5.4211 L 0.5 2.7128 V 0.5 Z"),F.setAttribute("fill","white"),F.setAttribute("stroke","#A1A1A1"),k.appendChild(F),W.appendChild(k),N.append(W),W.addEventListener("dblclick",function(e){d.showDialog("Paragraph"),e.stopPropagation()}),o=!1,r=j.getNumberFromString(W.style.left),j.getNumberFromString(W.style.left),W.addEventListener("mouseenter",function(e){d.isOnIndent=!0}),W.addEventListener("mouseleave",function(e){d.isOnIndent=!1}),W.addEventListener("mousedown",function(e){o=!0,s=e.clientX-W.getBoundingClientRect().left,r=j.getNumberFromString(W.style.left);var t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin)*d.zoomFactor,i=(d.selectionModule.paragraphFormat.bidi&&(t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin-(d.selectionModule.sectionFormat.pageWidth-d.selectionModule.sectionFormat.leftMargin-d.selectionModule.sectionFormat.rightMargin))*d.zoomFactor),(t="Continuous"===d.layoutType&&(t=d.hRuler.zeroPosition*d.zoomFactor-20,d.selectionModule.paragraphFormat.bidi)?d.hRuler.zeroPosition*d.zoomFactor-20-d.viewer.clientArea.width*d.zoomFactor:t)+e.clientX-s-N.getBoundingClientRect().left),n=d.documentHelper.currentPage.boundingRectangle.x,n=("Continuous"===d.layoutType?0:n)+(i-t)+6,i=document.getElementById(d.element.id+"_hRuler_indicator_svg");i.style.left=n+"px",i.style.display="block",e.stopPropagation()}),document.addEventListener("mousemove",function(e){var t,i,n,r;o&&(r=i=t=void 0,n=document.getElementById(d.element.id+"_rightIndent"),n=j.getNumberFromString(n.style.left),"Pages"===d.layoutType?d.selectionModule.paragraphFormat.bidi?(i=(t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin-(d.selectionModule.sectionFormat.pageWidth-d.selectionModule.sectionFormat.leftMargin-d.selectionModule.sectionFormat.rightMargin))*d.zoomFactor)-6+j.convertPointToPixel(d.selectionModule.sectionFormat.pageWidth)*d.zoomFactor,r=n+j.convertPointToPixel(42)*d.zoomFactor):(r=(t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin)*d.zoomFactor)-6,i=n-j.convertPointToPixel(42)*d.zoomFactor):"Continuous"===d.layoutType&&(H.position.paragraph.paragraphFormat.bidi?(t=d.hRuler.zeroPosition*d.zoomFactor-20-d.viewer.clientArea.width*d.zoomFactor,i=d.hRuler.zeroPosition*d.zoomFactor-20+40-6,r=n+j.convertPointToPixel(42)*d.zoomFactor):(r=(t=d.hRuler.zeroPosition*d.zoomFactor-20)-6,i=n-j.convertPointToPixel(42)*d.zoomFactor)),(n=t+e.clientX-s-N.getBoundingClientRect().left)<r?n=r:i<n&&(n=i),W.style.left=n+"px",e=d.documentHelper.currentPage.boundingRectangle.x,r=(e="Continuous"===d.layoutType?0:e)+(n-t)+6,document.getElementById(d.element.id+"_hRuler_indicator_svg").style.left=r+"px")}),document.addEventListener("mouseup",function(){var e;o&&(o=!1,e=j.getNumberFromString(W.style.left),parseInt(W.style.left.replace("px",""),10)<0&&(e*=-1),d.selectionModule.paragraphFormat.bidi?d.editorModule.applyRulerMarkerValues("firstLineIndent",e,r):d.editorModule.applyRulerMarkerValues("firstLineIndent",r,e),r=e,document.getElementById(d.element.id+"_hRuler_indicator_svg").style.display="none")})),document.getElementById(d.element.id+"_hangingIndent")),E=(O||(i="left:"+(j.convertPointToPixel(d.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)-6)+"px;",n="height:"+e.height/2+"px;top:"+((e.height-3)/2+1)+"px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;"+i,C={id:d.element.id+"_hangingIndent",style:n,"data-name":"HangingIndent",class:"e-de-ruler-indent"},(O=this.createHtmlElement("div",C)).setAttribute("title",t.getConstant("Hanging Indent")),I={id:d.element.id+"_hangingIndent_svg",width:e.width+"px",height:(e.height-3)/2+"px",style:"position:inherit;left:0px"},(k=this.createSvgElement("svg",I)).setAttribute("fill","none"),(F=this.createSvgElement("path",{style:"position:inherit;left:0px"})).setAttribute("class","e-de-ruler-indent-svg"),F.setAttribute("d","M 0.5 5.3211 H 11.5 V 3.1083 L 6 0.4 L 0.5 3.1083 V 5.3211 Z"),F.setAttribute("fill","white"),F.setAttribute("stroke","#A1A1A1"),k.appendChild(F),O.appendChild(k),N.append(O),O.addEventListener("dblclick",function(e){d.showDialog("Paragraph"),e.stopPropagation()}),a=!1,h=j.getNumberFromString(O.style.left),j.getNumberFromString(O.style.left),O.addEventListener("mouseenter",function(e){d.isOnIndent=!0}),O.addEventListener("mouseleave",function(e){d.isOnIndent=!1}),O.addEventListener("mousedown",function(e){a=!0,l=e.clientX-O.getBoundingClientRect().left,h=j.getNumberFromString(O.style.left);var t,i=document.getElementById(d.element.id+"_rightIndent"),i=j.getNumberFromString(i.style.left),i=("Pages"===d.layoutType?p=d.selectionModule.paragraphFormat.bidi?(t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin-(d.selectionModule.sectionFormat.pageWidth-d.selectionModule.sectionFormat.leftMargin-d.selectionModule.sectionFormat.rightMargin))*d.zoomFactor,c=i+j.convertPointToPixel(42)*d.zoomFactor,t-6+j.convertPointToPixel(d.selectionModule.sectionFormat.pageWidth)*d.zoomFactor):(t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin)*d.zoomFactor,c=t-6,i-j.convertPointToPixel(42)*d.zoomFactor):"Continuous"===d.layoutType&&(H.position.paragraph.paragraphFormat.bidi?(t=d.hRuler.zeroPosition*d.zoomFactor-20-d.viewer.clientArea.width*d.zoomFactor,p=d.hRuler.zeroPosition*d.zoomFactor-20+40-6,c=i+j.convertPointToPixel(42)*d.zoomFactor):(t=d.hRuler.zeroPosition*d.zoomFactor-20,c=t-6,p=i-j.convertPointToPixel(42)*d.zoomFactor)),u=document.getElementById(d.element.id+"_leftIndent"),t+e.clientX-l-N.getBoundingClientRect().left),n=d.documentHelper.currentPage.boundingRectangle.x,n=("Continuous"===d.layoutType?0:n)+(i-t)+6,i=document.getElementById(d.element.id+"_hRuler_indicator_svg");i.style.left=n+"px",i.style.display="block",e.stopPropagation()}),document.addEventListener("mousemove",function(e){var t,i;a&&(t=void 0,"Pages"===d.layoutType?t=d.selectionModule.paragraphFormat.bidi?j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin-(d.selectionModule.sectionFormat.pageWidth-d.selectionModule.sectionFormat.leftMargin-d.selectionModule.sectionFormat.rightMargin))*d.zoomFactor:j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin)*d.zoomFactor:"Continuous"===d.layoutType&&(t=H.position.paragraph.paragraphFormat.bidi?d.hRuler.zeroPosition*d.zoomFactor-20-d.viewer.clientArea.width*d.zoomFactor:d.hRuler.zeroPosition*d.zoomFactor-20),e=t+e.clientX-l-N.getBoundingClientRect().left,p<e?e=p:e<c&&(e=c),u.style.left=e+"px",O.style.left=e+"px",i=d.documentHelper.currentPage.boundingRectangle.x,i=(i="Continuous"===d.layoutType?0:i)+(e-t)+6,document.getElementById(d.element.id+"_hRuler_indicator_svg").style.left=i+"px")}),document.addEventListener("mouseup",function(){var e;a&&(a=!1,e=j.getNumberFromString(O.style.left),parseInt(O.style.left.replace("px",""),10)<0&&(e*=-1),d.selectionModule.paragraphFormat.bidi?d.editorModule.applyRulerMarkerValues("hangingIndent",e,h):d.editorModule.applyRulerMarkerValues("hangingIndent",h,e),h=e,document.getElementById(d.element.id+"_hRuler_indicator_svg").style.display="none")})),document.getElementById(d.element.id+"_leftIndent")),L=(E||(n="height:4px;top:11px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;"+(i="left:"+(j.convertPointToPixel(d.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)-6)+"px;"),C={id:d.element.id+"_leftIndent",style:n,class:"e-de-ruler-indent"},(E=this.createHtmlElement("div",C)).setAttribute("title",t.getConstant("Left Indent")),I={id:d.element.id+"_leftIndent_svg",width:e.width+"px",height:"4px",style:"position:inherit;left:0px"},(k=this.createSvgElement("svg",I)).setAttribute("fill","none"),(F=this.createSvgElement("path",{style:"position:inherit;left:0px"})).setAttribute("class","e-de-ruler-indent-svg"),F.setAttribute("d","M 0.5 3.5 H 11.5 V 0.5 H 0.5 V 3.5 Z"),F.setAttribute("fill","white"),F.setAttribute("stroke","#A1A1A1"),k.appendChild(F),E.appendChild(k),N.append(E),E.addEventListener("dblclick",function(e){d.showDialog("Paragraph"),e.stopPropagation()}),g=!1,f=j.getNumberFromString(E.style.left),j.getNumberFromString(E.style.left),E.addEventListener("mouseenter",function(e){d.isOnIndent=!0}),E.addEventListener("mouseleave",function(e){d.isOnIndent=!1}),E.addEventListener("mousedown",function(e){g=!0,m=e.clientX-E.getBoundingClientRect().left,f=j.getNumberFromString(E.style.left),y=j.getNumberFromString(W.style.left),v=y-f,W=document.getElementById(d.element.id+"_firstLineIndent");var t,i=document.getElementById(d.element.id+"_rightIndent"),i=j.getNumberFromString(i.style.left),i=("Pages"===d.layoutType?x=d.selectionModule.paragraphFormat.bidi?(t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin-(d.selectionModule.sectionFormat.pageWidth-d.selectionModule.sectionFormat.leftMargin-d.selectionModule.sectionFormat.rightMargin))*d.zoomFactor,w=i+j.convertPointToPixel(42)*d.zoomFactor,b=t-6+j.convertPointToPixel(d.selectionModule.sectionFormat.pageWidth)*d.zoomFactor,j.getNumberFromString(O.style.left)-i<=j.getNumberFromString(W.style.left)-i):(t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin)*d.zoomFactor,w=t-6,b=i-j.convertPointToPixel(42)*d.zoomFactor,i-j.getNumberFromString(O.style.left)<=i-j.getNumberFromString(W.style.left)):"Continuous"===d.layoutType&&(x=H.position.paragraph.paragraphFormat.bidi?(t=d.hRuler.zeroPosition*d.zoomFactor-20-d.viewer.clientArea.width*d.zoomFactor,b=d.hRuler.zeroPosition*d.zoomFactor-20+40-6,w=i+j.convertPointToPixel(42)*d.zoomFactor,j.getNumberFromString(O.style.left)-i<=j.getNumberFromString(W.style.left)-i):(t=d.hRuler.zeroPosition*d.zoomFactor-20,w=t-6,b=i-j.convertPointToPixel(42)*d.zoomFactor,i-j.getNumberFromString(O.style.left)<=i-j.getNumberFromString(W.style.left))),t+e.clientX-m-N.getBoundingClientRect().left),n=d.documentHelper.currentPage.boundingRectangle.x,n=("Continuous"===d.layoutType?0:n)+(i-t)+6,i=document.getElementById(d.element.id+"_hRuler_indicator_svg");i.style.left=n+"px",i.style.display="block",e.stopPropagation()}),document.addEventListener("mousemove",function(e){var t,i;g&&(i=t=void 0,d.selectionModule.paragraphFormat.bidi?("Pages"===d.layoutType?t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin-(d.selectionModule.sectionFormat.pageWidth-d.selectionModule.sectionFormat.leftMargin-d.selectionModule.sectionFormat.rightMargin))*d.zoomFactor:"Continuous"===d.layoutType&&(t=d.hRuler.zeroPosition*d.zoomFactor-20-d.viewer.clientArea.width*d.zoomFactor),i=t+e.clientX-m-N.getBoundingClientRect().left,x?b<i+v&&(i=b-v):b<i&&(i=b),x?i<w&&(i=w):i+v<w&&(i=w-v)):("Pages"===d.layoutType?t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin)*d.zoomFactor:"Continuous"===d.layoutType&&(t=d.hRuler.zeroPosition*d.zoomFactor-20),i=t+e.clientX-m-N.getBoundingClientRect().left,x?b<i&&(i=b):b<i+v&&(i=b-v),x?i+v<w&&(i=w-v):i<w&&(i=w)),O.style.left=i+"px",E.style.left=i+"px",W.style.left=y+(i-f)+"px",e=d.documentHelper.currentPage.boundingRectangle.x,e=(e="Continuous"===d.layoutType?0:e)+(i-t)+6,document.getElementById(d.element.id+"_hRuler_indicator_svg").style.left=e+"px")}),document.addEventListener("mouseup",function(){var e;g&&(g=!1,e=j.getNumberFromString(E.style.left),parseInt(E.style.left.replace("px",""),10)<0&&(e*=-1),d.selectionModule.paragraphFormat.bidi?d.editorModule.applyRulerMarkerValues("leftIndent",e,f):d.editorModule.applyRulerMarkerValues("leftIndent",f,e),f=e,document.getElementById(d.element.id+"_hRuler_indicator_svg").style.display="none")})),document.getElementById(d.element.id+"_rightIndent"));L||(n="height:7px;top:8px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+(i="left:"+(d.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.width-j.convertPointToPixel(d.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin)-6)+"px;"),C={id:d.element.id+"_rightIndent",style:n,class:"e-de-ruler-indent"},(L=this.createHtmlElement("div",C)).setAttribute("title",t.getConstant("Right Indent")),I={id:d.element.id+"_rightIndent_svg",width:e.width+"px",height:"7px",style:"position:inherit;left:0px"},(k=this.createSvgElement("svg",I)).setAttribute("fill","none"),(F=this.createSvgElement("path",{style:"position:inherit;left:0px"})).setAttribute("class","e-de-ruler-indent-svg"),F.setAttribute("d","M 0.5 6.5 H 11.5 V 4.2872 L 6 1.5789 L 0.5 4.2872 V 6.5 Z"),F.setAttribute("fill","white"),F.setAttribute("stroke","#A1A1A1"),k.appendChild(F),L.appendChild(k),N.append(L),L.addEventListener("dblclick",function(e){d.showDialog("Paragraph"),e.stopPropagation()}),P=!1,S=j.getNumberFromString(L.style.left),j.getNumberFromString(L.style.left),L.addEventListener("mouseenter",function(e){d.isOnIndent=!0}),L.addEventListener("mouseleave",function(e){d.isOnIndent=!1}),L.addEventListener("mousedown",function(e){P=!0,T=e.clientX-L.getBoundingClientRect().left,S=j.getNumberFromString(L.style.left);var t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin)*d.zoomFactor,i=(d.selectionModule.paragraphFormat.bidi&&(t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin-(d.selectionModule.sectionFormat.pageWidth-d.selectionModule.sectionFormat.leftMargin-d.selectionModule.sectionFormat.rightMargin))*d.zoomFactor),(t="Continuous"===d.layoutType&&(t=d.hRuler.zeroPosition*d.zoomFactor-20,d.selectionModule.paragraphFormat.bidi)?d.hRuler.zeroPosition*d.zoomFactor-20-d.viewer.clientArea.width*d.zoomFactor:t)+e.clientX-T-N.getBoundingClientRect().left),n=d.documentHelper.currentPage.boundingRectangle.x,n=("Continuous"===d.layoutType?0:n)+(i-t)+6,i=document.getElementById(d.element.id+"_hRuler_indicator_svg");i.style.left=n+"px",i.style.display="block",e.stopPropagation()}),document.addEventListener("mousemove",function(e){var t,i,n,r,o,s,a,l;P&&(n=t=void 0,l=document.getElementById(d.element.id+"_leftIndent"),i=document.getElementById(d.element.id+"_firstLineIndent"),o=r=void 0,o=d.selectionModule.paragraphFormat.bidi?("Pages"===d.layoutType?t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin-(d.selectionModule.sectionFormat.pageWidth-d.selectionModule.sectionFormat.leftMargin-d.selectionModule.sectionFormat.rightMargin))*d.zoomFactor:"Continuous"===d.layoutType&&(t=d.hRuler.zeroPosition*d.zoomFactor-20-d.viewer.clientArea.width*d.zoomFactor),n=t+e.clientX-T-N.getBoundingClientRect().left,s=j.getNumberFromString(l.style.left)-n<=j.getNumberFromString(i.style.left)-n?l:i,r=(a=j.getNumberFromString(s.style.left))-j.convertPointToPixel(42)*d.zoomFactor,t-6):("Pages"===d.layoutType?t=j.convertPointToPixel(1584-d.selectionModule.sectionFormat.leftMargin)*d.zoomFactor:"Continuous"===d.layoutType&&(t=d.hRuler.zeroPosition*d.zoomFactor-20),s=(n=t+e.clientX-T-N.getBoundingClientRect().left)-j.getNumberFromString(l.style.left)<=n-j.getNumberFromString(i.style.left)?l:i,a=j.getNumberFromString(s.style.left),r=t+d.documentHelper.currentPage.boundingRectangle.width*d.zoomFactor-6,a+j.convertPointToPixel(42)*d.zoomFactor),n<o?n=o:r<n&&(n=r),L.style.left=n+"px",e=d.documentHelper.currentPage.boundingRectangle.x,l=(e="Continuous"===d.layoutType?0:e)+(n-t)+6,document.getElementById(d.element.id+"_hRuler_indicator_svg").style.left=l+"px")}),document.addEventListener("mouseup",function(){var e;P&&(P=!1,e=j.getNumberFromString(L.style.left),d.selectionModule.paragraphFormat.bidi?d.editorModule.applyRulerMarkerValues("rightIndent",S,e):d.editorModule.applyRulerMarkerValues("rightIndent",e,S),S=e,document.getElementById(d.element.id+"_hRuler_indicator_svg").style.display="none")})),this.updateIndentMarkers(d)},gf.prototype.updateRuler=function(e,t){e.rulerHelper&&e.documentEditorSettings&&!e.documentEditorSettings.showRuler||e.isReadOnlyMode||_.isNullOrUndefined(e.hRuler)&&_.isNullOrUndefined(e.vRuler)||(e.selectionModule.isForward?this.position=e.selectionModule.start:this.position=e.selectionModule.end,this.updateRulerDimension(e,e.hRuler,0,t),this.updateRulerDimension(e,e.vRuler,0,t),this.updateRulerMargins(e),this.updateIndentMarkers(e),this.updateTabStopMarkers(e),this.position.paragraph.isInsideTable?this.updateTableMarkers(e,e.hRuler):this.removeTableMarkers(e,e.hRuler),this.updateIndicatorLines(e))},gf.prototype.removeTableMarkers=function(e,t){var i=j.convertNodeListToArray(document.querySelectorAll(".e-de-ruler-table-marker"));if(!_.isNullOrUndefined(i))for(var n=0;n<i.length;n++){var r=i[parseInt(n.toString(),10)];_.isNullOrUndefined(r)||r.parentNode.removeChild(r)}},gf.prototype.updateTableMarkers=function(e,t){var i=j.convertNodeListToArray(document.querySelectorAll(".e-de-ruler-table-marker"));(_.isNullOrUndefined(i)||this.position.paragraph.isInsideTable)&&this.renderTableMarkers(e,t)},gf.prototype.renderTableMarkers=function(s,i){for(var n,a=this,l=(this.removeTableMarkers(s,s.hRuler),this.position.paragraph.containerWidget.ownerTable,this.position.paragraph.associatedCell.ownerRow.clone().childWidgets),d=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi?l.length:0,h=(this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi&&l.reverse(),document.getElementById(s.element.id+"_hRuler")),c=this,e=0;e<=l.length;e++)!function(e){var r,o=document.getElementById(s.element.id+"_tableMarker_"+d),t=void 0,t=0===e?"left:"+((n=(l[parseInt(e.toString(),10)].x-l[parseInt(e.toString(),10)].margin.left)*s.zoomFactor+h.scrollLeft)-4)+"px;":"left:"+((n+=(l[e-1].width+l[e-1].margin.left+l[e-1].margin.right)*s.zoomFactor)-4)+"px;",t="height:"+i.thickness+"px;overflow:hidden;width:10px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+t,t={id:s.element.id+"_tableMarker_"+d,class:"e-de-ruler-table-marker",style:t},o=c.createHtmlElement("div",t),t=new _.L10n("documenteditor",s.defaultLocale),t=(o.setAttribute("title",t.getConstant("Move Table Column")),{id:s.element.id+"_tableMarker_svg"+e,width:"9px",height:"11px",style:"position:inherit;left:0px;top:3px;"}),e=c.createSvgElement("svg",t),t=(e.setAttribute("fill","none"),c.createSvgElement("path",{style:"position:inherit;left:0px;"}));t.setAttribute("class","e-de-ruler-table-svg"),t.setAttribute("d","M1 1V0H2V1H3V0H4V1H5V0H6V1H7V2H6V3H7V4H6V5H7V6H6V7H7V8H0V7H1V6H0V5H1V4H0V3H1V2H0V1H1ZM2 2V3H3V2H2ZM4 2V3H5V2H4ZM5 4H4V5H5V4ZM5 6H4V7H5V6ZM3 7V6H2V7H3ZM2 5H3V4H2V5Z"),t.setAttribute("fill","#A1A1A1"),e.appendChild(t),o.appendChild(e),h.append(o),c.position.paragraph.associatedCell.ownerTable.tableFormat.bidi?d--:d++,o.addEventListener("dblclick",function(e){s.showDialog("TableProperties"),e.stopPropagation()}),o.addEventListener("mousedown",function(e){r=e.clientX-o.getBoundingClientRect().left,s.startXPosition=j.convertPixelToPoint(e.clientX),s.isTableMarkerDragging=!0;var t=new nl(e.clientX,e.clientY),t=s.viewer.findFocusedPage(t,!0,!0),i=(e.currentTarget instanceof HTMLElement&&(n=(n=e.currentTarget.id.split("_"))[n.length-1],n=parseInt(n,10)),s.selectionModule.end.paragraph.containerWidget.ownerTable),i=(s.editorModule.tableResize.currentResizingTable=i,s.editorModule.tableResize.resizeNode=0,s.editorModule.tableResize.resizerPosition=n,s.editorModule.tableResize.startingPoint.x=t.x,s.editorModule.tableResize.startingPoint.y=t.y,s.editorHistoryModule.initResizingHistory(t,s.editorModule.tableResize),j.convertPointToPixel(1584-s.selectionModule.sectionFormat.leftMargin)*s.zoomFactor),n=i+e.clientX-r-h.getBoundingClientRect().left,t=s.documentHelper.currentPage.boundingRectangle.x+(n-i)+6,e=document.getElementById(s.element.id+"_hRuler_indicator_svg");e.style.left=t-6+"px",e.style.display="block"}),document.addEventListener("mousemove",function(e){var t,i;!s.isDestroyed&&s.documentEditorSettings.showRuler&&s.isTableMarkerDragging&&(i=document.getElementById(s.element.id+"_hRuler"),t=j.convertPointToPixel(1584-s.selectionModule.sectionFormat.leftMargin)*s.zoomFactor,s.selectionModule.end.paragraph.associatedCell.ownerTable.tableFormat.bidi&&(t-=a.getRulerGeometry(s).width-j.convertPointToPixel(s.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin*s.zoomFactor+s.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin*s.zoomFactor)),e=t+e.clientX-r-i.getBoundingClientRect().left,o.style.left=e+"px",i=s.documentHelper.currentPage.boundingRectangle.x+(e-t)+6,document.getElementById(s.element.id+"_hRuler_indicator_svg").style.left=i-6+"px")}),document.addEventListener("mouseup",function(e){var t;!s.isDestroyed&&s.documentEditorSettings.showRuler&&s.isTableMarkerDragging&&(t=new nl(e.clientX,e.clientY),e=a.position.paragraph.associatedCell.ownerTable.tableFormat.bidi?s.startXPosition-j.convertPixelToPoint(e.clientX):j.convertPixelToPoint(e.clientX)-s.startXPosition,s.editorModule.tableResize.handleResizing(t,!0,e/s.zoomFactor),s.editorModule.tableResize.updateResizingHistory(s.viewer.findFocusedPage(t,!0,!0)),s.isTableMarkerDragging=!1,document.getElementById(s.element.id+"_hRuler_indicator_svg").style.display="none")})}(e)},gf.prototype.updateRulerDimension=function(e,t,i,n){var r,o,s="Horizontal"===t.orientation,a=(this.getRulerSize(e),this.getRulerGeometry(e)),l=(this.updateRulerDiv(e,a,s,t),this.updateRulerSpace(e,a,s,t),this.updateMargin(t,e,s),t.length=e.zoomFactor<1?2*t.zeroPosition/e.zoomFactor:2*t.zeroPosition*e.zoomFactor,t.element);s?l.style.marginLeft=("Pages"===e.layoutType?e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.x:0)+"px":(l.parentElement.style.display="Pages"===e.layoutType?"block":"none",l.style.marginTop=e.selectionModule.getPageTop(e.selectionModule.end.paragraph.bodyWidget.page)+"px"),n&&(t.offset=i,t.scale=e.zoomFactor,t.length=e.zoomFactor<1?2*t.zeroPosition/e.zoomFactor:2*t.zeroPosition*e.zoomFactor,t.updateRuler()),s?"Pages"===e.layoutType?(r=this.position.paragraph.paragraphFormat.bidi,o=!1,this.position.paragraph.isInsideTable&&(o=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi),r||o?(n=a.width-j.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor),l.scrollLeft=e.hRuler.zeroPosition*e.zoomFactor-n):l.scrollLeft=(t.zeroPosition-j.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin))*e.zoomFactor):(r=this.position.paragraph.paragraphFormat.bidi,o=!1,this.position.paragraph.isInsideTable&&(o=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi),l.scrollLeft=r||o?(t.zeroPosition-e.viewer.clientActiveArea.width)*e.zoomFactor-20:t.zeroPosition*e.zoomFactor-20):l.scrollTop=(t.zeroPosition-j.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin))*e.zoomFactor},gf.prototype.updateRulerSpace=function(e,t,i,n){var r=document.getElementById(e.element.id+(i?"_hRuler_ruler_space":"_vRuler_ruler_space"));r&&e&&t&&(r.style.width=(i?t.width+2*n.segmentWidth:n.thickness)+"px",r.style.height=(i?n.thickness:t.height+2*n.segmentWidth)+"px")},gf.prototype.updateRulerDiv=function(e,t,i,n){var r=document.getElementById(e.element.id+(i?"_hRuler":"_vRuler"));r&&e&&t&&(r.style.width=(i?"Continuous"===e.layoutType?t.width/e.zoomFactor:t.width:n.thickness)+"px",r.style.height=(i?n.thickness:t.height)+"px",r=document.getElementById(e.element.id+"_overlapRuler"))&&(i?r.style.height:r.style.width,n.thickness),i&&this.hRulerBottom&&(t=document.getElementById(e.element.id+"_pageContainer"),this.hRulerBottom.style.width=t.getBoundingClientRect().width+"px")},gf.prototype.getRulerGeometry=function(e){this.getRulerSize(e);var t=e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.height*e.zoomFactor,e=e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.width*e.zoomFactor;return new df(e,t)},gf.prototype.getVerticalHeight=function(e){var t=j.convertPixelToPoint(e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.height),i=e.element.getBoundingClientRect().height;return t<i?t:i-e.documentHelper.pages[0].boundingRectangle.y},gf.prototype.renderTab=function(s,e,t,i,n,r){var a,l,d,h,o,c,p,u=this,g=document.getElementById(s.element.id+"_hRuler"),m=s.documentHelper.zoomFactor;switch(i){case"Left":var f=document.getElementById(s.element.id+"_LeftTab_"+n);f||(y="",_.isNullOrUndefined(t)||(y="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?j.convertPointToPixel(1584-t.position):j.convertPointToPixel(1584+t.position))-1.5)*m+"px;")),v={id:s.element.id+"_LeftTab_"+n,class:"e-de-ruler-tab e-de-ruler-tab-left",style:y,"data-name":"LeftTab"},(f=this.createHtmlElement("div",v)).setAttribute("title",r.getConstant("Left Tab")),w={id:s.element.id+"_leftTab_svg",width:e.width/2+"px",height:e.height/2+"px",style:"position:inherit;left:0px"},(b=this.createSvgElement("svg",w)).setAttribute("fill","none"),(x=this.createSvgElement("path",{style:"position:inherit;left:0px"})).setAttribute("class","e-de-ruler-tab-svg"),x.setAttribute("d","M3 5H7V7H1V1H3V5Z"),x.setAttribute("fill","#605E5C"),x.setAttribute("stroke","#A1A1A1"),b.appendChild(x),f.appendChild(b),g.append(f));break;case"Center":f=document.getElementById(s.element.id+"_CenterTab_"+n);f||(y="",_.isNullOrUndefined(t)||(y="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?j.convertPointToPixel(1584-t.position):j.convertPointToPixel(1584+t.position))-4)*m+"px;")),v={id:s.element.id+"_CenterTab_"+n,class:"e-de-ruler-tab e-de-ruler-tab-center",style:y,"data-name":"CenterTab"},(f=this.createHtmlElement("div",v)).setAttribute("title",r.getConstant("Center Tab")),w={id:s.element.id+"_centerTab_svg",width:e.width/2+"px",height:e.height/2+"px",style:"position:inherit;left:0px"},(b=this.createSvgElement("svg",w)).setAttribute("fill","none"),(x=this.createSvgElement("path",{style:"position:inherit;left:0px"})).setAttribute("class","e-de-ruler-tab-svg"),x.setAttribute("d","M5 5H8V7H0V5H3V1H5V5Z"),x.setAttribute("fill","#605E5C"),x.setAttribute("stroke","#A1A1A1"),b.appendChild(x),f.appendChild(b),g.append(f));break;case"Right":f=document.getElementById(s.element.id+"_RightTab_"+n);f||(y="",_.isNullOrUndefined(t)||(y="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?j.convertPointToPixel(1584-t.position):j.convertPointToPixel(1584+t.position))-5.5)*m+"px;")),v={id:s.element.id+"_RightTab_"+n,class:"e-de-ruler-tab e-de-ruler-tab-right",style:y,"data-name":"RightTab"},(f=this.createHtmlElement("div",v)).setAttribute("title",r.getConstant("Right Tab")),w={id:s.element.id+"_rightTab_svg",width:e.width/2+"px",height:e.height/2+"px",style:"position:inherit;left:0px"},(b=this.createSvgElement("svg",w)).setAttribute("fill","none"),(x=this.createSvgElement("path",{style:"position:inherit;left:0px"})).setAttribute("class","e-de-ruler-tab-svg"),x.setAttribute("d","M5 5V1H7V7H1V5H5Z"),x.setAttribute("fill","#605E5C"),x.setAttribute("stroke","#A1A1A1"),b.appendChild(x),f.appendChild(b),g.append(f));break;case"Decimal":f=document.getElementById(s.element.id+"_DecimalTab_"+n);f||(y="",_.isNullOrUndefined(t)||(y="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?j.convertPointToPixel(1584-t.position):j.convertPointToPixel(1584+t.position))*m-4)+"px;")),v={id:s.element.id+"_DecimalTab_"+n,class:"e-de-ruler-tab e-de-ruler-tab-decimal",style:y,"data-name":"DecimalTab"},(f=this.createHtmlElement("div",v)).setAttribute("title",r.getConstant("Decimal Tab")),w={id:s.element.id+"_decimalTab_svg",width:e.width/2+"px",height:e.height/2+"px",style:"position:inherit;left:0px"},(b=this.createSvgElement("svg",w)).setAttribute("fill","none"),(x=this.createSvgElement("path",{style:"position:inherit;left:0px"})).setAttribute("class","e-de-ruler-tab-svg"),x.setAttribute("d","M6 0H4V6H0V8H4H6H10V6H6V0Z"),x.setAttribute("fill","#605E5C"),x.setAttribute("clip-rule","evenodd"),x.setAttribute("fill-rule","evenodd"),x.setAttribute("stroke","#A1A1A1"),b.appendChild(x),f.appendChild(b),g.append(f));break;case"Bar":var y,v,w,b,x=document.getElementById(s.element.id+"_BarTab_"+n);x||(y="",_.isNullOrUndefined(t)||(y="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?j.convertPointToPixel(1584-t.position):j.convertPointToPixel(1584+t.position))-1.5)*m+"px;")),v={id:s.element.id+"_BarTab_"+n,class:"e-de-ruler-tab e-de-ruler-tab-bar",style:y,"data-name":"BarTab"},(x=this.createHtmlElement("div",v)).setAttribute("title",r.getConstant("Bar Tab")),w={id:s.element.id+"_barTab_svg",width:e.width/2+"px",height:e.height/2+"px",style:"position:inherit;left:0px"},(b=this.createSvgElement("svg",w)).setAttribute("fill","none"),(f=this.createSvgElement("rect",{style:"position:inherit;left:0px"})).setAttribute("width","2"),f.setAttribute("height","8"),f.setAttribute("fill","#605E5C"),f.setAttribute("stroke","#A1A1A1"),b.appendChild(f),x.appendChild(b),g.append(x))}_.isNullOrUndefined(t)||(a=document.getElementById(s.element.id+"_"+i+"Tab_"+n),_.isNullOrUndefined(t)||a.addEventListener("dblclick",function(e){s.showTabDialog(),e.stopPropagation()}),l=!1,j.getNumberFromString(a.style.left),j.getNumberFromString(a.style.left),h=a.getAttribute("data-name"),o=this.position.paragraph,p=void(c=0),a.addEventListener("mousedown",function(e){e.stopPropagation(),l=!0,d=e.clientX-a.getBoundingClientRect().left,j.getNumberFromString(a.style.left),c=parseInt(a.id.split("_")[a.id.split("_").length-1],10),p=o.paragraphFormat.tabs[parseInt(c.toString(),10)],u.currentTabStopElement=a;var t=j.convertPointToPixel(1584-s.selectionModule.sectionFormat.leftMargin)*s.zoomFactor,e=(t="Continuous"===s.layoutType&&(t=s.hRuler.zeroPosition*s.zoomFactor-20,u.position.paragraph.paragraphFormat.bidi)?s.hRuler.zeroPosition*s.zoomFactor-20-s.viewer.clientArea.width*s.zoomFactor:t)+e.clientX-d-g.getBoundingClientRect().left,i=s.documentHelper.currentPage.boundingRectangle.x,i=("Continuous"===s.layoutType?0:i)+(e-t),e=document.getElementById(s.element.id+"_hRuler_indicator_svg");e.style.left=i+"px",e.style.display="block"}),a.addEventListener("mouseup",function(){_.isNullOrUndefined(u.currentTabStopElement)||(u.currentTabStopElement=void 0)}),document.addEventListener("mousemove",function(e){var t,i,n,r,o;l&&(t=void 0,"Continuous"===s.layoutType?(t=s.hRuler.zeroPosition*s.zoomFactor-20,u.position.paragraph.paragraphFormat.bidi&&(t=s.hRuler.zeroPosition*s.zoomFactor-20-s.viewer.clientArea.width*s.zoomFactor)):"Pages"===s.layoutType&&(t=j.convertPointToPixel(1584-s.selectionModule.sectionFormat.leftMargin)*s.zoomFactor,u.position.paragraph.bidi)&&(t=j.convertPointToPixel(1584+s.selectionModule.sectionFormat.rightMargin-s.selectionModule.sectionFormat.pageWidth)*s.zoomFactor),e=t+e.clientX-d-g.getBoundingClientRect().left,n=t,r=document.getElementById(s.element.id+"_rightIndent"),i=r=j.getNumberFromString(r.style.left),o=document.getElementById(s.element.id+"_leftIndent"),n=o=j.getNumberFromString(o.style.left),u.position.paragraph.paragraphFormat.bidi&&(n=r,i=o),i+="CenterTab"===h||"DecimalTab"===h?4:"RightTab"===h?5.5:1.5,e<n?e=n:i<e&&(e=i),a.style.left=e+"px",r=s.documentHelper.currentPage.boundingRectangle.x,o=(r="Continuous"===s.layoutType?0:r)+(e-t)+6,document.getElementById(s.element.id+"_hRuler_indicator_svg").style.left=o+"px")}),document.addEventListener("mouseup",function(){var e;l&&!_.isNullOrUndefined(p)&&(_.isNullOrUndefined(u.currentTabStopElement)||"none"!==u.currentTabStopElement.style.display?(e=j.getNumberFromString(a.style.left),s.editorModule.removeTabStops([o],[p]),e=j.convertPixelToPoint(e/s.zoomFactor)-1584,e=o.paragraphFormat.bidi?-1*e:e,p.position=e,s.editorModule.updateTabStopCollection(o,[p])):(s.editorModule.removeTabStops([o],[p]),u.currentTabStopElement.parentNode.removeChild(u.currentTabStopElement)),u.updateTabStopMarkers(s),l=!1,document.getElementById(s.element.id+"_hRuler_indicator_svg").style.display="none",u.currentTabStopElement=void 0)}))},gf.prototype.updateMargin=function(e,t,i){i?(e.startMargin=t.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin,e.endMargin=t.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin):(e.startMargin=t.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin,e.endMargin=t.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin)},gf.prototype.getTabJustification=function(e){switch(e){case"LeftTab":return"Left";case"CenterTab":return"Center";case"RightTab":return"Right";case"DecimalTab":return"Decimal";case"BarTab":return"Bar"}return"Left"},gf.prototype.getRulerSize=function(e){return new df(15,15)};var uf=gf;function gf(){}ff.prototype.getModuleName=function(){return"DateContentDialog"},ff.prototype.initDateContentDialog=function(e){this.target=_.createElement("div");var t=_.createElement("div"),i=(this.target.appendChild(t),new v.Calendar({change:this.valueChange.bind(this)}));this.documentHelper.owner.editor.dateValue&&(i.value=new Date(this.documentHelper.owner.editor.dateValue)),i.appendTo(t),this.documentHelper.owner.editor.dateValue&&(i.value=new Date(this.documentHelper.owner.editor.dateValue))},ff.prototype.valueChange=function(e){var t;e.event&&(e=e.value.toLocaleDateString(),t=this.documentHelper.owner.editor.getContentControl(),this.documentHelper.owner.editor.dropDownChange(t,e),this.documentHelper.hideDialog())},ff.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.localeValue=e,this.target||this.initDateContentDialog(e),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog.header=e.getConstant("Datepicker Content Control"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},ff.prototype.destroy=function(){if(this.calendar&&(this.calendar.destroy(),this.calendar=void 0),this.documentHelper=void 0,!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}};var mf=ff;function ff(e){var t=this;this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.documentHelper.updateFocus()},this.documentHelper=e}vf.prototype.getModuleName=function(){return"ContentControlPropertiesDialog"},vf.prototype.createInputElement=function(e,t,i){return _.createElement("input",{attrs:{type:e},id:t,className:i})},vf.prototype.initContentControlPropertiesDialog=function(e,t){var i=this,n=(this.target=_.createElement("div",{className:"e-de-hyperlink"}),_.createElement("div")),r=_.createElement("div"),o=_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("General")}),o=(r.appendChild(o),_.createElement("div",{className:"e-de-dlg-container"})),o=(this.titleText=_.createElement("input",{className:"e-input"}),o.appendChild(this.titleText),r.appendChild(o),this.tagText=_.createElement("input",{className:"e-input"}),r.appendChild(this.tagText),_.createElement("div",{className:"e-de-container-row"})),s=(o.style.paddingTop="10px",this.fontColorDiv=_.createElement("div",{className:"e-de-font-dlg-display"}),_.createElement("label",{className:"e-de-font-dlg-header-font-color e-de-font-color-margin",innerHTML:e.getConstant("Color")})),s=(this.fontColorDiv.appendChild(s),this.createInputElement("color",this.target.id+"_ColorDiv","e-de-font-dlg-color")),o=(this.fontColorDiv.appendChild(s),o.appendChild(this.fontColorDiv),r.appendChild(o),this.documentHelper.owner.documentEditorSettings.colorPickerSettings),a=o.columns,l=o.createPopupOnClick,d=o.cssClass,h=o.disabled,c=o.enablePersistence,p=o.inline,u=o.mode,g=o.modeSwitcher,m=o.noColor,f=o.presetColors,o=o.showButtons,u=(this.colorPicker=new D.ColorPicker({change:this.fontColorUpdate,value:"#000000",locale:this.documentHelper.owner.locale,enableOpacity:!1,mode:u,modeSwitcher:g,showButtons:o,columns:a,createPopupOnClick:l,cssClass:d,disabled:h,enablePersistence:c,inline:p,noColor:m,presetColors:f}),this.colorPicker.appendTo(s),_.createElement("div",{styles:"display:block"})),g=(r.appendChild(u),_.createElement("div",{styles:"display:block"})),o=(r.appendChild(g),_.createElement("input",{attrs:{type:"checkbox"}})),a=(g.appendChild(o),this.removeCheckBox=new H.CheckBox({label:e.getConstant("Remove content control when contents are edited"),cssClass:"e-de-para-dlg-cs-check-box"}),this.removeCheckBox.appendTo(o),o.setAttribute("aria-label",e.getConstant("Remove content control when contents are edited")),n.appendChild(r),_.createElement("div")),l=(a.style.paddingTop="10px",_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Locking")})),d=(a.appendChild(l),_.createElement("div",{styles:"display:block"})),h=(a.appendChild(d),_.createElement("input",{attrs:{type:"checkbox"}})),c=(d.appendChild(h),this.contentDeletedCheckBox=new H.CheckBox({label:e.getConstant("Content control cannot be deleted"),cssClass:"e-de-para-dlg-cs-check-box",change:function(e){e.checked?i.removeCheckBox.disabled=!0:i.removeCheckBox.disabled=!1,i.removeCheckBox.dataBind()}}),this.contentDeletedCheckBox.appendTo(h),h.setAttribute("aria-label",e.getConstant("Content control cannot be deleted")),_.createElement("div",{styles:"display:block"})),p=(a.appendChild(c),_.createElement("input",{attrs:{type:"checkbox"}})),m=(c.appendChild(p),this.contentEditedCheckBox=new H.CheckBox({label:e.getConstant("Contents cannot be edited"),cssClass:"e-de-para-dlg-cs-check-box"}),this.contentEditedCheckBox.appendTo(p),p.setAttribute("aria-label",e.getConstant("Contents cannot be edited")),n.appendChild(a),this.plainTextPropertiesDiv=_.createElement("div"),this.plainTextPropertiesDiv.style.marginTop="10px",this.plainTextPropertiesDiv.style.display="none",_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Plain Text properties")})),f=(this.plainTextPropertiesDiv.appendChild(m),_.createElement("input",{attrs:{type:"checkbox"}})),s=(this.plainTextPropertiesDiv.appendChild(f),this.multilineCheckBox=new H.CheckBox({label:e.getConstant("Allow carriage returns"),cssClass:"e-de-para-dlg-cs-check-box"}),this.multilineCheckBox.appendTo(f),f.setAttribute("aria-label",e.getConstant("Allow carriage returns")),n.appendChild(this.plainTextPropertiesDiv),this.dropDownPropertiesDiv=_.createElement("div"),this.dropDownPropertiesDiv.style.marginTop="10px",this.dropDownPropertiesDiv.style.display="none",_.createElement("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Drop_Down List properties")})),u=(this.dropDownPropertiesDiv.appendChild(s),_.createElement("div",{className:"e-bookmark-common"})),g=(this.dropDownPropertiesDiv.appendChild(u),_.createElement("div",{className:"e-bookmark-list"})),o=(u.appendChild(g),_.createElement("div",{className:"e-bookmark-textboxdiv"})),r=(g.appendChild(o),this.textBoxInput=_.createElement("input",{className:"e-input e-bookmark-textbox-input",id:"bookmark_text_box"}),this.textBoxInput.setAttribute("type","text"),this.textBoxInput.addEventListener("keyup",this.onKeyUpOnTextBox),this.textBoxInput.setAttribute("aria-label",e.getConstant("Display Text")),o.appendChild(this.textBoxInput),_.createElement("div",{className:"e-bookmark-textboxdiv"})),l=(g.appendChild(r),this.valueBoxInput=_.createElement("input",{className:"e-input e-bookmark-textbox-input",id:"bookmark_text_box"}),this.valueBoxInput.setAttribute("type","text"),this.valueBoxInput.addEventListener("keyup",this.onKeyUpOnTextBox),this.valueBoxInput.setAttribute("aria-label",e.getConstant("Value")),r.appendChild(this.valueBoxInput),_.createElement("div",{className:"e-bookmark-listViewDiv",id:"bookmark_listview",attrs:{tabindex:"-1",role:"listbox"}})),d=(g.appendChild(l),this.listviewInstance=new F.ListView({cssClass:"e-bookmark-listview",select:this.selectHandler,fields:{text:"value"}}),this.listviewInstance.appendTo(l),_.createElement("div",{className:"e-bookmark-button"})),h=(u.appendChild(d),_.createElement("div",{className:"e-bookmark-addbutton"})),c=(d.appendChild(h),_.createElement("button",{innerHTML:"Add",id:"add",attrs:{type:"button"}})),p=(c.setAttribute("aria-label",e.getConstant("Add")),h.appendChild(c),this.addButton=new H.Button({cssClass:"e-button-custom"}),this.addButton.disabled=!0,this.addButton.appendTo(c),c.addEventListener("click",this.setButtonClick.bind(this)),_.createElement("div",{className:"e-bookmark-deletebutton"})),a=(d.appendChild(p),_.createElement("button",{innerHTML:"Delete",id:"delete",attrs:{type:"button"}}));a.setAttribute("aria-label","Delete"),p.appendChild(a),this.deleteButton=new H.Button({cssClass:"e-button-custom"}),this.deleteButton.appendTo(a),a.addEventListener("click",this.clearButtonClick),n.appendChild(this.dropDownPropertiesDiv),this.target.appendChild(n),new D.TextBox({placeholder:e.getConstant("Title"),floatLabelType:"Always"},this.titleText),new D.TextBox({placeholder:e.getConstant("Tag"),floatLabelType:"Always"},this.tagText),new D.TextBox({placeholder:e.getConstant("Display Text"),floatLabelType:"Always"},this.textBoxInput),new D.TextBox({placeholder:e.getConstant("Value"),floatLabelType:"Always"},this.valueBoxInput)},vf.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.localeValue=e,this.target||this.initContentControlPropertiesDialog(e,!1),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),"none"===this.dropDownPropertiesDiv.style.display&&"none"===this.plainTextPropertiesDiv.style.display||(this.dropDownPropertiesDiv.style.display="none",this.plainTextPropertiesDiv.style.display="none"),this.documentHelper.dialog.header=e.getConstant("Content Control Properties"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.beforeOpen=this.loadPropertiesdialog,this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.applyProperties,buttonModel:{content:this.localeValue.getConstant("Ok"),cssClass:"e-flat e-para-okay",isPrimary:!0}},{click:this.closePropertiesDialog,buttonModel:{content:this.localeValue.getConstant("Cancel"),cssClass:"e-flat e-para-cancel"}}],this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},vf.prototype.enableOrDisableButton=function(){_.isNullOrUndefined(this.addButton)||(this.addButton.disabled=""===this.textBoxInput.value||""===this.valueBoxInput.value)},vf.prototype.unWireEventsAndBindings=function(){this.fontColor=void 0,this.currentContentControl=void 0,this.currentSelectedItem=void 0,this.convertedItems=[]},vf.prototype.destroy=function(){if(this.contentDeletedCheckBox&&(this.contentDeletedCheckBox.destroy(),this.contentDeletedCheckBox=void 0),this.contentEditedCheckBox&&(this.contentEditedCheckBox.destroy(),this.contentEditedCheckBox=void 0),this.removeCheckBox&&(this.removeCheckBox.destroy(),this.removeCheckBox=void 0),this.multilineCheckBox&&(this.multilineCheckBox.destroy(),this.multilineCheckBox=void 0),this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.textBoxInput&&(this.textBoxInput.remove(),this.textBoxInput=void 0),this.valueBoxInput&&(this.valueBoxInput.remove(),this.valueBoxInput=void 0),this.titleText&&(this.titleText.remove(),this.titleText=void 0),this.tagText&&(this.tagText.remove(),this.tagText=void 0),this.colorPicker&&this.colorPicker.destroy(),this.colorPicker=void 0,this.documentHelper=void 0,!_.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}};var yf=vf;function vf(e){var i=this;this.colorPicker=void 0,this.fontColor=void 0,this.characterFormat=void 0,this.clearButtonClick=function(e){i.textBoxInput.value="",i.valueBoxInput.value="";for(var t=0;t<i.convertedItems.length;t++)i.convertedItems[parseInt(t.toString(),10)].value===i.currentSelectedItem&&(i.currentContentControl.contentControlProperties.contentControlListItems.splice(t,1),i.convertedItems.splice(t,1));i.listviewInstance.dataSource=i.convertedItems.slice(),i.listviewInstance.dataBind()},this.setButtonClick=function(e){var t;_.isNullOrUndefined(i.textBoxInput.value)&&_.isNullOrUndefined(i.valueBoxInput.value)||((t=new Qh).displayText=i.textBoxInput.value||"",t.value=i.valueBoxInput.value||"",i.currentContentControl.contentControlProperties.contentControlListItems.push(t),t={displayText:t.displayText,value:t.value},i.convertedItems.push(t),i.listviewInstance.addItem([t])),i.textBoxInput.value="",i.valueBoxInput.value=""},this.onKeyUpOnTextBox=function(){i.enableOrDisableButton()},this.loadPropertiesdialog=function(){i.currentContentControl=i.documentHelper.owner.editor.getContentControl(),_.isNullOrUndefined(i.currentContentControl)||(i.contentEditedCheckBox.checked=i.currentContentControl.contentControlProperties.lockContents,i.contentDeletedCheckBox.checked=i.currentContentControl.contentControlProperties.lockContentControl,i.removeCheckBox.checked=i.currentContentControl.contentControlProperties.isTemporary,i.multilineCheckBox.checked=i.currentContentControl.contentControlProperties.multiline,i.colorPicker.value=i.currentContentControl.contentControlProperties.color,i.removeCheckBox.checked&&(i.contentEditedCheckBox.checked=!1),i.titleText.value=i.currentContentControl.contentControlProperties.title||"",i.tagText.value=i.currentContentControl.contentControlProperties.tag||"",i.fontColor=i.currentContentControl.contentControlProperties.color,"Text"===i.currentContentControl.contentControlProperties.type?i.plainTextPropertiesDiv.style.display="block":i.plainTextPropertiesDiv.style.display="none","ComboBox"===i.currentContentControl.contentControlProperties.type||"DropDownList"===i.currentContentControl.contentControlProperties.type?i.dropDownPropertiesDiv.style.display="block":i.dropDownPropertiesDiv.style.display="none",_.isNullOrUndefined(void 0!==i.currentContentControl.contentControlProperties.contentControlListItems))||(i.convertedItems=i.currentContentControl.contentControlProperties.contentControlListItems.map(function(e){var t,i={};for(t in e)i[""+t]=e[""+t];return i}),i.listviewInstance.dataSource=i.convertedItems,i.listviewInstance.dataBind()),i.documentHelper.updateFocus()},this.applyProperties=function(){_.isNullOrUndefined(i.fontColor)||(i.currentContentControl.contentControlProperties.color=i.fontColor);var e=i.documentHelper.owner.getImageContentControl();e instanceof E&&"Picture"==e.contentControlProperties.type&&(e.contentControlProperties.lockContents=i.contentEditedCheckBox.checked,e.contentControlProperties.lockContentControl=i.contentDeletedCheckBox.checked,e.contentControlProperties.isTemporary=i.removeCheckBox.checked,i.removeCheckBox.checked&&(e.contentControlProperties.lockContents=!1),e.contentControlProperties.title=void 0!==i.titleText.value?i.titleText.value:"",e.contentControlProperties.tag=void 0!==i.tagText.value?i.tagText.value:"",e.contentControlProperties.multiline=i.multilineCheckBox.checked),_.isNullOrUndefined(i.currentContentControl)||(i.currentContentControl.contentControlProperties.lockContents=i.contentEditedCheckBox.checked,i.currentContentControl.contentControlProperties.lockContentControl=i.contentDeletedCheckBox.checked,i.currentContentControl.contentControlProperties.isTemporary=i.removeCheckBox.checked,i.removeCheckBox.checked&&(i.currentContentControl.contentControlProperties.lockContents=!1),i.currentContentControl.contentControlProperties.title=void 0!==i.titleText.value?i.titleText.value:"",i.currentContentControl.contentControlProperties.tag=void 0!==i.tagText.value?i.tagText.value:"",i.currentContentControl.contentControlProperties.multiline=i.multilineCheckBox.checked),i.unWireEventsAndBindings(),i.documentHelper.dialog.hide(),i.documentHelper.viewer.updateScrollBars(),i.documentHelper.updateFocus()},this.closePropertiesDialog=function(){i.documentHelper.dialog.hide(),i.unWireEventsAndBindings(),i.documentHelper.updateFocus()},this.fontColorUpdate=function(e){_.isNullOrUndefined(e.currentValue)||(i.fontColor=e.currentValue.hex)},this.selectHandler=function(e){i.currentSelectedItem=e.text},this.documentHelper=e}bf.prototype.getModuleName=function(){return"PicContentControlDialog"},bf.prototype.show=function(){var e=new _.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.localeValue=e,this.documentHelper.dialog2.header=e.getConstant("Insert Pictures"),this.documentHelper.dialog2.showCloseIcon=!0,this.documentHelper.dialog2.allowDragging=!0,this.documentHelper.dialog2.position={X:"center",Y:"center"},this.documentHelper.dialog2.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog2.buttons=[{click:this.onInsertPicClick,buttonModel:{content:e.getConstant("Upload from computer"),iconCss:"e-icons e-de-ctnr-upload",iconPosition:"Left"}}],this.documentHelper.dialog2.dataBind(),this.documentHelper.dialog2.show()},bf.prototype.onImageChange=function(){var e=this,t=this.imagePicker.files[0],i=new FileReader;i.onload=function(){e.insertImage(i.result)},i.readAsDataURL(t)},bf.prototype.insertImage=function(e){var t=document.createElement("img"),i=this.documentHelper;this.container;t.addEventListener("load",function(){i.owner.editorModule.insertImageInternal(e,!0,this.width,this.height,this.alt),i.owner.selection.isImageSelected||(i.owner.selection.handleShiftLeftKey(),i.owner.editor.insertContentControl("Picture"))}),t.src=e},bf.prototype.destroy=function(){this.documentHelper=void 0,this.imagePicker&&(this.imagePicker.remove(),this.imagePicker=void 0)};var wf=bf;function bf(e){var t=this;this.onCancelButtonClick=function(){t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus()},this.onInsertPicClick=function(){t.documentHelper.dialog2.hide(),t.imagePicker=_.createElement("input",{attrs:{type:"file",accept:".jpg,.jpeg,.png,.bmp,.svg"},className:"e-de-ctnr-file-picker"}),_.Browser.isIE&&document.body.appendChild(t.imagePicker),t.imagePicker.value="",t.imagePicker.click(),_.EventHandler.add(t.imagePicker,"change",t.onImageChange,t)},this.documentHelper=e}xf=function(e,t){return(xf=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}))(e,t)};var xf,Cf,If=function(e,t){function i(){this.constructor=e}xf(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},p=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;0<=a;a--)(r=e[a])&&(s=(o<3?r(s):3<o?r(t,i,s):r(t,i))||s);return 3<o&&s&&Object.defineProperty(t,i,s),s},kf=function(o,s,a,l){return new(a=a||Promise)(function(e,t){function i(e){try{r(l.next(e))}catch(e){t(e)}}function n(e){try{r(l.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},Ff=function(n,r){var o,s,a,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,s&&(a=2&t[0]?s.return:t[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,t[1])).done)return a;switch(s=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,s=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))l.label=t[1];else if(6===t[0]&&l.label<a[1])l.label=a[1],a=t;else{if(!(a&&l.label<a[2])){a[2]&&l.ops.pop(),l.trys.pop();continue}l.label=a[2],l.ops.push(t)}}t=r.call(n,l)}catch(e){t=[6,e],s=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},Pf=(Cf=_.ChildProperty,If(Tf,Cf),p([_.Property(null)],Tf.prototype,"popupTarget",void 0),p([_.Property("#FFE97F")],Tf.prototype,"searchHighlightColor",void 0),p([_.Property(["Algerian","Arial","Calibri","Cambria","Cambria Math","Candara","Courier New","Georgia","Impact","Segoe Print","Segoe Script","Segoe UI","Symbol","Times New Roman","Verdana","Wingdings"])],Tf.prototype,"fontFamilies",void 0),p([_.Property({shadingColor:"#cfcfcf",applyShading:!0,selectionColor:"#cccccc",formFillingMode:"Popup"})],Tf.prototype,"formFieldSettings",void 0),p([_.Property({interval:2e3,itertationCount:5})],Tf.prototype,"autoResizeSettings",void 0),p([_.Property({roomName:"",editableRegionColor:"#22b24b",lockedRegionColor:"#f44336"})],Tf.prototype,"collaborativeEditingSettings",void 0),p([_.Property(1)],Tf.prototype,"printDevicePixelRatio",void 0),p([_.Property(!0)],Tf.prototype,"enableOptimizedTextMeasuring",void 0),p([_.Property(!0)],Tf.prototype,"allowDragAndDrop",void 0),p([_.Property(32767)],Tf.prototype,"maximumRows",void 0),p([_.Property(63)],Tf.prototype,"maximumColumns",void 0),p([_.Property(!1)],Tf.prototype,"showHiddenMarks",void 0),p([_.Property(!1)],Tf.prototype,"showBookmarks",void 0),p([_.Property(!0)],Tf.prototype,"highlightEditableRanges",void 0),p([_.Property(!0)],Tf.prototype,"optimizeSfdt",void 0),p([_.Property(!1)],Tf.prototype,"showRuler",void 0),p([_.Property({mode:"Picker",modeSwitcher:!0,showButtons:!0})],Tf.prototype,"colorPickerSettings",void 0),p([_.Property(!1)],Tf.prototype,"showNavigationPane",void 0),p([_.Property({mentionChar:"@"})],Tf.prototype,"mentionSettings",void 0),Tf);function Tf(){return null!==Cf&&Cf.apply(this,arguments)||this}Sf=_.ChildProperty,If(Nf,Sf),p([_.Property("Word2013")],Nf.prototype,"compatibilityMode",void 0);var Sf,Hf=Nf;function Nf(){return null!==Sf&&Sf.apply(this,arguments)||this}Wf=_.ChildProperty,If(Ef,Wf),p([_.Property(2e3)],Ef.prototype,"interval",void 0),p([_.Property(5)],Ef.prototype,"iterationCount",void 0);var Wf,Of=Ef;function Ef(){return null!==Wf&&Wf.apply(this,arguments)||this}Lf=_.Component,If(u,Lf),Bf=u,Object.defineProperty(u.prototype,"enableHeaderAndFooter",{get:function(){return this.enableHeaderFooterIn},set:function(e){!(this.enableHeaderFooterIn=e)&&this.selectionModule&&this.selectionModule.isWebLayout&&(this.selectionModule.isWebLayout=!1),this.viewer.updateScrollBars()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"pageCount",{get:function(){return!this.isDocumentLoaded||_.isNullOrUndefined(this.viewer)||this.viewer instanceof Wd?1:this.documentHelper.pages.length},enumerable:!0,configurable:!0}),u.prototype.getComments=function(){var e=[];if(0<this.documentHelper.comments.length)for(var t=[],i=0,n=this.documentHelper.comments;i<n.length;i++){for(var r=n[i],t=[],o={author:r.author,isResolved:r.isResolved||!1,dateTime:this.editor.parseDateTime(r.createdDate)},s=0,a=r.replyComments;s<a.length;s++){var l=a[s],d={author:l.author,isResolved:!!l.isResolved&&r.isResolved,dateTime:this.editor.parseDateTime(l.createdDate)},l=j.parseCommentAsText(l),d=new I(r.commentId,d,l);t.push(d)}o={id:r.commentId,text:j.parseCommentAsText(r),commentProperties:o,replies:t};e.push(o)}return e},Object.defineProperty(u.prototype,"selection",{get:function(){return this.selectionModule||this.checkModuleInjection("Selection",this.enableSelection),this.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"editor",{get:function(){return this.editorModule||this.checkModuleInjection("Editor",this.enableEditor),this.editorModule},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"editorHistory",{get:function(){return this.editorHistoryModule||this.checkModuleInjection("EditorHistory",this.enableEditorHistory),this.editorHistoryModule},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"search",{get:function(){return this.searchModule||this.checkModuleInjection("Search",this.enableSearch),this.searchModule},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"contextMenu",{get:function(){return this.contextMenuModule||this.checkModuleInjection("ContextMenu",this.enableContextMenu),this.contextMenuModule},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"spellCheckDialog",{get:function(){return this.spellCheckDialogModule||this.checkModuleInjection("SpellCheck",this.enableSpellCheck),this.spellCheckDialogModule},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"spellChecker",{get:function(){return this.spellCheckerModule||this.checkModuleInjection("SpellCheck",this.enableSpellCheck),this.spellCheckerModule},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"containerId",{get:function(){return this.element.id},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isDocumentLoaded",{get:function(){return this.isDocumentLoadedIn},set:function(e){this.isDocumentLoadedIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isDocumentEmpty",{get:function(){if(1===this.documentHelper.pages.length){var e=this.documentHelper.pages[0],t=e.headerWidget,i=e.footerWidget,n=!0,r=!0;if(_.isNullOrUndefined(t)||_.isNullOrUndefined(t.firstChild)||t.firstChild instanceof G&&t.firstChild.isEmpty()||(n=!1),_.isNullOrUndefined(i)||_.isNullOrUndefined(i.firstChild)||i.firstChild instanceof G&&i.firstChild.isEmpty()||(r=!1),n&&r){t=e.bodyWidgets[0];if(_.isNullOrUndefined(t.nextWidget)){i=t.firstChild;if(i instanceof G&&i.isEmpty()&&_.isNullOrUndefined(i.nextWidget))return!0}}}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"revisions",{get:function(){return _.isNullOrUndefined(this.revisionsInternal)&&(this.revisionsInternal=new tl(this)),this.revisionsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"enableHistoryMode",{get:function(){return this.enableEditorHistory&&!_.isNullOrUndefined(this.editorHistoryModule)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"documentStart",{get:function(){if(!_.isNullOrUndefined(this.selectionModule))return this.selectionModule.getDocumentStart();this.checkModuleInjection("Selection",this.enableSelection)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"documentEnd",{get:function(){if(!_.isNullOrUndefined(this.selectionModule))return this.selectionModule.getDocumentEnd();this.checkModuleInjection("Selection",this.enableSelection)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isReadOnlyMode",{get:function(){return this.isReadOnly||_.isNullOrUndefined(this.editorModule)||_.isNullOrUndefined(this.selectionModule)||!_.isNullOrUndefined(this.editorModule)&&this.editorModule.restrictEditing},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isSpellCheck",{get:function(){return this.enableSpellCheck&&this.spellCheckerModule.enableSpellCheck},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"enableImageResizerMode",{get:function(){return this.enableImageResizer&&!_.isNullOrUndefined(this.imageResizerModule)},enumerable:!0,configurable:!0}),u.prototype.preRender=function(){var e=this;this.documentEditorSettings&&this.documentEditorSettings.enableOptimizedTextMeasuring?Bf.Inject(Km):Bf.Inject(Xm),this.findResultsList=[],setTimeout(function(){_.isNullOrUndefined(e.documentEditorSettings.popupTarget)&&(e.documentEditorSettings.popupTarget=document.body)},0),_.isNullOrUndefined(this.element)||""!==this.element.id||(this.element.id=j.getUniqueElementId()),this.refreshing&&this.initHelper()},u.prototype.initHelper=function(){this.documentHelper=new kd(this),"Pages"===this.layoutType?this.viewer=new Sd(this):this.viewer=new Wd(this),this.parser=new Ym(this.documentHelper)},u.prototype.render=function(){var e;_.isNullOrUndefined(this.element)||((e=this.element).style.minHeight="200px",e.style.minWidth="200px",""!==this.height&&(this.element.style.height=_.formatUnit(this.height)),""!==this.width&&(this.element.style.width=_.formatUnit(this.width))),this.textMeasureHelper=this.optimizedModule||this.regularModule,_.isNullOrUndefined(this.textMeasureHelper)&&(this.textMeasureHelper=new Km(this.documentHelper)),this.documentHelper.initializeComponents(),this.openBlank(),this.renderComplete(),this.renderRulers(),this.renderNavigationPane(),this.createdTriggered=!0},u.prototype.renderRulers=function(){this.rulerHelper=new uf,this.rulerContainer=this.rulerHelper.renderOverlapElement(this),this.rulerHelper.renderRuler(this,!0),this.rulerHelper.renderRuler(this,!1),this.rulerHelper.renderRulerMarkerIndicatorElement(this),this.rulerHelper.createIndicatorLines(this),this.showHideRulers()},u.prototype.showHideRulers=function(){var e;this.rulerHelper&&this.documentEditorSettings&&!_.isNullOrUndefined(!this.documentEditorSettings.showRuler)&&(e=this.documentEditorSettings.showRuler&&!this.isReadOnlyMode,this.rulerHelper.hideTabStopSwitch(e),this.rulerHelper.hideRulerBottom(e),this.vRuler&&this.vRuler.showHideRuler(e),this.hRuler)&&this.hRuler.showHideRuler(e)},u.prototype.renderNavigationPane=function(){!this.isReadOnly&&this.optionsPaneModule&&this.optionsPaneModule.showHideOptionsPane(this.documentEditorSettings.showNavigationPane)},u.prototype.getModuleName=function(){return"DocumentEditor"},u.prototype.onPropertyChanged=function(e,t){for(var i,n,r=this,o=0,s=Object.keys(e);o<s.length;o++)switch(s[o]){case"enableTrackChanges":this.notify(Le,e),this.getSettingData("enableTrackChanges",e.enableTrackChanges),this.documentHelper.isTrackedOnlyMode&&!e.enableTrackChanges&&(this.enableTrackChanges=!0);break;case"autoResizeOnVisibilityChange":e.autoResizeOnVisibilityChange&&this.documentHelper.triggerAutoResizeInterval();break;case"zoomFactor":this.viewer&&t.zoomFactor!==e.zoomFactor&&(this.documentHelper.zoomFactor=e.zoomFactor,this.rulerHelper&&this.documentEditorSettings&&this.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!0),this.enableCollaborativeEditing)&&this.collaborativeEditingHandlerModule&&this.collaborativeEditingHandlerModule.updateCaretPosition();break;case"layoutType":this.selectionModule&&this.selectionModule.isWebLayout||(this.viewer.destroy(),"Pages"===this.layoutType?this.viewer=new Sd(this):(!0===this.enableHeaderAndFooter&&this.selectionModule.closeHeaderFooter(),this.viewer=new Wd(this)),this.selectionModule.start.paragraph.containerWidget instanceof q&&(this.selectionModule.clearSelectionHighlightInSelectedWidgets(),this.selectionModule.selectContent(this.documentStart,!0)),this.editorModule.layoutWholeDocument(!0),setTimeout(function(){r.fireViewChange()},200));break;case"locale":this.localizeDialogs();break;case"isReadOnly":!_.isNullOrUndefined(this.optionsPaneModule)&&this.optionsPaneModule.isOptionsPaneShow&&(this.optionsPaneModule.showHideOptionsPane(!1),this.documentHelper.updateFocus()),this.showComments&&this.commentReviewPane.showHidePane(!0,"Comments"),this.commentReviewPane.enableDisableItems(),this.trackChangesPane.enableDisableButton(!this.isReadOnly&&!this.documentHelper.isDocumentProtected),this.showHideRulers();break;case"currentUser":case"userColor":this.selectionModule&&this.documentHelper.isDocumentProtected&&this.selectionModule.highlightEditRegion(),this.viewer.updateScrollBars();break;case"pageGap":case"pageOutline":this.viewer.updateScrollBars();break;case"zIndex":this.documentHelper.dialog&&(this.documentHelper.dialog.zIndex=e.zIndex+10),this.documentHelper.dialog2&&(this.documentHelper.dialog2.zIndex=e.zIndex);break;case"showComments":this.viewer&&e.showComments!==t.showComments&&this.documentHelper.showComments(e.showComments),this.viewer.updateScrollBars();break;case"enableRtl":this.localizeDialogs(e.enableRtl);break;case"enableComment":this.viewer&&this.showComments&&(this.showComments=!!this.showComments&&this.enableComment,this.documentHelper.showComments(e.enableComment)),this.viewer.updateScrollBars();break;case"showRevisions":this.isReadOnly||this.documentHelper.isDocumentProtected?this.documentHelper.showRevisions(!1):this.viewer&&this.documentHelper.showRevisions(e.showRevisions),this.viewer.updateScrollBars();break;case"documentSettings":_.isNullOrUndefined(e.documentSettings.compatibilityMode)||(i=t.documentSettings.compatibilityMode,n=e.documentSettings.compatibilityMode,("Word2013"==i&&"Word2013"!=n||"Word2013"!=i&&"Word2013"==n)&&this.documentHelper.compatibilityMode!==n&&(this.documentHelper.compatibilityMode=n,this.editorModule.layoutWholeDocument(!0))),this.viewer.updateScrollBars();break;case"documentEditorSettings":_.isNullOrUndefined(e.documentEditorSettings.enableOptimizedTextMeasuring)||(this.documentHelper.heightInfoCollection={},e.documentEditorSettings.enableOptimizedTextMeasuring?this.textMeasureHelper=this.optimizedModule:this.textMeasureHelper=this.regularModule,this.viewer.updateScrollBars()),(!_.isNullOrUndefined(e.documentEditorSettings.showHiddenMarks)&&e.documentEditorSettings.showHiddenMarks!==t.documentEditorSettings.showHiddenMarks||!_.isNullOrUndefined(e.documentEditorSettings.showBookmarks)&&e.documentEditorSettings.showBookmarks!==t.documentEditorSettings.showBookmarks)&&(this.trackChangesPane&&this.trackChangesPane.showHiddenParaMark(),this.viewer.updateScrollBars()),_.isNullOrUndefined(e.documentEditorSettings.highlightEditableRanges)||this.documentHelper&&this.documentHelper.restrictEditingPane&&(this.documentHelper.restrictEditingPane.highlightCheckBox.checked=e.documentEditorSettings.highlightEditableRanges),_.isNullOrUndefined(e.documentEditorSettings.colorPickerSettings)||e.documentEditorSettings.colorPickerSettings&&this.applyColorPickerProperties(e),_.isNullOrUndefined(e.documentEditorSettings.showRuler)||(this.showHideRulers(),e.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!0)),_.isNullOrUndefined(e.documentEditorSettings.showNavigationPane)||!this.isReadOnly&&this.optionsPaneModule&&this.optionsPaneModule.showHideOptionsPane(this.documentEditorSettings.showNavigationPane),this.enableCollaborativeEditing&&this.collaborativeEditingHandlerModule&&this.collaborativeEditingHandlerModule.updateCaretPosition();break;case"height":this.element.style.height=_.formatUnit(this.height),this.resize();break;case"width":this.element.style.width=_.formatUnit(this.width),this.resize();break;case"enableAutoFocus":this.enableAutoFocus=e.enableAutoFocus}},u.prototype.applyColorPickerProperties=function(e){var t;e.documentEditorSettings.colorPickerSettings&&(t=e.documentEditorSettings.colorPickerSettings,!this.isReadOnly&&!_.isNullOrUndefined(t)&&this.bordersAndShadingDialogModule&&this.documentHelper.borderColorPicker&&this.documentHelper.shadingColorPicker&&(_.isNullOrUndefined(t.mode)||(this.documentHelper.borderColorPicker.mode=e.documentEditorSettings.colorPickerSettings.mode,this.documentHelper.shadingColorPicker.mode=e.documentEditorSettings.colorPickerSettings.mode),_.isNullOrUndefined(t.showButtons)||(this.documentHelper.borderColorPicker.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons,this.documentHelper.shadingColorPicker.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons),_.isNullOrUndefined(t.modeSwitcher)||(this.documentHelper.borderColorPicker.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher,this.documentHelper.shadingColorPicker.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher)),!this.isReadOnly&&!_.isNullOrUndefined(t)&&this.fontDialogModule&&this.documentHelper.fontColor&&(_.isNullOrUndefined(t.mode)||(this.documentHelper.fontColor.mode=e.documentEditorSettings.colorPickerSettings.mode),_.isNullOrUndefined(t.showButtons)||(this.documentHelper.fontColor.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons),_.isNullOrUndefined(t.modeSwitcher)||(this.documentHelper.fontColor.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher)),!this.isReadOnly&&!_.isNullOrUndefined(t)&&this.styleDialogModule&&this.documentHelper.colorPicker&&(_.isNullOrUndefined(t.mode)||(this.documentHelper.colorPicker.mode=e.documentEditorSettings.colorPickerSettings.mode),_.isNullOrUndefined(t.showButtons)||(this.documentHelper.colorPicker.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons),_.isNullOrUndefined(t.modeSwitcher)||(this.documentHelper.colorPicker.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher)),_.isNullOrUndefined(t)||(_.isNullOrUndefined(t.mode)||(this.documentHelper.fontColorInputElement.mode=e.documentEditorSettings.colorPickerSettings.mode,this.documentHelper.shadingBtn.mode=e.documentEditorSettings.colorPickerSettings.mode,this.documentHelper.borderBtn.mode=e.documentEditorSettings.colorPickerSettings.mode),_.isNullOrUndefined(t.showButtons)||(this.documentHelper.fontColorInputElement.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons,this.documentHelper.shadingBtn.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons,this.documentHelper.borderBtn.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons),_.isNullOrUndefined(t.modeSwitcher))||(this.documentHelper.fontColorInputElement.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher,this.documentHelper.shadingBtn.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher,this.documentHelper.borderBtn.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher))},u.prototype.localizeDialogs=function(e){var t;""!==this.locale&&((t=new _.L10n("documenteditor",this.defaultLocale)).setLocale(this.locale),_.isNullOrUndefined(e)||(this.documentHelper.dialog.enableRtl=e,this.documentHelper.dialog2.enableRtl=e),this.optionsPaneModule&&this.optionsPaneModule.initOptionsPane(t,e),this.paragraphDialogModule&&this.paragraphDialogModule.initParagraphDialog(t),this.footNotesDialogModule&&this.footNotesDialogModule.notesDialog(t,e),this.pageSetupDialogModule&&this.pageSetupDialogModule.initPageSetupDialog(t,e),this.columnsDialogModule&&this.columnsDialogModule.initColumnsDialog(t,e),this.fontDialogModule&&this.fontDialogModule.initFontDialog(t,e),this.hyperlinkDialogModule&&this.hyperlinkDialogModule.initHyperlinkDialog(t,e),this.contextMenuModule&&(this.contextMenuModule.contextMenuInstance.destroy(),this.contextMenuModule.initContextMenu(t,e)),this.listDialogModule&&this.listDialogModule.initListDialog(t,e),this.tablePropertiesDialogModule&&this.tablePropertiesDialogModule.initTablePropertyDialog(t,e),this.bordersAndShadingDialogModule&&this.bordersAndShadingDialogModule.initBordersAndShadingsDialog(t,e),this.cellOptionsDialogModule&&this.cellOptionsDialogModule.initCellMarginsDialog(t,e),this.tableOptionsDialogModule&&this.tableOptionsDialogModule.initTableOptionsDialog(t,e),this.tableDialogModule&&this.tableDialogModule.initTableDialog(t),this.styleDialogModule&&this.styleDialogModule.initStyleDialog(t,e),this.tabDialogModule&&this.tabDialogModule.initTabsDialog(t,e),this.tableOfContentsDialogModule&&this.tableOfContentsDialogModule.initTableOfContentDialog(t,e),this.commentReviewPane)&&this.commentReviewPane.parentPaneElement&&(this.enableRtl?_.classList(this.commentReviewPane.parentPaneElement,["e-rtl"],[]):_.classList(this.commentReviewPane.parentPaneElement,[],["e-rtl"]))},u.prototype.setDefaultCharacterFormat=function(e){this.characterFormat=JSON.parse(j.sanitizeString(JSON.stringify(e))),this.documentHelper.setDefaultDocumentFormat(),_.isNullOrUndefined(this.selectionModule)||this.selectionModule.retrieveCurrentFormatProperties()},u.prototype.setDefaultParagraphFormat=function(e){this.paragraphFormat=JSON.parse(j.sanitizeString(JSON.stringify(e))),this.documentHelper.setDefaultDocumentFormat(),_.isNullOrUndefined(this.selectionModule)||this.selectionModule.retrieveCurrentFormatProperties()},u.prototype.setDefaultSectionFormat=function(e){this.sectionFormat=JSON.parse(j.sanitizeString(JSON.stringify(e))),this.documentHelper.setDefaultDocumentFormat(),_.isNullOrUndefined(this.selectionModule)||this.selectionModule.retrieveCurrentFormatProperties()},u.prototype.getPersistData=function(){return"documenteditor"},u.prototype.clearPreservedCollectionsInViewer=function(){this.viewer instanceof Fd&&this.documentHelper.clearDocumentItems()},u.prototype.getDocumentEditorElement=function(){return this.element},u.prototype.fireContentChange=function(){if(!this.enableEditor||!this.editorModule.isIncrementalSave){this.enableLockAndEdit&&this.collaborativeEditingModule&&this.collaborativeEditingModule.saveContent();var e,t={source:this};if(this.enableCollaborativeEditing)if(t.operations=[],this.isSettingOp)t.operations=this.documentSettingOps,this.documentSettingOps=[],this.isSettingOp=!1;else if(!_.isNullOrUndefined(this.editorHistoryModule))if(_.isNullOrUndefined(this.editorHistoryModule.currentHistoryInfo)||"IMEInput"!==this.editorHistoryModule.currentHistoryInfo.action?_.isNullOrUndefined(this.editorHistoryModule.lastOperation)||("IMEInput"===(e=this.editorHistoryModule.lastOperation).action?t.operations=e.getActionInfo(!0):t.operations=e.getActionInfo(),this.editorHistoryModule.lastOperation=void 0):t.operations=this.editorHistoryModule.currentHistoryInfo.getActionInfo(),this.enableTrackChanges&&0<t.operations.length)for(var i=0;i<t.operations.length;i++)_.isNullOrUndefined(t.operations[i].markerData)&&(t.operations[i].markerData={}),t.operations[i].markerData.author=this.currentUser;this.trigger(ee,t)}},u.prototype.fireDocumentChange=function(){this.enableLockAndEdit&&this.enableEditor&&this.editorModule.enforceProtection("",!1,!0),this.trigger(te,{source:this})},u.prototype.fireSelectionChange=function(){var e;this.enableEditor&&this.editorModule.isIncrementalSave||(!this.documentHelper.isCompositionStart&&_.Browser.isDevice&&this.editorModule&&this.editorModule.predictText(),e={source:this,isCompleted:this.documentHelper.isCompleted},this.trigger(ie,e),this.documentHelper.isSelectionCompleted=this.documentHelper.isCompleted,this.documentHelper.isCompleted=!0)},u.prototype.fireZoomFactorChange=function(){var e={source:this};this.trigger(ne,e),this.notify($,e)},u.prototype.fireOptionPaneChange=function(e){this.notify(Be,{show:e})},u.prototype.fireBeformFieldFill=function(){this.trigger(re,{})},u.prototype.fireAfterFormFieldFill=function(){this.trigger(oe,{})},u.prototype.fireServiceFailure=function(e){this.trigger(le,e)},u.prototype.fireViewChange=function(){var e;this.viewer&&0<this.documentHelper.pages.length&&0<this.viewer.visiblePages.length&&(e={startPage:(e=this.viewer.visiblePages)[0].index+1,endPage:e[e.length-1].index+1,source:this},this.trigger(de,e),this.notify(Pe,e))},u.prototype.fireCustomContextMenuSelect=function(e){this.trigger(he,{id:e})},u.prototype.fireCustomContextMenuBeforeOpen=function(e){this.trigger(ce,{ids:e})},u.prototype.showParagraphDialog=function(e){this.paragraphDialogModule&&!this.isReadOnlyMode&&this.viewer?this.paragraphDialogModule.show(e):this.checkModuleInjection("ParagraphDialog",this.enableParagraphDialog)},u.prototype.showPageSetupDialog=function(){this.pageSetupDialogModule&&!this.isReadOnlyMode&&this.viewer?this.pageSetupDialogModule.show():this.checkModuleInjection("PageSetupDialog",this.enablePageSetupDialog)},u.prototype.showColumnsDialog=function(){this.columnsDialogModule&&!this.isReadOnlyMode&&this.viewer?this.columnsDialogModule.show():this.checkModuleInjection("ColumnsDialog",this.enableColumnsDialog)},u.prototype.showFootNotesDialog=function(){this.footNotesDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.footNotesDialogModule.show()},u.prototype.showFontDialog=function(e){this.fontDialogModule&&!this.isReadOnlyMode&&this.viewer?this.fontDialogModule.showFontDialog(e):this.checkModuleInjection("FontDialog",this.enableFontDialog)},u.prototype.showCellOptionsDialog=function(){this.cellOptionsDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.cellOptionsDialogModule.show()},u.prototype.showTableOptionsDialog=function(){this.tableOptionsDialogModule&&!this.isReadOnlyMode&&this.viewer?this.tableOptionsDialogModule.show():this.checkModuleInjection("TableOptionsDialog",this.enableTableOptionsDialog)},u.prototype.showTableDialog=function(){this.tableDialogModule&&!this.isReadOnlyMode&&this.viewer?this.tableDialogModule.show():this.checkModuleInjection("TableDialog",this.enableTableDialog)},u.prototype.showDateContentDialog=function(){this.dateContentDialogModule&&!this.isReadOnlyMode&&this.viewer?this.dateContentDialogModule.show():this.checkModuleInjection("DateContentDialog",this.enableDateContentDialog)},u.prototype.showPicContentControlDialog=function(){var e=this.getImageContentControl(),t=this.picturePositionY;this.selection.isEmpty&&this.renderPictureContentControlElement(this,!0,!0,t),this.selection.isImageSelected&&(this.renderPictureContentControlElement(this,!0,!0,t),e instanceof E&&"Picture"!=e.contentControlProperties.type||this.editor.insertContentControl("Picture"))},u.prototype.showpicContentControlDialogModule=function(){this.picContentControlDialogModule&&!this.isReadOnlyMode&&this.viewer?this.picContentControlDialogModule.show():this.checkModuleInjection("PicContentControlDialog",this.enablePicContentControlDialog)},u.prototype.renderPictureContentControlElement=function(e,t,i,n){var r,o,s,a=this;this.enableSelection&&(r=this.documentHelper.owner.selection.sectionFormat.leftMargin,n=this.selection.isForward?(r+=this.selection.start.location.x,n):(r+=this.selection.end.location.x,this.selection.end.location.y),r={id:this.element.id+"PICTURE_CONTENT_CONTROL",innerHTML:"Picture",class:"e-btn-icon e-icons e-de-ctnr-image e-icon-left",style:"height:20px;width:70px;left:"+r+"px;top:"+n+"px;z-index:5;position:absolute;background-color:#ccc;border:1px solid #ccc;display:"},n=document.getElementById(this.element.id+"_viewerContainer"),s=document.getElementById(this.element.id+"PICTURE_CONTENT_CONTROL"),_.isNullOrUndefined(s)&&t||i?(r=this.rulerHelper.createHtmlElement("div",r),n.insertBefore(r,n.firstChild),r.style.display="block",r.addEventListener("click",function(e){o=a.getImageContentControl(),!_.isNullOrUndefined(o)&&"Picture"==o.contentControlProperties.type||a.picContentControlDialogModule.show()})):_.isNullOrUndefined(s)||!t||i?_.isNullOrUndefined(s)||t||i||(s.style.display="none"):(s.style.display="block",s.addEventListener("click",function(e){(o=a.getImageContentControl())instanceof E&&!o.contentControlProperties.lockContentControl&&"Picture"==o.contentControlProperties.type&&!a.documentHelper.owner.isReadOnlyMode&&a.picContentControlDialogModule.show()})),(n=new _.L10n("documenteditor",this.defaultLocale)).setLocale(this.locale),n.getConstant("Picture"))},u.prototype.getImageContentControl=function(){for(var e,t=this.documentHelper.owner.selectionModule.start.currentWidget.paragraph,i=0;i<t.childWidgets.length;i++)for(var n=0;n<t.childWidgets[i].children.length;n++){var r=t.childWidgets[i].children[n];if(r instanceof E&&0==r.type&&"Picture"==r.contentControlProperties.type){e=t.childWidgets[i].children[n];break}}return e},u.prototype.showContentPropertiesDialog=function(){this.contentControlPropertiesDialogModule&&!this.isReadOnlyMode&&this.viewer?this.contentControlPropertiesDialogModule.show():this.checkModuleInjection("ContentControlPropertiesDialog",this.enableContentControlPropertiesDialog)},u.prototype.showTableOfContentsDialog=function(){this.tableOfContentsDialogModule&&!this.isReadOnlyMode&&this.viewer?this.tableOfContentsDialogModule.show():this.checkModuleInjection("TableOfContentsDialog",this.enableTableOfContentsDialog)},u.prototype.showStyleDialog=function(){this.styleDialogModule&&!this.isReadOnlyMode&&this.viewer?this.styleDialogModule.show():this.checkModuleInjection("StyleDialog",this.enableStyleDialog)},u.prototype.showHyperlinkDialog=function(){this.hyperlinkDialogModule&&!this.isReadOnlyMode&&this.viewer?this.hyperlinkDialogModule.show():this.checkModuleInjection("HyperlinkDialog",this.enableHyperlinkDialog)},u.prototype.showBookmarkDialog=function(){this.bookmarkDialogModule&&!this.isReadOnlyMode&&this.viewer?this.bookmarkDialogModule.show():this.checkModuleInjection("BookmarkDialog",this.enableBookmarkDialog)},u.prototype.showStylesDialog=function(){this.stylesDialogModule&&!this.isReadOnlyMode&&this.viewer?this.stylesDialogModule.show():this.checkModuleInjection("StylesDialog",this.enableStyleDialog)},u.prototype.showListDialog=function(){this.listDialogModule&&!this.isReadOnlyMode&&this.viewer?this.listDialogModule.showListDialog():this.checkModuleInjection("ListDialog",this.enableListDialog)},u.prototype.showTablePropertiesDialog=function(){this.tablePropertiesDialogModule&&!this.isReadOnlyMode&&this.viewer?this.tablePropertiesDialogModule.show():this.checkModuleInjection("TablePropertiesDialog",this.enableTablePropertiesDialog)},u.prototype.showBordersAndShadingDialog=function(){this.bordersAndShadingDialogModule&&!this.isReadOnlyMode&&this.viewer?this.bordersAndShadingDialogModule.show():this.checkModuleInjection("BordersAndShadingDialog",this.enableBordersAndShadingDialog)},u.prototype.requiredModules=function(){var e=[];return this.enableCollaborativeEditing&&e.push({member:"CollaborativeEditingHandler",args:[this]}),this.enableLockAndEdit&&e.push({member:"CollaborativeEditing",args:[this]}),this.enablePrint&&e.push({member:"Print",args:[]}),(this.enableSfdtExport||this.enableWordExport||this.enableTextExport||this.enableSelection||this.enableEditor)&&e.push({member:"SfdtExport",args:[this.documentHelper]}),this.enableWordExport&&e.push({member:"WordExport",args:[]}),this.enableTextExport&&e.push({member:"TextExport",args:[]}),(this.enableSelection||this.enableSearch||this.enableEditor)&&(e.push({member:"Selection",args:[this]}),this.enableContextMenu)&&e.push({member:"ContextMenu",args:[this.documentHelper]}),this.enableSearch&&(e.push({member:"Search",args:[this]}),this.enableOptionsPane)&&e.push({member:"OptionsPane",args:[this.documentHelper]}),this.documentEditorSettings&&this.documentEditorSettings.enableOptimizedTextMeasuring?(Bf.Inject(Km),e.push({member:"Optimized",args:[this.documentHelper]})):(Bf.Inject(Xm),e.push({member:"Regular",args:[this.documentHelper]})),this.enableEditor&&(e.push({member:"Editor",args:[this.documentHelper]}),e.push({member:"XmlPane",args:[this.documentHelper]}),this.enableImageResizer&&e.push({member:"ImageResizer",args:[this,this.documentHelper]}),this.enableEditorHistory&&e.push({member:"EditorHistory",args:[this]}),this.enableHyperlinkDialog&&e.push({member:"HyperlinkDialog",args:[this.documentHelper]}),this.enableTableDialog&&e.push({member:"TableDialog",args:[this.documentHelper]}),this.enableDateContentDialog&&e.push({member:"DateContentDialog",args:[this.documentHelper]}),this.enablePicContentControlDialog&&e.push({member:"PicContentControlDialog",args:[this.documentHelper]}),this.enableContentControlPropertiesDialog&&e.push({member:"ContentControlPropertiesDialog",args:[this.documentHelper]}),this.enableBookmarkDialog&&e.push({member:"BookmarkDialog",args:[this.documentHelper]}),this.enableTableOfContentsDialog&&e.push({member:"TableOfContentsDialog",args:[this.documentHelper]}),this.enablePageSetupDialog&&e.push({member:"PageSetupDialog",args:[this.documentHelper]}),this.enableColumnsDialog&&e.push({member:"ColumnsDialog",args:[this.documentHelper]}),this.enableFootnoteAndEndnoteDialog&&e.push({member:"FootNotesDialog",args:[this.documentHelper]}),this.enableStyleDialog&&(e.push({member:"StylesDialog",args:[this.documentHelper]}),e.push({member:"StyleDialog",args:[this.documentHelper]}),e.push({member:"BulletsAndNumberingDialog",args:[this.documentHelper]})),this.enableListDialog&&e.push({member:"ListDialog",args:[this.documentHelper]}),this.enableParagraphDialog&&(e.push({member:"ParagraphDialog",args:[this.documentHelper]}),e.push({member:"TabDialog",args:[this.documentHelper]})),this.enableFontDialog&&e.push({member:"FontDialog",args:[this.documentHelper]}),this.enableTablePropertiesDialog&&(e.push({member:"TablePropertiesDialog",args:[this.documentHelper]}),e.push({member:"CellOptionsDialog",args:[this.documentHelper]})),this.enableBordersAndShadingDialog&&e.push({member:"BordersAndShadingDialog",args:[this.documentHelper]}),this.enableTableOptionsDialog&&e.push({member:"TableOptionsDialog",args:[this.documentHelper]}),this.enableSpellCheck&&(e.push({member:"SpellChecker",args:[this.documentHelper]}),e.push({member:"SpellCheckDialog",args:[this.documentHelper]})),this.enableFormField)&&(e.push({member:"TextFormFieldDialog",args:[this]}),e.push({member:"DropDownFormFieldDialog",args:[this]}),e.push({member:"CheckBoxFormFieldDialog",args:[this]})),e},u.prototype.checkModuleInjection=function(e,t){if(!t&&!this.isReadOnly)throw console.warn('[WARNING] :: Module "'+e+'" is not available in Document Editor component! You either misspelled the module name or forgot to load it.'),new Error("Inject "+e+" module")},u.prototype.open=function(e){C.showSpinner(this.element);try{_.isNullOrUndefined(e)||this.openInternal(e,!1)}catch(e){C.hideSpinner(this.element),this.failureHandler("onError")}},u.prototype.openAsync=function(e){C.showSpinner(this.element);try{_.isNullOrUndefined(e)||this.openInternal(e,!0)}catch(e){C.hideSpinner(this.element),this.failureHandler("onError")}},u.prototype.openInternal=function(t,e){var i=this,n=this.isValidUrl(t);null!==n?this.getSfdtFromUrl(t,n).then(function(e){t=e,i.processSfdt(t)}).catch(function(e){console.error(e)}):this.isValidBase64(t)?this.getSfdtFromBase64string(t).then(function(e){t=e,i.processSfdt(t)}).catch(function(e){console.error(e)}):t instanceof File?this.convertToSfdt(t).then(function(e){t=e,i.processSfdt(t)}).catch(function(e){console.error(e)}):t instanceof Blob?"sfdt"===(n=t.type.split("/"))[n.length-1]?this.convertFromSfdtBlob(t).then(function(e){t=e,i.processSfdt(t)}).catch(function(e){console.error(e)}):this.convertFromBlob(t).then(function(e){t=e,i.processSfdt(t)}).catch(function(e){console.error(e)}):e?setTimeout(function(){try{i.processSfdt(t)}catch(e){C.hideSpinner(i.element),i.failureHandler("onError")}},50):this.processSfdt(t)},u.prototype.processSfdt=function(e){var t;_.isNullOrUndefined(this.viewer)||_.isNullOrUndefined(e)||(this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.lists=[],this.documentHelper.abstractLists=[],this.documentHelper.styles=new xl,this.documentHelper.cachedPages=[],this.clearSpellCheck(),this.isSpellCheck&&this.isSpellCheck&&!this.spellCheckerModule.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading=!0,this.documentHelper.triggerSpellCheck=!0),!_.isNullOrUndefined(e)&&this.viewer&&(t={},this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.onDocumentChanged(this.parser.convertJsonToDocument(e,t),t)),this.isSpellCheck&&this.isSpellCheck&&!this.spellCheckerModule.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading=!1,this.documentHelper.triggerSpellCheck=!1)),C.hideSpinner(this.element)},u.prototype.isValidUrl=function(e){try{return new URL(e).pathname.split("/").pop()||null}catch(e){return null}},u.prototype.isValidBase64=function(e){try{var t=atob(e);return btoa(t)===e}catch(e){return!1}},u.prototype.getSfdtFromUrl=function(t,s){return kf(this,void 0,void 0,function(){var o;return Ff(this,function(e){return o=this,[2,new Promise(function(n,e){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="blob",r.onload=function(){return kf(this,void 0,void 0,function(){var t,i;return Ff(this,function(e){switch(e.label){case 0:return 200!==r.status?[3,2]:(i=r.response,(t=new FormData).append("file",i,s),[4,o.send(t)]);case 1:i=e.sent(),n(i),e.label=2;case 2:return[2]}})})},r.onerror=function(){e(null)},r.send()})]})})},u.prototype.convertToSfdt=function(i){return kf(this,void 0,void 0,function(){var t;return Ff(this,function(e){switch(e.label){case 0:return(t=new FormData).append("files",i),[4,this.send(t)];case 1:return[2,e.sent()]}})})},u.prototype.getSfdtFromBase64string=function(s){return kf(this,void 0,void 0,function(){var t,i,n,r,o;return Ff(this,function(e){switch(e.label){case 0:for(t=atob(s),i=new Uint8Array(t.length),n=0;n<t.length;n++)i[parseInt(n.toString(),10)]=t.charCodeAt(parseInt(n.toString(),10));return r=new Blob([i],{type:"application/octet-stream"}),(o=new FormData).append("file",r),[4,this.send(o)];case 1:return[2,e.sent()]}})})},u.prototype.convertFromBlob=function(r){return kf(this,void 0,void 0,function(){var t,i,n;return Ff(this,function(e){switch(e.label){case 0:return t=new FormData,i=r.type.split("/"),n=null,n="html"===i[i.length-1]||"rtf"===i[i.length-1]?"."+i[i.length-1]:r.type,t.append("files",r,n),[4,this.send(t)];case 1:return[2,e.sent()]}})})},u.prototype.send=function(r){var o=this,s=this.serviceUrl+this.serverActionSettingsImport;return new Promise(function(t,e){var i=new A,n=(i.url=s,i.onSuccess=function(e){t(e.data)},i.onFailure=o.failureHandler.bind(o),i.onError=o.failureHandler.bind(o),i.customHeaders=o.headers,{serverActionType:o.serverActionSettingsImport,headers:o.headers,timeout:0,cancel:!1,withCredentials:!1});o.trigger(Te,n),n.cancel?e(null):i.send(r)})},u.prototype.convertFromSfdtBlob=function(i){return new Promise(function(t){var e=new FileReader;e.onload=function(e){e=e.target.result;t(e)},e.readAsText(i)})},u.prototype.failureHandler=function(e){var t=new _.L10n("documenteditor",this.defaultLocale);"onError"===e.name?C.DialogUtility.alert({content:t.getConstant("Error in establishing connection with web server"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"center",Y:"center"}}).enableRtl=this.enableRtl:"onError"===e&&alert(t.getConstant("Failed to load the file"))},u.prototype.scrollToPage=function(e){return!(_.isNullOrUndefined(this.viewer)||e<1||e>this.documentHelper.pages.length||(this.viewer.scrollToPage(e-1),0))},u.prototype.enableAllModules=function(){this.enablePrint=this.enableSfdtExport=this.enableWordExport=this.enableTextExport=this.enableSelection=this.enableContextMenu=this.enableSearch=this.enableOptionsPane=this.enableEditor=this.enableImageResizer=this.enableEditorHistory=this.enableHyperlinkDialog=this.enableTableDialog=this.enableBookmarkDialog=this.enableTableOfContentsDialog=this.enableFootnoteAndEndnoteDialog=this.enablePageSetupDialog=this.enableStyleDialog=this.enableDateContentDialog=this.enablePicContentControlDialog=this.enableContentControlPropertiesDialog=this.enableListDialog=this.enableParagraphDialog=this.enableFontDialog=this.enableTablePropertiesDialog=this.enableBordersAndShadingDialog=this.enableTableOptionsDialog=this.enableSpellCheck=this.enableComment=this.enableFormField=this.enableColumnsDialog=!0,Bf.Inject(Ba,tf,Qm,$m,_m,fm,Yg,Qg,jg,xu,vm,Hu,Wu,af,Eu,Bu,Mu,Ku,ju,Du,bg,mf,wf,yf,Xu,Yu,$u,tg,ng,og,ag,jm,dg,cg,ug,mg,vg,rm)},u.prototype.resize=function(e,t){this.element&&(!_.isNullOrUndefined(e)&&200<e&&(this.element.style.width=e+"px"),!_.isNullOrUndefined(t)&&200<t&&(this.element.style.height=t+"px"),this.viewer&&this.documentHelper.updateViewerSize(),this.trackChangesPane.toolbar&&this.trackChangesPane.toolbar.refreshOverflow(),this.optionsPaneModule)&&this.optionsPaneModule.refreshHeadingPaneHeight(),this.rulerHelper&&this.documentEditorSettings&&this.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!1),this.enableCollaborativeEditing&&this.collaborativeEditingHandlerModule&&this.collaborativeEditingHandlerModule.updateCaretPosition()},u.prototype.triggerResize=function(){var e=this;this&&setTimeout(function(){e&&e.resize()},10)},u.prototype.getFormFieldNames=function(){for(var e=[],t=this.documentHelper.formFields,i=0;i<t.length;i++)""!==t[parseInt(i.toString(),10)].formFieldData.name&&e.push(t[parseInt(i.toString(),10)].formFieldData.name);return e},u.prototype.getFormFieldInfo=function(e){e=j.sanitizeString(e);for(var t=this.documentHelper.formFields,i=0;i<t.length;i++)if(t[parseInt(i.toString(),10)].formFieldData.name===e&&""!==t[parseInt(i.toString(),10)].formFieldData.name)return t[parseInt(i.toString(),10)].formFieldData.getFormFieldInfo()},u.prototype.setFormFieldInfo=function(e,t){e=j.sanitizeString(e);for(var i,n=this.documentHelper.formFields,r=0;r<n.length;r++)if(n[parseInt(r.toString(),10)].formFieldData.name===e&&""!==n[parseInt(r.toString(),10)].formFieldData.name)return i=n[parseInt(r.toString(),10)],void(this.selectionModule?(this.selectionModule.selectFieldInternal(i),this.editorModule?this.editorModule.setFormField(i,t):this.checkModuleInjection("Editor",this.enableEditor)):this.checkModuleInjection("Selection",this.enableSelection))},u.prototype.resetFormFields=function(e){this.editorModule||this.checkModuleInjection("Editor",this.enableEditor),_.isNullOrUndefined(e)||(e=j.sanitizeString(e));for(var t=this.documentHelper.formFields,i=0;i<t.length;i++)!_.isNullOrUndefined(e)&&e!==t[parseInt(i.toString(),10)].formFieldData.name||(t[parseInt(i.toString(),10)].formFieldData instanceof Ch?this.editorModule.updateFormField(t[parseInt(i.toString(),10)],t[parseInt(i.toString(),10)].formFieldData.defaultValue,!0):t[parseInt(i.toString(),10)].formFieldData instanceof Fh?this.editorModule.toggleCheckBoxFormField(t[parseInt(i.toString(),10)],!0,t[parseInt(i.toString(),10)].formFieldData.defaultValue):t[parseInt(i.toString(),10)].formFieldData instanceof Sh&&this.editorModule.updateFormField(t[parseInt(i.toString(),10)],0,!0))},u.prototype.importFormData=function(e){this.editorModule||this.checkModuleInjection("Editor",this.enableEditor);for(var t=this.documentHelper.formFields,i=0;i<e.length;i++)for(var n=e[parseInt(i.toString(),10)],r=n.fieldName,o=0;o<t.length;o++)t[parseInt(o.toString(),10)].formFieldData.name===r&&(t[parseInt(o.toString(),10)].formFieldData instanceof Fh?this.editorModule.toggleCheckBoxFormField(t[parseInt(o.toString(),10)],!0,n.value):(t[parseInt(o.toString(),10)].formFieldData instanceof Ch||t[parseInt(o.toString(),10)].formFieldData instanceof Sh)&&this.editorModule.updateFormField(t[parseInt(o.toString(),10)],n.value))},u.prototype.exportFormData=function(){for(var e,t,i,n=[],r=this.documentHelper.formFields,o=0;o<r.length;o++)""!==r[parseInt(o.toString(),10)].formFieldData.name&&((e={fieldName:"",value:""}).fieldName=r[parseInt(o.toString(),10)].formFieldData.name,r[parseInt(o.toString(),10)].formFieldData instanceof Fh?e.value=r[parseInt(o.toString(),10)].formFieldData.checked:r[parseInt(o.toString(),10)].formFieldData instanceof Ch?(t="",t=this.documentHelper.isInlineFormFillProtectedMode?this.editorModule.getFieldResultText(r[parseInt(o.toString(),10)]):r[parseInt(o.toString(),10)].resultText,i=RegExp(this.documentHelper.textHelper.getEnSpaceCharacter(),"gi"),""===t.replace(i,"")&&(t=""),e.value=t):r[parseInt(o.toString(),10)].formFieldData instanceof Sh&&(e.value=r[parseInt(o.toString(),10)].formFieldData.selectedIndex),n.push(e));return n},u.prototype.importContentControlData=function(e){for(var t=0;t<e.length;t++)for(var i=e[parseInt(t.toString(),10)],n=0;n<this.documentHelper.contentControlCollection.length;n++){var r=this.documentHelper.contentControlCollection[parseInt(n.toString(),10)];i.title===r.contentControlProperties.title&&this.editorModule.updateContentControl(r,i.value)}return[]},u.prototype.exportContentControlData=function(){this.selection.contentControleditRegionHighlighters.clear(),this.selection.isHighlightContentControlEditRegion=!0;for(var e=[],t=0,i=this.documentHelper.contentControlCollection;t<i.length;t++){var n,r,o=i[t];o instanceof E&&((n={title:"",tag:"",value:"",canDelete:!1,canEdit:!1,type:o.contentControlProperties.type}).title=o.contentControlProperties.title,n.tag=o.contentControlProperties.tag,o.contentControlProperties.lockContentControl&&(n.canDelete=!0),o.contentControlProperties.lockContents&&(n.canEdit=!0),r=o.nextElement,"Picture"===o.contentControlProperties.type?r instanceof Ic&&(n.value=this.documentHelper.getImageString(r)):"CheckBox"===o.contentControlProperties.type?n.value=String(o.contentControlProperties.isChecked):"Date"===o.contentControlProperties.type?n.value=r.text:"ComboBox"===o.contentControlProperties.type||"DropDownList"===o.contentControlProperties.type?n.value=this.getContentControlValue(r):n.value=this.getContentControlValueForText(o),e.push(n))}return e},u.prototype.resetContentControlData=function(e){for(var t=0;t<e.length;t++)for(var i=e[parseInt(t.toString(),10)],n=0;n<this.documentHelper.contentControlCollection.length;n++){var r=this.documentHelper.contentControlCollection[parseInt(n.toString(),10)];i.title===r.contentControlProperties.title&&this.editorModule.updateContentControl(r,i.value,!0)}},u.prototype.getContentControlValue=function(e){for(var t="";e&&!(e instanceof E);)e instanceof X&&(t+=e.text),e=e.nextElement;return t},u.prototype.getContentControlValueForText=function(e){var t="",i=e.line.children.indexOf(e)+1,n=!1;if(this.selection.contentControleditRegionHighlighters.containsKey(e))for(var r=this.selection.contentControleditRegionHighlighters.get(e),o=0;o<r.keys.length;o++){var s=r.keys[parseInt(o.toString(),10)];0<o&&s.paragraph!==r.keys[o-1].paragraph&&(t+="/n");for(var a=i;a<s.children.length;a++){var i=0,l=s.children[parseInt(a.toString(),10)];if(l instanceof X&&(t+=l.text),l instanceof E){n=!0;break}}if(n)break}return t},u.prototype.updateFields=function(){this.selectionModule||this.checkModuleInjection("Selection",this.enableSelection);for(var e=0;e<this.documentHelper.fields.length;e++){var t,i=this.documentHelper.fields[parseInt(e.toString(),10)];0===this.selectionModule.getFieldCode(i).toLowerCase().trim().indexOf("ref ")&&(t=i.line.paragraph,_.isNullOrUndefined(t)||_.isNullOrUndefined(this.selectionModule)||_.isNullOrUndefined(this.selectionModule.getPage(t))||this.selectionModule.updateRefField(i))}},u.prototype.focusIn=function(){this.viewer&&this.documentHelper.updateFocus()},u.prototype.fitPage=function(e){_.isNullOrUndefined(e)&&(e="None"),this.viewer&&(this.viewer.pageFitType=e)},u.prototype.exportAsImage=function(e,t){if(_.isNullOrUndefined(this.viewer))throw new Error("Invalid operation.");if(this.printModule)return this.printModule.exportAsImage(this.documentHelper,e,"Png"===t?"image/png":"image/jpeg");this.checkModuleInjection("Print",this.enablePrint)},u.prototype.exportAsPath=function(e){if(!_.isNullOrUndefined(e)&&e<=this.documentHelper.pages.length&&1<=e)return e=this.documentHelper.pages[e-1],this.documentHelper.render.isExporting=!0,this.documentHelper.render.renderWidgets(e,0,0,0,0),e=this.documentHelper.render.pageCanvas.toDataURL(),this.documentHelper.render.pageCanvas.getContext("2d").renderedPath="",this.documentHelper.render.isExporting=!1,e},u.prototype.print=function(e){if(_.isNullOrUndefined(this.viewer))throw new Error("Invalid operation.");this.printModule?"Continuous"===this.layoutType?(this.documentHelper.isWebPrinting=!0,this.viewer=new Sd(this),this.editorModule.layoutWholeDocument(),this.printModule.print(this.documentHelper,e),this.viewer=new Wd(this),this.editorModule.layoutWholeDocument(),this.documentHelper.isWebPrinting=!1):this.printModule.print(this.documentHelper,e):this.checkModuleInjection("Print",this.enablePrint)},u.prototype.serialize=function(){var e="";return this.enableSfdtExport&&this.sfdtExportModule instanceof tf?e=this.sfdtExportModule.serialize():this.checkModuleInjection("SfdtExport",this.enableSfdtExport),e},u.prototype.save=function(t,e){var i,n,r,o=this;if(t=(t=_.isNullOrUndefined(t)?t:j.sanitizeString(t))||"Untitled",_.isNullOrUndefined(this.documentHelper))throw new Error("Invalid operation.");if("Docx"===e||"Dotx"===e)this.wordExportModule?(this.documentHelper.owner.sfdtExportModule.isWordExport=!0,this.wordExportModule.save(this.documentHelper,t,e),this.documentHelper.owner.sfdtExportModule.isWordExport=!1):this.checkModuleInjection("WordExport",this.enableWordExport);else if("Txt"===e)this.textExportModule?this.textExportModule.save(this.documentHelper,t):this.checkModuleInjection("TextExport",this.enableTextExport);else{if("Sfdt"!==e)throw new Error("Invalid operation. Specified export is not enabled.");this.sfdtExportModule?this.documentEditorSettings.optimizeSfdt?(n=this.serialize(),r=new Blob([n],{type:"application/json"}),e=new f.ZipArchiveItem(r,"sfdt"),(i=new f.ZipArchive).addItem(e),i.saveAsBlob().then(function(e){o.zipArchiveBlobToSfdtFile(e,t)})):(n=this.serialize(),r=new Blob([n],{type:"application/json"}),x.Save.save(t+".sfdt",r)):this.checkModuleInjection("SfdtExport",this.enableSfdtExport)}},u.prototype.zipArchiveBlobToSfdtFile=function(e,i){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){var e=n.result.split(",")[1],t={},e=(t.sfdt=e,new Blob([JSON.stringify(t)],{type:"application/json"}));x.Save.save(i+".sfdt",e)}},u.prototype.saveAsBlob=function(e){var t=this;if(_.isNullOrUndefined(this.viewer))throw new Error("Invalid operation");return new Promise(function(i){"Docx"===e||"Dotx"===e?t.wordExportModule?i(t.wordExportModule.saveAsBlob(t.documentHelper,e)):t.checkModuleInjection("WordExport",t.enableWordExport):"Txt"===e?t.textExportModule?i(t.textExportModule.saveAsBlob(t.documentHelper)):t.checkModuleInjection("TextExport",t.enableTextExport):"Sfdt"===e&&(t.sfdtExportModule?t.documentEditorSettings.optimizeSfdt?t.sfdtExportModule.saveAsBlob(t.documentHelper).then(function(e){t.getBase64StringFromBlob(e).then(function(e){var t={},e=(t.sfdt=e,new Blob([JSON.stringify(t)],{type:"application/json"}));i(e)})}):i(t.sfdtExportModule.saveAsBlobNonOptimized(t.documentHelper)):t.checkModuleInjection("SfdtExport",t.enableSfdtExport))})},u.prototype.getBase64StringFromBlob=function(n){return new Promise(function(t,e){var i=new FileReader;i.readAsDataURL(n),i.onload=function(){var e=i.result.split(",")[1];t(e)}})},u.prototype.openBlank=function(){var e=[],t=(e.push(this.createNewBodyWidget()),this.parser.parseHeaderFooter({header:{},footer:{},evenHeader:{},evenFooter:{},firstPageHeader:{},firstPageFooter:{}},void 0));if(this.viewer){if(this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.cachedPages=[],this.clearSpellCheck(),this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.headersFooters.push(t),this.editorModule){this.editorModule.intializeDefaultStyles();for(var i=this.documentHelper.styles.findByName("Normal"),n=0;n<e.length;n++){var r=e[parseInt(n.toString(),10)].childWidgets[0];r.paragraphFormat.baseStyle=i,r.paragraphFormat.listFormat.baseStyle=i}}this.documentHelper.onDocumentChanged(e)}},u.prototype.getStyleNames=function(e){return this.viewer?this.documentHelper.styles.getStyleNames(e):[]},u.prototype.getStyles=function(e){return this.viewer?this.documentHelper.styles.getStyles(e):[]},u.prototype.getBookmarks=function(){var e=[];return e=this.viewer?this.documentHelper.getBookmarks(!0):e},u.prototype.showDialog=function(e){switch(e){case"Hyperlink":this.showHyperlinkDialog();break;case"Table":this.showTableDialog();break;case"Bookmark":this.showBookmarkDialog();break;case"TableOfContents":this.showTableOfContentsDialog();break;case"PageSetup":this.showPageSetupDialog();break;case"Columns":this.showColumnsDialog();break;case"List":this.showListDialog();break;case"Styles":this.showStylesDialog();break;case"Style":this.showStyleDialog();break;case"Paragraph":this.showParagraphDialog();break;case"Font":this.showFontDialog();break;case"TableProperties":this.showTablePropertiesDialog();break;case"BordersAndShading":this.showBordersAndShadingDialog();break;case"TableOptions":this.showTableOptionsDialog();break;case"SpellCheck":this.showSpellCheckDialog();break;case"DatepickerContentControl":this.showDateContentDialog();break;case"PictureContentControl":this.showPicContentControlDialog();break;case"ContentControlProperties":this.showContentPropertiesDialog()}},u.prototype.toggleShowHiddenMarksInternal=function(){this.documentEditorSettings.showHiddenMarks=!this.documentEditorSettings.showHiddenMarks,this.notify(He,this.documentEditorSettings)},u.prototype.showOptionsPane=function(){_.isNullOrUndefined(this.optionsPaneModule)||_.isNullOrUndefined(this.viewer)?this.checkModuleInjection("OptionsPane",this.enableOptionsPane):this.optionsPaneModule.showHideOptionsPane(!0)},u.prototype.showXmlPane=function(){!_.isNullOrUndefined(this.xmlPaneModule)&&_.isNullOrUndefined(this.xmlPaneModule.element)?this.xmlPaneModule.showXmlProperties(!0):this.checkModuleInjection("XmlPane",this.enableXMLPane)},u.prototype.showRestrictEditingPane=function(e){e=!!_.isNullOrUndefined(e)||e,this.documentHelper&&this.documentHelper.restrictEditingPane&&this.documentHelper.restrictEditingPane.showHideRestrictPane(e)},u.prototype.showSpellCheckDialog=function(){var e;this.spellCheckDialogModule&&this.spellCheckerModule?(e=this.spellCheckerModule.retriveText(),_.isNullOrUndefined(e)||this.spellCheckDialogModule.show(e.text,e.element)):this.checkModuleInjection("SpellCheck",this.enableSpellCheck)},u.prototype.showTabDialog=function(){this.tabDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tabDialogModule.show()},u.prototype.destroy=function(){Lf.prototype.destroy.call(this),this.destroyDependentModules(),_.isNullOrUndefined(this.documentHelper)||this.documentHelper.destroy(),this.viewer&&this.viewer.componentDestroy(),this.viewer=void 0,_.isNullOrUndefined(this.element)||(this.element.classList.remove("e-documenteditor"),this.element.innerHTML=""),this.refreshing||(this.element=void 0),this.parser&&(this.parser.destroy(),this.parser=void 0),this.revisionsInternal&&(this.revisionsInternal.destroy(),this.revisionsInternal=void 0),this.findResultsList=[],this.findResultsList=void 0,this.documentHelper=void 0},u.prototype.updateStyle=function(e,t){var i,n;_.isNullOrUndefined(this.styleDialogModule)||(i="Paragraph"===t.type?_.isNullOrUndefined(t.link)?"Paragraph":"Linked Style":"Character",e.type=this.styleDialogModule.getTypeValue(i),e.basedOn=t.basedOn,"Paragraph"==i||"Linked Style"==i?(e.next=t.next,e.characterFormat.destroy(),e.characterFormat.copyFormat(t.characterFormat),n=e.paragraphFormat.listFormat.listId,e.paragraphFormat.destroy(),e.paragraphFormat.copyFormat(t.paragraphFormat),e.link=t.link,!_.isNullOrUndefined(n)&&-1<n&&(n=this.documentHelper.getListById(n),_.isNullOrUndefined(n)||this.documentHelper.lists.splice(this.documentHelper.lists.indexOf(n),1))):"Character"==i&&(e.characterFormat.destroy(),e.characterFormat.copyFormat(t.characterFormat)),e.name=t.name)},u.prototype.createNewBodyWidget=function(){var e=new z,t=(e.index=0,e.sectionFormat=new Ma(e),this.sectionFormat&&this.parser.parseSectionFormat(0,this.sectionFormat,e.sectionFormat),new G);return t.index=0,t.paragraphFormat=new Xa(t),t.characterFormat=new B(t),e.childWidgets.push(t),t.containerWidget=e},u.prototype.clearSpellCheck=function(){_.isNullOrUndefined(this.spellCheckerModule)||(_.isNullOrUndefined(this.spellCheckerModule.errorWordCollection)||this.spellCheckerModule.errorWordCollection.clear(),_.isNullOrUndefined(this.spellCheckerModule.uniqueWordsCollection))||this.spellCheckerModule.uniqueWordsCollection.clear()},u.prototype.setStyleData=function(e,t){this.enableCollaborativeEditing&&(this.isSettingOp=!0,_.isNullOrUndefined(e)||_.isNullOrUndefined(this.documentHelper.owner.sfdtExportModule)||(e=this.documentHelper.styles.findByName(e),_.isNullOrUndefined(e))||(t=this.getStyleObject(e,t),!_.isNullOrUndefined(e)&&this.enableCollaborativeEditing&&(e={action:"Update",styleData:JSON.stringify(t)},this.documentSettingOps.push(e))),this.fireContentChange())},u.prototype.getStyleObject=function(e,t){var i,n;if(!_.isNullOrUndefined(e))return i=this.documentHelper.owner.sfdtExportModule.keywordIndex,this.documentHelper.owner.sfdtExportModule.keywordIndex=1,n={optimizeSfdt:!0,sty:[this.documentHelper.owner.sfdtExportModule.writeStyle(e)]},this.editorModule.isLinkedStyle(e.name)&&(e=this.documentHelper.styles.findByName(e.name+" Char"),e=this.documentHelper.owner.sfdtExportModule.writeStyle(e),n.sty.push(e)),!_.isNullOrUndefined(t)&&-1<t&&(e=this.documentHelper.getListById(t),n[Ue[1]]=[],n[Ue[1]].push(this.sfdtExportModule.writeList(e)),n[Ve[1]]=[],n[Ve[1]].push(this.sfdtExportModule.writeAbstractList(e.abstractList))),this.documentHelper.owner.sfdtExportModule.keywordIndex=i,n},u.prototype.getSettingData=function(e,t,i,n,r){this.enableCollaborativeEditing&&!this.editorModule.isRemoteAction&&(this.isSettingOp=!0,n="protection"===e?{text:e,protectionData:{saltValue:n,hashValue:i,protectionType:r}}:{text:e,enableTrackChanges:t},this.skipSettingsOps||(this.documentSettingOps.push(n),this.fireContentChange()),this.skipSettingsOps=!1,this.isSettingOp=!1)},p([_.Property(!(u.prototype.destroyDependentModules=function(){this.printModule&&(this.printModule.destroy(),this.printModule=void 0),this.sfdtExportModule&&(this.sfdtExportModule.destroy(),this.sfdtExportModule=void 0),this.optionsPaneModule&&(this.optionsPaneModule.destroy(),this.optionsPaneModule=void 0),this.xmlPaneModule&&(this.xmlPaneModule.destroy(),this.xmlPaneModule=void 0),this.commentReviewPane&&(this.commentReviewPane.destroy(),this.commentReviewPane=void 0),this.trackChangesPane&&(this.trackChangesPane.destroy(),this.trackChangesPane=void 0),_.isNullOrUndefined(this.hyperlinkDialogModule)||(this.hyperlinkDialogModule.destroy(),this.hyperlinkDialogModule=void 0),this.searchModule&&(this.searchModule.destroy(),this.searchModule=void 0),this.contextMenuModule&&(this.contextMenuModule.componentDestroy(),this.contextMenuModule=void 0),this.editorModule&&(this.editorModule.destroy(),this.editorModule=void 0),this.selectionModule&&(this.selectionModule.destroy(),this.selectionModule=void 0),this.editorHistoryModule&&(this.editorHistoryModule.destroy(),this.editorHistoryModule=void 0),_.isNullOrUndefined(this.paragraphDialogModule)||(this.paragraphDialogModule.destroy(),this.paragraphDialogModule=void 0),this.tabDialogModule&&(this.tabDialogModule.destroy(),this.tabDialogModule=void 0),this.pageSetupDialogModule&&(this.pageSetupDialogModule.destroy(),this.pageSetupDialogModule=void 0),this.columnsDialogModule&&(this.columnsDialogModule.destroy(),this.columnsDialogModule=void 0),this.footNotesDialogModule&&(this.footNotesDialogModule.destroy(),this.footNotesDialogModule=void 0),this.fontDialogModule&&(this.fontDialogModule.destroy(),this.fontDialogModule=void 0),this.listDialogModule&&(this.listDialogModule.destroy(),this.listDialogModule=void 0),this.imageResizerModule&&(this.imageResizerModule.destroy(),this.imageResizerModule=void 0),this.tablePropertiesDialogModule&&(this.tablePropertiesDialogModule.destroy(),this.tablePropertiesDialogModule=void 0),this.contentControlPropertiesDialogModule&&(this.contentControlPropertiesDialogModule.destroy(),this.contentControlPropertiesDialogModule=void 0),this.picContentControlDialogModule&&(this.picContentControlDialogModule.destroy(),this.picContentControlDialogModule=void 0),this.bordersAndShadingDialogModule&&(this.bordersAndShadingDialogModule.destroy(),this.bordersAndShadingDialogModule=void 0),this.cellOptionsDialogModule&&(this.cellOptionsDialogModule.destroy(),this.cellOptionsDialogModule=void 0),this.tableOptionsDialogModule&&(this.tableOptionsDialogModule.destroy(),this.tableOptionsDialogModule=void 0),this.tableDialogModule&&(this.tableDialogModule.destroy(),this.tableDialogModule=void 0),this.bookmarkDialogModule&&(this.bookmarkDialogModule.destroy(),this.bookmarkDialogModule=void 0),this.styleDialogModule&&(this.styleDialogModule.destroy(),this.styleDialogModule=void 0),this.textExportModule&&(this.textExportModule.destroy(),this.textExportModule=void 0),this.wordExportModule&&(this.wordExportModule.destroy(),this.wordExportModule=void 0),this.tableOfContentsDialogModule&&(this.tableOfContentsDialogModule.destroy(),this.tableOfContentsDialogModule=void 0),this.spellCheckerModule&&(this.spellCheckerModule.destroy(),this.spellCheckerModule=void 0),this.checkBoxFormFieldDialogModule&&(this.checkBoxFormFieldDialogModule.destroy(),this.checkBoxFormFieldDialogModule=void 0),this.dropDownFormFieldDialogModule&&(this.dropDownFormFieldDialogModule.destroy(),this.dropDownFormFieldDialogModule=void 0),this.textFormFieldDialogModule&&(this.textFormFieldDialogModule.destroy(),this.textFormFieldDialogModule=void 0),this.spellCheckDialogModule&&(this.spellCheckDialogModule.destroy(),this.spellCheckDialogModule=void 0),this.stylesDialogModule&&(this.stylesDialogModule.destroy(),this.stylesDialogModule=void 0),this.optimizedModule&&(this.optimizedModule.destroy(),this.optimizedModule=void 0),this.regularModule&&(this.regularModule.destroy(),this.regularModule=void 0)}))],u.prototype,"enableCollaborativeEditing",void 0),p([_.Property("KeepSourceFormatting")],u.prototype,"defaultPasteOption",void 0),p([_.Property("Pages")],u.prototype,"layoutType",void 0),p([_.Property("")],u.prototype,"currentUser",void 0),p([_.Property("#FFFF00")],u.prototype,"userColor",void 0),p([_.Property(20)],u.prototype,"pageGap",void 0),p([_.Property("")],u.prototype,"documentName",void 0),p([_.Property("100%")],u.prototype,"width",void 0),p([_.Property("200px")],u.prototype,"height",void 0),p([_.Property("")],u.prototype,"serviceUrl",void 0),p([_.Property(1)],u.prototype,"zoomFactor",void 0),p([_.Property(2e3)],u.prototype,"zIndex",void 0),p([_.Property(!0)],u.prototype,"isReadOnly",void 0),p([_.Property(!1)],u.prototype,"enablePrint",void 0),p([_.Property(!1)],u.prototype,"enableSelection",void 0),p([_.Property(!1)],u.prototype,"enableEditor",void 0),p([_.Property(!1)],u.prototype,"enableEditorHistory",void 0),p([_.Property(!1)],u.prototype,"enableSfdtExport",void 0),p([_.Property(!1)],u.prototype,"enableWordExport",void 0),p([_.Property(!0)],u.prototype,"enableAutoFocus",void 0),p([_.Property(!1)],u.prototype,"enableTextExport",void 0),p([_.Property(!1)],u.prototype,"enableOptionsPane",void 0),p([_.Property(!1)],u.prototype,"enableContextMenu",void 0),p([_.Property(!1)],u.prototype,"enableHyperlinkDialog",void 0),p([_.Property(!1)],u.prototype,"enableBookmarkDialog",void 0),p([_.Property(!1)],u.prototype,"enableTableOfContentsDialog",void 0),p([_.Property(!1)],u.prototype,"enableSearch",void 0),p([_.Property(!1)],u.prototype,"enableParagraphDialog",void 0),p([_.Property(!1)],u.prototype,"enableListDialog",void 0),p([_.Property(!1)],u.prototype,"enableTablePropertiesDialog",void 0),p([_.Property(!1)],u.prototype,"enableBordersAndShadingDialog",void 0),p([_.Property(!1)],u.prototype,"enableFootnoteAndEndnoteDialog",void 0),p([_.Property(!1)],u.prototype,"enableColumnsDialog",void 0),p([_.Property(!1)],u.prototype,"enablePageSetupDialog",void 0),p([_.Property(!1)],u.prototype,"enableStyleDialog",void 0),p([_.Property(!1)],u.prototype,"enableFontDialog",void 0),p([_.Property(!1)],u.prototype,"enableTableOptionsDialog",void 0),p([_.Property(!1)],u.prototype,"enableTableDialog",void 0),p([_.Property(!1)],u.prototype,"enableImageResizer",void 0),p([_.Property(!1)],u.prototype,"enableSpellCheck",void 0),p([_.Property(!1)],u.prototype,"enableComment",void 0),p([_.Property(!1)],u.prototype,"enableTrackChanges",void 0),p([_.Property(!0)],u.prototype,"enableFormField",void 0),p([_.Property(!1)],u.prototype,"acceptTab",void 0),p([_.Property(!0)],u.prototype,"useCtrlClickToFollowHyperlink",void 0),p([_.Property("#000000")],u.prototype,"pageOutline",void 0),p([_.Property(!1)],u.prototype,"enableCursorOnReadOnly",void 0),p([_.Property(!1)],u.prototype,"enableLocalPaste",void 0),p([_.Property(!1)],u.prototype,"enableLockAndEdit",void 0),p([_.Complex({},Pf)],u.prototype,"documentEditorSettings",void 0),p([_.Complex({},Hf)],u.prototype,"documentSettings",void 0),p([_.Property({systemClipboard:"SystemClipboard",spellCheck:"SpellCheck",spellCheckByPage:"SpellCheckByPage",restrictEditing:"RestrictEditing",canLock:"CanLock",getPendingActions:"GetPendingActions"})],u.prototype,"serverActionSettings",void 0),p([_.Property([])],u.prototype,"headers",void 0),p([_.Property(!1)],u.prototype,"showComments",void 0),p([_.Property(!1)],u.prototype,"showRevisions",void 0),p([_.Property(!1)],u.prototype,"autoResizeOnVisibilityChange",void 0),p([_.Event()],u.prototype,"documentChange",void 0),p([_.Event()],u.prototype,"viewChange",void 0),p([_.Event()],u.prototype,"zoomFactorChange",void 0),p([_.Event()],u.prototype,"selectionChange",void 0),p([_.Event()],u.prototype,"requestNavigate",void 0),p([_.Event()],u.prototype,"contentChange",void 0),p([_.Event()],u.prototype,"keyDown",void 0),p([_.Event()],u.prototype,"searchResultsChange",void 0),p([_.Event()],u.prototype,"created",void 0),p([_.Event()],u.prototype,"destroyed",void 0),p([_.Event()],u.prototype,"customContextMenuSelect",void 0),p([_.Event()],u.prototype,"customContextMenuBeforeOpen",void 0),p([_.Event()],u.prototype,"beforePaneSwitch",void 0),p([_.Event()],u.prototype,"commentBegin",void 0),p([_.Event()],u.prototype,"commentEnd",void 0),p([_.Event()],u.prototype,"beforeFileOpen",void 0),p([_.Event()],u.prototype,"commentDelete",void 0),p([_.Event()],u.prototype,"beforeAcceptRejectChanges",void 0),p([_.Event()],u.prototype,"beforeCommentAction",void 0),p([_.Event()],u.prototype,"trackChange",void 0),p([_.Event()],u.prototype,"beforeFormFieldFill",void 0),p([_.Event()],u.prototype,"serviceFailure",void 0),p([_.Event()],u.prototype,"afterFormFieldFill",void 0),p([_.Event()],u.prototype,"actionComplete",void 0),p([_.Event()],u.prototype,"contentControl",void 0),p([_.Event()],u.prototype,"beforeXmlHttpRequestSend",void 0);var Lf,Bf,Rf=Bf=p([_.NotifyPropertyChanges],u);function u(e,t){e=Lf.call(this,e,t)||this;return e.enableHeaderFooterIn=!1,e.isShiftingEnabled=!1,e.isContainerResize=!1,e.enableXMLPane=!1,e.isLayoutEnabled=!0,e.isPastingContent=!1,e.isOnIndent=!1,e.isTableMarkerDragging=!1,e.startXPosition=0,e.parser=void 0,e.isUpdateTrackChanges=!1,e.disableHistoryIn=!1,e.documentSettingOps=[],e.skipSettingsOps=!1,e.isSettingOp=!1,e.findResultsList=void 0,e.tablePropertiesDialogModule=void 0,e.bordersAndShadingDialogModule=void 0,e.cellOptionsDialogModule=void 0,e.tableOptionsDialogModule=void 0,e.paragraphDialogModule=void 0,e.imageResizerModule=void 0,e.createdTriggered=!1,e.serverActionSettingsImport="Import",e.isXmlPaneTool=!1,e.isXmlMapCC=!1,e.defaultLocale={Table:"Table",Row:"Row",Cell:"Cell",Ok:"OK",Apply:"Apply","Alt Text":"Alt Text",Title:"Title",Description:"Description",Cancel:"Cancel",Size:"Size","Preferred Width":"Preferred width",Points:"Points",Percent:"Percent","Measure in":"Measure in",Alignment:"Alignment",OutlineLevel:"Outline Level",BodyText:"Body Text",Level1:"Level 1",Level2:"Level 2",Level3:"Level 3",Level4:"Level 4",Level5:"Level 5",Level6:"Level 6",Level7:"Level 7",Level8:"Level 8",Level9:"Level 9",Left:"Left",Center:"Center",Right:"Right",Decimal:"Decimal",Bar:"Bar",Justify:"Justify","Indent from left":"Indent from left","Borders and Shading":"Borders and Shading",Options:"Options","Specify height":"Specify height","At least":"At least",Exactly:"Exactly","Row height is":"Row height is","Allow row to break across pages":"Allow row to break across pages","Repeat as header row at the top of each page":"Repeat as header row at the top of each page","Vertical alignment":"Vertical alignment",Top:"Top",Bottom:"Bottom","Default cell margins":"Default cell margins","Default cell spacing":"Default cell spacing","Allow spacing between cells":"Allow spacing between cells","Cell margins":"Cell margins","Same as the whole table":"Same as the whole table",Borders:"Borders",None:"None",Style:"Style",Width:"Width",Height:"Height",Letter:"Letter","1, 2, 3, ...":"1, 2, 3, ...","a, b, c, ...":"a, b, c, ...","A, B, C, ...":"A, B, C, ...","I, II, III, ...":"I, II, III, ...","i, ii, iii, ...":"i, ii, iii, ...",Tabloid:"Tabloid",Legal:"Legal",Statement:"Statement",Executive:"Executive",A3:"A3",A4:"A4",A5:"A5",B4:"B4",B5:"B5","Custom Size":"Custom size","Different odd and even":"Different odd and even","Different first page":"Different first page","From edge":"From edge",Header:"Header",Footer:"Footer","First Page Header":"First Page Header","First Page Footer":"First Page Footer","Even Page Header":"Even Page Header","Even Page Footer":"Even Page Footer","Odd Page Header":"Odd Page Header","Odd Page Footer":"Odd Page Footer","Same as Previous":"Same as Previous",Section:"Section",Margin:"Margins",Paper:"Paper",Layout:"Layout",Orientation:"Orientation",Landscape:"Landscape",Portrait:"Portrait","Show page numbers":"Show page numbers","Right align page numbers":"Right align page numbers",Nothing:"Nothing","Tab leader":"Tab leader",Leader:"Leader","Show levels":"Show levels","Use hyperlinks instead of page numbers":"Use hyperlinks instead of page numbers","Build table of contents from":"Build table of contents from",Styles:"Styles","Available styles":"Available styles","TOC level":"TOC level",Heading:"Heading","Heading 1":"Heading 1","Heading 2":"Heading 2","Heading 3":"Heading 3","Heading 4":"Heading 4","Heading 5":"Heading 5","Heading 6":"Heading 6","Heading 7":"Heading 7","Heading 8":"Heading 8","Heading 9":"Heading 9","List Paragraph":"List Paragraph",Normal:"Normal","Outline levels":"Outline levels","Table entry fields":"Table entry fields",Modify:"Modify",Color:"Color",Setting:"Setting",Box:"Box",All:"All",Custom:"Custom",Preview:"Preview",Shading:"Shading",Fill:"Fill","Apply To":"Apply to","Table Properties":"Table Properties","Cell Options":"Cell Options","Table Options":"Table Options","Insert Table":"Insert Table","Number of columns":"Number of columns","Number of rows":"Number of rows","Text to display":"Text to display","ScreenTip text":"ScreenTip text",Address:"Address","Insert Hyperlink":"Insert Hyperlink","Edit Hyperlink":"Edit Hyperlink",Insert:"Insert",General:"General","The number must be between":"The number must be between 1 and 9","The Invalid number":"This is not a valid number",Indentation:"Indentation","Before text":"Before text",Special:"Special","First line":"First line",Hanging:"Hanging","After text":"After text",By:"By",Before:"Before","Line Spacing":"Line spacing",After:"After",At:"At",Multiple:"Multiple",Spacing:"Spacing","Define new Multilevel list":"Define new Multilevel list","List level":"List level","Choose level to modify":"Choose level to modify",Level:"Level","Number format":"Number format","Number style for this level":"Number style for this level","Enter formatting for number":"Enter formatting for number","Start at":"Start at","Restart list after":"Restart list after",Position:"Position","Text indent at":"Text indent at","Aligned at":"Aligned at","Follow number with":"Follow number with","Tab character":"Tab character",Space:"Space",Arabic:"Arabic",UpRoman:"UpRoman",LowRoman:"LowRoman",UpLetter:"UpLetter",LowLetter:"LowLetter",Number:"Number","Leading zero":"Leading zero",Bullet:"Bullet",Ordinal:"Ordinal","Ordinal Text":"Ordinal Text","For East":"For East","No Restart":"No Restart",Font:"Font","Font style":"Font style","Underline style":"Underline style","Font color":"Font color",Effects:"Effects",Strikethrough:"Strikethrough",Superscript:"Superscript",Subscript:"Subscript","Double strikethrough":"Double strikethrough",Regular:"Regular",Bold:"Bold",Italic:"Italic",Cut:"Cut",Copy:"Copy",Paste:"Paste",Hyperlink:"Hyperlink","Remove Content Control":"Remove Content Control","Content Control Properties":"Content Control Properties","Remove content control when contents are edited":"Remove content control when contents are edited","Content control cannot be deleted":"Content control cannot be deleted","Contents cannot be edited":"Contents cannot be edited","Plain Text properties":"Plain Text properties","Allow carriage returns":"Allow carriage returns","Drop_Down List properties":"Drop_Down List properties","Display Text":"Display Text",Locking:"Locking",Tag:"Tag",Value:"Value",PictureContentControl:"PictureContentControl","Upload from computer":"Upload from computer",Picture:"Picture","Choose an item":"Choose an item","Insert Pictures":"Insert Pictures","Open Hyperlink":"Open Hyperlink","Copy Hyperlink":"Copy Hyperlink","Remove Hyperlink":"Remove Hyperlink",Paragraph:"Paragraph","Linked Style":"Linked(Paragraph and Character)",Character:"Character","Merge Cells":"Merge Cells","Insert Above":"Insert Above","Insert Below":"Insert Below","Insert Left":"Insert Left","Insert Right":"Insert Right",Delete:"Delete","Delete Table":"Delete Table","Delete Row":"Delete Row","Delete Column":"Delete Column","File Name":"File Name","Format Type":"Format Type",Save:"Save",Navigation:"Navigation",Results:"Results",Replace:"Replace","Replace All":"Replace All","We replaced all":"We replaced all",Find:"Find","No matches":"No matches","All Done":"All Done",Result:"Result",of:"of",instances:"instances",with:"with","Click to follow link":"Click to follow link","Continue Numbering":"Continue Numbering","Bookmark name":"Bookmark name",Tab:"Tab","Tab stop position":"Tab stop position",Close:"Close","Restart At":"Restart At",Properties:"Properties",Name:"Name","Style type":"Style type","Style based on":"Style based on","Style for following paragraph":"Style for following paragraph",Formatting:"Formatting","Numbering and Bullets":"Numbering and Bullets",Numbering:"Numbering","Update Field":"Update Field","Edit Field":"Edit Field",Bookmark:"Bookmark","Page Setup":"Page Setup","No bookmarks found":"No bookmarks found","Number format tooltip information":'Single-level number format: </br>[PREFIX]%[LEVELNUMBER][SUFFIX]</br>For example, "Chapter %1." will display numbering like</br>Chapter 1. Item</br>Chapter 2. Item</br>…</br>Chapter N. Item</br></br>Multilevel number format:</br>[PREFIX]%[LEVELNUMBER][SUFFIX]+[PREFIX]%[LEVELNUMBER][SUFFIX]</br>For example, "%1.%2." will display numbering like</br>1.1. Item</br>1.2. Item</br>…</br>1.N. Item',Format:"Format","Create New Style":"Create New Style","Modify Style":"Modify Style",New:"New",InsertFootnote:"InsertFootnote",InsertEndnote:"InsertEndnote",Footnote:"Footnote",Endnote:"Endnote","Notes Options":"Notes Options",Bullets:"Bullets","Use bookmarks":"Use bookmarks","Table of Contents":"Table of Contents",AutoFit:"AutoFit","AutoFit to Contents":"AutoFit to Contents","AutoFit to Window":"AutoFit to Window","Fixed Column Width":"Fixed Column Width",Reset:"Reset","Match case":"Match case","Whole words":"Whole words",Add:"Add","Go To":"Go To","Search for":"Search for","Replace with":"Replace with","TOC 1":"TOC 1","TOC 2":"TOC 2","TOC 3":"TOC 3","TOC 4":"TOC 4","TOC 5":"TOC 5","TOC 6":"TOC 6","TOC 7":"TOC 7","TOC 8":"TOC 8","TOC 9":"TOC 9","Right-to-left":"Right-to-left","Left-to-right":"Left-to-right",Direction:"Direction","Table direction":"Table direction","Indent from right":"Indent from right","Contextual Spacing":"Don't add space between paragraphs of the same style","Password Mismatch":"The password don't match","Restrict Editing":"Restrict Editing","Formatting restrictions":"Formatting restrictions","Allow formatting":"Allow formatting","Editing restrictions":"Editing restrictions","Read only":"Read only","Exceptions Optional":"Exceptions (optional)","Select Part Of Document And User":"Select parts of the document and choose users who are allowed to freely edit them.",Everyone:"Everyone","More users":"More users","Add Users":"Add Users","Enforcing Protection":"Yes, Start Enforcing Protection","Start Enforcing Protection":"Start Enforcing Protection","Enter User":"Enter User",Users:"Users","Enter new password":"Enter new password","Reenter new password to confirm":"Reenter new password to confirm","Your permissions":"Your permissions","Protected Document":"This document is protected from unintentional editing.",FormFieldsOnly:"You may only fill in forms in this region.",CommentsOnly:"You may only insert comments into this region.",ReadOnlyProtection:"You may edit in this region.","Stop Protection":"Stop Protection",Password:"Password","Spelling Editor":"Spelling Editor",Spelling:"Spelling","Spell Check":"Spell Check","Underline errors":"Underline errors",Ignore:"Ignore","Ignore All":"Ignore All","Add to Dictionary":"Add to Dictionary",Change:"Change","Change All":"Change All",Suggestions:"Suggestions","The password is incorrect":"The password is incorrect","Error in establishing connection with web server":"Error in establishing connection with web server","Highlight the regions I can edit":"Highlight the regions I can edit","Show All Regions I Can Edit":"Show All Regions I Can Edit","Find Next Region I Can Edit":"Find Next Region I Can Edit","Keep source formatting":"Keep source formatting","Match destination formatting":"Match destination formatting",InsertAsRows:"Insert as New Rows",InsertAsColumns:"Insert as New Columns",OverwriteCells:"Overwrite Cells",NestTable:"Nest Table","Text only":"Text only",Comments:"Comments","Type your comment":"Type your comment",Post:"Post",Reply:"Reply","New Comment":"New Comment",Edit:"Edit",Resolve:"Resolve",Reopen:"Reopen","No comments in this document":"No comments in this document",more:"more","Type your comment here":"Type your comment here","Next Comment":"Next Comment","Previous Comment":"Previous Comment","Un-posted comments":"Un-posted comments","XML Mapping":"XML Mapping","Custom XML Part":"Custom XML Part:","Discard Comment":"Added comments not posted. If you continue, that comment will be discarded.","Discard Content Control":"You can not insert a content control when the selection includes another content control.","No Headings":"No Heading Found!","Add Headings":"This document has no headings. Please add headings and try again.","More Options":"More Options","Click to see this comment":"Click to see this comment","Form Fields":"Form Fields","Text Form":"Text Form","Check Box":"Check Box","Drop Down Form Field":"Drop Down Form Field","Dropdown items":"Drop-down items","Items in dropdown list":"Items in drop-down list",ADD:"ADD",REMOVE:"REMOVE","Field settings":"Field settings",Tooltip:"Tooltip","Dropdown enabled":"Drop-down enabled","Check Box Form Field":"Check Box Form Field","Check box size":"Check box size",Auto:"Auto","Default value":"Default value","Not checked":"Not checked",Checked:"Checked","Check box enabled":"Check box enabled","Text Form Field":"Text Form Field",Type:"Type","Default text":"Default text","Maximum length":"Maximum length","Text format":"Text format","Fillin enabled":"Fill-in enabled","Default number":"Default number","Default date":"Default date","Date format":"Date format","Merge Track":"This action wont be marked as change. Do you want to continue?",UnTrack:"Cannot be tracked !",Accept:"Accept",Reject:"Reject","Previous Changes":"Previous Changes","Next Changes":"Next Changes",Inserted:"Inserted",Deleted:"Deleted","Move From":"Move From","Move To":"Move To",Changes:"Changes","Accept all":"Accept all","Reject all":"Reject all","No changes":"No changes","Accept Changes":"Accept Changes","Reject Changes":"Reject Changes",User:"User",View:"View",Insertion:"Insertion",Deletion:"Deletion","All caps":"All caps","This region is locked by":"This region is locked by",Lock:"Lock",Unlock:"Unlock","Already locked":"Selected or part of region is already locked by another user","Click to View/Edit Footnote":"Click to View/Edit Footnote","Click to View/Edit Endnote":"Click to View/Edit Endnote","Multiple Comment":"Please post your comment","No suggestions":"No suggestions","More Suggestion":"More Suggestion","Ignore Once":"Ignore Once","Keep With Next":"Keep with next","Keep Lines Together":"Keep lines together",WidowControl:"Widow/Orphan control","Indents and Spacing":"Indents and Spacing","Line and Page Breaks":"Line and Page Breaks",Pagination:"Pagination",Single:"Single",DashSmallGap:"DashSmallGap",DashDot:"DashDot",Double:"Double",ThinThickSmallGap:"ThinThickSmallGap",ThickThinSmallGap:"ThickThinSmallGap",ThickThinMediumGap:"ThickThinMediumGap",ThickThinLargeGap:"ThickThinLargeGap",SingleWavy:"SingleWavy",DoubleWavy:"DoubleWavy",Inset:"Inset",DashLargeGap:"DashLargeGap",Dot:"Dot",DashDotDot:"DashDotDot",Triple:"Triple",ThinThickThinSmallGap:"ThinThickThinSmallGap",ThinThickThinMediumGap:"ThinThickThinMediumGap",ThinThickThinLargeGap:"ThinThickThinLargeGap",DashDotStroked:"DashDotStroked",Engrave3D:"Engrave3D",Thick:"Thick",Outset:"Outset",Emboss3D:"Emboss3D",ThinThickLargeGap:"ThinThickLargeGap",ThinThickMediumGap:"ThinThickMediumGap","Number of rows must be between":"Number of rows must be between","Number of columns must be between":"Number of columns must be between",and:"and",Unlimited:"Unlimited","Regular text":"Regular text",Date:"Date",Uppercase:"Uppercase",Lowercase:"Lowercase",FirstCapital:"FirstCapital",TitleCase:"Titlecase","Filling in forms":"Filling in forms",px:"px","Tracked changes":"Tracked changes",TrackChangesOnly:"You may edit in this region, but all change will be tracked.",RemovedIgnoreExceptions:"If you make this change in document protection, Word will ignore all the exceptions in this document.",RemovedIgnore:"Do you want to remove the ignored exceptions?",Information:"Information",Yes:"Yes",No:"No","Page Break":"Page Break","Column Break":"Column Break","Section Break Next Page":"Section Break (Next Page)","Section Break Continuous":"Section Break (Continuous)","Unsupported format":"The file format you have selected isn't supported. Please choose valid format.",One:"One",Two:"Two",Three:"Three",Presets:"Presets",Columns:"Columns","Split your text into two or more columns":"Split your text into two or more columns","Line between column":"Line between column","Width and Spacing":"Width and Spacing","Equal column width":"Equal column width",Column:"Column","Paste Content Dialog":"Due to browser’s security policy, paste from system clipboard is restricted. Alternatively use the keyboard shortcut","Paste Content CheckBox":"Don’t show again",BookMarkList:"List of bookmarks in the document",TabMarkList:"List of tab stops in the paragraph","Default tab stops":"Default tab stops","Tab stops to be cleared":"Tab stops to be cleared",Tabs:"Tabs",Set:"Set",Clear:"Clear","Clear All":"Clear All",Discard:"Discard","The top/bottom margins are too large for the page height in some sections.":"The top/bottom margins are too large for the page height in some sections.","Column width cannot be less than 36 pt.":"Column width cannot be less than 36 pt.","Left and right margins.":"Settings you chose for the left and right margins, column spacing, or pargraph indents are too large for the page width in same secitions.","Left Indent":"Left Indent","Right Indent":"Right Indent","Hanging Indent":"Hanging Indent","First Line Indent":"First Line Indent","Left Margin":"Left Margin","Right Margin":"Right Margin","Top Margin":"Top Margin","Bottom Margin":"Bottom Margin","Left Tab":"Left Tab","Right Tab":"Right Tab","Center Tab":"Center Tab","Decimal Tab":"Decimal Tab","Bar Tab":"Bar Tab","Move Table Column":"Move Table Column","Default Content Control Text":"Click here or tap to insert text","Default Date Picker":"Click or tap enter the date","Rich text Controls":"Rich text controls cannot be applied here.","Plain text Controls":"Plain text controls cannot be applied here."},e.initHelper(),e}Mf=_.ChildProperty,If(Df,Mf),p([_.Property("SystemClipboard")],Df.prototype,"systemClipboard",void 0),p([_.Property("SpellCheck")],Df.prototype,"spellCheck",void 0),p([_.Property("SpellCheckByPage")],Df.prototype,"spellCheckByPage",void 0),p([_.Property("RestrictEditing")],Df.prototype,"restrictEditing",void 0),p([_.Property("CanLock")],Df.prototype,"canLock",void 0),p([_.Property("GetPendingActions")],Df.prototype,"getPendingActions",void 0);var Mf,Af=Df;function Df(){return null!==Mf&&Mf.apply(this,arguments)||this}Uf=_.ChildProperty,If(zf,Uf),p([_.Property("#cfcfcf")],zf.prototype,"shadingColor",void 0),p([_.Property(!0)],zf.prototype,"applyShading",void 0),p([_.Property("#cccccc")],zf.prototype,"selectionColor",void 0),p([_.Property("Popup")],zf.prototype,"formFillingMode",void 0),p([_.Property([])],zf.prototype,"formattingExceptions",void 0);var Uf,Vf=zf;function zf(){return null!==Uf&&Uf.apply(this,arguments)||this}qf=_.ChildProperty,If(jf,qf),p([_.Property("")],jf.prototype,"roomName",void 0),p([_.Property("#22b24b")],jf.prototype,"editableRegionColor",void 0),p([_.Property("#f44336")],jf.prototype,"lockedRegionColor",void 0),p([_.Property(3e3)],jf.prototype,"saveTimeout",void 0);var qf,_f=jf;function jf(){return null!==qf&&qf.apply(this,arguments)||this}If(Kf,Gf=Af),p([_.Property("Import")],Kf.prototype,"import",void 0);var Gf,If=Kf;function Kf(){return null!==Gf&&Gf.apply(this,arguments)||this}var Zf="_toolbar",Xf="_new",Jf="_open",Yf="_undo",Qf="_redo",$f="_image",ey="_image_local",ty="_table",iy="_link",ny="_bookmark",ry="_comment",oy="_track",sy="_toc",ay="_header",ly="_footer",dy="_page_setup",hy="_page_number",cy="_break",py="_listView",uy="_find",gy="_use_local_clipboard",my="_restrict_edit",fy="_page_break",yy="_section_break",vy="_section_break_continuous",wy="_column_break",by="_read_only",xy="_protections",Cy="_form_fields",Iy="_update_fields",ky="_text_form",Fy="_checkbox",Py="_dropdown",Ty="_footnote",Sy="_endnote",Hy="_columns",Ny="_page_set",Wy="_content_control",Oy="_richtext_content_control",Ey="_plaintext_content_control",Ly="_combobox_content_control",By="_dropdown_content_control",Ry="_datepicker_content_control",My="_checkbox_content_control",Ay="_picture_content_control",Dy="_xmlmapping",p=(Object.defineProperty(Uy.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),Uy.prototype.getModuleName=function(){return"toolbar"},Uy.prototype.enableItems=function(e,t){this.toolbar.enableItems(e,t)},Uy.prototype.initToolBar=function(e){this.toolbarItems=e,this.renderToolBar(),this.wireEvent()},Uy.prototype.renderToolBar=function(){var e,t,i,n,r,o;_.isNullOrUndefined(this.container)||(e=this.container.toolbarContainer,i=_.createElement("div",{className:"e-de-tlbr-wrapper"}),t=_.createElement("div",{className:"e-de-toolbar"}),this.initToolbarItems(),i.appendChild(t),e.appendChild(i),i=this.container.localObj,n=_.createElement("div",{className:"e-de-ctnr-properties-pane-btn"}),this.buttonElement=_.createElement("button",{attrs:{type:"button","aria-label":i.getConstant("Hide properties pane"),"aria-pressed":"true"}}),n.appendChild(this.buttonElement),r="e-tbar-btn e-tbtn-txt e-control e-btn e-de-showhide-btn",o="e-icons e-de-ctnr-showhide",this.container.enableRtl&&(r+="-rtl",o="e-icons e-de-ctnr-showhide e-de-flip"),this.propertiesPaneButton=new H.Button({cssClass:r,iconCss:o}),this.container.showPropertiesPane?this.buttonElement.title=i.getConstant("Hide properties pane"):(this.buttonElement.title=i.getConstant("Show properties pane"),_.classList(n,this.container.restrictEditing?["e-de-overlay"]:[],this.container.restrictEditing?[]:["e-de-overlay"]),n.classList.add("e-de-pane-disable-clr")),this.propertiesPaneButton.appendTo(this.buttonElement),_.EventHandler.add(this.buttonElement,"click",this.showHidePropertiesPane,this),e.appendChild(n),this.toolbar.appendTo(t),this.initToolbarDropdown(t))},Uy.prototype.initToolbarDropdown=function(e){var t,i,n,r=this;this.container&&(t=this.container.localObj,i=this.container.element.id+Zf,0<=this.toolbarItems.indexOf("Image")&&(this.imgDropDwn=new w.DropDownButton({items:[{text:t.getConstant("Upload from computer"),iconCss:"e-icons e-de-ctnr-upload",id:i+ey}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.imgDropDwn.appendTo("#"+i+$f)),0<=this.toolbarItems.indexOf("PageSetup")&&(this.PageSetUpDropDwn=new w.DropDownButton({items:[{text:t.getConstant("Page Setup"),iconCss:"e-icons e-de-ctnr-page-size",id:i+Ny},{text:t.getConstant("Columns"),iconCss:"e-icons e-de-ctnr-columns",id:i+Hy}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.PageSetUpDropDwn.appendTo("#"+i+dy)),0<=this.toolbarItems.indexOf("ContentControl")&&(this.ContentControlDropDwn=new w.DropDownButton({items:[{text:t.getConstant("Rich Text Content Control"),iconCss:"e-icons e-de-ctnr-change-case",id:i+Oy},{text:t.getConstant("Plain Text Content Control"),iconCss:"e-icons e-de-ctnr-change-case",id:i+Ey},{text:t.getConstant("Picture Content Control"),iconCss:"e-icons e-de-ctnr-image",id:i+Ay},{text:t.getConstant("Combo Box Content Control"),iconCss:"e-icons e-de-combo-box",id:i+Ly},{text:t.getConstant("Drop-Down List Content Control"),iconCss:"e-icons e-de-dropdown-list",id:i+By},{text:t.getConstant("Date Picker Content Control"),iconCss:"e-icons e-timeline-today",id:i+Ry},{text:t.getConstant("Check Box Content Control"),iconCss:"e-icons e-check-box",id:i+My}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.ContentControlDropDwn.appendTo("#"+i+Wy)),0<=this.toolbarItems.indexOf("Break")&&(n=[{text:t.getConstant("Page"),iconCss:"e-de-listview e-de-listview-icon e-icons e-de-ctnr-page-break",id:fy,category:t.getConstant("Page Breaks")},{text:t.getConstant("Column"),iconCss:"e-de-listview e-de-listview-icon e-icons e-de-ctnr-page-break-column",id:wy,category:t.getConstant("Page Breaks")},{text:t.getConstant("Next Page"),iconCss:"e-de-listview e-de-listview-icon e-icons e-de-ctnr-section-break",id:yy,category:t.getConstant("Section Breaks")},{text:t.getConstant("Continuous"),iconCss:"e-de-listview e-de-listview-icon e-icons e-de-ctnr-section-break-continuous",id:vy,category:t.getConstant("Section Breaks")}],this.breakDropDwn=new w.DropDownButton({target:"#"+i+cy+py,cssClass:"e-caret-hide"},"#"+i+cy),this.breakListView=new F.ListView({dataSource:n,width:"170px",fields:{iconCss:"iconCss",groupBy:"category"},showIcon:!0,select:this.onListViewSelection.bind(this)}),this.breakListView.appendTo("#"+i+cy+py)),this.filePicker=_.createElement("input",{attrs:{type:"file",accept:".doc,.docx,.rtf,.txt,.htm,.html,.sfdt"},className:"e-de-ctnr-file-picker"}),_.Browser.isIE&&document.body.appendChild(this.filePicker),this.imagePicker=_.createElement("input",{attrs:{type:"file",accept:".jpg,.jpeg,.png,.bmp,.svg"},className:"e-de-ctnr-file-picker"}),_.Browser.isIE&&document.body.appendChild(this.imagePicker),0<=this.toolbarItems.indexOf("LocalClipboard")&&this.toggleButton(i+gy,this.container.enableLocalPaste),0<=this.toolbarItems.indexOf("TrackChanges")&&this.toggleButton(i+oy,this.container.enableTrackChanges),0<=this.toolbarItems.indexOf("RestrictEditing")&&(this.toggleButton(i+my,this.container.restrictEditing),n="",this.container.restrictEditing&&(n=" e-de-selected-item"),this.restrictDropDwn=new w.DropDownButton({items:[{text:t.getConstant("Read only"),id:i+by,iconCss:"e-icons"+n},{text:t.getConstant("Protections"),id:i+xy,iconCss:"e-icons"}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this),beforeItemRender:function(e){r.onBeforeRenderRestrictDropdown(e,i)}}),this.restrictDropDwn.appendTo("#"+i+my)),0<=this.toolbarItems.indexOf("FormFields"))&&(this.formFieldDropDown=new w.DropDownButton({items:[{text:t.getConstant("Text Form"),iconCss:"e-icons e-de-textform",id:i+ky},{text:t.getConstant("Check Box"),iconCss:"e-icons e-de-checkbox-form",id:i+Fy},{text:t.getConstant("DropDown"),iconCss:"e-icons e-de-dropdownform",id:i+Py}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.formFieldDropDown.appendTo("#"+i+Cy))},Uy.prototype.onListViewSelection=function(e){var t=this.container.element.id+Zf,i=e.item.id;i===t+cy+py+"_"+fy?this.container.documentEditor.editorModule.insertPageBreak():i===t+cy+py+"_"+yy?this.container.documentEditor.editorModule.insertSectionBreak():i===t+cy+py+"_"+vy?this.container.documentEditor.editorModule.insertSectionBreak(V.SectionBreakType.Continuous):i===t+cy+py+"_"+wy&&this.container.documentEditor.editorModule.insertColumnBreak(),e.item.classList.remove("e-active")},Uy.prototype.onBeforeRenderRestrictDropdown=function(e,t){var i=e.element.getElementsByClassName("e-menu-icon")[0];_.isNullOrUndefined(i)||(e.item.id===t+by&&this.toggleRestrictIcon(i,this.container.restrictEditing),e.item.id===t+xy&&(e=document.getElementsByClassName("e-de-restrict-pane")[0],_.isNullOrUndefined(e)||(t=!("none"===e.style.display),this.toggleRestrictIcon(i,t))))},Uy.prototype.toggleRestrictIcon=function(e,t){t?e.classList.add("e-de-selected-item"):e.classList.remove("e-de-selected-item")},Uy.prototype.showHidePropertiesPane=function(){var e=document.getElementsByClassName("e-de-ctnr-properties-pane-btn")[0],t=this.container.localObj;"none"===this.container.propertiesPaneContainer.style.display?(this.container.showPropertiesPane=!0,e.classList.remove("e-de-pane-disable-clr"),this.buttonElement.title=t.getConstant("Hide properties pane"),this.buttonElement.setAttribute("aria-label",t.getConstant("Hide properties pane")),this.buttonElement.setAttribute("aria-pressed","true"),_.classList(e,["e-de-pane-enable-clr"],[]),this.container.trigger(ve,{type:"PropertiesPane"})):0<=this.container.previousContext.indexOf("Header")||0<=this.container.previousContext.indexOf("Footer")?this.container.showHeaderProperties=!this.container.showHeaderProperties:(this.container.showPropertiesPane=!1,e.classList.remove("e-de-pane-enable-clr"),this.buttonElement.title=t.getConstant("Show properties pane"),this.buttonElement.setAttribute("aria-label",t.getConstant("Show properties pane")),this.buttonElement.setAttribute("aria-pressed","false"),_.classList(e,["e-de-pane-disable-clr"],[])),this.enableDisablePropertyPaneButton(this.container.showPropertiesPane),this.container.showPropertiesPaneOnSelection(),this.documentEditor.focusIn()},Uy.prototype.onWrapText=function(e){var t="",i=e.lastIndexOf(" ");return-1!==i?(t=e.slice(0,i),e.slice(i),t+='<div class="e-de-text-wrap">'+e.slice(i)+"</div>"):t=e,t},Uy.prototype.wireEvent=function(){this.propertiesPaneButton.on("click",this.togglePropertiesPane.bind(this)),_.EventHandler.add(this.filePicker,"change",this.onFileChange,this),_.EventHandler.add(this.imagePicker,"change",this.onImageChange,this)},Uy.prototype.initToolbarItems=function(){this.toolbar=new k.Toolbar({enableRtl:this.container.enableRtl,clicked:this.clickHandler.bind(this),items:this.getToolbarItems()})},Uy.prototype.reInitToolbarItems=function(e){for(var t=this,i=0;i<e.length;i++)switch(e[parseInt(i.toString(),10)]){case"RestrictEditing":_.isNullOrUndefined(this.restrictDropDwn)||this.restrictDropDwn.destroy();break;case"Break":_.isNullOrUndefined(this.breakDropDwn)||this.breakDropDwn.destroy();break;case"PageSetup":_.isNullOrUndefined(this.PageSetUpDropDwn)||this.PageSetUpDropDwn.destroy();break;case"Image":_.isNullOrUndefined(this.imgDropDwn)||this.imgDropDwn.destroy();break;case"FormFields":_.isNullOrUndefined(this.formFieldDropDown)||this.formFieldDropDown.destroy()}this.toolbarItems=e;var n=this.container.toolbarContainer;this.toolbar.items=this.getToolbarItems(),this.toolbarTimer=Number(setTimeout(function(){t.toolbarTimer&&clearTimeout(t.toolbarTimer),t.initToolbarDropdown(n),0<=e.indexOf("Open")&&_.EventHandler.add(t.filePicker,"change",t.onFileChange,t),0<=e.indexOf("Image")&&_.EventHandler.add(t.imagePicker,"change",t.onImageChange,t)},200))},Uy.prototype.getToolbarItems=function(){for(var e,t=this.container.localObj,i=this.container.element.id+Zf,n=[],r=this.toolbarItems,o=0;o<this.toolbarItems.length;o++)switch(e=0===o?"e-de-toolbar-btn-start":"Separator"===r[o+1]&&"Separator"===r[o-1]?"e-de-toolbar-btn":"Separator"===r[o+1]?"e-de-toolbar-btn-last":"Separator"===r[o-1]?"e-de-toolbar-btn-first":o===this.toolbarItems.length-1?"e-de-toolbar-btn-end":"e-de-toolbar-btn-middle",r[parseInt(o.toString(),10)]){case"Separator":n.push({type:"Separator",cssClass:"e-de-separator"});break;case"New":n.push({prefixIcon:"e-de-ctnr-new",tooltipText:t.getConstant("Create a new document"),id:i+Xf,text:t.getConstant("New"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Create a new document")}});break;case"Open":n.push({prefixIcon:"e-de-ctnr-open",tooltipText:t.getConstant("Open a document"),id:i+Jf,text:t.getConstant("Open"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Open a document")}});break;case"Undo":n.push({prefixIcon:"e-de-ctnr-undo",tooltipText:t.getConstant("Undo Tooltip"),id:i+Yf,text:t.getConstant("Undo"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Undo Tooltip")}});break;case"Redo":n.push({prefixIcon:"e-de-ctnr-redo",tooltipText:t.getConstant("Redo Tooltip"),id:i+Qf,text:t.getConstant("Redo"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Redo Tooltip")}});break;case"Comments":n.push({prefixIcon:"e-de-cnt-cmt-add",tooltipText:t.getConstant("Show comments"),id:i+ry,text:t.getConstant("Comments"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Show comments")}});break;case"TrackChanges":n.push({prefixIcon:"e-de-cnt-track",tooltipText:t.getConstant("Track Changes"),id:i+oy,text:this.onWrapText(t.getConstant("TrackChanges")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("TrackChanges"),"aria-pressed":this.container.enableTrackChanges,role:"button","aria-hidden":"true"}});break;case"Image":n.push({template:'<button title="'+t.getConstant("Insert inline picture from a file")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-de-toolbar-btn-first e-caret-hide" type="button" id="'+i+$f+'"><span class="e-btn-icon e-icons e-de-ctnr-image e-icon-left"></span><span class="e-tbar-btn-text">'+t.getConstant("Image")+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:i+$f,htmlAttributes:{"aria-label":t.getConstant("Insert inline picture from a file"),"aria-haspopup":!1}});break;case"Table":n.push({prefixIcon:"e-de-ctnr-table",tooltipText:t.getConstant("Insert a table into the document"),id:i+ty,text:t.getConstant("Table"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Insert a table into the document"),"aria-haspopup":!0}});break;case"Hyperlink":n.push({prefixIcon:"e-de-ctnr-link",tooltipText:t.getConstant("Create Hyperlink"),id:i+iy,text:t.getConstant("Link"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Create Hyperlink"),"aria-haspopup":!0}});break;case"Bookmark":n.push({prefixIcon:"e-de-ctnr-bookmark",tooltipText:t.getConstant("Insert a bookmark in a specific place in this document"),id:i+ny,text:t.getConstant("Bookmark"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Insert a bookmark in a specific place in this document"),"aria-haspopup":!0}});break;case"TableOfContents":n.push({prefixIcon:"e-de-ctnr-tableofcontent",tooltipText:t.getConstant("Provide an overview of your document by adding a table of contents"),id:i+sy,text:this.onWrapText(t.getConstant("Table of Contents")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Table of Contents")}});break;case"Header":n.push({prefixIcon:"e-de-ctnr-header",tooltipText:t.getConstant("Add or edit the header"),id:i+ay,text:t.getConstant("Header"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Add or edit the header")}});break;case"Footer":n.push({prefixIcon:"e-de-ctnr-footer",tooltipText:t.getConstant("Add or edit the footer"),id:i+ly,text:t.getConstant("Footer"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Add or edit the footer")}});break;case"PageSetup":n.push({template:'<button title="'+t.getConstant("Page Setup")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-caret-hide" type="button" id="'+i+dy+'"><span class="e-btn-icon e-icons e-de-ctnr-pagesetup e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(t.getConstant("Page Setup"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:i+dy,htmlAttributes:{"aria-label":t.getConstant("Page Setup")}});break;case"PageNumber":n.push({prefixIcon:"e-de-ctnr-pagenumber",tooltipText:t.getConstant("Add page numbers"),id:i+hy,text:this.onWrapText(t.getConstant("Page Number")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Page Number")}});break;case"Break":n.push({template:'<button title="'+t.getConstant("Break")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-caret-hide" type="button" id="'+i+cy+'"><span class="e-btn-icon e-icons e-de-ctnr-break e-icon-left"></span><span class="e-tbar-btn-text">'+t.getConstant("Break")+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button><div id="'+i+cy+py+'"></div>',id:i+cy,htmlAttributes:{"aria-label":t.getConstant("Break")}});break;case"Find":n.push({prefixIcon:"e-de-ctnr-find",tooltipText:t.getConstant("Find Text"),id:i+uy,text:t.getConstant("Find"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Find Text")}});break;case"LocalClipboard":n.push({prefixIcon:"e-de-ctnr-paste",tooltipText:t.getConstant("Toggle between the internal clipboard and system clipboard"),id:i+gy,text:this.onWrapText(t.getConstant("Local Clipboard")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Local Clipboard"),"aria-pressed":this.container.enableLocalPaste,role:"button","aria-hidden":"true"}});break;case"RestrictEditing":n.push({template:'<button title="'+t.getConstant("Restrict editing")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-de-toolbar-btn-first e-caret-hide" type="button" id="'+i+my+'"><span class="e-btn-icon e-de-ctnr-lock e-icons e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(t.getConstant("Restrict Editing"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',htmlAttributes:{"aria-label":t.getConstant("Restrict editing")}});break;case"FormFields":n.push({template:'<button title="'+t.getConstant("Form Fields")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-de-toolbar-btn-first e-caret-hide" type="button" id="'+i+Cy+'"><span class="e-btn-icon e-de-formfield e-icons e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(t.getConstant("Form Fields"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:i+Cy,htmlAttributes:{"aria-label":t.getConstant("Form Fields")}});break;case"UpdateFields":n.push({prefixIcon:"e-de-update-field",tooltipText:t.getConstant("Update cross reference fields"),id:i+Iy,text:this.onWrapText(t.getConstant("Update Fields")),cssClass:e+" e-de-formfields",htmlAttributes:{"aria-label":t.getConstant("Update cross reference fields")}});break;case"InsertFootnote":n.push({prefixIcon:"e-de-footnote",tooltipText:t.getConstant("Footnote Tooltip"),text:this.onWrapText(t.getConstant("Insert Footnote")),id:i+Ty,cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Insert Footnote")}});break;case"InsertEndnote":n.push({prefixIcon:"e-de-endnote",tooltipText:t.getConstant("Endnote Tooltip"),text:this.onWrapText(t.getConstant("Insert Endnote")),id:i+Sy,cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Insert Endnote")}});break;case"ContentControl":n.push({template:'<button title="'+t.getConstant("Content Control")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-caret-hide" type="button" id="'+i+Wy+'"><span class="e-btn-icon e-icons e-de-ctnr-content-control e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(t.getConstant("Content Control"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:i+Wy,htmlAttributes:{"aria-label":t.getConstant("Content Control")}});break;case"XML Mapping":n.push({prefixIcon:"e-de-ctnr-xml-mapping",tooltipText:t.getConstant("XML Mapping Pane"),id:i+Dy,text:this.onWrapText(t.getConstant("XML Mapping Pane")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("XML Mapping Pane")}});break;default:n.push(r[parseInt(o.toString(),10)])}for(o=0;o<n.length;o++){var s;"Separator"!==n[o].text&&(s=o.toString(),n[o].htmlattributes={tabindex:s})}return n},Uy.prototype.clickHandler=function(e){var t=this.container.element.id+Zf;switch(e.item.id){case t+Xf:this.container.documentEditor.openBlank(),this.documentEditor.focusIn();break;case t+Jf:this.filePicker.value="",this.filePicker.click(),this.documentEditor.focusIn();break;case t+Yf:this.container.documentEditor.editorHistoryModule.undo();break;case t+Qf:this.container.documentEditor.editorHistoryModule.redo();break;case t+ty:this.container.documentEditor.showDialog("Table");break;case t+iy:this.container.documentEditor.showDialog("Hyperlink");break;case t+ny:this.container.documentEditor.showDialog("Bookmark");break;case t+ry:this.documentEditor.editorModule.isUserInsert=!0,this.documentEditor.editorModule.insertComment(""),this.documentEditor.editorModule.isUserInsert=!1;break;case t+oy:this.toggleTrackChangesInternal(e.item.id);break;case t+ay:this.container.documentEditor.selectionModule.goToHeader(),this.container.statusBar.toggleWebLayout();break;case t+sy:this.onToc();break;case t+Dy:this.container.documentEditor.isXmlPaneTool||this.container.documentEditor.showXmlPane(),this.container.statusBar.toggleWebLayout();break;case t+ly:this.container.documentEditor.selectionModule.goToFooter(),this.container.statusBar.toggleWebLayout();break;case t+hy:this.container.documentEditor.editorModule.insertPageNumber();break;case t+uy:this.container.documentEditor.showOptionsPane();break;case t+gy:this.toggleLocalPaste(e.item.id);break;case t+Iy:this.documentEditor.updateFields();break;case t+Ty:this.documentEditor.editorModule.insertFootnote();break;case t+Sy:this.documentEditor.editorModule.insertEndnote();break;default:this.container.trigger(ke,e)}e.item.id!==t+Xf&&e.item.id!==t+Jf&&e.item.id!==t+Yf&&e.item.id!==Qf&&e.item.id!==t+Dy&&e.item.id!==t+ry&&e.item.id!==t+oy&&e.item.id!==t+ay&&e.item.id!==t+sy&&e.item.id!==t+ly&&e.item.id!==t+hy&&e.item.id!==t+gy&&e.item.id!==t+Iy&&e.item.id!==t+Ty&&e.item.id!==t+Sy&&e.item.id!==t+dy&&e.item.id!==t+cy&&e.item.id!==t+my&&e.item.id!==t+Cy||this.documentEditor.focusIn()},Uy.prototype.toggleLocalPaste=function(e){this.container.enableLocalPaste=!this.container.enableLocalPaste,this.toggleButton(e,this.container.enableLocalPaste)},Uy.prototype.toggleEditing=function(){this.container.restrictEditing=!this.container.restrictEditing,this.container.showPropertiesPane=!this.container.restrictEditing},Uy.prototype.toggleRestrictEditing=function(e){var t=this.container.element.id+Zf+my;document.getElementById(t)&&this.toggleButton(t,e)},Uy.prototype.toggleButton=function(e,t){e=document.getElementById(e);t?(_.classList(e,["e-btn-toggle"],[]),e.setAttribute("aria-pressed","true")):(_.classList(e,[],["e-btn-toggle"]),e.setAttribute("aria-pressed","false"))},Uy.prototype.toggleTrackChangesInternal=function(e,t){_.isNullOrUndefined(t)||(this.container.enableTrackChanges=!t),this.container.enableTrackChanges=!this.container.enableTrackChanges,this.toggleButton(e,this.container.enableTrackChanges)},Uy.prototype.togglePropertiesPane=function(){this.container.showPropertiesPane=!this.container.showPropertiesPane},Uy.prototype.onDropDownButtonSelect=function(e){var t=this,i=this.container.element.id+Zf,e=e.item.id;e===i+ey?(this.imagePicker.value="",this.imagePicker.click()):e===i+Ny?this.container.documentEditor.showDialog("PageSetup"):e===i+Hy?this.container.documentEditor.showDialog("Columns"):e===i+Ry?this.container.documentEditor.editor.insertContentControl("Date"):e===i+My?this.container.documentEditor.editor.insertContentControl("CheckBox"):e===i+Ly?this.container.documentEditor.editor.insertContentControl("ComboBox"):e===i+Oy?this.container.documentEditor.editor.insertContentControl("RichText"):e===i+Ey?this.container.documentEditor.editor.insertContentControl("Text"):e===i+Ay?this.container.documentEditor.showDialog("PictureContentControl"):e===i+By?this.container.documentEditor.editor.insertContentControl("DropDownList"):e!==i+"_image_url"&&(e===i+by?this.toggleEditing():e===i+xy?this.documentEditor.documentHelper.restrictEditingPane.showHideRestrictPane(!0):e===i+Fy?this.documentEditor.editorModule.insertFormField("CheckBox"):e===i+Py?this.documentEditor.editorModule.insertFormField("DropDown"):e===i+ky&&this.documentEditor.editorModule.insertFormField("Text")),setTimeout(function(){t.documentEditor.focusIn()},30)},Uy.prototype.onFileChange=function(){var e,t,i=this,n=this.filePicker.files[0],r={fileSize:n.size,isCanceled:void 0};this.documentEditor.trigger(Fe,r),r.isCanceled||n&&(".sfdt"===(e=n.name.substr(n.name.lastIndexOf(".")))||".txt"===e?((t=new FileReader).onload=function(){".txt"===e?i.container.documentEditor.documentHelper.openTextFile(t.result):i.container.documentEditor.openAsync(t.result)},t.readAsText(n)):this.isSupportedFormatType(e.toLowerCase())?this.documentEditor.open(n):(r=new _.L10n("documenteditor",this.documentEditor.defaultLocale),C.DialogUtility.alert({content:r.getConstant("Unsupported format"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"center",Y:"center"}}).enableRtl=this.container.enableRtl),this.container.documentEditor.documentName=n.name.substr(0,n.name.lastIndexOf(".")))},Uy.prototype.isSupportedFormatType=function(e){switch(e){case".dotx":case".docx":case".docm":case".dotm":case".dot":case".doc":case".rtf":case".txt":case".xml":case".html":return!0;default:return!1}},Uy.prototype.failureHandler=function(e){"onError"===e.name?C.DialogUtility.alert({content:this.container.localObj.getConstant("Error in establishing connection with web server"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"center",Y:"center"}}).enableRtl=this.container.enableRtl:(alert("Failed to load the file"),this.documentEditor.fireServiceFailure(e)),C.hideSpinner(this.container.containerTarget)},Uy.prototype.successHandler=function(e){this.container.documentEditor.open(e.data),C.hideSpinner(this.container.containerTarget)},Uy.prototype.onImageChange=function(){var e=this,t=this.imagePicker.files[0],i=new FileReader;i.onload=function(){e.insertImage(i.result)},i.readAsDataURL(t)},Uy.prototype.insertImage=function(e){var t=document.createElement("img"),i=this.container;t.addEventListener("load",function(){i.documentEditor.editorModule.insertImageInternal(e,!0,this.width,this.height,this.alt)}),t.src=e},Uy.prototype.enableDisableFormField=function(e){var t=document.getElementById("container_toolbar_form_fields");_.isNullOrUndefined(t)||this.toolbar.enableItems(t.parentElement,e)},Uy.prototype.enableDisableInsertComment=function(e){this.isCommentEditing=!e;var t=this.container.element.id+Zf,t=document.getElementById(t+ry);!this.container.enableComment&&t?this.toolbar.removeItems(t.parentElement):t&&(_.isNullOrUndefined(this.documentEditor)||!this.documentEditor.isReadOnly&&!this.documentEditor.documentHelper.isDocumentProtected||(e=this.documentEditor.documentHelper.isCommentOnlyMode||!this.documentEditor.isReadOnlyMode),this.toolbar.enableItems(t.parentElement,e))},Uy.prototype.toggleTrackChanges=function(e){var t=this.container.element.id+Zf+oy;document.getElementById(t)&&this.toggleTrackChangesInternal(t,e)},Uy.prototype.enableDisableToolBarItem=function(e,t){if(!_.isNullOrUndefined(this.container.element)){for(var i=this.container.element.id+Zf,n=0,r=this.toolbar.items;n<r.length;n++){var o=r[n],s=o.id;s===i+Xf||s===i+Jf||s===i+uy||s===i+gy||s===i+my||"Separator"===o.type||e&&this.isCommentEditing&&s===i+ry||s!==i+Yf&&s!==i+Qf&&s!==i+ty&&s!==i+iy&&s!==i+ny&&s!==i+ry&&s!==i+ay&&s!==i+Dy&&s!==i+sy&&s!==i+ly&&s!==i+dy&&s!==i+Wy&&s!==i+hy&&s!==i+$f&&s!==i+Cy&&s!==i+cy&&s!==i+oy&&s!==i+Ty&&s!==i+Sy&&s!==i+Iy||t&&this.documentEditor.documentHelper.isFormFillProtectedMode&&s===i+Iy||(s=document.getElementById(o.id),_.isNullOrUndefined(s))||_.isNullOrUndefined(s.parentElement)||this.toolbar.enableItems(s.parentElement,e)}_.isNullOrUndefined(this.documentEditor)||this.enableDisableFormField(!this.documentEditor.enableHeaderAndFooter&&e&&!this.documentEditor.isReadOnlyMode);var a=this.documentEditor.selectionModule.isPlainContentControl(),a=((this.documentEditor.selectionModule.isinFootnote||this.documentEditor.selectionModule.isinEndnote||this.documentEditor.enableHeaderAndFooter||a)&&(this.containsItem(i+Sy)&&this.toolbar.enableItems(document.getElementById(i+Sy).parentElement,!1),this.containsItem(i+Ty)&&this.toolbar.enableItems(document.getElementById(i+Ty).parentElement,!1),this.containsItem(i+cy)&&this.toolbar.enableItems(document.getElementById(i+cy).parentElement,!1),a)&&(this.containsItem(i+ty)&&this.toolbar.enableItems(document.getElementById(i+ty).parentElement,!1),this.containsItem(i+$f)&&this.toolbar.enableItems(document.getElementById(i+$f).parentElement,!1),this.containsItem(i+ry)&&this.toolbar.enableItems(document.getElementById(i+ry).parentElement,!1),this.containsItem(i+ny)&&this.toolbar.enableItems(document.getElementById(i+ny).parentElement,!1),this.containsItem(i+iy)&&this.toolbar.enableItems(document.getElementById(i+iy).parentElement,!1),this.containsItem(i+Cy)&&this.toolbar.enableItems(document.getElementById(i+Cy).parentElement,!1),this.containsItem(i+Wy))&&this.toolbar.enableItems(document.getElementById(i+Wy).parentElement,!1),t&&!this.container.showPropertiesPane||(t&&(e=this.container.showPropertiesPane),_.classList(this.propertiesPaneButton.element.parentElement,e?[]:["e-de-overlay"],e?["e-de-overlay"]:[])),this.documentEditor.documentHelper.protectionType);(e||this.documentEditor.documentHelper.isDocumentProtected&&("FormFieldsOnly"===a||"CommentsOnly"===a))&&this.enableDisableUndoRedo(),this.documentEditor.documentHelper.isTrackedOnlyMode&&this.containsItem(i+oy)&&this.toolbar.enableItems(document.getElementById(i+oy).parentElement,!1)}},Uy.prototype.containsItem=function(e){for(var t=0,i=this.toolbar.items;t<i.length;t++)if(i[t].id===e)return!0;return!1},Uy.prototype.enableDisableUndoRedo=function(){var e,t=this.container.element.id+Zf;0<=this.toolbarItems.indexOf("Undo")&&(e=document.getElementById(t+Yf),_.isNullOrUndefined(e)||this.toolbar.enableItems(e.parentElement,this.container.documentEditor.editorHistoryModule.canUndo())),0<=this.toolbarItems.indexOf("Redo")&&(e=document.getElementById(t+Qf),_.isNullOrUndefined(e)||this.toolbar.enableItems(e.parentElement,this.container.documentEditor.editorHistoryModule.canRedo()))},Uy.prototype.onToc=function(){"TableOfContents"===this.container.previousContext&&"none"===this.container.propertiesPaneContainer.style.display?(this.container.showPropertiesPane=!1,this.documentEditor.focusIn()):("block"===this.container.headerFooterProperties.element.style.display&&this.documentEditor.selectionModule.closeHeaderFooter(),this.enableDisablePropertyPaneButton(!1),this.container.showProperties("toc"))},Uy.prototype.enableDisablePropertyPaneButton=function(e){e?_.classList(this.propertiesPaneButton.element.firstChild,["e-pane-enabled"],["e-pane-disabled"]):_.classList(this.propertiesPaneButton.element.firstChild,["e-pane-disabled"],["e-pane-enabled"])},Uy.prototype.destroy=function(){var e;this.restrictDropDwn&&(this.restrictDropDwn.destroy(),this.restrictDropDwn=void 0),this.imgDropDwn&&(this.imgDropDwn.destroy(),this.imgDropDwn=void 0),this.PageSetUpDropDwn&&(this.PageSetUpDropDwn.destroy(),this.PageSetUpDropDwn=void 0),this.breakDropDwn&&(this.breakDropDwn.destroy(),this.breakDropDwn=void 0),this.formFieldDropDown&&(this.formFieldDropDown.destroy(),this.formFieldDropDown=void 0),this.ContentControlDropDwn&&(this.ContentControlDropDwn.destroy(),this.ContentControlDropDwn=void 0),this.toolbar&&(e=this.toolbar.element,this.toolbar.destroy(),this.toolbar=void 0,e.parentElement.removeChild(e)),this.container.toolbarContainer&&(this.container.containerTarget.removeChild(this.container.toolbarContainer),this.container.toolbarContainer=void 0),this.container.toolbarModule&&(this.container.toolbarModule=void 0),this.propertiesPaneButton&&this.propertiesPaneButton.destroy(),this.breakListView&&(this.breakListView.destroy(),this.breakListView=void 0),this.propertiesPaneButton=void 0,this.toolbarItems=[],this.toolbarItems=void 0,this.container=void 0},Uy);function Uy(e){this.isCommentEditing=!1,this.container=e,this.importHandler=new A}Object.defineProperty(zy.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),Object.defineProperty(zy.prototype,"toolbar",{get:function(){return this.container.toolbarModule},enumerable:!0,configurable:!0}),zy.prototype.enableDisableElements=function(e){e?_.classList(this.element,[],["e-de-overlay"]):_.classList(this.element,["e-de-overlay"],[])},zy.prototype.initHeaderFooterPane=function(){this.initializeHeaderFooter(),this.element.style.display="none",this.container.propertiesPaneContainer.appendChild(this.element)},zy.prototype.showHeaderFooterPane=function(e){e&&(this.toolbar&&this.toolbar.enableDisablePropertyPaneButton(!1),this.onSelectionChange()),!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display||(this.element.style.display=e?"block":"none",this.documentEditor.resize())},zy.prototype.initializeHeaderFooter=function(){var e=this,t=(this.localObj=new _.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.elementId="header_footer_properties",this.element=_.createElement("div",{id:this.documentEditor.element.id+this.elementId,className:"e-de-prop-pane"}),this.headerDiv=this.createDivTemplate("_header_footer",this.element,"padding-bottom:0"),_.classList(this.headerDiv,["e-de-cntr-pane-padding"],[]),this.headerLabel=_.createElement("label",{className:"e-de-prop-header-label"}),this.headerLabel.innerHTML=this.localObj.getConstant("Header And Footer"),t=this.isRtl?"float:left;":"float:right;",this.closeIcon=_.createElement("span",{id:"_header_footer_close",className:"e-de-ctnr-close e-de-close-icon e-icons",styles:"display:inline-block;cursor:pointer;"+t}),this.closeIcon.addEventListener("click",function(){e.onClose()}),this.headerDiv.appendChild(this.headerLabel),this.headerDiv.appendChild(this.closeIcon),this.optionsLabelDiv=this.createDivTemplate(this.elementId+"_options",this.element),_.classList(this.optionsLabelDiv,["e-de-cntr-pane-padding","e-de-prop-separator-line"],[]),this.optionsLabel=_.createElement("label",{className:"e-de-ctnr-prop-label",styles:"height:20px;"}),this.optionsLabel.innerHTML=this.localObj.getConstant("Options"),this.optionsLabelDiv.appendChild(this.optionsLabel),this.optionsDiv=this.createDivTemplate(this.elementId+"_optionsDiv",this.optionsLabelDiv),this.firstPageDiv=this.createDivTemplate(this.elementId+"_firstPageDiv",this.optionsDiv),_.classList(this.firstPageDiv,["e-de-hdr-ftr-frst-div"],[]),_.createElement("input",{id:"firstPage",className:"e-de-prop-sub-label"})),t=(this.firstPageDiv.appendChild(t),this.firstPage=new H.CheckBox({label:this.localObj.getConstant("Different First Page"),change:this.changeFirstPageOptions.bind(this),cssClass:"e-de-prop-sub-label",enableRtl:this.isRtl}),this.firstPage.appendTo(t),this.firstPageDiv.children[0].setAttribute("title",this.localObj.getConstant("Different header and footer for first page")),this.oddOrEvenDiv=this.createDivTemplate(this.elementId+"_oddOrEvenDiv",this.optionsDiv),_.classList(this.oddOrEvenDiv,["e-de-hdr-ftr-frst-div"],[]),_.createElement("input",{id:"oddOrEven",className:"e-de-sub-prop-label"})),t=(this.oddOrEvenDiv.appendChild(t),this.oddOrEven=new H.CheckBox({label:this.localObj.getConstant("Different Odd And Even Pages"),change:this.changeoddOrEvenOptions.bind(this),cssClass:"e-de-prop-sub-label",enableRtl:this.isRtl}),this.oddOrEven.appendTo(t),this.oddOrEvenDiv.children[0].setAttribute("title",this.localObj.getConstant("Different header and footer for odd and even pages")),this.linkToPreviousDiv=this.createDivTemplate(this.elementId+"_linkToPreviousDiv",this.optionsDiv),_.createElement("input",{id:"linkToPrevious",className:"e-de-sub-prop-label"})),t=(this.linkToPreviousDiv.appendChild(t),this.linkToPrevious=new H.CheckBox({label:this.localObj.getConstant("Link to Previous"),change:this.changeLinkToPreviousOptions.bind(this),cssClass:"e-de-prop-sub-label",enableRtl:this.isRtl,checked:!0}),this.linkToPrevious.appendTo(t),this.linkToPreviousDiv.children[0].setAttribute("title",this.localObj.getConstant("Link to the previous Title")),this.positionLabelDiv=this.createDivTemplate(this.elementId+"_positionLabelDiv",this.element),_.classList(this.positionLabelDiv,["e-de-cntr-pane-padding","e-de-prop-separator-line"],[]),this.positionLabel=_.createElement("label",{className:"e-de-ctnr-prop-label",styles:"height:20px;"}),this.positionLabel.innerHTML=this.localObj.getConstant("Position"),this.positionLabelDiv.appendChild(this.positionLabel),this.positionDiv=this.createDivTemplate(this.elementId+"_positionDiv",this.positionLabelDiv),this.headerTopDiv=this.createDivTemplate(this.elementId+"_headerTopDiv",this.positionDiv),_.classList(this.headerTopDiv,["e-de-hdr-ftr-top-div"],[]),this.headerTopLabel=_.createElement("label",{className:"e-de-prop-sub-label",styles:"display:block"}),this.headerTopLabel.innerHTML=this.localObj.getConstant("Header from Top"),this.headerTopDiv.appendChild(this.headerTopLabel),_.createElement("input",{id:this.documentEditor.element.id+"_headerFromTop",className:"e-de-prop-sub-label"})),t=(t.setAttribute("aria-label",this.localObj.getConstant("Header from Top")),this.headerTopDiv.appendChild(t),this.headerFromTop=new D.NumericTextBox({value:36,cssClass:"e-de-prop-header-numeric",showSpinButton:!1,format:"n0",decimals:2,max:1584,min:0,enableRtl:this.isRtl}),this.headerFromTop.appendTo(t),this.headerFromTop.element.parentElement.setAttribute("title",this.localObj.getConstant("Distance from top of the page to top of the header")),this.footerBottomDiv=this.createDivTemplate(this.elementId+"_footerBottomDiv",this.positionDiv),this.footerBottomLabel=_.createElement("label",{className:"e-de-prop-sub-label",styles:"display:block"}),this.footerBottomLabel.innerHTML=this.localObj.getConstant("Footer from Bottom"),this.footerBottomDiv.appendChild(this.footerBottomLabel),_.createElement("input",{id:this.documentEditor.element.id+"_footerFromTop",className:"e-de-prop-sub-label"}));t.setAttribute("aria-label",this.localObj.getConstant("Footer from Bottom")),this.footerBottomDiv.appendChild(t),this.footerFromTop=new D.NumericTextBox({value:36,cssClass:"e-de-prop-header-numeric",showSpinButton:!1,format:"n0",decimals:2,max:1584,min:0,enableRtl:this.isRtl}),this.footerFromTop.appendTo(t),this.footerFromTop.element.parentElement.setAttribute("title",this.localObj.getConstant("Distance from bottom of the page to bottom of the footer"))},zy.prototype.createDivTemplate=function(e,t,i){return this.divElement=i?_.createElement("div",{id:e,styles:i}):_.createElement("div",{id:e}),t.appendChild(this.divElement),this.divElement},zy.prototype.wireEvents=function(){this.headerFromTop.element.addEventListener("click",this.HeaderTopApplyClickHook),this.footerFromTop.element.addEventListener("click",this.FooterTopApplyClickHook),this.headerFromTop.element.addEventListener("keydown",this.OnHeaderValueKeyDownHook),this.footerFromTop.element.addEventListener("keydown",this.OnFooterValueKeyDownHook),this.headerFromTop.element.addEventListener("blur",this.ChangeHeaderBlurHook),this.footerFromTop.element.addEventListener("blur",this.ChangeFooterBlurHook)},zy.prototype.headerTopApply=function(){this.isHeaderTopApply=!0},zy.prototype.footerTopapply=function(){this.isFooterTopApply=!0},zy.prototype.changeHeaderBlur=function(){this.changeHeaderValue(),this.isHeaderTopApply=!1},zy.prototype.changeFooterBlur=function(){this.changeFooterValue(),this.isFooterTopApply=!1},zy.prototype.onClose=function(){this.container.showHeaderProperties=!0,this.container.documentEditor.selectionModule.closeHeaderFooter()},zy.prototype.changeFirstPageOptions=function(){var e=this;this.documentEditor.isReadOnly||(this.documentEditor.selectionModule.sectionFormat.differentFirstPage=this.firstPage.checked,setTimeout(function(){e.documentEditor.focusIn()},10))},zy.prototype.changeoddOrEvenOptions=function(){var e=this;this.documentEditor.isReadOnly||(this.documentEditor.selectionModule.sectionFormat.differentOddAndEvenPages=this.oddOrEven.checked,setTimeout(function(){e.documentEditor.focusIn()},10))},zy.prototype.changeLinkToPreviousOptions=function(){var e=this;if(!this.documentEditor.isReadOnly){var t=this.documentEditor.selectionModule.start.paragraph.containerWidget.headerFooterType,i=this.linkToPrevious.checked;switch(t){case"OddHeader":this.documentEditor.selectionModule.sectionFormat.oddPageHeader.linkToPrevious=i;break;case"OddFooter":this.documentEditor.selectionModule.sectionFormat.oddPageFooter.linkToPrevious=i;break;case"EvenHeader":this.documentEditor.selectionModule.sectionFormat.evenPageHeader.linkToPrevious=i;break;case"EvenFooter":this.documentEditor.selectionModule.sectionFormat.evenPageFooter.linkToPrevious=i;break;case"FirstPageHeader":this.documentEditor.selectionModule.sectionFormat.firstPageHeader.linkToPrevious=i;break;case"FirstPageFooter":this.documentEditor.selectionModule.sectionFormat.firstPageFooter.linkToPrevious=i}setTimeout(function(){e.documentEditor.focusIn()},10)}},zy.prototype.changeHeaderValue=function(){var e;this.isHeaderTopApply&&!this.documentEditor.isReadOnly&&((e=this.headerFromTop.value)>this.headerFromTop.max&&(e=this.headerFromTop.max),this.documentEditor.selectionModule.sectionFormat.headerDistance=e)},zy.prototype.onHeaderValue=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.changeHeaderValue(),t.isHeaderTopApply=!1},30)},zy.prototype.onFooterValue=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.changeFooterValue(),t.isFooterTopApply=!1},30)},zy.prototype.changeFooterValue=function(){var e;this.isFooterTopApply&&!this.documentEditor.isReadOnly&&((e=this.footerFromTop.value)>this.footerFromTop.max&&(e=this.footerFromTop.max),this.documentEditor.selectionModule.sectionFormat.footerDistance=e)},zy.prototype.onSelectionChange=function(){if(this.headerFromTop.value=this.documentEditor.selectionModule.sectionFormat.headerDistance,this.footerFromTop.value=this.documentEditor.selectionModule.sectionFormat.footerDistance,this.documentEditor.selectionModule.sectionFormat.differentFirstPage?this.firstPage.checked=!0:this.firstPage.checked=!1,this.documentEditor.selectionModule.sectionFormat.differentOddAndEvenPages?this.oddOrEven.checked=!0:this.oddOrEven.checked=!1,0===this.documentEditor.selectionModule.start.paragraph.bodyWidget.sectionIndex)this.linkToPrevious.disabled=!0;else switch(this.linkToPrevious.disabled=!1,this.documentEditor.selectionModule.start.paragraph.containerWidget.headerFooterType){case"OddHeader":this.linkToPrevious.checked=this.documentEditor.selectionModule.sectionFormat.oddPageHeader.linkToPrevious;break;case"OddFooter":this.linkToPrevious.checked=this.documentEditor.selectionModule.sectionFormat.oddPageFooter.linkToPrevious;break;case"EvenHeader":this.linkToPrevious.checked=this.documentEditor.selectionModule.sectionFormat.evenPageHeader.linkToPrevious;break;case"EvenFooter":this.linkToPrevious.checked=this.documentEditor.selectionModule.sectionFormat.evenPageFooter.linkToPrevious;break;case"FirstPageHeader":this.linkToPrevious.checked=this.documentEditor.selectionModule.sectionFormat.firstPageHeader.linkToPrevious;break;case"FirstPageFooter":this.linkToPrevious.checked=this.documentEditor.selectionModule.sectionFormat.firstPageFooter.linkToPrevious}},zy.prototype.destroy=function(){this.unWireEvents(),this.removeHTMLDOM(),this.element&&(this.element.innerHTML="",this.element.parentElement)&&this.element.parentElement.removeChild(this.element),this.element=void 0,this.firstPage&&this.firstPage.destroy(),this.firstPage=void 0,this.oddOrEven&&this.oddOrEven.destroy(),this.oddOrEven=void 0,this.linkToPrevious&&this.linkToPrevious.destroy(),this.linkToPrevious=void 0,this.headerFromTop&&(this.headerFromTop.destroy(),this.headerFromTop=void 0),this.footerFromTop&&(this.footerFromTop.destroy(),this.footerFromTop=void 0),this.container=void 0,this.localObj=void 0,this.elementId=void 0},zy.prototype.unWireEvents=function(){this.headerFromTop.element.removeEventListener("click",this.HeaderTopApplyClickHook),this.footerFromTop.element.removeEventListener("click",this.FooterTopApplyClickHook),this.headerFromTop.element.removeEventListener("keydown",this.OnHeaderValueKeyDownHook),this.footerFromTop.element.removeEventListener("keydown",this.OnFooterValueKeyDownHook),this.headerFromTop.element.removeEventListener("blur",this.ChangeHeaderBlurHook),this.footerFromTop.element.removeEventListener("blur",this.ChangeFooterBlurHook),this.HeaderTopApplyClickHook=void 0,this.FooterTopApplyClickHook=void 0,this.OnHeaderValueKeyDownHook=void 0,this.OnFooterValueKeyDownHook=void 0,this.ChangeHeaderBlurHook=void 0,this.ChangeFooterBlurHook=void 0},zy.prototype.removeHTMLDOM=function(){this.headerDiv.remove(),this.headerLabel.remove(),this.closeIcon.remove(),this.optionsLabelDiv.remove(),this.optionsLabel.remove(),this.optionsDiv.remove(),this.firstPageDiv.remove(),this.oddOrEvenDiv.remove(),this.linkToPreviousDiv.remove(),this.positionLabelDiv.remove(),this.positionLabel.remove(),this.positionDiv.remove(),this.headerTopDiv.remove(),this.headerTopLabel.remove(),this.footerBottomDiv.remove(),this.footerBottomLabel.remove(),this.divElement.remove()};var Vy=zy;function zy(e,t){this.isHeaderTopApply=!1,this.isFooterTopApply=!1,this.HeaderTopApplyClickHook=this.headerTopApply.bind(this),this.FooterTopApplyClickHook=this.footerTopapply.bind(this),this.OnHeaderValueKeyDownHook=this.onHeaderValue.bind(this),this.OnFooterValueKeyDownHook=this.onFooterValue.bind(this),this.ChangeHeaderBlurHook=this.changeHeaderBlur.bind(this),this.ChangeFooterBlurHook=this.changeFooterBlur.bind(this),this.container=e,this.isRtl=t,this.initHeaderFooterPane(),this.wireEvents()}Object.defineProperty(_y.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),_y.prototype.enableDisableElements=function(e){e?_.classList(this.element,[],["e-de-overlay"]):_.classList(this.element,["e-de-overlay"],[])},_y.prototype.initializeImageProperties=function(){this.element=_.createElement("div",{id:this.elementId+"_imageProperties",className:"e-de-prop-pane"}),this.element.style.display="none",this.container.propertiesPaneContainer.appendChild(this.element),this.initImageProp(),this.initImageAltProp(),this.wireEvents()},_y.prototype.initImageProp=function(){var e=new _.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale);this.imageDiv=_.createElement("div",{id:this.elementId+"_imageDiv",className:"e-de-cntr-pane-padding e-de-prop-separator-line"}),this.element.appendChild(this.imageDiv),this.label=_.createElement("label",{className:"e-de-ctnr-prop-label"}),this.label.textContent=e.getConstant("Image"),this.imageDiv.appendChild(this.label),this.outerDiv=_.createElement("div"),this.imageDiv.appendChild(this.outerDiv),this.widthElement=this.createImagePropertiesDiv("_widthDiv",this.outerDiv,"_widthInput",e.getConstant("W"),e.getConstant("Width")),this.widthNumericBox=new D.NumericTextBox({min:0,max:23500,cssClass:"e-de-image-property",showSpinButton:!1,format:"n0",decimals:2}),this.widthNumericBox.appendTo(this.widthElement),this.heightElement=this.createImagePropertiesDiv("_heightDiv",this.outerDiv,"_heightInput",e.getConstant("H"),e.getConstant("Height")),this.heightNumericBox=new D.NumericTextBox({min:0,max:23500,cssClass:"e-de-image-property",showSpinButton:!1,format:"n0",decimals:2}),this.heightNumericBox.appendTo(this.heightElement),this.aspectRatioDiv=_.createElement("div",{id:this.elementId+"_aspectRatioDiv"}),this.aspectRatioDiv.setAttribute("title",e.getConstant("Aspect ratio")),this.outerDiv.appendChild(this.aspectRatioDiv),this.aspectRatio=_.createElement("input",{id:this.elementId+"_aspectRatio",className:"e-de-ctnr-prop-label"}),this.aspectRatioDiv.appendChild(this.aspectRatio),this.aspectRatioBtn=new H.CheckBox({label:e.getConstant("Aspect ratio"),enableRtl:this.isRtl},this.aspectRatio)},_y.prototype.initImageAltProp=function(){var e=new _.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale);this.altDiv=_.createElement("div",{id:this.elementId+"_altDiv",className:"e-de-cntr-pane-padding e-de-prop-separator-line"}),this.element.appendChild(this.altDiv),this.alabel=_.createElement("label",{className:"e-de-ctnr-prop-label"}),this.alabel.textContent=e.getConstant("Alternate Text"),this.altDiv.appendChild(this.alabel),this.textArea=_.createElement("textarea",{id:this.elementId+"_textarea",className:"e-de-ctnr-prop-label "}),this.altDiv.appendChild(this.textArea),this.textareaObj=new D.TextBox({floatLabelType:"Never"}),this.textareaObj.appendTo(this.textArea)},_y.prototype.createImagePropertiesDiv=function(e,t,i,n,r){e=_.createElement("div",{id:this.elementId+e,styles:"position: relative;width: 100%;",className:"e-de-ctnr-segment"}),e.setAttribute("title",r),t.appendChild(e),r=_.createElement("input",{id:this.elementId+i,className:"e-textbox",styles:"width:100%;"}),e.appendChild(r),t=_.createElement("span",{className:"e-de-img-prty-span"});return t.textContent=n,e.appendChild(t),r},_y.prototype.wireEvents=function(){this.aspectRatioBtn.element.addEventListener("change",this.onAspectRatioBtnClickHook),this.widthNumericBox.element.addEventListener("click",this.widthBlurHook),this.heightNumericBox.element.addEventListener("click",this.heightBlurHook),this.widthNumericBox.element.addEventListener("keydown",this.onImageWidthHook),this.heightNumericBox.element.addEventListener("keydown",this.onImageHeightHook),this.widthNumericBox.element.addEventListener("blur",this.widthNumericBlurHook),this.heightNumericBox.element.addEventListener("blur",this.heightNumericBlurHook),this.textArea.addEventListener("blur",this.altTextAreaBlurHook)},_y.prototype.altTextAreaBlur=function(){this.documentEditor.selectionModule.imageFormat.alternateText!==this.textArea.value&&this.applyImageAlternativeText()},_y.prototype.heightNumericBlur=function(){this.applyImageHeight(),this.isHeightApply=!1},_y.prototype.widthNumericBlur=function(){this.applyImageWidth(),this.isWidthApply=!1},_y.prototype.widthBlur=function(){this.isWidthApply=!0},_y.prototype.heightBlur=function(){this.isHeightApply=!0},_y.prototype.applyImageAlternativeText=function(){var e=_.SanitizeHtmlHelper.sanitize(this.textArea.value);_.isNullOrUndefined(e)||this.documentEditor.selectionModule.imageFormat.applyImageAlternativeText(e)},_y.prototype.onImageWidth=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyImageWidth(),t.isWidthApply=!1},30)},_y.prototype.onImageHeight=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyImageHeight(),t.isHeightApply=!1},30)},_y.prototype.applyImageWidth=function(){var e,t;this.isMaintainAspectRatio?this.isMaintainAspectRatio&&(t=(e=(e=this.widthNumericBox.value)>this.widthNumericBox.max?this.widthNumericBox.max:e)/this.documentEditor.selectionModule.imageFormat.width,t=this.heightNumericBox.value*t,this.heightNumericBox.value=t,null!==e)&&null!==t&&this.documentEditor.selectionModule.imageFormat.resize(e,t):(e=this.widthNumericBox.value,t=this.heightNumericBox.value,e>this.widthNumericBox.max&&(e=this.widthNumericBox.max),t>this.heightNumericBox.max&&(t=this.heightNumericBox.max),null!==e&&null!==t&&this.documentEditor.selectionModule.imageFormat.resize(e,t))},_y.prototype.applyImageHeight=function(){var e,t;this.isMaintainAspectRatio?this.isMaintainAspectRatio&&(e=(t=this.heightNumericBox.value)/this.documentEditor.selectionModule.imageFormat.height,e=this.widthNumericBox.value*e,null!==(this.widthNumericBox.value=e))&&null!==t&&this.documentEditor.selectionModule.imageFormat.resize(e,t):(e=this.widthNumericBox.value,t=this.heightNumericBox.value,null!==e&&null!==t&&this.documentEditor.selectionModule.imageFormat.resize(e,t))},_y.prototype.onAspectRatioBtnClick=function(){this.isMaintainAspectRatio?this.isMaintainAspectRatio=!1:this.isMaintainAspectRatio=!0},_y.prototype.showImageProperties=function(e){"block"===this.element.style.display&&this.updateImageProperties(),!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display||(this.element.style.display=e?"block":"none",this.documentEditor.resize())},_y.prototype.updateImageProperties=function(){this.widthNumericBox.value=this.documentEditor.selectionModule.imageFormat.width,this.heightNumericBox.value=this.documentEditor.selectionModule.imageFormat.height,_.isNullOrUndefined(this.documentEditor.selectionModule.imageFormat.alternateText)?this.textArea.value="":this.textArea.value=this.documentEditor.selectionModule.imageFormat.alternateText},_y.prototype.destroy=function(){this.unWireEvents(),this.removeHTMLDom(),this.widthNumericBox&&this.widthNumericBox.destroy(),this.widthNumericBox=void 0,this.heightNumericBox&&this.heightNumericBox.destroy(),this.heightNumericBox=void 0,this.aspectRatioBtn&&this.aspectRatioBtn.destroy(),this.aspectRatioBtn=void 0,this.textareaObj&&(this.textareaObj.destroy(),this.textArea.remove(),this.textArea=void 0),this.element&&(this.element.innerHTML="",this.element=void 0),this.container=void 0},_y.prototype.removeHTMLDom=function(){this.outerDiv.remove(),this.label.remove(),this.imageDiv.remove(),this.aspectRatioDiv.remove(),this.aspectRatio.remove(),this.alabel.remove(),this.textArea.remove(),this.altDiv.remove(),this.element.remove()},_y.prototype.unWireEvents=function(){this.aspectRatioBtn.element.removeEventListener("change",this.onAspectRatioBtnClickHook),this.widthNumericBox.element.removeEventListener("click",this.widthBlurHook),this.heightNumericBox.element.removeEventListener("click",this.heightBlurHook),this.widthNumericBox.element.removeEventListener("keydown",this.onImageWidthHook),this.heightNumericBox.element.removeEventListener("keydown",this.onImageHeightHook),this.widthNumericBox.element.removeEventListener("blur",this.widthNumericBlurHook),this.heightNumericBox.element.removeEventListener("blur",this.heightNumericBlurHook),this.textArea.removeEventListener("blur",this.altTextAreaBlurHook),this.onAspectRatioBtnClickHook=void 0,this.widthBlurHook=void 0,this.heightBlurHook=void 0,this.onImageWidthHook=void 0,this.onImageHeightHook=void 0,this.widthNumericBlurHook=void 0,this.heightNumericBlurHook=void 0,this.altTextAreaBlurHook=void 0};var qy=_y;function _y(e,t){this.isWidthApply=!1,this.isHeightApply=!1,this.onAspectRatioBtnClickHook=this.onAspectRatioBtnClick.bind(this),this.widthBlurHook=this.widthBlur.bind(this),this.heightBlurHook=this.heightBlur.bind(this),this.onImageWidthHook=this.onImageWidth.bind(this),this.onImageHeightHook=this.onImageHeight.bind(this),this.widthNumericBlurHook=this.widthNumericBlur.bind(this),this.heightNumericBlurHook=this.heightNumericBlur.bind(this),this.altTextAreaBlurHook=this.altTextAreaBlur.bind(this),this.container=e,this.elementId=this.documentEditor.element.id,this.isMaintainAspectRatio=!1,this.isRtl=t,this.initializeImageProperties()}Object.defineProperty(Gy.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),Object.defineProperty(Gy.prototype,"toolbar",{get:function(){return this.container.toolbarModule},enumerable:!0,configurable:!0}),Gy.prototype.enableDisableElements=function(e){e?_.classList(this.element,[],["e-de-overlay"]):_.classList(this.element,["e-de-overlay"],[])},Gy.prototype.initializeTocPane=function(){this.localObj=new _.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.element=_.createElement("div",{id:this.elementId+"_tocProperties",className:"e-de-prop-pane"});var e=_.createElement("div",{className:"e-de-cntr-pane-padding e-de-prop-separator-line"});this.tocHeaderDiv(e),this.initTemplates(e),e=_.createElement("div",{className:"e-de-cntr-pane-padding"}),this.tocOptionsDiv(e),this.contentStylesDropdown(e),this.checkboxContent(e),this.buttonDiv(e),this.wireEvents(),this.updateTocProperties(),this.container.propertiesPaneContainer.appendChild(this.element)},Gy.prototype.updateTocProperties=function(){this.rightalignPageNumber.checked=!0,this.showPageNumber.checked=!0,this.hyperlink.checked=!0},Gy.prototype.wireEvents=function(){this.cancelBtn.element.addEventListener("click",this.onCloseClickHook),this.updateBtn.element.addEventListener("click",this.onInsertToClickHook),this.closeButton.addEventListener("click",this.onCloseClickHook)},Gy.prototype.onCloseClick=function(){this.onClose()},Gy.prototype.onClose=function(){this.container.showPropertiesPane&&"TableOfContents"!==this.container.previousContext?this.container.showPropertiesPaneOnSelection():(this.showTocPane(!1),this.toolbar&&this.toolbar.enableDisablePropertyPaneButton(!1),this.container.showPropertiesPane=!1)},Gy.prototype.tocHeaderDiv=function(e){var t,i=this.isRtl?(t="float:left;","margin-left:7px;"):(t="float:right;","margin-right:7px;");this.headerDiv=_.createElement("div",{id:this.elementId+"toc_id",styles:"display: block;"}),e.appendChild(this.headerDiv),this.element.appendChild(e),this.title=_.createElement("label",{className:"e-de-ctnr-prop-label"}),this.title.textContent=this.localObj.getConstant("Table of Contents"),this.headerDiv.appendChild(this.title),this.closeButton=_.createElement("span",{className:"e-de-ctnr-close e-icons",styles:"cursor: pointer;display:inline-block;color: #4A4A4A;"+t+i}),this.headerDiv.appendChild(this.closeButton)},Gy.prototype.initTemplates=function(e){this.template1(e)},Gy.prototype.template1=function(e){this.template1Div=_.createElement("div",{className:"e-de-toc-template1"}),this.isRtl&&this.template1Div.classList.add("e-de-rtl"),e.appendChild(this.template1Div),this.templateContent1=_.createElement("div",{className:"e-de-toc-template1-content1"}),this.templateContent1.textContent=this.localObj.getConstant("HEADING - - - - 1"),this.template1Div.appendChild(this.templateContent1),this.templateContent2=_.createElement("div",{className:"e-de-toc-template1-content2"}),this.templateContent2.textContent=this.localObj.getConstant("HEADING - - - - 2"),this.template1Div.appendChild(this.templateContent2),this.templateContent3=_.createElement("div",{className:"e-de-toc-template1-content3"}),this.templateContent3.textContent=this.localObj.getConstant("HEADING - - - - 3"),this.template1Div.appendChild(this.templateContent3)},Gy.prototype.tocOptionsDiv=function(e){this.optionsDiv=_.createElement("div"),e.appendChild(this.optionsDiv),this.element.appendChild(e),this.isRtl&&this.optionsDiv.classList.add("e-de-rtl"),this.label=_.createElement("label",{className:"e-de-ctnr-prop-label"}),this.label.textContent=this.localObj.getConstant("Options"),this.optionsDiv.appendChild(this.label)},Gy.prototype.createDropDownButton=function(e,t,i,n,r){e=_.createElement("input",{id:e});return t.appendChild(e),new U.DropDownList({index:r,dataSource:n,popupHeight:"150px",cssClass:"e-de-prop-font-button",placeholder:this.localObj.getConstant("Levels")},e)},Gy.prototype.contentStylesDropdown=function(e){var t=this;this.isRtl,this.contentStyleElement=_.createElement("div",{id:"contentstyle_div"}),this.contentStyleElement.setAttribute("title",this.localObj.getConstant("Number of heading or outline levels to be shown in table of contents")),e.appendChild(this.contentStyleElement),this.isRtl,this.dropDownLabel=_.createElement("label",{className:"e-de-prop-sub-label",styles:"display:block"}),this.dropDownLabel.textContent=this.localObj.getConstant("Levels"),this.contentStyleElement.appendChild(this.dropDownLabel),e.appendChild(this.contentStyleElement);this.borderLevelStyle=this.createDropDownButton(this.elementId+"_borderLevelDiv",this.contentStyleElement,"",["1","2","3","4","5","6","7","8","9"],2),this.borderLevelStyle.change=function(e){t.borderLevelStyle.value=e.item.value},e.appendChild(this.contentStyleElement)},Gy.prototype.checkboxContent=function(e){this.isRtl,this.checkboxElement=_.createElement("div",{id:"toc_checkboxDiv",styles:"margin-bottom:36px;"}),e.appendChild(this.checkboxElement),this.showPageNumberDiv=_.createElement("div",{className:"e-de-toc-checkbox1"}),this.showPageNumberDiv.setAttribute("title",this.localObj.getConstant("Show page numbers in table of contents")),this.checkboxElement.appendChild(this.showPageNumberDiv),this.showpagenumberCheckboxElement=_.createElement("input",{id:"showpagenumber",styles:"width:12px;height:12px;margin-bottom:8px",className:"e-de-prop-sub-label"}),this.showPageNumberDiv.appendChild(this.showpagenumberCheckboxElement),this.showPageNumber=new H.CheckBox({label:this.localObj.getConstant("Show page numbers"),enableRtl:this.isRtl}),this.showPageNumber.appendTo(this.showpagenumberCheckboxElement),this.rightAlignDiv=_.createElement("div",{className:"e-de-toc-checkbox2"}),this.rightAlignDiv.setAttribute("title",this.localObj.getConstant("Right align page numbers in table of contents")),this.checkboxElement.appendChild(this.rightAlignDiv),this.rightalignpagenumberCheckboxElement=_.createElement("input",{id:"rightalignpagenumber",styles:"width:12px;height:12px",className:"e-de-prop-sub-label"}),this.rightAlignDiv.appendChild(this.rightalignpagenumberCheckboxElement),this.rightalignPageNumber=new H.CheckBox({label:this.localObj.getConstant("Right align page numbers"),enableRtl:this.isRtl}),this.rightalignPageNumber.appendTo(this.rightalignpagenumberCheckboxElement),this.hyperlinkDiv=_.createElement("div",{className:"e-de-toc-checkbox3"}),this.hyperlinkDiv.setAttribute("title",this.localObj.getConstant("Use hyperlinks instead of page numbers")),this.checkboxElement.appendChild(this.hyperlinkDiv),this.hyperlinkCheckboxElement=_.createElement("input",{id:"hyperlinkdiv",styles:"width:12px;height:12px",className:"e-de-prop-sub-label"}),this.hyperlinkDiv.appendChild(this.hyperlinkCheckboxElement),this.hyperlink=new H.CheckBox({label:this.localObj.getConstant("Use hyperlinks"),enableRtl:this.isRtl}),this.hyperlink.appendTo(this.hyperlinkCheckboxElement)},Gy.prototype.buttonDiv=function(e){var t=this.isRtl?"float:left":"float:right";this.footerElement=_.createElement("div",{id:"footerDiv",styles:t}),e.appendChild(this.footerElement),this.updatebuttoncontentStyleElement=_.createElement("button",{id:"footerupdatebuttonDiv",attrs:{type:"button"}}),this.footerElement.appendChild(this.updatebuttoncontentStyleElement),this.updateBtn=new H.Button({content:this.localObj.getConstant("Update"),cssClass:"btn-update",isPrimary:!0}),this.updateBtn.appendTo(this.updatebuttoncontentStyleElement),this.cancelbuttoncontentStyleElement=_.createElement("button",{id:"footercancelbuttonDiv",attrs:{type:"button"}}),this.footerElement.appendChild(this.cancelbuttoncontentStyleElement),this.cancelBtn=new H.Button({content:this.localObj.getConstant("Cancel"),cssClass:this.isRtl?"e-de-btn-cancel-rtl":"e-de-btn-cancel"}),this.cancelbuttoncontentStyleElement.setAttribute("aria-label",this.cancelBtn.content),this.cancelBtn.appendTo(this.cancelbuttoncontentStyleElement)},Gy.prototype.enableDisableInsertButton=function(e){"Text"===this.prevContext?this.updateBtn.disabled=e:this.updateBtn.disabled=!1},Gy.prototype.showTocPane=function(e,t){!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display?this.updateBtn&&this.enableDisableInsertButton(!1):(this.element.style.display=e?"block":"none",this.updateBtn.content="TableOfContents"===this.documentEditor.selectionModule.contextType?this.localObj.getConstant("Update"):this.localObj.getConstant("Insert"),this.updateBtn.element.setAttribute("aria-label",this.updateBtn.content),this.prevContext=this.documentEditor.selectionModule.contextType,this.enableDisableInsertButton(this.documentEditor.selectionModule.isPlainContentControl()),this.documentEditor.resize(),e&&this.updateBtn.element.focus())},Gy.prototype.onInsertToc=function(){var e={startLevel:1,endLevel:parseInt(this.borderLevelStyle.value,0),includeHyperlink:this.hyperlink.checked,includeOutlineLevels:!0,includePageNumber:this.showPageNumber.checked,rightAlign:this.rightalignPageNumber.checked};e.rightAlign&&(e.tabLeader="Dot"),this.documentEditor.editorModule.insertTableOfContents(e),this.documentEditor.focusIn()},Gy.prototype.destroy=function(){this.container=void 0,this.removeHTMLDOM(),this.unWireEvents(),this.showPageNumber&&(this.showPageNumber.destroy(),this.showPageNumber=void 0),this.rightalignPageNumber&&(this.rightalignPageNumber.destroy(),this.rightalignPageNumber=void 0),this.borderBtn&&(this.borderBtn.destroy(),this.borderBtn=void 0),this.borderLevelStyle&&(this.borderLevelStyle.destroy(),this.borderLevelStyle=void 0),this.hyperlink&&this.hyperlink.destroy(),this.hyperlink=void 0,this.updateBtn&&this.updateBtn.destroy(),this.updateBtn=void 0,this.cancelBtn&&this.cancelBtn.destroy(),this.cancelBtn=void 0,this.localObj=void 0,this.isRtl=void 0,this.element&&(this.element.innerHTML="",this.element=void 0)},Gy.prototype.unWireEvents=function(){this.cancelBtn.element.removeEventListener("click",this.onCloseClickHook),this.updateBtn.element.removeEventListener("click",this.onInsertToClickHook),this.closeButton.removeEventListener("click",this.onCloseClickHook),this.onCloseClickHook=void 0,this.onInsertToClickHook=void 0},Gy.prototype.removeHTMLDOM=function(){this.template1Div.remove(),this.headerDiv.remove(),this.closeButton.remove(),this.title.remove(),this.templateContent1.remove(),this.templateContent2.remove(),this.templateContent3.remove(),this.optionsDiv.remove(),this.label.remove(),this.contentStyleElement.remove(),this.checkboxElement.remove(),this.showPageNumberDiv.remove(),this.showpagenumberCheckboxElement.remove(),this.rightAlignDiv.remove(),this.rightalignpagenumberCheckboxElement.remove(),this.hyperlinkDiv.remove(),this.hyperlinkCheckboxElement.remove(),this.footerElement.remove(),this.updatebuttoncontentStyleElement.remove(),this.cancelbuttoncontentStyleElement.remove()};var jy=Gy;function Gy(e,t){this.onCloseClickHook=this.onCloseClick.bind(this),this.onInsertToClickHook=this.onInsertToc.bind(this),this.container=e,this.elementId=this.documentEditor.element.id,this.isRtl=t,this.initializeTocPane()}Object.defineProperty(Zy.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),Zy.prototype.initializeTextPropertiesDiv=function(e,t){this.localObj=new _.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.textProperties=e;var i=this.documentEditor.element.id+"_font_properties",e=this.createDiv(i+"_text",e),n=(_.classList(e,["e-de-cntr-pane-padding","e-de-prop-separator-line"],[]),this.createDiv(i+"_sizeStyle",e,"display:inline-flex;")),r=(_.classList(n,["e-de-ctnr-segment"],[]),t&&_.classList(n,["e-de-ctnr-segment-rtl"],[]),this.createDiv(i+"_fontFamilyDiv",n)),o=_.createElement("input",{id:i+"_fontFamily",className:"e-prop-font-style"}),r=(r.appendChild(o),_.classList(r,["e-de-panel-left-width"],[]),this.createDropDownListForFamily(o),this.createDiv(i+"_fontSizeDiv",n)),o="e-de-ctnr-group-btn e-de-char-fmt-btn-left e-btn-group",n=(t&&(o="e-rtl "+o),_.createElement("input",{id:i+"_fontSize",innerHTML:"type:number",className:"e-prop-font-style"})),r=(r.appendChild(n),_.classList(r,["e-de-panel-right-width"],[]),this.createDropDownListForSize(n),_.createElement("div",{id:i+"_properties",styles:"display:inline-flex;",className:"e-de-ctnr-segment"})),n=(t&&_.classList(r,["e-de-ctnr-segment-rtl"],[]),e.appendChild(r),_.createElement("div",{id:i+"_leftDiv",className:o,styles:"display:inline-flex;"})),n=(r.appendChild(n),this.bold=this.createButtonTemplate(i+"_bold","e-de-ctnr-bold e-icons",n,"e-de-prop-font-button","40.5","Bold Tooltip"),this.italic=this.createButtonTemplate(i+"_italic","e-de-ctnr-italic e-icons",n,"e-de-prop-font-button","40.5","Italic Tooltip"),this.underline=this.createButtonTemplate(i+"_underline","e-de-ctnr-underline e-icons",n,"e-de-prop-font-button","40.5","Underline Tooltip"),this.strikethrough=this.createButtonTemplate(i+"_strikethrough","e-de-ctnr-strikethrough e-icons",n,"e-de-prop-font-last-button","40.5","Strikethrough"),o="e-de-ctnr-group-btn e-de-char-fmt-btn-right e-btn-group",_.createElement("div",{id:i+"_rightDiv",className:o=t?"e-rtl "+o:o,styles:"display:inline-flex;"})),n=(r.appendChild(n),this.superscript=this.createButtonTemplate(i+"_superscript","e-de-ctnr-superscript e-icons",n,"e-de-prop-font-button","38.5","Superscript Tooltip"),this.subscript=this.createButtonTemplate(i+"_subscript","e-de-ctnr-subscript e-icons",n,"e-de-prop-font-last-button","38.5","Subscript Tooltip"),_.createElement("div",{id:i+"_colorDiv",styles:"display:inline-flex;",className:"e-de-ctnr-segment"})),r=(t&&_.classList(r,["e-de-ctnr-segment-rtl"],[]),_.createElement("div",{id:i+"_color",className:"e-de-font-clr-picker e-de-ctnr-group-btn",styles:"display:inline-flex;"})),n=(t&&_.classList(r,["e-rtl"],[]),n.appendChild(r),e.appendChild(n),this.fontColor=this.createFontColorPicker(i+"_textColor",40.5,r,this.localObj.getConstant("Font color")),_.classList(r.firstElementChild.lastElementChild.lastElementChild.firstChild,["e-de-ctnr-fontcolor","e-icons"],["e-caret"]),this.initializeHighlightColorElement(),this.highlightColor=this.createHighlightColorSplitButton(i+"_highlightColor",34.5,r,this.localObj.getConstant("Text highlight color")),_.classList(this.highlightColor.element.nextElementSibling.firstElementChild,["e-de-ctnr-highlight","e-icons"],["e-caret"]),this.highlightColorInputElement=this.highlightColor.element.firstChild,this.clearFormat=this.createButtonTemplate(i+"_clearFormat","e-de-ctnr-clearall e-icons",r,"e-de-prop-font-last-button","40.5","Clear all formatting"),_.createElement("div",{id:i+"_rightDiv2",className:o.replace("e-btn-group",""),styles:"display:inline-flex;"}));t&&_.classList(n,["e-rtl"],[]),n.setAttribute("title",this.container.localObj.getConstant("Change case Tooltip")),e.appendChild(n),this.createChangecase(n)},Zy.prototype.createHighlightColorSplitButton=function(e,t,i,n){var r=this,e=_.createElement("button",{id:e,attrs:{type:"button"}}),i=(i.appendChild(e),new w.SplitButton({cssClass:"e-de-btn-hghlclr",iconCss:"e-de-ctnr-hglt-color",target:this.highlightColorElement,close:this.closePopup.bind(this),beforeOpen:this.openPopup.bind(this),enableRtl:this.isRtl}));return i.appendTo(e),i.click=function(){r.applyHighlightColor(r.highlightColorInputElement.style.backgroundColor)},i.element.firstChild.style.backgroundColor="rgb(255, 255, 0)",i.element.parentElement.setAttribute("title",n),i.element.parentElement.setAttribute("aria-label",n),i},Zy.prototype.openPopup=function(){this.highlightColorElement.style.display="block"},Zy.prototype.closePopup=function(){this.highlightColorElement.style.display="none"},Zy.prototype.initializeHighlightColorElement=function(){this.highlightColorElement=_.createElement("div",{styles:"display:none;width:157px",className:"e-de-cntr-highlight-pane"});var e=this.createHightlighColorPickerDiv("#ffff00","yellowDiv"),t=this.createHightlighColorPickerDiv("#00ff00","brightGreenDiv"),i=this.createHightlighColorPickerDiv("#00ffff","turquoiseDiv"),n=this.createHightlighColorPickerDiv("#ff00ff","hotPinkDiv"),r=this.createHightlighColorPickerDiv("#0000ff","blueDiv"),o=this.createHightlighColorPickerDiv("#ff0000","redDiv"),s=this.createHightlighColorPickerDiv("#000080","darkBlueDiv"),a=this.createHightlighColorPickerDiv("#008080","tealDiv"),l=this.createHightlighColorPickerDiv("#008000","greenDiv"),d=this.createHightlighColorPickerDiv("#800080","violetDiv"),h=this.createHightlighColorPickerDiv("#800000","darkRedDiv"),c=this.createHightlighColorPickerDiv("#808000","darkYellowDiv"),p=this.createHightlighColorPickerDiv("#808080","gray50Div"),u=this.createHightlighColorPickerDiv("#c0c0c0","gray25Div"),g=this.createHightlighColorPickerDiv("#000000","blackDiv"),m=_.createElement("div",{className:"e-hglt-no-color"}),f=(this.highlightColorElement.appendChild(m),_.createElement("div",{styles:"width:24px;height:24px;background-color:#ffffff;margin:3px;",id:"noColorDiv"})),y=(m.appendChild(f),_.createElement("div",{innerHTML:this.localObj.getConstant("No color"),className:"e-de-ctnr-hglt-no-color"}));f.appendChild(y),e.addEventListener("click",this.onHighLightColor.bind(this)),t.addEventListener("click",this.onHighLightColor.bind(this)),i.addEventListener("click",this.onHighLightColor.bind(this)),n.addEventListener("click",this.onHighLightColor.bind(this)),r.addEventListener("click",this.onHighLightColor.bind(this)),o.addEventListener("click",this.onHighLightColor.bind(this)),s.addEventListener("click",this.onHighLightColor.bind(this)),a.addEventListener("click",this.onHighLightColor.bind(this)),l.addEventListener("click",this.onHighLightColor.bind(this)),d.addEventListener("click",this.onHighLightColor.bind(this)),h.addEventListener("click",this.onHighLightColor.bind(this)),c.addEventListener("click",this.onHighLightColor.bind(this)),p.addEventListener("click",this.onHighLightColor.bind(this)),u.addEventListener("click",this.onHighLightColor.bind(this)),g.addEventListener("click",this.onHighLightColor.bind(this)),m.addEventListener("click",this.onHighLightColor.bind(this))},Zy.prototype.createHightlighColorPickerDiv=function(e,t){t=_.createElement("div",{className:"e-de-ctnr-hglt-btn",id:t});return t.style.backgroundColor=e,this.highlightColorElement.appendChild(t),t},Zy.prototype.onHighLightColor=function(e){this.documentEditor.selectionModule&&(this.applyHighlightColor(e.currentTarget.style.backgroundColor),this.highlightColor.toggle())},Zy.prototype.applyHighlightColorAsBackground=function(e){this.removeSelectedColorDiv(),"NoColor"===e?this.highlightColorElement.querySelector("#noColorDiv").classList.add("e-color-selected"):"Yellow"===e?this.highlightColorElement.querySelector("#yellowDiv").classList.add("e-color-selected"):"BrightGreen"===e?this.highlightColorElement.querySelector("#brightGreenDiv").classList.add("e-color-selected"):"Turquoise"===e?this.highlightColorElement.querySelector("#turquoiseDiv").classList.add("e-color-selected"):"Pink"===e?this.highlightColorElement.querySelector("#hotPinkDiv").classList.add("e-color-selected"):"Red"===e?this.highlightColorElement.querySelector("#redDiv").classList.add("e-color-selected"):"DarkBlue"===e?this.highlightColorElement.querySelector("#darkBlueDiv").classList.add("e-color-selected"):"Teal"===e?this.highlightColorElement.querySelector("#tealDiv").classList.add("e-color-selected"):"Green"===e?this.highlightColorElement.querySelector("#greenDiv").classList.add("e-color-selected"):"Violet"===e?this.highlightColorElement.querySelector("#violetDiv").classList.add("e-color-selected"):"DarkRed"===e?this.highlightColorElement.querySelector("#darkRedDiv").classList.add("e-color-selected"):"DarkYellow"===e?this.highlightColorElement.querySelector("#darkYellowDiv").classList.add("e-color-selected"):"Gray50"===e?this.highlightColorElement.querySelector("#gray50Div").classList.add("e-color-selected"):"Gray25"===e?this.highlightColorElement.querySelector("#gray25Div").classList.add("e-color-selected"):"Black"===e?this.highlightColorElement.querySelector("#blackDiv").classList.add("e-color-selected"):"Blue"===e&&this.highlightColorElement.querySelector("#blueDiv").classList.add("e-color-selected")},Zy.prototype.removeSelectedColorDiv=function(){this.highlightColorElement.querySelector("#noColorDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#yellowDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#brightGreenDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#turquoiseDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#hotPinkDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#redDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#darkBlueDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#tealDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#greenDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#violetDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#darkRedDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#darkYellowDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#gray50Div").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#gray25Div").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#blackDiv").classList.remove("e-color-selected")},Zy.prototype.applyHighlightColor=function(e){this.appliedHighlightColor=e;e=this.getHighLightColor(e);"NoColor"===e&&(this.documentEditor.selectionModule.characterFormat.highlightColor=null),this.documentEditor.selectionModule.characterFormat.highlightColor=e,this.documentEditor.focusIn()},Zy.prototype.getHighLightColor=function(e){switch(e){case"rgb(255, 255, 0)":return"Yellow";case"rgb(0, 255, 0)":return"BrightGreen";case"rgb(0, 255, 255)":return"Turquoise";case"rgb(255, 0, 255)":return"Pink";case"rgb(0, 0, 255)":return"Blue";case"rgb(255, 0, 0)":return"Red";case"rgb(0, 0, 128)":return"DarkBlue";case"rgb(0, 128, 128)":return"Teal";case"rgb(0, 128, 0)":return"Green";case"rgb(128, 0, 128)":return"Violet";case"rgb(128, 0, 0)":return"DarkRed";case"rgb(128, 128, 0)":return"DarkYellow";case"rgb(128, 128, 128)":return"Gray50";case"rgb(192, 192, 192)":return"Gray25";case"rgb(0, 0, 0)":return"Black";default:return"NoColor"}},Zy.prototype.createDiv=function(e,t,i){i=i?_.createElement("div",{id:e,styles:i}):_.createElement("div",{id:e});return t.appendChild(i),i},Zy.prototype.createButtonTemplate=function(e,t,i,n,r,o){var e=_.createElement("Button",{id:e,attrs:{type:"button"}}),s=(i.appendChild(e),new H.Button({cssClass:n,iconCss:t,enableRtl:this.isRtl}));switch(s.appendTo(e),e.setAttribute("title",this.localObj.getConstant(o)),e.setAttribute("aria-label",this.localObj.getConstant(o)),e.setAttribute("aria-pressed","false"),o){case"Bold Tooltip":this.boldBtn=s;break;case"Italic Tooltip":this.italicBtn=s;break;case"Underline Tooltip":this.underlineBtn=s;break;case"Strikethrough":this.strikethroughBtn=s;break;case"Superscript Tooltip":this.superscriptBtn=s;break;case"Subscript Tooltip":this.subscriptBtn=s;break;default:this.clearFormatBtn=s}return e},Zy.prototype.createFontColorPicker=function(e,t,i,n){var r=this.documentEditor.documentEditorSettings.colorPickerSettings,o=r.columns,s=r.createPopupOnClick,a=r.cssClass,l=r.disabled,d=r.enablePersistence,h=r.inline,c=r.mode,p=r.modeSwitcher,u=r.noColor,g=r.presetColors,r=r.showButtons,e=_.createElement("input",{id:e,attrs:{type:"color"}});return e.style.width=t+"px",i.appendChild(e),this.fontColorInputElement=new D.ColorPicker({value:"#000000",enableRtl:this.isRtl,locale:this.container.locale,enableOpacity:!1,mode:c,modeSwitcher:p,showButtons:r,columns:o,createPopupOnClick:s,cssClass:a,disabled:l,enablePersistence:d,inline:h,noColor:u,presetColors:g},e),this.fontColorInputElement.element.parentElement.setAttribute("title",n),this.fontColorInputElement.element.parentElement.setAttribute("aria-label",n),this.documentEditor.documentHelper.fontColorInputElement=this.fontColorInputElement,e},Zy.prototype.createDropDownListForSize=function(e){var t=this;this.fontSize=new U.ComboBox({dataSource:["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72","96"],popupHeight:"180px",popupWidth:"80px",cssClass:"e-de-prop-dropdown",allowCustom:!0,showClearButton:!1,enableRtl:this.isRtl}),this.fontSize.focus=function(){t.isRetrieving=!1,t.fontSize.element.select()},this.fontSize.value=this.documentEditor.selectionModule.characterFormat.fontSize.toString(),this.fontSize.appendTo(e),this.fontSize.element.parentElement.setAttribute("title",this.localObj.getConstant("Font Size"))},Zy.prototype.createDropDownListForFamily=function(e){for(var t=this,i=!1,n="",r=(this.container.enableCsp||(n=_.initializeCSPTemplate(function(e){return'<span style="font-family: '+e.FontName+';">'+e.FontName+"</span>"}),i=!0),this.fontFamily=new U.ComboBox({dataSource:void 0,query:(new b.Query).select(["FontName"]),fields:{text:"FontName",value:"FontValue"},popupHeight:"150px",cssClass:"e-de-prop-dropdown",allowCustom:!0,showClearButton:!1,enableRtl:this.isRtl,itemTemplate:n}),this.fontFamily.appendTo(e),this.fontFamily.isStringTemplate=i,this.container.documentEditorSettings.fontFamilies),o=0;o<r.length;o++){var s=r[o];this.fontFamily.addItem({FontName:s,FontValue:s},o)}this.fontFamily.focus=function(){t.isRetrieving=!1,t.fontFamily.element.select()},this.fontFamily.element.parentElement.setAttribute("title",this.localObj.getConstant("Font"))},Zy.prototype.wireEvent=function(){var t=this;this.fontFamily.addEventListener("change",function(){t.changeFontFamily()}),this.fontSize.addEventListener("change",function(){t.changeFontSize()}),this.bold.addEventListener("click",function(){t.isRetrieving=!1,t.boldAction()}),this.italic.addEventListener("click",function(){t.isRetrieving=!1,t.italicAction()}),this.underline.addEventListener("click",function(){t.isRetrieving=!1,t.underlineAction()}),this.strikethrough.addEventListener("click",function(){t.isRetrieving=!1,t.strikethroughAction()}),this.superscript.addEventListener("click",function(){t.isRetrieving=!1,t.superscriptAction()}),this.subscript.addEventListener("click",function(){t.isRetrieving=!1,t.subscriptAction()}),this.fontColorInputElement.addEventListener("change",function(e){t.isRetrieving=!1,t.changeFontColor(e)}),this.clearFormat.addEventListener("click",function(){t.isRetrieving=!1,t.clearFormatAction()}),this.changeCaseDropdown.addEventListener("select",function(e){t.isRetrieving=!1,t.changeCase(e)})},Zy.prototype.unwireEvents=function(){this.fontFamily.change=void 0,this.fontSize.change=void 0,this.bold.click=void 0,this.italic.click=void 0,this.underline.click=void 0,this.strikethrough.click=void 0,this.superscript.click=void 0,this.subscript.click=void 0,this.fontColorInputElement.change=void 0,this.highlightColorElement.click=void 0,this.highlightColor.click=void 0,this.clearFormat.click=void 0,this.changeCaseDropdown.select=void 0},Zy.prototype.boldAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleBold(),this.documentEditor.focusIn())},Zy.prototype.italicAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleItalic(),this.documentEditor.focusIn())},Zy.prototype.underlineAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleUnderline("Single"),this.documentEditor.focusIn())},Zy.prototype.strikethroughAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleStrikethrough(),this.documentEditor.focusIn())},Zy.prototype.clearFormatAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&this.documentEditor.editorModule.clearFormatting()},Zy.prototype.subscriptAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleSubscript(),this.documentEditor.focusIn())},Zy.prototype.superscriptAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleSuperscript(),this.documentEditor.focusIn())},Zy.prototype.changeFontColor=function(e){var t=this;this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.selectionModule&&(this.documentEditor.selectionModule.characterFormat.fontColor=e.currentValue.hex,setTimeout(function(){t.documentEditor.focusIn()},30))},Zy.prototype.changeFontFamily=function(){var e=this;this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.selectionModule&&""!==this.fontFamily.value&&(setTimeout(function(){e.documentEditor.selectionModule.characterFormat.fontFamily=_.SanitizeHtmlHelper.sanitize(e.fontFamily.value)},10),this.documentEditor.focusIn())},Zy.prototype.changeFontSize=function(){var e=this;this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.selectionModule&&""!==this.fontSize.value&&(setTimeout(function(){e.documentEditor.selectionModule.characterFormat.fontSize=e.fontSize.value},10),this.documentEditor.focusIn())},Zy.prototype.onSelectionChange=function(){var e;this.isRetrieving=!0,this.documentEditor.selectionModule&&(this.documentEditor.selectionModule.characterFormat.fontFamily?(e=void 0,e=_.isNullOrUndefined(this.documentEditor.selectionModule.characterFormat.renderedFontFamily)||_.isNullOrUndefined(this.documentEditor.selectionModule.characterFormat.fontFamily)?this.documentEditor.selectionModule.characterFormat.fontFamily:this.documentEditor.selectionModule.characterFormat.renderedFontFamily,this.fontFamily.value=e,this.fontFamily.dataBind(),_.isNullOrUndefined(this.fontFamily.getDataByValue(e))&&this.fontFamily.addItem({FontName:e,FontValue:e})):this.fontFamily.value="",this.documentEditor.selectionModule.characterFormat.fontSize?(this.fontSize.value=this.documentEditor.selectionModule.characterFormat.fontSize.toString(),this.fontSize.dataBind()):this.fontSize.value="",this.documentEditor.selectionModule.characterFormat.bold?this.bold.classList.contains("e-btn-toggle")||(this.bold.classList.add("e-btn-toggle"),this.bold.setAttribute("aria-pressed","true")):this.bold.classList.contains("e-btn-toggle")&&(this.bold.classList.remove("e-btn-toggle"),this.bold.setAttribute("aria-pressed","false")),this.documentEditor.selectionModule.characterFormat.italic?this.italic.classList.contains("e-btn-toggle")||(this.italic.classList.add("e-btn-toggle"),this.italic.setAttribute("aria-pressed","true")):this.italic.classList.contains("e-btn-toggle")&&(this.italic.classList.remove("e-btn-toggle"),this.italic.setAttribute("aria-pressed","false")),this.documentEditor.selectionModule.characterFormat.underline&&"None"!==this.documentEditor.selectionModule.characterFormat.underline?this.underline.classList.contains("e-btn-toggle")||(this.underline.classList.add("e-btn-toggle"),this.underline.setAttribute("aria-pressed","true")):this.underline.classList.contains("e-btn-toggle")&&(this.underline.classList.remove("e-btn-toggle"),this.underline.setAttribute("aria-pressed","false")),this.documentEditor.selectionModule.characterFormat.strikethrough&&"None"!==this.documentEditor.selectionModule.characterFormat.strikethrough?this.strikethrough.classList.contains("e-btn-toggle")||(this.strikethrough.classList.add("e-btn-toggle"),this.strikethrough.setAttribute("aria-pressed","true")):this.strikethrough.classList.contains("e-btn-toggle")&&(this.strikethrough.classList.remove("e-btn-toggle"),this.strikethrough.setAttribute("aria-pressed","false")),this.documentEditor.selectionModule.characterFormat.baselineAlignment&&"Subscript"===this.documentEditor.selectionModule.characterFormat.baselineAlignment?this.subscript.classList.contains("e-btn-toggle")||(this.subscript.classList.add("e-btn-toggle"),this.subscript.setAttribute("aria-pressed","true")):this.subscript.classList.contains("e-btn-toggle")&&(this.subscript.classList.remove("e-btn-toggle"),this.subscript.setAttribute("aria-pressed","false")),this.documentEditor.selectionModule.characterFormat.baselineAlignment&&"Superscript"===this.documentEditor.selectionModule.characterFormat.baselineAlignment?this.superscript.classList.contains("e-btn-toggle")||(this.superscript.classList.add("e-btn-toggle"),this.superscript.setAttribute("aria-pressed","true")):this.superscript.classList.contains("e-btn-toggle")&&(this.superscript.classList.remove("e-btn-toggle"),this.superscript.setAttribute("aria-pressed","false")),this.documentEditor.selectionModule.characterFormat.fontColor&&(e=this.documentEditor.selectionModule.characterFormat.fontColor,this.fontColorInputElement.value=e="empty"!==e&&"#00000000"!==e?e:"#000000"),this.documentEditor.selectionModule.characterFormat.highlightColor)&&(this.highlightColorInputElement.style.backgroundColor=this.appliedHighlightColor,this.applyHighlightColorAsBackground(this.documentEditor.selectionModule.characterFormat.highlightColor))},Zy.prototype.destroy=function(){this.highlightColor&&(this.highlightColor.destroy(),this.highlightColor=void 0),this.fontColorInputElement&&(this.fontColorInputElement.destroy(),this.fontColorInputElement=void 0),this.fontSize&&(this.fontSize.destroy(),this.fontSize=void 0),this.fontFamily&&(this.fontFamily.destroy(),this.fontFamily=void 0),this.changeCaseDropdown&&(this.changeCaseDropdown.destroy(),this.changeCaseDropdown=void 0),this.boldBtn&&(this.boldBtn.destroy(),this.boldBtn=void 0),this.italicBtn&&(this.italicBtn.destroy(),this.italicBtn=void 0),this.underlineBtn&&(this.underlineBtn.destroy(),this.underlineBtn=void 0),this.strikethroughBtn&&(this.strikethroughBtn.destroy(),this.strikethroughBtn=void 0),this.subscriptBtn&&(this.subscriptBtn.destroy(),this.subscriptBtn=void 0),this.superscriptBtn&&(this.superscriptBtn.destroy(),this.superscriptBtn=void 0),this.clearFormatBtn&&(this.clearFormatBtn.destroy(),this.clearFormatBtn=void 0),this.container=void 0};var Ky=Zy;function Zy(e,t){var n=this;this.isRetrieving=!1,this.appliedHighlightColor="rgb(255, 255, 0)",this.createChangecase=function(e){var t=[{text:n.localObj.getConstant("SentenceCase"),id:"sentencecase"},{text:n.localObj.getConstant("UPPERCASE"),id:"uppercase"},{text:n.localObj.getConstant("Lowercase"),id:"lowercase"},{text:n.localObj.getConstant("CapitalizeEachWord"),id:"capitalizeEachWord"},{text:n.localObj.getConstant("ToggleCase"),id:"togglecase"}],t=(n.changeCaseDropdown=new w.DropDownButton({items:t,iconCss:"e-icons e-de-ctnr-change-case",enableRtl:n.isRtl}),_.createElement("div",{id:e.id+"_changeCase",className:"e-de-ctnr-group-btn"})),i=_.createElement("button",{id:t.id+"_dropdownBtn",attrs:{type:"button"}});t.appendChild(i),e.appendChild(t),n.changeCaseDropdown.appendTo(i)},this.changeCase=function(e){if(!n.isRetrieving)switch(e.item.id){case"sentencecase":!n.documentEditor.isReadOnly&&n.documentEditor.editorModule&&n.documentEditor.editorModule.changeCase("SentenceCase");break;case"uppercase":!n.documentEditor.isReadOnly&&n.documentEditor.editorModule&&n.documentEditor.editorModule.changeCase("Uppercase");break;case"lowercase":!n.documentEditor.isReadOnly&&n.documentEditor.editorModule&&n.documentEditor.editorModule.changeCase("Lowercase");break;case"capitalizeEachWord":!n.documentEditor.isReadOnly&&n.documentEditor.editorModule&&n.documentEditor.editorModule.changeCase("CapitalizeEachWord");break;case"togglecase":!n.documentEditor.isReadOnly&&n.documentEditor.editorModule&&n.documentEditor.editorModule.changeCase("ToggleCase")}},this.container=e,this.isRtl=t}Object.defineProperty(Jy.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),Jy.prototype.initializeParagraphPropertiesDiv=function(e,t){this.localObj=new _.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.isRtl=t,this.isRtl&&(this.splitButtonClass="e-rtl "+this.splitButtonClass),this.textProperties=e;var i=this.documentEditor.element.id+"_font_properties",e=this.createDivElement(i+"_paragraph",e,""),n=(_.classList(e,["e-de-cntr-pane-padding"],[]),_.createElement("label",{className:"e-de-ctnr-prop-label"})),n=(n.innerHTML=this.localObj.getConstant("Paragraph"),e.appendChild(n),this.createDivElement(i+"_styleDiv",e)),r=(n.classList.add("e-de-ctnr-segment","e-de-ctnr-style-div"),_.createElement("input",{id:i+"_style",styles:"width:248px;letter-spacing: 0.05px;"})),n=(n.appendChild(r),this.createStyleDropDownList(r),this.createDivElement(i+"_indentWholeDiv",e)),r=(n.style.display="flex",n.classList.add("e-de-ctnr-segment"),t&&_.classList(n,["e-de-ctnr-segment-rtl"],[]),this.createDivElement(i+"_indentDiv",n,"display:flex;")),o="e-de-ctnr-group-btn e-de-char-fmt-btn-left e-btn-group",r=(r.className=o=t?"e-rtl "+o:o,this.leftAlignment=this.createButtonTemplate(i+"_leftIndent","e-de-ctnr-alignleft e-icons",r,"e-de-prop-indent-button","40.5","Align left Tooltip"),this.centerAlignment=this.createButtonTemplate(i+"_centerIndent","e-de-ctnr-aligncenter e-icons",r,"e-de-prop-indent-button","40.5","Center Tooltip"),this.rightAlignment=this.createButtonTemplate(i+"_rightIndent","e-de-ctnr-alignright e-icons",r,"e-de-prop-indent-button","40.5","Align right Tooltip"),this.justify=this.createButtonTemplate(i+"_justify","e-de-ctnr-justify e-icons",r,"e-de-prop-indent-last-button","40.5","Justify Tooltip"),"e-de-ctnr-increaseindent e-icons"),s="e-de-ctnr-decreaseindent e-icons",n=this.createDivElement(i+"_lineindentDiv",n,"display:flex;"),o="e-de-ctnr-group-btn e-de-char-fmt-btn-right e-btn-group",o=(t&&(o="e-rtl "+o,r+=" e-de-flip",s+=" e-de-flip"),n.className=o,this.decreaseIndent=this.createButtonTemplate(i+"_decreaseIndent",s,n,"e-de-prop-indent-button","37","Decrease indent"),this.increaseIndent=this.createButtonTemplate(i+"_increaseIndent",r,n,"e-de-prop-indent-last-button","37","Increase indent"),this.createDivElement(i+"_listDiv",e,"display:flex;")),s=this.createDivElement(i+"_paraDiv",e,"display:flex"),r=(_.classList(o,["e-de-ctnr-segment","e-de-ctnr-group-btn"],[]),_.classList(s,["e-de-ctnr-segment","e-de-ctnr-group-btn"],[]),t&&(_.classList(o,["e-de-ctnr-segment-rtl","e-de-ctnr-group-btn"],[]),_.classList(s,["e-de-ctnr-segment-rtl","e-de-ctnr-group-btn"],[])),_.createElement("button",{id:i+"_lineHeight",attrs:{type:"button"}})),n=(o.appendChild(r),this.lineSpacing=this.createLineSpacingDropdown(r),this.createDivElement(i+"_listDropDiv",o)),e=(_.classList(n,["de-split-button","e-de-ctnr-segment-list"],[]),t&&_.classList(n,["e-de-ctnr-segment-list-rtl"],[]),_.createElement("button",{id:i+"_bullet",attrs:{type:"button"}})),r=(n.appendChild(e),_.createElement("button",{id:i+"_numberingList",attrs:{type:"button"}})),o=(n.appendChild(r),"e-de-ctnr-bullets e-icons"),n="e-de-ctnr-numbering e-icons";t&&(o+=" e-de-flip",n+=" e-de-flip"),this.createBulletListDropButton(o,e),this.createNumberListDropButton(n,r),this.borders=this.createButtonTemplate(i+"_borders","e-de-ctnr-borders e-icons",s,"e-de-ctnr-group-btn","37","Borders"),this.showHiddenMarks=this.createButtonTemplate(i+"_paraMark","e-de-e-paragraph-mark e-icons",s,"e-de-ctnr-group-btn","37","ShowHiddenMarks Tooltip")},Jy.prototype.createSeparator=function(e){var t=_.createElement("div",{className:"e-de-prop-vline"});e.appendChild(t)},Jy.prototype.createDivElement=function(e,t,i){i=i?_.createElement("div",{id:e,styles:i}):_.createElement("div",{id:e});return t.appendChild(i),i},Jy.prototype.createButtonTemplate=function(e,t,i,n,r,o){var e=_.createElement("Button",{id:e,attrs:{type:"button"}}),s=(i.appendChild(e),new H.Button({cssClass:n,iconCss:t}));switch(s.appendTo(e),e.setAttribute("title",this.localObj.getConstant(o)),e.setAttribute("aria-label",this.localObj.getConstant(o)),"Decrease indent"!==this.localObj.getConstant(o)&&"Increase indent"!==this.localObj.getConstant(o)&&"Borders"!==this.localObj.getConstant(o)&&e.setAttribute("aria-pressed","false"),o){case"Align left Tooltip":this.leftAlignmentBtn=s;break;case"Align right Tooltip":this.rightAlignmentBtn=s;break;case"Justify Tooltip":this.justifyBtn=s;break;case"Decrease indent":this.decreaseIndentBtn=s;break;case"Increase indent":this.increaseIndentBtn=s;break;case"Borders":this.bordersBtn=s;break;case"ShowHiddenMarks Tooltip":this.showHiddenMarksBtn=s;break;default:this.centerAlignmentBtn=s}return e},Jy.prototype.createLineSpacingDropdown=function(e){var i=this,t=[{text:this.localObj.getConstant("Single")},{text:"1.15"},{text:"1.5"},{text:this.localObj.getConstant("Double")}],t=new w.DropDownButton({items:t,iconCss:"e-de-ctnr-linespacing e-icons",enableRtl:this.isRtl,select:this.lineSpacingAction.bind(this),cssClass:this.splitButtonClass,beforeItemRender:function(e){e.element.innerHTML="<span></span>"+e.item.text;var t=e.element.children[0];e.item.text===i.appliedLineSpacing?(t.style.marginRight="10px",t.setAttribute("class","e-de-selected-item e-icons e-de-linespacing")):(e.element.children[0].style.marginRight="25px",e.element.children[0].classList.remove("e-de-selected-item"))}});return t.appendTo(e),e.setAttribute("title",this.localObj.getConstant("Line spacing")),t},Jy.prototype.createNumberListDropButton=function(e,t){var n=this,r=_.createElement("div",{id:"target",styles:"width: 211px;height: auto;display:none"}),i=_.createElement("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-floating-menu e-de-bullets-menu e-de-list-container e-de-list-thumbnail"}),i=(r.appendChild(i),this.noneNumberTag=this.createNumberNoneListTag(i),this.noneNumberTag.addEventListener("click",this.numberedNoneClick.bind(this)),this.numberList=this.createNumberListTag(i,"1.","2.","3."),this.numberList.addEventListener("click",this.numberedNumberDotClick.bind(this)),this.lowLetter=this.createNumberListTag(i,"a.","b.","c."),this.lowLetter.addEventListener("click",this.numberedLowLetterClick.bind(this)),this.upLetter=this.createNumberListTag(i,"A.","B.","C."),this.upLetter.addEventListener("click",this.numberedUpLetterClick.bind(this)),this.lowRoman=this.createNumberListTag(i,"i.","ii.","iii."),this.lowRoman.addEventListener("click",this.numberedLowRomanClick.bind(this)),this.upRoman=this.createNumberListTag(i,"I.","II.","III."),this.upRoman.addEventListener("click",this.numberedUpRomanClick.bind(this)),{target:r,iconCss:e,cssClass:this.splitButtonClass,beforeOpen:function(){r.style.display="block";var e,t,i="None";_.isNullOrUndefined(n.documentEditor.selectionModule.paragraphFormat)||(i=_.isNullOrUndefined(n.documentEditor.selectionModule.paragraphFormat.listId)||-1===n.documentEditor.selectionModule.paragraphFormat.listId?"None":(e=n.documentEditor.documentHelper.getListById(n.documentEditor.selectionModule.paragraphFormat.listId),e=n.documentEditor.documentHelper.getAbstractListById(e.abstractListId),t=(n.documentEditor.selectionModule.isForward?n.documentEditor.selectionModule.start:n.documentEditor.selectionModule.end).paragraph,e.levels[t.paragraphFormat.listFormat.listLevelNumber].listLevelPattern)),n.updateSelectedNumberedListType(i)},beforeClose:function(){r.style.display="none",n.removeSelectedList()}});this.numberedListBtn=new w.SplitButton(i),this.numberedListBtn.click=function(){n.applyLastAppliedNumbering()},this.numberedListBtn.appendTo(t),t.parentElement.setAttribute("title",this.localObj.getConstant("Numbering")),t.parentElement.setAttribute("aria-label",this.localObj.getConstant("Numbering"))},Jy.prototype.updateSelectedBulletListType=function(e){switch(e){case String.fromCharCode(61623):this.dotBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61551)+String.fromCharCode(32):this.circleBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61607):this.squareBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61558):this.flowerBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61656):this.arrowBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61692):this.tickBullet.classList.add("de-list-item-selected");break;default:this.noneBulletTag.classList.add("de-list-item-selected")}},Jy.prototype.updateSelectedNumberedListType=function(e){switch(e){case"Arabic":this.numberList.classList.add("de-list-item-selected");break;case"UpRoman":this.upRoman.classList.add("de-list-item-selected");break;case"UpLetter":this.upLetter.classList.add("de-list-item-selected");break;case"LowLetter":this.lowLetter.classList.add("de-list-item-selected");break;case"LowRoman":this.lowRoman.classList.add("de-list-item-selected");break;default:this.noneNumberTag.classList.add("de-list-item-selected")}},Jy.prototype.removeSelectedList=function(){var e="de-list-item-selected";this.noneNumberTag.classList.remove(e),this.numberList.classList.remove(e),this.lowLetter.classList.remove(e),this.upLetter.classList.remove(e),this.lowRoman.classList.remove(e),this.upRoman.classList.remove(e),this.noneBulletTag.classList.remove(e),this.dotBullet.classList.remove(e),this.circleBullet.classList.remove(e),this.squareBullet.classList.remove(e),this.flowerBullet.classList.remove(e),this.arrowBullet.classList.remove(e),this.tickBullet.classList.remove(e)},Jy.prototype.applyLastAppliedNumbering=function(){switch(this.appliedNumberingStyle){case"arabic":this.numberedNumberDotClick();break;case"lowletter":this.numberedLowLetterClick();break;case"upletter":this.numberedUpLetterClick();break;case"lowroman":this.numberedLowRomanClick();break;case"uproman":this.numberedUpRomanClick()}},Jy.prototype.applyLastAppliedBullet=function(){switch(this.appliedBulletStyle){case"dot":this.bulletDotClick();break;case"circle":this.bulletCircleClick();break;case"square":this.bulletSquareClick();break;case"arrow":this.bulletArrowClick();break;case"tick":this.bulletTickClick();break;case"flower":this.bulletFlowerClick()}},Jy.prototype.createBulletListDropButton=function(e,t){var i=this,n=_.createElement("div",{id:"bullet_list",styles:"width: 196px;height: auto;display:none"}),r=_.createElement("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-floating-menu e-de-bullets-menu e-de-list-container e-de-list-thumbnail"}),r=(n.appendChild(r),this.noneBulletTag=this.createBulletListTag(r,"e-de-ctnr-bullet-none e-icons e-de-ctnr-list",!0),this.noneBulletTag.addEventListener("click",this.numberedNoneClick.bind(this)),this.dotBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-dot e-icons e-de-ctnr-list",!1),this.dotBullet.addEventListener("click",this.bulletDotClick.bind(this)),this.circleBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-circle e-icons e-de-ctnr-list",!1),this.circleBullet.addEventListener("click",this.bulletCircleClick.bind(this)),this.squareBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-square e-icons e-de-ctnr-list",!1),this.squareBullet.addEventListener("click",this.bulletSquareClick.bind(this)),this.flowerBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-flower e-icons e-de-ctnr-list",!1),this.flowerBullet.addEventListener("click",this.bulletFlowerClick.bind(this)),this.arrowBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-arrow e-icons e-de-ctnr-list",!1),this.arrowBullet.addEventListener("click",this.bulletArrowClick.bind(this)),this.tickBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-tick e-icons e-de-ctnr-list",!1),this.tickBullet.addEventListener("click",this.bulletTickClick.bind(this)),{target:n,iconCss:e,cssClass:this.splitButtonClass,beforeOpen:function(){var e;n.style.display="block",_.isNullOrUndefined(i.documentEditor.selectionModule.paragraphFormat.listId)||-1===i.documentEditor.selectionModule.paragraphFormat.listId?i.updateSelectedBulletListType(i.documentEditor.selectionModule.paragraphFormat.listText):(e=(i.documentEditor.selectionModule.isForward?i.documentEditor.selectionModule.start:i.documentEditor.selectionModule.end).paragraph,i.updateSelectedBulletListType(e.paragraphFormat.listFormat.listLevel.numberFormat))},beforeClose:function(){n.style.display="none",i.removeSelectedList()}});this.bulletListBtn=new w.SplitButton(r),this.bulletListBtn.click=function(){i.applyLastAppliedBullet()},this.bulletListBtn.appendTo(t),t.parentElement.setAttribute("title",this.localObj.getConstant("Bullets")),t.parentElement.setAttribute("aria-label",this.localObj.getConstant("Bullets"))},Jy.prototype.createNumberListTag=function(e,t,i,n){var r=_.createElement("li",{styles:"display:block",className:"e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size"}),e=(e.appendChild(r),"<div>"+t+'<span class="e-de-list-line"></span></div><div>'+i+'<span class="e-de-list-line">'),t=_.createElement("div",{className:"e-de-list-header-presetmenu",innerHTML:e+="</span></div><div>"+n+'<span class="e-de-list-line"> </span></div >'});return r.appendChild(t),r},Jy.prototype.createNumberNoneListTag=function(e){var t=_.createElement("li",{styles:"display:block;",className:"e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size"}),e=(e.appendChild(t),'<div><span class="e-de-bullets">'+this.localObj.getConstant("None")+"</span></div>"),e=_.createElement("div",{className:"e-de-list-header-presetmenu",styles:"position:relative;left:11px;top:13px",innerHTML:e});return t.appendChild(e),t},Jy.prototype.createBulletListTag=function(e,t,i){var n=_.createElement("li",{styles:"display:block;",className:"e-de-floating-menuitem e-de-floating-bullet-menuitem-md e-de-list-items  e-de-list-item-size"}),e=(e.appendChild(n),_.createElement("div",{className:"e-de-bullet-list-header-presetmenu"})),r=_.createElement("div",{styles:i?"font-size:8px;text-align: center;top: 8px;line-height:normal":""}),t=(e.appendChild(r),_.createElement("span",{className:i?"":t}));return r.appendChild(t),i&&(e.style.display="inline-table",t.textContent=this.localObj.getConstant("None")),n.appendChild(e),n},Jy.prototype.createStyleDropDownList=function(e){var t=this,i=(this.style=new U.ComboBox({dataSource:[{StyleName:"Normal",IconClass:"e-de-e-paragraph-mark e-icons"}],cssClass:"e-de-prop-dropdown",popupHeight:"240px",enableRtl:this.isRtl,allowFiltering:!0,query:(new b.Query).select(["StyleName","Style","IconClass"]),fields:{text:"StyleName",value:"StyleName"},showClearButton:!1,change:this.selectStyleValue.bind(this)}),"");this.style.open=this.updateOptions.bind(this),this.container.enableCsp||(i=this.isRtl?_.initializeCSPTemplate(function(e){return'<span style="'+e.Style+'">'+e.StyleName+'</span><span class="'+e.IconClass+'"></span>'}):_.initializeCSPTemplate(function(e){return'<span class="'+e.IconClass+'"></span><span style="'+e.Style+'">'+e.StyleName+"</span>"}),this.style.itemTemplate=i,this.style.isStringTemplate=!0),this.style.footerTemplate=_.initializeCSPTemplate(function(e){return'<span class="e-de-ctnr-dropdown-ftr">\n                '+t.localObj.getConstant("Manage Styles")+"...</span>"}),this.style.appendTo(e),this.style.focus=function(){t.isRetrieving=!1,t.style.element.select()},e.parentElement.setAttribute("title",this.localObj.getConstant("Styles"))},Jy.prototype.updateOptions=function(e){e.popup.element.getElementsByClassName("e-de-ctnr-dropdown-ftr")[0].addEventListener("click",this.createStyle.bind(this))},Jy.prototype.updateStyleNames=function(){this.styleName=_.isNullOrUndefined(this.style.itemData)?void 0:this.style.itemData.StyleName;for(var e=this.documentEditor.documentHelper.stylesMap,t=e.get("Paragraph")?e.get("Paragraph"):[],i=e.get("Linked")?e.get("Linked"):[],n=e.get("Character")?e.get("Character"):[],r=0,o=i;r<o.length;r++)for(var s=o[r],a=0;a<n.length;a++){var l=n[a];if(s.StyleName+" Char"===l.StyleName){n.splice(a,1);break}}this.style.dataSource=t.concat(i,n),this.onSelectionChange()},Jy.prototype.createStyle=function(){this.style.hidePopup(),this.documentEditor.isReadOnly||this.documentEditor.showDialog("Styles")},Jy.prototype.constructStyleDropItems=function(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i],o={},s=this.localObj.getConstant(r.name);o.StyleName=""===s?r.name:s,o.Style=this.parseStyle(r.style),"Paragraph"==r.type?o.IconClass="e-list-icon e-de-listview-icon e-de-e-paragraph-style-mark e-icons":"Character"==r.type?o.IconClass="e-list-icon e-de-listview-icon e-de-e-character-style-mark e-icons":o.IconClass="e-list-icon e-de-listview-icon e-de-e-linked-style-mark e-icons",t.push(o)}return t},Jy.prototype.parseStyle=function(e){var t="",e=JSON.parse(e),i="";if(!_.isNullOrUndefined(e.characterFormat.baselineAlignment)&&"Normal"!==e.characterFormat.baselineAlignment){var n="";switch(e.characterFormat.baselineAlignment){case"Superscript":n="super";break;case"Subscript":n="sub"}1<n.length&&(t+="vertical-align:"+n+";")}return _.isNullOrUndefined(e.characterFormat.underline)||"None"===e.characterFormat.underline||(i+="underline "),_.isNullOrUndefined(e.characterFormat.strikethrough)||"None"===e.characterFormat.strikethrough||(i+="line-through "),_.isNullOrUndefined(e.characterFormat.fontSize)||(t+="font-size:"+e.characterFormat.fontSize+"px;"),_.isNullOrUndefined(e.characterFormat.fontFamily)||(t+="font-family:"+e.characterFormat.fontFamily+";"),!_.isNullOrUndefined(e.characterFormat.bold)&&e.characterFormat.bold&&(t+="font-weight:bold;"),!_.isNullOrUndefined(e.characterFormat.italic)&&e.characterFormat.italic&&(t+="font-style:italic;"),1<i.length&&(t+="text-decoration:"+i+";"),t},Jy.prototype.wireEvent=function(){var t=this;this.leftAlignment.addEventListener("click",function(){t.leftAlignmentAction()}),this.rightAlignment.addEventListener("click",function(){t.rightAlignmentAction()}),this.centerAlignment.addEventListener("click",function(){t.centerAlignmentAction()}),this.justify.addEventListener("click",function(){t.justifyAction()}),this.increaseIndent.addEventListener("click",function(){t.increaseIndentAction()}),this.showHiddenMarks.addEventListener("click",function(){t.container.documentEditorSettings.showHiddenMarks=!t.container.documentEditorSettings.showHiddenMarks,t.toggleHiddenMarks(),setTimeout(function(){t.documentEditor.focusIn()},30)}),this.decreaseIndent.addEventListener("click",function(){t.decreaseIndentAction()}),this.lineSpacing.addEventListener("select",function(e){t.lineSpacingAction(e)}),this.borders.addEventListener("click",function(){t.documentEditor.showBordersAndShadingDialog()})},Jy.prototype.unwireEvents=function(){this.leftAlignment.click=void 0,this.rightAlignment.click=void 0,this.centerAlignment.click=void 0,this.justify.click=void 0,this.increaseIndent.click=void 0,this.decreaseIndent.click=void 0,this.lineSpacing.select=void 0,this.style.select=void 0},Jy.prototype.toggleHiddenMarks=function(){this.container.documentEditorSettings.showHiddenMarks?(_.classList(this.showHiddenMarks,["e-btn-toggle"],[]),this.showHiddenMarks.setAttribute("aria-pressed","true")):(_.classList(this.showHiddenMarks,[],["e-btn-toggle"]),this.showHiddenMarks.setAttribute("aria-pressed","false"))},Jy.prototype.leftAlignmentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleTextAlignment("Left"),this.documentEditor.focusIn())},Jy.prototype.lineSpacingAction=function(e){var t=this;if(!this.isRetrieving){switch(e.item.text){case this.localObj.getConstant("Single"):this.documentEditor.selectionModule.paragraphFormat.lineSpacing=1;break;case"1.15":this.documentEditor.selectionModule.paragraphFormat.lineSpacing=1.15;break;case"1.5":this.documentEditor.selectionModule.paragraphFormat.lineSpacing=1.5;break;case this.localObj.getConstant("Double"):this.documentEditor.selectionModule.paragraphFormat.lineSpacing=2}setTimeout(function(){t.documentEditor.focusIn()},30)}},Jy.prototype.setLineSpacing=function(){var e=this.documentEditor.selectionModule.paragraphFormat.lineSpacing;this.appliedLineSpacing=1===e?this.localObj.getConstant("Single"):1.15===e?"1.15":1.5===e?"1.5":2===e?this.localObj.getConstant("Double"):""},Jy.prototype.selectStyleValue=function(e){var t=this,i=document.getElementById(this.documentEditor.containerId+"_treeDiv");_.isNullOrUndefined(i)||_.isNullOrUndefined(this.documentEditor.optionsPaneModule)||!this.documentEditor.optionsPaneModule.isOptionsPaneShow||(i.innerHTML="",this.documentEditor.optionsPaneModule.data=this.documentEditor.optionsPaneModule.dataForTreeview(),this.documentEditor.optionsPaneModule.initHeadingTab()),!this.isRetrieving&&e.isInteracted&&setTimeout(function(){t.applyStyleValue(e)},10)},Jy.prototype.applyStyleValue=function(e){!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(e=this.documentEditor.stylesDialogModule.getStyleName(_.SanitizeHtmlHelper.sanitize(e.itemData.StyleName)),_.isNullOrUndefined(this.documentEditor.documentHelper.styles.findByName(e))||(this.documentEditor.editorModule.applyStyle(e,!0),e=document.getElementById(this.documentEditor.containerId+"_treeDiv"),_.isNullOrUndefined(e))||_.isNullOrUndefined(this.documentEditor.optionsPaneModule)||!this.documentEditor.optionsPaneModule.isOptionsPaneShow||(e.innerHTML="",this.documentEditor.optionsPaneModule.data=this.documentEditor.optionsPaneModule.dataForTreeview(),this.documentEditor.optionsPaneModule.initHeadingTab()))},Jy.prototype.rightAlignmentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleTextAlignment("Right"),this.documentEditor.focusIn())},Jy.prototype.centerAlignmentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleTextAlignment("Center"),this.documentEditor.focusIn())},Jy.prototype.justifyAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleTextAlignment("Justify"),this.documentEditor.focusIn())},Jy.prototype.increaseIndentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.increaseIndent(),this.documentEditor.focusIn())},Jy.prototype.decreaseIndentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.decreaseIndent(),this.documentEditor.focusIn())},Jy.prototype.numberedNoneClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.documentEditor.editorModule.clearList(),setTimeout(function(){e.documentEditor.focusIn()},30))},Jy.prototype.numberedNumberDotClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedNumberingStyle="arabic",this.documentEditor.editorModule.applyNumbering(this.getLevelFormatNumber(),"Arabic"),setTimeout(function(){e.documentEditor.focusIn()},30))},Jy.prototype.numberedUpRomanClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedNumberingStyle="uproman",this.documentEditor.editorModule.applyNumbering(this.getLevelFormatNumber(),"UpRoman"),setTimeout(function(){e.documentEditor.focusIn()},30))},Jy.prototype.numberedUpLetterClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedNumberingStyle="upletter",this.documentEditor.editorModule.applyNumbering(this.getLevelFormatNumber(),"UpLetter"),setTimeout(function(){e.documentEditor.focusIn()},30))},Jy.prototype.numberedLowLetterClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedNumberingStyle="lowletter",this.documentEditor.editorModule.applyNumbering(this.getLevelFormatNumber(),"LowLetter"),setTimeout(function(){e.documentEditor.focusIn()},30))},Jy.prototype.numberedLowRomanClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedNumberingStyle="lowroman",this.documentEditor.editorModule.applyNumbering(this.getLevelFormatNumber(),"LowRoman"),setTimeout(function(){e.documentEditor.focusIn()},30))},Jy.prototype.getLevelFormatNumber=function(){return"%"+((this.documentEditor.selectionModule.paragraphFormat.listLevelNumber<=0?0:this.documentEditor.selectionModule.paragraphFormat.listLevelNumber)+1)+"."},Jy.prototype.bulletDotClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedBulletStyle="dot",this.documentEditor.editorModule.applyBullet(String.fromCharCode(61623),"Symbol"),setTimeout(function(){e.documentEditor.focusIn()},30))},Jy.prototype.bulletCircleClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedBulletStyle="circle",this.documentEditor.editorModule.applyBullet(String.fromCharCode(61551)+String.fromCharCode(32),"Symbol"),setTimeout(function(){e.documentEditor.focusIn()},30))},Jy.prototype.bulletSquareClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedBulletStyle="square",this.documentEditor.editorModule.applyBullet(String.fromCharCode(61607),"Wingdings"),setTimeout(function(){e.documentEditor.focusIn()},30))},Jy.prototype.bulletFlowerClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedBulletStyle="flower",this.documentEditor.editorModule.applyBullet(String.fromCharCode(61558),"Wingdings"),setTimeout(function(){e.documentEditor.focusIn()},30))},Jy.prototype.bulletArrowClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedBulletStyle="arrow",this.documentEditor.editorModule.applyBullet(String.fromCharCode(61656),"Wingdings"),setTimeout(function(){e.documentEditor.focusIn()},30))},Jy.prototype.bulletTickClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedBulletStyle="tick",this.documentEditor.editorModule.applyBullet(String.fromCharCode(61692),"Wingdings"),setTimeout(function(){e.documentEditor.focusIn()},30))},Jy.prototype.onSelectionChange=function(){var e,t;this.isRetrieving=!0,this.documentEditor.editorModule&&(e=this.documentEditor.selectionModule.characterFormat.styleName,(e="Default Paragraph Font"===this.documentEditor.selectionModule.characterFormat.styleName?this.documentEditor.selectionModule.paragraphFormat.styleName:e)?(t=this.localObj.getConstant(e),this.style.value=_.isNullOrUndefined(t)||""==t?e:t):this.style.value=null,_.classList(this.leftAlignment,[],["e-btn-toggle"]),_.classList(this.rightAlignment,[],["e-btn-toggle"]),_.classList(this.centerAlignment,[],["e-btn-toggle"]),_.classList(this.justify,[],["e-btn-toggle"]),"Left"===this.documentEditor.selectionModule.paragraphFormat.textAlignment?(_.classList(this.leftAlignment,["e-btn-toggle"],[]),this.leftAlignment.setAttribute("aria-pressed","true"),this.rightAlignment.setAttribute("aria-pressed","false"),this.centerAlignment.setAttribute("aria-pressed","false"),this.justify.setAttribute("aria-pressed","false")):"Right"===this.documentEditor.selectionModule.paragraphFormat.textAlignment?(_.classList(this.rightAlignment,["e-btn-toggle"],[]),this.leftAlignment.setAttribute("aria-pressed","false"),this.rightAlignment.setAttribute("aria-pressed","true"),this.centerAlignment.setAttribute("aria-pressed","false"),this.justify.setAttribute("aria-pressed","false")):"Center"===this.documentEditor.selectionModule.paragraphFormat.textAlignment?(_.classList(this.centerAlignment,["e-btn-toggle"],[]),this.leftAlignment.setAttribute("aria-pressed","false"),this.rightAlignment.setAttribute("aria-pressed","false"),this.centerAlignment.setAttribute("aria-pressed","true"),this.justify.setAttribute("aria-pressed","false")):"Justify"===this.documentEditor.selectionModule.paragraphFormat.textAlignment&&(_.classList(this.justify,["e-btn-toggle"],[]),this.leftAlignment.setAttribute("aria-pressed","false"),this.rightAlignment.setAttribute("aria-pressed","false"),this.centerAlignment.setAttribute("aria-pressed","false"),this.justify.setAttribute("aria-pressed","true")),this.toggleHiddenMarks()),this.setLineSpacing(),this.isRetrieving=!1},Jy.prototype.destroy=function(){this.container=void 0,this.lineSpacing&&(this.lineSpacing.destroy(),this.lineSpacing=void 0),this.style&&(this.style.destroy(),this.style=void 0),this.bulletListBtn&&(this.bulletListBtn.destroy(),this.bulletListBtn=void 0),this.numberedListBtn&&(this.numberedListBtn.destroy(),this.numberedListBtn=void 0),this.leftAlignmentBtn&&(this.leftAlignmentBtn.destroy(),this.leftAlignmentBtn=void 0),this.rightAlignmentBtn&&(this.rightAlignmentBtn.destroy(),this.rightAlignmentBtn=void 0),this.centerAlignmentBtn&&(this.centerAlignmentBtn.destroy(),this.centerAlignmentBtn=void 0),this.showHiddenMarksBtn&&(this.showHiddenMarksBtn.destroy(),this.showHiddenMarksBtn=void 0),this.justifyBtn&&(this.justifyBtn.destroy(),this.justifyBtn=void 0),this.decreaseIndentBtn&&(this.decreaseIndentBtn.destroy(),this.decreaseIndentBtn=void 0),this.increaseIndentBtn&&(this.increaseIndentBtn.destroy(),this.increaseIndentBtn=void 0),this.bordersBtn&&(this.bordersBtn.destroy(),this.bordersBtn=void 0),this.showHiddenMarksBtn&&(this.showHiddenMarksBtn.destroy(),this.showHiddenMarksBtn=void 0)};var Xy=Jy;function Jy(e){this.isRetrieving=!1,this.appliedBulletStyle="dot",this.appliedNumberingStyle="arabic",this.appliedLineSpacing="",this.splitButtonClass="e-de-prop-splitbutton",this.container=e}Qy.prototype.initializeTextProperties=function(e,t,i){this.element=_.createElement("div",{className:"e-de-prop-pane e-de-scrollbar-hide"}),this.element.setAttribute("tabindex","0"),this.text.initializeTextPropertiesDiv(this.element,i),this.paragraph.initializeParagraphPropertiesDiv(this.element,i),this.paragraph.updateStyleNames(),t||this.container.propertiesPaneContainer.appendChild(this.element)},Qy.prototype.wireEvents=function(){this.text.wireEvent(),this.paragraph.wireEvent()},Qy.prototype.onSelectionChange=function(){this.text.onSelectionChange(),this.paragraph.onSelectionChange()},Qy.prototype.destroy=function(){this.text&&(this.text.destroy(),this.text=void 0),this.paragraph&&(this.paragraph.destroy(),this.paragraph=void 0),this.container=void 0};var Yy=Qy;function Qy(e,t,i,n){this.container=e,this.text=new Ky(e,n),this.paragraph=new Xy(e),this.initializeTextProperties(t,i,n),this.wireEvents()}Object.defineProperty(ev.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),ev.prototype.initializeTablePropPane=function(){this.localObj=new _.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.tableProperties=_.createElement("div",{className:"e-de-scrollbar-hide",styles:"overflow: auto"}),this.initFillColorDiv(),this.initBorderStylesDiv(),this.initCellDiv(),this.initInsertOrDelCell(),this.initCellMargin(),this.initAlignText(),this.addTablePropertyTab(),this.wireEvent()},ev.prototype.enableDisableElements=function(e){e?_.classList(this.element,[],["e-de-overlay"]):_.classList(this.element,["e-de-overlay"],[])},ev.prototype.addTablePropertyTab=function(){var e=_.createElement("div",{innerHTML:this.localObj.getConstant("Table")}),t=_.createElement("div",{innerHTML:this.localObj.getConstant("Text")}),t=(this.parentElement=_.createElement("div",{styles:"height:100%;overflow:auto;display:none",className:"e-de-prop-pane e-de-scrollbar-hide"}),this.element=_.createElement("div",{id:this.elementId+"_propertyTabDiv",className:"e-de-property-tab"}),[{header:{text:t},content:this.tableTextProperties.element},{header:{text:e},content:this.tableProperties}]);this.propertiesTab=new k.Tab({items:t,animation:{previous:{effect:"None"},next:{effect:"None"}},selected:this.onTabSelection.bind(this)}),this.propertiesTab.isStringTemplate=!0,this.propertiesTab.appendTo(this.element),this.parentElement.appendChild(this.element),this.container.propertiesPaneContainer.appendChild(this.parentElement)},ev.prototype.onTabSelection=function(e){e.preventFocus=!0,this.documentEditor.resize(),this.documentEditor.enableAutoFocus&&this.documentEditor.focusIn()},ev.prototype.wireEvent=function(){var t=this;this.shadingBtn.addEventListener("change",this.changeBackgroundColor),this.borderBtn.addEventListener("change",function(e){setTimeout(function(){t.borderColor=e.currentValue.hex,t.tableOutlineBorder.element.focus()},10)}),this.tableOutlineBorder.element.addEventListener("click",this.onOutlineBorderClickHandler),this.tableAllBorder.element.addEventListener("click",this.onAllBorderHandler),this.tableCenterBorder.element.addEventListener("click",this.onInsideBorderHandler),this.tableLeftBorder.element.addEventListener("click",this.onLeftBorderHandler),this.tableCenterVerticalBorder.element.addEventListener("click",this.onVerticalBorderHandler),this.tableRightBorder.element.addEventListener("click",this.onRightBorderHandler),this.tableTopBorder.element.addEventListener("click",this.onTopBorderHandler),this.tableCenterHorizontalBorder.element.addEventListener("click",this.onHorizontalBorderHandler),this.tableBottomBorder.element.addEventListener("click",this.onBottomBorderHandler),this.insertRowAbove.element.addEventListener("click",this.onInsertRowAboveHandler),this.insertRowBelow.element.addEventListener("click",this.onInsertRowBelowHandler),this.insertColumnLeft.element.addEventListener("click",this.onInsertColumnLeftHandler),this.insertColumnRight.element.addEventListener("click",this.onInsertColumnRightHandler),this.deleteRow.element.addEventListener("click",this.onDeleteRowHandler),this.deleteColumn.element.addEventListener("click",this.onDeleteColumnHandler),this.horizontalMerge.element.addEventListener("click",this.onMergeCellHandler),this.alignTop.element.addEventListener("click",this.applyAlignTopHandler),this.alignBottom.element.addEventListener("click",this.applyAlignBottomHandler),this.alignCenterHorizontal.element.addEventListener("click",this.applyAlignCenterHorizontalHandler),this.topMargin.htmlAttributes={"aria-label":"top-margin"},this.bottomMargin.htmlAttributes={"aria-label":"bottom-margin"},this.leftMargin.htmlAttributes={"aria-label":"left-margin"},this.rightMargin.htmlAttributes={"aria-label":"right-Margin"},this.topMargin.element.addEventListener("click",this.onTopMarginClickHandler),this.rightMargin.element.addEventListener("click",this.onRightMarginClickHandler),this.leftMargin.element.addEventListener("click",this.onLeftMarginClickHandler),this.bottomMargin.element.addEventListener("click",this.onBottomMarginClickHandler),this.topMargin.element.addEventListener("keydown",this.onTopMarginHandler),this.rightMargin.element.addEventListener("keydown",this.onRightMarginHandler),this.leftMargin.element.addEventListener("keydown",this.onLeftMarginHandler),this.bottomMargin.element.addEventListener("keydown",this.onBottomMarginHandler),this.topMargin.element.addEventListener("blur",this.onTopMarginBlurHandler),this.rightMargin.element.addEventListener("blur",this.onRightMarginBlurHandler),this.leftMargin.element.addEventListener("blur",this.onLeftMarginBlurHandler),this.bottomMargin.element.addEventListener("blur",this.onBottomMarginBlurHandler)},ev.prototype.unWireEvent=function(){this.shadingBtn.removeEventListener("change",this.changeBackgroundColor),this.tableOutlineBorder.element.removeEventListener("click",this.onOutlineBorderClickHandler),this.tableAllBorder.element.removeEventListener("click",this.onAllBorderHandler),this.tableCenterBorder.element.removeEventListener("click",this.onInsideBorderHandler),this.tableLeftBorder.element.removeEventListener("click",this.onLeftBorderHandler),this.tableCenterVerticalBorder.element.removeEventListener("click",this.onVerticalBorderHandler),this.tableRightBorder.element.removeEventListener("click",this.onRightBorderHandler),this.tableTopBorder.element.removeEventListener("click",this.onTopBorderHandler),this.tableCenterHorizontalBorder.element.removeEventListener("click",this.onHorizontalBorderHandler),this.tableBottomBorder.element.removeEventListener("click",this.onBottomBorderHandler),this.insertRowAbove.element.removeEventListener("click",this.onInsertRowAboveHandler),this.insertRowBelow.element.removeEventListener("click",this.onInsertRowBelowHandler),this.insertColumnLeft.element.removeEventListener("click",this.onInsertColumnLeftHandler),this.insertColumnRight.element.removeEventListener("click",this.onInsertColumnRightHandler),this.deleteRow.element.removeEventListener("click",this.onDeleteRowHandler),this.deleteColumn.element.removeEventListener("click",this.onDeleteColumnHandler),this.horizontalMerge.element.removeEventListener("click",this.onMergeCellHandler),this.alignTop.element.removeEventListener("click",this.applyAlignTopHandler),this.alignBottom.element.removeEventListener("click",this.applyAlignBottomHandler),this.alignCenterHorizontal.element.removeEventListener("click",this.applyAlignCenterHorizontalHandler),this.topMargin.element.removeEventListener("click",this.onTopMarginClickHandler),this.rightMargin.element.removeEventListener("click",this.onRightMarginClickHandler),this.leftMargin.element.removeEventListener("click",this.onLeftMarginClickHandler),this.bottomMargin.element.removeEventListener("click",this.onBottomMarginClickHandler),this.topMargin.element.removeEventListener("keydown",this.onTopMarginHandler),this.rightMargin.element.removeEventListener("keydown",this.onRightMarginHandler),this.leftMargin.element.removeEventListener("keydown",this.onLeftMarginHandler),this.bottomMargin.element.removeEventListener("keydown",this.onBottomMarginHandler),this.topMargin.element.removeEventListener("blur",this.onTopMarginBlurHandler),this.rightMargin.element.removeEventListener("blur",this.onRightMarginBlurHandler),this.leftMargin.element.removeEventListener("blur",this.onLeftMarginBlurHandler),this.bottomMargin.element.removeEventListener("blur",this.onBottomMarginBlurHandler)},ev.prototype.onTopMarginClick=function(){this.isTopMarginApply=!0},ev.prototype.onTopMarginBlur=function(){this.applyTopMargin(),this.isTopMarginApply=!1},ev.prototype.onRightMarginClick=function(){this.isRightMarginApply=!0},ev.prototype.onRightMarginBlur=function(){this.applyRightMargin(),this.isRightMarginApply=!1},ev.prototype.onLeftMarginClick=function(){this.isLeftMarginApply=!0},ev.prototype.onLeftMarginBlur=function(){this.applyLeftMargin(),this.isLeftMarginApply=!1},ev.prototype.onBottomMarginClick=function(){this.isBottomMarginApply=!0},ev.prototype.onBottomMarginBlur=function(){this.applyBottomMargin(),this.isBottomMarginApply=!1},ev.prototype.getBorder=function(e){var t=0<=this.borderSize.content.indexOf("No Border")?0:parseFloat(this.borderSize.content);return{type:e,borderColor:this.borderColor,lineWidth:t,borderStyle:0===t?"Cleared":"Single"}},ev.prototype.onOutlineBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("OutsideBorders"))},ev.prototype.onAllBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("AllBorders"))},ev.prototype.onInsideBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("InsideBorders"))},ev.prototype.onLeftBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("LeftBorder"))},ev.prototype.onVerticalBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("InsideVerticalBorder"))},ev.prototype.onRightBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("RightBorder"))},ev.prototype.onTopBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("TopBorder"))},ev.prototype.onHorizontalBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("InsideHorizontalBorder"))},ev.prototype.onBottomBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("BottomBorder"))},ev.prototype.onTopMargin=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyTopMargin(),t.isTopMarginApply=!1},30)},ev.prototype.onBottomMargin=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyBottomMargin(),t.isBottomMarginApply=!1},30)},ev.prototype.onLeftMargin=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyLeftMargin(),t.isLeftMarginApply=!1},30)},ev.prototype.onRightMargin=function(e){var t=this;13===e.keyCode&&setTimeout(function(){t.applyRightMargin(),t.isRightMarginApply=!1},30)},ev.prototype.applyTopMargin=function(){this.isTopMarginApply&&(this.documentEditor.selectionModule.cellFormat.topMargin=this.topMargin.value>this.topMargin.max?this.topMargin.max:this.topMargin.value)},ev.prototype.applyBottomMargin=function(){this.isBottomMarginApply&&(this.documentEditor.selectionModule.cellFormat.bottomMargin=this.bottomMargin.value>this.bottomMargin.max?this.bottomMargin.max:this.bottomMargin.value)},ev.prototype.applyLeftMargin=function(){this.isLeftMarginApply&&(this.documentEditor.selectionModule.cellFormat.leftMargin=this.leftMargin.value>this.leftMargin.max?this.leftMargin.max:this.leftMargin.value)},ev.prototype.applyRightMargin=function(){this.isRightMarginApply&&(this.documentEditor.selectionModule.cellFormat.rightMargin=this.rightMargin.value>this.rightMargin.max?this.rightMargin.max:this.rightMargin.value)},ev.prototype.applyAlignTop=function(){this.documentEditor.selectionModule.cellFormat.verticalAlignment="Top"},ev.prototype.applyAlignBottom=function(){this.documentEditor.selectionModule.cellFormat.verticalAlignment="Bottom"},ev.prototype.applyAlignCenterHorizontal=function(){this.documentEditor.selectionModule.cellFormat.verticalAlignment="Center"},ev.prototype.onMergeCell=function(){this.documentEditor.editorModule.mergeCells()},ev.prototype.onInsertRowAbove=function(){this.documentEditor.editorModule.insertRow(!0)},ev.prototype.onInsertRowBelow=function(){this.documentEditor.editorModule.insertRow(!1)},ev.prototype.onInsertColumnLeft=function(){this.documentEditor.editorModule.insertColumn(!0)},ev.prototype.onInsertColumnRight=function(){this.documentEditor.editorModule.insertColumn(!1)},ev.prototype.onDeleteRow=function(){this.documentEditor.editorModule.deleteRow(),this.documentEditor.focusIn()},ev.prototype.onDeleteColumn=function(){this.documentEditor.editorModule.deleteColumn(),this.documentEditor.focusIn()},ev.prototype.onSelectionChange=function(){this.documentEditor.selectionModule&&(this.documentEditor.editorModule&&this.documentEditor.editorModule.canMergeCells()?this.horizontalMerge.disabled=!1:this.horizontalMerge.disabled=!0,"TableText"!==this.documentEditor.selectionModule.contextType&&"TableImage"!==this.documentEditor.selectionModule.contextType||(this.shadingBtn.value=this.documentEditor.selectionModule.cellFormat.background||""),this.topMargin.value=this.documentEditor.selectionModule.cellFormat.topMargin||0,this.bottomMargin.value=this.documentEditor.selectionModule.cellFormat.bottomMargin||0,this.rightMargin.value=this.documentEditor.selectionModule.cellFormat.rightMargin||0,this.leftMargin.value=this.documentEditor.selectionModule.cellFormat.leftMargin||0)},ev.prototype.changeBackgroundColor=function(e){var t=this;this.documentEditor.isReadOnly||(this.documentEditor.selectionModule.cellFormat.background=e.currentValue.hex,setTimeout(function(){t.documentEditor.focusIn()},10))},ev.prototype.initFillColorDiv=function(){var e=_.createElement("div",{id:this.elementId+"_fillColorDiv",className:"e-de-property-div-padding de-tbl-fill-clr"}),t=(this.tableProperties.appendChild(e),_.createElement("label",{className:"e-de-prop-sub-label"}));t.classList.add("e-de-prop-fill-label"),this.isRtl&&t.classList.add("e-de-rtl"),t.textContent=this.localObj.getConstant("Fill"),e.appendChild(t),this.shadingBtn=this.createColorPickerTemplate(this.elementId+"_tableShading",e,this.localObj.getConstant("Fill color"),!1),_.classList(e.lastElementChild.lastElementChild.lastElementChild.firstChild,["e-de-ctnr-cellbg-clr-picker"],["e-caret"]),this.documentEditor.documentHelper.shadingBtn=this.shadingBtn},ev.prototype.initBorderStylesDiv=function(){var e=_.createElement("div",{className:"e-de-property-div-padding"}),t=(this.tableProperties.appendChild(e),_.createElement("label",{className:"e-de-ctnr-prop-label"})),i=(t.textContent=this.localObj.getConstant("Border Style"),e.appendChild(t),_.createElement("div",{styles:"display:inline-flex;"})),n=_.createElement("div",{styles:"width:min-content;height:126px",className:"e-de-grp-btn-ctnr"}),r=_.createElement("div",{className:this.groupButtonClass+" e-de-ctnr-group-btn-top"}),o=(n.appendChild(r),_.createElement("div",{className:this.groupButtonClass+" e-de-ctnr-group-btn-middle"})),s=(n.appendChild(o),_.createElement("div",{className:this.groupButtonClass+" e-de-ctnr-group-btn-bottom"})),t=(n.appendChild(s),this.isRtl&&(r.classList.add("e-de-rtl"),s.classList.add("e-de-rtl"),i.classList.add("e-de-rtl"),t.classList.add("e-de-rtl")),this.tableOutlineBorder=this.createButtonTemplate(this.elementId+"_tableOutlineBorder","e-de-ctnr-outsideborder e-icons",r,"e-de-prop-font-button","",this.localObj.getConstant("Outside borders")),this.tableAllBorder=this.createButtonTemplate(this.elementId+"_tableAllBorder","e-de-ctnr-allborders e-icons",r,"e-de-prop-font-button","",this.localObj.getConstant("All borders")),this.tableCenterBorder=this.createButtonTemplate(this.elementId+"_tableCenterBorder","e-de-ctnr-insideborders e-icons",r,"e-de-prop-font-button","",this.localObj.getConstant("Inside borders")),this.tableLeftBorder=this.createButtonTemplate(this.elementId+"_tableLeftBorder","e-de-ctnr-leftborders e-icons",o,"e-de-prop-font-button","",this.localObj.getConstant("Left border")),this.tableCenterVerticalBorder=this.createButtonTemplate(this.elementId+"_tableCenterVBorder","e-de-ctnr-insideverticalborder e-icons",o,"e-de-prop-font-button","",this.localObj.getConstant("Inside vertical border")),this.tableRightBorder=this.createButtonTemplate(this.elementId+"_tableRightBorder","e-de-ctnr-rightborder e-icons",o,"e-de-prop-font-button","",this.localObj.getConstant("Right border")),this.tableTopBorder=this.createButtonTemplate(this.elementId+"_tableTopBorder","e-de-ctnr-topborder e-icons",s,"e-de-prop-font-button","",this.localObj.getConstant("Top border")),this.tableCenterHorizontalBorder=this.createButtonTemplate(this.elementId+"_tableCenterHBorder","e-de-ctnr-insidehorizondalborder e-icons",s,"e-de-prop-font-button","",this.localObj.getConstant("Inside horizontal border")),this.tableBottomBorder=this.createButtonTemplate(this.elementId+"_tableBottomBorder","e-de-ctnr-bottomborder e-icons",s,"e-de-prop-font-button","",this.localObj.getConstant("Bottom border")),i.appendChild(n),_.createElement("div",{className:"de-tbl-fill-clr"})),r=(this.isRtl?t.classList.add("e-de-stylediv-rtl"):t.classList.add("e-de-stylediv"),this.borderBtn=this.createColorPickerTemplate(this.elementId+"_tableBorderColor",t,this.localObj.getConstant("Border color"),!0),this.documentEditor.documentHelper.borderBtn=this.borderBtn,this.borderBtn.value="#000000",t.firstElementChild.lastElementChild.lastElementChild.style.width="30px",t.firstElementChild.lastElementChild.firstElementChild.firstElementChild.style.width="100%",_.classList(t.lastElementChild.lastElementChild.lastElementChild.firstChild,["e-de-ctnr-highlightcolor"],["e-caret"]),_.createElement("button",{id:this.elementId+"_tableBorderSize",className:"e-de-border-size-button",styles:"font-size:10px;padding:0px;",attrs:{type:"button"}}));t.appendChild(r),this.borderSize=this.createBorderSizeDropDown("e-de-ctnr-strokesize e-icons",r),i.appendChild(t),this.borderSizeColorElement=document.getElementsByClassName("e-de-border-width"),e.appendChild(i)},ev.prototype.initCellDiv=function(){var e=_.createElement("div",{className:"e-de-property-div-padding"}),t=(this.tableProperties.appendChild(e),_.createElement("label",{className:"e-de-ctnr-prop-label"})),i=(t.textContent=this.localObj.getConstant("Cell"),e.appendChild(t),_.createElement("div",{className:"e-de-ctnr-group-btn"}));i.classList.add("e-de-cell-div"),this.isRtl&&(i.classList.add("e-de-rtl"),t.classList.add("e-de-rtl"));this.horizontalMerge=this.createButtonTemplate(this.elementId+"_tableOutlineBorder","e-de-ctnr-mergecell e-icons",i,"e-de-prop-font-button","",this.localObj.getConstant("Merge cells")),e.appendChild(i)},ev.prototype.initInsertOrDelCell=function(){var e=_.createElement("div",{className:"e-de-property-div-padding"}),t=(this.tableProperties.appendChild(e),_.createElement("label",{className:"e-de-ctnr-prop-label"})),i=(t.textContent=this.localObj.getConstant("Insert Or Delete"),e.appendChild(t),_.createElement("div",{className:"e-de-insert-del-cell",styles:"display:inline-flex"})),n=_.createElement("div",{className:this.groupButtonClass}),r=(i.appendChild(n),_.createElement("div",{className:this.groupButtonClass}));this.isRtl?(r.style.marginRight="12px",i.classList.add("e-de-rtl"),t.classList.add("e-de-rtl")):r.style.marginLeft="12px",i.appendChild(r);this.insertColumnLeft=this.createButtonTemplate(this.elementId+"_insertColumnLeft","e-de-ctnr-insertleft e-icons",n,"e-de-prop-font-button","",this.localObj.getConstant("Insert columns to the left")),this.insertColumnRight=this.createButtonTemplate(this.elementId+"_insertColumnRight","e-de-ctnr-insertright e-icons",n,"e-de-prop-font-button","",this.localObj.getConstant("Insert columns to the right")),this.insertRowAbove=this.createButtonTemplate(this.elementId+"_insertRowAbove","e-de-ctnr-insertabove e-icons",n,"e-de-prop-font-button","",this.localObj.getConstant("Insert rows above")),this.insertRowBelow=this.createButtonTemplate(this.elementId+"_insertRowBelow","e-de-ctnr-insertbelow e-icons",n,"e-de-prop-font-button","",this.localObj.getConstant("Insert rows below")),this.deleteRow=this.createButtonTemplate(this.elementId+"_deleteRow","e-de-ctnr-deleterows e-icons",r,"e-de-prop-font-button","",this.localObj.getConstant("Delete rows")),this.deleteColumn=this.createButtonTemplate(this.elementId+"_deleteColumn","e-de-ctnr-deletecolumns e-icons",r,"e-de-prop-font-button","",this.localObj.getConstant("Delete columns")),e.appendChild(i)},ev.prototype.initCellMargin=function(){var e=_.createElement("div",{className:"e-de-property-div-padding e-de-cellmargin-text"}),t=(this.tableProperties.appendChild(e),_.createElement("label",{className:"e-de-ctnr-prop-label"})),i=(t.textContent=this.localObj.getConstant("Cell Margin"),e.appendChild(t),_.createElement("div",{styles:"display:inline-flex"})),t=(this.isRtl&&t.classList.add("e-de-rtl"),"width:48px"),n="width:50px;float:left;";this.topMargin=this.createCellMarginTextBox(this.localObj.getConstant("Top"),this.elementId+"_topMargin",i,t,n,500,this.localObj.getConstant("Top margin")),this.bottomMargin=this.createCellMarginTextBox(this.localObj.getConstant("Bottom"),this.elementId+"_bottomMargin",i,t,n,500,this.localObj.getConstant("Bottom margin")),this.leftMargin=this.createCellMarginTextBox(this.localObj.getConstant("Left"),this.elementId+"_leftMargin",i,t,n,500,this.localObj.getConstant("Left margin")),this.rightMargin=this.createCellMarginTextBox(this.localObj.getConstant("Right"),this.elementId+"_rightMargin",i,t,n,500,this.localObj.getConstant("Right margin"),!0),e.appendChild(i)},ev.prototype.initAlignText=function(){var e=_.createElement("div",{className:"e-de-property-div-padding",styles:"border-bottom-width:0px"}),t=(this.tableProperties.appendChild(e),_.createElement("label",{className:"e-de-ctnr-prop-label"})),i=(t.textContent=this.localObj.getConstant("Align Text"),e.appendChild(t),_.createElement("div")),t=(this.isRtl&&(i.classList.add("e-de-rtl"),t.classList.add("e-de-rtl")),_.createElement("div",{className:this.groupButtonClass}));i.appendChild(t);this.alignTop=this.createButtonTemplate(this.elementId+"_alignTop","e-de-ctnr-aligntop e-icons",t,"e-de-prop-font-button","",this.localObj.getConstant("Align top")),this.alignBottom=this.createButtonTemplate(this.elementId+"_alignBottom","e-de-ctnr-alignbottom e-icons",t,"e-de-prop-font-button","",this.localObj.getConstant("Align bottom")),this.alignCenterHorizontal=this.createButtonTemplate(this.elementId+"_alignCenterHorizontal","e-de-ctnr-aligncenter-table e-icons",t,"e-de-prop-font-button","",this.localObj.getConstant("Align center")),this.alignCenterHorizontal.addEventListener("click",this.applyAlignCenterHorizontal.bind(this)),e.appendChild(i)},ev.prototype.createCellMarginTextBox=function(e,t,i,n,r,o,s,a){r=_.createElement("div",{styles:r}),a||r.classList.add("e-de-cell-text-box"),a=_.createElement("label",{className:"e-de-prop-sub-label"}),a.textContent=e,r.appendChild(a),e=_.createElement("input",{className:"e-textbox",id:t,styles:n}),r.appendChild(e),a=new D.NumericTextBox({showSpinButton:!1,min:0,format:"n0",max:o,enableRtl:this.isRtl},e);return i.appendChild(r),e.setAttribute("title",s),a},ev.prototype.createBorderSizeDropDown=function(e,t){var i=this,n=_.createElement("div",{id:"borderSizeTarget",styles:"display:none"}),r=_.createElement("ul",{styles:"display: block; outline: 0px; width: 126px; height: auto;",id:"borderSizeListMenu"});n.appendChild(r);this.createDropdownOption(r,this.localObj.getConstant("No Border")).addEventListener("click",function(){i.onBorderSizeChange("No Border")});var o=this.localObj.getConstant("px");this.createDropdownOption(r,".25"+o).addEventListener("click",function(){i.onBorderSizeChange(".25px")}),this.createDropdownOption(r,".5"+o).addEventListener("click",function(){i.onBorderSizeChange(".5px")}),this.createDropdownOption(r,".75"+o).addEventListener("click",function(){i.onBorderSizeChange(".75px")}),this.createDropdownOption(r,"1"+o).addEventListener("click",function(){i.onBorderSizeChange("1px")}),this.createDropdownOption(r,"1.5"+o).addEventListener("click",function(){i.onBorderSizeChange("1.5px")}),this.createDropdownOption(r,"2"+o).addEventListener("click",function(){i.onBorderSizeChange("2px")}),this.createDropdownOption(r,"3"+o).addEventListener("click",function(){i.onBorderSizeChange("3px")}),this.createDropdownOption(r,"4"+o).addEventListener("click",function(){i.onBorderSizeChange("4px")}),this.createDropdownOption(r,"5"+o).addEventListener("click",function(){i.onBorderSizeChange("5px")});this.createDropdownOption(r,"6"+o).addEventListener("click",function(){i.onBorderSizeChange("6px")});r={target:n,iconCss:e,cssClass:"e-de-prop-bordersize",enableRtl:this.isRtl,content:"1.5px"},o=new w.DropDownButton(r);return o.beforeOpen=function(){n.style.display="block";for(var e=0;e<i.borderSizeColorElement.length;e++)i.borderSizeColorElement[parseInt(e.toString(),10)].style.borderBottomColor=i.borderColor},o.beforeClose=function(){n.style.display="none"},o.appendTo(t),o.element.setAttribute("title",this.localObj.getConstant("Border width")),o},ev.prototype.onBorderSizeChange=function(e){var t=this;this.borderSize.content=e,setTimeout(function(){t.tableOutlineBorder.element.focus()},10)},ev.prototype.createDropdownOption=function(e,t){var i=_.createElement("li",{styles:"display:block",className:"e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size"}),e=(e.appendChild(i),_.createElement("div",{className:"e-de-list-header-presetmenu",innerHTML:"No Border"===t?"<div>"+t+"</div>":"1.5px"===t?"<div>"+t+'<span class="e-de-list-line e-de-border-width"  style="margin-left:10px;border-bottom-width:'+t+';"></span></div>':"<div>"+t+'<span class="e-de-list-line e-de-border-width" style="margin-left:20px;border-bottom-width:'+t+';"></span></div>'}));return i.appendChild(e),i},ev.prototype.createDropDownButton=function(e,t,i,n,r,o,s){e=_.createElement("button",{id:e,styles:t,attrs:{type:"button"}}),i.appendChild(e),t="e-de-prop-splitbutton",this.isRtl&&(t="e-rtl "+t),i=new w.DropDownButton({iconCss:n,content:r,enableRtl:this.isRtl,cssClass:t},e);return o&&(i.items=o),s&&(i.target=s),i},ev.prototype.createButtonTemplate=function(e,t,i,n,r,o,s,a){e=_.createElement("Button",{id:e,styles:r,attrs:{type:"button"}}),i.appendChild(e),r=new H.Button({cssClass:n,iconCss:t,enableRtl:this.isRtl,iconPosition:a||"Left",content:s||""});return r.appendTo(e),e.setAttribute("title",o),e.setAttribute("aria-label",o),r},ev.prototype.createColorPickerTemplate=function(e,t,i,n){var r=this.documentEditor.documentEditorSettings.colorPickerSettings,o=r.columns,s=r.createPopupOnClick,a=r.disabled,l=r.enablePersistence,d=r.inline,h=r.mode,c=r.modeSwitcher,p=r.noColor,u=r.presetColors,r=r.showButtons,e=_.createElement("input",{id:e}),t=(t.appendChild(e),"e-de-prop-font-button e-de-prop-font-colorpicker"),n=(n&&(t+=" e-de-border-clr-picker"),new D.ColorPicker({cssClass:t,enableRtl:this.isRtl,locale:this.container.locale,enableOpacity:!1,mode:h,modeSwitcher:c,showButtons:r,columns:o,createPopupOnClick:s,disabled:a,enablePersistence:l,inline:d,noColor:p,presetColors:u},e));return e.parentElement.setAttribute("title",i),e.parentElement.setAttribute("aria-label",i),n},ev.prototype.showTableProperties=function(e,t){e&&("text"===t?this.propertiesTab.hideTab(1,!0):(this.propertiesTab.hideTab(1,!1),this.prevContext!==this.documentEditor.selectionModule.contextType&&(this.propertiesTab.selectedItem=1)),this.prevContext=this.documentEditor.selectionModule.contextType,this.onSelectionChange(),this.tableTextProperties.onSelectionChange()),!e&&"none"===this.parentElement.style.display||e&&"block"===this.parentElement.style.display||(this.parentElement.style.display=e?"block":"none",e&&this.updateTabContainerHeight(),this.documentEditor.resize(),this.prevContext=this.documentEditor.selectionModule.contextType)},ev.prototype.updateTabContainerHeight=function(){var e;this.parentElement&&"block"===this.parentElement.style.display&&(e=this.parentElement.getElementsByClassName("e-tab-header")[0])&&(e=this.parentElement.offsetHeight-e.offsetHeight,this.tableProperties.style.height=e+"px",this.tableTextProperties.element.style.height=e+"px")},ev.prototype.destroy=function(){this.unWireEvent(),this.container=void 0,this.shadingBtn&&(this.shadingBtn.destroy(),this.shadingBtn=void 0),this.borderBtn&&(this.borderBtn.destroy(),this.borderBtn=void 0),this.borderSize&&(this.borderSize.destroy(),this.borderSize=void 0),this.topMargin&&(this.topMargin.destroy(),this.topMargin=void 0),this.bottomMargin&&(this.bottomMargin.destroy(),this.bottomMargin=void 0),this.leftMargin&&(this.leftMargin.destroy(),this.leftMargin=void 0),this.rightMargin&&(this.rightMargin.destroy(),this.rightMargin=void 0),this.tableTextProperties&&(this.tableTextProperties.destroy(),this.tableTextProperties=void 0),this.propertiesTab&&(this.propertiesTab.destroy(),this.propertiesTab=void 0),this.imageProperty&&(this.imageProperty=null),this.tableOutlineBorder&&this.tableOutlineBorder.destroy(),this.tableOutlineBorder=void 0,this.tableAllBorder&&this.tableAllBorder.destroy(),this.tableAllBorder=void 0,this.tableCenterBorder&&this.tableCenterBorder.destroy(),this.tableCenterBorder=void 0,this.tableLeftBorder&&this.tableLeftBorder.destroy(),this.tableLeftBorder=void 0,this.tableCenterVerticalBorder&&this.tableCenterVerticalBorder.destroy(),this.tableCenterVerticalBorder=void 0,this.tableRightBorder&&this.tableRightBorder.destroy(),this.tableRightBorder=void 0,this.tableTopBorder&&this.tableTopBorder.destroy(),this.tableTopBorder=void 0,this.tableCenterHorizontalBorder&&this.tableCenterHorizontalBorder.destroy(),this.tableCenterHorizontalBorder=void 0,this.tableBottomBorder&&this.tableBottomBorder.destroy(),this.tableBottomBorder=void 0,this.horizontalMerge&&this.horizontalMerge.destroy(),this.horizontalMerge=void 0,this.insertRowAbove&&this.insertRowAbove.destroy(),this.insertRowAbove=void 0,this.insertRowBelow&&this.insertRowBelow.destroy(),this.insertRowBelow=void 0,this.insertColumnLeft&&this.insertColumnLeft.destroy(),this.insertColumnLeft=void 0,this.insertColumnRight&&this.insertColumnRight.destroy(),this.insertColumnRight=void 0,this.deleteRow&&this.deleteRow.destroy(),this.deleteRow=void 0,this.deleteColumn&&this.deleteColumn.destroy(),this.deleteColumn=void 0,this.alignBottom&&this.alignBottom.destroy(),this.alignBottom=void 0,this.alignCenterHorizontal&&this.alignCenterHorizontal.destroy(),this.alignCenterHorizontal=void 0,this.alignTop&&this.alignTop.destroy(),this.alignTop=void 0,this.groupButtonClass=void 0,this.borderColor=void 0,this.elementId=void 0};var $y=ev;function ev(e,t,i){this.isTopMarginApply=!1,this.isRightMarginApply=!1,this.isBottomMarginApply=!1,this.isLeftMarginApply=!1,this.borderColor="#000000",this.groupButtonClass="e-de-ctnr-group-btn e-btn-group",this.onOutlineBorderClickHandler=this.onOutlineBorder.bind(this),this.onAllBorderHandler=this.onAllBorder.bind(this),this.onInsideBorderHandler=this.onInsideBorder.bind(this),this.onLeftBorderHandler=this.onLeftBorder.bind(this),this.onVerticalBorderHandler=this.onVerticalBorder.bind(this),this.onRightBorderHandler=this.onRightBorder.bind(this),this.onTopBorderHandler=this.onTopBorder.bind(this),this.onHorizontalBorderHandler=this.onHorizontalBorder.bind(this),this.onBottomBorderHandler=this.onBottomBorder.bind(this),this.onInsertRowAboveHandler=this.onInsertRowAbove.bind(this),this.onInsertRowBelowHandler=this.onInsertRowBelow.bind(this),this.onInsertColumnLeftHandler=this.onInsertColumnLeft.bind(this),this.onInsertColumnRightHandler=this.onInsertColumnRight.bind(this),this.onDeleteRowHandler=this.onDeleteRow.bind(this),this.onDeleteColumnHandler=this.onDeleteColumn.bind(this),this.onMergeCellHandler=this.onMergeCell.bind(this),this.applyAlignTopHandler=this.applyAlignTop.bind(this),this.applyAlignBottomHandler=this.applyAlignBottom.bind(this),this.applyAlignCenterHorizontalHandler=this.applyAlignCenterHorizontal.bind(this),this.onTopMarginHandler=this.onTopMargin.bind(this),this.onRightMarginHandler=this.onRightMargin.bind(this),this.onLeftMarginHandler=this.onLeftMargin.bind(this),this.onBottomMarginHandler=this.onBottomMargin.bind(this),this.onTopMarginClickHandler=this.onTopMarginClick.bind(this),this.onTopMarginBlurHandler=this.onTopMarginBlur.bind(this),this.onRightMarginClickHandler=this.onRightMarginClick.bind(this),this.onRightMarginBlurHandler=this.onRightMarginBlur.bind(this),this.onLeftMarginClickHandler=this.onLeftMarginClick.bind(this),this.onLeftMarginBlurHandler=this.onLeftMarginBlur.bind(this),this.onBottomMarginClickHandler=this.onBottomMarginClick.bind(this),this.onBottomMarginBlurHandler=this.onBottomMarginBlur.bind(this),this.container=e,this.isRtl=i,this.isRtl&&(this.groupButtonClass="e-rtl "+this.groupButtonClass),this.tableTextProperties=new Yy(e,"textProperties",!0,this.isRtl),this.imageProperty=t,this.elementId=this.documentEditor.element.id,this.initializeTablePropPane(),this.prevContext=this.documentEditor.selectionModule.contextType}iv.prototype.onPageLayoutClick=function(){this.documentEditor.layoutType="Pages",this.addRemoveClass(this.pageButton,this.webButton),this.documentEditor.focusIn()},iv.prototype.onWebLayoutClick=function(){this.documentEditor.layoutType="Continuous",this.addRemoveClass(this.webButton,this.pageButton),this.documentEditor.focusIn()},iv.prototype.onPageNumberKeyDown=function(e){13===e.which&&(e.preventDefault(),parseInt(this.pageNumberInput.value,10)>this.editorPageCount?this.updatePageNumber():this.documentEditor.selectionModule?(this.documentEditor.selectionModule.goToPage(parseInt(this.pageNumberInput.value,10)),this.documentEditor.focusIn()):this.documentEditor.scrollToPage(parseInt(this.pageNumberInput.value,10)),this.pageNumberInput.contentEditable="false",""===this.pageNumberInput.value)&&this.updatePageNumber(),64<e.which&&e.preventDefault()},iv.prototype.onPageNumberKeyUp=function(){this.updatePageNumberWidth()},iv.prototype.onPageNumberBlur=function(){(""===this.pageNumberInput.value||parseInt(this.pageNumberInput.value,10)>this.editorPageCount)&&this.updatePageNumber(),this.pageNumberInput.contentEditable="false"},iv.prototype.onPageNumberFocus=function(){this.pageNumberInput.select()},Object.defineProperty(iv.prototype,"documentEditor",{get:function(){return this.container?this.container.documentEditor:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(iv.prototype,"editorPageCount",{get:function(){return this.documentEditor?this.documentEditor.pageCount:1},enumerable:!0,configurable:!0}),iv.prototype.initializeStatusBar=function(){var e=this.container.enableRtl,t=(this.documentEditor.enableSpellCheck=!!this.container.enableSpellCheck,this.localObj=new _.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),e?"padding-right:16px":"padding-left:16px"),t=(this.pageNumDiv=_.createElement("div",{className:this.container.enableSpellCheck?"e-de-ctnr-pg-no":"e-de-ctnr-pg-no-spellout",styles:t}),this.statusBarDiv.appendChild(this.pageNumDiv),this.pageLabel=_.createElement("span"),this.pageLabel.textContent=this.localObj.getConstant("Page")+" ",this.pageNumDiv.appendChild(this.pageLabel),this.pageNumberInput=_.createElement("input",{styles:"text-transform:capitalize;white-space:pre;overflow:hidden;user-select:none;cursor:text",attrs:{type:"text","aria-label":this.localObj.getConstant("Current Page Number")},className:"e-de-pagenumber-input"}),this.editablePageNumber=_.createElement("div",{styles:"display: inline-flex",className:"e-input e-de-pagenumber-text"}),this.editablePageNumber.appendChild(this.pageNumberInput),""),t=e?(this.pageLabel.style.marginLeft="6px",this.editablePageNumber.style.marginLeft="6px","padding-left:5px"):(this.pageLabel.style.marginRight="6px",this.editablePageNumber.style.marginRight="6px","padding-right:5px"),e=(this.updatePageNumber(),this.pageNumDiv.appendChild(this.editablePageNumber),this.editablePageNumber.setAttribute("title",this.localObj.getConstant("Current Page Number")),this.ofLabel=_.createElement("span",{styles:t}),this.ofLabel.textContent=" "+this.localObj.getConstant("of")+" ",this.pageNumDiv.appendChild(this.ofLabel),this.pageCount=_.createElement("span"),this.pageNumDiv.appendChild(this.pageCount),this.updatePageCount(),this.documentEditor.enableSpellCheck&&(this.verticalLine=_.createElement("div",{className:"e-de-statusbar-separator"}),this.statusBarDiv.appendChild(this.verticalLine),this.spellCheckBtn=this.addSpellCheckElement(),this.spellCheckButton.appendTo(this.spellCheckBtn)),this.pageButton=this.createButtonTemplate(this.container.enableSpellCheck?"e-de-statusbar-pageweb e-btn-pageweb-spellcheck":"e-de-statusbar-pageweb","e-de-printlayout e-icons","Print layout",this.statusBarDiv,this.pageButton,"Pages"===this.documentEditor.layoutType),this.webButton=this.createButtonTemplate("e-de-statusbar-pageweb","e-de-weblayout e-icons","Web layout",this.statusBarDiv,this.webButton,"Continuous"===this.documentEditor.layoutType),this.pageButton.addEventListener("click",this.onPageLayoutClickHandler),this.webButton.addEventListener("click",this.onWebLayoutClickHandler),this.zoomBtn=_.createElement("button",{className:"e-de-statusbar-zoom",attrs:{type:"button"}}),this.statusBarDiv.appendChild(this.zoomBtn),this.zoomBtn.setAttribute("title",this.localObj.getConstant("ZoomLevelTooltip")),[{text:"200%"},{text:"175%"},{text:"150%"},{text:"125%"},{text:"100%"},{text:"75%"},{text:"50%"},{text:"25%"},{separator:!0},{text:this.localObj.getConstant("Fit one page")},{text:this.localObj.getConstant("Fit page width")}]);this.zoom=new w.DropDownButton({content:"100%",items:e,enableRtl:this.container.enableRtl,select:this.onZoom.bind(this)}),this.zoom.isStringTemplate=!0,this.zoom.appendTo(this.zoomBtn)},iv.prototype.addSpellCheckElement=function(){var i=this,e=_.createElement("button",{className:"e-de-statusbar-spellcheck"}),t=(this.statusBarDiv.appendChild(e),e.setAttribute("title","Spell Checker options"),[{text:this.localObj.getConstant("Spell Check")},{text:this.localObj.getConstant("Underline errors")}]);return this.spellCheckButton=new w.DropDownButton({content:this.localObj.getConstant("Spelling"),items:t,enableRtl:this.container.enableRtl,select:this.onSpellCheck.bind(this),beforeItemRender:function(e){e.element.innerHTML="<span></span>"+e.item.text,_.isNullOrUndefined(i.currentLanguage)&&(i.currentLanguage=i.documentEditor.spellCheckerModule.languageID),_.isNullOrUndefined(i.allowSuggestion)&&(i.allowSuggestion=i.documentEditor.spellCheckerModule.allowSpellCheckAndSuggestion);var t=e.element.children[0];e.item.text===i.localObj.getConstant("Spell Check")&&i.documentEditor.enableSpellCheck&&i.documentEditor.spellCheckerModule.enableSpellCheck?(t.style.marginRight="10px",t.setAttribute("class","e-de-selected-spellcheck-item")):e.item.text===i.localObj.getConstant("Underline errors")&&i.documentEditor.enableSpellCheck&&i.documentEditor.spellCheckerModule.enableSpellCheck&&!i.documentEditor.spellCheckerModule.removeUnderline?(t.style.marginRight="10px",t.setAttribute("class","e-de-selected-underline-item")):(t.style.marginRight="25px",e.element.children[0].classList.remove("e-de-selected-spellcheck-item"),e.element.children[0].classList.remove("e-de-selected-underline-item"))}}),e},iv.prototype.onZoom=function(e){this.setZoomValue(e.item.text),this.updateZoomContent()},iv.prototype.onSpellCheck=function(e){this.setSpellCheckValue(e.item.text)},iv.prototype.updateZoomContent=function(){this.zoom.content=Math.round(100*this.documentEditor.zoomFactor)+"%"},iv.prototype.setSpellCheckValue=function(e){this.spellCheckButton.content=this.localObj.getConstant("Spelling"),e.match(this.localObj.getConstant("Spell Check"))?(this.documentEditor.spellCheckerModule.enableSpellCheck=!this.documentEditor.spellCheckerModule.enableSpellCheck,this.documentEditor.documentHelper.triggerSpellCheck=!1,this.documentEditor.documentHelper.triggerElementsOnLoading=!1):e.match(this.localObj.getConstant("Underline errors"))&&this.documentEditor.enableSpellCheck&&this.documentEditor.spellCheckerModule.enableSpellCheck&&(this.documentEditor.spellCheckerModule.removeUnderline=!this.documentEditor.spellCheckerModule.removeUnderline)},iv.prototype.setZoomValue=function(e){e.match(this.localObj.getConstant("Fit one page"))?this.documentEditor.fitPage("FitOnePage"):e.match(this.localObj.getConstant("Fit page width"))?this.documentEditor.fitPage("FitPageWidth"):this.documentEditor.zoomFactor=parseInt(e,10)/100},iv.prototype.updatePageCount=function(){this.pageCount.textContent=this.editorPageCount.toString()},iv.prototype.updatePageNumber=function(){this.pageNumberInput.value=this.startPage.toString(),this.updatePageNumberWidth()},iv.prototype.updatePageNumberOnViewChange=function(e){this.documentEditor.selectionModule&&this.documentEditor.selectionModule.startPage>=e.startPage&&this.documentEditor.selectionModule.startPage<=e.endPage?this.startPage=this.documentEditor.selectionModule.startPage:this.startPage=e.startPage,this.updatePageNumber(),this.updatePageCount()},iv.prototype.wireEvents=function(){this.pageNumberInput.addEventListener("keydown",this.onPageNumberKeyDownHandler),this.pageNumberInput.addEventListener("keyup",this.onPageNumberKeyUpHandler),this.pageNumberInput.addEventListener("blur",this.onPageNumberBlurHandler),this.pageNumberInput.addEventListener("focus",this.onPageNumberFocusHandler)},iv.prototype.unWireEvents=function(){this.pageButton.removeEventListener("click",this.onPageLayoutClickHandler),this.webButton.removeEventListener("click",this.onWebLayoutClickHandler),this.pageNumberInput.removeEventListener("keydown",this.onPageNumberKeyDownHandler),this.pageNumberInput.removeEventListener("keyup",this.onPageNumberKeyUpHandler),this.pageNumberInput.removeEventListener("blur",this.onPageNumberBlurHandler),this.pageNumberInput.removeEventListener("focus",this.onPageNumberFocusHandler)},iv.prototype.updatePageNumberWidth=function(){this.pageNumberInput&&(this.pageNumberInput.style.width=3<=this.pageNumberInput.value.length?"30px":"22px")},iv.prototype.toggleWebLayout=function(){this.addRemoveClass(this.pageButton,this.webButton)},iv.prototype.togglePageLayout=function(){this.addRemoveClass(this.webButton,this.pageButton)},iv.prototype.addRemoveClass=function(e,t){e.classList.add("e-btn-toggle"),t.classList.contains("e-btn-toggle")&&t.classList.remove("e-btn-toggle")},iv.prototype.createButtonTemplate=function(e,t,i,n,r,o){r=_.createElement("Button",{className:e,attrs:{type:"button"}}),n.appendChild(r);n=new H.Button({cssClass:e,iconCss:t,enableRtl:this.container.enableRtl});return!0===o&&r.classList.add("e-btn-toggle"),n.appendTo(r),r.setAttribute("title",this.localObj.getConstant(i)),"Web layout"===i?this.webBtn=n:this.pageBtn=n,r},iv.prototype.destroy=function(){this.unWireEvents(),this.removeHTMLDom(),this.dependentComponentsDestroy(),this.pageButton=void 0,this.webButton=void 0,this.pageNumberInput=void 0,this.statusBarDiv=void 0,this.pageCount=void 0,this.editablePageNumber=void 0,this.localObj=void 0,this.container=void 0},iv.prototype.dependentComponentsDestroy=function(){this.zoom&&(this.zoom.destroy(),this.zoom=void 0),this.spellCheckButton&&(this.spellCheckButton.destroy(),this.spellCheckButton=void 0),this.pageBtn&&(this.pageBtn.destroy(),this.pageBtn=void 0),this.webBtn&&(this.webBtn.destroy(),this.webBtn=void 0)},iv.prototype.removeHTMLDom=function(){this.pageNumDiv.remove(),this.statusBarDiv.remove(),this.pageCount.remove(),this.pageLabel.remove(),this.pageNumberInput.remove(),this.editablePageNumber.remove(),this.ofLabel.remove(),this.zoomBtn.remove(),this.pageButton.remove(),this.webButton.remove(),_.isNullOrUndefined(this.verticalLine)||this.verticalLine.remove(),_.isNullOrUndefined(this.spellCheckBtn)||this.spellCheckBtn.remove()};var tv=iv;function iv(e,t){this.startPage=1,this.onPageLayoutClickHandler=this.onPageLayoutClick.bind(this),this.onWebLayoutClickHandler=this.onWebLayoutClick.bind(this),this.onPageNumberKeyDownHandler=this.onPageNumberKeyDown.bind(this),this.onPageNumberKeyUpHandler=this.onPageNumberKeyUp.bind(this),this.onPageNumberBlurHandler=this.onPageNumberBlur.bind(this),this.onPageNumberFocusHandler=this.onPageNumberFocus.bind(this),this.statusBarDiv=e,this.container=t,this.initializeStatusBar(),this.wireEvents()}nv=function(e,t){return(nv=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}))(e,t)};var nv,rv,ov=function(e,t){function i(){this.constructor=e}nv(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},sv=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;0<=a;a--)(r=e[a])&&(s=(o<3?r(s):3<o?r(t,i,s):r(t,i))||s);return 3<o&&s&&Object.defineProperty(t,i,s),s},ov=(rv=_.Component,ov(g,rv),Object.defineProperty(g.prototype,"documentEditor",{get:function(){return this.documentEditorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"toolbar",{get:function(){return this.toolbarModule},enumerable:!0,configurable:!0}),g.prototype.getModuleName=function(){return"DocumentEditorContainer"},g.prototype.onPropertyChanged=function(e,t){for(var i,n=0,r=Object.keys(e);n<r.length;n++)switch(r[n]){case"restrictEditing":this.restrictEditingToggleHelper(e.restrictEditing);break;case"showPropertiesPane":this.showHidePropertiesPane(e.showPropertiesPane);break;case"enableTrackChanges":this.documentEditor.documentHelper.isTrackedOnlyMode&&!e.enableTrackChanges&&e.enableTrackChanges!==this.enableTrackChanges&&(this.enableTrackChanges=!0),this.documentEditor&&(this.documentEditor.enableTrackChanges=e.enableTrackChanges,this.toolbarModule&&this.toolbarModule.toggleTrackChanges(e.enableTrackChanges),this.documentEditor.enableTrackChanges&&(this.documentEditor.documentHelper.showRevision=!0),this.documentEditor.resize());break;case"enableLocalPaste":this.documentEditor&&(this.documentEditor.enableLocalPaste=e.enableLocalPaste);break;case"serviceUrl":this.documentEditor&&(this.documentEditor.serviceUrl=e.serviceUrl);break;case"serverActionSettings":this.documentEditor&&this.setserverActionSettings();break;case"zIndex":this.documentEditor&&(this.documentEditor.zIndex=e.zIndex);break;case"headers":this.documentEditor&&(this.documentEditor.headers=e.headers);break;case"locale":case"enableRtl":this.refresh();break;case"enableComment":this.documentEditor&&(this.documentEditor.enableComment=e.enableComment),this.toolbarModule&&this.toolbarModule.enableDisableInsertComment(e.enableComment);break;case"enableSpellCheck":this.documentEditor&&(this.documentEditor.enableSpellCheck=e.enableSpellCheck);break;case"documentSettings":this.documentEditor&&(this.documentEditor.documentSettings.compatibilityMode=this.documentSettings.compatibilityMode);break;case"documentEditorSettings":this.documentEditor&&this.customizeDocumentEditorSettings(),_.isNullOrUndefined(e.documentEditorSettings.fontFamilies)||(i=e.documentEditorSettings.fontFamilies,this.refreshFontFamilies(i));break;case"toolbarItems":this.toolbarModule&&this.toolbarModule.reInitToolbarItems(e.toolbarItems);break;case"currentUser":this.documentEditor&&(this.documentEditor.currentUser=e.currentUser);break;case"userColor":this.documentEditor&&(this.documentEditor.userColor=e.userColor);break;case"layoutType":this.documentEditor&&(this.documentEditor.layoutType=e.layoutType,"Continuous"===e.layoutType?this.statusBar.togglePageLayout():this.statusBar.toggleWebLayout());break;case"enableToolbar":this.createToolbarContainer(this.enableRtl,!0),e.enableToolbar&&this.toolbarModule&&(this.toolbarModule.initToolBar(this.toolbarItems),this.toolbarModule.enableDisableInsertComment(this.enableComment),this.toolbarModule.toggleTrackChanges(this.enableTrackChanges)),this.documentEditor&&this.documentEditor.resize();break;case"height":this.element.style.height=_.formatUnit(this.height),this.documentEditor&&this.documentEditor.resize(),this.resize();break;case"width":this.element.style.width=_.formatUnit(this.width),this.documentEditor&&this.documentEditor.resize();break;case"enableAutoFocus":this.documentEditor&&(this.documentEditor.enableAutoFocus=e.enableAutoFocus);break;case"autoResizeOnVisibilityChange":this.documentEditor&&(this.documentEditor.autoResizeOnVisibilityChange=e.autoResizeOnVisibilityChange)}},g.prototype.preRender=function(){this.localObj=new _.L10n("documenteditorcontainer",this.defaultLocale,this.locale),_.isNullOrUndefined(this.element)||""!==this.element.id||(this.element.id=j.getUniqueElementId()),this.initContainerElement()},g.prototype.render=function(){this.toolbarModule&&(this.toolbarModule.initToolBar(this.toolbarItems),this.toolbarModule.enableDisableInsertComment(this.enableComment)),""!==this.height&&(this.element.style.height=_.formatUnit(this.height)),""!==this.width&&(this.element.style.width=_.formatUnit(this.width)),this.element.style.minHeight="320px",this.initializeDocumentEditor(),this.restrictEditing&&this.restrictEditingToggleHelper(this.restrictEditing),this.headerFooterProperties=new Vy(this,this.enableRtl),this.imageProperties=new qy(this,this.enableRtl),this.tocProperties=new jy(this,this.enableRtl),this.tableProperties=new $y(this,this.imageProperties,this.enableRtl),this.statusBar=new tv(this.statusBarElement,this),C.createSpinner({target:this.containerTarget,cssClass:"e-spin-overlay"}),this.setserverActionSettings(),this.renderComplete()},g.prototype.restrictEditingToggleHelper=function(e){this.documentEditor.isReadOnly=e,this.toolbarModule&&(this.toolbarModule.enableDisableToolBarItem(!e,!1),this.toolbarModule.toggleRestrictEditing(e)),this.showPropertiesPane=!e,this.showHidePropertiesPane(!e),this.documentEditor.trackChangesPane.enableDisableButton(!e&&!this.documentEditor.documentHelper.isDocumentProtected)},g.prototype.setFormat=function(){this.characterFormat&&this.documentEditor&&this.documentEditor.setDefaultCharacterFormat(this.characterFormat),this.paragraphFormat&&this.documentEditor&&this.documentEditor.setDefaultParagraphFormat(this.paragraphFormat),this.sectionFormat&&this.documentEditor&&this.documentEditor.setDefaultSectionFormat(this.sectionFormat)},g.prototype.setserverActionSettings=function(){this.serviceUrl&&(this.documentEditor.serviceUrl=j.sanitizeString(this.serviceUrl)),this.serverActionSettings.spellCheck&&(this.documentEditor.serverActionSettings.spellCheck=j.sanitizeString(this.serverActionSettings.spellCheck)),this.serverActionSettings.spellCheckByPage&&(this.documentEditor.serverActionSettings.spellCheckByPage=j.sanitizeString(this.serverActionSettings.spellCheckByPage)),this.serverActionSettings.restrictEditing&&(this.documentEditor.serverActionSettings.restrictEditing=j.sanitizeString(this.serverActionSettings.restrictEditing)),this.serverActionSettings.systemClipboard&&(this.documentEditor.serverActionSettings.systemClipboard=j.sanitizeString(this.serverActionSettings.systemClipboard)),this.serverActionSettings.import&&(this.documentEditor.serverActionSettingsImport=j.sanitizeString(this.serverActionSettings.import)),this.headers&&(this.documentEditor.headers=JSON.parse(j.sanitizeString(JSON.stringify(this.headers))))},g.prototype.customizeDocumentEditorSettings=function(){var e,t;this.documentEditorSettings.formFieldSettings&&(e=this.documentEditorSettings.formFieldSettings,t=this.documentEditor,_.isNullOrUndefined(e.applyShading)||(t.documentEditorSettings.formFieldSettings.applyShading=e.applyShading),_.isNullOrUndefined(e.formFillingMode)||(t.documentEditorSettings.formFieldSettings.formFillingMode=e.formFillingMode),_.isNullOrUndefined(e.formattingExceptions)||(t.documentEditorSettings.formFieldSettings.formattingExceptions=e.formattingExceptions),_.isNullOrUndefined(e.selectionColor)||(t.documentEditorSettings.formFieldSettings.selectionColor=e.selectionColor),_.isNullOrUndefined(e.shadingColor)||(t.documentEditorSettings.formFieldSettings.shadingColor=e.shadingColor)),this.documentEditorSettings.searchHighlightColor&&(this.documentEditor.documentEditorSettings.searchHighlightColor=j.sanitizeString(this.documentEditorSettings.searchHighlightColor)),this.documentEditorSettings.fontFamilies&&(this.documentEditor.documentEditorSettings.fontFamilies=JSON.parse(j.sanitizeString(JSON.stringify(this.documentEditorSettings.fontFamilies)))),this.documentEditorSettings.collaborativeEditingSettings&&(this.documentEditor.documentEditorSettings.collaborativeEditingSettings=this.documentEditorSettings.collaborativeEditingSettings),this.documentEditorSettings.printDevicePixelRatio&&(this.documentEditor.documentEditorSettings.printDevicePixelRatio=this.documentEditorSettings.printDevicePixelRatio),_.isNullOrUndefined(this.documentEditorSettings.enableOptimizedTextMeasuring)||(this.documentEditor.documentEditorSettings.enableOptimizedTextMeasuring=this.documentEditorSettings.enableOptimizedTextMeasuring),_.isNullOrUndefined(this.documentEditorSettings.maximumRows)||(this.documentEditor.documentEditorSettings.maximumRows=this.documentEditorSettings.maximumRows),_.isNullOrUndefined(this.documentEditorSettings.maximumColumns)||(this.documentEditor.documentEditorSettings.maximumColumns=this.documentEditorSettings.maximumColumns),_.isNullOrUndefined(this.documentEditorSettings.showHiddenMarks)||(this.documentEditor.documentEditorSettings.showHiddenMarks=this.documentEditorSettings.showHiddenMarks),_.isNullOrUndefined(this.documentEditorSettings.showBookmarks)||(this.documentEditor.documentEditorSettings.showBookmarks=this.documentEditorSettings.showBookmarks),_.isNullOrUndefined(this.documentEditorSettings.highlightEditableRanges)||(this.documentEditor.documentEditorSettings.highlightEditableRanges=this.documentEditorSettings.highlightEditableRanges),_.isNullOrUndefined(this.documentEditorSettings.allowDragAndDrop)||(this.documentEditor.documentEditorSettings.allowDragAndDrop=this.documentEditorSettings.allowDragAndDrop),_.isNullOrUndefined(this.documentEditorSettings.optimizeSfdt)||(this.documentEditor.documentEditorSettings.optimizeSfdt=this.documentEditorSettings.optimizeSfdt),_.isNullOrUndefined(this.documentEditorSettings.autoResizeSettings)||(this.documentEditor.documentEditorSettings.autoResizeSettings=this.documentEditorSettings.autoResizeSettings),_.isNullOrUndefined(this.documentEditorSettings.showRuler)||(this.documentEditor.documentEditorSettings.showRuler=this.documentEditorSettings.showRuler),_.isNullOrUndefined(this.documentEditorSettings.colorPickerSettings)||(this.documentEditor.documentEditorSettings.colorPickerSettings=this.documentEditorSettings.colorPickerSettings),_.isNullOrUndefined(this.documentEditorSettings.popupTarget)||(this.documentEditor.documentEditorSettings.popupTarget=this.documentEditorSettings.popupTarget),_.isNullOrUndefined(this.documentEditorSettings.showNavigationPane)||(this.documentEditor.documentEditorSettings.showNavigationPane=this.documentEditorSettings.showNavigationPane),_.isNullOrUndefined(this.documentEditorSettings.mentionSettings)||(this.documentEditor.documentEditorSettings.mentionSettings=this.documentEditorSettings.mentionSettings)},g.prototype.getPersistData=function(){return"documenteditor-container"},g.prototype.requiredModules=function(){var e=[];return this.enableToolbar&&e.push({member:"toolbar",args:[this]}),e},g.prototype.initContainerElement=function(){var e=this.enableRtl;this.containerTarget=this.createElement("div",{className:"e-de-ctn"}),this.containerTarget.contentEditable="false",this.createToolbarContainer(e),this.propertiesPaneContainer=this.createElement("div",{className:e?"e-de-pane-rtl":"e-de-pane",styles:"display:none"}),this.editorContainer.appendChild(this.propertiesPaneContainer),this.containerTarget.appendChild(this.editorContainer),this.statusBarElement=this.createElement("div",{className:"e-de-status-bar"}),e&&(this.statusBarElement.style.direction="rtl"),this.containerTarget.appendChild(this.statusBarElement),this.element.appendChild(this.containerTarget)},g.prototype.createToolbarContainer=function(e,t){_.isNullOrUndefined(this.editorContainer)&&(this.editorContainer=this.createElement("div",{className:"e-de-tool-ctnr-properties-pane"+(e?" e-de-ctnr-rtl":"")})),this.enableToolbar?(this.toolbarContainer=this.createElement("div",{className:"e-de-ctnr-toolbar"+(e?" e-de-ctnr-rtl":"")}),t?this.containerTarget.insertBefore(this.toolbarContainer,this.containerTarget.firstChild):this.containerTarget.appendChild(this.toolbarContainer),this.editorContainer.classList.remove("e-de-ctnr-properties-pane"),this.editorContainer.classList.add("e-de-tool-ctnr-properties-pane")):(this.editorContainer.classList.remove("e-de-tool-ctnr-properties-pane"),this.editorContainer.classList.add("e-de-ctnr-properties-pane"))},g.prototype.initializeDocumentEditor=function(){var e=this.element.id+"_editor",e=this.createElement("div",{id:e,styles:"width:100%;height:100%"});this.documentEditorInternal=new Rf({isReadOnly:!1,enableRtl:this.enableRtl,selectionChange:this.onSelectionChange.bind(this),contentChange:this.onContentChange.bind(this),documentChange:this.onDocumentChange.bind(this),requestNavigate:this.onRequestNavigate.bind(this),viewChange:this.onViewChange.bind(this),customContextMenuSelect:this.onCustomContextMenuSelect.bind(this),customContextMenuBeforeOpen:this.onCustomContextMenuBeforeOpen.bind(this),beforePaneSwitch:this.onBeforePaneSwitch.bind(this),commentBegin:this.onCommentBegin.bind(this),commentEnd:this.onCommentEnd.bind(this),commentDelete:this.onCommentDelete.bind(this),beforeAcceptRejectChanges:this.onBeforeAcceptRejectChanges.bind(this),beforeCommentAction:this.onCommentAction.bind(this),trackChange:this.onTrackChange.bind(this),serviceFailure:this.fireServiceFailure.bind(this),beforeXmlHttpRequestSend:this.beforeXmlHttpSend.bind(this),locale:this.locale,acceptTab:!0,zIndex:this.zIndex,enableLocalPaste:this.enableLocalPaste,layoutType:this.layoutType,pageOutline:"#E0E0E0",currentUser:this.currentUser,userColor:this.userColor,height:"100%",width:"100%",enableTrackChanges:this.enableTrackChanges,showRevisions:!0,showComments:!0,enableLockAndEdit:this.enableLockAndEdit,enableAutoFocus:this.enableAutoFocus}),this.wireEvents(),this.customizeDocumentEditorSettings(),this.documentEditor.enableAllModules(),this.documentEditor.enableComment=this.enableComment,this.editorContainer.insertBefore(e,this.editorContainer.firstChild),this.setFormat(),this.documentEditor.appendTo(e),this.documentEditor.resize()},g.prototype.wireEvents=function(){window.addEventListener("resize",this.onWindowResize.bind(this)),this.documentEditor.on($,this.onZoomFactorChange,this),this.documentEditor.on(Pe,this.onViewChange,this),this.documentEditor.on(Se,this.showPropertiesPaneOnSelection,this),this.documentEditor.on(He,this.updateShowHiddenMarks,this),this.documentEditor.on(Ne,this.updateStyleCollection,this),this.documentEditor.on(Oe,this.triggerAutoResize,this),this.documentEditor.on(Ee,this.onBeforeAutoResize,this),this.documentEditor.on(Le,this.onEnableTrackChanges,this),this.documentEditor.on(Be,this.onOptionPaneChange,this)},g.prototype.onWindowResize=function(){_.isNullOrUndefined(this.documentEditor)||(this.documentEditor.isContainerResize=!0,this.resize())},g.prototype.onOptionPaneChange=function(e){},g.prototype.onEnableTrackChanges=function(e){e.enableTrackChanges!==this.enableTrackChanges&&(this.enableTrackChanges=e.enableTrackChanges)},g.prototype.triggerAutoResize=function(e){e.cancel=!0,this.resize()},g.prototype.onBeforeAutoResize=function(e){e.element=this.element},g.prototype.unWireEvents=function(){_.isNullOrUndefined(this.documentEditor)||this.documentEditor.isDestroyed||(this.documentEditor.off($,this.onZoomFactorChange),this.documentEditor.off(Pe,this.onViewChange),this.documentEditor.off(Se,this.showPropertiesPaneOnSelection),this.documentEditor.off(He,this.updateShowHiddenMarks),this.documentEditor.off(Ne,this.updateStyleCollection))},g.prototype.onCommentBegin=function(){this.toolbarModule&&this.toolbarModule.enableDisableInsertComment(!1)},g.prototype.onCommentEnd=function(){this.toolbarModule&&this.toolbarModule.enableDisableInsertComment(this.enableComment)},g.prototype.beforeXmlHttpSend=function(e){this.trigger(Te,e)},g.prototype.onCommentDelete=function(e){this.trigger(fe,e)},g.prototype.onBeforeAcceptRejectChanges=function(e){this.trigger(ye,e)},g.prototype.onCommentAction=function(e){this.trigger(me,e)},g.prototype.onTrackChange=function(e){this.trigger(xe,e),this.toolbarModule&&this.toolbarModule.toggleTrackChanges(e.isTrackChangesEnabled)},g.prototype.onBeforePaneSwitch=function(e){this.trigger(ve,e)},g.prototype.fireServiceFailure=function(e){this.trigger(le,e)},g.prototype.showHidePropertiesPane=function(e){this.showPropertiesPane&&this.showPropertiesPaneOnSelection(),this.propertiesPaneContainer.style.display=e?"block":"none",this.toolbarModule&&(this.toolbarModule.propertiesPaneButton.element.style.opacity=e?"1":"0.5"),this.documentEditor.resize()},g.prototype.updateStyleCollection=function(){_.isNullOrUndefined(this.tableProperties)||_.isNullOrUndefined(this.tableProperties.tableTextProperties)||_.isNullOrUndefined(this.tableProperties.tableTextProperties.paragraph)||this.tableProperties.tableTextProperties.paragraph.updateStyleNames()},g.prototype.resize=function(e,t){this.element&&(this.documentEditor.isContainerResize||(_.isNullOrUndefined(t)&&this.element&&this.element.parentElement&&(t=this.element.parentElement.clientHeight),_.isNullOrUndefined(e)&&this.element&&this.element.parentElement&&(e=this.element.parentElement.clientWidth),!_.isNullOrUndefined(e)&&200<e&&(this.width=e.toString(),this.element.style.width=e+"px"),!_.isNullOrUndefined(t)&&200<t&&(this.height=t.toString(),this.element.style.height=t+"px")),this.documentEditor&&this.documentEditor.resize(),this.toolbarModule&&this.toolbarModule.toolbar.refreshOverflow(),this.showPropertiesPane)&&this.tableProperties.updateTabContainerHeight()},g.prototype.refreshFontFamilies=function(e){if(!_.isNullOrUndefined(this.tableProperties)&&!_.isNullOrUndefined(this.tableProperties.tableTextProperties)&&!_.isNullOrUndefined(this.tableProperties.tableTextProperties.text)){var t=this.tableProperties.tableTextProperties.text;t.fontFamily.refresh();for(var i=0;i<e.length;i++){var n=e[i];t.fontFamily.addItem({FontName:n,FontValue:n},i)}}},g.prototype.onContentChange=function(e){this.toolbarModule&&this.toolbarModule.enableDisableUndoRedo(),this.statusBar&&this.statusBar.updatePageCount();e={source:this,operations:e.operations};this.trigger(ee,e)},g.prototype.onDocumentChange=function(){this.enableTrackChanges=this.documentEditor.enableTrackChanges,_.isNullOrUndefined(this.documentSettings)||_.isNullOrUndefined(this.documentEditor)||_.isNullOrUndefined(this.documentEditor.documentSettings)||(this.documentSettings.compatibilityMode=this.documentEditor.documentSettings.compatibilityMode),_.isNullOrUndefined(this.documentEditorSettings)||_.isNullOrUndefined(this.documentEditorSettings.fontFamilies)||(e=this.documentEditorSettings.fontFamilies,this.refreshFontFamilies(e)),this.toolbarModule&&(this.toolbarModule.isCommentEditing=!1,this.toolbarModule.enableDisableInsertComment(!0),this.toolbarModule.enableDisableUndoRedo()),this.statusBar&&this.statusBar.updatePageCount(),0<this.documentEditor.documentHelper.contentControlCollection.length&&(this.documentEditor.selection.isHighlightContentControlEditRegion=!0,this.documentEditor.selection.onHighlightContentControl());var e={source:this};this.trigger(te,e),this.updateStyleCollection()},g.prototype.onSelectionChange=function(){var t=this;setTimeout(function(){var e;_.isNullOrUndefined(t.documentEditor)||(t.showPropertiesPaneOnSelection(),e={source:t,isCompleted:t.documentEditor.documentHelper.isSelectionCompleted},t.trigger(ie,e),t.documentEditor.documentHelper.isSelectionCompleted=!0)})},g.prototype.onZoomFactorChange=function(){this.statusBar&&this.statusBar.updateZoomContent()},g.prototype.updateShowHiddenMarks=function(e){this.documentEditorSettings.showHiddenMarks=e.showHiddenMarks,this.tableProperties.tableTextProperties.paragraph.toggleHiddenMarks()},g.prototype.onRequestNavigate=function(e){var t,i;"Bookmark"!==e.linkType&&(t=e.navigationLink,i=_.SanitizeHtmlHelper.sanitize(t),0<e.localReference.length&&(i+="#"+e.localReference),"file:///"===t.substring(0,8)||"http://"===t.substring(0,7)&&7<t.length||"https://"===t.substring(0,8)&&8<t.length||"www."===t.substring(0,4)&&4<t.length||"mailto:"===t.substring(0,7)&&7<t.length?window.open(i):C.DialogUtility.alert({title:this.localObj.getConstant("Information"),content:this.localObj.getConstant("The address of this site is not valid. Check the address and try again."),okButton:{text:this.localObj.getConstant("OK")},closeOnEscape:!0}),e.isHandled=!0)},g.prototype.onViewChange=function(e){this.statusBar&&this.statusBar.updatePageNumberOnViewChange(e)},g.prototype.onCustomContextMenuSelect=function(e){this.trigger(he,e)},g.prototype.onCustomContextMenuBeforeOpen=function(e){this.trigger(ce,e)},g.prototype.showPropertiesPaneOnSelection=function(){var e,t,i;this.restrictEditing&&!this.showPropertiesPane||_.isNullOrUndefined(this.tableProperties)||(t=(e="NoProtection"!==this.documentEditor.documentHelper.protectionType)&&this.documentEditor.documentHelper.restrictFormatting,i=this.documentEditor.editorModule.restrictEditing,e?(this.toolbarModule&&this.toolbarModule.enableDisableToolBarItem(!i,!0),this.tableProperties.enableDisableElements(!t&&!i),this.tocProperties.enableDisableElements(!i),this.headerFooterProperties.enableDisableElements(!i),this.imageProperties.enableDisableElements(!i)):(e=!this.documentEditor.isReadOnly,this.toolbarModule&&this.toolbarModule.enableDisableToolBarItem(e,!0),this.tableProperties.enableDisableElements(!0),this.tocProperties.enableDisableElements(!0),this.headerFooterProperties.enableDisableElements(!0),this.imageProperties.enableDisableElements(!0)),(i=0<=(t=this.documentEditor.selectionModule.contextType).indexOf("Header")||0<=t.indexOf("Footer"))||(this.showHeaderProperties=!0),this.showPropertiesPane?(this.propertiesPaneContainer.style.display="block",i&&this.showHeaderProperties?this.showProperties("headerfooter"):0<=t.indexOf("List")||0<=t.indexOf("Text")&&t.indexOf("Table")<0?this.showProperties("text"):0<=t.indexOf("Image")?this.showProperties("image"):0<=t.indexOf("TableOfContents")?this.showProperties("toc"):0<=t.indexOf("Table")&&this.showProperties("table")):(this.showHidePropertiesPane(!1),this.propertiesPaneContainer.style.display="none"),this.previousContext=this.documentEditor.selectionModule.contextType,this.toolbarModule&&this.toolbarModule.toolbar&&this.toolbarModule.enableDisableInsertComment(!this.documentEditor.enableHeaderAndFooter&&this.enableComment&&!this.documentEditor.isReadOnlyMode&&!this.documentEditor.selectionModule.isinFootnote&&!this.documentEditor.selectionModule.isinEndnote&&!this.documentEditor.selectionModule.isPlainContentControl()))},g.prototype.showProperties=function(e){this.toolbarModule&&"headerfooter"!==e&&"toc"!==e&&this.toolbarModule.enableDisablePropertyPaneButton(!0),this.tableProperties.showTableProperties("table"===e||"text"===e,e),this.imageProperties.showImageProperties("image"===e),this.headerFooterProperties.showHeaderFooterPane("headerfooter"===e),this.tocProperties.showTocPane("toc"===e)},g.prototype.setDefaultCharacterFormat=function(e){this.characterFormat=e,this.setFormat()},g.prototype.setDefaultParagraphFormat=function(e){this.paragraphFormat=e,this.setFormat()},g.prototype.setDefaultSectionFormat=function(e){this.sectionFormat=e,this.setFormat()},g.prototype.destroy=function(){rv.prototype.destroy.call(this),this.element&&(this.refreshing||this.element.classList.remove("e-documenteditorcontainer"),this.element.innerHTML=""),this.refreshing||(this.element=void 0,this.paragraphFormat=void 0,this.sectionFormat=void 0,this.characterFormat=void 0),this.toolbarContainer&&this.toolbarContainer.parentElement&&(this.toolbarContainer.innerHTML="",this.toolbarContainer.parentElement.removeChild(this.toolbarContainer)),this.toolbarContainer=void 0,this.documentEditorInternal&&(this.unWireEvents(),this.documentEditorInternal.destroy(),this.documentEditorInternal=void 0),this.headerFooterProperties&&this.headerFooterProperties.destroy(),this.headerFooterProperties=void 0,this.imageProperties&&this.imageProperties.destroy(),this.imageProperties=void 0,this.tocProperties&&this.tocProperties.destroy(),this.tocProperties=void 0,this.tableProperties&&this.tableProperties.destroy(),this.tableProperties=void 0,this.statusBar&&this.statusBar.destroy(),this.propertiesPaneContainer&&this.propertiesPaneContainer.parentElement&&this.propertiesPaneContainer.remove(),this.propertiesPaneContainer=void 0,this.editorContainer&&this.editorContainer.parentElement&&(this.editorContainer.innerHTML="",this.editorContainer.parentElement.removeChild(this.editorContainer)),this.statusBarElement&&this.statusBarElement.parentElement&&(this.statusBarElement.innerHTML="",this.statusBarElement.parentElement.removeChild(this.statusBarElement)),this.containerTarget&&this.containerTarget.parentElement&&(this.containerTarget.innerHTML="",this.containerTarget.parentElement.removeChild(this.containerTarget)),this.containerTarget=void 0,this.statusBarElement=void 0,this.editorContainer=void 0,this.statusBar=void 0,this.previousContext=void 0},sv([_.Property(!0)],g.prototype,"showPropertiesPane",void 0),sv([_.Property(!0)],g.prototype,"enableToolbar",void 0),sv([_.Property(!1)],g.prototype,"restrictEditing",void 0),sv([_.Property(!1)],g.prototype,"enableSpellCheck",void 0),sv([_.Property(!1)],g.prototype,"enableTrackChanges",void 0),sv([_.Property("Pages")],g.prototype,"layoutType",void 0),sv([_.Property("")],g.prototype,"currentUser",void 0),sv([_.Property("#FFFF00")],g.prototype,"userColor",void 0),sv([_.Property(!1)],g.prototype,"enableLocalPaste",void 0),sv([_.Property()],g.prototype,"serviceUrl",void 0),sv([_.Property(2e3)],g.prototype,"zIndex",void 0),sv([_.Property(!1)],g.prototype,"enableCsp",void 0),sv([_.Property(!0)],g.prototype,"enableComment",void 0),sv([_.Property("100%")],g.prototype,"width",void 0),sv([_.Property("320px")],g.prototype,"height",void 0),sv([_.Property(!0)],g.prototype,"enableAutoFocus",void 0),sv([_.Property(!1)],g.prototype,"enableLockAndEdit",void 0),sv([_.Property(!1)],g.prototype,"autoResizeOnVisibilityChange",void 0),sv([_.Event()],g.prototype,"created",void 0),sv([_.Event()],g.prototype,"destroyed",void 0),sv([_.Event()],g.prototype,"contentChange",void 0),sv([_.Event()],g.prototype,"selectionChange",void 0),sv([_.Event()],g.prototype,"documentChange",void 0),sv([_.Event()],g.prototype,"toolbarClick",void 0),sv([_.Event()],g.prototype,"customContextMenuSelect",void 0),sv([_.Event()],g.prototype,"customContextMenuBeforeOpen",void 0),sv([_.Event()],g.prototype,"beforePaneSwitch",void 0),sv([_.Event()],g.prototype,"commentDelete",void 0),sv([_.Event()],g.prototype,"beforeAcceptRejectChanges",void 0),sv([_.Event()],g.prototype,"beforeCommentAction",void 0),sv([_.Event()],g.prototype,"serviceFailure",void 0),sv([_.Event()],g.prototype,"trackChange",void 0),sv([_.Event()],g.prototype,"contentControl",void 0),sv([_.Event()],g.prototype,"beforeXmlHttpRequestSend",void 0),sv([_.Complex({},Pf)],g.prototype,"documentEditorSettings",void 0),sv([_.Complex({},Hf)],g.prototype,"documentSettings",void 0),sv([_.Property({import:"Import",systemClipboard:"SystemClipboard",spellCheck:"SpellCheck",spellCheckByPage:"SpellCheckByPage",restrictEditing:"RestrictEditing",canLock:"CanLock",getPendingActions:"GetPendingActions"})],g.prototype,"serverActionSettings",void 0),sv([_.Property(["New","Open","Separator","Undo","Redo","Separator","Image","Table","Hyperlink","Bookmark","TableOfContents","Separator","Header","Footer","PageSetup","PageNumber","Break","InsertFootnote","InsertEndnote","Separator","Find","Separator","Comments","TrackChanges","Separator","LocalClipboard","RestrictEditing","Separator","FormFields","UpdateFields","ContentControl","XML Mapping"])],g.prototype,"toolbarItems",void 0),sv([_.Property([])],g.prototype,"headers",void 0),sv([_.NotifyPropertyChanges],g));function g(e,t){e=rv.call(this,e,t)||this;return e.previousContext="",e.showHeaderProperties=!0,e.defaultLocale={New:"New","Insert Footnote":"Insert Footnote","Insert Endnote":"Insert Endnote","Footnote Tooltip":"Insert Footnote (Alt+Ctrl+F).","Endnote Tooltip":"Insert Endnote (Alt+Ctrl+D).",Open:"Open",Undo:"Undo",Redo:"Redo",Image:"Image",Table:"Table",Link:"Link",Bookmark:"Bookmark","Table of Contents":"Table of Contents","HEADING - - - - 1":"HEADING - - - - 1","HEADING - - - - 2":"HEADING - - - - 2","HEADING - - - - 3":"HEADING - - - - 3",Header:"Header",Footer:"Footer","XML Mapping Pane":"XML Mapping Pane","Page Setup":"Page Setup","Page Number":"Page Number",Break:"Break",Find:"Find","Local Clipboard":"Local Clipboard","Restrict Editing":"Restrict Editing","Upload from computer":"Upload from computer","By URL":"By URL",Page:"Page","Show properties pane":"Show properties pane","Hide properties pane":"Hide properties pane","Next Page":"Next Page",Continuous:"Continuous","Header And Footer":"Header & Footer",Options:"Options","XML Mapping":"XML Mapping","Custom XML Part:":"Custom XML Part:","Core Properties":"Core Properties",Levels:"Levels","Different First Page":"Different First Page","Different header and footer for odd and even pages":"Different header and footer for odd and even pages.","Different Odd And Even Pages":"Different Odd & Even Pages","Different header and footer for first page":"Different header and footer for first page.",Position:"Position","Header from Top":"Header from Top","Footer from Bottom":"Footer from Bottom","Distance from top of the page to top of the header":"Distance from top of the page to top of the header.","Distance from bottom of the page to bottom of the footer":"Distance from bottom of the page to bottom of the footer.","Aspect ratio":"Aspect ratio",W:"W",H:"H",Width:"Width",Height:"Height",Text:"Text",Paragraph:"Paragraph",Fill:"Fill","Fill color":"Fill color","Border Style":"Border Style","Outside borders":"Outside borders","All borders":"All borders","Inside borders":"Inside borders","Left border":"Left border","Inside vertical border":"Inside vertical border","Right border":"Right border","Top border":"Top border","Inside horizontal border":"Inside horizontal border","Bottom border":"Bottom border","Border color":"Border color","Border width":"Border width",Cell:"Cell","Merge cells":"Merge cells","Insert Or Delete":"Insert / Delete","Insert columns to the left":"Insert columns to the left","Insert columns to the right":"Insert columns to the right","Insert rows above":"Insert rows above","Insert rows below":"Insert rows below","Delete rows":"Delete rows","Delete columns":"Delete columns","Cell Margin":"Cell Margin",Top:"Top",Bottom:"Bottom",Left:"Left",Right:"Right","Align Text":"Align Text","Align top":"Align top","Align bottom":"Align bottom","Align center":"Align center","Number of heading or outline levels to be shown in table of contents":"Number of heading or outline levels to be shown in table of contents.","Show page numbers":"Show page numbers","Show page numbers in table of contents":"Show page numbers in table of contents.","Right align page numbers":"Right align page numbers","Right align page numbers in table of contents":"Right align page numbers in table of contents.","Use hyperlinks":"Use hyperlinks","Use hyperlinks instead of page numbers":"Use hyperlinks instead of page numbers.",Font:"Font","Font Size":"Font Size","Font color":"Font color","Text highlight color":"Text highlight color","Clear all formatting":"Clear all formatting","Bold Tooltip":"Bold (Ctrl+B)","Italic Tooltip":"Italic (Ctrl+I)","Underline Tooltip":"Underline (Ctrl+U)",Strikethrough:"Strikethrough","Superscript Tooltip":"Superscript (Ctrl+Shift++)","Subscript Tooltip":"Subscript (Ctrl+=)","Align left Tooltip":"Align left (Ctrl+L)","Center Tooltip":"Center (Ctrl+E)","Align right Tooltip":"Align right (Ctrl+R)","Justify Tooltip":"Justify (Ctrl+J)","Decrease indent":"Decrease indent","Increase indent":"Increase indent","Line spacing":"Line spacing",Bullets:"Bullets",Numbering:"Numbering",Styles:"Styles","Manage Styles":"Manage Styles",of:"of","Fit one page":"Fit one page","Spell Check":"Spell Check",Spelling:"Spelling","Underline errors":"Underline errors","Fit page width":"Fit page width",Update:"Update",Cancel:"Cancel",Insert:"Insert","No Border":"No Border","Create a new document":"Create a new document.","Open a document":"Open a document.","Undo Tooltip":"Undo the last operation (Ctrl+Z).","Redo Tooltip":"Redo the last operation (Ctrl+Y).","Insert inline picture from a file":"Insert inline picture from a file.","Insert a table into the document":"Insert a table into the document","Create Hyperlink":"Create a link in your document for quick access to web pages and files (Ctrl+K).","Insert a bookmark in a specific place in this document":"Insert a bookmark in a specific place in this document.","Provide an overview of your document by adding a table of contents":"Provide an overview of your document by adding a table of contents.","Add or edit the header":"Add or edit the header.","Add or edit the footer":"Add or edit the footer.","Open the page setup dialog":"Open the page setup dialog.","Content Control":"Content Control","Insert Content Control":"Insert Content Control","Add page numbers":"Add page numbers.","Find Text":"Find text in the document (Ctrl+F).","Toggle between the internal clipboard and system clipboard":"Toggle between the internal clipboard and system clipboard.</br>Access to system clipboard through script is denied due to browsers security policy. Instead, </br> 1. You can enable internal clipboard to cut, copy and paste within the component.</br> 2. You can use the keyboard shortcuts (Ctrl+X, Ctrl+C and Ctrl+V) to cut, copy and paste with system clipboard.","Current Page Number":"The current page number in the document. Click or tap to navigate specific page.","Read only":"Read only",Protections:"Protections","Error in establishing connection with web server":"Error in establishing connection with web server",Single:"Single",Double:"Double","New comment":"New comment",Comments:"Comments","Print layout":"Print layout","Web layout":"Web layout","Form Fields":"Form Fields","Text Form":"Text Form","Check Box":"Check Box",DropDown:"Drop-Down","Update Fields":"Update Fields","Update cross reference fields":"Update cross reference fields","Track Changes":"Keep track of the changes made in the document",TrackChanges:"Track Changes",AllCaps:"AllCaps","Change case Tooltip":"Change case",UPPERCASE:"UPPERCASE",SentenceCase:"Sentence case",Lowercase:"Lowercase",CapitalizeEachWord:"Capitalize each word",ToggleCase:"tOGGLE cASE","No color":"No color","Top margin":"Top margin","Bottom margin":"Bottom margin","Left margin":"Left margin","Right margin":"Right margin",Normal:"Normal",Heading:"Heading","Heading 1":"Heading 1","Heading 2":"Heading 2","Heading 3":"Heading 3","Heading 4":"Heading 4","Heading 5":"Heading 5","Heading 6":"Heading 6","Heading 7":"Heading 7","Heading 8":"Heading 8","Heading 9":"Heading 9",ZoomLevelTooltip:"Zoom level. Click or tap to open the Zoom options.",None:"None",Borders:"Borders","ShowHiddenMarks Tooltip":"Show the hidden characters like spaces, tab, paragraph marks, and breaks.(Ctrl + *)",Columns:"Columns",Column:"Column","Page Breaks":"Page Breaks","Section Breaks":"Section Breaks","Link to Previous":"Link to Previous","Link to PreviousTooltip":"Link this section with previous section header or footer","Alternate Text":"Alternate Text","The address of this site is not valid. Check the address and try again.":"The address of this site is not valid. Check the address and try again.",OK:"OK",Information:"Information","Rich Text Content Control":"Rich Text Content Control","Plain Text Content Control":"Plain Text Content Control","Picture Content Control":"Picture Content Control","Combo Box Content Control":"Combo Box Content Control","Drop-Down List Content Control":"Drop-Down List Content Control","Date Picker Content Control":"Date Picker Content Control","Check Box Content Control":"Check Box Content Control"},e}V.AddUserDialog=Yl,V.AutoResizeSettings=Of,V.Base64=ol,V.BaseHistoryInfo=Ug,V.BlockContainer=_d,V.BlockWidget=Qd,V.BodyWidget=z,V.BookmarkDialog=Eu,V.BookmarkElementBox=J,V.BordersAndShadingDialog=tg,V.BreakElementBox=Sp,V.BulletsAndNumberingDialog=Xu,V.CONTROL_CHARACTERS=L,V.CellFormatHistoryInfo=Dg,V.CellHistoryFormat=Rg,V.CellOptionsDialog=og,V.ChangesSingleView=cd,V.ChartArea=Rc,V.ChartCategory=Ac,V.ChartCategoryAxis=lp,V.ChartData=Uc,V.ChartDataFormat=ip,V.ChartDataLabels=Jc,V.ChartDataTable=hp,V.ChartElementBox=Lc,V.ChartErrorBar=Gc,V.ChartFill=rp,V.ChartLayout=sp,V.ChartLegend=zc,V.ChartSeries=_c,V.ChartSeriesFormat=Zc,V.ChartTitleArea=ep,V.ChartTrendLines=Qc,V.CheckBoxFormField=Fh,V.CheckBoxFormFieldDialog=cg,V.CheckBoxState=ec,V.CollaborativeEditing=pl,V.CollaborativeEditingHandler=nf,V.CollaborativeEditingSettings=_f,V.ColumnLayout=Ed,V.ColumnSizeInfo=Tp,V.ColumnsDialog=vg,V.Comment=I,V.CommentCharacterElementBox=up,V.CommentEditInfo=kp,V.CommentElementBox=fp,V.CommentPane=Fu,V.CommentReviewPane=Iu,V.CommentView=Tu,V.ContainerServerActionSettings=If,V.ContentControl=E,V.ContentControlListItems=Qh,V.ContentControlProperties=Jh,V.ContextMenu=xu,V.CustomXmlPart=rc,V.Dictionary=T,V.DocumentEditor=Rf,V.DocumentEditorContainer=ov,V.DocumentEditorSettings=Pf,V.DocumentHelper=kd,V.DocumentSettings=Hf,V.DropDownFormField=Sh,V.DropDownFormFieldDialog=mg,V.EditRangeEndElementBox=Sc,V.EditRangeStartElementBox=Wc,V.Editor=Yg,V.EditorHistory=jg,V.ElementBox=mh,V.EnforceProtectionDialog=$l,V.ErrorTextElementBox=Ah,V.FieldElementBox=Z,V.FieldTextElementBox=Vh,V.FillFormat=bc,V.FontDialog=Yu,V.FontScheme=md,V.FontSchemeStruct=yd,V.FootNoteWidget=q,V.Footnote=Oh,V.FootnoteElementBox=Bh,V.FootnoteEndnoteMarkerElementBox=Op,V.FormField=wh,V.FormFieldPopUp=od,V.FormFieldSettings=Vf,V.HeaderFooterWidget=Xd,V.HelperMethods=j,V.HistoryInfo=qg,V.HtmlExport=zm,V.Hyperlink=kg,V.HyperlinkDialog=Hu,V.ImageElementBox=Ic,V.ImageResizer=Qg,V.ImageResizingPoints=em,V.ImageSizeInfo=Pg,V.Layout=Ml,V.LayoutViewer=Fd,V.LineFormat=vc,V.LineWidget=uh,V.ListDialog=ju,V.ListTextElementBox=Y,V.MajorMinorFontScheme=ud,V.Margin=Dd,V.MentionDataEditInfo=Fp,V.ModifiedLevel=Sg,V.ModifiedParagraphFormat=Ng,V.Optimized=Km,V.OptionsPane=vm,V.Padding=Ad,V.Page=vp,V.PageLayoutViewer=Sd,V.PageSetupDialog=Mu,V.ParagraphDialog=Du,V.ParagraphWidget=G,V.Point=nl,V.Print=Ba,V.Rect=Rd,V.Regular=Xm,V.Renderer=Zl,V.RestrictEditing=nd,V.Revision=$a,V.RevisionCollection=tl,V.RowFormatHistoryInfo=Ag,V.RowHistoryFormat=Og,V.Search=fm,V.SearchWidgetInfo=lm,V.SelectedImageInfo=tm,V.Selection=_m,V.SelectionBorder=Cm,V.SelectionBorders=km,V.SelectionCellFormat=Lm,V.SelectionCharacterFormat=bm,V.SelectionColumnFormat=Um,V.SelectionHeaderFooter=Sm,V.SelectionImageFormat=Am,V.SelectionParagraphFormat=Pm,V.SelectionRowFormat=Rm,V.SelectionSectionFormat=Nm,V.SelectionTableFormat=Om,V.SelectionWidgetInfo=Cg,V.ServerActionSettings=Af,V.SfdtExport=tf,V.SfdtReader=Ym,V.ShapeBase=hc,V.ShapeCommon=ac,V.ShapeElementBox=uc,V.SpellCheckDialog=dg,V.SpellChecker=jm,V.StyleDialog=Ku,V.StylesDialog=ag,V.TabDialog=bg,V.TabElementBox=_h,V.TabStopListInfo=Np,V.TableCellWidget=N,V.TableDialog=Wu,V.TableFormatHistoryInfo=Mg,V.TableHistoryInfo=Lg,V.TableOfContentsDialog=Bu,V.TableOptionsDialog=ng,V.TablePosition=rh,V.TablePropertiesDialog=$u,V.TableResizer=Kg,V.TableRowWidget=dh,V.TableWidget=K,V.TextElementBox=X,V.TextExport=$m,V.TextFormField=Ch,V.TextFormFieldDialog=ug,V.TextFrame=fc,V.TextHelper=Bl,V.TextPosition=y,V.TextSearch=sm,V.TextSearchResult=hm,V.TextSearchResults=pm,V.Themes=wd,V.Toolbar=p,V.TrackChangesPane=dd,V.UnProtectDocumentDialog=td,V.WAbstractList=Hl,V.WBorder=Va,V.WBorders=qa,V.WCellFormat=Tl,V.WCharacterFormat=B,V.WCharacterStyle=fl,V.WColumn=Cp,V.WColumnFormat=Da,V.WLevelOverride=Wl,V.WList=Vu,V.WListFormat=ja,V.WListLevel=El,V.WParagraphFormat=Xa,V.WParagraphStyle=ul,V.WRowFormat=Ya,V.WSectionFormat=Ma,V.WShading=Il,V.WStyle=dl,V.WStyles=xl,V.WTabStop=Ka,V.WTableFormat=Fl,V.WTableHolder=bp,V.WTableStyle=wl,V.WUniqueFormat=O,V.WUniqueFormats=e,V.WebLayoutViewer=Wd,V.Widget=Vd,V.WordExport=Qm,V.WrapPosition=al,V.XmlHttpRequestHandler=A,V.XmlMapping=ic,V.XmlPane=rm,V.Zoom=Xl,V.abstractListIdProperty=Os,V.abstractListsProperty=Ve,V.actionCompleteEvent=be,V.afterFieldFillEvent=oe,V.afterFormFieldFillEvent=se,V.afterSpacingProperty=Zt,V.afterWidthProperty=["afterWidth","aw"],V.alignTablesRowByRowProperty=tt,V.allCapsProperty=Lt,V.allowAutoFitProperty=ji,V.allowBreakAcrossPagesProperty=Ri,V.allowOverlapProperty=as,V.allowSpaceOfSameStyleInTableProperty=ba,V.alternativeTextProperty=cr,V.appearanceProperty=va,V.authorProperty=co,V.autoShapeTypeProperty=Nr,V.backgroundColorProperty=$i,V.backgroundProperty=ze,V.backwardProperty=Pn,V.basedOnProperty=ht,V.baselineAlignmentProperty=bt,V.bdoProperty=St,V.beforeAutoResize=Ee,V.beforeCommentActionEvent=me,V.beforeFieldFillEvent=re,V.beforeFileOpenEvent=Fe,V.beforeFormFieldFillEvent=ae,V.beforePaneSwitchEvent=ve,V.beforeSpacingProperty=Xt,V.beforeWidthProperty=["beforeWidth","bw"],V.beforeXmlHttpRequestSend=Te,V.belowTextProperty=ur,V.bidiProperty=Tt,V.blocksProperty=S,V.boldBidiProperty=Ot,V.boldProperty=ft,V.bookmarkTypeProperty=Us,V.bordersProperty=si,V.bottomMarginProperty=yi,V.bottomProperty=Ur,V.breakClearTypeProperty=Ht,V.breakCodeProperty=Wi,V.categoryTypeProperty=Xn,V.categoryXNameProperty=gn,V.cellFormatProperty=Qo,V.cellSpacingProperty=Gi,V.cellWidthProperty=Oi,V.cellsProperty=es,V.characterFormatProperty=Ae,V.characterSpacingProperty=Vt,V.chartAreaProperty=Qn,V.chartCategoryProperty=Jn,V.chartDataProperty=un,V.chartDataTableProperty=lr,V.chartLegendProperty=tr,V.chartPrimaryCategoryAxisProperty=ir,V.chartPrimaryValueAxisProperty=nr,V.chartSeriesProperty=Yn,V.chartTitleAreaProperty=$n,V.chartTitleProperty=rr,V.chartTypeProperty=or,V.checkBoxProperty=Qr,V.checkedProperty=oo,V.checkedStateProperty=Do,V.colorProperty=Or,V.columnCountProperty=Wa,V.columnFirstProperty=Ks,V.columnIndexProperty=Fa,V.columnLastProperty=Zs,V.columnSpanProperty=Ei,V.columnsProperty=Ti,V.commentBeginEvent=ue,V.commentCharacterTypeProperty=ho,V.commentDeleteEvent=fe,V.commentEndEvent=ge,V.commentIdProperty=lo,V.commentsProperty=_e,V.compatibilityModeProperty=st,V.complexScriptProperty=Bt,V.contentChangeEvent=ee,V.contentControlEvent=pe,V.contentControlListItemsProperty=Uo,V.contentControlPropertiesProperty=Fo,V.contextualSpacingProperty=oi,V.continuationNoticeProperty=Ds,V.continuationSeparatorProperty=As,V.cryptAlgorithmClassProperty=["cryptAlgorithmClass","cac"],V.cryptAlgorithmSidProperty=["cryptAlgorithmSid","cas"],V.cryptAlgorithmTypeProperty=["cryptAlgorithmType","cat"],V.cryptProviderTypeProperty=["cryptProviderType","cpt"],V.cryptSpinCountProperty=["cryptSpinCount","csc"],V.customContextMenuBeforeOpenEvent=ce,V.customContextMenuSelectEvent=he,V.customMarkerProperty=Io,V.customXmlPartProperty=Jo,V.customXmlProperty=Ge,V.dataFormatProperty=cn,V.dataLabelProperty=Wn,V.dataPointsProperty=Bn,V.dateCalendarTypeProperty=Eo,V.dateDisplayFormatProperty=Ro,V.dateDisplayLocaleProperty=Bo,V.dateProperty=uo,V.dateStorageFormatProperty=Lo,V.defaultFont=We,V.defaultTabWidthProperty=Ke,V.defaultValueProperty=to,V.deletePositionProperty=_s,V.descriptionProperty=is,V.diagonalDownProperty=an,V.diagonalUpProperty=sn,V.differentFirstPageProperty=hi,V.differentOddAndEvenPagesProperty=ci,V.directionProperty=wn,V.displayTextProperty=_o,V.distanceBottomProperty=cs,V.distanceLeftProperty=hs,V.distanceRightProperty=ds,V.distanceTopProperty=ls,V.doNotUseHTMLParagraphAutoSpacingProperty=et,V.documentChangeEvent=te,V.doneProperty=go,V.dropDownItemsProperty=so,V.dropDownListProperty=$r,V.editRangeIdProperty=Gs,V.editableRangeStartProperty=Ys,V.editingPointsProperty=La,V.enabledProperty=Zr,V.endStyleProperty=bn,V.endnoteNumberFormatProperty=bi,V.endnotesProperty=ot,V.enforcementProperty=Ye,V.equalWidthProperty=Hi,V.errorBarProperty=On,V.evenFooterProperty=bs,V.evenHeaderProperty=ws,V.fieldTypeProperty=Kr,V.fillFormatProperty=br,V.fillProperty=Er,V.firstLineIndentProperty=Gt,V.firstPageFooterProperty=Cs,V.firstPageHeaderProperty=xs,V.firstSliceAngleProperty=Rn,V.followCharacterProperty=Ps,V.fontColorProperty=kt,V.fontFamilyAsciiProperty=Rt,V.fontFamilyBidiProperty=Wt,V.fontFamilyFarEastProperty=Mt,V.fontFamilyNonFarEastProperty=At,V.fontFamilyProperty=Ft,V.fontNameProperty=Ia,V.fontProperty=zo,V.fontSchemeListProperty=na,V.fontSchemeNameProperty=ea,V.fontSchemeProperty=$s,V.fontSizeBidiProperty=Nt,V.fontSizeProperty=It,V.fontSubstitutionTableProperty=Me,V.fontTypefaceProperty=ra,V.footNoteNumberFormatProperty=xi,V.footerDistanceProperty=di,V.footerProperty=vs,V.footnoteTypeProperty=bo,V.footnotesProperty=rt,V.foreColorProperty=fn,V.foregroundColorProperty=en,V.formFieldDataProperty=Gr,V.formFieldShadingProperty=it,V.formatProperty=io,V.formattingProperty=Ze,V.forwardProperty=Fn,V.gapWidthProperty=sr,V.getImageHeightProperty=qr,V.getImageWidthProperty=_r,V.gridAfterProperty=zi,V.gridAfterWidthProperty=qi,V.gridAfterWidthTypeProperty=_i,V.gridBeforeProperty=Di,V.gridBeforeWidthProperty=Ui,V.gridBeforeWidthTypeProperty=Vi,V.gridProperty=Na,V.groupProperty=Js,V.hasBordersProperty=Zn,V.hasFieldEndProperty=jr,V.hasHorizontalBorderProperty=Gn,V.hasMajorGridLinesProperty=pa,V.hasMinorGridLinesProperty=ua,V.hasNoneStyleProperty=nn,V.hasPlaceHolderTextProperty=No,V.hasVerticalBorderProperty=Kn,V.hashValueProperty=Qe,V.headerDistanceProperty=li,V.headerProperty=ys,V.headersFootersProperty=Is,V.heightProperty=fr,V.heightRelativePercentProperty=Fr,V.heightScaleProperty=vr,V.heightTypeProperty=Ai,V.helpTextProperty=Xr,V.highlightColorProperty=Ct,V.holeSizeProperty=Mn,V.horizontalAlignmentProperty=ms,V.horizontalOriginProperty=gs,V.horizontalPositionAbsProperty=Yi,V.horizontalPositionProperty=fs,V.horizontalProperty=on,V.horizontalRelativePercentProperty=kr,V.horizontalRuleProperty=gr,V.idProperty=Yo,V.imageStringProperty=Br,V.imagesProperty=Pa,V.incrementalOps=Ea,V.initialEndNoteNumberProperty=Fi,V.initialFootNoteNumberProperty=ki,V.initialProperty=po,V.inlineFormatProperty=Ca,V.inlinesProperty=ko,V.interceptProperty=Tn,V.internalAutoResize=Oe,V.internalDocumentEditorSettingsChange=He,V.internalOptionPaneChange=Be,V.internalStyleCollectionChange=Ne,V.internalZoomFactorChange=$,V.internalviewChangeEvent=Pe,V.isAfterCellMarkProperty=Sa,V.isAfterParagraphMarkProperty=Ta,V.isAfterRowMarkProperty=Ha,V.isAfterTableMarkProperty=Oa,V.isAutoMajorProperty=da,V.isBubbleSizeProperty=Dn,V.isCategoryNameProperty=Un,V.isCheckedProperty=Mo,V.isCompressedProperty=ka,V.isCreatedUsingHtmlSpanTagProperty=["isCreatedUsingHtmlSpanTag","ishst"],V.isDisplayEquationProperty=Hn,V.isDisplayRSquaredProperty=Sn,V.isHeaderProperty=Mi,V.isInlineImageProperty=Mr,V.isLeaderLinesProperty=_n,V.isLegalStyleNumberingProperty=rs,V.isLegendKeyProperty=An,V.isMappedProperty=jo,V.isMetaFileProperty=Ar,V.isPercentageProperty=qn,V.isSeriesNameProperty=Vn,V.isTemporaryProperty=Oo,V.isValueProperty=zn,V.isWordMlProperty=Go,V.italicBidiProperty=Et,V.italicProperty=yt,V.itemIDProperty=vo,V.keepLinesTogetherProperty=ni,V.keepWithNextProperty=ti,V.keyDownEvent=Ie,V.lastParagraphMarkCopiedProperty=nt,V.layoutInCellProperty=Sr,V.layoutProperty=hn,V.layoutXProperty=yn,V.layoutYProperty=vn,V.leaderProperty=["leader","l"],V.leftIndentProperty=_t,V.leftMarginProperty=gi,V.leftProperty=zr,V.lengthProperty=["length","l"],V.levelNumberProperty=Hs,V.levelOverridesProperty=Rs,V.levelsProperty=Ls,V.lineBetweenColumnsProperty=Ni,V.lineFormatProperty=wr,V.lineFormatTypeProperty=wa,V.lineProperty=mn,V.lineSpacingProperty=Qt,V.lineSpacingTypeProperty=$t,V.lineStyleProperty=ln,V.lineWidthProperty=dn,V.linkProperty=pt,V.listFormatProperty=ei,V.listIdProperty=Ut,V.listLevelNumberProperty=qt,V.listLevelPatternProperty=Fs,V.listsProperty=Ue,V.localeIdBidiProperty=mt,V.localeIdFarEastProperty=gt,V.localeIdProperty=ut,V.lockAnchorProperty=Hr,V.lockContentControlProperty=Po,V.lockContentsProperty=To,V.majorFontSchemeProperty=ta,V.majorTickMarkProperty=ga,V.majorUnitProperty=la,V.markerColorProperty=In,V.markerSizeProperty=kn,V.markerStyleProperty=Cn,V.maxLengthProperty=eo,V.maximumValueProperty=ha,V.metaFileImageStringProperty=Rr,V.minimumValueProperty=ca,V.minorFontSchemeProperty=ia,V.minorTickMarkProperty=ma,V.multiLineProperty=Wo,V.nameProperty=dt,V.nextProperty=ct,V.nsidProperty=Es,V.numberFormatProperty=Ns,V.numberOfColumnsProperty=Si,V.numberValueProperty=xn,V.outlineLevelProperty=ri,V.overlapProperty=ar,V.overrideListLevelProperty=Bs,V.pageHeightProperty=ui,V.pageNumberStyleProperty=Pi,V.pageStartingNumberProperty=wi,V.pageWidthProperty=pi,V.panoseProperty=sa,V.paraStyleNameProperty=Ws,V.paragraphFormatProperty=De,V.patternProperty=["pattern","pt"],V.plotAreaProperty=er,V.positionProperty=qs,V.positioningProperty=os,V.preferredWidthProperty=Xi,V.preferredWidthTypeProperty=Ji,V.prefixMappingProperty=Ko,V.propertiesProperty=Vs,V.protectionTypeChangeEvent=Se,V.protectionTypeProperty=Je,V.replyCommentsProperty=mo,V.requestNavigateEvent=we,V.restartIndexForEndnotesProperty=Ii,V.restartIndexForFootnotesProperty=Ci,V.restartLevelProperty=Ss,V.restartPageNumberingProperty=vi,V.revisionActionEvent=ye,V.revisionIdProperty=yo,V.revisionIdsProperty=Dt,V.revisionTypeProperty=fo,V.revisionsProperty=je,V.rgbProperty=ya,V.rightIndentProperty=jt,V.rightMarginProperty=mi,V.rightProperty=Vr,V.rowFormatProperty=$o,V.rowSpanProperty=Li,V.rowsProperty=ts,V.saltValueProperty=$e,V.scalingProperty=zt,V.searchResultsChangeEvent=Ce,V.sectionFormatProperty=ks,V.sectionsProperty=Re,V.selectedIndexProperty=ao,V.selectionChangeEvent=ie,V.separatorProperty=Ms,V.seriesFormatProperty=En,V.seriesNameProperty=Nn,V.serviceFailureEvent=le,V.shadingProperty=Ki,V.shadowProperty=tn,V.shapeIdProperty=hr,V.showSeriesKeysProperty=jn,V.sizeProperty=ro,V.sizeTypeProperty=no,V.spaceAfterAutoProperty=Jt,V.spaceBeforeAutoProperty=Yt,V.spaceProperty=Qs,V.startAtProperty=Ts,V.statusTextProperty=Jr,V.storeItemIdProperty=Xo,V.strikethroughProperty=xt,V.styleNameProperty=Pt,V.stylesProperty=qe,V.symbolCodeProperty=xo,V.symbolFontNameProperty=Co,V.tabJustificationProperty=zs,V.tabLeaderProperty=js,V.tableAlignmentProperty=Zi,V.tableFormatProperty=ss,V.tabsProperty=ai,V.tagProperty=So,V.textAlignmentProperty=Kt,V.textFrameProperty=Wr,V.textInputProperty=Yr,V.textProperty=dr,V.textVerticalAlignmentProperty=Lr,V.textWrappingStyleProperty=xr,V.textWrappingTypeProperty=Cr,V.textureProperty=Qi,V.themeFontLanguagesProperty=at,V.themesProperty=lt,V.tickLabelPositionProperty=fa,V.titleProperty=Ho,V.toolbarClickEvent=ke,V.topMarginProperty=fi,V.topProperty=Dr,V.trackChangeEvent=xe,V.trackChanges=Le,V.trackChangesProperty=Xe,V.trendLinesProperty=Ln,V.typeProperty=aa,V.typefaceProperty=oa,V.uncheckedStateProperty=Ao,V.underlineColorProperty=wt,V.underlineProperty=vt,V.userProperty=Xs,V.valueProperty=qo,V.verticalAlignmentProperty=Bi,V.verticalOriginProperty=ps,V.verticalPositionProperty=us,V.verticalProperty=rn,V.verticalRelativePercentProperty=Ir,V.viewChangeEvent=de,V.visibleProperty=pr,V.weightProperty=xa,V.widowControlProperty=ii,V.widthProperty=mr,V.widthRelativePercentProperty=Pr,V.widthScaleProperty=yr,V.wrapTextAroundProperty=ns,V.xPathProperty=Zo,V.xmlMappingProperty=Vo,V.xmlProperty=wo,V.yValueProperty=pn,V.zOrderPositionProperty=Tr,V.zoomFactorChangeEvent=ne,Object.defineProperty(V,"__esModule",{value:!0})});
//# sourceMappingURL=ej2-documenteditor.umd.min.js.map
